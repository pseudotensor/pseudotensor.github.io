<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>HARM: initbase.c Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">HARM
   </div>
   <div id="projectbrief">harm and utilities</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">initbase.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../de/df8/initbase_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;decs.h&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div>
<div class="line"><a name="l00021"></a><span class="lineno"><a class="code" href="../../de/df8/initbase_8c.html#ac4110398e386c9888d9565630357dbbe">   21</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d8/df4/global_8funcdeclare_8h.html#ac4110398e386c9888d9565630357dbbe" title="General-Primary init() routine Uses globals inside init() because sets memory and sets physics...">init</a>(<span class="keywordtype">int</span> *argc, <span class="keywordtype">char</span> **argv[])</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;{</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="../../de/df8/initbase_8c.html#acb850ca3cf91c9fc812d0739ebe773e6" title="Called before pre_init() : i.e. before MPI init.">prepre_init</a>(<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="../../de/df8/initbase_8c.html#a1c74eb972a6b27d89248c6f1d702d3bd" title="initialize MPI and other things NO computations should be performed here">pre_init</a>(<span class="keywordtype">int</span> *argc, <span class="keywordtype">char</span> **argv[]);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="../../de/df8/initbase_8c.html#a989e8f627ab06fa34fb3a3abf4f6bffe" title="init default defcoord">init_defdefcoord</a>(<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="../../de/df8/initbase_8c.html#a213950b7c45e18f5966a83c116142a1c" title="init default grid">init_defgrid</a>(<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="../../de/df8/initbase_8c.html#a0904e3bc54f4a1fafe4152bfac071111" title="init default global paramters">init_defglobal</a>(<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="../../de/df8/initbase_8c.html#a2a7b5a31d7713e0db1c142dc7d096fbb" title="init default constants">init_defconsts</a>(<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="../../de/df8/initbase_8c.html#ae2b35ba778a1c94bdb69e35592d3a341" title="set certain arrays to zero for diagnostic purposes (must come after all basic init stuff that sets up...">init_arrays_before_set_pu</a>(<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="keyword">extern</span> <span class="keywordtype">void</span> filterffde(<span class="keywordtype">int</span> <a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#ad21ff679aac3fe28202c6d592eafd3e6">i</a>, <span class="keywordtype">int</span> <a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>, <span class="keywordtype">int</span> k, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *<a class="code" href="../../dc/dd2/newcodediff_8txt.html#ae7ab77d7e616dc02fba121a009b48c27">pr</a>);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="keyword">extern</span> <span class="keywordtype">void</span> filter_coldgrmhd(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *pr);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../de/df8/initbase_8c.html#ab7cd2db876c8f553cbb0570316c6e796">set_grid_all</a>(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> thetarot, <span class="keywordtype">int</span> restartmode);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keywordtype">void</span>  <a class="code" href="../../de/df8/initbase_8c.html#a77c984f691a1923e8ec1884a090f673b" title="initialize conserved quantities if(RESTARTMODE==0)">init_all_conservatives</a>(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*prim)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pstag)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*utemp)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*ucons)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR]);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#ad21ff679aac3fe28202c6d592eafd3e6">i</a>,<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>,k;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordtype">int</span> jj;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordtype">int</span> pl,pliter;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keywordtype">int</span> selfgraviter;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keywordtype">int</span> gotnan;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordtype">int</span> faketimeorder,fakenumtimeorders;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  stderrfprintf(<span class="stringliteral">&quot;Start init\n&quot;</span>); fflush(stderr);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="comment">// Both normal and restart mode need all &quot;pre_init&quot; functions called</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a00bdeb72a08e745eb0a5482af9e8cb74">RESTARTMODE</a>==0 || <a class="code" href="../../d8/d5b/defs_8general_8h.html#a00bdeb72a08e745eb0a5482af9e8cb74">RESTARTMODE</a>==1){</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="comment">// prepre_init type functions should not assume anything done yet</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment"></span>    <a class="code" href="../../de/df8/initbase_8c.html#acb850ca3cf91c9fc812d0739ebe773e6" title="Called before pre_init() : i.e. before MPI init.">prepre_init</a>();</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <a class="code" href="../../d8/d60/init_8c.html#a2ce999ac8e87da3eb35ffc736f33515a">prepre_init_specific_init</a>(); <span class="comment">// user func</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="comment">// pre_init type functions initialize MPI and other things</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment"></span>    <a class="code" href="../../de/df8/initbase_8c.html#a1c74eb972a6b27d89248c6f1d702d3bd" title="initialize MPI and other things NO computations should be performed here">pre_init</a>(argc,argv);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <a class="code" href="../../d8/d60/init_8c.html#a828f57eb31d3e4344cdb8fe80a87456b">pre_init_specific_init</a>(); <span class="comment">// user func</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  }</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="comment">// Always set parameters and coordinates as default in case restart file doesn&#39;t have this information.  Properly, the restart file will overwrite if file contains those variables.</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment"></span>  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a00bdeb72a08e745eb0a5482af9e8cb74">RESTARTMODE</a>==0 || <a class="code" href="../../d8/d5b/defs_8general_8h.html#a00bdeb72a08e745eb0a5482af9e8cb74">RESTARTMODE</a>==1){</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="comment">// define parameters</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <a class="code" href="../../de/df8/initbase_8c.html#a0904e3bc54f4a1fafe4152bfac071111" title="init default global paramters">init_defglobal</a>(); <span class="comment">// init default global parameters</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <a class="code" href="../../de/df8/initbase_8c.html#a2a7b5a31d7713e0db1c142dc7d096fbb" title="init default constants">init_defconsts</a>(); <span class="comment">// init default physical constants</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <a class="code" href="../../d8/d60/init_8c.html#ad65091dcd8813738c5e64bec2afa6d35">init_consts</a>(); <span class="comment">// init user constants</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <a class="code" href="../../d8/d60/init_8c.html#abd98493cc6574124e0b41c742a056eea">init_global</a>(); <span class="comment">// request choices for global parameters</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="../../de/df8/initbase_8c.html#a989e8f627ab06fa34fb3a3abf4f6bffe" title="init default defcoord">init_defdefcoord</a>(); <span class="comment">// choose defcoord</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <a class="code" href="../../d8/d60/init_8c.html#a754ac4e0e3187d9f67a57083aa3bdcf7">init_defcoord</a>(); <span class="comment">// user choose defcoord</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a60cc2ae07fc7fa7fe31f94d01bc7f4f8" title="Things to set that only depend upon defcoord and nothing else NOTEMARK: By nothing else...">set_coord_parms_nodeps</a>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a>); <span class="comment">// requires only defcoord, no other grid parameters</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <a class="code" href="../../de/df8/initbase_8c.html#a213950b7c45e18f5966a83c116142a1c" title="init default grid">init_defgrid</a>(); <span class="comment">// init default grid</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <a class="code" href="../../d8/d60/init_8c.html#af39bdacc916052c8633c4300a8f99441">init_grid</a>(); <span class="comment">// request choices for grid/coordinate/metric parameters</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#afe287fe0a55bbf3b69020d103da8b6cd" title="stuff that depends upon ANYTHING external that might be set by user in init_grid() or by system in in...">set_coord_parms_deps</a>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a>); <span class="comment">// requires correct defcoord at least</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="comment">// MPI setup for core placement and boundary conditions</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="comment">// requires special3dspc, periodicx?, and dofull2pi and other things defining grid type already be set</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="comment">// after the below call, can then call boundary functions and MPI decomposition will be ready</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    init_placeongrid_griddecomposition();</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="comment">// set certain arrays to zero for diagnostic purposes (must come after all basic init stuff that sets up grid parms and all other parms)</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <a class="code" href="../../de/df8/initbase_8c.html#ae2b35ba778a1c94bdb69e35592d3a341" title="set certain arrays to zero for diagnostic purposes (must come after all basic init stuff that sets up...">init_arrays_before_set_pu</a>();</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="comment">// RESTART MODE</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="comment">// Loads primitives and conserved quantities.</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="comment">// Always assume conserved quantities are in the file, regardless of whether used.  Only used if doing higher-order method</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment"></span>  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a00bdeb72a08e745eb0a5482af9e8cb74">RESTARTMODE</a>==1){</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    trifprintf(<span class="stringliteral">&quot;start restart_init: proc=%04d\n&quot;</span>,myid);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordflow">if</span> (restart_init(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a8b72d2f050a5b88382fed7121a35207f">WHICHFILE</a>) &gt;= 1) {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>, <span class="stringliteral">&quot;main:restart_init: failure\n&quot;</span>);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    trifprintf(<span class="stringliteral">&quot;end restart_init: proc=%04d\n&quot;</span>,myid);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="comment">// don&#39;t bound read-in data yet since need grid and other things</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="comment">// if read-in dummy data that had meaningless radiation terms, then call below:</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="comment">// extern int process_restart_toget_radiation(void);</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="comment">// process_restart_toget_radiation();</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="comment">// Always write new coordparms file.  Fresh start needs it, but also do in case user updated restart file but not coord file</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="comment">// Default file name: coordparms.dat</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment"></span>  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a00bdeb72a08e745eb0a5482af9e8cb74">RESTARTMODE</a>==0 || <a class="code" href="../../d8/d5b/defs_8general_8h.html#a00bdeb72a08e745eb0a5482af9e8cb74">RESTARTMODE</a>==1){</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a3a0b85792ff4269484f48bb95a0f0a3e" title="write coordinate parameters">write_coord_parms</a>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a>); <span class="comment">// output coordinate parameters to file</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  }</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="comment">// Both normal and restart mode need to setup grid</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment"></span>  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a00bdeb72a08e745eb0a5482af9e8cb74">RESTARTMODE</a>==0 || <a class="code" href="../../d8/d5b/defs_8general_8h.html#a00bdeb72a08e745eb0a5482af9e8cb74">RESTARTMODE</a>==1){</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <a class="code" href="../../de/df8/initbase_8c.html#ab7cd2db876c8f553cbb0570316c6e796">set_grid_all</a>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ac1ef268f75fd0b1d21d07ca1f743db23">THETAROTPRIMITIVES</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a00bdeb72a08e745eb0a5482af9e8cb74">RESTARTMODE</a>); <span class="comment">// use THETAROT=THETAROTPRIMITIVES</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  }</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="comment">// Normal fresh start need to get primitive and conserved quantities</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment"></span>  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a00bdeb72a08e745eb0a5482af9e8cb74">RESTARTMODE</a>==0){</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="preprocessor">#if(DOSELFGRAVVSR)</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define NUMSELFGRAVITER 3 // MINIMUM of 2 iterations should be done for metric to computed once</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="preprocessor"></span>    <span class="comment">// further iterations will determine PRIMECOORD velocity and magnetic field using newly updated metric</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="comment">// 3 iterations allows this new metric to be used once, and I suggest this as good minimum # of iterations</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define NUMSELFGRAVITER 1 // NO CHOICE</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="comment">// iterations to get consistent/converged initial conditions</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="comment">// assume user chooses primitive in final-to-be-metric so first primitive is correct final primitive</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="comment">// conservatives adjusted with adjusting metric</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">for</span>(selfgraviter=1;selfgraviter&lt;=<a class="code" href="../../de/df8/initbase_8c.html#a5ed6061b8649d9d6a1f2c2e88b97eebb">NUMSELFGRAVITER</a>;selfgraviter++){</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      trifprintf(<span class="stringliteral">&quot;begin iteration over metric: selfgraviter=%d\n&quot;</span>,selfgraviter);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <span class="keywordflow">if</span>(selfgraviter&gt;1){</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#af35efc27e405b7c3e2c95df8f7559a07" title="#define WHICHENTROPYEVOLVE EVOLVEFULLENTROPY">DOSELFGRAVVSR</a>){</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;          trifprintf(<span class="stringliteral">&quot;new metric with self-gravity: selfgraviter=%d\n&quot;</span>,selfgraviter);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;          <span class="comment">// if box_grid needs to change, is done inside below function</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;          compute_new_metric_and_prims(0,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a1fb64169459d57727a61a72b6e01ced5">MBH</a>, <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa73cf2d397cae726436e08d2c891bdb0">a</a>, <a class="code" href="../../d8/d5b/defs_8general_8h.html#a60c2aa47ffa41453bf4afb2c19ac2a4e">QBH</a>, <a class="code" href="../../d8/d5b/defs_8general_8h.html#a2f09f0f07c81c40846f158024b125ed0">EP3</a>, <a class="code" href="../../d8/d5b/defs_8general_8h.html#af850e395071231822a385de91849efd3">THETAROT</a>, <a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pglobal),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pstagglobal),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(unewglobal),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(vpotarrayglobal),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(Bhatglobal),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(gp_l),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(gp_r),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(F1),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(F2),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(F3),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(emf),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(ulastglobal));</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;          trifprintf(<span class="stringliteral">&quot;done with computing new metric with self-gravity dt=%21.15g selfgraviter=%d\n&quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a56db625f31229c5e8b208ff27d464931">dt</a>,selfgraviter);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        }</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      }</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <span class="comment">// user function that should fill p with primitives</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      <span class="comment">// assumes everyting computed by:  compute_EOS_parms() is known by init_primitives without immediate reference to what&#39;s computed by compute_EOS_parms since this function depends upon primitives themselves</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a0163a499c88dd8b07688e3dbd7007f0e">MYFUN</a>(<a class="code" href="../../d8/d60/init_8c.html#a0afa200a5f947b1c9f6e554519f28fc4">init_primitives</a>(<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pglobal),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pstagglobal),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(unewglobal),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(vpotarrayglobal),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(Bhatglobal),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(panalytic),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pstaganalytic),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(vpotanalytic),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(Bhatanalytic),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(F1),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(F2),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(F3),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(emf)),<span class="stringliteral">&quot;initbase.c:init()&quot;</span>, <span class="stringliteral">&quot;init_primitives()&quot;</span>, 0);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      <span class="comment">// dump analytic solution</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      <span class="comment">//GLOBALPOINT(pdump)=GLOBALPOINT(panalytic);</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <span class="comment">//if (dump(-9999) &gt;= 1){</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      <span class="comment">//  dualfprintf(fail_file,&quot;unable to print dump file\n&quot;);</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      <span class="comment">//  return (1);</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      <span class="comment">//}</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      <span class="comment">// assign memory for dumping primitives</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      <a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pdump)=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pglobal);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      <span class="comment">//    COMPLOOPF{</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      <span class="comment">// MACP0A1(p,i,j,k,UU)=0.0;</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      <span class="comment">// }</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <span class="comment">// mandatory filters on user supplied primitives</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <span class="comment">// Filter to get correct degenerate FFDE solution</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment"></span>      </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#a87e5572748e4cc27373e50bd78e6f2e8">EOMTYPE</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a6f6094bc467dc61f9490ad7e1de63580">EOMFFDE</a>||<a class="code" href="../../da/d3e/definit_8h.html#a87e5572748e4cc27373e50bd78e6f2e8">EOMTYPE</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a30a753538ac3bf4801ac123a37dfcc57">EOMFFDE2</a>){</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        trifprintf(<span class="stringliteral">&quot;System filtered to FFDE\n&quot;</span>);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <span class="comment">// filter to get force-free</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <a class="code" href="../../df/da8/global_8comploops_8h.html#a73344b9115781fb6586768527d859edd">COMPFULLLOOP</a>{</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;          filterffde(i,j,k,<a class="code" href="../../df/d1c/global_8storage_8h.html#a5dd5a282922755d8516bcbf69ccfa767">GLOBALMAC</a>(pglobal,i,j,k));</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      }</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#a87e5572748e4cc27373e50bd78e6f2e8">EOMTYPE</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a757ad8b9c2c7611dad8aab853a87f61b">EOMCOLDGRMHD</a>){</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        trifprintf(<span class="stringliteral">&quot;System filtered to cold GRMHD\n&quot;</span>);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <span class="comment">// filter to get cold GRMHD</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <a class="code" href="../../df/da8/global_8comploops_8h.html#a73344b9115781fb6586768527d859edd">COMPFULLLOOP</a>{</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;          filter_coldgrmhd(i,j,k,<a class="code" href="../../df/d1c/global_8storage_8h.html#a5dd5a282922755d8516bcbf69ccfa767">GLOBALMAC</a>(pglobal,i,j,k));</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        }</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      }</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      <span class="comment">// Fixup and Bound variables since field may have changed</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      <span class="comment">// Also setup pre_fixup() type quantities</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment"></span>      </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      trifprintf(<span class="stringliteral">&quot;System Fixup and Bound\n&quot;</span>);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      <span class="keywordflow">if</span>(pre_fixup(<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#affb13608b845e81f4595b80927fbedbd" title="for various uses (dumping and special boundary/comp interchange routine">STAGEM1</a>,<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pglobal))&gt;=1) <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a5febb92786c5f7a1479e7e65f1c23ef3">FAILSTATEMENT</a>(<span class="stringliteral">&quot;initbase.c:init()&quot;</span>, <span class="stringliteral">&quot;pre_fixup()&quot;</span>, 1);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="preprocessor">#if(FIXUPAFTERINIT)</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="preprocessor"></span>      <span class="keywordflow">if</span>(fixup(<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#affb13608b845e81f4595b80927fbedbd" title="for various uses (dumping and special boundary/comp interchange routine">STAGEM1</a>,<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pglobal),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(unewglobal),0)&gt;=1)</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a5febb92786c5f7a1479e7e65f1c23ef3">FAILSTATEMENT</a>(<span class="stringliteral">&quot;initbase.c:init()&quot;</span>, <span class="stringliteral">&quot;fixup()&quot;</span>, 1);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      {</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <span class="keywordtype">int</span> finalstep=1; <span class="comment">// assume user wants to know if initial conserved quants changed</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="comment">// in case pflag failure of utoprim call was hit during init, and user didn&#39;t do anything about it, then need to fixup now.</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a0163a499c88dd8b07688e3dbd7007f0e">MYFUN</a>(post_fixup(<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#affb13608b845e81f4595b80927fbedbd" title="for various uses (dumping and special boundary/comp interchange routine">STAGEM1</a>,finalstep, <a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>, <a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pglobal),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pglobal),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(unewglobal)),<span class="stringliteral">&quot;initbase.c:init()&quot;</span>, <span class="stringliteral">&quot;post_fixup()&quot;</span>, 1);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      }</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="keywordtype">int</span> finalstep=1; <span class="comment">// assume user wants to know if initial conserved quants changed</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/dad/bounds_8funcdeclare_8h.html#a91fe5c4370e3292a19e7f794797a407f" title="normal bounding of all primitives">bound_allprim</a>(<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#affb13608b845e81f4595b80927fbedbd" title="for various uses (dumping and special boundary/comp interchange routine">STAGEM1</a>,finalstep,<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>,<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pglobal),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pstagglobal),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(unewglobal), USEMPI) &gt;= 1)</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;          <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a5febb92786c5f7a1479e7e65f1c23ef3">FAILSTATEMENT</a>(<span class="stringliteral">&quot;initbase.c:init()&quot;</span>, <span class="stringliteral">&quot;bound_allprim()&quot;</span>, 1);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      }</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      <span class="comment">// now fully bounded, initialize interpolations in case interpolate using prim/pstag data</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      pre_interpolate_and_advance(<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pglobal));</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aac5486df6a846aa6cb47c73202ac0485">DODIAGS</a> &amp;&amp; <a class="code" href="../../da/d3e/definit_8h.html#a6fc838c14c5e9fc17d6d8bb3d868ec2f">PRODUCTION</a>==0){</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <span class="comment">// BEGIN DEBUG</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <span class="comment">// dump solution so far</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <span class="keywordflow">if</span>(selfgraviter==1){</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;          <a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pdump)=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pglobal);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;          <span class="keywordflow">if</span> (dump(9000) &gt;= 1){</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;unable to print dump file\n&quot;</span>);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            <span class="keywordflow">return</span> (1);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;          }</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        }</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(selfgraviter==2){</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;          <a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pdump)=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pglobal);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;          <span class="keywordflow">if</span> (dump(9001) &gt;= 1){</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;unable to print dump file\n&quot;</span>);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            <span class="keywordflow">return</span> (1);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;          }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(selfgraviter==3){</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;          <a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pdump)=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pglobal);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;          <span class="keywordflow">if</span> (dump(9002) &gt;= 1){</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;unable to print dump file\n&quot;</span>);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            <span class="keywordflow">return</span> (1);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;          }</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        }</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <span class="comment">// END DEBUG</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment"></span>      }<span class="comment">// end if doing diagnostics and production==0</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      <span class="comment">// after all parameters and primitives are set, then can set these items</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      <a class="code" href="../../d5/de1/global_8inits_8h.html#a0d6e7670443a502fbdd65884255d88b3" title="post init">post_init</a>(<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pglobal),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(cfaraday));</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      <span class="comment">// user post_init function</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      <a class="code" href="../../d8/d60/init_8c.html#a93e3703307cb156be38a44b240a6a6cb">post_init_specific_init</a>();</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      <span class="comment">// get all conserved quantities (volume averaged or otherwise)</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      <a class="code" href="../../de/df8/initbase_8c.html#a77c984f691a1923e8ec1884a090f673b" title="initialize conserved quantities if(RESTARTMODE==0)">init_all_conservatives</a>(<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pglobal),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pstagglobal),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(ulastglobal),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(unewglobal));</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aac5486df6a846aa6cb47c73202ac0485">DODIAGS</a> &amp;&amp; <a class="code" href="../../da/d3e/definit_8h.html#a6fc838c14c5e9fc17d6d8bb3d868ec2f">PRODUCTION</a>==0){</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <span class="comment">// BEGIN DEBUG</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="comment">// dump solution so far</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <span class="keywordflow">if</span>(selfgraviter==1){</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;          <a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pdump)=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pglobal);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;          <span class="keywordflow">if</span> (dump(9100) &gt;= 1){</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;unable to print dump file\n&quot;</span>);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            <span class="keywordflow">return</span> (1);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;          }</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        }</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(selfgraviter==2){</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;          <a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pdump)=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pglobal);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;          <span class="keywordflow">if</span> (dump(9101) &gt;= 1){</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;unable to print dump file\n&quot;</span>);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            <span class="keywordflow">return</span> (1);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;          }</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        }</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(selfgraviter==3){</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;          <a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pdump)=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pglobal);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;          <span class="keywordflow">if</span> (dump(9102) &gt;= 1){</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;unable to print dump file\n&quot;</span>);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            <span class="keywordflow">return</span> (1);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;          }</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        }</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <span class="comment">// END DEBUG</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment"></span>      }</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      trifprintf(<span class="stringliteral">&quot;end iteration over metric: selfgraviter=%d\n&quot;</span>,selfgraviter);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    }<span class="comment">// end loop to get metric and primitive setting consistent</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  }<span class="comment">// end if RESTARTMODE==0</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment"></span>  <span class="comment">//</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <span class="comment">// Restart and get primitive and conserved quantities</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment"></span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a00bdeb72a08e745eb0a5482af9e8cb74">RESTARTMODE</a>==1){</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="comment">// more restart checks</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    restart_init_simple_checks(2);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="preprocessor">#if(FIXUPAFTERINIT)</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="preprocessor"></span>    trifprintf(<span class="stringliteral">&quot;before pre_fixup() during restart: proc=%04d\n&quot;</span>,myid);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keywordflow">if</span>(pre_fixup(<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#affb13608b845e81f4595b80927fbedbd" title="for various uses (dumping and special boundary/comp interchange routine">STAGEM1</a>,<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pglobal))&gt;=1) <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a5febb92786c5f7a1479e7e65f1c23ef3">FAILSTATEMENT</a>(<span class="stringliteral">&quot;initbase.c:init()&quot;</span>, <span class="stringliteral">&quot;pre_fixup()&quot;</span>, 1);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    trifprintf(<span class="stringliteral">&quot;after pre_fixup() during restart: proc=%04d\n&quot;</span>,myid);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    trifprintf(<span class="stringliteral">&quot;before fixup() during restart: proc=%04d\n&quot;</span>,myid);</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="keywordflow">if</span>(fixup(<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#affb13608b845e81f4595b80927fbedbd" title="for various uses (dumping and special boundary/comp interchange routine">STAGEM1</a>,<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pglobal),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(unewglobal),0)&gt;=1)  <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a5febb92786c5f7a1479e7e65f1c23ef3">FAILSTATEMENT</a>(<span class="stringliteral">&quot;initbase.c:init()&quot;</span>, <span class="stringliteral">&quot;fixup()&quot;</span>, 1);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    trifprintf(<span class="stringliteral">&quot;after fixup() during restart: proc=%04d\n&quot;</span>,myid);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="comment">// DEBUG: in case restart and need to fix-up things</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="comment">//void debugfixup(void);</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="comment">//    debugfixup();</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    {</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      <span class="keywordtype">int</span> finalstep=1; <span class="comment">// assume user wants to know if initial conserved quants changed</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      <span class="comment">// in case pflag failure of utoprim call was hit during init, and user didn&#39;t do anything about it, then need to fixup now.</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;      <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a0163a499c88dd8b07688e3dbd7007f0e">MYFUN</a>(post_fixup(<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#affb13608b845e81f4595b80927fbedbd" title="for various uses (dumping and special boundary/comp interchange routine">STAGEM1</a>,finalstep, <a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>, <a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pglobal),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pglobal),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(unewglobal)),<span class="stringliteral">&quot;initbase.c:init()&quot;</span>, <span class="stringliteral">&quot;post_fixup()&quot;</span>, 1);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    }</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    trifprintf(<span class="stringliteral">&quot;before bound_prim() during restart: proc=%04d\n&quot;</span>,myid);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    {</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      <span class="comment">// pstag not computed from unewglobal yet, so don&#39;t bound it.  It&#39;ll get self-consistently bounded when ucons2upointppoint() is called below</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      <span class="keywordtype">int</span> finalstep=1; <span class="comment">// assume user wants to know if initial conserved quants changed</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d4/dad/bounds_8funcdeclare_8h.html#addca75a18cc861326a321565a2e81aa0" title="normal bounding of non-staggered primitives">bound_prim</a>(<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#affb13608b845e81f4595b80927fbedbd" title="for various uses (dumping and special boundary/comp interchange routine">STAGEM1</a>,finalstep,<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>,<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pglobal),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pstagglobal),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(unewglobal), USEMPI) &gt;= 1)      <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a5febb92786c5f7a1479e7e65f1c23ef3">FAILSTATEMENT</a>(<span class="stringliteral">&quot;initbase.c:init()&quot;</span>, <span class="stringliteral">&quot;bound_allprim()&quot;</span>, 1);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    }</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    trifprintf(<span class="stringliteral">&quot;after bound_prim() during restart: proc=%04d\n&quot;</span>,myid);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="comment">// more restart checks</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    restart_init_simple_checks(3);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="comment">// before can interpolate inside ucons2upointppoint(), need to compute things needed by interpolation, including for STORESHOCKINDICATOR==1</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#a6855043e100d3c2181179e61edba690b" title="whether to compute and store Shock (and other indicators) just once rather than for every call to slo...">STORESHOCKINDICATOR</a>==1){</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      pre_interpolate_and_advance(<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pglobal));</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    }</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="comment">// Note there is no need to convert average or quasi-deaveraged field to staggered field (see comments in ucons2upointppoint())</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="comment">// However, divb diagnostics at first won&#39;t be right at t=0 since set to use primitive for lower-order method, but just assume diagnostic won&#39;t likely be immediately after restart</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="comment">// For RESTARTMODE==0 the pstag quantity is set by user or during vector potential conversion to u and p, but during restart we only read-in p and unew while we need also pstagscratch</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="comment">// so after ucons2upointppoint() call, pcent as in boundaries will not be updated but not required.  And it will not be Nan since did bound above.</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment"></span>    trifprintf(<span class="stringliteral">&quot;before ucons2upointppoint during restart: proc=%04d\n&quot;</span>,myid);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <a class="code" href="../../d3/d72/fluxvpot_8c.html#aaa24493002bc8c0a527b1ea2ac2dddbf" title="convert conservative U to stag point P and CENT point U and CENT point primitive">ucons2upointppoint</a>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>, <a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pglobal),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pstagglobal),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(unewglobal),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(ulastglobal),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pglobal)); <span class="comment">// this regenerates pcentered for B1,B2,B3</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    trifprintf(<span class="stringliteral">&quot;after ucons2upointppoint during restart: proc=%04d\n&quot;</span>,myid);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="comment">// now bound unewglobal and vpot&#39;s</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a11c4e99e1493d0c1914ad1ab313ea472">FLUXB</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0b6762cef74e396f50a83864bb53fb6c">FLUXCTSTAG</a>){</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      <span class="keywordtype">int</span> boundvartype=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2eddd9ab5ac3f8f5a8a8b62288b76f89">BOUNDPRIMTYPE</a>;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      <span class="keywordtype">int</span> finalstep=1; <span class="comment">// assume user wants to know if initial conserved quants changed</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      <span class="keywordtype">int</span> doboundmpi=1;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      <a class="code" href="../../d4/dad/bounds_8funcdeclare_8h.html#abdea68b778dc9253324da69d3c376965" title="bound any pstag type CALLS directly real and MPI boundary functions pstag is at FACE1,2,3 for fields, so user bound is different MPI bounding is the same as CENT quantities used when restarting in initbase.c to bound unewglobal for FLUXB==FLUXCTSTAG">bound_anypstag</a>(<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#affb13608b845e81f4595b80927fbedbd" title="for various uses (dumping and special boundary/comp interchange routine">STAGEM1</a>, finalstep, <a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>, boundvartype, <a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(unewglobal), <a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(unewglobal), <a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(unewglobal), doboundmpi);</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    }</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#a10c2a32787a08dc5ca8ee25788232ab5" title="whether to redefine fields from A_i during evolution currently only done after each full timestep to ...">EVOLVEWITHVPOT</a>||<a class="code" href="../../da/d3e/definit_8h.html#a3a15a632c4a89c05af66b680733eb82c" title="whether to track and dump A_i the vector potential">TRACKVPOT</a>){</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;      <span class="keywordtype">int</span> boundvartype=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2a10dbc87550637eb2582e022436108d">BOUNDVPOTTYPE</a>;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      <span class="keywordtype">int</span> finalstep=1; <span class="comment">// assume user wants to know if initial conserved quants changed</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      <span class="keywordtype">int</span> doboundmpi=1;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      <span class="keywordtype">int</span> doboundnonmpi=1;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      bound_vpot(<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#affb13608b845e81f4595b80927fbedbd" title="for various uses (dumping and special boundary/comp interchange routine">STAGEM1</a>, finalstep, <a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>, boundvartype, <a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(vpotarrayglobal),doboundmpi,doboundnonmpi);</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    }</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="comment">// more restart checks</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    restart_init_simple_checks(4);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="comment">// after all parameters and primitives are set, then can set these items</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    trifprintf(<span class="stringliteral">&quot;before post_init and post_init_specific_init during restart: proc=%04d\n&quot;</span>,myid);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <a class="code" href="../../d5/de1/global_8inits_8h.html#a0d6e7670443a502fbdd65884255d88b3" title="post init">post_init</a>(<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pglobal),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(cfaraday));</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="comment">// user post_init function</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <a class="code" href="../../d8/d60/init_8c.html#a93e3703307cb156be38a44b240a6a6cb">post_init_specific_init</a>();</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    trifprintf(<span class="stringliteral">&quot;after post_init and post_init_specific_init during restart: proc=%04d\n&quot;</span>,myid);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="comment">// more restart checks</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    restart_init_simple_checks(5);</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="comment">// don&#39;t want conservatives or primitives to change, just compute metric</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#af35efc27e405b7c3e2c95df8f7559a07" title="#define WHICHENTROPYEVOLVE EVOLVEFULLENTROPY">DOSELFGRAVVSR</a>){</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      trifprintf(<span class="stringliteral">&quot;new metric with self-gravity\n&quot;</span>);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      compute_new_metric_and_prims(0,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a1fb64169459d57727a61a72b6e01ced5">MBH</a>, <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa73cf2d397cae726436e08d2c891bdb0">a</a>, <a class="code" href="../../d8/d5b/defs_8general_8h.html#a60c2aa47ffa41453bf4afb2c19ac2a4e">QBH</a>, <a class="code" href="../../d8/d5b/defs_8general_8h.html#a2f09f0f07c81c40846f158024b125ed0">EP3</a>, <a class="code" href="../../d8/d5b/defs_8general_8h.html#af850e395071231822a385de91849efd3">THETAROT</a>, <a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pglobal),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pstagglobal),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(unewglobal),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(vpotarrayglobal),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(Bhatglobal),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(gp_l),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(gp_r),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(F1),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(F2),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(F3),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(emf),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(ulastglobal));</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      trifprintf(<span class="stringliteral">&quot;done with computing new metric with self-gravity dt=%21.15g\n&quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a56db625f31229c5e8b208ff27d464931">dt</a>);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    }</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    trifprintf(<span class="stringliteral">&quot;before restart_init_checks() during restart: proc=%04d\n&quot;</span>,myid);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="keywordflow">if</span> (restart_init_checks(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a8b72d2f050a5b88382fed7121a35207f">WHICHFILE</a>, <a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pglobal), <a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pstagglobal), <a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(unewglobal)) &gt;= 1) {</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>, <span class="stringliteral">&quot;main:restart_init_checks: failure\n&quot;</span>);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    }</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    trifprintf(<span class="stringliteral">&quot;after restart_init_checks() during restart: proc=%04d\n&quot;</span>,myid);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    trifprintf( <span class="stringliteral">&quot;proc: %d restart completed: failed=%d\n&quot;</span>, myid, <a class="code" href="../../d8/d5b/defs_8general_8h.html#ad4ec5aab9b62fbbe9b8fc2d8ac0a5989">failed</a>);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  }<span class="comment">// done if RESTARTMODE==1</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a8e477e3a4df3a35b6685963eb797dbef">THETAROTMETRIC</a>!=<a class="code" href="../../d8/d5b/defs_8general_8h.html#ac1ef268f75fd0b1d21d07ca1f743db23">THETAROTPRIMITIVES</a>){ <span class="comment">// Deal with initial tilt</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="comment">// SUPERGODMARK: After changing metric, should really also do after below:</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="comment">// 1) A_i or U -&gt; Bstag for stag method *or* A_i -&gt; B for Toth</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="comment">// 2) Bstag -&gt; B for stag method</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="comment">// 3) Bstag,U -&gt; Bhat for stag higher order method</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="comment">// etc.</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="comment">// Otherwise, gdet changes and t=0 Bstag and B won&#39;t be consistent with A_i and U for the new metric.</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    </div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="comment">// Both normal and restart mode need to setup grid</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment"></span>    <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a00bdeb72a08e745eb0a5482af9e8cb74">RESTARTMODE</a>==0 || <a class="code" href="../../d8/d5b/defs_8general_8h.html#a00bdeb72a08e745eb0a5482af9e8cb74">RESTARTMODE</a>==1){</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;      <a class="code" href="../../de/df8/initbase_8c.html#ab7cd2db876c8f553cbb0570316c6e796">set_grid_all</a>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a8e477e3a4df3a35b6685963eb797dbef">THETAROTMETRIC</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a00bdeb72a08e745eb0a5482af9e8cb74">RESTARTMODE</a>); <span class="comment">// now use THETAROT=THETAROTMETRIC</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    }</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  }</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  <span class="comment">// Final things done whether fresh run or restart run</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment"></span><span class="preprocessor">#if(ANALYTICMEMORY)</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="preprocessor"></span>  <span class="comment">// copy over initial solution as analytic solution</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  <span class="comment">// NEEDED FOR BOUND in case uses panalytic</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <span class="comment">// Should be done before any changes in grid due to grid sectioning so that analytic variables set over all grid rather than limited range.  Then expansion of grid uses those analytical values.</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  copy_prim2panalytic(<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pglobal),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(panalytic),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pstagglobal),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pstaganalytic),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(vpotarrayglobal),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(vpotanalytic),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(Bhatglobal),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(Bhatanalytic));</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="comment">// redo grid positions using actual gridding (not full grid just because was doing inits before)</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  faketimeorder=1;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  fakenumtimeorders=2;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  recompute_fluxpositions(3,faketimeorder,fakenumtimeorders,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a1a1088d87617078680f1fd0f0d707384">nstep</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>);</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  <span class="comment">// must set dt after DOSELFGRAVVSR so have acceleration in case v=0 and c_s=0 initially</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  <span class="comment">// set initial dt correctly rather than random choice</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  <span class="comment">// actually compute_new_metric_and_prims() computes dt from set_dt()</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a0163a499c88dd8b07688e3dbd7007f0e">MYFUN</a>(set_dt(<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pglobal),&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#a56db625f31229c5e8b208ff27d464931">dt</a>),<span class="stringliteral">&quot;initbase.c:init()&quot;</span>,<span class="stringliteral">&quot;set_dt()&quot;</span>,1);</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  trifprintf(<span class="stringliteral">&quot;dt=%21.15g at t=%21.15g at nstep=%ld at realnstep=%ld\n&quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a56db625f31229c5e8b208ff27d464931">dt</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a1a1088d87617078680f1fd0f0d707384">nstep</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0b92e4d6197989f0f9b0609c8615a46f">realnstep</a>);</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  <span class="comment">// Some final diagnostics</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="preprocessor">#if(PRODUCTION==0)</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="preprocessor"></span>  <span class="comment">// SUPERGODMARK: Should only be done for RESTARTMODE==1?</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <span class="comment">// final checks</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  restart_init_simple_checks(6);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  trifprintf(<span class="stringliteral">&quot;end init.c\n&quot;</span>);</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  <span class="keywordflow">return</span> (0);</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;}</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">// wrapper to do repeated set_grid when involving tilt</span></div>
<div class="line"><a name="l00571"></a><span class="lineno"><a class="code" href="../../de/df8/initbase_8c.html#ab7cd2db876c8f553cbb0570316c6e796">  571</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../de/df8/initbase_8c.html#ab7cd2db876c8f553cbb0570316c6e796">set_grid_all</a>(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> thetarot, <span class="keywordtype">int</span> restartmode)</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;{</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../de/df8/initbase_8c.html#aa88e03092994c7a48371ef1da5231aa1" title="bounds, etc. use enerpos type stuff that is set by recompute_fluxpositions()">set_box_grid_parameters</a>(<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="../../de/df8/initbase_8c.html#a254d74445f2d2509612bfe1641f68903" title="after all parameters are set, can call this">post_par_set</a>(<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  <span class="comment">// sets global THETAROT</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#af850e395071231822a385de91849efd3">THETAROT</a> = thetarot; <span class="comment">// No, if restarting, then no need since not actually calling init_primitives // set so init rho,u,v,B are as if no rotation</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  <span class="comment">// once all interpolation parameters are set, now can set dependent items that may be used to set primitives or conservatives</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  <span class="comment">// doesn&#39;t use metric parameters, so doesn&#39;t need to be in SELFGRAV loop</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  <a class="code" href="../../de/df8/initbase_8c.html#a254d74445f2d2509612bfe1641f68903" title="after all parameters are set, can call this">post_par_set</a>();</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  <span class="keywordflow">if</span>(restartmode==1) trifprintf(<span class="stringliteral">&quot;proc: %d post_par_set completed: failed=%d\n&quot;</span>, myid,<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad4ec5aab9b62fbbe9b8fc2d8ac0a5989">failed</a>);</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  <span class="comment">// get grid</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  <span class="comment">// 0 tells set_grid that it&#39;s first call to set_grid() and so have to assume stationarity of the metric since have no time information yet</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  <a class="code" href="../../dd/d50/set__grid_8c.html#a9ac78f6d937c36a5541eb64e9983c289" title="GODMARK: may want to make grid functions explicitly 2D for axisymmetric space-times when in axisymmet...">set_grid</a>(0,0,0);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <span class="keywordflow">if</span>(restartmode==1) trifprintf(<span class="stringliteral">&quot;proc: %d grid restart completed: failed=%d\n&quot;</span>, myid,<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad4ec5aab9b62fbbe9b8fc2d8ac0a5989">failed</a>);</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  <span class="comment">// set grid boundary parameters that uses metric parameters to determine loop ranges using enerregions and enerpos</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  <a class="code" href="../../de/df8/initbase_8c.html#aa88e03092994c7a48371ef1da5231aa1" title="bounds, etc. use enerpos type stuff that is set by recompute_fluxpositions()">set_box_grid_parameters</a>();</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  <span class="keywordflow">if</span>(restartmode==1) trifprintf(<span class="stringliteral">&quot;proc: %d set_box_grid_parameters completed: failed=%d\n&quot;</span>, myid,<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad4ec5aab9b62fbbe9b8fc2d8ac0a5989">failed</a>);</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  <span class="comment">// user post_set_grid function</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  <a class="code" href="../../d5/de1/global_8inits_8h.html#a48d362b8c512e76d21c3a8a4be5ee127">init_grid_post_set_grid</a>(<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pglobal),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pstagglobal),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(unewglobal),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(vpotarrayglobal),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(Bhatglobal),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(panalytic),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pstaganalytic),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(vpotanalytic),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(Bhatanalytic),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(F1),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(F2),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(F3),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(emf));</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  <span class="keywordflow">if</span>(restartmode==1) trifprintf(<span class="stringliteral">&quot;proc: %d init_grid_post_set_grid completed: failed=%d\n&quot;</span>, myid,<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad4ec5aab9b62fbbe9b8fc2d8ac0a5989">failed</a>);</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  trifprintf(<span class="stringliteral">&quot;MCOORD=%d\n&quot;</span>,<a class="code" href="../../da/d3e/definit_8h.html#ab343edb2f60f3de2d654dcf1c58e06a2" title="#else define MAXBND 3 endif">MCOORD</a>);</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  trifprintf(<span class="stringliteral">&quot;COMPDIM=%d\n&quot;</span>,<a class="code" href="../../da/d3e/definit_8h.html#a1b2ef8afddd2c5d91ab65015bbd7b80b" title="NUMBER OF DIMENSIONS FOR COMPUTATION Can choose 3 and still do 1D optimized problems Choosing 2 or ev...">COMPDIM</a>);</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  trifprintf(<span class="stringliteral">&quot;MAXBND=%d\n&quot;</span>,<a class="code" href="../../da/d3e/definit_8h.html#ac97bae4266eb010870a1da7dc312c459" title="#if(DOENOFLUX==ENOFINITEVOLUME)">MAXBND</a>);</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  trifprintf(<span class="stringliteral">&quot;FLUXB=%d\n&quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a11c4e99e1493d0c1914ad1ab313ea472">FLUXB</a>);</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;}</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="keywordtype">int</span> copy_prim2panalytic(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*prim)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*panalytic)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pstag)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pstaganalytic)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*vpot)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a1c452bce7a227fd9f2c8f937a3c7841c">SHIFTSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#adfe8c351b7f60e189dbd9bfca47af5c5">SHIFTSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a6dc540b0373d80d3ea2db53d03a9fa72">SHIFTSTORE3</a>], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*vpotanalytic)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a1c452bce7a227fd9f2c8f937a3c7841c">SHIFTSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#adfe8c351b7f60e189dbd9bfca47af5c5">SHIFTSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a6dc540b0373d80d3ea2db53d03a9fa72">SHIFTSTORE3</a>], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*Bhat)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*Bhatanalytic)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR])</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;{</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="preprocessor">#if(ANALYTICMEMORY==0)</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="preprocessor"></span>  dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Shouldn&#39;t be setting analytic with ANALYTICMEMORY==0\n&quot;</span>);</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  myexit(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2fbdc58f192261834f16a38fdaadca70">ERRORCODEBELOWCLEANFINISH</a>+35968346);</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="preprocessor">#pragma omp parallel</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="preprocessor"></span>  {</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#ad21ff679aac3fe28202c6d592eafd3e6">i</a>,<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>,k;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <span class="keywordtype">int</span> pl,pliter;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="keywordtype">int</span> jj;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <a class="code" href="../../d5/d7b/global_8openmploops_8h.html#a1389db2daf5bd9e94918090c253a16c9">OPENMP3DLOOPVARSDEFINE</a>;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <a class="code" href="../../d5/d7b/global_8openmploops_8h.html#a7518365209531b952c067f47c80777c2" title="COMPFULLLOOP equivalent for OpenMP.">OPENMP3DLOOPSETUPFULL</a>;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="preprocessor">#pragma omp for schedule(OPENMPSCHEDULE(),OPENMPCHUNKSIZE(blocksize)) nowait // next vpot assignment does not depend upon this loop completing</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="preprocessor"></span>    <a class="code" href="../../d5/d7b/global_8openmploops_8h.html#a9e48537d3cb58cc3a3765b8a18b43b15" title="Oddly, performance changes by 10% when changing how start and stop blockijk (and fixing how used too ...">OPENMP3DLOOPBLOCK</a>{</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      <a class="code" href="../../df/d1c/global_8storage_8h.html#a96983b0c56e836f50cb7c1af16f59fb6">OPENMP3DLOOPBLOCK2IJK</a>(i,j,k);</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;      <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#af1c67086436007e897bccc458390886f" title="PLOOP controls looping over conserved or primitive -type quantities except during interpolation or ot...">PLOOP</a>(pliter,pl) <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(panalytic,i,j,k,pl)=<a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(prim,i,j,k,pl);</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      if(<a class="code" href="../../da/d3e/definit_8h.html#a08b028b6dbd6365e0fb1b1cd0770c4d6" title="#define OTHERADVECTMINIMIZE(pl) ( YFLPL(pl) &amp;&amp; DOYFL!=DONOYFL || pl==YL &amp;&amp; DOYL!=DONOYL || pl==YNU &amp;&amp;...">FIELDSTAGMEM</a>){</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#af1c67086436007e897bccc458390886f" title="PLOOP controls looping over conserved or primitive -type quantities except during interpolation or ot...">PLOOP</a>(pliter,pl) <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(pstaganalytic,i,j,k,pl)=<a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(pstag,i,j,k,pl);</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;      }</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      if(<a class="code" href="../../da/d3e/definit_8h.html#a78a93233320c47a0821fab3b7ab5e68b" title="whether need higher order memory stuff">HIGHERORDERMEM</a>){</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#af1c67086436007e897bccc458390886f" title="PLOOP controls looping over conserved or primitive -type quantities except during interpolation or ot...">PLOOP</a>(pliter,pl) <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(Bhatanalytic,i,j,k,pl)=<a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(Bhat,i,j,k,pl);</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;      }</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    }</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    if(<a class="code" href="../../da/d3e/definit_8h.html#a3a15a632c4a89c05af66b680733eb82c" title="whether to track and dump A_i the vector potential">TRACKVPOT</a>){</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;      <a class="code" href="../../d5/d7b/global_8openmploops_8h.html#a14a26cd1935ba1080f653584598acd68" title="COMPFULLLOOPP1 equivalent for OpenMP.">OPENMP3DLOOPSETUPFULLP1</a>;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="preprocessor">#pragma omp for schedule(OPENMPSCHEDULE(),OPENMPCHUNKSIZE(blocksize)) nowait // next vpot assignment is independent</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="preprocessor"></span>      <a class="code" href="../../d5/d7b/global_8openmploops_8h.html#a9e48537d3cb58cc3a3765b8a18b43b15" title="Oddly, performance changes by 10% when changing how start and stop blockijk (and fixing how used too ...">OPENMP3DLOOPBLOCK</a>{</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        <a class="code" href="../../df/d1c/global_8storage_8h.html#a96983b0c56e836f50cb7c1af16f59fb6">OPENMP3DLOOPBLOCK2IJK</a>(i,j,k);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160; </div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(jj) <a class="code" href="../../df/d1c/global_8storage_8h.html#a4589594cbb3d23d258245b68273e6df6">MACP1A0</a>(vpotanalytic,jj,i,j,k)=<a class="code" href="../../df/d1c/global_8storage_8h.html#a4589594cbb3d23d258245b68273e6df6">MACP1A0</a>(vpot,jj,i,j,k);</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;      }</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    }</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  }<span class="comment">// end parallel region (and implied barrier)</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  return(0);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;}</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;</div>
<div class="line"><a name="l00666"></a><span class="lineno"><a class="code" href="../../de/df8/initbase_8c.html#a77c984f691a1923e8ec1884a090f673b">  666</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../de/df8/initbase_8c.html#a77c984f691a1923e8ec1884a090f673b" title="initialize conserved quantities if(RESTARTMODE==0)">init_all_conservatives</a>(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*prim)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pstag)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*utemp)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*ucons)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR])</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;{</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  <span class="keywordtype">int</span> pl,pliter;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  <span class="comment">// below is user function that usually uses system function</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="../../d8/d60/init_8c.html#aa713da528acf03316bf98c126912e3ee">init_conservatives</a>(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pstag)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*Utemp)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*U)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR]);</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  </div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  <a class="code" href="../../d8/d60/init_8c.html#aa713da528acf03316bf98c126912e3ee">init_conservatives</a>(prim, pstag, utemp, ucons);</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  <span class="comment">//  bound_uavg(STAGEM1,ucons); DEBUG DEBUG</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;}</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="preprocessor">#include &quot;initbase.defaultnprlists.c&quot;</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;</div>
<div class="line"><a name="l00684"></a><span class="lineno"><a class="code" href="../../de/df8/initbase_8c.html#acb850ca3cf91c9fc812d0739ebe773e6">  684</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../de/df8/initbase_8c.html#acb850ca3cf91c9fc812d0739ebe773e6" title="Called before pre_init() : i.e. before MPI init.">prepre_init</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;{</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;  <span class="keywordtype">int</span> pl,pliter;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#ad51c3292d4a1fe55dad50b5c58b6b2a9">SQRTMINNUMREPRESENT</a>=sqrt(<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a761d328f82547ccc85bd4442993d7204">MINNUMREPRESENT</a>);</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac79d4fd7cdf46f68ef5a749d73a4b286">NUMEPSILONPOW23</a>=pow(<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a8913cb5d64cfec23ae1a3052930ec468">NUMEPSILON</a>,2.0/3.0);</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  rancvaln=0; <span class="comment">// for ranc.c</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  <span class="comment">// things initialized whether restarting or init fresh</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;  ranc(1,0);  <span class="comment">// power up random number generator in case used without init</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  <span class="comment">// set default performance parameters</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  set_defaults_performance_checks_prepreinit();</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;  <span class="comment">// set file version numbers</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  set_file_versionnumbers();</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  <span class="comment">// Setup Loop ranges for primitive/conserved/interpolated variables</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  set_default_nprlists();</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  </div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  <span class="comment">// setup NOGDET list</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  <span class="comment">// defaults</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#ad5ba6b43c072aca55951657f023cbfc3" title="always goes over all conserved">PALLLOOP</a>(pl) <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa30de46d2418926aec7cb4ccf27e394e">nogdetlist</a>[pl]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0e69b8ad1f3786793ba979b298087468" title="This stays naturally, simply consistent with how code evolves conserved quantities.">NOGDETRHO</a>;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  <span class="comment">// details</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa30de46d2418926aec7cb4ccf27e394e">nogdetlist</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a3bf4402b9e2ae88e4462c3689f5d22b8">RHO</a>] =<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0e69b8ad1f3786793ba979b298087468" title="This stays naturally, simply consistent with how code evolves conserved quantities.">NOGDETRHO</a>;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa30de46d2418926aec7cb4ccf27e394e">nogdetlist</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a94db1ec6a412a83becda73ca2a5db0bf">UU</a>] =<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aa3c72f94399b241b821d2a0594c5c53f">NOGDETU0</a>;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa30de46d2418926aec7cb4ccf27e394e">nogdetlist</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aacb3eec923047fe7ddf3eda070c600d9">U1</a>] =<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a73b295b3ffab6a57edee3087058ae5fd">NOGDETU1</a>;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa30de46d2418926aec7cb4ccf27e394e">nogdetlist</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ae907e773ef038f3fc0c2ad5de0cb0f07">U2</a>] =<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0579bc72e23b5227a22bee41db125468">NOGDETU2</a>;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa30de46d2418926aec7cb4ccf27e394e">nogdetlist</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8de9104f1fffa59f057b214d74c5cfea">U3</a>] =<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a153488f2d52de51e06a70f388b4f7167">NOGDETU3</a>;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa30de46d2418926aec7cb4ccf27e394e">nogdetlist</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a7b21d6a6a4573b4997b1f04b01cd4efb">B1</a>] =<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#acd8b4c9899cba6ecfcaf9292cf9db17a">NOGDETB1</a>;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa30de46d2418926aec7cb4ccf27e394e">nogdetlist</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a6945d50f798e1fde624d70c74457090e">B2</a>] =<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#af0e822c28f1b4f38270e64317e2c7590">NOGDETB2</a>;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa30de46d2418926aec7cb4ccf27e394e">nogdetlist</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ae6ac0edb1e2c9c7672ab9488d8b65be9">B3</a>] =<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0cba504dc38c151c3be0ef3bb6f4c396">NOGDETB3</a>;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#a99ba7daf58b283bc831b8f507f5873a4" title="#define EOMTYPE EOMCOLDGRMHD">EOMRADTYPE</a>!=<a class="code" href="../../d4/d96/global_8nondepmnemonics_8rad_8h.html#a993e29ef4139116d822d89bccb92180d" title="radiation equations of motion">EOMRADNONE</a>){</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa30de46d2418926aec7cb4ccf27e394e">nogdetlist</a>[URAD0] =<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a565d681bf10c0291b4f588e206e66541">NOGDETURAD0</a>;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa30de46d2418926aec7cb4ccf27e394e">nogdetlist</a>[URAD1] =<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8bdc310f97e7ae4361e4babef5c970fe">NOGDETURAD1</a>;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa30de46d2418926aec7cb4ccf27e394e">nogdetlist</a>[URAD2] =<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a73bc176c9488c0db0f6acfccc002035c">NOGDETURAD2</a>;</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa30de46d2418926aec7cb4ccf27e394e">nogdetlist</a>[URAD3] =<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a73322acd243960f97deaac8ffc296d99">NOGDETURAD3</a>;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;  }</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#abf90251d9bf1eb0bf77da8cd95bb79a9" title="#define WHICHEOS MIGNONE define WHICHEOS GRBPWF99 define WHICHEOS KAZFULL">DOENTROPY</a>) <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa30de46d2418926aec7cb4ccf27e394e">nogdetlist</a>[ENTROPY] =<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a233db8f9713f8361db20e94f11b9366b">NOGDETENTROPY</a>;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  <span class="keywordflow">if</span>(YFL1&gt;=0) <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa30de46d2418926aec7cb4ccf27e394e">nogdetlist</a>[YFL1] =<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a682fece79829eeb02ec956e5aa4fdfa3">NOGDETYFL1</a>;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  <span class="keywordflow">if</span>(YFL2&gt;=0) <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa30de46d2418926aec7cb4ccf27e394e">nogdetlist</a>[YFL2] =<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ac07b1738f509c465fc59e296074773bb">NOGDETYFL2</a>;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  <span class="keywordflow">if</span>(YFL3&gt;=0) <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa30de46d2418926aec7cb4ccf27e394e">nogdetlist</a>[YFL3] =<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a3b39b7388dcb7e1493fe5089a87c82bd">NOGDETYFL3</a>;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  <span class="keywordflow">if</span>(YFL4&gt;=0) <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa30de46d2418926aec7cb4ccf27e394e">nogdetlist</a>[YFL4] =<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a930ca5c1cef7dbfe6af404224801719b">NOGDETYFL4</a>;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  <span class="keywordflow">if</span>(YFL5&gt;=0) <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa30de46d2418926aec7cb4ccf27e394e">nogdetlist</a>[YFL5] =<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a4d7266ea4c31701cb14894a5b6a50ffd">NOGDETYFL5</a>;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;  <span class="keywordflow">if</span>(YL&gt;=0) <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa30de46d2418926aec7cb4ccf27e394e">nogdetlist</a>[YL] =<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ac8b222e2626652d07c114000b8b680f2">NOGDETYL</a>;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  <span class="keywordflow">if</span>(YNU&gt;=0) <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa30de46d2418926aec7cb4ccf27e394e">nogdetlist</a>[YNU] =<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a843637ef1afe63e14baac00e988f059d">NOGDETYNU</a>;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa2010d23a21177641277f5119a2705c7">advancepassnumber</a>=-1; <span class="comment">// by default assume all things done (should only matter if SPLITNPR==1 and debugging it)</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  <span class="comment">// still need to avoid conserved+flux calculations for other PL&#39;s in phys.c</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  <span class="comment">// below 2 now determined at command line.  See init_MPI_GRMHD() in init_mpi.c (myargs and init_MPI).</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  <span class="comment">//  RESTARTMODE=0;// whether restarting from rdump or not (0=no, 1=yes)</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  <span class="comment">//WHICHFILE=0; // see diag.c for dump_cnt and image_cnt starts</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  <span class="comment">// user defined parameter</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  restartonfail=0; <span class="comment">// whether we are restarting on failure or not and want special diagnostics</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a36504a6b465c1e2c9c3af7298c8e3ef1">specialstep</a>=0; <span class="comment">// normal step assumed</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a1ede5cdf31ba2dd54327d558e786f7d6">didstorepositiondata</a>=0; <span class="comment">// assume haven&#39;t stored position data (yet)</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3ac70e0bc8f102cca400733fb37c3f54" title="end changes after ...">horizoni</a>=-200;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a58b9fa3befcf1cde8e143386173d5960">horizoncpupos1</a>=-1;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;  <span class="comment">// other global flags</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#ad4ec5aab9b62fbbe9b8fc2d8ac0a5989">failed</a>=0;</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a01e7281889728e2ec41a4159da19ac69">global_preinterpolate</a>=0;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#a3d14480f30d39eff4e51ae8bc93df56f" title="whether we use ultimately precise inversion or &quot;workable&quot; inversion precision (see utoprim&#39;s for ho...">WHICHVEL</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a22de13ceb1d46983868c7f22fbd0201a">VEL3</a>){</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#acbbbf660c55c527d9a2c9863d66500be">jonchecks</a>=1; <span class="comment">// whether to include jon&#39;s checks to make sure u^t real and some rho/u limits throughout code</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#acbbbf660c55c527d9a2c9863d66500be">jonchecks</a>=0;</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  }</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  <span class="keywordflow">else</span> <a class="code" href="../../d8/d5b/defs_8general_8h.html#acbbbf660c55c527d9a2c9863d66500be">jonchecks</a>=0; <span class="comment">// not relevant</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  <span class="comment">// choice// GODMARK: not convenient location, but needed for init_MPI_GRMHD()</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  <a class="code" href="../../dd/d46/mpidefs_8h.html#ab6ed54cec8c2547f4280b86f34426cb5" title="for only grmhd code">periodicx1</a>=0;</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  <a class="code" href="../../dd/d46/mpidefs_8h.html#a504b3e0d6a16870176bb4555e95642c7">periodicx2</a>=0;</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  <a class="code" href="../../dd/d46/mpidefs_8h.html#a5e966c43d71ea8ef3cd3fb6e5e4c00d8">periodicx3</a>=0;<span class="comment">// GODMARK: periodic in \phi for 3D spherical polar</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a089706c546fc30d0b60ae9d6eb0a89ea">dofull2pi</a>=1;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  <span class="keywordflow">if</span>(USEMPI&amp;&amp;<a class="code" href="../../dc/dd8/mympi_8definit_8h.html#a125da10d4f20cf53facb2a408fdc3f52">USEROMIO</a>){</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a04767aafce2d594a681b4d39134050c8">binaryoutput</a>=<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#aeda769b56bd2fdb9ee4b9db524f753b5">MIXEDOUTPUT</a>; <span class="comment">// choice: mixed or binary</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#aeea3c92b1852b95e378a0256e0d7d9d6">sortedoutput</a>=<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#ac0732fd72573f5fa69a9ef066ef63f65">SORTED</a>; <span class="comment">// no choice</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  }</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    <span class="comment">// choice</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <span class="comment">//    binaryoutput=TEXTOUTPUT;</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a04767aafce2d594a681b4d39134050c8">binaryoutput</a>=<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#aeda769b56bd2fdb9ee4b9db524f753b5">MIXEDOUTPUT</a>; <span class="comment">// choice: mixed or binary</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#aeea3c92b1852b95e378a0256e0d7d9d6">sortedoutput</a>=<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#ac0732fd72573f5fa69a9ef066ef63f65">SORTED</a>;</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  }</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  <span class="comment">// Initialize global EOS pointers and initial repeated array values (originally static)</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="comment"></span>  initeos_eomtype();</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;}</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="keywordtype">void</span> set_defaults_performance_checks_prepreinit(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;{</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  <span class="comment">// whether to log steps</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  <span class="comment">// log the time step as per NDTCCHECK</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#af0b9bb78fa09703f2b0563601335f4e5">DOLOGSTEP</a>=1 ;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  <span class="comment">// log the performance as per NZCCHECK</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa692e3b1b0689297e24b7b6cc14cd95a">DOLOGPERF</a>=1;</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#aedd52e2d974e234694cf4f528766ba03">CHECKCONT</a>=1; <span class="comment">// 1: check if user wants to continue run 0: don&#39;t</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  <span class="comment">// initial guess for how often to check time per timestep</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#afe7dfc7ebb1b60da8c80dd4848958098">NTIMECHECK</a>=1000;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  <span class="comment">// how often in steps to output step/dt/t data (controlled by above if above are nonzero, else use below numbers)</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;  <span class="comment">// MARK 100 100 20 500</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;  <span class="comment">// MARK 10 10 1 100 for 1024x1024 vortex</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;  <span class="comment">// MARK 1D bondi: 10000 10000 1000 20000</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;  <span class="comment">// MARK 2D MHD Tori128128: 500 500 10 1000</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#ad205d3a87a889b9b03ff73de0cee1770">NDTCCHECK</a>=100;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  <span class="comment">// how often in steps to check speed in zonecycles/sec</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a24e9905f6dba152c3b59fdc01747bc83">NZCCHECK</a>=100;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a612c5c2d5f9671a197d4c4f7991a3c5d">NDTDOTCCHECK</a>=10;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a2dcb9f7eda30f4b112b56660473d0ed7">NGOCHECK</a>=1000; <span class="comment">// how often in steps to check the go.go file to see if to continue running</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a00e47c139bb0e47b72aa05aafc257da9">NDTPERFDUMPCHECK</a>=1000;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;}</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="keywordtype">void</span> set_defaults_performance_checks_preinit(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;{</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  <span class="comment">// must come after MPI is initialized</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> secsperdump;</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  </div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;  <span class="comment">// how often in REAL *seconds* to dump 0_logstep.out file (unless 0, which then uses below)</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#aeef202f78dbdfe15dda98e7ea726c7cf">DTstep</a>=10.0;</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#af612f289b9e49024cb60bcd9120d0964">DTstepdot</a>=1.0;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a882b33430fdc8873023b2c4d2f3edfe2">DTperf</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#aeef202f78dbdfe15dda98e7ea726c7cf">DTstep</a>;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa595a7f82cd730f67df3dd0a37aa6088">DTgocheck</a>=30.0;</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a5ada116caf9484af544ad3190d499071">DTtimecheck</a>=60.0;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;  <span class="comment">// below assumes shared disk space at 20MB/sec access</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;  secsperdump=(100.0*8.0*(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>)(<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1]*<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[2]*<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[3])/(20.0*1024.0*1024.0*1024.0));</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a2feec2650b1abafa56368d693bd81c61">DTperfdump</a>=3.0*secsperdump; <span class="comment">// factor of 3 longer assumed so dumps don&#39;t hurt performance</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  <span class="comment">// number of wallseconds per perf run(see: main.c)</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3227cc255d553bfb41ee26b2cd8e252f">PERFWALLTIME</a>=30.0;</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  <span class="comment">// 1 linux cluster cpu</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  <span class="comment">// ZCPSESTIMATE (50000)</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  <span class="comment">// 25 linux cluster cpu(550Mhz Xeon&#39;s connected via Myrinet)</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;  <span class="comment">// ZCPSESTIMATE (1250000)</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  <span class="comment">// 36 linux cluster cpu(550Mhz Xeon&#39;s connected via Myrinet)</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  <span class="comment">// ZCPSESTIMATE (1800000)</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  <span class="comment">// 64 linux cluster cpu(550Mhz Xeon&#39;s connected via Myrinet)</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;  <span class="comment">// ZCPSESTIMATE (3200000)</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;  <span class="comment">// 121 linux cluster cpu(550Mhz Xeon&#39;s connected via Myrinet)</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;  <span class="comment">// ZCPSESTIMATE (6050000)</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;  <span class="comment">// photon MHD for one cpu alone</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;  <span class="comment">// ZCPSESTIMATE (265000)</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;  <span class="comment">// photon HD 1 cpu</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;  <span class="comment">// ZCPSESTIMATE (400000)</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;  <span class="comment">// rainman MHD for one cpu alone</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;  <span class="comment">// ZCPSESTIMATE (220000)</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;  <span class="comment">// ZCPSESTIMATE (100000)</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;  <span class="comment">// sgi r10000 for one cpu alone(195sMhz)</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  <span class="comment">// ZCPSESTIMATE (80000)</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;  <span class="comment">// 4cpu mpigm</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;  <span class="comment">// ZCPSESTIMATE (800000)</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;  <span class="comment">// 4cpu r10000</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  <span class="comment">// ZCPSESTIMATE (343000)</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;  <span class="comment">// 9cpu r10000</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  <span class="comment">// ZCPSESTIMATE (745000)</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  <span class="comment">// 16cpu r10000</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  <span class="comment">// ZCPSESTIMATE (1325000)</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  <span class="comment">// 25cpu r10000</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  <span class="comment">// ZCPSESTIMATE (1200000)</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;  <span class="comment">// 36cpu r10000</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;  <span class="comment">// ZCPSESTIMATE (1700000)</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;  <span class="comment">// 49cpu r10000</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  <span class="comment">// ZCPSESTIMATE (4021000)</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  <span class="comment">// 64 r10000&#39;s 64x64 tile</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  <span class="comment">// ZCPSESTIMATE (4309000)</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  <span class="comment">// 121 r10000&#39;s</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  <span class="comment">// ZCPSESTIMATE (10943000)</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  <span class="comment">// 256 r10000&#39;s</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;  <span class="comment">// ZCPSESTIMATE (20000000)</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  <span class="comment">// kerr 2DMHD</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;  <span class="comment">// ZCPSESTIMATE (50000)</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;  <span class="comment">// rainman 2DMHD</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;  <span class="comment">//  ZCPSESTIMATE=(200000);</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;  <span class="comment">// Latest HARM w/ lim=WENO5BND and FLUXCTSTAG on ki-rh42</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;  <span class="comment">//  ZCPSESTIMATE=(5000);</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;  <span class="comment">// Latest HARM w/ lim=PARA and FLUXCTSTAG on ki-rh42</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;  <span class="comment">//  ZCPSESTIMATE=(10000);</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;  <span class="comment">// Latest HARM w/ lim=PARA and FLUXCTSTAG on 1 Orange CPU</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  <span class="comment">//  ZCPSESTIMATE=(7000);</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;  <span class="comment">// Latest HARM w/ lim=WENO5BND and FLUXCTTOTH on 1 Orange CPU</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a7022e616d6e307a7d3b283ca36ffe137">ZCPSESTIMATE</a>=(3200);</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;}</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="keywordtype">void</span> set_file_versionnumbers(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;{</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;  <span class="comment">// file versions numbers(use sm for backwards compat)</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#ad8b82edd3a89075b7a6ae6c8c570841f" title="file version stuff:">PVER</a>= 11;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#af023f0fbb4ce4c226972e64fd44fcb60">GRIDVER</a>= 3; <span class="comment">// 3 is without cotangent</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a34a70d9888c15e2e8afca26571bdfef4">DVER</a>= 1 ;   <span class="comment">// dumps same as for pdumps, adumps</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a0ec6ecc949ff52decebf2562474eb202">FLVER</a>= 2;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a07c300f7d53a781d400684c19453081f">NPVER</a>= 2;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a86e7518b7344b657fc60c2275a354e2c">AVG1DVER</a>= 2;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#aaac6c929b2c3d0dd2bb83847a7291294">AVG2DVER</a>= 2;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a054c0752b210d2e470344aaaa9fdf16d">ENERVER</a>= 7; <span class="comment">// 6 is without c/s mode amp in ener, 7 has new ang mom</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a8aaaca86428f74a3fcc493a80a8d6a59">MODEVER</a>= 2; <span class="comment">// 2 is all vars for 9 modes</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#abd58cd44b4a17673f21e5b817bdfd521">LOSSVER</a>= 7; <span class="comment">// 6 has x3 losses, 5 doesn&#39;t, 7 has new ang mom losses</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a19888954fe0ca7f81810016ecbe360da">SPVER</a>=   1;</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a1b6898364d876de03ebb8ad8d0cc0e29">TSVER</a>=   1;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a94beea79c955f37266b603168dfbca42">LOGDTVER</a>= 1;</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#ad7fb0a61c7cc1858af1cecb700743652">STEPVER</a>= 1;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#ae061d75749214cd7945ab91d046cf1fc">PERFVER</a>= 3;</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#af687e772853ce9ebb41c88692adb40b2">ADVER</a>= <a class="code" href="../../d8/d5b/defs_8general_8h.html#a34a70d9888c15e2e8afca26571bdfef4">DVER</a>;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a0e600e3e6e8a2f8a1e06f8628bb292d3">PDVER</a>= <a class="code" href="../../d8/d5b/defs_8general_8h.html#a34a70d9888c15e2e8afca26571bdfef4">DVER</a>;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a5c1f7e27f88e0aab007ebb3931f54a65">CALCVER</a>= 1;</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a472c1331a6d9289fe6ad532ebcf69eae">FLINEVER</a>= 1;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;  <span class="comment">// type designations for sm automagical read in correct format for similar things</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#adb8b78b00d13b187689aba3b8ea42438">PTYPE</a>=     1; <span class="comment">// global par file</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a184ccc56dd9cebe0b2dfd0220f622983">GRIDTYPE</a>=  2;</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#ad709fc2074ec41362007ae30afe951bd">DTYPE</a>=     3 ;<span class="comment">// dump</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#af77d8523e7bea5a2baf5e2c0b10116bb">FLTYPE</a>=    4; <span class="comment">// floor</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a587709ec62611142a6d38c828f6ef9ab">NPTYPE</a>=    5; <span class="comment">// np</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#ad9d771a9bc8dc03e41140cc14200090b">AVG2DTYPE</a>= 6;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#ab4759eb3139bf49a9c1a44fbb1df7c18">AVG1DTYPE</a>= 7;</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a5d70376e052c596ae4e1e156d8026329">ENERTYPE</a>=  8;</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#afd0ce7cf8fa2eaa97f6efe9c81638b1c">LOSSTYPE</a>=  9;</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a1719eac2e5b3635bad55b4886759cd6d">SPTYPE</a>=    10;</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a02ce24453a0ee55c6ad9a276eca0273a">TSTYPE</a>=    11;</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a02f5992a0b136295c085e1d4e1c2a4a5">LOGDTTYPE</a>= 12 ;</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a620c929e222b684c3c5cd31d5e5aa62b">STEPTYPE</a>=  13;</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a33e1b49955b8b1928e89a8d40343ce53">PERFTYPE</a>=  14;</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#af5fd69871b8f40fac09ae5c9a5f10746">ADTYPE</a>=    15 ;<span class="comment">// same as dump except filename</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#aceca84725c532d7dd8cb28102bab83fe">PDTYPE</a>=    16; <span class="comment">// same as dump except filename</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#ae7e998109fc002df22b9894a4e5077d8">CALCTYPE</a>=  17; <span class="comment">// arbitrary calcs during pp</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a96782eebd21ec088eb66bb95f8dbaf62">FLINETYPE</a>=  18; <span class="comment">// field line during pp</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa872b594a0f63261a3efd45ff11e1fbb">MODETYPE</a>=  19;</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#adcfb62573b212d96f1ded46d7286f276">EXPANDTYPE</a>= 50 ;<span class="comment">// used to signify doing pp expansion</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac078e94431040dcd51717a789e6c78c2">NPCOMPUTETYPE</a>= 33; <span class="comment">// used to signify want to compute np before output</span></div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;}</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;</div>
<div class="line"><a name="l00970"></a><span class="lineno"><a class="code" href="../../de/df8/initbase_8c.html#a47051981241cadc820dd2ee6a039d16e">  970</a></span>&#160;<span class="keywordtype">void</span>  <a class="code" href="../../d8/df4/global_8funcdeclare_8h.html#a47051981241cadc820dd2ee6a039d16e" title="functions for loop stuff">setup_nprlocalist</a>(<span class="keywordtype">int</span> whichprimtype, <span class="keywordtype">int</span> *nprlocalstart, <span class="keywordtype">int</span> *nprlocalend,<span class="keywordtype">int</span> *nprlocallist, <span class="keywordtype">int</span> *numprims)</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;{</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;  <span class="keywordtype">int</span> pl,pliter;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  <span class="comment">// setup primitive loops</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;  <span class="keywordflow">if</span>(whichprimtype==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#adfffac9f0ada9db5f6423d8db6397ad2">ENOPRIMITIVE</a>){</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    *nprlocalstart=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0698381e35c41efe1e8e744c563346ca" title="for choosing range of PLOOPINTERP type arrays">npr2interpstart</a>;</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    *nprlocalend=<a class="code" href="../../d8/d5b/defs_8general_8h.html#ab8d17d77cf16ec7a4448add3fc8710f8">npr2interpend</a>;</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#ae3d8ba1d892944d94ad9f496a3fb3566" title="goes over all/any npr lists for copying one list to another">PMAXNPRLOOP</a>(pl) nprlocallist[pl]=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a647235f9afd0ad17f188ed43fe23997f">npr2interplist</a>[pl];</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    *numprims=NPR2INTERP;</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;  }</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;  <span class="keywordflow">else</span>{ <span class="comment">// NPR type</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    *nprlocalstart=<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa513122b9e25a436a0e98805e46961af" title="OPENMPNOTE: Ensure all pl&#39;s are set as private as required [only npr2interp and npr2notinterp changed...">nprstart</a>;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    *nprlocalend=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a11c2c3ace90a795cd7a910ac0a6256d2">nprend</a>;</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#ae3d8ba1d892944d94ad9f496a3fb3566" title="goes over all/any npr lists for copying one list to another">PMAXNPRLOOP</a>(pl) nprlocallist[pl]=<a class="code" href="../../d8/d5b/defs_8general_8h.html#af637e542453ec23c1a41a1038b223040">nprlist</a>[pl];</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    *numprims=NPR;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;  }</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;}</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;</div>
<div class="line"><a name="l00995"></a><span class="lineno"><a class="code" href="../../de/df8/initbase_8c.html#a1c74eb972a6b27d89248c6f1d702d3bd">  995</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../de/df8/initbase_8c.html#a1c74eb972a6b27d89248c6f1d702d3bd" title="initialize MPI and other things NO computations should be performed here">pre_init</a>(<span class="keywordtype">int</span> *argc, <span class="keywordtype">char</span> **argv[])</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;{</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;  <span class="keywordtype">int</span> ii;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;  <span class="keywordtype">int</span> dir,pl,pliter,sc,fl,floor,enerregion;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;  <span class="keywordtype">int</span> jj;</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;  <span class="keywordtype">int</span> tscale;</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;  <span class="keywordtype">int</span> dissloop;</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#ad21ff679aac3fe28202c6d592eafd3e6">i</a>,<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>,k;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;  <span class="keyword">extern</span> <span class="keywordtype">void</span> set_arrays(<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;  <span class="keywordtype">int</span> checki;</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;  <span class="keywordtype">int</span> faketimeorder,fakenumtimeorders;</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;  <span class="comment">// must do in MPI mode or not MPI mode  </span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;  init_MPI_GRMHD(argc, argv);</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;  <span class="comment">// set default performance parameters</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;  set_defaults_performance_checks_preinit();</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="preprocessor">#if(USEMPI)</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="preprocessor"></span>  mpi_set_arrays();</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;  <span class="comment">// check starting go files (must be after init_mpi so all files know)</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;  gocheck(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8b8de0860375b660802310771f89e7f3" title="for timing">STARTTIME</a>);</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  report_systeminfo(stderr);</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ab936051f5aaca44c6c3c41dee0d19c36">log_file</a>) report_systeminfo(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ab936051f5aaca44c6c3c41dee0d19c36">log_file</a>);</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;  <span class="keywordflow">if</span>(myid==0&amp;&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa5d0f5183b267927d3eb00692224be5b">logfull_file</a>) report_systeminfo(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa5d0f5183b267927d3eb00692224be5b">logfull_file</a>);</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  <span class="comment">// setup files for writing and reading (must come after init_MPI_GRMHD())</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;  makedirs();</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;  <span class="comment">// init arrays</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;  set_arrays();</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;  <span class="comment">// set default variable to dump (must come before init() where if failed or other reasons can dump output)</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;  <a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(udump) = <a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(unewglobal);</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;  <span class="comment">//  GLOBALPOINT(ubound) = GLOBALPOINT(unewglobal);</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;  <a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pdump) = <a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pglobal);</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;  <a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pstagdump) = <a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pstagglobal);</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;  <a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(Bhatdump) = <a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(Bhatglobal);</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;  <a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(vpotarraydump) = <a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(vpotarrayglobal);</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;  <a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pl_ctdump) = <a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(gp_l);</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;  <a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pr_ctdump) = <a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(gp_r);</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;  init_dumps();</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;  </div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;  <span class="comment">// compute default enerregion/section information and initialize ENERREGIONLOOP()</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;  <span class="comment">// initial call is reason why (1)</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;  faketimeorder=-1;</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;  fakenumtimeorders=-1;</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;  recompute_fluxpositions(1,faketimeorder,fakenumtimeorders,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a1a1088d87617078680f1fd0f0d707384">nstep</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>);</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;  <span class="comment">// must go here b4 restart if restarting</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a2eb6e271008c49cc3feaa64c6eea2ddb" title="loop over ener/flux regions">ENERREGIONLOOP</a>(enerregion){</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    <span class="comment">// used for each region, related to global quantities</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    <span class="comment">// no need to initialize _tot quantities, they are overwritten during MPI sum in diag.c</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#aebda2a7dfd8109bff10160f9bf2993fa">fladd</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a6707f24b846a9a6236e3f6b2b64e7e82" title="these quantities contain diagnostics all these require writing to restart file other _tot quantities ...">fladdreg</a>[enerregion];</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#af56ce3c03a54f45dd2230f39521a1489">fladdterms</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#acd071ad3c75fd969b717fc8872aa70c4">fladdtermsreg</a>[enerregion];</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#abf96720f4175a88587273eff6bd609e9">U_init</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a6c600198e62182b798fabbc064dad2d3">Ureg_init</a>[enerregion];</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3db95be8997404ffedeec87bbacc78c4">pcum</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2fee8f15a2bd11178d308d2d6c8acc1b">pcumreg</a>[enerregion];</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a8de8f5aa2639ff085d3aae86a0ab3d74">pdot</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a23cf644ed9f84bfe915ec4e8fe5e48c8">pdotreg</a>[enerregion];</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a08c6cad0da4b86c3230016fcae3a5652">pdotterms</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#afdad79843302d351975cd4f60e86351e">pdottermsreg</a>[enerregion];</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ae8fccff72233de8bd53983760c414795">sourceaddterms</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a4493c5cbc76f78da7e95a5b87f9bf6f6">sourceaddtermsreg</a>[enerregion];</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a9216a94c4f02bd14cdf02129b8d7b6f2">sourceadd</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#abc8a54a29a758e02e4eabaf374bbdfbd">sourceaddreg</a>[enerregion];</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a169f58cb5a306eec56593fa30f25d28d">diss</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a33837b5474325908836b24ab40fed5b6">dissreg</a>[enerregion];</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#af1c67086436007e897bccc458390886f" title="PLOOP controls looping over conserved or primitive -type quantities except during interpolation or ot...">PLOOP</a>(pliter,pl){</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#aebda2a7dfd8109bff10160f9bf2993fa">fladd</a>[pl] = 0;</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;      <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#aecfc572a5344bcf7fa1a22b51db76b71" title="loop over fair/floor types">FLOORLOOP</a>(floor) <a class="code" href="../../d8/d5b/defs_8general_8h.html#af56ce3c03a54f45dd2230f39521a1489">fladdterms</a>[floor][pl]=0;</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#abf96720f4175a88587273eff6bd609e9">U_init</a>[pl] = 0;</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;      <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#af276566d52b9239d67b094c949e15889" title="loop over directions">DIRLOOP</a>(dir){</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;        <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3db95be8997404ffedeec87bbacc78c4">pcum</a>[dir][pl]=0;</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;        <a class="code" href="../../d8/d5b/defs_8general_8h.html#a8de8f5aa2639ff085d3aae86a0ab3d74">pdot</a>[dir][pl]=0;</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;        <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a32e091d76a116b4de3b9263bff415fd1" title="loop over fluxterms">FLLOOP</a>(fl) <a class="code" href="../../d8/d5b/defs_8general_8h.html#a08c6cad0da4b86c3230016fcae3a5652">pdotterms</a>[dir][fl][pl]=0;</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;        <span class="keywordflow">if</span>(enerregion==0) <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a32e091d76a116b4de3b9263bff415fd1" title="loop over fluxterms">FLLOOP</a>(fl) <a class="code" href="../../d8/d5b/defs_8general_8h.html#aff071475bb57622298e44ee438fa0898">pdottermsjet2</a>[dir][fl][pl]=0; <span class="comment">// needed for other not-flux cpus!</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;      }</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a9216a94c4f02bd14cdf02129b8d7b6f2">sourceadd</a>[pl] = 0;</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;      <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a2da8b12fca78064531b9b64e5699e4fc" title="loop over ALL sources (including geometry)">SCLOOP</a>(sc) <a class="code" href="../../d8/d5b/defs_8general_8h.html#ae8fccff72233de8bd53983760c414795">sourceaddterms</a>[sc][pl] = 0;</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    }</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    <span class="keywordflow">for</span>(dissloop=0;dissloop&lt;<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#adde832aa14a494487d47d4fed8268966" title="totals:">NUMDISSVERSIONS</a>;dissloop++)  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a169f58cb5a306eec56593fa30f25d28d">diss</a>[dissloop] = 0;</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#a6c2751c5217b428c5f5faf66a08e2d90" title="0: don&#39;t do calculation 1: do">DOLUMVSR</a>) <span class="keywordflow">if</span>(enerregion==0) <span class="keywordflow">for</span>(ii=0;ii&lt;<a class="code" href="../../dd/d46/mpidefs_8h.html#a849af7562e98534cd4ea5764f5187bbd">ncpux1</a>*<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>;ii++) <a class="code" href="../../d8/d5b/defs_8general_8h.html#a75d4d9f688220e74452609859774e5a0">lumvsr</a>[ii]=0;</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#affb54fad9620541e1fcb17f854af9bfe" title="see diag_source()">DODISSVSR</a>) <span class="keywordflow">if</span>(enerregion==0) <span class="keywordflow">for</span>(ii=0;ii&lt;<a class="code" href="../../dd/d46/mpidefs_8h.html#a849af7562e98534cd4ea5764f5187bbd">ncpux1</a>*<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>;ii++) <span class="keywordflow">for</span>(dissloop=0;dissloop&lt;<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#adde832aa14a494487d47d4fed8268966" title="totals:">NUMDISSVERSIONS</a>;dissloop++) <a class="code" href="../../d8/d5b/defs_8general_8h.html#a57d77cd626bfc2578b551b63f7640736">dissvsr</a>[dissloop][ii]=0;</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#af35efc27e405b7c3e2c95df8f7559a07" title="#define WHICHENTROPYEVOLVE EVOLVEFULLENTROPY">DOSELFGRAVVSR</a>) <span class="keywordflow">if</span>(enerregion==0) <span class="keywordflow">for</span>(ii=0;ii&lt;<a class="code" href="../../dd/d46/mpidefs_8h.html#a849af7562e98534cd4ea5764f5187bbd">ncpux1</a>*<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>;ii++) <a class="code" href="../../d8/d5b/defs_8general_8h.html#adc06473b0cad9b3116d4833df73ee995">dMvsr</a>[ii]=0;</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    <span class="comment">// below quantities have been subsumed into own full enerregion</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    <span class="comment">//    if(DOEVOLVEMETRIC) if(enerregion==0) PLOOP(pliter,pl){</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    <span class="comment">//  horizonflux[pl]=0;</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    <span class="comment">//  horizoncum[pl]=0;</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    <span class="comment">// }</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;  }</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;  </div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;  <span class="comment">// start counter</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;  <span class="comment">// full loop since user may choose to count something in boundary zones</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;  <span class="keywordtype">int</span> indexfinalstep;</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#aefc47346bd5140a39b6d744385796e56" title="0: don&#39;t output debug dump file or ener file(ener is based on dump counts) 1: do">DODEBUG</a>) <a class="code" href="../../da/db2/global_8loops_8manypoints_8h.html#a615c1d48363ecaa0866f1c0fd337b780">FULLLOOP</a> <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a109c0007f7542c45c42b16a82239df74">FAILFLOORLOOP</a>(indexfinalstep,tscale,floor) <a class="code" href="../../df/d1c/global_8storage_8h.html#a4ca176a81d2229ced28a5c53ebeacc06">GLOBALMACP0A3</a>(failfloorcount,i,j,k,indexfinalstep,tscale,floor)=0;</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;  <span class="comment">// start du diag_fixup() sum</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;  <span class="comment">// full loop since user may choose to count something in boundary zones</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#a926e8df3554baffbda6ddeb65ded6feb">DOFLOORDIAG</a>){</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <a class="code" href="../../da/db2/global_8loops_8manypoints_8h.html#a615c1d48363ecaa0866f1c0fd337b780">FULLLOOP</a>{</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;      <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#ad5ba6b43c072aca55951657f023cbfc3" title="always goes over all conserved">PALLLOOP</a>(pl) GLOBALMACP0A1(failfloordu,i,j,k,pl)=0.0;</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    }</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;  }</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="preprocessor">#if(CALCFARADAYANDCURRENTS)</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="preprocessor"></span>  <span class="comment">// zero out jcon since outer boundaries not set ever since j^\mu involves spatial derivatives that don&#39;t exist outside a certain point</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;  <span class="keywordflow">for</span>(pl=0;pl&lt;<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>;pl++) <a class="code" href="../../da/db2/global_8loops_8manypoints_8h.html#a615c1d48363ecaa0866f1c0fd337b780">FULLLOOP</a> GLOBALMACP0A1(jcon,i,j,k,pl)=0.0;</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;  </div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;}</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;</div>
<div class="line"><a name="l01132"></a><span class="lineno"><a class="code" href="../../de/df8/initbase_8c.html#a989e8f627ab06fa34fb3a3abf4f6bffe"> 1132</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../de/df8/initbase_8c.html#a989e8f627ab06fa34fb3a3abf4f6bffe" title="init default defcoord">init_defdefcoord</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;{</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;  <span class="comment">// set coordinates</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a>=<a class="code" href="../../d7/d56/coord_8h.html#a99c6ba3b86430e6eb5a179c57fd58070">LOGRSINTH</a>;</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;}</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;</div>
<div class="line"><a name="l01141"></a><span class="lineno"><a class="code" href="../../de/df8/initbase_8c.html#a213950b7c45e18f5966a83c116142a1c"> 1141</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../de/df8/initbase_8c.html#a213950b7c45e18f5966a83c116142a1c" title="init default grid">init_defgrid</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;{</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;  <span class="comment">// sets metric</span></div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;  <span class="comment">//  a=0.0;</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;  <span class="comment">// sets parameters of coordinates, default changes</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a> = 0.0;</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a> = 0.98 * <a class="code" href="../../d8/d5b/defs_8general_8h.html#a20e81ef2343c6d8db701c6613cbcd279">Rhor</a>;</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a> = 40.;</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a93f06eb0b7c274f722a7e09d4861a941">hslope</a> = 0.3;</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;  <span class="comment">// default black hole parameters, and so length is in GMBH/c^2 and time in GMBH/c^3</span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa73cf2d397cae726436e08d2c891bdb0">a</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0263710807f02d8418758c4e3e46bc4e">a0</a>;</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a1fb64169459d57727a61a72b6e01ced5">MBH</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a1c7a46e6336f8a47446a7f7d71e29d4d">MBH0</a>;</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a60c2aa47ffa41453bf4afb2c19ac2a4e">QBH</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#ac2458c82775ea2fbba5cd1a289b7779d">QBH0</a>;</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a2f09f0f07c81c40846f158024b125ed0">EP3</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa2c1ce9d27f3d7c1b1d9eeb4d89d3401">EP30</a>;</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a8e477e3a4df3a35b6685963eb797dbef">THETAROTMETRIC</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a5bd32ec33416c5c0212739cbb02ed2f4">THETAROT0</a>;</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac1ef268f75fd0b1d21d07ca1f743db23">THETAROTPRIMITIVES</a>=0.0; <span class="comment">// assume by default is zero</span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;}</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;</div>
<div class="line"><a name="l01164"></a><span class="lineno"><a class="code" href="../../de/df8/initbase_8c.html#a0904e3bc54f4a1fafe4152bfac071111"> 1164</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../de/df8/initbase_8c.html#a0904e3bc54f4a1fafe4152bfac071111" title="init default global paramters">init_defglobal</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;{</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#ad21ff679aac3fe28202c6d592eafd3e6">i</a>;</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;  <span class="keywordtype">int</span> pl,pliter;</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;  <span class="keywordtype">int</span> dtloop;</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;<span class="preprocessor">#if(PRODUCTION==0)</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;<span class="preprocessor"></span>  debugfail=2; <span class="comment">// CHANGINGMARK</span></div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;<span class="preprocessor"></span>  debugfail=0; <span class="comment">// no messages in production -- assumes all utoprim-like failures need not be debugged</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;<span class="preprocessor"></span>  <span class="comment">// whether to show debug into on failures.  Desirable to turn off if don&#39;t care and just want code to burn away using given hacks/kludges</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;  <span class="comment">// 0: no messages</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;  <span class="comment">// 1: critical messages</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;  <span class="comment">// 2: all failure messages</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;  <span class="comment">// included in rdump</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a8685a7babea647420ac0741a6859f867">defcon</a> = 1.0;</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;  <span class="comment">/* maximum increase in timestep */</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a73deb5caf870e00d9b50f194357000dd">SAFE</a>=1.3;</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a36f0e01e4b2d3274b34702da16fbce66" title="float value prefactor for dissipation term in flux calculations (see fluxcompute.c)">FLUXDISSIPATION</a>=(1.0); <span class="comment">// normally full flux dissipation.</span></div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a34256ac1b9f15cac78b574deef3397c1">EMFDISSIPATION</a>=(1.0); <span class="comment">// normally full emf dissipation.</span></div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a1a1088d87617078680f1fd0f0d707384">nstep</a> = <a class="code" href="../../d8/d5b/defs_8general_8h.html#a0b92e4d6197989f0f9b0609c8615a46f">realnstep</a> = 0;</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a9738619f6b1cbb93697432a12d122133" title="global flags">whichrestart</a> = 0;</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;  restartsteps[0] = 0;</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;  restartsteps[1] = 0;</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#aecfe591bfb11fe6fab1df27c05cb568d">whichfake</a> = <a class="code" href="../../d8/d5b/defs_8general_8h.html#a9738619f6b1cbb93697432a12d122133" title="global flags">whichrestart</a>;</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3fb3b56bd826fc63d53225ee4b2d8353">fakesteps</a>[0] = restartsteps[0];</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3fb3b56bd826fc63d53225ee4b2d8353">fakesteps</a>[1] = restartsteps[1];</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#ad4ec5aab9b62fbbe9b8fc2d8ac0a5989">failed</a> = 0;</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#ab95415a19b94c9c8b05a1a1d1be4ce40">cour</a> = 0.5; <span class="comment">// see init.tools.c for why &gt;0.5 should *not* be used.</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a6ae5007e4186b2c5f4a41a3176683959">doevolvemetricsubsteps</a>=0; <span class="comment">// default is to evolve on long steps (only applicable if DOEVOLVEMETRIC==1 &amp;&amp; EVOLVEMETRICSUBSTEP==2)</span></div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1aa0d402c34ec50b2da9371b5f69ce4">gravityskipstep</a>=0; <span class="comment">// default is no skipping</span></div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#ae58178ca76ba1f6fd135877e28ca1409">gravitydtglobal</a> = <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a38eb76aa0a9a1bb1dac30c75be4a05b6">BIG</a>;</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a0a7150593e8f78afd7a91cfb19edab08">sourcedtglobal</a>  = <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a38eb76aa0a9a1bb1dac30c75be4a05b6">BIG</a>;</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a0e73706eb0db019d8fa67c66f41d93d6">wavedtglobal</a>    = <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a38eb76aa0a9a1bb1dac30c75be4a05b6">BIG</a>;</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;  <span class="comment">//  avgscheme=WENO5BND;</span></div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#acb6f71700ed482e84b69ee6bec92c303">avgscheme</a>[1]=<a class="code" href="../../d8/d5b/defs_8general_8h.html#acb6f71700ed482e84b69ee6bec92c303">avgscheme</a>[2]=<a class="code" href="../../d8/d5b/defs_8general_8h.html#acb6f71700ed482e84b69ee6bec92c303">avgscheme</a>[3]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aecdd356ed1a28e3325b6608f353cdc8f" title="ordered from most diffusive to least diffusive, so can start high and go down if needed 0 should be r...">DONOR</a>;</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;  </div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#ad5ba6b43c072aca55951657f023cbfc3" title="always goes over all conserved">PALLLOOP</a>(pl) <a class="code" href="../../d8/d5b/defs_8general_8h.html#a13fd1bc27b6fdc0978d4cbc7cd9bdaec">do_transverse_flux_integration</a>[pl] = 1;</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#ad5ba6b43c072aca55951657f023cbfc3" title="always goes over all conserved">PALLLOOP</a>(pl) <a class="code" href="../../d8/d5b/defs_8general_8h.html#a619bd249bee29e34eb58716b9b88dc8a">do_source_integration</a>[pl] = 1;</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#ad5ba6b43c072aca55951657f023cbfc3" title="always goes over all conserved">PALLLOOP</a>(pl) <a class="code" href="../../d8/d5b/defs_8general_8h.html#a42a3e0ccdd6805791cf169d439d305d6">do_conserved_integration</a>[pl] = 1;</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a618d1d6042e7d435e9439a0bbd7a9048">INVERTFROMAVERAGEIFFAILED</a> = 1;</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a0d5e1b767182dfc4e2a3f89a9173d1ef">LIMIT_AC_PRIM_FRAC_CHANGE</a> = 1;</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a43991f234455e5f1169b75f14dede420">MAX_AC_PRIM_FRAC_CHANGE</a> = 0.1;</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#aeba423594eef8c67de9f06010b7fed5e">LIMIT_AC_FRAC_CHANGE</a> = 1;</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#aecc5caf8e100de1cd41a733def1f83fb">MAX_AC_FRAC_CHANGE</a> = 0.1;</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a9efbdb319435873a6f7afe3f8e816c8d">PARAMODWENO</a>=0;</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#ad5c8369abdf1833b4afc10d11d52b537">dofluxreconevolvepointfield</a>=1;</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a71b7c970651a395e2500645e74862abc">DOEVOLVERHO</a>){</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    <span class="comment">//lim = WENO5FLAT;</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    <span class="comment">//lim = WENO5BND;</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    <span class="comment">//  lim = WENO3;</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    <span class="comment">//lim = DONOR;</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    <span class="comment">//lim = MINM;</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    <span class="comment">//  lim = PARA;</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    <span class="comment">//lim = MC;</span></div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a817404fd8a61abc2300c378e1eb2d122">lim</a>[1]=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a817404fd8a61abc2300c378e1eb2d122">lim</a>[2]=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a817404fd8a61abc2300c378e1eb2d122">lim</a>[3]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a71d9e511e7e302cd831e83581219e70d">MC</a>;</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    <span class="comment">//lim = PARA;</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    <span class="comment">//  lim = PARAFLAT;</span></div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    <span class="comment">//lim = MC;</span></div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ae202d8b69a0ef3f07651368c3de9ca25">TIMEORDER</a>=4;</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a10228b0cb639e1d94eded72900312334">TIMETYPE</a>=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a56de233d8b42babd780f075b155863fa">TIMEEXPLICIT</a>;</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    <span class="comment">// whether/which ENO used to interpolate fluxes</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a55732148d2616d6d1f5d2abbe8710850">DOENOFLUX</a> = <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ac634a307561f486f9df8ba8a67c21c19">ENOFINITEVOLUME</a>;</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    <span class="comment">//DOENOFLUX= NOENOFLUX;</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    <span class="comment">//DOENOFLUX=ENOFLUXRECON;</span></div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    <span class="comment">// PALLLOOP(pl) fluxmethod[pl]=MUSTAFLUX;</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    <span class="comment">//PALLLOOP(pl) fluxmethod[pl]=FORCEFLUX;</span></div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#ad5ba6b43c072aca55951657f023cbfc3" title="always goes over all conserved">PALLLOOP</a>(pl) <a class="code" href="../../d8/d5b/defs_8general_8h.html#a6b32259475937e434b03862c64fb86a3">fluxmethod</a>[pl]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a9961b06ca0e8af348eeb5595c5965902">HLLFLUX</a>;</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    <span class="comment">//PALLLOOP(pl) fluxmethod[pl]=HLLLAXF1FLUX;</span></div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    <span class="comment">//PALLLOOP(pl) fluxmethod[pl]=LAXFFLUX;</span></div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a11c4e99e1493d0c1914ad1ab313ea472">FLUXB</a> = <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a5014e44c6e710d8827ef79dd18abe6ad">FLUXCTTOTH</a>;</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a538f4ebe3434f76ec67690f0651b53e7">UTOPRIMVERSION</a>=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#abd3dcef411a08060eddd9a17eeb655c5" title="#define FLUXB FLUXCTTOTH 0: HLL 1: FLUXCT TOTH version (toth 2000 eq.">UTOPRIM5D1</a>;  <span class="comment">//UTOPRIM2DFINAL;</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    <span class="comment">//UTOPRIMVERSION=UTOPRIM5D2;</span></div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    <span class="comment">//  UTOPRIMVERSION=UTOPRIM2DFINAL;</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;  }</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#a87e5572748e4cc27373e50bd78e6f2e8">EOMTYPE</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a6f6094bc467dc61f9490ad7e1de63580">EOMFFDE</a>||<a class="code" href="../../da/d3e/definit_8h.html#a87e5572748e4cc27373e50bd78e6f2e8">EOMTYPE</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a30a753538ac3bf4801ac123a37dfcc57">EOMFFDE2</a>){</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    <span class="comment">// PARA and TO=4 and HLL not trustable in FFDE so far</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a817404fd8a61abc2300c378e1eb2d122">lim</a>[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#a817404fd8a61abc2300c378e1eb2d122">lim</a>[2] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#a817404fd8a61abc2300c378e1eb2d122">lim</a>[3] = <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a71d9e511e7e302cd831e83581219e70d">MC</a>;</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ae202d8b69a0ef3f07651368c3de9ca25">TIMEORDER</a>=2;</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a10228b0cb639e1d94eded72900312334">TIMETYPE</a>=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a56de233d8b42babd780f075b155863fa">TIMEEXPLICIT</a>;</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#ad5ba6b43c072aca55951657f023cbfc3" title="always goes over all conserved">PALLLOOP</a>(pl) <a class="code" href="../../d8/d5b/defs_8general_8h.html#a6b32259475937e434b03862c64fb86a3">fluxmethod</a>[pl]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aa677868bf00f1ed7013d1e3992d15236" title="mnemonics for flux method (Riemann solver) ordered from most diffusive to least diffusive, so can back track 0 should be reasonable most diffusive">LAXFFLUX</a>;</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a11c4e99e1493d0c1914ad1ab313ea472">FLUXB</a> = <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a5014e44c6e710d8827ef79dd18abe6ad">FLUXCTTOTH</a>;</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a538f4ebe3434f76ec67690f0651b53e7">UTOPRIMVERSION</a>=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a43bf3e0f38b75c684c6969028b848cda" title="6: SCN 2D final and optimized and recommended by Scott">UTOPRIM2DFINAL</a>;</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;    <span class="comment">// whether/which ENO used to interpolate fluxes</span></div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;    <span class="comment">//DOENOFLUX = ENOFINITEVOLUME;</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a55732148d2616d6d1f5d2abbe8710850">DOENOFLUX</a>= <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#adacaaf8526353cfe870206f0cf4d2ca7" title="for DOENOFLUX: 0: no ENO flux reconstruction 1: reconstruct F for finite difference rep...">NOENOFLUX</a>;</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;    <span class="comment">//DOENOFLUX=ENOFLUXRECON;</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;  }</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a> = 0.;</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a66ee7a124e4ae5f84428f69f625c8851">tstepparti</a> = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>;</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a207dd7fd301c011f173d6cc43b5823c1">tsteppartf</a> = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>;</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a19a363a93267c97a3d521293fc39d942">tf</a> = 1.0;</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;  </div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;  <span class="keywordflow">for</span>(dtloop=0;dtloop&lt;<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a199215088aa5278950fcc865a67e7019" title="these dump types also control period of output Period can be controlled for non-spatial dumps such as...">NUMDUMPTYPES</a>;dtloop++) <a class="code" href="../../d8/d5b/defs_8general_8h.html#a2edf04580f3ba6725fface8987e5f533">DTdumpgen</a>[dtloop]=1.0;</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;  <span class="comment">//  DTd = DTavg = DTdebug = 1.0;</span></div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;  <span class="comment">//  DTener=1.0;</span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;  <span class="comment">//  DTi=1.0;</span></div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a6650077e624189283a8fc864f948d3b5">DTr</a>=1;</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#ab1151b6a19a26b4041e46379df81be9e">DTfake</a>=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(1,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a6650077e624189283a8fc864f948d3b5">DTr</a>/10);</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a6be7a07f2c885aa09ccac7e12a45ab26">GAMMIEDUMP</a>=0;<span class="comment">// whether in Gammie output types (sets filename with 3 numbers and doesn&#39;t output i,j)</span></div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a1da7eba5b6c3fe0390f4597b3cc911ef">GAMMIEIMAGE</a>=0; <span class="comment">// Gammie filename and single density output</span></div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#ad592700218c6ca4bf0543723ee36d028">GAMMIEENER</a>=0; <span class="comment">// currently doing gener as well as ener, but this would also output some messages in gammie form</span></div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;  <span class="comment">// DOCOLSPLIT</span></div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;  <span class="comment">// 0: don&#39;t ..</span></div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;  <span class="comment">// 1: split dump files into 1 column per file with ending number being column number</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;  <span class="comment">// works in MPI-mode as well.  ROMIO+DOCOLSPLIT is useful for tungsten with low memory and small files to avoid diskspace and memory limits.</span></div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;  <span class="comment">// default</span></div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;  <span class="keywordflow">for</span>(i=0;i&lt;<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a199215088aa5278950fcc865a67e7019" title="these dump types also control period of output Period can be controlled for non-spatial dumps such as...">NUMDUMPTYPES</a>;i++){</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#af4d4bc25a42f2a484eec2cca14f462ea">DOCOLSPLIT</a>[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#ad21ff679aac3fe28202c6d592eafd3e6">i</a>]=0;</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;  }</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;  <span class="comment">// otherwise specify for each dump type</span></div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a813cffebecba4a98b088087f80250ba0">DODIAGEVERYSUBSTEP</a> = 0;</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a86ce38467899f6c68fe212903387563e">DOENODEBUGEVERYSUBSTEP</a> = 0;</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160; </div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#aac5486df6a846aa6cb47c73202ac0485">DODIAGS</a>=1; <span class="comment">// whether to do diagnostics</span></div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;  <span class="comment">// specify individual diagnostics to be done</span></div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#a6fc838c14c5e9fc17d6d8bb3d868ec2f">PRODUCTION</a>&gt;=2){ <span class="comment">// then disable things not really using</span></div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#afbca4918ea5a00b04a471d39f4760924">DOENERDIAG</a>=0;</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    <span class="comment">// still kinda use images to check if looks reasonable, and already limit images to 1 image file if PRODUCTION==1</span></div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;  }</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    <span class="comment">// ener diag also does debug.out counts that could want even if not dumping debug dump itself that would give spatial information</span></div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#afbca4918ea5a00b04a471d39f4760924">DOENERDIAG</a>=1;</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;  }</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a94cc36357859eb0ab6d39dc297f9afff">DOGDUMPDIAG</a>=<a class="code" href="../../da/d3e/definit_8h.html#a82f85e2d68db2555ddaa7c58da361d01" title="0: don&#39;t split AVG file 1: do">DOGDUMP</a>;</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#add77258f6ba7c5eb969ec7b141fa396b">DORDUMPDIAG</a>=<a class="code" href="../../da/d3e/definit_8h.html#a466c30227c9cbc7ce3ac8b093d98da96" title="0: don&#39;t output grid dump 1: do">DORDUMP</a>;</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#aaac66b2bb804ea426f0bb8ce430bc49d">DODUMPDIAG</a>=<a class="code" href="../../da/d3e/definit_8h.html#a885d2726b593784f864fa4c4492d834a" title="0: don&#39;t output restart dumps 1: do">DOMAINDUMP</a>;</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a2ea279929ad8e3b8eeaa615d062ea5cd">DOIMAGEDIAG</a>=<a class="code" href="../../da/d3e/definit_8h.html#a8ead8b368510eb28dfda6bb9fe9846af">DOIMAGEDUMP</a>;</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a8d37b3ef2557632a85dd419e900f05cd">DOAREAMAPDIAG</a>=<a class="code" href="../../da/d3e/definit_8h.html#aee340d517641e633777f58c01ee825a8">DOAREAMAPDUMP</a>;</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a263ad60a48b4d3fe687c524e69465cc9">POSDEFMETRIC</a>=0; <span class="comment">// see metric.c, bounds.c, and coord.c</span></div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;  rescaletype=1;</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;  <span class="comment">// 0: normal</span></div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;  <span class="comment">// 1: extended b^2/rho in funnel</span></div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;  <span class="comment">// 2: conserve E and L along field lines</span></div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;  <span class="comment">//   1 or 2 required to conserve E and L along field line</span></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a7ea29d2d3d2dedf13e5530aae75489db">RHOMIN</a>=1.e-4;</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a5f145b29adcf588cf7f2821cb5c9302f">UUMIN</a> =1.e-6;</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a04996871e3c67b0ac4bb3b9a9ea2eb82">SPECIFICENTROPYMIN</a>=-sqrt(<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a09c78d2f8feb311dd9fc969a0bf84979">SMALL</a>);  <span class="comment">// for ideal gas or other things so Newton steps in inversion and flux calculation for dissipation doesn&#39;t go wacky (see notes in utoprim_jon.c under Ss_Wp_utsq() calculation and Ss0 calculation).</span></div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;  <span class="comment">// 10* to avoid interaction with use of SMALL when avoiding singular expressions</span></div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#aaf25d08a41cff499b5e3d448ad7f76f7">RHOMINLIMIT</a>=10.0*sqrt(<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a09c78d2f8feb311dd9fc969a0bf84979">SMALL</a>);</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a13f615d7832e3abc6abd54325112daf3">UUMINLIMIT</a> =10.0*sqrt(<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a09c78d2f8feb311dd9fc969a0bf84979">SMALL</a>); <span class="comment">// since u^2 used sometimes</span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#aed4087d9f9f32f0794680a57d6a1ec13">SPECIFICENTROPYMINLIMIT</a>=-sqrt(<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a09c78d2f8feb311dd9fc969a0bf84979">SMALL</a>);</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;  <span class="comment">// limit of B^2/rho if using that flag</span></div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a0fe8d3c7642e667dd8ae3635506c4273">BSQORHOLIMIT</a>=1E2;</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a2ac5e41aa897e1fa82d748b7e38b9c6a">BSQOULIMIT</a>=1E3;</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a29e0b9f4e26a839ec5b98c698e90ca17">UORHOLIMIT</a>=1E3;</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#acfae75775b104373e85c66288d127747">GAMMADAMP</a>=5.0;</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a71b7c970651a395e2500645e74862abc">DOEVOLVERHO</a>){</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;    <span class="comment">// GODMARK -- unstable beyond about 25, but can sometimes get away with 1000</span></div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#accef7ff74daca804b9a5a3ad7d3db882">GAMMAMAX</a>=25.0; <span class="comment">// when we think gamma is just too high and may cause unstable flow, but solution is probably accurate.</span></div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;  }</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#accef7ff74daca804b9a5a3ad7d3db882">GAMMAMAX</a>=2000.0;</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;  }</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a51ef12e4cafc4a8fe70374c37f57d565">GAMMAMAXRAD</a>=1000.0; <span class="comment">// maximum radiation frame lorentz factor</span></div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a6be2b06c26c5422c755647ef87bdb924">GAMMAMAXRADFAIL</a>=1000.0; <span class="comment">// maximum radiation frame lorentz factor</span></div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a5bd9da451f108352614cbc457524c5b0">ERADLIMIT</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a13f615d7832e3abc6abd54325112daf3">UUMINLIMIT</a>;</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa0ed69c2bd22558a88c5030c33d90371">UULIMIT</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a13f615d7832e3abc6abd54325112daf3">UUMINLIMIT</a>;</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a0a7b28802551fa49c7931c4345ec6fc9">GAMMAFAIL</a>=100.0*<a class="code" href="../../d8/d5b/defs_8general_8h.html#accef7ff74daca804b9a5a3ad7d3db882">GAMMAMAX</a>; <span class="comment">// when we think gamma is rediculous as to mean failure and solution is not accurate.</span></div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a9919090995876cac5e400300e53436b2">prMAX</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a3bf4402b9e2ae88e4462c3689f5d22b8">RHO</a>]=20.0;</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a9919090995876cac5e400300e53436b2">prMAX</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a94db1ec6a412a83becda73ca2a5db0bf">UU</a>]=20.0;</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a9919090995876cac5e400300e53436b2">prMAX</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aacb3eec923047fe7ddf3eda070c600d9">U1</a>]=100.0;</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a9919090995876cac5e400300e53436b2">prMAX</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ae907e773ef038f3fc0c2ad5de0cb0f07">U2</a>]=100.0;</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a9919090995876cac5e400300e53436b2">prMAX</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8de9104f1fffa59f057b214d74c5cfea">U3</a>]=100.0;</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a9919090995876cac5e400300e53436b2">prMAX</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a7b21d6a6a4573b4997b1f04b01cd4efb">B1</a>]=100.0;</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a9919090995876cac5e400300e53436b2">prMAX</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a6945d50f798e1fde624d70c74457090e">B2</a>]=100.0;</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a9919090995876cac5e400300e53436b2">prMAX</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ae6ac0edb1e2c9c7672ab9488d8b65be9">B3</a>]=100.0;</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;  <span class="comment">// AKMARK: parameter: gam (adiabatic index)</span></div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;  <span class="comment">// some physics</span></div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a5db33bd66a02c92d495409fd6d6c7459" title="GLOBAL PARAMETERS SECTION.">gam</a>=4./3.; <span class="comment">// ultrarelativistic gas, assumes pgas&lt;prad and radiation</span></div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a01b433e38380d85f84aa0baf1cf8deb7">gamideal</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a5db33bd66a02c92d495409fd6d6c7459" title="GLOBAL PARAMETERS SECTION.">gam</a>;</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a7a6f9a2927c5dc63051c63873b1fddc9">zerouuperbaryon</a>=0.0; <span class="comment">// definition of zero-point energy per baryon (i.e. such that internal energy cannot be lower than this times baryon density)</span></div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;  <span class="comment">// doesn&#39;t escape</span></div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;  <span class="comment">// gam=5/3 for non-relativistic gas, such as neucleons in collapsar model</span></div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a5a991b7bb31c346421e7caea2bfb239a">cooling</a>=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a9e514517da1689d80685be5708f92604" title="Choices for cooling function.">NOCOOLING</a>;</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;  <span class="comment">// cooling: 0: no cooling 1: adhoc thin disk cooling 2: neutrino cooling for collapsar model</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;  <span class="comment">// boundary conditions (default is for 3D spherical polar grid -- full r,pi,2pi)</span></div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a6a3603145c91f722d74610fbd6e4f696" title="----------—&gt; r | 3 | 1-0 | 2 v theta and likewise for 4,5 (4=out,5=in) directions:">X1UP</a>]=<a class="code" href="../../da/d3e/definit_8h.html#a537ea156403ef6d3c02745333ecc50d8">OUTFLOW</a>;</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aab7332b2c03d905515d5350d4fd0850f">X1DN</a>]=<a class="code" href="../../da/d3e/definit_8h.html#a537ea156403ef6d3c02745333ecc50d8">OUTFLOW</a>;</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aa9363649053ac2e906715b3259a14954">X2UP</a>]=<a class="code" href="../../da/d3e/definit_8h.html#ae81381343e0c525e13866d873d9deb52">POLARAXIS</a>;</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aae79dca9f851fb40349156f6bca1f8ca">X2DN</a>]=<a class="code" href="../../da/d3e/definit_8h.html#ae81381343e0c525e13866d873d9deb52">POLARAXIS</a>;</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a55fd86081e74615c36554fed69074cd2">X3UP</a>]=<a class="code" href="../../da/d3e/definit_8h.html#af36821ad7b93ab31dcfaaa25e134fdf0">PERIODIC</a>;</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ada1c40d716a8e3567377cd77831aca10">X3DN</a>]=<a class="code" href="../../da/d3e/definit_8h.html#af36821ad7b93ab31dcfaaa25e134fdf0">PERIODIC</a>;</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#afc644ac0842a45965846d51669e93f3e" title="some grid section or loop things">AVOIDADVANCESHIFTX1DN</a>= 1;</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac6aeb510e62df7a008ce14bfaea0f460">AVOIDADVANCESHIFTX1UP</a>= 1;</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a9546eacdd7635538f71b596b1df8efd8">AVOIDADVANCESHIFTX2DN</a>= 1;</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a40a6cd720202abd21543d96cf00587e2">AVOIDADVANCESHIFTX2UP</a>= 1;</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a77e88b8a1252c992e847870001b28e71">AVOIDADVANCESHIFTX3DN</a>= 1;</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a791a4ba8f4e104677b4c9a0e9a7689c1">AVOIDADVANCESHIFTX3UP</a>= 1;</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a5ef0ed187c80734536c4ef6156bc43c2">GLOBALBCMOVEDWITHACTIVESECTION</a>= 0;</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;  <span class="comment">// special3dspc assignment must come after dofull2pi and periodicx? are set in prepre_init()</span></div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;  <span class="comment">// must come before any use of special3dspc such as by init_placeongrid_griddecomposition()</span></div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a67cb78168551d0bd18591a73d82dccf1" title="ENO DEBUG GLOBAL VARS.">special3dspc</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a089706c546fc30d0b60ae9d6eb0a89ea">dofull2pi</a> &amp;&amp; <a class="code" href="../../da/d3e/definit_8h.html#ad66109fbdc4d3adc9c3d6ff917038aef">N3</a>&gt;1 &amp;&amp; IF3DSPCTHENMPITRANSFERATPOLE&amp;&amp;<a class="code" href="../../dd/d46/mpidefs_8h.html#a5e966c43d71ea8ef3cd3fb6e5e4c00d8">periodicx3</a>&amp;&amp;<a class="code" href="../../d2/dbf/metric_8h.html#ac565810c37e91f851ac3bda28ec35e39">ISSPCMCOORDNATIVE</a>(<a class="code" href="../../da/d3e/definit_8h.html#ab343edb2f60f3de2d654dcf1c58e06a2" title="#else define MAXBND 3 endif">MCOORD</a>);</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;  trifprintf(<span class="stringliteral">&quot;Using %s 3D polar boundary conditions\n&quot;</span>, (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a67cb78168551d0bd18591a73d82dccf1" title="ENO DEBUG GLOBAL VARS.">special3dspc</a>)?(<span class="stringliteral">&quot;full&quot;</span>):(<span class="stringliteral">&quot;limited&quot;</span>) );</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;}</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;</div>
<div class="line"><a name="l01407"></a><span class="lineno"><a class="code" href="../../de/df8/initbase_8c.html#a2a7b5a31d7713e0db1c142dc7d096fbb"> 1407</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../de/df8/initbase_8c.html#a2a7b5a31d7713e0db1c142dc7d096fbb" title="init default constants">init_defconsts</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;{</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;  <span class="comment">// some constants that define neutrino cooling and spin evolution</span></div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;  <span class="comment">// cgs</span></div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a9bb24e90c9fc7c84ea9a82dddd4ed122">msun</a>=1.989E33;</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a729f65ee994514a3c172f240e3f04f9e">lsun</a>=3.89E33;</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a4d7df63dd9346423b210e484abe2698a">rsun</a>=695500.0*1E3*1E2;</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a0050aa7bf7fc92a690eec015acb18800">C</a>=2.99792458E10;</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a1b697356441aab8d55c753517a360792">G</a>=6.672E-8;</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;  <span class="comment">// erg K^{-1} g^{-1}</span></div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a21aa565a827b83395847170c4dff8554">kb</a>=1.3807E-16;</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;  <span class="comment">// defs:</span></div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a0050aa7bf7fc92a690eec015acb18800">C</a>=2.99792458E10;</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a19219494bec6e12d3e3da222992af682">amu</a>=1.660538782E-24;</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a204451e8ec20e7512e65a0b10cd19797">qe</a>=4.8032068E-10;</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#af1e794441490b31aade94371055d6a8f">Na</a>=1/<a class="code" href="../../d8/d5b/defs_8general_8h.html#a19219494bec6e12d3e3da222992af682">amu</a>;</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;  <span class="comment">// http://physics.nist.gov/cgi-bin/cuu/Convert?exp=0&amp;num=1&amp;From=ev&amp;To=kg&amp;Action=Convert+value+and+show+factor</span></div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#aadee70c070b8ea91c8c0454886d09078">ergPmev</a> = 1.782661758E-30*1.0E3*<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0050aa7bf7fc92a690eec015acb18800">C</a>*<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0050aa7bf7fc92a690eec015acb18800">C</a>;</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;  <span class="comment">// http://en.wikipedia.org/wiki/Proton</span></div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;  <span class="comment">// http://physics.nist.gov/cgi-bin/cuu/Value?mp</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a1f2f09283a88325fb50a2126ed73bee4">mp</a>=1.672621637E-24;</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;  <span class="comment">// NIST:</span></div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;  <span class="comment">//me=9.10938188E-28</span></div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a9b9ce287df1d997b449c37e3ae5221b2">me</a>=9.10938215E-28;</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;  <span class="comment">// http://physics.nist.gov/cgi-bin/cuu/Value?mn|search_for=atomnuc!</span></div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#acc104efdb993afab15a5a6dd6e376bb3">mn</a>=1.674927211E-24;</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a567fa71c80b232696223800454a771b7">malpha</a>=6.64465598E-24;</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;  <span class="comment">// some constants</span></div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;  <span class="comment">//hpl=6.6262E-27</span></div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a08243fbec6ff87b0ee5c0dfe877053a5">hpl</a>=4.13566733E-15*1<a class="code" href="../../d8/d60/init_8c.html#a07484107e6d9fdf38b53edf631d6511d">E</a>-6*<a class="code" href="../../d8/d5b/defs_8general_8h.html#aadee70c070b8ea91c8c0454886d09078">ergPmev</a>;</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;  <span class="comment">//  mn=1.67492716E-24;</span></div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;  <span class="comment">//  mp=1.67262158E-24;</span></div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;  <span class="comment">//  me=9.10938188E-28;</span></div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a21aa565a827b83395847170c4dff8554">kb</a>=1.380658E-16; <span class="comment">// erg K^{-1} g^{-1}</span></div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a705c2bce1b829cc90b0d71ac62b0e991">Q</a>=(<a class="code" href="../../d8/d5b/defs_8general_8h.html#acc104efdb993afab15a5a6dd6e376bb3">mn</a>-<a class="code" href="../../d8/d5b/defs_8general_8h.html#a1f2f09283a88325fb50a2126ed73bee4">mp</a>)*C*C;</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#abf002e87ba3ed4d3c9dcc98216e6d9d6">R</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a21aa565a827b83395847170c4dff8554">kb</a>/<a class="code" href="../../d8/d5b/defs_8general_8h.html#a1f2f09283a88325fb50a2126ed73bee4">mp</a>;</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#ae7d52645c15699038d3f5098409a0990">Re</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a21aa565a827b83395847170c4dff8554">kb</a>/<a class="code" href="../../d8/d5b/defs_8general_8h.html#a9b9ce287df1d997b449c37e3ae5221b2">me</a>;</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;  <span class="comment">//  hpl=6.6260755E-27;</span></div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a333bf60038d1801707ebf78ebdebdaea">H</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a08243fbec6ff87b0ee5c0dfe877053a5">hpl</a>;</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a4fb6d4010b1a749c8da484188a3a4f63">hbar</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a08243fbec6ff87b0ee5c0dfe877053a5">hpl</a>/(2.0*M_PI);</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a33aba725064a95e4c33b25ccdc2504a9">K</a>=1.24E15;</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a6c820b032adede45cd2b2c4559d509f4">K2</a>=9.9E12;</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;  <span class="comment">// compare below</span></div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a93bea50fd4e28e5d3f9385813663af30">arad</a>=8.*pow(M_PI,5.0)*pow(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a21aa565a827b83395847170c4dff8554">kb</a>,4.0)/(15*C*C*C*<a class="code" href="../../d8/d5b/defs_8general_8h.html#a333bf60038d1801707ebf78ebdebdaea">H</a>*<a class="code" href="../../d8/d5b/defs_8general_8h.html#a333bf60038d1801707ebf78ebdebdaea">H</a>*<a class="code" href="../../d8/d5b/defs_8general_8h.html#a333bf60038d1801707ebf78ebdebdaea">H</a>);</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;  <span class="comment">//  arad=5.6704E-5 * 4.0 / C;</span></div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#aff17315bac4f0cc7fdeb362d2a407448">sigmasb</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a93bea50fd4e28e5d3f9385813663af30">arad</a>*C/4.0;</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac8c9c62921a64e0d6157ab806d944634">sigmamat</a>=6.652E-29*100*100;</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a996a3649177b176bff762e82430ef790">mevocsq</a>=1.783E-27;</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;  <span class="comment">// default for units is GM=C=1</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;  <span class="comment">// GRB</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;  <span class="comment">//  mb=mn;</span></div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;  <span class="comment">// definition of baryon mass uses the below</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a374465c1332e5bdb43fe6593de016927">mb</a> = <a class="code" href="../../d8/d5b/defs_8general_8h.html#a19219494bec6e12d3e3da222992af682">amu</a>;</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a7b6b27c2365c731757b01824f976c837">Mcgs</a>=3.*<a class="code" href="../../d8/d5b/defs_8general_8h.html#a9bb24e90c9fc7c84ea9a82dddd4ed122">msun</a>;</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#ace8ff49c364a2a36d3b768f004f8800a">Mdot</a>=0.1*<a class="code" href="../../d8/d5b/defs_8general_8h.html#a9bb24e90c9fc7c84ea9a82dddd4ed122">msun</a>;</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#ade58afec59d572d7c1f1676bf329eeee">Mdotc</a>=0.35; <span class="comment">// approx code units mass accretion rate</span></div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;  </div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;  <span class="comment">// units</span></div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a73328c615b6665ae65a6b5cce39ca977">Lunit</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a1b697356441aab8d55c753517a360792">G</a>*<a class="code" href="../../d8/d5b/defs_8general_8h.html#a7b6b27c2365c731757b01824f976c837">Mcgs</a>/(C*<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0050aa7bf7fc92a690eec015acb18800">C</a>);</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a82e5394d42d4590bf18c228cfd9bf83d">Tunit</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a1b697356441aab8d55c753517a360792">G</a>*<a class="code" href="../../d8/d5b/defs_8general_8h.html#a7b6b27c2365c731757b01824f976c837">Mcgs</a>/(C*C*<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0050aa7bf7fc92a690eec015acb18800">C</a>);</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#ad288525bcb281cf7bf2764abfd9ba158">Vunit</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a73328c615b6665ae65a6b5cce39ca977">Lunit</a>/<a class="code" href="../../d8/d5b/defs_8general_8h.html#a82e5394d42d4590bf18c228cfd9bf83d">Tunit</a>;</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a930db4676f37cff00af105beb96454d3">Ccode</a>=C/<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad288525bcb281cf7bf2764abfd9ba158">Vunit</a>;</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#af89d32e944074f5f3da2bb0d24a58830">rho0unittype</a>=0; <span class="comment">// mass is mass</span></div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a95824410d3ee13341f4cac01deeb6851">rhounit</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#ace8ff49c364a2a36d3b768f004f8800a">Mdot</a>/(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ade58afec59d572d7c1f1676bf329eeee">Mdotc</a>*<a class="code" href="../../d8/d5b/defs_8general_8h.html#a73328c615b6665ae65a6b5cce39ca977">Lunit</a>*<a class="code" href="../../d8/d5b/defs_8general_8h.html#a73328c615b6665ae65a6b5cce39ca977">Lunit</a>*<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad288525bcb281cf7bf2764abfd9ba158">Vunit</a>);</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a85843fed841a684fd21b1275cc6d7a15">mbwithrhounit</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a374465c1332e5bdb43fe6593de016927">mb</a>;</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#affc1961d157dc7cbc91cd9429193991d">rhomassunit</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a95824410d3ee13341f4cac01deeb6851">rhounit</a>;</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#afecffe0d17534d2189b26743647ce817">Munit</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a95824410d3ee13341f4cac01deeb6851">rhounit</a>*pow(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a73328c615b6665ae65a6b5cce39ca977">Lunit</a>,3.0);</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a64967c4ee0b24a48af67ea1d5fc74258">mdotunit</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#afecffe0d17534d2189b26743647ce817">Munit</a>/<a class="code" href="../../d8/d5b/defs_8general_8h.html#a82e5394d42d4590bf18c228cfd9bf83d">Tunit</a>;</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a25461c546c2dcc94f9ca504492789a63">energyunit</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#afecffe0d17534d2189b26743647ce817">Munit</a>*<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad288525bcb281cf7bf2764abfd9ba158">Vunit</a>*<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad288525bcb281cf7bf2764abfd9ba158">Vunit</a>;</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a4a26339fd2f8e2c8fc26fc03a9d44a5e">edotunit</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a25461c546c2dcc94f9ca504492789a63">energyunit</a>/<a class="code" href="../../d8/d5b/defs_8general_8h.html#a82e5394d42d4590bf18c228cfd9bf83d">Tunit</a>;</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a4dc091cc5c69320910f5ff335d3bb83a">Pressureunit</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a95824410d3ee13341f4cac01deeb6851">rhounit</a>*Vunit*<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad288525bcb281cf7bf2764abfd9ba158">Vunit</a>;</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#afc47cf8d33014500245cddaab2a14ab2">Tempunit</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a4dc091cc5c69320910f5ff335d3bb83a">Pressureunit</a>*<a class="code" href="../../d8/d5b/defs_8general_8h.html#a374465c1332e5bdb43fe6593de016927">mb</a>/(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a95824410d3ee13341f4cac01deeb6851">rhounit</a>*<a class="code" href="../../d8/d5b/defs_8general_8h.html#a21aa565a827b83395847170c4dff8554">kb</a>);</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a70a42484367a7f4129da3ca5e6b0d777">Bunit</a>=Vunit*sqrt(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a95824410d3ee13341f4cac01deeb6851">rhounit</a>);</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#ad724832d12d70737120ad49455a90d1d">massunitPmsun</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#afecffe0d17534d2189b26743647ce817">Munit</a>/<a class="code" href="../../d8/d5b/defs_8general_8h.html#a9bb24e90c9fc7c84ea9a82dddd4ed122">msun</a>;</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;  </div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;  <span class="comment">// physics stuff</span></div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a8053155c7213b7b04393af83ba8211ea">ledd</a>=4.*M_PI*C*<a class="code" href="../../d8/d5b/defs_8general_8h.html#a1b697356441aab8d55c753517a360792">G</a>*<a class="code" href="../../d8/d5b/defs_8general_8h.html#a7b6b27c2365c731757b01824f976c837">Mcgs</a>*<a class="code" href="../../d8/d5b/defs_8general_8h.html#a374465c1332e5bdb43fe6593de016927">mb</a>/<a class="code" href="../../d8/d5b/defs_8general_8h.html#ac8c9c62921a64e0d6157ab806d944634">sigmamat</a>;</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#adfbc4c472f7f1144e320da0aa15c2ae5">leddcode</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a8053155c7213b7b04393af83ba8211ea">ledd</a>/<a class="code" href="../../d8/d5b/defs_8general_8h.html#a4a26339fd2f8e2c8fc26fc03a9d44a5e">edotunit</a>;</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;  <span class="comment">// normalizations and settings for metric changes </span></div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a0263710807f02d8418758c4e3e46bc4e">a0</a>=0.0;</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a1c7a46e6336f8a47446a7f7d71e29d4d">MBH0</a>=1.0;</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac2458c82775ea2fbba5cd1a289b7779d">QBH0</a>=0.0;</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa2c1ce9d27f3d7c1b1d9eeb4d89d3401">EP30</a>=0.0;</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a5bd32ec33416c5c0212739cbb02ed2f4">THETAROT0</a>=0.0;</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a7333a61884836afbece009c6aecccd65">Mfactor</a>=1.0;</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a8da583f7aae5952492f72ea57dd2dc6d">Jfactor</a>=1.0;</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a369506c3813b9e346f51a5e096d694f8">rhofactor</a>=1.0;</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a2e1f63ba60e8b09e99c4b01c138c7474">dabh</a>=0.0;</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a1764b81f8e8d4337c9ac6b6c618a8e43">dE</a>=0.0;</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#af8914916405b4022372a86e27b6c9a53">dJ</a>=0.0;</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;}</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;</div>
<div class="line"><a name="l01523"></a><span class="lineno"><a class="code" href="../../de/df8/initbase_8c.html#a0d6e7670443a502fbdd65884255d88b3"> 1523</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d5/de1/global_8inits_8h.html#a0d6e7670443a502fbdd65884255d88b3" title="post init">post_init</a>(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*prim)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*faraday)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a260333635b659426b194b61015b9a0e7">NUMCURRENTSLOTS</a>][3])</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;{</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;  <span class="keywordtype">int</span> compute_currents_t0(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*prim)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*faraday)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NUMCURRENTSLOTS][3]);</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;  trifprintf(<span class="stringliteral">&quot;begin: post_init\n&quot;</span>);</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;  <span class="comment">// post-init checks</span></div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;  <span class="keywordflow">if</span>(</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;     ((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a6a3603145c91f722d74610fbd6e4f696" title="----------—&gt; r | 3 | 1-0 | 2 v theta and likewise for 4,5 (4=out,5=in) directions:">X1UP</a>]==<a class="code" href="../../da/d3e/definit_8h.html#af36821ad7b93ab31dcfaaa25e134fdf0">PERIODIC</a> || <a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aab7332b2c03d905515d5350d4fd0850f">X1DN</a>]==<a class="code" href="../../da/d3e/definit_8h.html#af36821ad7b93ab31dcfaaa25e134fdf0">PERIODIC</a>) &amp;&amp; <a class="code" href="../../dd/d46/mpidefs_8h.html#ab6ed54cec8c2547f4280b86f34426cb5" title="for only grmhd code">periodicx1</a>==0 &amp;&amp; <a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>&gt;1)</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;     ||((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a6a3603145c91f722d74610fbd6e4f696" title="----------—&gt; r | 3 | 1-0 | 2 v theta and likewise for 4,5 (4=out,5=in) directions:">X1UP</a>]!=<a class="code" href="../../da/d3e/definit_8h.html#af36821ad7b93ab31dcfaaa25e134fdf0">PERIODIC</a> || <a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aab7332b2c03d905515d5350d4fd0850f">X1DN</a>]!=<a class="code" href="../../da/d3e/definit_8h.html#af36821ad7b93ab31dcfaaa25e134fdf0">PERIODIC</a>) &amp;&amp; <a class="code" href="../../dd/d46/mpidefs_8h.html#ab6ed54cec8c2547f4280b86f34426cb5" title="for only grmhd code">periodicx1</a>==1 &amp;&amp; <a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>&gt;1)</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;     ||((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aa9363649053ac2e906715b3259a14954">X2UP</a>]==<a class="code" href="../../da/d3e/definit_8h.html#af36821ad7b93ab31dcfaaa25e134fdf0">PERIODIC</a> || <a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aae79dca9f851fb40349156f6bca1f8ca">X2DN</a>]==<a class="code" href="../../da/d3e/definit_8h.html#af36821ad7b93ab31dcfaaa25e134fdf0">PERIODIC</a>) &amp;&amp; <a class="code" href="../../dd/d46/mpidefs_8h.html#a504b3e0d6a16870176bb4555e95642c7">periodicx2</a>==0 &amp;&amp; <a class="code" href="../../da/d3e/definit_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a>&gt;1)</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;     ||((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aa9363649053ac2e906715b3259a14954">X2UP</a>]!=<a class="code" href="../../da/d3e/definit_8h.html#af36821ad7b93ab31dcfaaa25e134fdf0">PERIODIC</a> || <a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aae79dca9f851fb40349156f6bca1f8ca">X2DN</a>]!=<a class="code" href="../../da/d3e/definit_8h.html#af36821ad7b93ab31dcfaaa25e134fdf0">PERIODIC</a>) &amp;&amp; <a class="code" href="../../dd/d46/mpidefs_8h.html#a504b3e0d6a16870176bb4555e95642c7">periodicx2</a>==1 &amp;&amp; <a class="code" href="../../da/d3e/definit_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a>&gt;1)</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;     ||((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a55fd86081e74615c36554fed69074cd2">X3UP</a>]==<a class="code" href="../../da/d3e/definit_8h.html#af36821ad7b93ab31dcfaaa25e134fdf0">PERIODIC</a> || <a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ada1c40d716a8e3567377cd77831aca10">X3DN</a>]==<a class="code" href="../../da/d3e/definit_8h.html#af36821ad7b93ab31dcfaaa25e134fdf0">PERIODIC</a>) &amp;&amp; <a class="code" href="../../dd/d46/mpidefs_8h.html#a5e966c43d71ea8ef3cd3fb6e5e4c00d8">periodicx3</a>==0 &amp;&amp; <a class="code" href="../../da/d3e/definit_8h.html#ad66109fbdc4d3adc9c3d6ff917038aef">N3</a>&gt;1)</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;     ||((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a55fd86081e74615c36554fed69074cd2">X3UP</a>]!=<a class="code" href="../../da/d3e/definit_8h.html#af36821ad7b93ab31dcfaaa25e134fdf0">PERIODIC</a> || <a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ada1c40d716a8e3567377cd77831aca10">X3DN</a>]!=<a class="code" href="../../da/d3e/definit_8h.html#af36821ad7b93ab31dcfaaa25e134fdf0">PERIODIC</a>) &amp;&amp; <a class="code" href="../../dd/d46/mpidefs_8h.html#a5e966c43d71ea8ef3cd3fb6e5e4c00d8">periodicx3</a>==1 &amp;&amp; <a class="code" href="../../da/d3e/definit_8h.html#ad66109fbdc4d3adc9c3d6ff917038aef">N3</a>&gt;1)</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;     ){</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;inconsistent periodic settings\n&quot;</span>);</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;    myexit(39472525);</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;  }</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;  <span class="comment">// need to compute various things for EOS</span></div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;  <span class="comment">// also done per timestep in step_ch.c</span></div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;  <span class="comment">// GODMARK: Check that no EOS call is before this point </span></div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;  <a class="code" href="../../d8/d67/eos_8c.html#a789d6eb445aa3c6807d21dc642058ca1" title="compute EOS all parameters">compute_EOS_parms_full</a>(<a class="code" href="../../da/d3e/definit_8h.html#ad7d4ae935d29d9f729e14124b737a430" title="which EOS (EoS) (equation of state) to use">WHICHEOS</a>, <a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(EOSextraglobal),prim);</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;  <span class="comment">// in synch always here</span></div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;  <span class="keywordflow">if</span> (error_check(3)) {</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>, <span class="stringliteral">&quot;error_check detected failure at main:1\n&quot;</span>);</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>, <span class="stringliteral">&quot;Bad initial conditions\n&quot;</span>);</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;    myexit(1);</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;  }</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;  <span class="comment">// all calculations that do not change for any initial conditions or problem setup or restart conditions</span></div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160; </div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;  <span class="comment">// don&#39;t recompute these things if doing metric evolution on substeps</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a00bdeb72a08e745eb0a5482af9e8cb74">RESTARTMODE</a>!=0){</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;    setfailresponse(restartonfail);</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;  }</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;  </div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;  </div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;  <span class="comment">// current</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;  compute_currents_t0(prim,faraday);</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;  </div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;  trifprintf(<span class="stringliteral">&quot;end: post_init\n&quot;</span>);</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;}</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;</div>
<div class="line"><a name="l01584"></a><span class="lineno"><a class="code" href="../../de/df8/initbase_8c.html#aa88e03092994c7a48371ef1da5231aa1"> 1584</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../de/df8/initbase_8c.html#aa88e03092994c7a48371ef1da5231aa1" title="bounds, etc. use enerpos type stuff that is set by recompute_fluxpositions()">set_box_grid_parameters</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;{</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;  <span class="keywordtype">int</span> faketimeorder,fakenumtimeorders;</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;  <span class="comment">// need to recompute horizon-related quantities if horizon is growing due to accretion</span></div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d2/dbf/metric_8h.html#abd133696cea6c0c1397c24e925e5039a">ISBLACKHOLEMCOORD</a>(<a class="code" href="../../da/d3e/definit_8h.html#ab343edb2f60f3de2d654dcf1c58e06a2" title="#else define MAXBND 3 endif">MCOORD</a>)){</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;    find_horizon(0);</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    trifprintf(<span class="stringliteral">&quot;Rhor=%21.15g Risco=%21.15g MBH=%21.15g a=%21.15g QBH=%21.15g EP3=%21.15g THETAROT=%21.15g\n&quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a20e81ef2343c6d8db701c6613cbcd279">Rhor</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a13eb494465126d4aa3e4d7657b9ff6ca">Risco</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a1fb64169459d57727a61a72b6e01ced5">MBH</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa73cf2d397cae726436e08d2c891bdb0">a</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a60c2aa47ffa41453bf4afb2c19ac2a4e">QBH</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2f09f0f07c81c40846f158024b125ed0">EP3</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#af850e395071231822a385de91849efd3">THETAROT</a>);</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;  }</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3ac70e0bc8f102cca400733fb37c3f54" title="end changes after ...">horizoni</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a58b9fa3befcf1cde8e143386173d5960">horizoncpupos1</a>=0;</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;  }</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;  <span class="comment">// not the initial call -- uses horizon information</span></div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;  <span class="comment">// By this point the code expects user to be able to specify ACTIVEREGION domain</span></div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;  <span class="comment">// however, if doing grid sectioning still need to have full COMP loops (hence 2 and not 1 below)</span></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;  faketimeorder=-1;</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;  fakenumtimeorders=-1;</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;  recompute_fluxpositions(2,faketimeorder,fakenumtimeorders,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a1a1088d87617078680f1fd0f0d707384">nstep</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>);</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;}</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;<span class="keywordtype">int</span> compute_currents_t0(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*prim)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*faraday)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a260333635b659426b194b61015b9a0e7">NUMCURRENTSLOTS</a>][3])</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;{</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;<span class="preprocessor">#if(CALCFARADAYANDCURRENTS)</span></div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;<span class="preprocessor"></span>    </div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;<span class="preprocessor">#if(CURRENTST0)</span></div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;<span class="preprocessor"></span>  <span class="comment">// setup faraday so t=0 dump has diagnostics</span></div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;  <span class="comment">// may want currents for dump=0 (time-derivative terms will be wrong)</span></div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;  current_doprecalc(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a273ed7511282d8abfa2e69104310fc7f">CURTYPET</a>,prim);</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;  current_doprecalc(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a526b60e23f8603587743fd662455013e">CURTYPEX</a>,prim);</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;  current_doprecalc(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0ad9c88320c2d415738cdbe52dd57839">CURTYPEY</a>,prim);</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;  current_doprecalc(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a4541757ca92b743ff88ea353fe0bb887">CURTYPEZ</a>,prim);</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;  <span class="comment">// compute current</span></div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;  current_calc(faraday);</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;  </div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;<span class="preprocessor"></span>  </div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;  <span class="comment">// need to at least compute t=0 faraday so currents can start to be computed before reach step_ch.c (just an ordering issue with how step_ch.c does this case)</span></div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;  <span class="keywordflow">if</span>(WHICHCURRENTCALC==1){</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;    <span class="comment">// compute faraday components needed for time centering of J</span></div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    current_doprecalc(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a273ed7511282d8abfa2e69104310fc7f">CURTYPET</a>,prim);</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;  }</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;<span class="preprocessor"></span>  </div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;<span class="preprocessor">#if(FARADAYT0)</span></div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;<span class="preprocessor"></span>  current_doprecalc(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a127d2636bce00224377a0d84fe478719">CURTYPEFARADAY</a>,prim);</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;<span class="preprocessor"></span>  </div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;}</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;</div>
<div class="line"><a name="l01649"></a><span class="lineno"><a class="code" href="../../de/df8/initbase_8c.html#ae2b35ba778a1c94bdb69e35592d3a341"> 1649</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../de/df8/initbase_8c.html#ae2b35ba778a1c94bdb69e35592d3a341" title="set certain arrays to zero for diagnostic purposes (must come after all basic init stuff that sets up...">init_arrays_before_set_pu</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;{</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#ad21ff679aac3fe28202c6d592eafd3e6">i</a>,<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>,k,pliter,pl;</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;  <span class="keywordtype">int</span> jj;</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;  <span class="comment">// 0 out these things so dump files are readable by SM under any cases</span></div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;<span class="comment"></span>  <a class="code" href="../../da/db2/global_8loops_8manypoints_8h.html#a615c1d48363ecaa0866f1c0fd337b780">FULLLOOP</a>{</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a11c4e99e1493d0c1914ad1ab313ea472">FLUXB</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0b6762cef74e396f50a83864bb53fb6c">FLUXCTSTAG</a>){</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;      <span class="comment">// then pl=B1,B2,B3 actually should be correct (i.e. not NaN), so don&#39;t reset those so nan-check works</span></div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;      <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#af1c67086436007e897bccc458390886f" title="PLOOP controls looping over conserved or primitive -type quantities except during interpolation or ot...">PLOOP</a>(pliter,pl){</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;        <span class="keywordflow">if</span>(! (pl==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a7b21d6a6a4573b4997b1f04b01cd4efb">B1</a> || pl==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a6945d50f798e1fde624d70c74457090e">B2</a> || pl==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ae6ac0edb1e2c9c7672ab9488d8b65be9">B3</a>) ){</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;          GLOBALMACP0A1(udump,i,j,k,pl)=0.0;</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;        }</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;      }</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    }</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a55732148d2616d6d1f5d2abbe8710850">DOENOFLUX</a> != <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#adacaaf8526353cfe870206f0cf4d2ca7" title="for DOENOFLUX: 0: no ENO flux reconstruction 1: reconstruct F for finite difference rep...">NOENOFLUX</a>){</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;      <span class="comment">// then all pl actually should be correct (i.e. not NaN), so don&#39;t reset those so nan-check works</span></div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;    }</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;      <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#af1c67086436007e897bccc458390886f" title="PLOOP controls looping over conserved or primitive -type quantities except during interpolation or ot...">PLOOP</a>(pliter,pl) GLOBALMACP0A1(udump,i,j,k,pl)=0.0;</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;    }</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;<span class="preprocessor">#if(CALCFARADAYANDCURRENTS)</span></div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;<span class="preprocessor"></span>    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(jj) GLOBALMACP0A1(jcon,i,j,k,jj)=0.0;</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;    <span class="keywordflow">for</span>(pl=0;pl&lt;<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a2803d3c18bbf2267596766a9f58c5217" title="for above see diag.c and set_varstavg()">NUMFARADAY</a>;pl++) GLOBALMACP0A1(fcon,i,j,k,pl)=0.0;</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;  }</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;}</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;</div>
<div class="line"><a name="l01692"></a><span class="lineno"><a class="code" href="../../de/df8/initbase_8c.html#a254d74445f2d2509612bfe1641f68903"> 1692</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../de/df8/initbase_8c.html#a254d74445f2d2509612bfe1641f68903" title="after all parameters are set, can call this">post_par_set</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;{</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;  <span class="keywordtype">int</span> interp_loop_set(<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;  <span class="keywordtype">int</span> orders_set(<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;  <span class="keywordtype">void</span> check_bnd_num(<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;  <span class="comment">// if higher order, then set useghostplusactive to 1 since need that region in general</span></div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;  <span class="keywordflow">if</span>(HIGHERORDERMEM &amp;&amp; (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a55732148d2616d6d1f5d2abbe8710850">DOENOFLUX</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ac634a307561f486f9df8ba8a67c21c19">ENOFINITEVOLUME</a> || <a class="code" href="../../d8/d5b/defs_8general_8h.html#a55732148d2616d6d1f5d2abbe8710850">DOENOFLUX</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a81c6be7c38a1e29b40efa57ca47d0d02">ENOFLUXRECON</a>) ){</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#afa531848f9f8c22b7302b80056ee67d1">useghostplusactive</a>=1;</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;  }</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#afa531848f9f8c22b7302b80056ee67d1">useghostplusactive</a>=0;</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;  }</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#afa531848f9f8c22b7302b80056ee67d1">useghostplusactive</a> &amp;&amp; <a class="code" href="../../d8/d5b/defs_8general_8h.html#a55732148d2616d6d1f5d2abbe8710850">DOENOFLUX</a> == <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a81c6be7c38a1e29b40efa57ca47d0d02">ENOFLUXRECON</a> &amp;&amp; <a class="code" href="../../d8/d5b/defs_8general_8h.html#a11c4e99e1493d0c1914ad1ab313ea472">FLUXB</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0b6762cef74e396f50a83864bb53fb6c">FLUXCTSTAG</a> &amp;&amp; <a class="code" href="../../d8/d5b/defs_8general_8h.html#ad5c8369abdf1833b4afc10d11d52b537">dofluxreconevolvepointfield</a>==0){</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;    <span class="comment">// no matter how this parameter is set, we reset it to </span></div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a41163ae4887e295df142ae7fc9b4829c">extrazones4emf</a>=1;</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;  }</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;  <span class="keywordflow">else</span> <a class="code" href="../../d8/d5b/defs_8general_8h.html#a41163ae4887e295df142ae7fc9b4829c">extrazones4emf</a>=0;</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#ae4d1105fadbd4b0070fc29dff3903f70" title="whether to split off MA and EM parts of flux for higher order for now always do if doing higher order...">SPLITMAEMMEM</a> &amp;&amp; HIGHERORDERMEM &amp;&amp; <a class="code" href="../../d8/d5b/defs_8general_8h.html#a55732148d2616d6d1f5d2abbe8710850">DOENOFLUX</a> == <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a81c6be7c38a1e29b40efa57ca47d0d02">ENOFLUXRECON</a>){</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;    splitmaem=1;</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;  }</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;  <span class="keywordflow">else</span> splitmaem=0;</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;  <span class="keywordflow">if</span>(splitmaem==0 &amp;&amp; <a class="code" href="../../d8/d5b/defs_8general_8h.html#ad5c8369abdf1833b4afc10d11d52b537">dofluxreconevolvepointfield</a>==1 &amp;&amp; <a class="code" href="../../d8/d5b/defs_8general_8h.html#a55732148d2616d6d1f5d2abbe8710850">DOENOFLUX</a> == <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a81c6be7c38a1e29b40efa57ca47d0d02">ENOFLUXRECON</a> &amp;&amp; <a class="code" href="../../d8/d5b/defs_8general_8h.html#a11c4e99e1493d0c1914ad1ab313ea472">FLUXB</a> == <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0b6762cef74e396f50a83864bb53fb6c">FLUXCTSTAG</a> &amp;&amp; <a class="code" href="../../da/d3e/definit_8h.html#a8d53959951a9d1a35c19bbbe8be87a00" title="whether to split isotropic pressure off of flux for separate interpolation this splitting only used u...">SPLITPRESSURETERMINFLUXMA</a>==0 &amp;&amp; <a class="code" href="../../da/d3e/definit_8h.html#a482268622b131154f6618b6c3af8d77c" title="below not setup yet:">SPLITPRESSURETERMINFLUXEM</a>==0){</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;    <span class="comment">// when not splitting MA/EM terms and doing FLUXRECON point field method, then need to still fix stencil for EMF terms</span></div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac4983e5dd43dbbd0aaea7f7a4b890108">emffixedstencil</a>=1;</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;  }</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;  </div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#afa531848f9f8c22b7302b80056ee67d1">useghostplusactive</a> &amp;&amp; ((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a55732148d2616d6d1f5d2abbe8710850">DOENOFLUX</a> == <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a81c6be7c38a1e29b40efa57ca47d0d02">ENOFLUXRECON</a> &amp;&amp; <a class="code" href="../../d8/d5b/defs_8general_8h.html#a11c4e99e1493d0c1914ad1ab313ea472">FLUXB</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0b6762cef74e396f50a83864bb53fb6c">FLUXCTSTAG</a> &amp;&amp; <a class="code" href="../../d8/d5b/defs_8general_8h.html#ad5c8369abdf1833b4afc10d11d52b537">dofluxreconevolvepointfield</a>==0) || <a class="code" href="../../d8/d5b/defs_8general_8h.html#a55732148d2616d6d1f5d2abbe8710850">DOENOFLUX</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ac634a307561f486f9df8ba8a67c21c19">ENOFINITEVOLUME</a>)){</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;    <span class="comment">// no matter how this parameter is set, we reset it to </span></div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#af8fe447ae4f447a0823daaedab6364f9">unewisavg</a>=1;</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;  }</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;  <span class="keywordflow">else</span> <a class="code" href="../../d8/d5b/defs_8general_8h.html#af8fe447ae4f447a0823daaedab6364f9">unewisavg</a>=0;</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;  trifprintf(<span class="stringliteral">&quot;useghostplusactive=%d extrazones4emf=%d\n&quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#afa531848f9f8c22b7302b80056ee67d1">useghostplusactive</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a41163ae4887e295df142ae7fc9b4829c">extrazones4emf</a>);</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;  trifprintf(<span class="stringliteral">&quot;Setting orders\n&quot;</span>);</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;  orders_set();</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;  trifprintf(<span class="stringliteral">&quot;Boundary number checks\n&quot;</span>);</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;  check_bnd_num();</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;  trifprintf(<span class="stringliteral">&quot;Setting interp loop\n&quot;</span>);</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;  interp_loop_set();</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;  trifprintf(<span class="stringliteral">&quot;Reporting bound loop\n&quot;</span>);</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;  report_bound_loop();</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;}</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;<span class="keywordtype">void</span> check_bnd_num(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;{</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;  <span class="keywordtype">int</span> totalo;</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;  <span class="keywordtype">int</span> get_num_bnd_zones_used(<span class="keywordtype">int</span> dir);</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;  <span class="keywordtype">int</span> dimen;</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;  <span class="keywordtype">int</span> bndnum[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;  <span class="keywordtype">int</span> doingdimen[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;  <span class="keywordtype">int</span> pl,pliter;</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;  <span class="keywordtype">int</span> doingenough;</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;  doingdimen[1]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a51b48b29d7903bb94a3d7879c3ff8eb9">N1NOT1</a>;</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;  doingdimen[2]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a9d8b7e3d088c68f51e7b29b95326a4ac">N2NOT1</a>;</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;  doingdimen[3]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#aabbd6bada71f73d78d57d14e9adc0c29">N3NOT1</a>;</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;  bndnum[1]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#aa00aaa6c09563827fbe601635b149ef8">N1BND</a>;</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;  bndnum[2]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a4053d825930f47a796f9f13678ef32e3">N2BND</a>;</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;  bndnum[3]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a90d132cb201447b8fe71388f1b0ffe93">N3BND</a>;</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a8cbb473515f18fcae523329c93f140dc">DIMENLOOP</a>(dimen){</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;    <span class="comment">// first fix avgscheme and lim for case when not doing dimension</span></div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;    <span class="keywordflow">if</span>(!doingdimen[dimen]){</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#acb6f71700ed482e84b69ee6bec92c303">avgscheme</a>[dimen]=0;</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a817404fd8a61abc2300c378e1eb2d122">lim</a>[dimen]=0;</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;    } <span class="comment">// otherwise assume as wanted</span></div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;    <span class="comment">// get number of boundary zones needed</span></div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;    totalo=get_num_bnd_zones_used(dimen);</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;  </div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;    <span class="comment">// bndnum[dimen] (MAXBND is maximum) is the number of boundary zones to be set by boundary routines and to be passed by MPI routines</span></div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;    <span class="keywordflow">if</span>(totalo==bndnum[dimen] || !doingdimen[dimen]){</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;      <span class="comment">// then good</span></div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;    }</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(totalo&gt;bndnum[dimen]){</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;      dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Not enough: dimen=%d totalo=%d MAXBND=%d bndnum=%d for avgscheme interporder[%d]=%d or lim interporder[%d]=%d extrazones4emf=%d\n&quot;</span>,dimen,totalo,<a class="code" href="../../da/d3e/definit_8h.html#ac97bae4266eb010870a1da7dc312c459" title="#if(DOENOFLUX==ENOFINITEVOLUME)">MAXBND</a>,bndnum[dimen],<a class="code" href="../../d8/d5b/defs_8general_8h.html#acb6f71700ed482e84b69ee6bec92c303">avgscheme</a>[dimen],<a class="code" href="../../d8/d5b/defs_8general_8h.html#adedce549d7ca97c62ec54f15549703eb">interporder</a>[<a class="code" href="../../d8/d5b/defs_8general_8h.html#acb6f71700ed482e84b69ee6bec92c303">avgscheme</a>[dimen]],<a class="code" href="../../d8/d5b/defs_8general_8h.html#a817404fd8a61abc2300c378e1eb2d122">lim</a>[dimen],<a class="code" href="../../d8/d5b/defs_8general_8h.html#adedce549d7ca97c62ec54f15549703eb">interporder</a>[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a817404fd8a61abc2300c378e1eb2d122">lim</a>[dimen]],<a class="code" href="../../d8/d5b/defs_8general_8h.html#a41163ae4887e295df142ae7fc9b4829c">extrazones4emf</a>);</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#ad4ec5aab9b62fbbe9b8fc2d8ac0a5989">failed</a>=1; <span class="comment">// so don&#39;t try to compute things in dump</span></div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;      myexit(1);</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;    }</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;      <span class="comment">// then MAXBND too large</span></div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;      dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;WARNING: MAXBND excessive\n&quot;</span>);</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;      dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;WARNING: dimen=%d totalo=%d MAXBND=%d and bndnum=%d for avgscheme interporder[%d]=%d or lim interporder[%d]=%d extrazones4emf=%d\n&quot;</span>,dimen,totalo,<a class="code" href="../../da/d3e/definit_8h.html#ac97bae4266eb010870a1da7dc312c459" title="#if(DOENOFLUX==ENOFINITEVOLUME)">MAXBND</a>,bndnum[dimen],<a class="code" href="../../d8/d5b/defs_8general_8h.html#acb6f71700ed482e84b69ee6bec92c303">avgscheme</a>[dimen],<a class="code" href="../../d8/d5b/defs_8general_8h.html#adedce549d7ca97c62ec54f15549703eb">interporder</a>[<a class="code" href="../../d8/d5b/defs_8general_8h.html#acb6f71700ed482e84b69ee6bec92c303">avgscheme</a>[dimen]],<a class="code" href="../../d8/d5b/defs_8general_8h.html#a817404fd8a61abc2300c378e1eb2d122">lim</a>[dimen],<a class="code" href="../../d8/d5b/defs_8general_8h.html#adedce549d7ca97c62ec54f15549703eb">interporder</a>[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a817404fd8a61abc2300c378e1eb2d122">lim</a>[dimen]],<a class="code" href="../../d8/d5b/defs_8general_8h.html#a41163ae4887e295df142ae7fc9b4829c">extrazones4emf</a>);</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;      <span class="comment">// not a failure, but user should be aware especially when doing MPI</span></div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;    }</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;    </div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;  }</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;  <span class="comment">// see if need to be here at all                                                                                         </span></div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#adedce549d7ca97c62ec54f15549703eb">interporder</a>[<a class="code" href="../../d8/d5b/defs_8general_8h.html#acb6f71700ed482e84b69ee6bec92c303">avgscheme</a>[1]]&lt;3 &amp;&amp; <a class="code" href="../../d8/d5b/defs_8general_8h.html#adedce549d7ca97c62ec54f15549703eb">interporder</a>[<a class="code" href="../../d8/d5b/defs_8general_8h.html#acb6f71700ed482e84b69ee6bec92c303">avgscheme</a>[2]]&lt;3 &amp;&amp; <a class="code" href="../../d8/d5b/defs_8general_8h.html#adedce549d7ca97c62ec54f15549703eb">interporder</a>[<a class="code" href="../../d8/d5b/defs_8general_8h.html#acb6f71700ed482e84b69ee6bec92c303">avgscheme</a>[3]]&lt;3){</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#ad5ba6b43c072aca55951657f023cbfc3" title="always goes over all conserved">PALLLOOP</a>(pl) <a class="code" href="../../d8/d5b/defs_8general_8h.html#a13fd1bc27b6fdc0978d4cbc7cd9bdaec">do_transverse_flux_integration</a>[pl] = 0;</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#ad5ba6b43c072aca55951657f023cbfc3" title="always goes over all conserved">PALLLOOP</a>(pl) <a class="code" href="../../d8/d5b/defs_8general_8h.html#a619bd249bee29e34eb58716b9b88dc8a">do_source_integration</a>[pl] = 0;</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#ad5ba6b43c072aca55951657f023cbfc3" title="always goes over all conserved">PALLLOOP</a>(pl) <a class="code" href="../../d8/d5b/defs_8general_8h.html#a42a3e0ccdd6805791cf169d439d305d6">do_conserved_integration</a>[pl] = 0;</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;    </div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;    trifprintf(&quot;Changed do_{conserved/<a class="code" href="../../d3/ddc/phys_8funcdeclare_8h.html#a4ebf7765a6bde079a76719b89d3033b6" title="add in source terms to equations of motion ui and dUriemann in UEVOLVE form assume q(pr) so consisten...">source</a>/transverse_flux}_integration to 0 since <a class="code" href="../../d8/d5b/defs_8general_8h.html#acb6f71700ed482e84b69ee6bec92c303">avgscheme</a>[1]=%d avgscheme[2]=%d avgscheme[3]=%d\n<span class="stringliteral">&quot;,avgscheme[1],avgscheme[2],avgscheme[3]);</span></div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;<span class="stringliteral">  // checks on parameters so user doesn&#39;t do something stupid</span></div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;<span class="stringliteral">  if(FULLOUTPUT&amp;&amp;USEMPI&amp;&amp;(numprocs&gt;1 || mpicombine==1)){</span></div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;<span class="stringliteral">    dualfprintf(fail_file,&quot;</span>Cannot use <a class="code" href="../../da/d3e/definit_8h.html#a19213af1114071d7405e721d37bc0a68" title="0: full images, dumps, etc., few more key failure stderr/fail_file messages 1: only log density image...">FULLOUTPUT</a>!=0 when USEMPI=1 and (<a class="code" href="../../dd/d46/mpidefs_8h.html#a31bfe068640b411bea3df0d69177ded5">numprocs</a>&gt;1 || <a class="code" href="../../d8/d5b/defs_8general_8h.html#a4242e6dd75844f241d042e8f43c404e8">mpicombine</a>==1)\n<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;<span class="stringliteral">    myexit(ERRORCODEBELOWCLEANFINISH+200);</span></div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;<span class="stringliteral">  if(DOEVOLVEMETRIC&amp;&amp; (ANALYTICCONNECTION||ANALYTICSOURCE)){</span></div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;<span class="stringliteral">    dualfprintf(fail_file,&quot;</span>Unlikely you have metric in time analytically\n<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;<span class="stringliteral">    myexit(ERRORCODEBELOWCLEANFINISH+201);</span></div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;<span class="stringliteral">  if(DOSELFGRAVVSR &amp;&amp; (ANALYTICCONNECTION||ANALYTICSOURCE||ANALYTICGCON)){</span></div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;<span class="stringliteral">    dualfprintf(fail_file,&quot;</span>Unlikely you have metric analytically with <span class="keyword">self</span> gravity\n<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;<span class="stringliteral">    myexit(ERRORCODEBELOWCLEANFINISH+202);</span></div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;<span class="stringliteral">  if(GDETVOLDIFF){</span></div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;<span class="stringliteral">    if(ISSPCMCOORDNATIVE(MCOORD)){</span></div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;<span class="stringliteral">      // then fine</span></div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;<span class="stringliteral">    else{</span></div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;<span class="stringliteral">      dualfprintf(fail_file,&quot;</span><a class="code" href="../../da/d3e/definit_8h.html#a95449d05291e56d2cb2f5de5911612be" title="#define WHICHEOM WITHNOGDET">GDETVOLDIFF</a>==1 not setup <span class="keywordflow">for</span> non-SPC metrics\n<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;<span class="stringliteral">      myexit(ERRORCODEBELOWCLEANFINISH+203);</span></div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;<span class="stringliteral">  if(DOSELFGRAVVSR==0 &amp;&amp; (MCOORD==KS_BH_TOV_COORDS || MCOORD==KS_TOV_COORDS || MCOORD==BL_TOV_COORDS) ){</span></div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;<span class="stringliteral">    dualfprintf(fail_file,&quot;</span><a class="code" href="../../da/d3e/definit_8h.html#af35efc27e405b7c3e2c95df8f7559a07" title="#define WHICHENTROPYEVOLVE EVOLVEFULLENTROPY">DOSELFGRAVVSR</a>==0 with <a class="code" href="../../da/d3e/definit_8h.html#ab343edb2f60f3de2d654dcf1c58e06a2" title="#else define MAXBND 3 endif">MCOORD</a>=%d is not likely what you want\n<span class="stringliteral">&quot;,MCOORD);</span></div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;<span class="stringliteral">    dualfprintf(fail_file,&quot;</span>Continuing....\n<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;<span class="stringliteral">  if(HIGHERORDERMEM==0 &amp;&amp; DOENOFLUX != NOENOFLUX){</span></div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;<span class="stringliteral">    dualfprintf(fail_file,&quot;</span>Need to turn on HIGHERORDERMEM when doing higher order methods (i.e. <a class="code" href="../../d8/d5b/defs_8general_8h.html#a55732148d2616d6d1f5d2abbe8710850">DOENOFLUX</a>(=%d)!=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#adacaaf8526353cfe870206f0cf4d2ca7" title="for DOENOFLUX: 0: no ENO flux reconstruction 1: reconstruct F for finite difference rep...">NOENOFLUX</a>)\n<span class="stringliteral">&quot;,DOENOFLUX);</span></div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;<span class="stringliteral">    myexit(ERRORCODEBELOWCLEANFINISH+204);</span></div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;<span class="stringliteral">  if(COMPDIM!=3){</span></div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;<span class="stringliteral">    dualfprintf(fail_file,&quot;</span>Code not setup <span class="keywordflow">for</span> anything but <a class="code" href="../../da/d3e/definit_8h.html#a1b2ef8afddd2c5d91ab65015bbd7b80b" title="NUMBER OF DIMENSIONS FOR COMPUTATION Can choose 3 and still do 1D optimized problems Choosing 2 or ev...">COMPDIM</a>==3\n<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;<span class="stringliteral">    myexit(ERRORCODEBELOWCLEANFINISH+205);</span></div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;<span class="stringliteral">  if(FIELDSTAGMEM==0 &amp;&amp; FLUXB==FLUXCTSTAG){</span></div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;<span class="stringliteral">    dualfprintf(fail_file,&quot;</span>FIELDSTAGMEM should be 1 <span class="keywordflow">if</span> <a class="code" href="../../d8/d5b/defs_8general_8h.html#a11c4e99e1493d0c1914ad1ab313ea472">FLUXB</a>==FLUXCTSTAG\n<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;<span class="stringliteral">    myexit(ERRORCODEBELOWCLEANFINISH+206);</span></div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;<span class="stringliteral">  if(FIELDSTAGMEM==1 &amp;&amp; FLUXB!=FLUXCTSTAG){</span></div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;<span class="stringliteral">    dualfprintf(fail_file,&quot;</span>WARNING: FIELDSTAGMEM==1 will be slower with non-stag method\n<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;<span class="stringliteral">  if(FIELDTOTHMEM==0 &amp;&amp; FLUXB==FLUXCTTOTH){</span></div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;<span class="stringliteral">    dualfprintf(fail_file,&quot;</span><a class="code" href="../../da/d3e/definit_8h.html#a59428b0097d315d6511709efb44e3da8" title="whether to define Toth memory stuff define FIELDTOTHMEM (!FIELDSTAGMEM) // CHANGINGMARK">FIELDTOTHMEM</a> should be 1 <span class="keywordflow">if</span> FLUXB==FLUXCTTOTH\n<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;<span class="stringliteral">    myexit(ERRORCODEBELOWCLEANFINISH+207);</span></div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;<span class="stringliteral">  if(ISSPCMCOORDNATIVE(MCOORD)){</span></div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;<span class="stringliteral">    //  if( (N1%2&gt;0 &amp;&amp; N1&gt;1) || (N2%2&gt;0 &amp;&amp; N2&gt;1) || (N3%2&gt;0 &amp;&amp; N3&gt;1) ){</span></div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;<span class="stringliteral">    if( (N2%2&gt;0 &amp;&amp; N2&gt;1) || (N3%2&gt;0 &amp;&amp; N3&gt;1) ){</span></div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;<span class="stringliteral">      dualfprintf(fail_file,&quot;</span><a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>, <a class="code" href="../../da/d3e/definit_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a>, <a class="code" href="../../da/d3e/definit_8h.html#ad66109fbdc4d3adc9c3d6ff917038aef">N3</a> should be even since some parts of code assume so <span class="keywordflow">for</span> SPC.\n<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;<span class="stringliteral">      myexit(ERRORCODEBELOWCLEANFINISH+208);</span></div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;<span class="stringliteral">  //  if(N1%2 &amp;&amp; N1&gt;1 || N2%2 &amp;&amp; N2&gt;1 || N3%2 &amp;&amp; N3&gt;1){</span></div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;<span class="stringliteral">  //  if(N2%2 &amp;&amp; N2&gt;1 || N3%2 &amp;&amp; N3&gt;1){</span></div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;<span class="stringliteral">  //    dualfprintf(fail_file,&quot;</span>Need even <a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>,<a class="code" href="../../da/d3e/definit_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a>,<a class="code" href="../../da/d3e/definit_8h.html#ad66109fbdc4d3adc9c3d6ff917038aef">N3</a> AFAIK N1=%d N2=%d <a class="code" href="../../da/d3e/definit_8h.html#ad66109fbdc4d3adc9c3d6ff917038aef">N3</a>=%d\n<span class="stringliteral">&quot;,N1,N2,N3);</span></div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;<span class="stringliteral">  //    myexit(ERRORCODEBELOWCLEANFINISH+19846286);</span></div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;<span class="stringliteral">  //  }</span></div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;<span class="stringliteral">  if(SUPERLONGDOUBLE){</span></div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;<span class="stringliteral">    dualfprintf(fail_file,&quot;</span>If doing <a class="code" href="../../da/d3e/definit_8h.html#aac4ade9fc783c4bc9f659af908c91ead" title="whether doing super long doubles">SUPERLONGDOUBLE</a>, then should have compiled as such\n<span class="stringliteral">&quot;);</span></div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;<span class="stringliteral">  if(ROEAVERAGEDWAVESPEED || ATHENAROE){</span></div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;<span class="stringliteral">    dualfprintf(fail_file,&quot;</span>ATHENA stuff only <span class="keywordflow">for</span> non-rel setup and <span class="keywordflow">while</span> was tested hasn<span class="stringliteral">&#39;t been used or kept up to date\n&quot;);</span></div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;<span class="stringliteral">    myexit(ERRORCODEBELOWCLEANFINISH+209);</span></div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;<span class="stringliteral">  if(STOREWAVESPEEDS==0 &amp;&amp; FLUXB==FLUXCTSTAG){</span></div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;<span class="stringliteral">    dualfprintf(fail_file,&quot;Must set STOREWAVESPEEDS==1 when doing FLUXCTSTAG\n&quot;);</span></div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;<span class="stringliteral">    myexit(ERRORCODEBELOWCLEANFINISH+210);</span></div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;<span class="stringliteral">  if(LIMADJUST!=LIMITERFIXED){</span></div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;<span class="stringliteral">    dualfprintf(fail_file,&quot;LIMADJUST old code\n&quot;);</span></div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;<span class="stringliteral">    myexit(ERRORCODEBELOWCLEANFINISH+211);</span></div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;<span class="stringliteral">  if(FLUXADJUST!=FLUXFIXED){</span></div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;<span class="stringliteral">    dualfprintf(fail_file,&quot;FLUXADJUST old code\n&quot;);</span></div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;<span class="stringliteral">    myexit(ERRORCODEBELOWCLEANFINISH+212);</span></div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;<span class="stringliteral">  if(DOEVOLVEMETRIC&amp;&amp; (WHICHEOM!=WITHGDET )){</span></div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;<span class="stringliteral">    dualfprintf(fail_file,&quot;conn2 not computed for time-dependent metric yet\n&quot;);</span></div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;<span class="stringliteral">    myexit(ERRORCODEBELOWCLEANFINISH+213);</span></div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;<span class="stringliteral">  if(CONNMACHINEBODY){</span></div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;<span class="stringliteral">    if(WHICHEOM!=WITHGDET){</span></div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;<span class="stringliteral">      dualfprintf(fail_file,&quot;Not setup for body correction when f is not detg\n&quot;);</span></div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;<span class="stringliteral">      myexit(ERRORCODEBELOWCLEANFINISH+215);</span></div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;<span class="stringliteral">  if(CONNMACHINEBODY&amp;&amp;(DOENOFLUX!=NOENOFLUX || MERGEDC2EA2CMETHOD)){</span></div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;<span class="stringliteral">    dualfprintf(fail_file,&quot;WARNING: MACHINEBODY with higher order scheme makes no sense\n&quot;);</span></div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;<span class="stringliteral">  if(CONTACTINDICATOR!=0){</span></div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;<span class="stringliteral">    dualfprintf(fail_file,&quot;Contact not recommended\n&quot;);</span></div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;<span class="stringliteral">  if(FLUXDUMP==1){</span></div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;<span class="stringliteral">    dualfprintf(fail_file,&quot;FLUXDUMP ACTIVE -- lots of extra output\n&quot;);</span></div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;<span class="stringliteral">  if(NUMPOTHER!=0){</span></div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;<span class="stringliteral">    dualfprintf(fail_file,&quot;NUMPOTHER ACTIVE -- lots of extra memory used\n&quot;);</span></div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;<span class="stringliteral">  if(LIMIT_FLUXC2A_PRIM_CHANGE){</span></div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;<span class="stringliteral">    dualfprintf(fail_file,&quot;LIMIT_FLUXC2A_PRIM_CHANGE doesn&#39;</span><a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a> work according to Sasha, so don<span class="stringliteral">&#39;t use\n&quot;);</span></div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;<span class="stringliteral">    myexit(ERRORCODEBELOWCLEANFINISH+216);</span></div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;<span class="stringliteral">  // check if </span></div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;<span class="stringliteral">  doingenough=1;</span></div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;<span class="stringliteral">  DIMENLOOP(dimen){</span></div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;<span class="stringliteral">    doingenough *= (interporder[avgscheme[dimen]]&gt;=interporder[WENO5BNDPLUSMIN] || doingdimen[dimen]==0);</span></div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;<span class="stringliteral">  if(WENO_EXTRA_A2C_MINIMIZATION==1 &amp;&amp; doingenough==0){</span></div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;<span class="stringliteral">    dualfprintf(fail_file,&quot;WENO_EXTRA_A2C_MINIMIZATION==1 and interporder=%d %d %d invalid\n&quot;,interporder[avgscheme[1]],interporder[avgscheme[2]],interporder[avgscheme[3]]);</span></div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;<span class="stringliteral">    myexit(ERRORCODEBELOWCLEANFINISH+217);</span></div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;<span class="stringliteral">  DIMENLOOP(dimen){</span></div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;<span class="stringliteral">    if(avgscheme[dimen]!=DONOR){ // using DONOR just turns off and assume standard way to turn off so no need to message user</span></div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;<span class="stringliteral">      if(avgscheme[dimen]&lt;FIRSTWENO || avgscheme[dimen]&gt;LASTWENO){</span></div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;<span class="stringliteral">        dualfprintf(fail_file,&quot;Choice of avgscheme[%d]=%d has no effect\n&quot;,dimen,avgscheme[dimen]);</span></div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;<span class="stringliteral">      }</span></div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;<span class="stringliteral">  }</span></div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;<span class="stringliteral">  </span></div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;<span class="stringliteral">  //  if( (FLUXB==FLUXCTHLL || FLUXB==FLUXCTTOTH || (FLUXB==FLUXCTSTAG &amp;&amp; extrazones4emf==1 &amp;&amp; )) &amp;&amp; EVOLVEWITHVPOT){ // avoid complicated conditional</span></div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;<span class="stringliteral">  if(EVOLVEWITHVPOT &amp;&amp; !(FLUXB==FLUXCTSTAG &amp;&amp; extrazones4emf==0) ){</span></div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;<span class="stringliteral">    // Even with FV or FLUXRECON method that relies on updating non-point fields, can&#39;</span><a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a> evolve with A_i since truncation error different rather than just machine error different.  This leads to large errors -- especially at boundaries? GODMARK -- not 100% sure <span class="keyword">this</span> is the problem <span class="keywordflow">for</span> test=1102 and <a class="code" href="../../da/d3e/definit_8h.html#a10c2a32787a08dc5ca8ee25788232ab5" title="whether to redefine fields from A_i during evolution currently only done after each full timestep to ...">EVOLVEWITHVPOT</a></div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Cannot evolve field using A_i for FLUXB==FLUXCTHLL or FLUXB==FLUXCTHLL since no single A_i evolved forward in time.  And cannot use with non-point field method since while single A_i updated, the update diverges at truncation error between updating A_i and updating the non-point-field -- this is especially bad for periodic boundary conditions where one must have machine error correct behavior at boundaries\n&quot;</span>);</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;    myexit(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2fbdc58f192261834f16a38fdaadca70">ERRORCODEBELOWCLEANFINISH</a>+218);</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;  }</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;  <span class="keywordflow">if</span>(splitmaem==0 &amp;&amp; (<a class="code" href="../../da/d3e/definit_8h.html#a8d53959951a9d1a35c19bbbe8be87a00" title="whether to split isotropic pressure off of flux for separate interpolation this splitting only used u...">SPLITPRESSURETERMINFLUXMA</a> || <a class="code" href="../../da/d3e/definit_8h.html#a482268622b131154f6618b6c3af8d77c" title="below not setup yet:">SPLITPRESSURETERMINFLUXEM</a>)){</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;To use SPLITPRESSURE must turn on splitmaem, which requires FLUXRECON\n&quot;</span>);</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;    myexit(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2fbdc58f192261834f16a38fdaadca70">ERRORCODEBELOWCLEANFINISH</a>+219);</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;  }</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;  <span class="keywordflow">if</span>(splitmaem==1){</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Noticed some tests are more accurate if don&#39;t split (splitmaem==0), like test=1102 in init.sasha.c when doing non-point field FLUXRECON method the density error is smaller by factor of 2 with splitmaem==0\n&quot;</span>);</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;  }</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;  <span class="comment">// when using FLUXRECON, WENO5BND lim/avg:</span></div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;  <span class="comment">// 32x16: splitmaem==1 (pressure split or not!): 5.164e-05   0.0005637    0.001195    0.001326    0.003499   0.0001439   0.0001438    0.000415</span></div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;  <span class="comment">// 32x16: splitmaem==0 (higherordersmooth or rough!): 8.369e-06   0.0005615    0.001208    0.001224    0.002977   0.0001433   0.0001431   0.0003529</span></div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d2/dbf/metric_8h.html#a720c791e54d46bbf744b0e3ed7050947">ISSPCMCOORD</a>(MCOORD) &amp;&amp; <a class="code" href="../../da/d3e/definit_8h.html#aee6278df23bb73c4b161e0161fbf83d2" title="whether to use sin/cos exactly symmetrized around pi/2 if one doesn&#39;t do this, then = pole can lead t...">ACCURATESINCOS</a>==0){</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Warning: if polar axis or r=0 singularity don&#39;t have \\detg=0 you should force it -- normally ACCURATESINCOS==1 does a good job of this, but still should have code to check\n&quot;</span>);</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;  }</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#a19213af1114071d7405e721d37bc0a68" title="0: full images, dumps, etc., few more key failure stderr/fail_file messages 1: only log density image...">FULLOUTPUT</a>!=0){</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;    <span class="comment">// then ensure that boundary zones are off if necessary</span></div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#a6c2751c5217b428c5f5faf66a08e2d90" title="0: don&#39;t do calculation 1: do">DOLUMVSR</a>){</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;      dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;lumvsr requires no boundary zones outputted so dump and lumvsr file can be used together\n&quot;</span>);</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;      myexit(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2fbdc58f192261834f16a38fdaadca70">ERRORCODEBELOWCLEANFINISH</a>+195815983);</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;    }</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#affb54fad9620541e1fcb17f854af9bfe" title="see diag_source()">DODISSVSR</a>){</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;      dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;dissvsr requires no boundary zones outputted so dump and dissvsr file can be used together\n&quot;</span>);</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;      myexit(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2fbdc58f192261834f16a38fdaadca70">ERRORCODEBELOWCLEANFINISH</a>+195815984);</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;    }</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;  }</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;  <span class="keywordflow">if</span>(2*N1&lt;N1BND || N1BND!=0 &amp;&amp; N1==1 || periodicx1==1 &amp;&amp; ncpux1&gt;1 &amp;&amp; <a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>&lt;<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#aa00aaa6c09563827fbe601635b149ef8">N1BND</a>){</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Code not setup to handle boundary cells N1BND=%d with only N1=%d\n&quot;</span>,<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#aa00aaa6c09563827fbe601635b149ef8">N1BND</a>,<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>);</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;    myexit(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2fbdc58f192261834f16a38fdaadca70">ERRORCODEBELOWCLEANFINISH</a>+246872462);</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;  }</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;  <span class="keywordflow">if</span>(2*N2&lt;N2BND || N2BND!=0 &amp;&amp; N2==1 || periodicx2==1 &amp;&amp; ncpux2&gt;1 &amp;&amp; <a class="code" href="../../da/d3e/definit_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a>&lt;<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a4053d825930f47a796f9f13678ef32e3">N2BND</a>){</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Code not setup to handle boundary cells N2BND=%d with only N2=%d\n&quot;</span>,<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a4053d825930f47a796f9f13678ef32e3">N2BND</a>,<a class="code" href="../../da/d3e/definit_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a>);</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;    myexit(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2fbdc58f192261834f16a38fdaadca70">ERRORCODEBELOWCLEANFINISH</a>+246872463);</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;  }</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;  <span class="keywordflow">if</span>(2*N3&lt;N3BND || N3BND!=0 &amp;&amp; N3==1 || periodicx3==1 &amp;&amp; ncpux3&gt;1 &amp;&amp; <a class="code" href="../../da/d3e/definit_8h.html#ad66109fbdc4d3adc9c3d6ff917038aef">N3</a>&lt;<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a90d132cb201447b8fe71388f1b0ffe93">N3BND</a>){</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Code not setup to handle boundary cells N3BND=%d with only N3=%d\n&quot;</span>,<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a90d132cb201447b8fe71388f1b0ffe93">N3BND</a>,<a class="code" href="../../da/d3e/definit_8h.html#ad66109fbdc4d3adc9c3d6ff917038aef">N3</a>);</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;    myexit(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2fbdc58f192261834f16a38fdaadca70">ERRORCODEBELOWCLEANFINISH</a>+246872464);</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;  }</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a1df4ff7337c70fd414bdb050e2344649" title="(non-perf critical or sensitive data types)">SENSITIVE</a>!=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ab1fc0687cd98ccf5c97f28fe7e6b1c08">LONGDOUBLETYPE</a>){</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;WARNING: With SENSITIVE!=LONGDOUBLETYPE you may have problems for some integral or counting quantities (e.g. DTd too small or many zones to integrate over)\n&quot;</span>);</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;  }</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;<span class="preprocessor">#if(MERGEDC2EA2CMETHOD==1)</span></div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;<span class="preprocessor"></span>  <span class="comment">//  if(splitmaem){</span></div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;  <span class="comment">//    dualfprintf(fail_file,&quot;MERGEDC2EA2CMETHOD==1 is not setup for splitmaem since it was assumed splitmaem only needed with old a2c method\n&quot;);</span></div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;  <span class="comment">//    myexit(ERRORCODEBELOWCLEANFINISH+346897346);</span></div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;  <span class="comment">//  }</span></div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;<span class="preprocessor">#if(MERGEDC2EA2CMETHOD==1 &amp;&amp; STOREFLUXSTATE==0)</span></div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;<span class="preprocessor"></span>  dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Must store flux state (STOREFLUXSTATE 1) if doing merged method\n&quot;</span>);</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;  myexit(9842511);</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;<span class="preprocessor">#if(STOREFLUXSTATE==0 &amp;&amp; STORESHOCKINDICATOR==1)</span></div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;<span class="preprocessor"></span>  dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Must store flux state (STOREFLUXSTATE 1) if storing shock indicator\n&quot;</span>);</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;  myexit(9842512);</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#a6fc838c14c5e9fc17d6d8bb3d868ec2f">PRODUCTION</a>&gt;0){</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a55732148d2616d6d1f5d2abbe8710850">DOENOFLUX</a> != <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#adacaaf8526353cfe870206f0cf4d2ca7" title="for DOENOFLUX: 0: no ENO flux reconstruction 1: reconstruct F for finite difference rep...">NOENOFLUX</a> &amp;&amp; <a class="code" href="../../d8/d5b/defs_8general_8h.html#a11c4e99e1493d0c1914ad1ab313ea472">FLUXB</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0b6762cef74e396f50a83864bb53fb6c">FLUXCTSTAG</a>){</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;      dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;NOTE: With PRODUCTION&gt;0, higher-order staggered field method won&#39;t compute ener file value of divB correctly because turned off diagnostic bounding to avoid excessive MPI calls to bound unew.  dump file will still be correct for MPI boundaries but not for real boundaries since unew not defined to be bounded by user\n&quot;</span>);</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;    }</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;  }</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#a6fc838c14c5e9fc17d6d8bb3d868ec2f">PRODUCTION</a>==0){</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;WARNING: PRODUCTION set to 0, code may be slower\n&quot;</span>);</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;  }</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#abd5f16739cf00a938800502b9a5ad811" title="whether to limit timestep using source term at t=0 and full flux term for future times">LIMITDTWITHSOURCETERM</a>){</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;WARNING: LIMITDTWITHSOURCETERM set to 1, code may be slower\n&quot;</span>);</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;  }</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;  <span class="comment">//  if(LIMITDTWITHSOURCETERM){</span></div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;  <span class="comment">//    dualfprintf(fail_file,&quot;LIMITDTWITHSOURCETERM==1 doesn&#39;t work right now\n&quot;);</span></div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;  <span class="comment">//    myexit(ERRORCODEBELOWCLEANFINISH+54986456);</span></div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;  <span class="comment">//  }</span></div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#a702c3f736ffae96949fb85f091aff230">DODISS</a> || <a class="code" href="../../da/d3e/definit_8h.html#a6c2751c5217b428c5f5faf66a08e2d90" title="0: don&#39;t do calculation 1: do">DOLUMVSR</a> || <a class="code" href="../../da/d3e/definit_8h.html#affb54fad9620541e1fcb17f854af9bfe" title="see diag_source()">DODISSVSR</a> || <a class="code" href="../../da/d3e/definit_8h.html#abf90251d9bf1eb0bf77da8cd95bb79a9" title="#define WHICHEOS MIGNONE define WHICHEOS GRBPWF99 define WHICHEOS KAZFULL">DOENTROPY</a>!=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#abad06a3d5a7c1f930198d04b94d4d15a" title="mnenomics for DOENTROPY">DONOENTROPY</a>){</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;WARNING: DODISS/DOLUMVSR/DODISSVSR/DOENTROPY!=DONOENTROPY set to 1, code may be slower\n&quot;</span>);</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;  }</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#a5dc18e6d15e4420586d45d912fccebac" title="whether to check on inversion and report problem Also, use diag_fixup() to account for changes in U w...">CHECKONINVERSION</a>){</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;WARNING: CHECKONINVERSION set to 1, code may be slower\n&quot;</span>);</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;  }</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#acab1350585a444504c59de674fa3266d" title="checks if solution is reasonble and fails a point if not only checks if b^2/&gt;&gt;BSQORHOMAX, etc.">CHECKSOLUTION</a>){</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;WARNING: CHECKSOLUTION set to 1, code may be slower\n&quot;</span>);</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;  }</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a8cbb473515f18fcae523329c93f140dc">DIMENLOOP</a>(dimen){</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#adedce549d7ca97c62ec54f15549703eb">interporder</a>[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a817404fd8a61abc2300c378e1eb2d122">lim</a>[dimen]]-1 &gt; <a class="code" href="../../d8/d5b/defs_8general_8h.html#ae202d8b69a0ef3f07651368c3de9ca25">TIMEORDER</a>){</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;      dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;WARNING: interporder[dimen=%d lim=%d]=%d -1 &gt; TIMEORDER=%d is unstable in region where Courant condition setting dt\n&quot;</span>,dimen,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a817404fd8a61abc2300c378e1eb2d122">lim</a>[dimen],<a class="code" href="../../d8/d5b/defs_8general_8h.html#adedce549d7ca97c62ec54f15549703eb">interporder</a>[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a817404fd8a61abc2300c378e1eb2d122">lim</a>[dimen]],<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae202d8b69a0ef3f07651368c3de9ca25">TIMEORDER</a>);</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;    }</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;  }</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d3/d67/global_8general_8h.html#a3c6ffc8b20b111286a30fc5aff6c1546" title="pre-global stuff:">DOINGLIAISON</a> &amp;&amp; USEMPI==0){</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;WARNING: DOINGLIAISON==1 but USEMPI==0\n&quot;</span>);</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;  }</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;  <span class="comment">// complain if b^2/rho b^2/u or u/rho too large for given resolution given experience with GRMHD torus problem</span></div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a8cbb473515f18fcae523329c93f140dc">DIMENLOOP</a>(dimen){</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0fe8d3c7642e667dd8ae3635506c4273">BSQORHOLIMIT</a>/30.0&gt;((<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>)<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[dimen])/64.0){</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;      dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;WARNING: BSQORHOLIMIT=%21.15g for totalsize[%d]=%d\n&quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0fe8d3c7642e667dd8ae3635506c4273">BSQORHOLIMIT</a>,dimen,<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[dimen]);</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;    }</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2ac5e41aa897e1fa82d748b7e38b9c6a">BSQOULIMIT</a>/100.0&gt;((<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>)<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[dimen])/64.0){</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;      dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;WARNING: BSQOULIMIT=%21.15g for totalsize[%d]=%d\n&quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2ac5e41aa897e1fa82d748b7e38b9c6a">BSQOULIMIT</a>,dimen,<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[dimen]);</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;    }</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a29e0b9f4e26a839ec5b98c698e90ca17">UORHOLIMIT</a>/100.0&gt;((<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>)<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[dimen])/64.0){</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;      dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;WARNING: UORHOLIMIT=%21.15g for totalsize[%d]=%d\n&quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a29e0b9f4e26a839ec5b98c698e90ca17">UORHOLIMIT</a>,dimen,<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[dimen]);</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;    }</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;  }</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#a9254c0f9b1e2cf49eb892d1e76e73bdc">MERGEDC2EA2CMETHOD</a> &amp;&amp; <a class="code" href="../../d8/d5b/defs_8general_8h.html#a55732148d2616d6d1f5d2abbe8710850">DOENOFLUX</a> != <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#adacaaf8526353cfe870206f0cf4d2ca7" title="for DOENOFLUX: 0: no ENO flux reconstruction 1: reconstruct F for finite difference rep...">NOENOFLUX</a>){</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Cannot do merged method with older weno-type c2a/a2c methods\n&quot;</span>);</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;    myexit(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2fbdc58f192261834f16a38fdaadca70">ERRORCODEBELOWCLEANFINISH</a>+289754897);</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;  }</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;  <span class="keywordflow">if</span>((<a class="code" href="../../da/d3e/definit_8h.html#a9254c0f9b1e2cf49eb892d1e76e73bdc">MERGEDC2EA2CMETHOD</a>==0) &amp;&amp; (<a class="code" href="../../da/d3e/definit_8h.html#a6ae00c1d2f6ed2e86a1c13086e102e3c" title="whether to do a2c during c2e see interpline.c">MERGEDC2EA2CMETHODMA</a>==1 || <a class="code" href="../../da/d3e/definit_8h.html#a304128fe38d260907b9b8f492ce5076d">MERGEDC2EA2CMETHODEM</a>==1) ){</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;MERGEDC2EA2CMETHOD,MA,EM set inconsistently: %d %d %d\n&quot;</span>,<a class="code" href="../../da/d3e/definit_8h.html#a9254c0f9b1e2cf49eb892d1e76e73bdc">MERGEDC2EA2CMETHOD</a>,<a class="code" href="../../da/d3e/definit_8h.html#a6ae00c1d2f6ed2e86a1c13086e102e3c" title="whether to do a2c during c2e see interpline.c">MERGEDC2EA2CMETHODMA</a>,<a class="code" href="../../da/d3e/definit_8h.html#a304128fe38d260907b9b8f492ce5076d">MERGEDC2EA2CMETHODEM</a>);</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;    myexit(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2fbdc58f192261834f16a38fdaadca70">ERRORCODEBELOWCLEANFINISH</a>+289754898);</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;  }</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a67cb78168551d0bd18591a73d82dccf1" title="ENO DEBUG GLOBAL VARS.">special3dspc</a> &amp;&amp; <a class="code" href="../../dd/d46/mpidefs_8h.html#abde3246ae6acb0425ffe363997b5f835">ncpux3</a>==1 &amp;&amp; (<a class="code" href="../../da/d3e/definit_8h.html#ad66109fbdc4d3adc9c3d6ff917038aef">N3</a>%2)){</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Must have even N3 (N3=%d) if special3dspc==1 &amp;&amp; ncpux3=1\n&quot;</span>,<a class="code" href="../../da/d3e/definit_8h.html#ad66109fbdc4d3adc9c3d6ff917038aef">N3</a>);</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;    myexit(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2fbdc58f192261834f16a38fdaadca70">ERRORCODEBELOWCLEANFINISH</a>+83746837);</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;  }</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a55732148d2616d6d1f5d2abbe8710850">DOENOFLUX</a> == <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ac634a307561f486f9df8ba8a67c21c19">ENOFINITEVOLUME</a> &amp;&amp; (<a class="code" href="../../da/d3e/definit_8h.html#a702c3f736ffae96949fb85f091aff230">DODISS</a> || <a class="code" href="../../da/d3e/definit_8h.html#affb54fad9620541e1fcb17f854af9bfe" title="see diag_source()">DODISSVSR</a>)){</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;WARNING: FV method does not allow accurate tracking of dissipation as code is currently written.  Overestimates compared to actual dissipation.\n&quot;</span>);</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;  }</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a11c4e99e1493d0c1914ad1ab313ea472">FLUXB</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0b6762cef74e396f50a83864bb53fb6c">FLUXCTSTAG</a> &amp;&amp; <a class="code" href="../../d8/d5b/defs_8general_8h.html#a67cb78168551d0bd18591a73d82dccf1" title="ENO DEBUG GLOBAL VARS.">special3dspc</a> &amp;&amp; (<a class="code" href="../../da/d3e/definit_8h.html#a47eb3650d14f676236387261e5d37427">COORDSINGFIX</a>==0 || <a class="code" href="../../da/d3e/definit_8h.html#ab279035c1cbedbf8f4aa5a04bb26b442" title="whether to move polar axis to a bit larger theta theta value where singularity is displaced to...">SINGSMALL</a>&lt;=0.0)){</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;IF3DSPCTHENMPITRANSFERATPOLE==1 with N3&gt;1 requires COORDSINGFIX&gt;0 and SINGSMALL&gt;0.0 in order for B2 to be evolved properly at the pole\n&quot;</span>);</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;    myexit(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2fbdc58f192261834f16a38fdaadca70">ERRORCODEBELOWCLEANFINISH</a>+978343943);</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;  }</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a11c4e99e1493d0c1914ad1ab313ea472">FLUXB</a>!=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0b6762cef74e396f50a83864bb53fb6c">FLUXCTSTAG</a> &amp;&amp; <a class="code" href="../../da/d3e/definit_8h.html#a47eb3650d14f676236387261e5d37427">COORDSINGFIX</a>==1 ){</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;WARNING: No need to have COORDSINGFIX==1 with non-staggered field\n&quot;</span>);</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;  }</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#a47eb3650d14f676236387261e5d37427">COORDSINGFIX</a>==1 &amp;&amp; (<a class="code" href="../../da/d3e/definit_8h.html#ad66109fbdc4d3adc9c3d6ff917038aef">N3</a>==1) &amp;&amp; <a class="code" href="../../d2/dbf/metric_8h.html#ac565810c37e91f851ac3bda28ec35e39">ISSPCMCOORDNATIVE</a>(MCOORD)){</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;WARNING: No need to have COORDSINGFIX==1 with 2D\n&quot;</span>);</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;  }</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>==1 &amp;&amp; <a class="code" href="../../dd/d46/mpidefs_8h.html#a849af7562e98534cd4ea5764f5187bbd">ncpux1</a>&gt;1 ||<a class="code" href="../../da/d3e/definit_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a>==1 &amp;&amp; <a class="code" href="../../dd/d46/mpidefs_8h.html#a2b69fb4a20e91ae01ef8452216afb784">ncpux2</a>&gt;1 ||<a class="code" href="../../da/d3e/definit_8h.html#ad66109fbdc4d3adc9c3d6ff917038aef">N3</a>==1 &amp;&amp; <a class="code" href="../../dd/d46/mpidefs_8h.html#abde3246ae6acb0425ffe363997b5f835">ncpux3</a>&gt;1){</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Must have N?&gt;1 if ncpux?&gt;1 for code to recognize that dimension\n&quot;</span>);</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;    myexit(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2fbdc58f192261834f16a38fdaadca70">ERRORCODEBELOWCLEANFINISH</a>+28347525);</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;  }</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a8cbb473515f18fcae523329c93f140dc">DIMENLOOP</a>(dimen){</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#ae2de95b221a0abc062f469a51675a473" title="whether want to use weno memory (required for c2e or a2c or c2a for weno/eno)">WENOMEMORY</a>==0 &amp;&amp; ( <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a4f08471d27464c32d301f3c4a2f06f50" title="defines limiters that are WENO/ENO">WENOINTERPTYPE</a>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a817404fd8a61abc2300c378e1eb2d122">lim</a>[dimen])||<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a4f08471d27464c32d301f3c4a2f06f50" title="defines limiters that are WENO/ENO">WENOINTERPTYPE</a>(avgscheme[dimen]))){</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;      dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Need to turn on WENOMEMORY when lim or avgscheme  = eno or weno\n&quot;</span>);</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;      myexit(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2fbdc58f192261834f16a38fdaadca70">ERRORCODEBELOWCLEANFINISH</a>+83763463);</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;    }</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;  }</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d3/d67/global_8general_8h.html#a126b8328170a52811a990e5dd302f783">USEOPENMP</a>){</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;WARNING: MYFUN function tracing for failures turned off because not allowed inside OpenMP constructs\n&quot;</span>);</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;  }</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;  <span class="comment">// GODMARK: No obvious way to check for ANALYTICMEMORY==0 since depends on user bounds.  Depend upon user to check for this.</span></div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;  <span class="keywordflow">if</span>(ALLOWKAZEOS &amp;&amp; <a class="code" href="../../d3/d67/global_8general_8h.html#a126b8328170a52811a990e5dd302f783">USEOPENMP</a>){</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;WARNING: If not using Kaz EOS, then setting ALLOWKAZEOS==1 will introduce more OpenMP overhead\n&quot;</span>);</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;  }</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../dd/d46/mpidefs_8h.html#a96e8ac8e9ae4bd597638862a4f451129">numopenmpthreads</a>==1 &amp;&amp; <a class="code" href="../../d3/d67/global_8general_8h.html#a126b8328170a52811a990e5dd302f783">USEOPENMP</a>==1){</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;WARNING: Using only 1 OpenMP thread: Excessive overhead due to pragma&#39;s: Recommend turning off USEOPENMP in makehead.inc.\n&quot;</span>);</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;  }</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#ae2cc56909ed67595b899f79bfe6fe8c3" title="whether to do ENO debug">DOGRIDSECTIONING</a> &amp;&amp; <a class="code" href="../../d8/d5b/defs_8general_8h.html#a11c4e99e1493d0c1914ad1ab313ea472">FLUXB</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a5014e44c6e710d8827ef79dd18abe6ad">FLUXCTTOTH</a>){</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;******SUPERWARNING******: If reveal region with Toth method, then divb can&#39;t be preserved due to how fluxes are averaged.\n&quot;</span>);</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;  }</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#ae2cc56909ed67595b899f79bfe6fe8c3" title="whether to do ENO debug">DOGRIDSECTIONING</a> &amp;&amp; <a class="code" href="../../d8/d5b/defs_8general_8h.html#a11c4e99e1493d0c1914ad1ab313ea472">FLUXB</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0b6762cef74e396f50a83864bb53fb6c">FLUXCTSTAG</a>){</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;******SUPERWARNING******: divb won&#39;t be zero for absorbed regions when using AVOIDADVANCESHIFTX???==1 as required since need those regions to inject solution with arbitrary velocity profile.\n&quot;</span>);</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;  }</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#a66e7984cbafffca6ab78f9f11d2dc397" title="whether to use analytic g^{} if available">ANALYTICGCON</a>==0){</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;******SUPERWARNING******: If far from black hole, even with apparently g^{t\\phi}\\sim 0 at the 10^{-34} level, still leads to exponential spurious growth in u^3 u_3 and B^3 to catastrophic levels!!  For KS metric with a\\neq 0, best to use analytical gcon that leads to exactly g^{t\\phi}=0 and so \\beta[\\phi]=0.\n&quot;</span>);</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;  }</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#ac1c413875e4d88f82853bf12d1df2eeb" title="which derivative type to use when computing connection coefficients define CONNDERTYPE DIFFGAMMIE...">CONNDERTYPE</a>!=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ae62e36a8fb8b0fa34b625c8934ce4947">DIFFNUMREC</a>){</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;WARNING: Using inaccurate CONNDERTYPE can lead to problems, such as force errors near poles can lead to secular errors growing.\n&quot;</span>);</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;  }</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;WARNING: Using DIFFNUMREC can be very slow, but more accurate than DIFFGAMMIE.\n&quot;</span>);</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;  }</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#aa394f1d919e05adcf57ae2731c0389e6" title="if WHICHEOM==WITHNOGDET, then below determines which EOMs get what geometric prefactor. Notice (as described in phys.c&#39;s source_conn() ) that geometry issue applies AFTER additions/subtractions of EOMs (as done by REMOVERESTMASSFROMUU).">WHICHEOM</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aea04d064e60276455dd06bbce582cc8c" title="for WHICHEOM">WITHGDET</a>){</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;WARNING: WHICHEOM==WITHGDET is inferior to WHICHEOM==WITHNOGDET and setting NOGDETU1=NOGDETU2=1 near the poles where force balance is difficult to ensure.  If pressure constant, then NOGDET method ensures force balance between flux and source terms.\n&quot;</span>);</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;  }</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;  </div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#a992fc9fe95d8223cc382010388a0913d" title="whether to store wave speeds over whole grid before computing flux useful to avoid extra calculations...">STOREWAVESPEEDS</a>==1){</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;WARNING: STOREWAVESPEEDS==1 has been found to be unstable due to how Riemann solver uses max-averaged wavespeeds.  You should use STOREWAVESPEEDS==2 or 0 .\n&quot;</span>);</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;  }</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;  </div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#abf90251d9bf1eb0bf77da8cd95bb79a9" title="#define WHICHEOS MIGNONE define WHICHEOS GRBPWF99 define WHICHEOS KAZFULL">DOENTROPY</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#abad06a3d5a7c1f930198d04b94d4d15a" title="mnenomics for DOENTROPY">DONOENTROPY</a> &amp;&amp; <a class="code" href="../../da/d3e/definit_8h.html#a87e5572748e4cc27373e50bd78e6f2e8">EOMTYPE</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a40b55e98bfcccde1a3f19d983ca7488c">EOMENTROPYGRMHD</a>){</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;ERROR: Must have DOENTROPY enabled to use EOMENTROPYGRMHD\n&quot;</span>);</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;    myexit(34897562);</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;  }</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#abf90251d9bf1eb0bf77da8cd95bb79a9" title="#define WHICHEOS MIGNONE define WHICHEOS GRBPWF99 define WHICHEOS KAZFULL">DOENTROPY</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#abad06a3d5a7c1f930198d04b94d4d15a" title="mnenomics for DOENTROPY">DONOENTROPY</a> &amp;&amp; <a class="code" href="../../da/d3e/definit_8h.html#a264372993369f0319459c6948ad8b74a" title="whether to try entropy inversion if hot fails">HOT2ENTROPY</a> &amp;&amp; <a class="code" href="../../da/d3e/definit_8h.html#a87e5572748e4cc27373e50bd78e6f2e8">EOMTYPE</a>!=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a757ad8b9c2c7611dad8aab853a87f61b">EOMCOLDGRMHD</a>){</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;ERROR: Must have DOENTROPY enabled to use HOT2ENTROPY\n&quot;</span>);</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;    myexit(13892345);</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;  }</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a538f4ebe3434f76ec67690f0651b53e7">UTOPRIMVERSION</a> == <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#abd3dcef411a08060eddd9a17eeb655c5" title="#define FLUXB FLUXCTTOTH 0: HLL 1: FLUXCT TOTH version (toth 2000 eq.">UTOPRIM5D1</a> &amp;&amp; <a class="code" href="../../da/d3e/definit_8h.html#a87e5572748e4cc27373e50bd78e6f2e8">EOMTYPE</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a40b55e98bfcccde1a3f19d983ca7488c">EOMENTROPYGRMHD</a>){</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;SUPERWARNING: Old 5D method often fails to find solution where solution to inversion does exist.  This can readily lead to completely wrong solutions due to failure fixups.\n&quot;</span>);</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;    myexit(3987634);</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;  }</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#ad7d4ae935d29d9f729e14124b737a430" title="which EOS (EoS) (equation of state) to use">WHICHEOS</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ac8c53bdabe3bb26474339d60e0e7b644">KAZFULL</a> &amp;&amp; <a class="code" href="../../da/d3e/definit_8h.html#a87e5572748e4cc27373e50bd78e6f2e8">EOMTYPE</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a757ad8b9c2c7611dad8aab853a87f61b">EOMCOLDGRMHD</a>){</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;For COLD GRMHD, turn off Kaz EOS\n&quot;</span>);</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;    myexit(9782362);</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;  }</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#a87e5572748e4cc27373e50bd78e6f2e8">EOMTYPE</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a757ad8b9c2c7611dad8aab853a87f61b">EOMCOLDGRMHD</a> &amp;&amp; <a class="code" href="../../da/d3e/definit_8h.html#abf90251d9bf1eb0bf77da8cd95bb79a9" title="#define WHICHEOS MIGNONE define WHICHEOS GRBPWF99 define WHICHEOS KAZFULL">DOENTROPY</a> == <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ac57b73455d6d2351b308f06439a37061">DOEVOLVEENTROPY</a> &amp;&amp; <a class="code" href="../../da/d3e/definit_8h.html#ad7d4ae935d29d9f729e14124b737a430" title="which EOS (EoS) (equation of state) to use">WHICHEOS</a>!=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0ae70f0fc915dfdaf16d03f5ee58a3f0">COLDEOS</a>){</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;For COLD GRMHD with fake entropy tracking, ensure WHICHEOS==COLDEOS\n&quot;</span>);</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;    myexit(872762211);</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;  }</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;  <span class="keywordflow">if</span>(TRACKVPOT==0 &amp;&amp; <a class="code" href="../../da/d3e/definit_8h.html#a10c2a32787a08dc5ca8ee25788232ab5" title="whether to redefine fields from A_i during evolution currently only done after each full timestep to ...">EVOLVEWITHVPOT</a>==1){</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Must turn on TRACKVPOT if EVOLVEWITHVPOT==1\n&quot;</span>);</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;    myexit(38974632);</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;  }</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#af495756c0121b5dcedcd66f1fae20f47" title="0: don&#39;t output super debug output 1: do">ALLOWMETRICROT</a>==1 &amp;&amp; (<a class="code" href="../../da/d3e/definit_8h.html#a603630960d67178468238e2b2fb3b77b" title="whether connection coefficients are computed as being axisymmetric Speeds-up connection calculation w...">CONNAXISYMM</a>==1 || <a class="code" href="../../da/d3e/definit_8h.html#a19afd8273f7777c921386631a82ea532" title="TODO:">DOMIXTHETAPHI</a>==0)){</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Generally must set CONNAXISYMM==0 and DOMIXTHETAPHI==1 if ALLOWMETRICROT==1 -- only special cases would override this.\n&quot;</span>);</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;    myexit(2467346463);</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;  }</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#a99ba7daf58b283bc831b8f507f5873a4" title="#define EOMTYPE EOMCOLDGRMHD">EOMRADTYPE</a>!=<a class="code" href="../../d4/d96/global_8nondepmnemonics_8rad_8h.html#a993e29ef4139116d822d89bccb92180d" title="radiation equations of motion">EOMRADNONE</a> &amp;&amp; URAD0&lt;0){</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;You seem to have not turned on radiation, causing URAD0&lt;0 and so not part of a normal evolved quantity\n&quot;</span>);</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;    myexit(373472252);</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;  }</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d4/d96/global_8nondepmnemonics_8rad_8h.html#a9ae397a98225a4645e8e3d718889a232">RADSHOCKFLAT</a>==0 &amp;&amp; <a class="code" href="../../da/d3e/definit_8h.html#a99ba7daf58b283bc831b8f507f5873a4" title="#define EOMTYPE EOMCOLDGRMHD">EOMRADTYPE</a>!=<a class="code" href="../../d4/d96/global_8nondepmnemonics_8rad_8h.html#a993e29ef4139116d822d89bccb92180d" title="radiation equations of motion">EOMRADNONE</a> &amp;&amp; <a class="code" href="../../d8/d5b/defs_8general_8h.html#ae202d8b69a0ef3f07651368c3de9ca25">TIMEORDER</a>&lt;3 &amp;&amp; (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a817404fd8a61abc2300c378e1eb2d122">lim</a>[1]&gt;<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a71d9e511e7e302cd831e83581219e70d">MC</a> || <a class="code" href="../../d8/d5b/defs_8general_8h.html#a817404fd8a61abc2300c378e1eb2d122">lim</a>[2]&gt;<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a71d9e511e7e302cd831e83581219e70d">MC</a> || <a class="code" href="../../d8/d5b/defs_8general_8h.html#a817404fd8a61abc2300c378e1eb2d122">lim</a>[3]&gt;<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a71d9e511e7e302cd831e83581219e70d">MC</a>)){</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;With radiation, need to use shock flattener with para and TIMEORDER=3 to avoid unphysical oscillations that lead to bad evolution and no radiation inversion.\n&quot;</span>);</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;    <span class="comment">// example test is RADBEAMFLAT with cour=0.8 and lim=PARALINE and TIMEORDER=2 which generates problems at beginning of test.  Also later in time generates consistent stripping and noise at much larger level compared to TIMEORDER=3.</span></div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;    <span class="comment">// generally want to have TIMEORDER\sim SPATIALORDER for consistent space-time errors.  Too much high spatial order at low temporal order can mean dominant temporal errors that interact poorly with attempt at higher spatial accuracy.</span></div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;    myexit(245834);</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;  }</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;    </div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../dc/dd8/mympi_8definit_8h.html#a125da10d4f20cf53facb2a408fdc3f52">USEROMIO</a>==1 &amp;&amp; <a class="code" href="../../d8/d5b/defs_8general_8h.html#a04767aafce2d594a681b4d39134050c8">binaryoutput</a>==<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#a2927c7a2f9bac08381bfb2e1a543e1e8">TEXTOUTPUT</a>){</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Cannot use text output with ROMIO\n&quot;</span>);</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;    myexit(98725235);</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;  }</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;  <span class="comment">// external checks</span></div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;  parainitchecks();</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;}</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;<span class="keywordtype">int</span> get_num_bnd_zones_used(<span class="keywordtype">int</span> dimen)</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;{</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;  <span class="keywordtype">int</span> avgo;</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;  <span class="keywordtype">int</span> interpo;</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;  <span class="keywordtype">int</span> totalo;</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;  <span class="keywordtype">int</span> doingdimen[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;  <span class="keywordtype">int</span> extraavgo;</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;  doingdimen[1]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a51b48b29d7903bb94a3d7879c3ff8eb9">N1NOT1</a>;</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;  doingdimen[2]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a9d8b7e3d088c68f51e7b29b95326a4ac">N2NOT1</a>;</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;  doingdimen[3]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#aabbd6bada71f73d78d57d14e9adc0c29">N3NOT1</a>;</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#afa531848f9f8c22b7302b80056ee67d1">useghostplusactive</a>){</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;    <span class="keywordflow">if</span>(doingdimen[dimen]){</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;      <span class="comment">// number of zones one way for finite volume scheme to convert Uavg -&gt; Upoint</span></div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;      avgo=(<a class="code" href="../../d8/d5b/defs_8general_8h.html#adedce549d7ca97c62ec54f15549703eb">interporder</a>[avgscheme[dimen]]-1)/2;</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;    }</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;    <span class="keywordflow">else</span> avgo=0; <span class="comment">// nothing done for this dimension, so no avg zones</span></div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;  }</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;  <span class="keywordflow">else</span> avgo=0; <span class="comment">// no need for extra zones</span></div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a41163ae4887e295df142ae7fc9b4829c">extrazones4emf</a>){</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;    <span class="keywordflow">if</span>(doingdimen[dimen]){</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;      <span class="comment">// number of zones one way for finite volume scheme to convert Uavg -&gt; Upoint</span></div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;      extraavgo=(<a class="code" href="../../d8/d5b/defs_8general_8h.html#adedce549d7ca97c62ec54f15549703eb">interporder</a>[avgscheme[dimen]]-1)/2;</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;    }</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;    <span class="keywordflow">else</span> extraavgo=0; <span class="comment">// nothing done for this dimension, so no avg zones</span></div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;  }</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;  <span class="keywordflow">else</span> extraavgo=0; <span class="comment">// no need for extra zones</span></div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;  <span class="comment">// number of zones one way to have for interpolation to get fluxes</span></div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;  <span class="comment">// need to get flux at i,j,k=-1 in any case, and need boundary zones from there, so 1 extra effective boundary zone for interpolation</span></div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;  <span class="keywordflow">if</span>(doingdimen[dimen]){</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;    interpo=(<a class="code" href="../../d8/d5b/defs_8general_8h.html#adedce549d7ca97c62ec54f15549703eb">interporder</a>[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a817404fd8a61abc2300c378e1eb2d122">lim</a>[dimen]]-1)/2+1;</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;  }</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;  <span class="keywordflow">else</span> interpo=0; <span class="comment">// then not doing this dimension</span></div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;  totalo=avgo+interpo+extraavgo;</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;  <span class="keywordflow">return</span>(totalo);</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;}</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;<span class="keywordtype">int</span> interp_loop_set(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;{</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;  <span class="keywordtype">int</span> avgo[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;  <span class="keywordtype">int</span> doingdimen[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;  <span class="keywordtype">int</span> dimen;</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;  <span class="keywordtype">int</span> dir;</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;  <span class="keywordtype">int</span> jj;</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;  <span class="keywordtype">int</span> avgoperdir[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;  <span class="keywordtype">int</span> odimen1,odimen2;</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;  doingdimen[1]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a51b48b29d7903bb94a3d7879c3ff8eb9">N1NOT1</a>;</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;  doingdimen[2]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a9d8b7e3d088c68f51e7b29b95326a4ac">N2NOT1</a>;</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;  doingdimen[3]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#aabbd6bada71f73d78d57d14e9adc0c29">N3NOT1</a>;</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;  <span class="comment">// the fluxloop[dir][FIJKDEL]&#39;s can be used for general purpose to get idel, jdel, kdel</span></div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a8cbb473515f18fcae523329c93f140dc">DIMENLOOP</a>(dimen){</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;    <span class="keywordflow">if</span>(doingdimen[dimen]){</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;      <span class="comment">// number of zones one way for finite volume scheme to convert Uavg -&gt; Upoint</span></div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;      avgo[dimen]=(<a class="code" href="../../d8/d5b/defs_8general_8h.html#adedce549d7ca97c62ec54f15549703eb">interporder</a>[avgscheme[dimen]]-1)/2;</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;    }</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;    <span class="keywordflow">else</span> avgo[dimen]=0; <span class="comment">// nothing done for this dimension, so no avg zones</span></div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;    trifprintf(<span class="stringliteral">&quot;dimen=%d lim=%d avgo=%d\n&quot;</span>,dimen,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a817404fd8a61abc2300c378e1eb2d122">lim</a>[dimen],avgo[dimen]);</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;  }</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;  <span class="comment">// always need fluxes in ghost+active if doing higher order methods</span></div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#afa531848f9f8c22b7302b80056ee67d1">useghostplusactive</a>){</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;    <span class="comment">// (interporder[avgscheme]-1)/2 is the number of points to the left and the number of ponits to the right that are needed for the finite volume scheme</span></div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;    <span class="comment">// scheme used to convert Uavg -&gt; Upoint requires extra zones</span></div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;    <span class="comment">//    avgo=(interporder[avgscheme]-1)/2;</span></div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;    <span class="comment">// i.e. if avgscheme=WENO5, then interporder[WENO5]=5 and the Uconsloop goes from -2 .. N+1 inclusive  and fluxes go from -2 to N+2 inclusive</span></div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;    <span class="comment">// same for WENO4</span></div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;    <span class="comment">// this is -avgo .. N-1+avgo for Uconsloop and -avgo .. N+avgo for fluxes</span></div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;    </div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;    <span class="comment">// note that if doing FLUXCTSTAG (FIELDSTAGMEM) then cross directions already expanded</span></div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;    <span class="comment">// merged method needs to store/compute state for full cell.  This is excessively computing final dissipative flux, but not major cost and this keeps loops simple</span></div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;    <span class="comment">// +SHIFT1/2/3 for fluxloop[dimen][F?E] is so flux computed on both lower and upper faces, which happens to only be required for IF3DSPCTHENMPITRANSFERATPOLE for upper pole</span></div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;    <span class="comment">// OUTM? already goes to upper face</span></div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;    dimen=1;</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a158ca926457b2c62875830147141748e">FIDEL</a>]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a2fb146af349ab49ff48fa36b12b9e4fe" title="x1">SHIFT1</a>;</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a90b513fe9dd3d28100473a9c72f3bda3">FJDEL</a>]=0;</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ada7f7c41064faa66235ca2a6e49ec5e9">FKDEL</a>]=0;</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ac3efe32c03ee3fa5f60a00e4673c6dd3">FFACE</a>]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a1df736ddba855d7b429869f9f09dbd66">FACE1</a>;</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aefa679918e336291a5fb0e5cfd0dc269">FIS</a>]=(-avgo[dimen]-<a class="code" href="../../da/d3e/definit_8h.html#a9254c0f9b1e2cf49eb892d1e76e73bdc">MERGEDC2EA2CMETHOD</a>)*<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a51b48b29d7903bb94a3d7879c3ff8eb9">N1NOT1</a>;</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aa9efa612e7e6b889d1fd42e644bf3cce">FIE</a>]=<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>-1 +<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a2fb146af349ab49ff48fa36b12b9e4fe" title="x1">SHIFT1</a> +(avgo[dimen]+1+<a class="code" href="../../da/d3e/definit_8h.html#a9254c0f9b1e2cf49eb892d1e76e73bdc">MERGEDC2EA2CMETHOD</a>)*<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a51b48b29d7903bb94a3d7879c3ff8eb9">N1NOT1</a>;</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a141f293b4491fd91a765cc74553edbea">FJS</a>]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#acbf84dd447babb415b924517d30ae07e">INFULL2</a>;</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;    fluxloop[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a82364cc36a73d5f4c269b5ad8b9f0dd4">FJE</a>]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#aa99c957b2837fd1878ee5c659baf71f2">OUTFULL2</a>;</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;    fluxloop[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ab2806eafbffb43c634853ab47d7fd7d7">FKS</a>]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a373c22aaf6aea03712ff54076864ae7c">INFULL3</a>;</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;    fluxloop[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8de59f913fa18843ee34d376002f5bbc">FKE</a>]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#af9b4b1cbfa52acafbd2b434f78e49392">OUTFULL3</a>;</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;    dimen=2;</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;    fluxloop[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a158ca926457b2c62875830147141748e">FIDEL</a>]=0;</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;    fluxloop[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a90b513fe9dd3d28100473a9c72f3bda3">FJDEL</a>]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a4601f340e88302d63182d0844c4e3c09" title="x2">SHIFT2</a>;</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;    fluxloop[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ada7f7c41064faa66235ca2a6e49ec5e9">FKDEL</a>]=0;</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;    fluxloop[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ac3efe32c03ee3fa5f60a00e4673c6dd3">FFACE</a>]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a5b4b42f50fd7667c7d22d8001811bc7e">FACE2</a>;</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;    fluxloop[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aefa679918e336291a5fb0e5cfd0dc269">FIS</a>]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a1cf005fa390f99c43c1dc90bb971c426">INFULL1</a>;</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;    fluxloop[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aa9efa612e7e6b889d1fd42e644bf3cce">FIE</a>]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a9c8f32b3fd97dc74d6a8d8dd709ad4f6">OUTFULL1</a>;</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;    fluxloop[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a141f293b4491fd91a765cc74553edbea">FJS</a>]=(-avgo[dimen]-<a class="code" href="../../da/d3e/definit_8h.html#a9254c0f9b1e2cf49eb892d1e76e73bdc">MERGEDC2EA2CMETHOD</a>)*<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a9d8b7e3d088c68f51e7b29b95326a4ac">N2NOT1</a>;</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;    fluxloop[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a82364cc36a73d5f4c269b5ad8b9f0dd4">FJE</a>]=<a class="code" href="../../da/d3e/definit_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a>-1 +<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a4601f340e88302d63182d0844c4e3c09" title="x2">SHIFT2</a> +(avgo[dimen]+1+<a class="code" href="../../da/d3e/definit_8h.html#a9254c0f9b1e2cf49eb892d1e76e73bdc">MERGEDC2EA2CMETHOD</a>)*<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a9d8b7e3d088c68f51e7b29b95326a4ac">N2NOT1</a>;</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;    fluxloop[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ab2806eafbffb43c634853ab47d7fd7d7">FKS</a>]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a373c22aaf6aea03712ff54076864ae7c">INFULL3</a>;</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;    fluxloop[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8de59f913fa18843ee34d376002f5bbc">FKE</a>]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#af9b4b1cbfa52acafbd2b434f78e49392">OUTFULL3</a>;</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;    dimen=3;</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;    fluxloop[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a158ca926457b2c62875830147141748e">FIDEL</a>]=0;</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;    fluxloop[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a90b513fe9dd3d28100473a9c72f3bda3">FJDEL</a>]=0;</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;    fluxloop[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ada7f7c41064faa66235ca2a6e49ec5e9">FKDEL</a>]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac3ff9bd198294b5b3a9c6a22b9cf456a" title="x3">SHIFT3</a>;</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;    fluxloop[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ac3efe32c03ee3fa5f60a00e4673c6dd3">FFACE</a>]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a630fdcefb04bdca66118cfd21476e8fd">FACE3</a>;</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;    fluxloop[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aefa679918e336291a5fb0e5cfd0dc269">FIS</a>]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a1cf005fa390f99c43c1dc90bb971c426">INFULL1</a>;</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;    fluxloop[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aa9efa612e7e6b889d1fd42e644bf3cce">FIE</a>]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a9c8f32b3fd97dc74d6a8d8dd709ad4f6">OUTFULL1</a>;</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;    fluxloop[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a141f293b4491fd91a765cc74553edbea">FJS</a>]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#acbf84dd447babb415b924517d30ae07e">INFULL2</a>;</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;    fluxloop[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a82364cc36a73d5f4c269b5ad8b9f0dd4">FJE</a>]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#aa99c957b2837fd1878ee5c659baf71f2">OUTFULL2</a>;</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;    fluxloop[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ab2806eafbffb43c634853ab47d7fd7d7">FKS</a>]=(-avgo[dimen]-<a class="code" href="../../da/d3e/definit_8h.html#a9254c0f9b1e2cf49eb892d1e76e73bdc">MERGEDC2EA2CMETHOD</a>)*<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#aabbd6bada71f73d78d57d14e9adc0c29">N3NOT1</a>;</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;    fluxloop[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8de59f913fa18843ee34d376002f5bbc">FKE</a>]=<a class="code" href="../../da/d3e/definit_8h.html#ad66109fbdc4d3adc9c3d6ff917038aef">N3</a>-1 +<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac3ff9bd198294b5b3a9c6a22b9cf456a" title="x3">SHIFT3</a> +(avgo[dimen]+1+<a class="code" href="../../da/d3e/definit_8h.html#a9254c0f9b1e2cf49eb892d1e76e73bdc">MERGEDC2EA2CMETHOD</a>)*<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#aabbd6bada71f73d78d57d14e9adc0c29">N3NOT1</a>;</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;  }</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;    <span class="comment">// Uconsloop for these methods just involve normal CZLOOP</span></div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;    <span class="comment">// inversion for this method just involves CZLOOP</span></div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;    dimen=1;</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a158ca926457b2c62875830147141748e">FIDEL</a>]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a2fb146af349ab49ff48fa36b12b9e4fe" title="x1">SHIFT1</a>;</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a90b513fe9dd3d28100473a9c72f3bda3">FJDEL</a>]=0;</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ada7f7c41064faa66235ca2a6e49ec5e9">FKDEL</a>]=0;</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ac3efe32c03ee3fa5f60a00e4673c6dd3">FFACE</a>]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a1df736ddba855d7b429869f9f09dbd66">FACE1</a>;</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aefa679918e336291a5fb0e5cfd0dc269">FIS</a>]=      -<a class="code" href="../../da/d3e/definit_8h.html#a9254c0f9b1e2cf49eb892d1e76e73bdc">MERGEDC2EA2CMETHOD</a>*<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a51b48b29d7903bb94a3d7879c3ff8eb9">N1NOT1</a>;</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aa9efa612e7e6b889d1fd42e644bf3cce">FIE</a>]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a072d0a827b86b0b903050166232b1185">OUTM1</a> +<a class="code" href="../../da/d3e/definit_8h.html#a9254c0f9b1e2cf49eb892d1e76e73bdc">MERGEDC2EA2CMETHOD</a>*<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a51b48b29d7903bb94a3d7879c3ff8eb9">N1NOT1</a>;</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a11c4e99e1493d0c1914ad1ab313ea472">FLUXB</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0b6762cef74e396f50a83864bb53fb6c">FLUXCTSTAG</a>){</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a141f293b4491fd91a765cc74553edbea">FJS</a>]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#acbf84dd447babb415b924517d30ae07e">INFULL2</a>;</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a82364cc36a73d5f4c269b5ad8b9f0dd4">FJE</a>]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#aa99c957b2837fd1878ee5c659baf71f2">OUTFULL2</a>;</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ab2806eafbffb43c634853ab47d7fd7d7">FKS</a>]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a373c22aaf6aea03712ff54076864ae7c">INFULL3</a>;</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8de59f913fa18843ee34d376002f5bbc">FKE</a>]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#af9b4b1cbfa52acafbd2b434f78e49392">OUTFULL3</a>;</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;    }</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;    <span class="keywordflow">else</span>{ <span class="comment">// then only averaging for FLUXCT so only need 1 additional off-direction point</span></div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a141f293b4491fd91a765cc74553edbea">FJS</a>]=-<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a4601f340e88302d63182d0844c4e3c09" title="x2">SHIFT2</a>;  <span class="comment">//atch: loop over additional row to provide enough fluxes for FLUXCT, etc. to operate near the boundary</span></div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a82364cc36a73d5f4c269b5ad8b9f0dd4">FJE</a>]=<a class="code" href="../../da/d3e/definit_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a>-1+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a4601f340e88302d63182d0844c4e3c09" title="x2">SHIFT2</a>; <span class="comment">// &quot; &quot; </span></div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ab2806eafbffb43c634853ab47d7fd7d7">FKS</a>]=-<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac3ff9bd198294b5b3a9c6a22b9cf456a" title="x3">SHIFT3</a>;     <span class="comment">// &quot; &quot;</span></div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8de59f913fa18843ee34d376002f5bbc">FKE</a>]=<a class="code" href="../../da/d3e/definit_8h.html#ad66109fbdc4d3adc9c3d6ff917038aef">N3</a>-1+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac3ff9bd198294b5b3a9c6a22b9cf456a" title="x3">SHIFT3</a>; <span class="comment">// &quot; &quot;</span></div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;    }</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;    dimen=2;</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a158ca926457b2c62875830147141748e">FIDEL</a>]=0;</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a90b513fe9dd3d28100473a9c72f3bda3">FJDEL</a>]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a4601f340e88302d63182d0844c4e3c09" title="x2">SHIFT2</a>;</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ada7f7c41064faa66235ca2a6e49ec5e9">FKDEL</a>]=0;</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ac3efe32c03ee3fa5f60a00e4673c6dd3">FFACE</a>]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a5b4b42f50fd7667c7d22d8001811bc7e">FACE2</a>;</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a141f293b4491fd91a765cc74553edbea">FJS</a>]=      -<a class="code" href="../../da/d3e/definit_8h.html#a9254c0f9b1e2cf49eb892d1e76e73bdc">MERGEDC2EA2CMETHOD</a>*<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a9d8b7e3d088c68f51e7b29b95326a4ac">N2NOT1</a>;</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a82364cc36a73d5f4c269b5ad8b9f0dd4">FJE</a>]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a5dd7b1565100c27239f0a9f0f6e9bc26">OUTM2</a> +<a class="code" href="../../da/d3e/definit_8h.html#a9254c0f9b1e2cf49eb892d1e76e73bdc">MERGEDC2EA2CMETHOD</a>*<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a9d8b7e3d088c68f51e7b29b95326a4ac">N2NOT1</a>;</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a11c4e99e1493d0c1914ad1ab313ea472">FLUXB</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0b6762cef74e396f50a83864bb53fb6c">FLUXCTSTAG</a>){</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aefa679918e336291a5fb0e5cfd0dc269">FIS</a>]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a1cf005fa390f99c43c1dc90bb971c426">INFULL1</a>;</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aa9efa612e7e6b889d1fd42e644bf3cce">FIE</a>]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a9c8f32b3fd97dc74d6a8d8dd709ad4f6">OUTFULL1</a>;</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ab2806eafbffb43c634853ab47d7fd7d7">FKS</a>]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a373c22aaf6aea03712ff54076864ae7c">INFULL3</a>;</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8de59f913fa18843ee34d376002f5bbc">FKE</a>]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#af9b4b1cbfa52acafbd2b434f78e49392">OUTFULL3</a>;</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;    }</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aefa679918e336291a5fb0e5cfd0dc269">FIS</a>]=-<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a2fb146af349ab49ff48fa36b12b9e4fe" title="x1">SHIFT1</a>;   <span class="comment">//atch: loop over additional row to provide enough fluxes for FLUXCT, etc. to operate near the boundary</span></div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aa9efa612e7e6b889d1fd42e644bf3cce">FIE</a>]=<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>-1+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a2fb146af349ab49ff48fa36b12b9e4fe" title="x1">SHIFT1</a>; <span class="comment">// &quot; &quot;</span></div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ab2806eafbffb43c634853ab47d7fd7d7">FKS</a>]=-<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac3ff9bd198294b5b3a9c6a22b9cf456a" title="x3">SHIFT3</a>;    <span class="comment">// &quot; &quot;</span></div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8de59f913fa18843ee34d376002f5bbc">FKE</a>]=<a class="code" href="../../da/d3e/definit_8h.html#ad66109fbdc4d3adc9c3d6ff917038aef">N3</a>-1+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac3ff9bd198294b5b3a9c6a22b9cf456a" title="x3">SHIFT3</a>;<span class="comment">// &quot; &quot;</span></div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;    }</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;    dimen=3;</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a158ca926457b2c62875830147141748e">FIDEL</a>]=0;</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a90b513fe9dd3d28100473a9c72f3bda3">FJDEL</a>]=0;</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ada7f7c41064faa66235ca2a6e49ec5e9">FKDEL</a>]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac3ff9bd198294b5b3a9c6a22b9cf456a" title="x3">SHIFT3</a>;</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ac3efe32c03ee3fa5f60a00e4673c6dd3">FFACE</a>]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a630fdcefb04bdca66118cfd21476e8fd">FACE3</a>;</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ab2806eafbffb43c634853ab47d7fd7d7">FKS</a>]=      -<a class="code" href="../../da/d3e/definit_8h.html#a9254c0f9b1e2cf49eb892d1e76e73bdc">MERGEDC2EA2CMETHOD</a>*<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#aabbd6bada71f73d78d57d14e9adc0c29">N3NOT1</a>;</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8de59f913fa18843ee34d376002f5bbc">FKE</a>]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a3feb1c90d4d61c0eb3b9838b7d7993ec">OUTM3</a> +<a class="code" href="../../da/d3e/definit_8h.html#a9254c0f9b1e2cf49eb892d1e76e73bdc">MERGEDC2EA2CMETHOD</a>*<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#aabbd6bada71f73d78d57d14e9adc0c29">N3NOT1</a>;</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a11c4e99e1493d0c1914ad1ab313ea472">FLUXB</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0b6762cef74e396f50a83864bb53fb6c">FLUXCTSTAG</a>){</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aefa679918e336291a5fb0e5cfd0dc269">FIS</a>]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a1cf005fa390f99c43c1dc90bb971c426">INFULL1</a>;</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aa9efa612e7e6b889d1fd42e644bf3cce">FIE</a>]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a9c8f32b3fd97dc74d6a8d8dd709ad4f6">OUTFULL1</a>;</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a141f293b4491fd91a765cc74553edbea">FJS</a>]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#acbf84dd447babb415b924517d30ae07e">INFULL2</a>;</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a82364cc36a73d5f4c269b5ad8b9f0dd4">FJE</a>]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#aa99c957b2837fd1878ee5c659baf71f2">OUTFULL2</a>;</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;    }</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aefa679918e336291a5fb0e5cfd0dc269">FIS</a>]=-<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a2fb146af349ab49ff48fa36b12b9e4fe" title="x1">SHIFT1</a>;   <span class="comment">//atch: loop over additional row to provide enough fluxes for FLUXCT, etc. to operate near the boundary</span></div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aa9efa612e7e6b889d1fd42e644bf3cce">FIE</a>]=<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>-1+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a2fb146af349ab49ff48fa36b12b9e4fe" title="x1">SHIFT1</a>;  <span class="comment">// &quot; &quot;</span></div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a141f293b4491fd91a765cc74553edbea">FJS</a>]=-<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a4601f340e88302d63182d0844c4e3c09" title="x2">SHIFT2</a>;      <span class="comment">// &quot; &quot;</span></div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a82364cc36a73d5f4c269b5ad8b9f0dd4">FJE</a>]=<a class="code" href="../../da/d3e/definit_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a>-1+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a4601f340e88302d63182d0844c4e3c09" title="x2">SHIFT2</a>;  <span class="comment">// &quot; &quot;</span></div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;    }</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;  }</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a8cbb473515f18fcae523329c93f140dc">DIMENLOOP</a>(dimen) <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a8cbb473515f18fcae523329c93f140dc">DIMENLOOP</a>(dir){</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;    avgoperdir[dir][dimen]=avgo[dir]*(dimen==dir);</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;  }</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;  <span class="comment">// fluxloop for staggered field&#39;s EMF when doing old dofluxreconevolvepointfield==0 method</span></div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a8cbb473515f18fcae523329c93f140dc">DIMENLOOP</a>(dimen){</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;    odimen1=dimen%3+1;</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;    odimen2=(dimen+1)%3+1;</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a2949e234d496b691cf10c1e4a4ff9b32">emffluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a158ca926457b2c62875830147141748e">FIDEL</a>]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[odimen1][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a158ca926457b2c62875830147141748e">FIDEL</a>],<a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[odimen2][FIDEL]);</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a2949e234d496b691cf10c1e4a4ff9b32">emffluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a90b513fe9dd3d28100473a9c72f3bda3">FJDEL</a>]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[odimen1][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a90b513fe9dd3d28100473a9c72f3bda3">FJDEL</a>],<a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[odimen2][FJDEL]);</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a2949e234d496b691cf10c1e4a4ff9b32">emffluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ada7f7c41064faa66235ca2a6e49ec5e9">FKDEL</a>]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[odimen1][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ada7f7c41064faa66235ca2a6e49ec5e9">FKDEL</a>],<a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[odimen2][FKDEL]);</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;    <span class="keywordflow">if</span>(dimen==1) <a class="code" href="../../d8/d5b/defs_8general_8h.html#a2949e234d496b691cf10c1e4a4ff9b32">emffluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ac3efe32c03ee3fa5f60a00e4673c6dd3">FFACE</a>]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a1068bcf25c9f187a8db0f422e0af64c8">CORN1</a>;</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(dimen==1) <a class="code" href="../../d8/d5b/defs_8general_8h.html#a2949e234d496b691cf10c1e4a4ff9b32">emffluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ac3efe32c03ee3fa5f60a00e4673c6dd3">FFACE</a>]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ab10e4ab484f1edd4cecb418ff22a743a">CORN2</a>;</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(dimen==1) <a class="code" href="../../d8/d5b/defs_8general_8h.html#a2949e234d496b691cf10c1e4a4ff9b32">emffluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ac3efe32c03ee3fa5f60a00e4673c6dd3">FFACE</a>]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a1a05e117efd4dbc39b7c590141004470">CORN3</a>;</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a41163ae4887e295df142ae7fc9b4829c">extrazones4emf</a>){</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;      <span class="comment">// then need defined at more positions</span></div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a2949e234d496b691cf10c1e4a4ff9b32">emffluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aefa679918e336291a5fb0e5cfd0dc269">FIS</a>]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[odimen1][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aefa679918e336291a5fb0e5cfd0dc269">FIS</a>]-avgoperdir[odimen1][1],<a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[odimen2][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aefa679918e336291a5fb0e5cfd0dc269">FIS</a>]-avgoperdir[odimen2][1]);</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a2949e234d496b691cf10c1e4a4ff9b32">emffluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aa9efa612e7e6b889d1fd42e644bf3cce">FIE</a>]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[odimen1][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aa9efa612e7e6b889d1fd42e644bf3cce">FIE</a>]+avgoperdir[odimen1][1],<a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[odimen2][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aa9efa612e7e6b889d1fd42e644bf3cce">FIE</a>]+avgoperdir[odimen2][1]);</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a2949e234d496b691cf10c1e4a4ff9b32">emffluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a141f293b4491fd91a765cc74553edbea">FJS</a>]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[odimen1][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a141f293b4491fd91a765cc74553edbea">FJS</a>]-avgoperdir[odimen1][2],<a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[odimen2][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a141f293b4491fd91a765cc74553edbea">FJS</a>]-avgoperdir[odimen2][2]);</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a2949e234d496b691cf10c1e4a4ff9b32">emffluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a82364cc36a73d5f4c269b5ad8b9f0dd4">FJE</a>]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[odimen1][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a82364cc36a73d5f4c269b5ad8b9f0dd4">FJE</a>]+avgoperdir[odimen1][2],<a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[odimen2][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a82364cc36a73d5f4c269b5ad8b9f0dd4">FJE</a>]+avgoperdir[odimen2][2]);</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a2949e234d496b691cf10c1e4a4ff9b32">emffluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ab2806eafbffb43c634853ab47d7fd7d7">FKS</a>]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[odimen1][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ab2806eafbffb43c634853ab47d7fd7d7">FKS</a>]-avgoperdir[odimen1][3],<a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[odimen2][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ab2806eafbffb43c634853ab47d7fd7d7">FKS</a>]-avgoperdir[odimen2][3]);</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a2949e234d496b691cf10c1e4a4ff9b32">emffluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8de59f913fa18843ee34d376002f5bbc">FKE</a>]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[odimen1][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8de59f913fa18843ee34d376002f5bbc">FKE</a>]+avgoperdir[odimen1][3],<a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[odimen2][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8de59f913fa18843ee34d376002f5bbc">FKE</a>]+avgoperdir[odimen2][3]);</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;    }</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a2949e234d496b691cf10c1e4a4ff9b32">emffluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aefa679918e336291a5fb0e5cfd0dc269">FIS</a>]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[odimen1][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aefa679918e336291a5fb0e5cfd0dc269">FIS</a>],<a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[odimen2][FIS]);</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a2949e234d496b691cf10c1e4a4ff9b32">emffluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aa9efa612e7e6b889d1fd42e644bf3cce">FIE</a>]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[odimen1][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aa9efa612e7e6b889d1fd42e644bf3cce">FIE</a>],<a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[odimen2][FIE]);</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a2949e234d496b691cf10c1e4a4ff9b32">emffluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a141f293b4491fd91a765cc74553edbea">FJS</a>]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[odimen1][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a141f293b4491fd91a765cc74553edbea">FJS</a>],<a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[odimen2][FJS]);</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a2949e234d496b691cf10c1e4a4ff9b32">emffluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a82364cc36a73d5f4c269b5ad8b9f0dd4">FJE</a>]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[odimen1][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a82364cc36a73d5f4c269b5ad8b9f0dd4">FJE</a>],<a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[odimen2][FJE]);</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a2949e234d496b691cf10c1e4a4ff9b32">emffluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ab2806eafbffb43c634853ab47d7fd7d7">FKS</a>]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[odimen1][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ab2806eafbffb43c634853ab47d7fd7d7">FKS</a>],<a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[odimen2][FKS]);</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a2949e234d496b691cf10c1e4a4ff9b32">emffluxloop</a>[dimen][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8de59f913fa18843ee34d376002f5bbc">FKE</a>]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[odimen1][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8de59f913fa18843ee34d376002f5bbc">FKE</a>],<a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[odimen2][FKE]);</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;    }</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;  }</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;  <span class="comment">// Define range over which &quot;average&quot; conserved quantities are *evolved*/updated from some flux.  See advance.c.</span></div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;  <span class="comment">// Defines cell centers where conserved quantity exists</span></div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;  <span class="comment">// Don&#39;t really need to evolve ghost+active region if FLUXRECON method unless FLUXRECON&amp;&amp;(FLUXB==FLUXCTSTAG), but not a problem to be a bit excessive</span></div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;  <span class="comment">// if doing FLUXRECON &amp;&amp; evolving point field, then no need to evolve ghost+active region -- latest method</span></div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;<span class="comment"></span>  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#afa531848f9f8c22b7302b80056ee67d1">useghostplusactive</a>==0 || (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a55732148d2616d6d1f5d2abbe8710850">DOENOFLUX</a> == <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a81c6be7c38a1e29b40efa57ca47d0d02">ENOFLUXRECON</a> &amp;&amp; <a class="code" href="../../d8/d5b/defs_8general_8h.html#a41163ae4887e295df142ae7fc9b4829c">extrazones4emf</a>==0 &amp;&amp; <a class="code" href="../../d8/d5b/defs_8general_8h.html#ad5c8369abdf1833b4afc10d11d52b537">dofluxreconevolvepointfield</a>==1) ){</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ab5c60dcb37b1f7e5642525031cd5cbcf">Uconsevolveloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ac3efe32c03ee3fa5f60a00e4673c6dd3">FFACE</a>]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8936711f57f82d1fc75c21fa2894e1c6">CENT</a>;</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;    dimen=1;</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ab5c60dcb37b1f7e5642525031cd5cbcf">Uconsevolveloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aefa679918e336291a5fb0e5cfd0dc269">FIS</a>]=0;</div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ab5c60dcb37b1f7e5642525031cd5cbcf">Uconsevolveloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aa9efa612e7e6b889d1fd42e644bf3cce">FIE</a>]=<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>-1;</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;    dimen=2;</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ab5c60dcb37b1f7e5642525031cd5cbcf">Uconsevolveloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a141f293b4491fd91a765cc74553edbea">FJS</a>]=0;</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ab5c60dcb37b1f7e5642525031cd5cbcf">Uconsevolveloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a82364cc36a73d5f4c269b5ad8b9f0dd4">FJE</a>]=<a class="code" href="../../da/d3e/definit_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a>-1;</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;    dimen=3;</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ab5c60dcb37b1f7e5642525031cd5cbcf">Uconsevolveloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ab2806eafbffb43c634853ab47d7fd7d7">FKS</a>]=0;</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ab5c60dcb37b1f7e5642525031cd5cbcf">Uconsevolveloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8de59f913fa18843ee34d376002f5bbc">FKE</a>]=<a class="code" href="../../da/d3e/definit_8h.html#ad66109fbdc4d3adc9c3d6ff917038aef">N3</a>-1;</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;  }</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;    <span class="comment">// expanded loop using expanded range of fluxes so update Uf and ucum in layer of ghost zones so don&#39;t have to bound flux or Uf/Ui/ucum</span></div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;    <span class="comment">// only needed for FLUXRECON with STAG field method and only for fields, but do all for simplicity</span></div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;    </div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;    <span class="comment">// inversion for this method just involves CZLOOP</span></div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;    <span class="comment">// loop over averaged U to get Uf</span></div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;    <span class="comment">//    Uconsevolveloop[FIDEL]=0;</span></div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;    <span class="comment">//    Uconsevolveloop[FJDEL]=0;</span></div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;    <span class="comment">//    Uconsevolveloop[FKDEL]=0;</span></div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ab5c60dcb37b1f7e5642525031cd5cbcf">Uconsevolveloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ac3efe32c03ee3fa5f60a00e4673c6dd3">FFACE</a>]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8936711f57f82d1fc75c21fa2894e1c6">CENT</a>;</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;    dimen=1;</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ab5c60dcb37b1f7e5642525031cd5cbcf">Uconsevolveloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aefa679918e336291a5fb0e5cfd0dc269">FIS</a>]=-avgo[dimen]*<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a51b48b29d7903bb94a3d7879c3ff8eb9">N1NOT1</a>;</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ab5c60dcb37b1f7e5642525031cd5cbcf">Uconsevolveloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aa9efa612e7e6b889d1fd42e644bf3cce">FIE</a>]=<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>-1+avgo[dimen]*<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a51b48b29d7903bb94a3d7879c3ff8eb9">N1NOT1</a>;</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;    dimen=2;</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ab5c60dcb37b1f7e5642525031cd5cbcf">Uconsevolveloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a141f293b4491fd91a765cc74553edbea">FJS</a>]=-avgo[dimen]*<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a9d8b7e3d088c68f51e7b29b95326a4ac">N2NOT1</a>;</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ab5c60dcb37b1f7e5642525031cd5cbcf">Uconsevolveloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a82364cc36a73d5f4c269b5ad8b9f0dd4">FJE</a>]=<a class="code" href="../../da/d3e/definit_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a>-1+avgo[dimen]*<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a9d8b7e3d088c68f51e7b29b95326a4ac">N2NOT1</a>;</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;    dimen=3;</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ab5c60dcb37b1f7e5642525031cd5cbcf">Uconsevolveloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ab2806eafbffb43c634853ab47d7fd7d7">FKS</a>]=-avgo[dimen]*<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#aabbd6bada71f73d78d57d14e9adc0c29">N3NOT1</a>;</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ab5c60dcb37b1f7e5642525031cd5cbcf">Uconsevolveloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8de59f913fa18843ee34d376002f5bbc">FKE</a>]=<a class="code" href="../../da/d3e/definit_8h.html#ad66109fbdc4d3adc9c3d6ff917038aef">N3</a>-1+avgo[dimen]*<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#aabbd6bada71f73d78d57d14e9adc0c29">N3NOT1</a>;</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;  }</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;</div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;  <span class="comment">// Define ghost+active region over which face (interpolated from center or natively existing in FLUXCTSTAG case) values of primitives are needed as necessary to define the final dissipative flux.</span></div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;  <span class="comment">// Does not need to be modified for merged method&#39;s use of more primitives used ultimately to get this same flux position through temporary left-right fluxes on a larger grid</span></div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;<span class="comment"></span>  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#afa531848f9f8c22b7302b80056ee67d1">useghostplusactive</a>){</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;</div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;    <span class="comment">// scheme used to convert Uavg -&gt; Upoint requires extra zones</span></div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;    <span class="comment">//    avgo=(interporder[avgscheme]-1)/2;</span></div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;    <span class="comment">// i.e. if avgscheme=WENO5, then interporder[WENO5]=5 and the Uconsloop goes from -2 .. N+1 inclusive  and fluxes go from -2 to N+2 inclusive</span></div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;    <span class="comment">// same for WENO4</span></div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;    <span class="comment">// this is -avgo .. N-1+avgo for Uconsloop and -avgo .. N+avgo for fluxes</span></div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;    <span class="comment">// loop over averaged U to get Uf</span></div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;    <span class="comment">//    Uconsloop[FIDEL]=0;</span></div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;    <span class="comment">//    Uconsloop[FJDEL]=0;</span></div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;    <span class="comment">//    Uconsloop[FKDEL]=0;</span></div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa8c4a7427588dceecfe6dd86c906515b">Uconsloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ac3efe32c03ee3fa5f60a00e4673c6dd3">FFACE</a>]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8936711f57f82d1fc75c21fa2894e1c6">CENT</a>;</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;    dimen=1;</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa8c4a7427588dceecfe6dd86c906515b">Uconsloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aefa679918e336291a5fb0e5cfd0dc269">FIS</a>]=-avgo[dimen]*<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a51b48b29d7903bb94a3d7879c3ff8eb9">N1NOT1</a>;</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa8c4a7427588dceecfe6dd86c906515b">Uconsloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aa9efa612e7e6b889d1fd42e644bf3cce">FIE</a>]=<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>-1+avgo[dimen]*<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a51b48b29d7903bb94a3d7879c3ff8eb9">N1NOT1</a>;</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;    dimen=2;</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa8c4a7427588dceecfe6dd86c906515b">Uconsloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a141f293b4491fd91a765cc74553edbea">FJS</a>]=-avgo[dimen]*<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a9d8b7e3d088c68f51e7b29b95326a4ac">N2NOT1</a>;</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa8c4a7427588dceecfe6dd86c906515b">Uconsloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a82364cc36a73d5f4c269b5ad8b9f0dd4">FJE</a>]=<a class="code" href="../../da/d3e/definit_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a>-1+avgo[dimen]*<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a9d8b7e3d088c68f51e7b29b95326a4ac">N2NOT1</a>;</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;    dimen=3;</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa8c4a7427588dceecfe6dd86c906515b">Uconsloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ab2806eafbffb43c634853ab47d7fd7d7">FKS</a>]=-avgo[dimen]*<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#aabbd6bada71f73d78d57d14e9adc0c29">N3NOT1</a>;</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa8c4a7427588dceecfe6dd86c906515b">Uconsloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8de59f913fa18843ee34d376002f5bbc">FKE</a>]=<a class="code" href="../../da/d3e/definit_8h.html#ad66109fbdc4d3adc9c3d6ff917038aef">N3</a>-1+avgo[dimen]*<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#aabbd6bada71f73d78d57d14e9adc0c29">N3NOT1</a>;</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;    <span class="comment">// inversion for this method just involves CZLOOP</span></div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;  }</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa8c4a7427588dceecfe6dd86c906515b">Uconsloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ac3efe32c03ee3fa5f60a00e4673c6dd3">FFACE</a>]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8936711f57f82d1fc75c21fa2894e1c6">CENT</a>;</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;    dimen=1;</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa8c4a7427588dceecfe6dd86c906515b">Uconsloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aefa679918e336291a5fb0e5cfd0dc269">FIS</a>]=0;</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa8c4a7427588dceecfe6dd86c906515b">Uconsloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aa9efa612e7e6b889d1fd42e644bf3cce">FIE</a>]=<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>-1;</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;    dimen=2;</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa8c4a7427588dceecfe6dd86c906515b">Uconsloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a141f293b4491fd91a765cc74553edbea">FJS</a>]=0;</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa8c4a7427588dceecfe6dd86c906515b">Uconsloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a82364cc36a73d5f4c269b5ad8b9f0dd4">FJE</a>]=<a class="code" href="../../da/d3e/definit_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a>-1;</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;    dimen=3;</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa8c4a7427588dceecfe6dd86c906515b">Uconsloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ab2806eafbffb43c634853ab47d7fd7d7">FKS</a>]=0;</div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa8c4a7427588dceecfe6dd86c906515b">Uconsloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8de59f913fa18843ee34d376002f5bbc">FKE</a>]=<a class="code" href="../../da/d3e/definit_8h.html#ad66109fbdc4d3adc9c3d6ff917038aef">N3</a>-1;</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;  }</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;  </div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a41163ae4887e295df142ae7fc9b4829c">extrazones4emf</a>){</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ab7fad34655d8f0a07b50313508cb5ecc">emfUconsloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ac3efe32c03ee3fa5f60a00e4673c6dd3">FFACE</a>]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8936711f57f82d1fc75c21fa2894e1c6">CENT</a>;</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;    dimen=1;</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ab7fad34655d8f0a07b50313508cb5ecc">emfUconsloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aefa679918e336291a5fb0e5cfd0dc269">FIS</a>]=<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa8c4a7427588dceecfe6dd86c906515b">Uconsloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aefa679918e336291a5fb0e5cfd0dc269">FIS</a>]-avgo[dimen]*<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a51b48b29d7903bb94a3d7879c3ff8eb9">N1NOT1</a>;</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ab7fad34655d8f0a07b50313508cb5ecc">emfUconsloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aa9efa612e7e6b889d1fd42e644bf3cce">FIE</a>]=<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa8c4a7427588dceecfe6dd86c906515b">Uconsloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aa9efa612e7e6b889d1fd42e644bf3cce">FIE</a>]+avgo[dimen]*<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a51b48b29d7903bb94a3d7879c3ff8eb9">N1NOT1</a>;</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;    dimen=2;</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ab7fad34655d8f0a07b50313508cb5ecc">emfUconsloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a141f293b4491fd91a765cc74553edbea">FJS</a>]=<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa8c4a7427588dceecfe6dd86c906515b">Uconsloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a141f293b4491fd91a765cc74553edbea">FJS</a>]-avgo[dimen]*<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a9d8b7e3d088c68f51e7b29b95326a4ac">N2NOT1</a>;</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ab7fad34655d8f0a07b50313508cb5ecc">emfUconsloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a82364cc36a73d5f4c269b5ad8b9f0dd4">FJE</a>]=<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa8c4a7427588dceecfe6dd86c906515b">Uconsloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a82364cc36a73d5f4c269b5ad8b9f0dd4">FJE</a>]+avgo[dimen]*<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a9d8b7e3d088c68f51e7b29b95326a4ac">N2NOT1</a>;</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;    dimen=3;</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ab7fad34655d8f0a07b50313508cb5ecc">emfUconsloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ab2806eafbffb43c634853ab47d7fd7d7">FKS</a>]=<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa8c4a7427588dceecfe6dd86c906515b">Uconsloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ab2806eafbffb43c634853ab47d7fd7d7">FKS</a>]-avgo[dimen]*<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#aabbd6bada71f73d78d57d14e9adc0c29">N3NOT1</a>;</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ab7fad34655d8f0a07b50313508cb5ecc">emfUconsloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8de59f913fa18843ee34d376002f5bbc">FKE</a>]=<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa8c4a7427588dceecfe6dd86c906515b">Uconsloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8de59f913fa18843ee34d376002f5bbc">FKE</a>]+avgo[dimen]*<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#aabbd6bada71f73d78d57d14e9adc0c29">N3NOT1</a>;</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;  }</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ab7fad34655d8f0a07b50313508cb5ecc">emfUconsloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ac3efe32c03ee3fa5f60a00e4673c6dd3">FFACE</a>]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8936711f57f82d1fc75c21fa2894e1c6">CENT</a>;</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;    dimen=1;</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ab7fad34655d8f0a07b50313508cb5ecc">emfUconsloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aefa679918e336291a5fb0e5cfd0dc269">FIS</a>]=<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa8c4a7427588dceecfe6dd86c906515b">Uconsloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aefa679918e336291a5fb0e5cfd0dc269">FIS</a>];</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ab7fad34655d8f0a07b50313508cb5ecc">emfUconsloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aa9efa612e7e6b889d1fd42e644bf3cce">FIE</a>]=<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa8c4a7427588dceecfe6dd86c906515b">Uconsloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aa9efa612e7e6b889d1fd42e644bf3cce">FIE</a>];</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;    dimen=2;</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ab7fad34655d8f0a07b50313508cb5ecc">emfUconsloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a141f293b4491fd91a765cc74553edbea">FJS</a>]=<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa8c4a7427588dceecfe6dd86c906515b">Uconsloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a141f293b4491fd91a765cc74553edbea">FJS</a>];</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ab7fad34655d8f0a07b50313508cb5ecc">emfUconsloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a82364cc36a73d5f4c269b5ad8b9f0dd4">FJE</a>]=<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa8c4a7427588dceecfe6dd86c906515b">Uconsloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a82364cc36a73d5f4c269b5ad8b9f0dd4">FJE</a>];</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;    dimen=3;</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ab7fad34655d8f0a07b50313508cb5ecc">emfUconsloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ab2806eafbffb43c634853ab47d7fd7d7">FKS</a>]=<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa8c4a7427588dceecfe6dd86c906515b">Uconsloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ab2806eafbffb43c634853ab47d7fd7d7">FKS</a>];</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ab7fad34655d8f0a07b50313508cb5ecc">emfUconsloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8de59f913fa18843ee34d376002f5bbc">FKE</a>]=<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa8c4a7427588dceecfe6dd86c906515b">Uconsloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8de59f913fa18843ee34d376002f5bbc">FKE</a>];</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;  }</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a8cbb473515f18fcae523329c93f140dc">DIMENLOOP</a>(dimen){</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;    <span class="keywordflow">for</span>(jj=0;jj&lt;<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a002fc21c3c89d3e35466cd2c7e31c32a" title="see interp_loop_set() in initbase.c">NUMFLUXLOOPNUMBERS</a>;jj++) trifprintf(<span class="stringliteral">&quot;fluxloop[dimen=%d][%d] = %d\n&quot;</span>,dimen,jj,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a3b45f45c6ed9393abcf05daa2f4d9d95">fluxloop</a>[dimen][jj]);</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;  }</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a8cbb473515f18fcae523329c93f140dc">DIMENLOOP</a>(dimen){</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;    <span class="keywordflow">for</span>(jj=0;jj&lt;<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a002fc21c3c89d3e35466cd2c7e31c32a" title="see interp_loop_set() in initbase.c">NUMFLUXLOOPNUMBERS</a>;jj++) trifprintf(<span class="stringliteral">&quot;emffluxloop[dimen=%d][%d] = %d\n&quot;</span>,dimen,jj,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2949e234d496b691cf10c1e4a4ff9b32">emffluxloop</a>[dimen][jj]);</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;  }</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;  <span class="keywordflow">for</span>(jj=0;jj&lt;<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a002fc21c3c89d3e35466cd2c7e31c32a" title="see interp_loop_set() in initbase.c">NUMFLUXLOOPNUMBERS</a>;jj++) trifprintf(<span class="stringliteral">&quot;Uconsevolveloop[%d] = %d\n&quot;</span>,jj,<a class="code" href="../../d8/d5b/defs_8general_8h.html#ab5c60dcb37b1f7e5642525031cd5cbcf">Uconsevolveloop</a>[jj]);</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;  <span class="keywordflow">for</span>(jj=0;jj&lt;<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a002fc21c3c89d3e35466cd2c7e31c32a" title="see interp_loop_set() in initbase.c">NUMFLUXLOOPNUMBERS</a>;jj++) trifprintf(<span class="stringliteral">&quot;Uconsloop[%d] = %d\n&quot;</span>,jj,<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa8c4a7427588dceecfe6dd86c906515b">Uconsloop</a>[jj]);</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;  <span class="keywordflow">for</span>(jj=0;jj&lt;<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a002fc21c3c89d3e35466cd2c7e31c32a" title="see interp_loop_set() in initbase.c">NUMFLUXLOOPNUMBERS</a>;jj++) trifprintf(<span class="stringliteral">&quot;emfUconsloop[%d] = %d\n&quot;</span>,jj,<a class="code" href="../../d8/d5b/defs_8general_8h.html#ab7fad34655d8f0a07b50313508cb5ecc">emfUconsloop</a>[jj]);</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;  </div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;}</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;<span class="keywordtype">int</span> get_loop(<span class="keywordtype">int</span> pointorlinetype, <span class="keywordtype">int</span> interporflux, <span class="keywordtype">int</span> dir, <span class="keyword">struct</span> <a class="code" href="../../d8/d9b/structof__loop.html">of_loop</a> *loop)</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;{</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;  set_interpalltypes_loop_ranges(pointorlinetype, interporflux, dir, <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8936711f57f82d1fc75c21fa2894e1c6">CENT</a>, 0, &amp;(loop-&gt;<a class="code" href="../../d8/d9b/structof__loop.html#aa7254fac88db61188d1a4be7b220c661">intdir</a>), &amp;(loop-&gt;<a class="code" href="../../d8/d9b/structof__loop.html#aa065ad97b11c89b7a5edd54e2bbe433b">is</a>), &amp;(loop-&gt;<a class="code" href="../../d8/d9b/structof__loop.html#a7e290b9d135e07f75235db53680f64ae">ie</a>), &amp;(loop-&gt;<a class="code" href="../../d8/d9b/structof__loop.html#a3991c392bde0f5726882a22fc0366b76">js</a>), &amp;(loop-&gt;<a class="code" href="../../d8/d9b/structof__loop.html#a21ddbfdd15788badc149326ffd59ead2">je</a>), &amp;(loop-&gt;<a class="code" href="../../d8/d9b/structof__loop.html#a09fe3cf49e575a68dc5661c5bec4d5e9">ks</a>), &amp;(loop-&gt;<a class="code" href="../../d8/d9b/structof__loop.html#acfe34553561e82d1ea0a255e6d60e9c1">ke</a>), &amp;(loop-&gt;<a class="code" href="../../d8/d9b/structof__loop.html#a20522dd110da033fe4cc1c5e0cd94033">di</a>), &amp;(loop-&gt;<a class="code" href="../../d8/d9b/structof__loop.html#a45aae51e771d038bdee257562a3ab689">dj</a>), &amp;(loop-&gt;<a class="code" href="../../d8/d9b/structof__loop.html#a06d9e5b38816ac75525dd9875f50b9d3">dk</a>), &amp;(loop-&gt;<a class="code" href="../../d8/d9b/structof__loop.html#ab20b818f81e6dca77dd962dfa7330aea">bs</a>), &amp;(loop-&gt;<a class="code" href="../../d8/d9b/structof__loop.html#a3e68a0afdd3b6632614ea061b646c909">ps</a>), &amp;(loop-&gt;<a class="code" href="../../d8/d9b/structof__loop.html#aa5043dc3d331080e33db988b01e3186c">pe</a>), &amp;(loop-&gt;<a class="code" href="../../d8/d9b/structof__loop.html#ab3556cac73d4b732dcf139f971d687da">be</a>));</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;    </div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;}</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;<span class="keywordtype">int</span> set_interpalltypes_loop_ranges(<span class="keywordtype">int</span> pointorlinetype, <span class="keywordtype">int</span> interporflux, <span class="keywordtype">int</span> dir, <span class="keywordtype">int</span> loc, <span class="keywordtype">int</span> continuous, <span class="keywordtype">int</span> *intdir, <span class="keywordtype">int</span> *is, <span class="keywordtype">int</span> *ie, <span class="keywordtype">int</span> *js, <span class="keywordtype">int</span> *je, <span class="keywordtype">int</span> *ks, <span class="keywordtype">int</span> *ke, <span class="keywordtype">int</span> *di, <span class="keywordtype">int</span> *dj, <span class="keywordtype">int</span> *dk, <span class="keywordtype">int</span> *bs, <span class="keywordtype">int</span> *ps, <span class="keywordtype">int</span> *pe, <span class="keywordtype">int</span> *be)</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;{</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;  <span class="keywordtype">int</span> withshifts;</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;  <span class="keywordflow">if</span>(pointorlinetype==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a1c4cf01a4f5bf62d08861d2c0a8e3cac">INTERPPOINTTYPE</a>){</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;    set_interppoint_loop_ranges(interporflux, dir, loc, continuous, is, ie, js, je, ks, ke, di, dj, dk);</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;    <span class="comment">// interpolation is always along dir-direction for point methods</span></div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;    *intdir=dir;</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;    *ps=*is;</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;    *pe=*ie;</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;    <span class="comment">// below is largest possible range that includes boundary cells</span></div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;    *bs = *is - <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#aa00aaa6c09563827fbe601635b149ef8">N1BND</a>*(dir==1) - <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a4053d825930f47a796f9f13678ef32e3">N2BND</a>*(dir==2) - <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a90d132cb201447b8fe71388f1b0ffe93">N3BND</a>*(dir==3);</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;    *be = *ie + <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#aa00aaa6c09563827fbe601635b149ef8">N1BND</a>*(dir==1) + <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a4053d825930f47a796f9f13678ef32e3">N2BND</a>*(dir==2) + <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a90d132cb201447b8fe71388f1b0ffe93">N3BND</a>*(dir==3);</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;  }</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(pointorlinetype==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a1bd5713562c8e9b82b408577c3cbe021">INTERPLINETYPE</a>){</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;    withshifts=0; <span class="comment">// force to be without shifts so results can be put into loop that has shifts embedded</span></div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;    set_interp_loop_gen(withshifts, interporflux, dir, loc, continuous, intdir, is, ie, js, je, ks, ke, di, dj, dk, bs, ps, pe, be);</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;    <span class="comment">// transcribe from loop over starting positions to full 3D loop</span></div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;    <span class="keywordflow">if</span>(*intdir==1){</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;      *is=*ps;</div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;      *ie=*pe;</div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;    }</div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(*intdir==2){</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;      *js=*ps;</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;      *je=*pe;</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;    }</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(*intdir==3){</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;      *ks=*ps;</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;      *ke=*pe;</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;    }</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;  }</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;No such pointorlinetype=%d\n&quot;</span>,pointorlinetype);</div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;    myexit(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2fbdc58f192261834f16a38fdaadca70">ERRORCODEBELOWCLEANFINISH</a>+287687456);</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;  }</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;}</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;</div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;<span class="keywordtype">int</span> pi2Uavg(<span class="keywordtype">int</span> *fieldfrompotential, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*prim)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pstag)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*Upoint)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*Uavg)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR])</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;{</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;  <span class="keyword">extern</span> <span class="keywordtype">int</span> initial_averageu_fv(<span class="keywordtype">int</span> *fieldfrompotential, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*prim)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*Upoint)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*Uavg)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR]);</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;  <span class="keyword">extern</span> <span class="keywordtype">int</span> initial_averageu_fluxrecon(<span class="keywordtype">int</span> *fieldfrompotential, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*prim)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*Upoint)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*Uavg)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR]);</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;<span class="preprocessor">#pragma omp parallel</span></div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;<span class="preprocessor"></span>  {</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae" title="typedef struct of_geom struct of_compgeom; force to be the same">of_geom</a> geom,geomf;</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae" title="typedef struct of_geom struct of_compgeom; force to be the same">of_geom</a> *ptrgeom,*ptrgeomf;</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d1/d83/structof__state.html" title="state structure">of_state</a> q;</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#ad21ff679aac3fe28202c6d592eafd3e6">i</a>,<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>,k;</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;    <span class="keywordtype">int</span> pl,pliter;</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;    <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> Utemp[NPR];</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;    </div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;    <a class="code" href="../../d5/d7b/global_8openmploops_8h.html#a1389db2daf5bd9e94918090c253a16c9">OPENMP3DLOOPVARSDEFINE</a>;</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;    <a class="code" href="../../d5/d7b/global_8openmploops_8h.html#a7518365209531b952c067f47c80777c2" title="COMPFULLLOOP equivalent for OpenMP.">OPENMP3DLOOPSETUPFULL</a>;</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;<span class="preprocessor">#pragma omp for schedule(OPENMPSCHEDULE(),OPENMPCHUNKSIZE(blocksize))</span></div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;<span class="preprocessor"></span>    <a class="code" href="../../d5/d7b/global_8openmploops_8h.html#a9e48537d3cb58cc3a3765b8a18b43b15" title="Oddly, performance changes by 10% when changing how start and stop blockijk (and fixing how used too ...">OPENMP3DLOOPBLOCK</a>{</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;      <a class="code" href="../../df/d1c/global_8storage_8h.html#a96983b0c56e836f50cb7c1af16f59fb6">OPENMP3DLOOPBLOCK2IJK</a>(i,j,k);</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;</div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;      <span class="comment">// set geometry</span></div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;      ptrgeom=&amp;geom; <a class="code" href="../../d3/ddc/phys_8funcdeclare_8h.html#a3059ed7bfcfb692cbe8014d55fd7c1e4">get_geometry</a>(i, j, k, <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8936711f57f82d1fc75c21fa2894e1c6">CENT</a>, ptrgeom);</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;    </div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;      <span class="comment">// find U(p)</span></div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;      <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a0163a499c88dd8b07688e3dbd7007f0e">MYFUN</a>(<a class="code" href="../../d3/ddc/phys_8funcdeclare_8h.html#a11e17cd8b0594d1ad52e3594aa9f477e" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e...">get_state</a>(<a class="code" href="../../df/d1c/global_8storage_8h.html#a849d8ce0cf4a61f92340425b34ba9538">MAC</a>(prim,i,j,k), ptrgeom, &amp;q),<span class="stringliteral">&quot;initbasec:pi2Uavg()&quot;</span>, <span class="stringliteral">&quot;get_state()&quot;</span>, 1);</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;      <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a0163a499c88dd8b07688e3dbd7007f0e">MYFUN</a>(<a class="code" href="../../d3/ddc/phys_8funcdeclare_8h.html#a9a54096e4c40a15a2c1bf74266153616" title="calculate &quot;conserved&quot; quantities">primtoU</a>(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a15d073255fcc246f09aa26337e643d22" title="defines data return types for primtoU() and primtoflux()">UEVOLVE</a>,<a class="code" href="../../df/d1c/global_8storage_8h.html#a849d8ce0cf4a61f92340425b34ba9538">MAC</a>(prim,i,j,k), &amp;q, ptrgeom, Utemp, NULL),<span class="stringliteral">&quot;initbase.c:pi2Uavg()&quot;</span>, <span class="stringliteral">&quot;primtoU()&quot;</span>, 1);</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;      <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a26c7def0d92cbac4d6a7e03a68c3825a">PLOOPNOB1</a>(pl) <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(Upoint,i,j,k,pl)=Utemp[pl];</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;      <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a122c19dd82429684d201ae0f9521be53">PLOOPNOB2</a>(pl) <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(Upoint,i,j,k,pl)=Utemp[pl];</div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;      if(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a11c4e99e1493d0c1914ad1ab313ea472">FLUXB</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0b6762cef74e396f50a83864bb53fb6c">FLUXCTSTAG</a>){</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;        <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a9afde1f1647e18e733406a1566b8b550">PLOOPBONLY</a>(pl) if(fieldfrompotential[pl-<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a7b21d6a6a4573b4997b1f04b01cd4efb">B1</a>+1]==0){</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;          ptrgeomf=&amp;geomf; <a class="code" href="../../d3/ddc/phys_8funcdeclare_8h.html#a3059ed7bfcfb692cbe8014d55fd7c1e4">get_geometry</a>(i, j, k, <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a1df736ddba855d7b429869f9f09dbd66">FACE1</a>+(pl-B1), ptrgeomf);</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;          <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(Upoint,i,j,k,pl)=<a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(pstag,i,j,k,pl)*(ptrgeomf-&gt;gdet);</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;        }</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;      }</div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;      <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;        <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a9afde1f1647e18e733406a1566b8b550">PLOOPBONLY</a>(pl) if(fieldfrompotential[pl-<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a7b21d6a6a4573b4997b1f04b01cd4efb">B1</a>+1]==0) <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(Upoint,i,j,k,pl)=Utemp[pl];</div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;      }</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;    </div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;      <span class="comment">//    dualfprintf(fail_file,&quot;Upoint[%d][%d][%d][UU]=%21.15g prim[UU]=%21.15g\n&quot;,i,j,k,MACP0A1(Upoint,i,j,k,UU)/(ptrgeom-&gt;gdet),MACP0A1(prim,i,j,k,UU));</span></div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;    }</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;  }<span class="comment">// end parallel region</span></div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;</div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;  <span class="comment">// now deal with higher-order interpolations</span></div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;<span class="comment"></span>  if(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a55732148d2616d6d1f5d2abbe8710850">DOENOFLUX</a> == <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ac634a307561f486f9df8ba8a67c21c19">ENOFINITEVOLUME</a>){</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;    initial_averageu_fv(fieldfrompotential, prim, Upoint, Uavg);</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;  }</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a55732148d2616d6d1f5d2abbe8710850">DOENOFLUX</a> == <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a81c6be7c38a1e29b40efa57ca47d0d02">ENOFLUXRECON</a>){</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;    initial_averageu_fluxrecon(fieldfrompotential, prim, Upoint, Uavg);</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;  }</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;    <span class="comment">// then just copy over</span></div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;<span class="preprocessor">#pragma omp parallel</span></div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;<span class="preprocessor"></span>    {</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;      <span class="keywordtype">int</span> <a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#ad21ff679aac3fe28202c6d592eafd3e6">i</a>,<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>,k;</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;      <span class="keywordtype">int</span> pl,pliter;</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;    </div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;      <a class="code" href="../../d5/d7b/global_8openmploops_8h.html#a1389db2daf5bd9e94918090c253a16c9">OPENMP3DLOOPVARSDEFINE</a>;</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;      <a class="code" href="../../d5/d7b/global_8openmploops_8h.html#a7518365209531b952c067f47c80777c2" title="COMPFULLLOOP equivalent for OpenMP.">OPENMP3DLOOPSETUPFULL</a>;</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;<span class="preprocessor">#pragma omp for schedule(OPENMPSCHEDULE(),OPENMPCHUNKSIZE(blocksize))</span></div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;<span class="preprocessor"></span>      <a class="code" href="../../d5/d7b/global_8openmploops_8h.html#a9e48537d3cb58cc3a3765b8a18b43b15" title="Oddly, performance changes by 10% when changing how start and stop blockijk (and fixing how used too ...">OPENMP3DLOOPBLOCK</a>{</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;        <a class="code" href="../../df/d1c/global_8storage_8h.html#a96983b0c56e836f50cb7c1af16f59fb6">OPENMP3DLOOPBLOCK2IJK</a>(i,j,k);</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;        <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a26c7def0d92cbac4d6a7e03a68c3825a">PLOOPNOB1</a>(pl) <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(Uavg,i,j,k,pl)=<a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(Upoint,i,j,k,pl);</div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;        <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a122c19dd82429684d201ae0f9521be53">PLOOPNOB2</a>(pl) <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(Uavg,i,j,k,pl)=<a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(Upoint,i,j,k,pl);</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;        <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a9afde1f1647e18e733406a1566b8b550">PLOOPBONLY</a>(pl) if(fieldfrompotential[pl-<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a7b21d6a6a4573b4997b1f04b01cd4efb">B1</a>+1]==0) <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(Uavg,i,j,k,pl)=<a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(Upoint,i,j,k,pl);</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;      }<span class="comment">// end 3D LOOP</span></div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;    }<span class="comment">// end parallel region</span></div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;  }<span class="comment">// end else</span></div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;  </div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;  return(0);</div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;}</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;<span class="keywordtype">void</span> makedirs(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;{</div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;</div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;<span class="preprocessor">#if( USINGMPIAVOIDMKDIR ) </span></div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;<span class="preprocessor"></span>  <span class="comment">//AT: for certain systems, neither way works to create dirs, </span></div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;  <span class="comment">//    so not create them at all</span></div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;  <span class="comment">//stderrfprintf(&quot;USEMPIAVOIDMKDIR==1: User must create dumps and images\n&quot;);</span></div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">if</span> ((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a4242e6dd75844f241d042e8f43c404e8">mpicombine</a> &amp;&amp; (myid == 0)) || (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a4242e6dd75844f241d042e8f43c404e8">mpicombine</a> == 0)) {</div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;    </div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;    <span class="keywordflow">if</span>(USEMPI &amp;&amp; (!MPIAVOIDFORK) || USEMPI==0){</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;      system(<span class="stringliteral">&quot;mkdir dumps&quot;</span>);</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;      system(<span class="stringliteral">&quot;mkdir images&quot;</span>);</div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;    }</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;<span class="preprocessor">#ifndef WIN32</span></div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;<span class="preprocessor"></span>      <span class="comment">// assumes unix commands exist in &lt;sys/stat.h&gt;</span></div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;      <span class="comment">// see also &quot;info libc&quot;</span></div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;      <span class="comment">// create directory with rxw permissions for user only</span></div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;      mkdir(<span class="stringliteral">&quot;dumps&quot;</span>,0700);</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;      mkdir(<span class="stringliteral">&quot;images&quot;</span>,0700);</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;<span class="preprocessor"></span>      stderrfprintf(<span class="stringliteral">&quot;WIN32: User must create dumps and images\n&quot;</span>);</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;<span class="preprocessor"></span>    }</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;  }</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;</div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;<span class="preprocessor">#if(USEMPI)</span></div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;<span class="preprocessor"></span>  <span class="comment">// all cpus wait for directory to be created</span></div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;  MPI_Barrier(MPI_COMM_GRMHD);</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#endif  //USINGMPIAVOIDMKDIR</span></div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;}</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;<span class="preprocessor">#include&lt;sys/stat.h&gt;</span></div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;</div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;</div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;</div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;</div>
<div class="line"><a name="l02910"></a><span class="lineno"><a class="code" href="../../de/db2/initbase_8funcdeclare_8h.html#a301d97374bef9a2ca3f1c30866ff1e4d"> 2910</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../de/df8/initbase_8c.html#a301d97374bef9a2ca3f1c30866ff1e4d" title="acts on globals, assumes static internals that get recalled upon reentering">addremovefromnpr</a>(<span class="keywordtype">int</span> doadd, <span class="keywordtype">int</span> *whichpltoavg, <span class="keywordtype">int</span> *ifnotavgthencopy, <span class="keywordtype">int</span> *nprlocalstart, <span class="keywordtype">int</span> *nprlocalend, <span class="keywordtype">int</span> *nprlocallist, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*in)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*out)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR])</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;{</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;  <span class="keywordtype">int</span> addremovefromanynpr(<span class="keywordtype">int</span> doadd, <span class="keywordtype">int</span> *whichpltoavg, <span class="keywordtype">int</span> *ifnotavgthencopy, <span class="keywordtype">int</span> *anynprstart, <span class="keywordtype">int</span> *anynprend, <span class="keywordtype">int</span> *anynprlist, <span class="keywordtype">int</span> *nprlocalstart, <span class="keywordtype">int</span> *nprlocalend, <span class="keywordtype">int</span> *nprlocallist, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*in)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*out)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR]);</div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;</div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;  <span class="comment">// applies only to NPR type list</span></div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;  addremovefromanynpr(doadd, whichpltoavg, ifnotavgthencopy, &amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa513122b9e25a436a0e98805e46961af" title="OPENMPNOTE: Ensure all pl&#39;s are set as private as required [only npr2interp and npr2notinterp changed...">nprstart</a>, &amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#a11c2c3ace90a795cd7a910ac0a6256d2">nprend</a>, <a class="code" href="../../d8/d5b/defs_8general_8h.html#af637e542453ec23c1a41a1038b223040">nprlist</a>, nprlocalstart, nprlocalend, nprlocallist, in, out);</div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;</div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;}</div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;<span class="keywordtype">int</span> addremovefromanynpr(<span class="keywordtype">int</span> doadd, <span class="keywordtype">int</span> *whichpltoavg, <span class="keywordtype">int</span> *ifnotavgthencopy, <span class="keywordtype">int</span> *anynprstart, <span class="keywordtype">int</span> *anynprend, <span class="keywordtype">int</span> *anynprlist, <span class="keywordtype">int</span> *nprlocalstart, <span class="keywordtype">int</span> *nprlocalend, <span class="keywordtype">int</span> *nprlocallist, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*in)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*out)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR])</div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;{</div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;  <span class="keywordtype">int</span> pl,pliter;</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;  <span class="keywordtype">int</span> pl2,pl3;</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#ad21ff679aac3fe28202c6d592eafd3e6">i</a>,<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>,k;</div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;  <span class="keywordtype">int</span> num;</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;</div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;</div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;  <span class="keywordflow">if</span>(doadd==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a70da358c1e7cdf376febfedff5f8ede4">REMOVEFROMNPR</a>){</div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;    <span class="comment">// save choice for interpolations</span></div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;    *nprlocalstart=*anynprstart;</div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;    *nprlocalend=*anynprend;</div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#ae3d8ba1d892944d94ad9f496a3fb3566" title="goes over all/any npr lists for copying one list to another">PMAXNPRLOOP</a>(pl) nprlocallist[pl]=anynprlist[pl];</div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;</div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;    if(anynprlist==<a class="code" href="../../d8/d5b/defs_8general_8h.html#af637e542453ec23c1a41a1038b223040">nprlist</a>) num=NPR;</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;    else if(anynprlist==<a class="code" href="../../d8/d5b/defs_8general_8h.html#a647235f9afd0ad17f188ed43fe23997f">npr2interplist</a>) num=NPR2INTERP;</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;    else if(anynprlist==<a class="code" href="../../d8/d5b/defs_8general_8h.html#a6dba6fb1a43922f6b8c4e933ad8b51bc">nprboundlist</a>) num=NPRBOUND;</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;    else{</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;      dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;No such type of list in addremovefromanynpr\n&quot;</span>);</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;      myexit(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2fbdc58f192261834f16a38fdaadca70">ERRORCODEBELOWCLEANFINISH</a>+7615156);</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;    }</div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;    <span class="comment">// now remove any other pl&#39;s not wanting to average for whatever reason</span></div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;    <span class="keywordflow">for</span>(pl3=0;pl3&lt;num;pl3++){ <span class="comment">// as above, but loop over all undesired quantities</span></div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;      <span class="keywordflow">for</span>(pl= *anynprstart;pl&lt;= *anynprend;pl++){</div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;        <span class="keywordflow">if</span>(whichpltoavg[pl3]==0 &amp;&amp; anynprlist[pl]==pl3){</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;          <span class="comment">// need to copy over unchanged quantity</span></div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;          <span class="keywordflow">if</span>(ifnotavgthencopy[pl3] &amp;&amp; in!=NULL &amp;&amp; out!=NULL) copy_3d_onepl_fullloop(pl3,in,out); <span class="comment">//COMPFULLLOOP MACP0A1(out,i,j,k,pl3)=MACP0A1(in,i,j,k,pl3);</span></div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;          <span class="keywordflow">for</span>(pl2=pl+1;pl2&lt;= *anynprend;pl2++) anynprlist[pl2-1]=anynprlist[pl2]; <span class="comment">// moving upper to lower index</span></div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;          *anynprend-=1; <span class="comment">// removed dir-field</span></div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;        }</div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;      }</div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;    }</div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;</div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;  }</div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(doadd==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#af732fdf2d9fc1059109b57109f6dde39">RESTORENPR</a>){</div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;</div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;    <span class="comment">// restore choice for interpolations</span></div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;    *anynprstart= *nprlocalstart;</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;    *anynprend= *nprlocalend;</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#ae3d8ba1d892944d94ad9f496a3fb3566" title="goes over all/any npr lists for copying one list to another">PMAXNPRLOOP</a>(pl) anynprlist[pl]=nprlocallist[pl];</div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;  }</div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;</div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;  <span class="comment">//  PALLLOOP(pl){</span></div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;  <span class="comment">//    dualfprintf(fail_file,&quot;dir=%d interptype=%d nprstart=%d nprend=%d nprlist[%d]=%d\n&quot;,dir,interptype,*anynprstart,*anynprend,pl,anynprlist[pl]);</span></div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;  <span class="comment">//  }</span></div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;  </div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;</div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;  return(0);</div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;</div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;}</div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;</div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;</div>
<div class="line"><a name="l02987"></a><span class="lineno"><a class="code" href="../../de/db2/initbase_8funcdeclare_8h.html#a7665bb79a8aea27c4ea4d7e58fd83c19"> 2987</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../de/df8/initbase_8c.html#a7665bb79a8aea27c4ea4d7e58fd83c19" title="used to transform from one coordinate system to PRIMECOORDS when acting on pstag, only relevant for m...">transform_primitive_vB</a>(<span class="keywordtype">int</span> whichvel, <span class="keywordtype">int</span> <a class="code" href="../../dc/dd2/newcodediff_8txt.html#ab29c7802084b56a574b83eb818d2fdda">whichcoord</a>, <span class="keywordtype">int</span> i,<span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pstag)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR])</div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;{</div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;</div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;  <span class="comment">// For p, transform from whichcoord to MCOORD</span></div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d3/d09/transforms_8c.html#a5eb01df8f2e210c8611a8320dc983a9d" title="assumes all centered quantities (so for FLUXB==FLUXCTSTAG assumes operates on centered field versions...">bl2met2metp2v</a>(whichvel,whichcoord,<a class="code" href="../../df/d1c/global_8storage_8h.html#a849d8ce0cf4a61f92340425b34ba9538">MAC</a>(<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>,i,j,k), i,j,k) &gt;= 1) <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a5febb92786c5f7a1479e7e65f1c23ef3">FAILSTATEMENT</a>(<span class="stringliteral">&quot;initbase.c:transform_primitive_vB()&quot;</span>, <span class="stringliteral">&quot;bl2ks2ksp2v()&quot;</span>, 1);</div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;</div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;}</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;</div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;</div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;</div>
<div class="line"><a name="l03000"></a><span class="lineno"><a class="code" href="../../de/df8/initbase_8c.html#a0be2ccbcc3204db61f1accf5a45cbaf1"> 3000</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d8/df4/global_8funcdeclare_8h.html#a0be2ccbcc3204db61f1accf5a45cbaf1" title="report emtpy">assert_func_empty</a>( <span class="keywordtype">int</span> is_bad_val, <span class="keywordtype">char</span> *s, ... )</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;{</div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;  <span class="keywordflow">return</span>(is_bad_val);</div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;}</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;</div>
<div class="line"><a name="l03006"></a><span class="lineno"><a class="code" href="../../de/df8/initbase_8c.html#ae6e2db7ddd61d5256cddd76b7f4be37c"> 3006</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d8/df4/global_8funcdeclare_8h.html#ae6e2db7ddd61d5256cddd76b7f4be37c" title="report">assert_func</a>( <span class="keywordtype">int</span> is_bad_val, <span class="keywordtype">char</span> *s, ... )</div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;{</div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;  va_list arglist;</div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;  FILE *fileptr = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>;</div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;  va_start (arglist, s);</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;  <span class="keywordflow">if</span>( 0 != is_bad_val ) {</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;    <span class="keywordflow">if</span>(fileptr==NULL){</div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;      stderrfprintf(<span class="stringliteral">&quot;tried to print to null file pointer: %s\n&quot;</span>,s);</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;      fflush(stderr);</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;    }</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;      dualfprintf( <a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>, <span class="stringliteral">&quot;Assertion failed: &quot;</span> );</div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;      vfprintf (fileptr, s, arglist);</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;      fflush(fileptr);</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;    }</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;    <span class="keywordflow">if</span>(myid==0){</div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;      vfprintf (stderr, s, arglist);</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;      fflush(stderr);</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;    }</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;    va_end (arglist);</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;    myexit( 1 );</div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;  }</div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;  <span class="keywordflow">return</span> is_bad_val;</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;}</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;</div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;</div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;<span class="keywordtype">void</span> set_array(<span class="keywordtype">void</span> *inbufptr, <span class="keywordtype">int</span> num, MPI_Datatype datatype, <span class="keywordtype">long</span> <span class="keywordtype">double</span> value)</div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;{</div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;  <span class="keywordtype">void</span> *bufptr=NULL;</div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">double</span> *buf16;</div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;  <span class="keywordtype">double</span> *buf8;</div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;  <span class="keywordtype">float</span> *buf4;</div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *buf1;</div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;  <span class="keywordtype">int</span> *buf4i;</div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> *buf8i;</div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;</div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">double</span> *inbuf16;</div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;  <span class="keywordtype">double</span> *inbuf8;</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;  <span class="keywordtype">float</span> *inbuf4;</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *inbuf1;</div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;  <span class="keywordtype">int</span> *inbuf4i;</div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> *inbuf8i;</div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;</div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;  <span class="keywordtype">int</span> sizeofdatatype=getsizeofdatatype(datatype);</div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;  </div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#ad21ff679aac3fe28202c6d592eafd3e6">i</a>;</div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;  <span class="keywordflow">if</span>(datatype==MPI_UNSIGNED_CHAR){ buf1=(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)bufptr; inbuf1=(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)inbufptr;  <span class="keywordflow">for</span>(i=0;i&lt;num;i++) inbuf1[i]=(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)value; }</div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(datatype==MPI_FLOAT){ buf4=(<span class="keywordtype">float</span> *)bufptr; inbuf4=(<span class="keywordtype">float</span> *)inbufptr;  <span class="keywordflow">for</span>(i=0;i&lt;num;i++) inbuf4[i]=(<span class="keywordtype">float</span>)value; }</div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(datatype==MPI_DOUBLE){ buf8=(<span class="keywordtype">double</span>*)bufptr; inbuf8=(<span class="keywordtype">double</span>*)inbufptr; <span class="keywordflow">for</span>(i=0;i&lt;num;i++) inbuf8[i]=(<span class="keywordtype">double</span>)value; }</div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(datatype==MPI_LONG_DOUBLE){ buf16=(<span class="keywordtype">long</span> <span class="keywordtype">double</span>*)bufptr; inbuf16=(<span class="keywordtype">long</span> <span class="keywordtype">double</span>*)inbufptr;  <span class="keywordflow">for</span>(i=0;i&lt;num;i++) inbuf16[i]=(<span class="keywordtype">long</span> <span class="keywordtype">double</span>)value; }</div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(datatype==MPI_INT){ buf4i=(<span class="keywordtype">int</span> *)bufptr; inbuf4i=(<span class="keywordtype">int</span> *)inbufptr;  <span class="keywordflow">for</span>(i=0;i&lt;num;i++) inbuf4i[i]=(<span class="keywordtype">int</span>)value; }</div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(datatype==MPI_LONG_LONG_INT){ buf8i=(<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> *)bufptr; inbuf8i=(<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> *)inbufptr;  <span class="keywordflow">for</span>(i=0;i&lt;num;i++) inbuf8i[i]=(<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>) value; }</div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;</div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;}</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;</div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;</div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;<span class="keywordtype">void</span> debugdivb(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;{</div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;</div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;  <span class="comment">// HACK:</span></div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;  bound_uavg(<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#affb13608b845e81f4595b80927fbedbd" title="for various uses (dumping and special boundary/comp interchange routine">STAGEM1</a>, 1, <a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>, <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2eddd9ab5ac3f8f5a8a8b62288b76f89">BOUNDPRIMTYPE</a>, <a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(unewglobal),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(unewglobal), <a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(unewglobal),1);</div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;  <span class="comment">//      bound_mpi(STAGEM1,1,0,BOUNDPRIMSIMPLETYPE,GLOBALPOINT(udump),NULL,NULL,NULL,NULL);</span></div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;  <span class="comment">//bound_mpi(STAGEM1,1,0,BOUNDPRIMSIMPLETYPE,GLOBALPOINT(unewglobal),NULL,NULL,NULL,NULL);</span></div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;</div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;  <span class="keyword">struct </span><a class="code" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae" title="typedef struct of_geom struct of_compgeom; force to be the same">of_geom</a> geomdontuse;</div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;  <span class="keyword">struct </span><a class="code" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae" title="typedef struct of_geom struct of_compgeom; force to be the same">of_geom</a> *ptrgeom=&amp;geomdontuse;</div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#ad21ff679aac3fe28202c6d592eafd3e6">i</a>,<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>,k;</div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;  <a class="code" href="../../da/db2/global_8loops_8manypoints_8h.html#a615c1d48363ecaa0866f1c0fd337b780">FULLLOOP</a>{</div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;    <a class="code" href="../../d3/ddc/phys_8funcdeclare_8h.html#a3059ed7bfcfb692cbe8014d55fd7c1e4">get_geometry</a>(i,j,k,<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a1df736ddba855d7b429869f9f09dbd66">FACE1</a>,ptrgeom);</div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;    GLOBALMACP0A1(pstagglobal,i,j,k,<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a7b21d6a6a4573b4997b1f04b01cd4efb">B1</a>)=GLOBALMACP0A1(unewglobal,i,j,k,<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a7b21d6a6a4573b4997b1f04b01cd4efb">B1</a>)/ptrgeom-&gt;gdet;</div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;    <a class="code" href="../../d3/ddc/phys_8funcdeclare_8h.html#a3059ed7bfcfb692cbe8014d55fd7c1e4">get_geometry</a>(i,j,k,<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a5b4b42f50fd7667c7d22d8001811bc7e">FACE2</a>,ptrgeom);</div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;    GLOBALMACP0A1(pstagglobal,i,j,k,<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a6945d50f798e1fde624d70c74457090e">B2</a>)=GLOBALMACP0A1(unewglobal,i,j,k,<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a6945d50f798e1fde624d70c74457090e">B2</a>)/ptrgeom-&gt;gdet;</div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;    <a class="code" href="../../d3/ddc/phys_8funcdeclare_8h.html#a3059ed7bfcfb692cbe8014d55fd7c1e4">get_geometry</a>(i,j,k,<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a630fdcefb04bdca66118cfd21476e8fd">FACE3</a>,ptrgeom);</div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;    GLOBALMACP0A1(pstagglobal,i,j,k,<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ae6ac0edb1e2c9c7672ab9488d8b65be9">B3</a>)=GLOBALMACP0A1(unewglobal,i,j,k,<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ae6ac0edb1e2c9c7672ab9488d8b65be9">B3</a>)/ptrgeom-&gt;gdet;</div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;  }</div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;</div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;  <span class="comment">//    dualfprintf(fail_file,&quot;MONKEY: %g\n&quot;,GLOBALMACP0A1(unewglobal,0,32,4,B2));</span></div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;  <span class="comment">//    dualfprintf(fail_file,&quot;PIECE2: %g\n&quot;,GLOBALMACP0A1(unewglobal,62,0,30,B2));</span></div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;</div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;  <span class="comment">//    FULLLOOP{</span></div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;  <span class="comment">//      if(i==62&amp;&amp;j==0&amp;&amp;k==30 || i==63&amp;&amp;j==0&amp;&amp;k==30) dualfprintf(fail_file,&quot;KILLGODB1: %d %d %g\n&quot;,i,k,GLOBALMACP0A1(unewglobal,i,j,k,B1));</span></div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;  <span class="comment">//      if(i==62&amp;&amp;j==0&amp;&amp;k==30 || i==62&amp;&amp;j==1&amp;&amp;k==30) dualfprintf(fail_file,&quot;KILLGODB2: %d %d %g\n&quot;,i,k,GLOBALMACP0A1(unewglobal,i,j,k,B2));</span></div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;  <span class="comment">//      if(i==62&amp;&amp;j==0&amp;&amp;k==30 || i==62&amp;&amp;j==0&amp;&amp;k==31) dualfprintf(fail_file,&quot;KILLGODB3: %d %d %g\n&quot;,i,k,GLOBALMACP0A1(unewglobal,i,j,k,B3));</span></div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;  <span class="comment">//}</span></div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;</div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> divbmax=0,divbavg=0;</div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;  divbmaxavg(<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pdump),&amp;divbmax,&amp;divbavg);</div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;  dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;GOD0: %g %g\n&quot;</span>,divbmax,divbavg);</div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;  <span class="keywordtype">int</span> finalstep=0; <span class="comment">// only for diagnostics, no accounting.</span></div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> localt=<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>;</div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;  <a class="code" href="../../d4/dad/bounds_8funcdeclare_8h.html#a91fe5c4370e3292a19e7f794797a407f" title="normal bounding of all primitives">bound_allprim</a>(<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#affb13608b845e81f4595b80927fbedbd" title="for various uses (dumping and special boundary/comp interchange routine">STAGEM1</a>,finalstep, localt,<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pdump),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pstagdump),<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(udump), USEMPI);</div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;  <span class="comment">//  dualfprintf(fail_file,&quot;MONKEY1.2: %g\n&quot;,GLOBALMACP0A1(unewglobal,0,32,4,B2));</span></div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;  <span class="keywordtype">int</span> fakedir=0;</div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;  bound_mpi(<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#affb13608b845e81f4595b80927fbedbd" title="for various uses (dumping and special boundary/comp interchange routine">STAGEM1</a>,finalstep,fakedir,<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ae8250514c2a764de11180b30e6ee2a67">BOUNDPSTAGSIMPLETYPE</a>,<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(udump),NULL,NULL,NULL,NULL);</div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;  <span class="comment">//  dualfprintf(fail_file,&quot;MONKEY1.3: %g\n&quot;,GLOBALMACP0A1(unewglobal,0,32,4,B2));</span></div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;  divbmaxavg(<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pdump),&amp;divbmax,&amp;divbavg);</div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;  dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;GOD1: %g %g\n&quot;</span>,divbmax,divbavg);</div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;</div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;</div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;</div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;}</div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;</div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;</div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri May 20 2016 15:52:33 for HARM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.3.1
</small></address>
</body>
</html>
