<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>HARM: utoprimgen.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">HARM
   </div>
   <div id="projectbrief">harm and utilities</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">utoprimgen.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>General extended feature wrapper for inversion U-&gt;P.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;decs.h&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for utoprimgen.c:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d9c/utoprimgen_8c__incl.png" border="0" usemap="#utoprimgen_8c" alt=""/></div>
<map name="utoprimgen_8c" id="utoprimgen_8c">
</map>
</div>
</div>
<p><a href="../../d1/d3e/utoprimgen_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a11db68297c24100ffe1c76e659268e5f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d3e/utoprimgen_8c.html#a11db68297c24100ffe1c76e659268e5f">CHECKONINVFRAC</a>&#160;&#160;&#160;(<a class="el" href="../../de/d10/global_8nondepmnemonics_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(1E-7,newtonstats-&gt;tryconv*1E3))</td></tr>
<tr class="memdesc:a11db68297c24100ffe1c76e659268e5f"><td class="mdescLeft">&#160;</td><td class="mdescRight">fractional error above which inversion is reported on as having made a signficant error  <a href="#a11db68297c24100ffe1c76e659268e5f">More...</a><br/></td></tr>
<tr class="separator:a11db68297c24100ffe1c76e659268e5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a3cb87e250a02050cb52a1f1240b128"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d3e/utoprimgen_8c.html#a3a3cb87e250a02050cb52a1f1240b128">FAILIFBADCHECK</a>&#160;&#160;&#160;1</td></tr>
<tr class="memdesc:a3a3cb87e250a02050cb52a1f1240b128"><td class="mdescLeft">&#160;</td><td class="mdescRight">whether to fail if check on inversion fails  <a href="#a3a3cb87e250a02050cb52a1f1240b128">More...</a><br/></td></tr>
<tr class="separator:a3a3cb87e250a02050cb52a1f1240b128"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac85d41f36d0739a78a1e6cc767157a8f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d3e/utoprimgen_8c.html#ac85d41f36d0739a78a1e6cc767157a8f">CHECKONINVFRACFAIL</a>&#160;&#160;&#160;(1E-1)</td></tr>
<tr class="memdesc:ac85d41f36d0739a78a1e6cc767157a8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">fraction upon if greater will treat as failure if FAILIFBADCHECK is triggered  <a href="#ac85d41f36d0739a78a1e6cc767157a8f">More...</a><br/></td></tr>
<tr class="separator:ac85d41f36d0739a78a1e6cc767157a8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29c71c132c174c4a72d398ebfc197d62"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d3e/utoprimgen_8c.html#a29c71c132c174c4a72d398ebfc197d62">REPORTCYCLE</a>&#160;&#160;&#160;(10)</td></tr>
<tr class="separator:a29c71c132c174c4a72d398ebfc197d62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a8adda834dd0777f2230a3d2dca2aba"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d3e/utoprimgen_8c.html#a3a8adda834dd0777f2230a3d2dca2aba">ENTROPYFIXGUESSEXTERNAL</a>&#160;&#160;&#160;(<a class="el" href="../../de/d10/global_8nondepmnemonics_8h.html#ae6708634050275c94899ab9f611f293b">ENTROPYFIXGUESS</a>)</td></tr>
<tr class="memdesc:a3a8adda834dd0777f2230a3d2dca2aba"><td class="mdescLeft">&#160;</td><td class="mdescRight">whether to fix u_g using entropy conserved quantity, if available.  <a href="#a3a8adda834dd0777f2230a3d2dca2aba">More...</a><br/></td></tr>
<tr class="separator:a3a8adda834dd0777f2230a3d2dca2aba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a106611f96996d6ee0f83acc680a365df"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d3e/utoprimgen_8c.html#a106611f96996d6ee0f83acc680a365df">CRAZYDEBUG</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:a106611f96996d6ee0f83acc680a365df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a577e35c436a5d051f7cb58ae8d418237"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d3e/utoprimgen_8c.html#a577e35c436a5d051f7cb58ae8d418237">ERRORCONST</a>&#160;&#160;&#160;(1E-10)</td></tr>
<tr class="separator:a577e35c436a5d051f7cb58ae8d418237"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a763c7a059cf1c4193f9b1a39bfe698b8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d3e/utoprimgen_8c.html#a763c7a059cf1c4193f9b1a39bfe698b8">SHOWUGCHANGEDUETOENTROPY</a>&#160;&#160;&#160;(10.0)</td></tr>
<tr class="separator:a763c7a059cf1c4193f9b1a39bfe698b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7e078cc9a354495bc85554d875a705d9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d3e/utoprimgen_8c.html#a7e078cc9a354495bc85554d875a705d9">Utoprimgen</a> (int showmessages, int checkoninversiongas, int checkoninversionrad, int allowlocalfailurefixandnoreport, int finalstep, int *eomtype, int whichcap, int whichmethod, int modprim, int evolvetype, int inputtype, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *U, struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *qptr, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *ptrgeom, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> dissmeasure, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *pi, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *<a class="el" href="../../dc/dd2/newcodediff_8txt.html#ae7ab77d7e616dc02fba121a009b48c27">pr</a>, struct <a class="el" href="../../db/d3a/structof__newtonstats.html">of_newtonstats</a> *newtonstats)</td></tr>
<tr class="memdesc:a7e078cc9a354495bc85554d875a705d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">General explicit inversion of U[MHD]-&gt;P[MHD] and also inverts scalars. Inverts radiation if(EOMRADTYPE!=EOMRADNONE)  <a href="#a7e078cc9a354495bc85554d875a705d9">More...</a><br/></td></tr>
<tr class="separator:a7e078cc9a354495bc85554d875a705d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfc42de6975dd4ff02f2748404e10911"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d3e/utoprimgen_8c.html#abfc42de6975dd4ff02f2748404e10911">invert_scalars1</a> (struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *ptrgeom, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *Ugeomfree, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *<a class="el" href="../../dc/dd2/newcodediff_8txt.html#ae7ab77d7e616dc02fba121a009b48c27">pr</a>)</td></tr>
<tr class="memdesc:abfc42de6975dd4ff02f2748404e10911"><td class="mdescLeft">&#160;</td><td class="mdescRight">perform U-&gt;p inversion on advected scalars  <a href="#abfc42de6975dd4ff02f2748404e10911">More...</a><br/></td></tr>
<tr class="separator:abfc42de6975dd4ff02f2748404e10911"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1118806d01e553c38ae5cf5f036f9f2e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d3e/utoprimgen_8c.html#a1118806d01e553c38ae5cf5f036f9f2e">invert_scalars2</a> (struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *ptrgeom, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *Ugeomfree, struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *q, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *<a class="el" href="../../dc/dd2/newcodediff_8txt.html#ae7ab77d7e616dc02fba121a009b48c27">pr</a>)</td></tr>
<tr class="memdesc:a1118806d01e553c38ae5cf5f036f9f2e"><td class="mdescLeft">&#160;</td><td class="mdescRight">perform U-&gt;p inversion on advected scalars  <a href="#a1118806d01e553c38ae5cf5f036f9f2e">More...</a><br/></td></tr>
<tr class="separator:a1118806d01e553c38ae5cf5f036f9f2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a83e9e7fdd3cc595c5b8d0df88ec684"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d3e/utoprimgen_8c.html#a0a83e9e7fdd3cc595c5b8d0df88ec684">Utoprimgen_pick</a> (int showmessages, int allowlocalfailurefixandnoreport, int which, int eomtype, int whichcap, int parameter, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *Ugeomfree, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *ptrgeom, <a class="el" href="../../d1/de6/global_8depmnemonics_8h.html#a9377001671b5ece8bb2a2cf636de4b8a">PFTYPE</a> *lpflag, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *<a class="el" href="../../dc/dd2/newcodediff_8txt.html#ae7ab77d7e616dc02fba121a009b48c27">pr</a>, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *pressure, struct <a class="el" href="../../db/d3a/structof__newtonstats.html">of_newtonstats</a> *newtonstats, <a class="el" href="../../d1/de6/global_8depmnemonics_8h.html#a9377001671b5ece8bb2a2cf636de4b8a">PFTYPE</a> *lpflagrad)</td></tr>
<tr class="memdesc:a0a83e9e7fdd3cc595c5b8d0df88ec684"><td class="mdescLeft">&#160;</td><td class="mdescRight">just picks the algorithm to invert  <a href="#a0a83e9e7fdd3cc595c5b8d0df88ec684">More...</a><br/></td></tr>
<tr class="separator:a0a83e9e7fdd3cc595c5b8d0df88ec684"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1986bb1d8ba8daf8c30863f647fb583e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d3e/utoprimgen_8c.html#a1986bb1d8ba8daf8c30863f647fb583e">Utoprimloop</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*U)[<a class="el" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*prim)[<a class="el" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], struct <a class="el" href="../../db/d3a/structof__newtonstats.html">of_newtonstats</a> *newtonstats)</td></tr>
<tr class="memdesc:a1986bb1d8ba8daf8c30863f647fb583e"><td class="mdescLeft">&#160;</td><td class="mdescRight">there may be something wrong with this function &ndash; didn't work in TIMEORDER==4, had to do standard method could have just been that I wasn't bounding after using this  <a href="#a1986bb1d8ba8daf8c30863f647fb583e">More...</a><br/></td></tr>
<tr class="separator:a1986bb1d8ba8daf8c30863f647fb583e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb7f18013467d4137a8b560024e71f51"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d3e/utoprimgen_8c.html#aeb7f18013467d4137a8b560024e71f51">primtoUloop</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*prim)[<a class="el" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*U)[<a class="el" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR])</td></tr>
<tr class="memdesc:aeb7f18013467d4137a8b560024e71f51"><td class="mdescLeft">&#160;</td><td class="mdescRight">loop for P-&gt;U  <a href="#aeb7f18013467d4137a8b560024e71f51">More...</a><br/></td></tr>
<tr class="separator:aeb7f18013467d4137a8b560024e71f51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d31362f91cd4ec3b92e15dd6bcb3908"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d3e/utoprimgen_8c.html#a7d31362f91cd4ec3b92e15dd6bcb3908">isflowcold</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> COLDFACTOR, int includerad, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *pb, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *ptrgeom, struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *q, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *uu0)</td></tr>
<tr class="memdesc:a7d31362f91cd4ec3b92e15dd6bcb3908"><td class="mdescLeft">&#160;</td><td class="mdescRight">includerad=1: account for fact that not only assume MHD flow is cold itself, but energy-force balance between gas and radiation is not important, only momentum being important.  <a href="#a7d31362f91cd4ec3b92e15dd6bcb3908">More...</a><br/></td></tr>
<tr class="separator:a7d31362f91cd4ec3b92e15dd6bcb3908"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>General extended feature wrapper for inversion U-&gt;P. </p>

<p>Definition in file <a class="el" href="../../d1/d3e/utoprimgen_8c_source.html">utoprimgen.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a11db68297c24100ffe1c76e659268e5f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CHECKONINVFRAC&#160;&#160;&#160;(<a class="el" href="../../de/d10/global_8nondepmnemonics_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(1E-7,newtonstats-&gt;tryconv*1E3))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>fractional error above which inversion is reported on as having made a signficant error </p>

<p>Definition at line <a class="el" href="../../d1/d3e/utoprimgen_8c_source.html#l00020">20</a> of file <a class="el" href="../../d1/d3e/utoprimgen_8c_source.html">utoprimgen.c</a>.</p>

</div>
</div>
<a class="anchor" id="ac85d41f36d0739a78a1e6cc767157a8f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CHECKONINVFRACFAIL&#160;&#160;&#160;(1E-1)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>fraction upon if greater will treat as failure if FAILIFBADCHECK is triggered </p>

<p>Definition at line <a class="el" href="../../d1/d3e/utoprimgen_8c_source.html#l00027">27</a> of file <a class="el" href="../../d1/d3e/utoprimgen_8c_source.html">utoprimgen.c</a>.</p>

</div>
</div>
<a class="anchor" id="a106611f96996d6ee0f83acc680a365df"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRAZYDEBUG&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a3a8adda834dd0777f2230a3d2dca2aba"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ENTROPYFIXGUESSEXTERNAL&#160;&#160;&#160;(<a class="el" href="../../de/d10/global_8nondepmnemonics_8h.html#ae6708634050275c94899ab9f611f293b">ENTROPYFIXGUESS</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>whether to fix u_g using entropy conserved quantity, if available. </p>

<p>Definition at line <a class="el" href="../../d1/d3e/utoprimgen_8c_source.html#l00032">32</a> of file <a class="el" href="../../d1/d3e/utoprimgen_8c_source.html">utoprimgen.c</a>.</p>

</div>
</div>
<a class="anchor" id="a577e35c436a5d051f7cb58ae8d418237"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ERRORCONST&#160;&#160;&#160;(1E-10)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a3a3cb87e250a02050cb52a1f1240b128"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FAILIFBADCHECK&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>whether to fail if check on inversion fails </p>

<p>Definition at line <a class="el" href="../../d1/d3e/utoprimgen_8c_source.html#l00024">24</a> of file <a class="el" href="../../d1/d3e/utoprimgen_8c_source.html">utoprimgen.c</a>.</p>

</div>
</div>
<a class="anchor" id="a29c71c132c174c4a72d398ebfc197d62"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define REPORTCYCLE&#160;&#160;&#160;(10)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d1/d3e/utoprimgen_8c_source.html#l00029">29</a> of file <a class="el" href="../../d1/d3e/utoprimgen_8c_source.html">utoprimgen.c</a>.</p>

</div>
</div>
<a class="anchor" id="a763c7a059cf1c4193f9b1a39bfe698b8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SHOWUGCHANGEDUETOENTROPY&#160;&#160;&#160;(10.0)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="abfc42de6975dd4ff02f2748404e10911"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int invert_scalars1 </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>ptrgeom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>Ugeomfree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>perform U-&gt;p inversion on advected scalars </p>

<p>Definition at line <a class="el" href="../../d1/d3e/utoprimgen_8c_source.html#l02215">2215</a> of file <a class="el" href="../../d1/d3e/utoprimgen_8c_source.html">utoprimgen.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d3e/utoprimgen_8c_abfc42de6975dd4ff02f2748404e10911_icgraph.png" border="0" usemap="#d1/d3e/utoprimgen_8c_abfc42de6975dd4ff02f2748404e10911_icgraph" alt=""/></div>
<map name="d1/d3e/utoprimgen_8c_abfc42de6975dd4ff02f2748404e10911_icgraph" id="d1/d3e/utoprimgen_8c_abfc42de6975dd4ff02f2748404e10911_icgraph">
<area shape="rect" id="node3" href="../../d2/d72/phys_8tools_8rad_8c.html#af46d2b1cf89a70a7e2ef503146c649a9" title="uu0 &#45; original cons." alt="" coords="165,22,240,51"/><area shape="rect" id="node5" href="../../d2/d72/phys_8tools_8rad_8c.html#a17aede36203a236390363af78d3a86f0" title="compute changes to U (both T and R) using implicit method KORALTODO: If doing implicit, should also add geometry source term that can sometimes be stiff." alt="" coords="443,22,651,51"/><area shape="rect" id="node33" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a7e078cc9a354495bc85554d875a705d9" title="General explicit inversion of U[MHD]&#45;&gt;P[MHD] and also inverts scalars. Inverts radiation if(EOMRADTYP..." alt="" coords="1244,124,1332,154"/><area shape="rect" id="node29" href="../../d2/d72/phys_8tools_8rad_8c.html#afa73a2caa3209e565a64f92447058507" title="calculating approximate Jacobian: dUresid(dUrad,G(Urad))/dUrad = dy(x)/dx then compute inverse Jacobi..." alt="" coords="289,22,393,51"/><area shape="rect" id="node7" href="../../d2/d72/phys_8tools_8rad_8c.html#a675bb3f12a77c62cf2540bc42c4867f8" title="wrapper for mode method" alt="" coords="700,22,868,51"/><area shape="rect" id="node9" href="../../d2/d72/phys_8tools_8rad_8c.html#aa8c5c0d5de580899948f9f22e10aff23" title="General radiation source term calculation (EXTERNALLY called) NOTE: source_explicit() takes as first ..." alt="" coords="919,22,1039,51"/><area shape="rect" id="node11" href="../../d2/d1d/sources_8c.html#a504ce383765ca3d2ff0b1ee653aff854" title="Ugeomfree and dUother are in UNOTHING form (or UEVOLVE without geometry) pf might be modified so bett..." alt="" coords="1088,22,1195,51"/><area shape="rect" id="node13" href="../../d7/def/phys_8tools_8c.html#a12ce5092c3a1a566cb7a560a7440acc1" title="add in source terms to equations of motion ui and dUriemann in UEVOLVE form assume q(pr) so consisten..." alt="" coords="1257,22,1319,51"/><area shape="rect" id="node15" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="1396,19,1524,48"/><area shape="rect" id="node27" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="1383,72,1537,102"/><area shape="rect" id="node17" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="1605,19,1675,48"/><area shape="rect" id="node19" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="1745,19,1879,48"/><area shape="rect" id="node21" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="1949,19,2016,48"/><area shape="rect" id="node23" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="2084,19,2175,48"/><area shape="rect" id="node25" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="2224,46,2275,75"/><area shape="rect" id="node37" href="../../d8/d60/init_8c.html#af3b64278d50c2ff0fee80291fbd38dab" title="fieldprim" alt="" coords="1425,126,1495,155"/><area shape="rect" id="node51" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a8db9dc7c7f52d6fcb405a74e519db5cf" title="there may be something wrong with this function – didn&#39;t work in TIMEORDER==4, had to do standard met..." alt="" coords="1415,179,1505,208"/><area shape="rect" id="node39" href="../../df/d15/init_8tools_8c.html#acefd26944dbbb1c289886f520f6befac" title="init_dsandvels" alt="" coords="1588,72,1692,102"/><area shape="rect" id="node48" href="../../de/db2/initbase_8funcdeclare_8h.html#a4e121b9448ac1adaa7608206369f9ea5" title="init_postvpot" alt="" coords="1592,126,1688,155"/><area shape="rect" id="node41" href="../../df/d15/init_8tools_8c.html#a77551ab2581efdbaf170dfca073ff9ab" title="user1_init_primitives" alt="" coords="1741,72,1883,102"/><area shape="rect" id="node43" href="../../de/db2/initbase_8funcdeclare_8h.html#a0afa200a5f947b1c9f6e554519f28fc4" title="init_primitives" alt="" coords="1932,72,2033,102"/><area shape="rect" id="node45" href="../../de/df8/initbase_8c.html#ac4110398e386c9888d9565630357dbbe" title="General&#45;Primary init() routine Uses globals inside init() because sets memory and sets physics..." alt="" coords="2111,72,2148,102"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1118806d01e553c38ae5cf5f036f9f2e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int invert_scalars2 </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>ptrgeom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>Ugeomfree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>perform U-&gt;p inversion on advected scalars </p>

<p>Definition at line <a class="el" href="../../d1/d3e/utoprimgen_8c_source.html#l02353">2353</a> of file <a class="el" href="../../d1/d3e/utoprimgen_8c_source.html">utoprimgen.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d3e/utoprimgen_8c_a1118806d01e553c38ae5cf5f036f9f2e_icgraph.png" border="0" usemap="#d1/d3e/utoprimgen_8c_a1118806d01e553c38ae5cf5f036f9f2e_icgraph" alt=""/></div>
<map name="d1/d3e/utoprimgen_8c_a1118806d01e553c38ae5cf5f036f9f2e_icgraph" id="d1/d3e/utoprimgen_8c_a1118806d01e553c38ae5cf5f036f9f2e_icgraph">
<area shape="rect" id="node3" href="../../d2/d72/phys_8tools_8rad_8c.html#af46d2b1cf89a70a7e2ef503146c649a9" title="uu0 &#45; original cons." alt="" coords="165,22,240,51"/><area shape="rect" id="node5" href="../../d2/d72/phys_8tools_8rad_8c.html#a17aede36203a236390363af78d3a86f0" title="compute changes to U (both T and R) using implicit method KORALTODO: If doing implicit, should also add geometry source term that can sometimes be stiff." alt="" coords="443,22,651,51"/><area shape="rect" id="node33" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a7e078cc9a354495bc85554d875a705d9" title="General explicit inversion of U[MHD]&#45;&gt;P[MHD] and also inverts scalars. Inverts radiation if(EOMRADTYP..." alt="" coords="1244,124,1332,154"/><area shape="rect" id="node29" href="../../d2/d72/phys_8tools_8rad_8c.html#afa73a2caa3209e565a64f92447058507" title="calculating approximate Jacobian: dUresid(dUrad,G(Urad))/dUrad = dy(x)/dx then compute inverse Jacobi..." alt="" coords="289,22,393,51"/><area shape="rect" id="node7" href="../../d2/d72/phys_8tools_8rad_8c.html#a675bb3f12a77c62cf2540bc42c4867f8" title="wrapper for mode method" alt="" coords="700,22,868,51"/><area shape="rect" id="node9" href="../../d2/d72/phys_8tools_8rad_8c.html#aa8c5c0d5de580899948f9f22e10aff23" title="General radiation source term calculation (EXTERNALLY called) NOTE: source_explicit() takes as first ..." alt="" coords="919,22,1039,51"/><area shape="rect" id="node11" href="../../d2/d1d/sources_8c.html#a504ce383765ca3d2ff0b1ee653aff854" title="Ugeomfree and dUother are in UNOTHING form (or UEVOLVE without geometry) pf might be modified so bett..." alt="" coords="1088,22,1195,51"/><area shape="rect" id="node13" href="../../d7/def/phys_8tools_8c.html#a12ce5092c3a1a566cb7a560a7440acc1" title="add in source terms to equations of motion ui and dUriemann in UEVOLVE form assume q(pr) so consisten..." alt="" coords="1257,22,1319,51"/><area shape="rect" id="node15" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="1396,19,1524,48"/><area shape="rect" id="node27" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="1383,72,1537,102"/><area shape="rect" id="node17" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="1605,19,1675,48"/><area shape="rect" id="node19" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="1745,19,1879,48"/><area shape="rect" id="node21" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="1949,19,2016,48"/><area shape="rect" id="node23" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="2084,19,2175,48"/><area shape="rect" id="node25" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="2224,46,2275,75"/><area shape="rect" id="node37" href="../../d8/d60/init_8c.html#af3b64278d50c2ff0fee80291fbd38dab" title="fieldprim" alt="" coords="1425,126,1495,155"/><area shape="rect" id="node51" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a8db9dc7c7f52d6fcb405a74e519db5cf" title="there may be something wrong with this function – didn&#39;t work in TIMEORDER==4, had to do standard met..." alt="" coords="1415,179,1505,208"/><area shape="rect" id="node39" href="../../df/d15/init_8tools_8c.html#acefd26944dbbb1c289886f520f6befac" title="init_dsandvels" alt="" coords="1588,72,1692,102"/><area shape="rect" id="node48" href="../../de/db2/initbase_8funcdeclare_8h.html#a4e121b9448ac1adaa7608206369f9ea5" title="init_postvpot" alt="" coords="1592,126,1688,155"/><area shape="rect" id="node41" href="../../df/d15/init_8tools_8c.html#a77551ab2581efdbaf170dfca073ff9ab" title="user1_init_primitives" alt="" coords="1741,72,1883,102"/><area shape="rect" id="node43" href="../../de/db2/initbase_8funcdeclare_8h.html#a0afa200a5f947b1c9f6e554519f28fc4" title="init_primitives" alt="" coords="1932,72,2033,102"/><area shape="rect" id="node45" href="../../de/df8/initbase_8c.html#ac4110398e386c9888d9565630357dbbe" title="General&#45;Primary init() routine Uses globals inside init() because sets memory and sets physics..." alt="" coords="2111,72,2148,102"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7d31362f91cd4ec3b92e15dd6bcb3908"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int isflowcold </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td>
          <td class="paramname"><em>COLDFACTOR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>includerad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>ptrgeom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>uu0</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>includerad=1: account for fact that not only assume MHD flow is cold itself, but energy-force balance between gas and radiation is not important, only momentum being important. </p>

<p>Definition at line <a class="el" href="../../d1/d3e/utoprimgen_8c_source.html#l03088">3088</a> of file <a class="el" href="../../d1/d3e/utoprimgen_8c_source.html">utoprimgen.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d3e/utoprimgen_8c_a7d31362f91cd4ec3b92e15dd6bcb3908_icgraph.png" border="0" usemap="#d1/d3e/utoprimgen_8c_a7d31362f91cd4ec3b92e15dd6bcb3908_icgraph" alt=""/></div>
<map name="d1/d3e/utoprimgen_8c_a7d31362f91cd4ec3b92e15dd6bcb3908_icgraph" id="d1/d3e/utoprimgen_8c_a7d31362f91cd4ec3b92e15dd6bcb3908_icgraph">
<area shape="rect" id="node3" href="../../d2/d72/phys_8tools_8rad_8c.html#a675bb3f12a77c62cf2540bc42c4867f8" title="wrapper for mode method" alt="" coords="135,32,303,61"/><area shape="rect" id="node5" href="../../d2/d72/phys_8tools_8rad_8c.html#aa8c5c0d5de580899948f9f22e10aff23" title="General radiation source term calculation (EXTERNALLY called) NOTE: source_explicit() takes as first ..." alt="" coords="353,32,473,61"/><area shape="rect" id="node7" href="../../d2/d1d/sources_8c.html#a504ce383765ca3d2ff0b1ee653aff854" title="Ugeomfree and dUother are in UNOTHING form (or UEVOLVE without geometry) pf might be modified so bett..." alt="" coords="523,32,629,61"/><area shape="rect" id="node9" href="../../d7/def/phys_8tools_8c.html#a12ce5092c3a1a566cb7a560a7440acc1" title="add in source terms to equations of motion ui and dUriemann in UEVOLVE form assume q(pr) so consisten..." alt="" coords="677,32,739,61"/><area shape="rect" id="node11" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="801,5,929,35"/><area shape="rect" id="node23" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="788,59,943,88"/><area shape="rect" id="node13" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="993,5,1063,35"/><area shape="rect" id="node15" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="1113,5,1247,35"/><area shape="rect" id="node17" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="1297,5,1364,35"/><area shape="rect" id="node19" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="1415,5,1505,35"/><area shape="rect" id="node21" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="1555,5,1605,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aeb7f18013467d4137a8b560024e71f51"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int primtoUloop </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>prim</em>[NSTORE2][NSTORE3][NPR], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>U</em>[NSTORE2][NSTORE3][NPR]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>loop for P-&gt;U </p>

<p>Definition at line <a class="el" href="../../d1/d3e/utoprimgen_8c_source.html#l02838">2838</a> of file <a class="el" href="../../d1/d3e/utoprimgen_8c_source.html">utoprimgen.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d3e/utoprimgen_8c_aeb7f18013467d4137a8b560024e71f51_cgraph.png" border="0" usemap="#d1/d3e/utoprimgen_8c_aeb7f18013467d4137a8b560024e71f51_cgraph" alt=""/></div>
<map name="d1/d3e/utoprimgen_8c_aeb7f18013467d4137a8b560024e71f51_cgraph" id="d1/d3e/utoprimgen_8c_aeb7f18013467d4137a8b560024e71f51_cgraph">
<area shape="rect" id="node3" href="../../d3/ddc/phys_8funcdeclare_8h.html#a11e17cd8b0594d1ad52e3594aa9f477e" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="148,203,223,232"/><area shape="rect" id="node11" href="../../d3/ddc/phys_8funcdeclare_8h.html#a9a54096e4c40a15a2c1bf74266153616" title="calculate &quot;conserved&quot; quantities" alt="" coords="152,283,219,312"/><area shape="rect" id="node5" href="../../d3/ddc/phys_8funcdeclare_8h.html#a12a473e24b431762af4168179e82cd08" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="291,136,453,165"/><area shape="rect" id="node7" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a8a762bf6582e6f7e1199de9c43b98454" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="273,189,471,219"/><area shape="rect" id="node9" href="../../d3/ddc/phys_8funcdeclare_8h.html#a41b8eacac0a4a23d6b00b670fe49629c" title="bsq_calc_fromq" alt="" coords="315,243,429,272"/><area shape="rect" id="node13" href="../../d3/ddc/phys_8funcdeclare_8h.html#a19e08c0d7e5a7c9fb9d97ff5ffab053c" title="Calculate fluxes in direction dir and conserved variable U returntype==0 : flux with geometric factor..." alt="" coords="333,296,411,325"/><area shape="rect" id="node15" href="../../d7/def/phys_8tools_8c.html#ace478826bef11e98daed7dd2ab026c93" title="matter only terms (as if B=0)" alt="" coords="520,163,624,192"/><area shape="rect" id="node35" href="../../d7/def/phys_8tools_8c.html#a3c8277899afc2a48590156971490bb79" title="radiation terms (as if rho=u=p=0)" alt="" coords="520,296,624,325"/><area shape="rect" id="node40" href="../../d7/def/phys_8tools_8c.html#a664550c21e363870d26e73f3ab5b3d3c" title="electromagnetic terms (as if rho=u=p=0)" alt="" coords="520,376,624,405"/><area shape="rect" id="node17" href="../../d7/def/phys_8tools_8c.html#a133cabc36f68eda16f9245f749c3cc38" title="flux asociated with Ynu variable" alt="" coords="705,5,799,35"/><area shape="rect" id="node19" href="../../d7/def/phys_8tools_8c.html#a787551c0e83438fe9e63ecd3d996f61a" title="massflux_calc" alt="" coords="916,57,1023,87"/><area shape="rect" id="node21" href="../../d7/def/phys_8tools_8c.html#a2ef51d65728fe59168e5b705165af6d4" title="flux associated with Y_L variable" alt="" coords="711,109,793,139"/><area shape="rect" id="node24" href="../../d7/def/phys_8tools_8c.html#a1e1dcf1d515232206c829a33d7e1192b" title="flux associated with Y_fl variable" alt="" coords="708,269,796,299"/><area shape="rect" id="node27" href="../../d7/def/phys_8tools_8c.html#a5717fa95303172fb697892a9232f0546" title="flux of specific entropy" alt="" coords="693,163,811,192"/><area shape="rect" id="node29" href="../../d7/def/phys_8tools_8c.html#a4886704a6724ea65ccaae2277b6ded74" title="MHD stress tensor, with first index up, second index down mhd^dir_j understood that mhddiagpress only..." alt="" coords="701,216,803,245"/><area shape="rect" id="node31" href="../../d7/def/phys_8tools_8c.html#ab3fd971df8ad09cce2462e78d7735f33" title="MHD stress tensor, with first index up, second index down." alt="" coords="911,189,1028,219"/><area shape="rect" id="node33" href="../../d7/def/phys_8tools_8c.html#a44930b5d598885afcb717a270f42749f" title="MHD stress tensor, with first index up, second index down avoids catastrophic cancellation with rest&#45;..." alt="" coords="880,243,1059,272"/><area shape="rect" id="node38" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a389bf7e41d2fd117af996e3392067cdc" title="compute radiation stres&#45;energy tensor assuming M1 closure" alt="" coords="701,323,803,352"/><area shape="rect" id="node42" href="../../d7/def/phys_8tools_8c.html#a3552b97ec9f1982094fbc3e3f9af7f05" title="MHD stress tensor, with first index up, second index down mhd^dir_j." alt="" coords="701,376,803,405"/><area shape="rect" id="node48" href="../../d7/def/phys_8tools_8c.html#a12b4ca77ffbef030f608b079327b4eb7" title="spatial part of dualfaraday" alt="" coords="673,429,831,459"/><area shape="rect" id="node44" href="../../d7/def/phys_8tools_8c.html#a3f6e052b84282b8db7b05a0acc435622" title="EM part of stress&#45;energy tensor." alt="" coords="911,323,1028,352"/><area shape="rect" id="node46" href="../../d7/def/phys_8tools_8c.html#a864ca09eade159d4c4b545593c1095de" title="MHD stress tensor, with first index up, second index down avoids catastrophic cancellation with rest&#45;..." alt="" coords="891,376,1048,405"/><area shape="rect" id="node50" href="../../d7/def/phys_8tools_8c.html#abc846df49f33c007310b52240e099e3b" title="Notation for HARM paper and JCM&#39;s GRFFE paper is that: B^ = &#160;*F^{} and for lab&#45;frame we chose ={&#45;1..." alt="" coords="901,429,1037,459"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7e078cc9a354495bc85554d875a705d9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Utoprimgen </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>showmessages</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>checkoninversiongas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>checkoninversionrad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>allowlocalfailurefixandnoreport</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>finalstep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>eomtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>whichcap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>whichmethod</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>modprim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>evolvetype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>inputtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>U</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *&#160;</td>
          <td class="paramname"><em>qptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>ptrgeom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td>
          <td class="paramname"><em>dissmeasure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../db/d3a/structof__newtonstats.html">of_newtonstats</a> *&#160;</td>
          <td class="paramname"><em>newtonstats</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>General explicit inversion of U[MHD]-&gt;P[MHD] and also inverts scalars. Inverts radiation if(EOMRADTYPE!=EOMRADNONE) </p>

<p>Definition at line <a class="el" href="../../d1/d3e/utoprimgen_8c_source.html#l00053">53</a> of file <a class="el" href="../../d1/d3e/utoprimgen_8c_source.html">utoprimgen.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d3e/utoprimgen_8c_a7e078cc9a354495bc85554d875a705d9_cgraph.png" border="0" usemap="#d1/d3e/utoprimgen_8c_a7e078cc9a354495bc85554d875a705d9_cgraph" alt=""/></div>
<map name="d1/d3e/utoprimgen_8c_a7e078cc9a354495bc85554d875a705d9_cgraph" id="d1/d3e/utoprimgen_8c_a7e078cc9a354495bc85554d875a705d9_cgraph">
<area shape="rect" id="node3" href="../../d1/d3e/utoprimgen_8c.html#a0a83e9e7fdd3cc595c5b8d0df88ec684" title="just picks the algorithm to invert" alt="" coords="144,252,264,282"/><area shape="rect" id="node11" href="../../d3/ddc/phys_8funcdeclare_8h.html#a41b8eacac0a4a23d6b00b670fe49629c" title="bsq_calc_fromq" alt="" coords="581,22,696,51"/><area shape="rect" id="node74" href="../../d1/d3e/utoprimgen_8c.html#abfc42de6975dd4ff02f2748404e10911" title="perform U&#45;&gt;p inversion on advected scalars" alt="" coords="149,359,259,388"/><area shape="rect" id="node76" href="../../d1/d3e/utoprimgen_8c.html#a1118806d01e553c38ae5cf5f036f9f2e" title="perform U&#45;&gt;p inversion on advected scalars" alt="" coords="149,412,259,442"/><area shape="rect" id="node78" href="../../d3/ddc/phys_8funcdeclare_8h.html#a11e17cd8b0594d1ad52e3594aa9f477e" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="364,92,439,122"/><area shape="rect" id="node83" href="../../d3/ddc/phys_8funcdeclare_8h.html#a9a54096e4c40a15a2c1bf74266153616" title="calculate &quot;conserved&quot; quantities" alt="" coords="171,306,237,335"/><area shape="rect" id="node90" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a5943065ab3d5b4e9f4f691db499b588f" title="calculates total opacity over dx[]" alt="" coords="161,500,247,530"/><area shape="rect" id="node5" href="../../d1/dde/utoprim__jon_8c.html#a2c450f7c2c86203afc48f0a40c665d38" title="The ONLY global function:" alt="" coords="313,358,489,405"/><area shape="rect" id="node7" href="../../d3/ddc/phys_8funcdeclare_8h.html#a3c69b676adf3024cd6ae832094d91fab" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="327,39,476,68"/><area shape="rect" id="node13" href="../../d3/ddc/phys_8funcdeclare_8h.html#aae6a7d24b984236dae44b1a3e8ee37b6" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="327,306,476,335"/><area shape="rect" id="node15" href="../../d7/def/phys_8tools_8c.html#ad54ad99ee062beaf43518d6e9afae0a7" title="primtoflux_nonradonly" alt="" coords="327,482,476,511"/><area shape="rect" id="node49" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a9fe58e7f372421d18633c8fc5007b815" title="u2p_rad" alt="" coords="368,199,435,228"/><area shape="rect" id="node63" href="../../d3/ddc/phys_8funcdeclare_8h.html#a07847bede2b7ba9d0aabaea82f17f989" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="339,146,464,175"/><area shape="rect" id="node67" href="../../d7/def/phys_8tools_8c.html#a764e6f682011d16faec0f9b71eb360d2" title="primtoflux_radonly" alt="" coords="337,252,465,282"/><area shape="rect" id="node9" href="../../d3/ddc/phys_8funcdeclare_8h.html#a12a473e24b431762af4168179e82cd08" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="557,75,720,104"/><area shape="rect" id="node17" href="../../d7/def/phys_8tools_8c.html#ace478826bef11e98daed7dd2ab026c93" title="matter only terms (as if B=0)" alt="" coords="587,438,691,467"/><area shape="rect" id="node37" href="../../d7/def/phys_8tools_8c.html#a664550c21e363870d26e73f3ab5b3d3c" title="electromagnetic terms (as if rho=u=p=0)" alt="" coords="587,554,691,583"/><area shape="rect" id="node19" href="../../d7/def/phys_8tools_8c.html#a133cabc36f68eda16f9245f749c3cc38" title="flux asociated with Ynu variable" alt="" coords="825,499,919,528"/><area shape="rect" id="node21" href="../../d7/def/phys_8tools_8c.html#a787551c0e83438fe9e63ecd3d996f61a" title="massflux_calc" alt="" coords="1041,499,1148,528"/><area shape="rect" id="node23" href="../../d7/def/phys_8tools_8c.html#a2ef51d65728fe59168e5b705165af6d4" title="flux associated with Y_L variable" alt="" coords="831,552,913,582"/><area shape="rect" id="node26" href="../../d7/def/phys_8tools_8c.html#a1e1dcf1d515232206c829a33d7e1192b" title="flux associated with Y_fl variable" alt="" coords="828,288,916,318"/><area shape="rect" id="node29" href="../../d7/def/phys_8tools_8c.html#a5717fa95303172fb697892a9232f0546" title="flux of specific entropy" alt="" coords="813,342,931,371"/><area shape="rect" id="node31" href="../../d7/def/phys_8tools_8c.html#a4886704a6724ea65ccaae2277b6ded74" title="MHD stress tensor, with first index up, second index down mhd^dir_j understood that mhddiagpress only..." alt="" coords="821,395,923,424"/><area shape="rect" id="node33" href="../../d7/def/phys_8tools_8c.html#ab3fd971df8ad09cce2462e78d7735f33" title="MHD stress tensor, with first index up, second index down." alt="" coords="1036,367,1153,396"/><area shape="rect" id="node35" href="../../d7/def/phys_8tools_8c.html#a44930b5d598885afcb717a270f42749f" title="MHD stress tensor, with first index up, second index down avoids catastrophic cancellation with rest&#45;..." alt="" coords="1005,420,1184,450"/><area shape="rect" id="node39" href="../../d7/def/phys_8tools_8c.html#a3552b97ec9f1982094fbc3e3f9af7f05" title="MHD stress tensor, with first index up, second index down mhd^dir_j." alt="" coords="821,606,923,635"/><area shape="rect" id="node45" href="../../d7/def/phys_8tools_8c.html#a12b4ca77ffbef030f608b079327b4eb7" title="spatial part of dualfaraday" alt="" coords="793,659,951,688"/><area shape="rect" id="node41" href="../../d7/def/phys_8tools_8c.html#a3f6e052b84282b8db7b05a0acc435622" title="EM part of stress&#45;energy tensor." alt="" coords="1036,606,1153,635"/><area shape="rect" id="node43" href="../../d7/def/phys_8tools_8c.html#a864ca09eade159d4c4b545593c1095de" title="MHD stress tensor, with first index up, second index down avoids catastrophic cancellation with rest&#45;..." alt="" coords="1016,552,1173,582"/><area shape="rect" id="node47" href="../../d7/def/phys_8tools_8c.html#abc846df49f33c007310b52240e099e3b" title="Notation for HARM paper and JCM&#39;s GRFFE paper is that: B^ = &#160;*F^{} and for lab&#45;frame we chose ={&#45;1..." alt="" coords="1027,659,1163,688"/><area shape="rect" id="node51" href="../../d2/d72/phys_8tools_8rad_8c.html#a67b370af2fa58283bc590ff4e895fb90" title="Like u2p_rad_orig(), but uses Jon&#39;s paper draft ZAMO RAD version." alt="" coords="589,182,688,211"/><area shape="rect" id="node53" href="../../d2/d72/phys_8tools_8rad_8c.html#a77c546a7fb064266fef5a9e796dc63dc" title="compute ZAMO version of radiation quantities as in paper draft" alt="" coords="799,128,945,158"/><area shape="rect" id="node55" href="../../d3/ddc/phys_8funcdeclare_8h.html#abfae38e47b0bd05a4fc38302ff948a96" title="find gamma&#45;factor wrt normal observer This function and qsq_calc() have about the same cache miss amo..." alt="" coords="787,182,957,211"/><area shape="rect" id="node57" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a3e47afcfc5c42719999d851395fd032d" title="nrad(E)" alt="" coords="808,75,936,104"/><area shape="rect" id="node59" href="../../df/d21/global_8funcdeclare_8rad_8h.html#af07558357c906b4dfa61cd34656d9f02" title="E=urad=arad T^4 and just solve for T (this is LTE only if assume resulting T is gas T)..." alt="" coords="1032,48,1157,78"/><area shape="rect" id="node61" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a7dc2e853cec9b6f9a5e83ce23c468d03" title="nrad(T) = nrad=arad T^3/2.70118 (this is LTE only if put in T was gas T)" alt="" coords="1031,102,1159,131"/><area shape="rect" id="node65" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a8a762bf6582e6f7e1199de9c43b98454" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="540,128,737,158"/><area shape="rect" id="node69" href="../../d7/def/phys_8tools_8c.html#a3c8277899afc2a48590156971490bb79" title="radiation terms (as if rho=u=p=0)" alt="" coords="587,271,691,300"/><area shape="rect" id="node72" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a389bf7e41d2fd117af996e3392067cdc" title="compute radiation stres&#45;energy tensor assuming M1 closure" alt="" coords="821,235,923,264"/><area shape="rect" id="node85" href="../../d3/ddc/phys_8funcdeclare_8h.html#a19e08c0d7e5a7c9fb9d97ff5ffab053c" title="Calculate fluxes in direction dir and conserved variable U returntype==0 : flux with geometric factor..." alt="" coords="363,428,440,458"/><area shape="rect" id="node92" href="../../d2/d72/phys_8tools_8rad_8c.html#a795959353203e99366b456b16d0d0bab" title="calculates total opacity over dx[] for given chi or chieff" alt="" coords="339,535,464,564"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d3e/utoprimgen_8c_a7e078cc9a354495bc85554d875a705d9_icgraph.png" border="0" usemap="#d1/d3e/utoprimgen_8c_a7e078cc9a354495bc85554d875a705d9_icgraph" alt=""/></div>
<map name="d1/d3e/utoprimgen_8c_a7e078cc9a354495bc85554d875a705d9_icgraph" id="d1/d3e/utoprimgen_8c_a7e078cc9a354495bc85554d875a705d9_icgraph">
<area shape="rect" id="node3" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="159,5,287,35"/><area shape="rect" id="node15" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="145,59,300,88"/><area shape="rect" id="node17" href="../../d8/d60/init_8c.html#af3b64278d50c2ff0fee80291fbd38dab" title="fieldprim" alt="" coords="188,112,257,141"/><area shape="rect" id="node31" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a8db9dc7c7f52d6fcb405a74e519db5cf" title="there may be something wrong with this function – didn&#39;t work in TIMEORDER==4, had to do standard met..." alt="" coords="177,165,268,195"/><area shape="rect" id="node5" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="368,5,437,35"/><area shape="rect" id="node7" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="508,5,641,35"/><area shape="rect" id="node9" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="712,5,779,35"/><area shape="rect" id="node11" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="847,5,937,35"/><area shape="rect" id="node13" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="987,32,1037,61"/><area shape="rect" id="node19" href="../../df/d15/init_8tools_8c.html#acefd26944dbbb1c289886f520f6befac" title="init_dsandvels" alt="" coords="351,59,455,88"/><area shape="rect" id="node28" href="../../de/db2/initbase_8funcdeclare_8h.html#a4e121b9448ac1adaa7608206369f9ea5" title="init_postvpot" alt="" coords="355,112,451,141"/><area shape="rect" id="node21" href="../../df/d15/init_8tools_8c.html#a77551ab2581efdbaf170dfca073ff9ab" title="user1_init_primitives" alt="" coords="504,59,645,88"/><area shape="rect" id="node23" href="../../de/db2/initbase_8funcdeclare_8h.html#a0afa200a5f947b1c9f6e554519f28fc4" title="init_primitives" alt="" coords="695,59,796,88"/><area shape="rect" id="node25" href="../../de/df8/initbase_8c.html#ac4110398e386c9888d9565630357dbbe" title="General&#45;Primary init() routine Uses globals inside init() because sets memory and sets physics..." alt="" coords="873,59,911,88"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0a83e9e7fdd3cc595c5b8d0df88ec684"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Utoprimgen_pick </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>showmessages</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>allowlocalfailurefixandnoreport</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>which</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>eomtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>whichcap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>parameter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>Ugeomfree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>ptrgeom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/de6/global_8depmnemonics_8h.html#a9377001671b5ece8bb2a2cf636de4b8a">PFTYPE</a> *&#160;</td>
          <td class="paramname"><em>lpflag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../db/d3a/structof__newtonstats.html">of_newtonstats</a> *&#160;</td>
          <td class="paramname"><em>newtonstats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/de6/global_8depmnemonics_8h.html#a9377001671b5ece8bb2a2cf636de4b8a">PFTYPE</a> *&#160;</td>
          <td class="paramname"><em>lpflagrad</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>just picks the algorithm to invert </p>

<p>Definition at line <a class="el" href="../../d1/d3e/utoprimgen_8c_source.html#l02615">2615</a> of file <a class="el" href="../../d1/d3e/utoprimgen_8c_source.html">utoprimgen.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d3e/utoprimgen_8c_a0a83e9e7fdd3cc595c5b8d0df88ec684_cgraph.png" border="0" usemap="#d1/d3e/utoprimgen_8c_a0a83e9e7fdd3cc595c5b8d0df88ec684_cgraph" alt=""/></div>
<map name="d1/d3e/utoprimgen_8c_a0a83e9e7fdd3cc595c5b8d0df88ec684_cgraph" id="d1/d3e/utoprimgen_8c_a0a83e9e7fdd3cc595c5b8d0df88ec684_cgraph">
<area shape="rect" id="node3" href="../../d1/dde/utoprim__jon_8c.html#a2c450f7c2c86203afc48f0a40c665d38" title="The ONLY global function:" alt="" coords="175,146,351,193"/><area shape="rect" id="node5" href="../../d3/ddc/phys_8funcdeclare_8h.html#a3c69b676adf3024cd6ae832094d91fab" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="188,216,337,245"/><area shape="rect" id="node11" href="../../d3/ddc/phys_8funcdeclare_8h.html#aae6a7d24b984236dae44b1a3e8ee37b6" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="188,269,337,299"/><area shape="rect" id="node13" href="../../d7/def/phys_8tools_8c.html#ad54ad99ee062beaf43518d6e9afae0a7" title="primtoflux_nonradonly" alt="" coords="188,323,337,352"/><area shape="rect" id="node47" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a9fe58e7f372421d18633c8fc5007b815" title="u2p_rad" alt="" coords="229,469,296,499"/><area shape="rect" id="node61" href="../../d3/ddc/phys_8funcdeclare_8h.html#a07847bede2b7ba9d0aabaea82f17f989" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="200,576,325,605"/><area shape="rect" id="node65" href="../../d7/def/phys_8tools_8c.html#a764e6f682011d16faec0f9b71eb360d2" title="primtoflux_radonly" alt="" coords="199,389,327,419"/><area shape="rect" id="node7" href="../../d3/ddc/phys_8funcdeclare_8h.html#a12a473e24b431762af4168179e82cd08" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="419,216,581,245"/><area shape="rect" id="node9" href="../../d3/ddc/phys_8funcdeclare_8h.html#a41b8eacac0a4a23d6b00b670fe49629c" title="bsq_calc_fromq" alt="" coords="443,163,557,192"/><area shape="rect" id="node15" href="../../d7/def/phys_8tools_8c.html#ace478826bef11e98daed7dd2ab026c93" title="matter only terms (as if B=0)" alt="" coords="448,323,552,352"/><area shape="rect" id="node35" href="../../d7/def/phys_8tools_8c.html#a664550c21e363870d26e73f3ab5b3d3c" title="electromagnetic terms (as if rho=u=p=0)" alt="" coords="448,269,552,299"/><area shape="rect" id="node17" href="../../d7/def/phys_8tools_8c.html#a133cabc36f68eda16f9245f749c3cc38" title="flux asociated with Ynu variable" alt="" coords="687,216,780,245"/><area shape="rect" id="node19" href="../../d7/def/phys_8tools_8c.html#a787551c0e83438fe9e63ecd3d996f61a" title="massflux_calc" alt="" coords="903,216,1009,245"/><area shape="rect" id="node21" href="../../d7/def/phys_8tools_8c.html#a2ef51d65728fe59168e5b705165af6d4" title="flux associated with Y_L variable" alt="" coords="692,269,775,299"/><area shape="rect" id="node24" href="../../d7/def/phys_8tools_8c.html#a1e1dcf1d515232206c829a33d7e1192b" title="flux associated with Y_fl variable" alt="" coords="689,429,777,459"/><area shape="rect" id="node27" href="../../d7/def/phys_8tools_8c.html#a5717fa95303172fb697892a9232f0546" title="flux of specific entropy" alt="" coords="675,323,792,352"/><area shape="rect" id="node29" href="../../d7/def/phys_8tools_8c.html#a4886704a6724ea65ccaae2277b6ded74" title="MHD stress tensor, with first index up, second index down mhd^dir_j understood that mhddiagpress only..." alt="" coords="683,376,784,405"/><area shape="rect" id="node31" href="../../d7/def/phys_8tools_8c.html#ab3fd971df8ad09cce2462e78d7735f33" title="MHD stress tensor, with first index up, second index down." alt="" coords="897,403,1015,432"/><area shape="rect" id="node33" href="../../d7/def/phys_8tools_8c.html#a44930b5d598885afcb717a270f42749f" title="MHD stress tensor, with first index up, second index down avoids catastrophic cancellation with rest&#45;..." alt="" coords="867,349,1045,379"/><area shape="rect" id="node37" href="../../d7/def/phys_8tools_8c.html#a3552b97ec9f1982094fbc3e3f9af7f05" title="MHD stress tensor, with first index up, second index down mhd^dir_j." alt="" coords="683,59,784,88"/><area shape="rect" id="node43" href="../../d7/def/phys_8tools_8c.html#a12b4ca77ffbef030f608b079327b4eb7" title="spatial part of dualfaraday" alt="" coords="655,112,812,141"/><area shape="rect" id="node39" href="../../d7/def/phys_8tools_8c.html#a3f6e052b84282b8db7b05a0acc435622" title="EM part of stress&#45;energy tensor." alt="" coords="897,5,1015,35"/><area shape="rect" id="node41" href="../../d7/def/phys_8tools_8c.html#a864ca09eade159d4c4b545593c1095de" title="MHD stress tensor, with first index up, second index down avoids catastrophic cancellation with rest&#45;..." alt="" coords="877,59,1035,88"/><area shape="rect" id="node45" href="../../d7/def/phys_8tools_8c.html#abc846df49f33c007310b52240e099e3b" title="Notation for HARM paper and JCM&#39;s GRFFE paper is that: B^ = &#160;*F^{} and for lab&#45;frame we chose ={&#45;1..." alt="" coords="888,112,1024,141"/><area shape="rect" id="node49" href="../../d2/d72/phys_8tools_8rad_8c.html#a67b370af2fa58283bc590ff4e895fb90" title="Like u2p_rad_orig(), but uses Jon&#39;s paper draft ZAMO RAD version." alt="" coords="451,536,549,565"/><area shape="rect" id="node51" href="../../d2/d72/phys_8tools_8rad_8c.html#a77c546a7fb064266fef5a9e796dc63dc" title="compute ZAMO version of radiation quantities as in paper draft" alt="" coords="660,536,807,565"/><area shape="rect" id="node53" href="../../d3/ddc/phys_8funcdeclare_8h.html#abfae38e47b0bd05a4fc38302ff948a96" title="find gamma&#45;factor wrt normal observer This function and qsq_calc() have about the same cache miss amo..." alt="" coords="648,589,819,619"/><area shape="rect" id="node55" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a3e47afcfc5c42719999d851395fd032d" title="nrad(E)" alt="" coords="669,643,797,672"/><area shape="rect" id="node57" href="../../df/d21/global_8funcdeclare_8rad_8h.html#af07558357c906b4dfa61cd34656d9f02" title="E=urad=arad T^4 and just solve for T (this is LTE only if assume resulting T is gas T)..." alt="" coords="893,616,1019,645"/><area shape="rect" id="node59" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a7dc2e853cec9b6f9a5e83ce23c468d03" title="nrad(T) = nrad=arad T^3/2.70118 (this is LTE only if put in T was gas T)" alt="" coords="892,669,1020,699"/><area shape="rect" id="node63" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a8a762bf6582e6f7e1199de9c43b98454" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="401,589,599,619"/><area shape="rect" id="node67" href="../../d7/def/phys_8tools_8c.html#a3c8277899afc2a48590156971490bb79" title="radiation terms (as if rho=u=p=0)" alt="" coords="448,429,552,459"/><area shape="rect" id="node70" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a389bf7e41d2fd117af996e3392067cdc" title="compute radiation stres&#45;energy tensor assuming M1 closure" alt="" coords="683,483,784,512"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d3e/utoprimgen_8c_a0a83e9e7fdd3cc595c5b8d0df88ec684_icgraph.png" border="0" usemap="#d1/d3e/utoprimgen_8c_a0a83e9e7fdd3cc595c5b8d0df88ec684_icgraph" alt=""/></div>
<map name="d1/d3e/utoprimgen_8c_a0a83e9e7fdd3cc595c5b8d0df88ec684_icgraph" id="d1/d3e/utoprimgen_8c_a0a83e9e7fdd3cc595c5b8d0df88ec684_icgraph">
<area shape="rect" id="node3" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a7e078cc9a354495bc85554d875a705d9" title="General explicit inversion of U[MHD]&#45;&gt;P[MHD] and also inverts scalars. Inverts radiation if(EOMRADTYP..." alt="" coords="175,85,263,115"/><area shape="rect" id="node5" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="327,5,455,35"/><area shape="rect" id="node17" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="313,59,468,88"/><area shape="rect" id="node19" href="../../d8/d60/init_8c.html#af3b64278d50c2ff0fee80291fbd38dab" title="fieldprim" alt="" coords="356,112,425,141"/><area shape="rect" id="node33" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a8db9dc7c7f52d6fcb405a74e519db5cf" title="there may be something wrong with this function – didn&#39;t work in TIMEORDER==4, had to do standard met..." alt="" coords="345,165,436,195"/><area shape="rect" id="node7" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="536,5,605,35"/><area shape="rect" id="node9" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="676,5,809,35"/><area shape="rect" id="node11" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="880,5,947,35"/><area shape="rect" id="node13" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="1015,5,1105,35"/><area shape="rect" id="node15" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="1155,32,1205,61"/><area shape="rect" id="node21" href="../../df/d15/init_8tools_8c.html#acefd26944dbbb1c289886f520f6befac" title="init_dsandvels" alt="" coords="519,59,623,88"/><area shape="rect" id="node30" href="../../de/db2/initbase_8funcdeclare_8h.html#a4e121b9448ac1adaa7608206369f9ea5" title="init_postvpot" alt="" coords="523,112,619,141"/><area shape="rect" id="node23" href="../../df/d15/init_8tools_8c.html#a77551ab2581efdbaf170dfca073ff9ab" title="user1_init_primitives" alt="" coords="672,59,813,88"/><area shape="rect" id="node25" href="../../de/db2/initbase_8funcdeclare_8h.html#a0afa200a5f947b1c9f6e554519f28fc4" title="init_primitives" alt="" coords="863,59,964,88"/><area shape="rect" id="node27" href="../../de/df8/initbase_8c.html#ac4110398e386c9888d9565630357dbbe" title="General&#45;Primary init() routine Uses globals inside init() because sets memory and sets physics..." alt="" coords="1041,59,1079,88"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1986bb1d8ba8daf8c30863f647fb583e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Utoprimloop </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>U</em>[NSTORE2][NSTORE3][NPR], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>prim</em>[NSTORE2][NSTORE3][NPR], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../db/d3a/structof__newtonstats.html">of_newtonstats</a> *&#160;</td>
          <td class="paramname"><em>newtonstats</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>there may be something wrong with this function &ndash; didn't work in TIMEORDER==4, had to do standard method could have just been that I wasn't bounding after using this </p>

<p>Definition at line <a class="el" href="../../d1/d3e/utoprimgen_8c_source.html#l02812">2812</a> of file <a class="el" href="../../d1/d3e/utoprimgen_8c_source.html">utoprimgen.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d3e/utoprimgen_8c_a1986bb1d8ba8daf8c30863f647fb583e_cgraph.png" border="0" usemap="#d1/d3e/utoprimgen_8c_a1986bb1d8ba8daf8c30863f647fb583e_cgraph" alt=""/></div>
<map name="d1/d3e/utoprimgen_8c_a1986bb1d8ba8daf8c30863f647fb583e_cgraph" id="d1/d3e/utoprimgen_8c_a1986bb1d8ba8daf8c30863f647fb583e_cgraph">
<area shape="rect" id="node3" href="../../d1/d3e/utoprimgen_8c.html#a7e078cc9a354495bc85554d875a705d9" title="General explicit inversion of U[MHD]&#45;&gt;P[MHD] and also inverts scalars. Inverts radiation if(EOMRADTYP..." alt="" coords="148,306,236,335"/><area shape="rect" id="node5" href="../../d1/d3e/utoprimgen_8c.html#a0a83e9e7fdd3cc595c5b8d0df88ec684" title="just picks the algorithm to invert" alt="" coords="285,252,405,282"/><area shape="rect" id="node13" href="../../d3/ddc/phys_8funcdeclare_8h.html#a41b8eacac0a4a23d6b00b670fe49629c" title="bsq_calc_fromq" alt="" coords="723,22,837,51"/><area shape="rect" id="node76" href="../../d1/d3e/utoprimgen_8c.html#abfc42de6975dd4ff02f2748404e10911" title="perform U&#45;&gt;p inversion on advected scalars" alt="" coords="291,359,400,388"/><area shape="rect" id="node78" href="../../d1/d3e/utoprimgen_8c.html#a1118806d01e553c38ae5cf5f036f9f2e" title="perform U&#45;&gt;p inversion on advected scalars" alt="" coords="291,412,400,442"/><area shape="rect" id="node80" href="../../d3/ddc/phys_8funcdeclare_8h.html#a11e17cd8b0594d1ad52e3594aa9f477e" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="505,92,580,122"/><area shape="rect" id="node85" href="../../d3/ddc/phys_8funcdeclare_8h.html#a9a54096e4c40a15a2c1bf74266153616" title="calculate &quot;conserved&quot; quantities" alt="" coords="312,306,379,335"/><area shape="rect" id="node92" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a5943065ab3d5b4e9f4f691db499b588f" title="calculates total opacity over dx[]" alt="" coords="303,500,388,530"/><area shape="rect" id="node7" href="../../d1/dde/utoprim__jon_8c.html#a2c450f7c2c86203afc48f0a40c665d38" title="The ONLY global function:" alt="" coords="455,358,631,405"/><area shape="rect" id="node9" href="../../d3/ddc/phys_8funcdeclare_8h.html#a3c69b676adf3024cd6ae832094d91fab" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="468,39,617,68"/><area shape="rect" id="node15" href="../../d3/ddc/phys_8funcdeclare_8h.html#aae6a7d24b984236dae44b1a3e8ee37b6" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="468,306,617,335"/><area shape="rect" id="node17" href="../../d7/def/phys_8tools_8c.html#ad54ad99ee062beaf43518d6e9afae0a7" title="primtoflux_nonradonly" alt="" coords="468,482,617,511"/><area shape="rect" id="node51" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a9fe58e7f372421d18633c8fc5007b815" title="u2p_rad" alt="" coords="509,199,576,228"/><area shape="rect" id="node65" href="../../d3/ddc/phys_8funcdeclare_8h.html#a07847bede2b7ba9d0aabaea82f17f989" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="480,146,605,175"/><area shape="rect" id="node69" href="../../d7/def/phys_8tools_8c.html#a764e6f682011d16faec0f9b71eb360d2" title="primtoflux_radonly" alt="" coords="479,252,607,282"/><area shape="rect" id="node11" href="../../d3/ddc/phys_8funcdeclare_8h.html#a12a473e24b431762af4168179e82cd08" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="699,75,861,104"/><area shape="rect" id="node19" href="../../d7/def/phys_8tools_8c.html#ace478826bef11e98daed7dd2ab026c93" title="matter only terms (as if B=0)" alt="" coords="728,438,832,467"/><area shape="rect" id="node39" href="../../d7/def/phys_8tools_8c.html#a664550c21e363870d26e73f3ab5b3d3c" title="electromagnetic terms (as if rho=u=p=0)" alt="" coords="728,554,832,583"/><area shape="rect" id="node21" href="../../d7/def/phys_8tools_8c.html#a133cabc36f68eda16f9245f749c3cc38" title="flux asociated with Ynu variable" alt="" coords="967,499,1060,528"/><area shape="rect" id="node23" href="../../d7/def/phys_8tools_8c.html#a787551c0e83438fe9e63ecd3d996f61a" title="massflux_calc" alt="" coords="1183,499,1289,528"/><area shape="rect" id="node25" href="../../d7/def/phys_8tools_8c.html#a2ef51d65728fe59168e5b705165af6d4" title="flux associated with Y_L variable" alt="" coords="972,552,1055,582"/><area shape="rect" id="node28" href="../../d7/def/phys_8tools_8c.html#a1e1dcf1d515232206c829a33d7e1192b" title="flux associated with Y_fl variable" alt="" coords="969,288,1057,318"/><area shape="rect" id="node31" href="../../d7/def/phys_8tools_8c.html#a5717fa95303172fb697892a9232f0546" title="flux of specific entropy" alt="" coords="955,342,1072,371"/><area shape="rect" id="node33" href="../../d7/def/phys_8tools_8c.html#a4886704a6724ea65ccaae2277b6ded74" title="MHD stress tensor, with first index up, second index down mhd^dir_j understood that mhddiagpress only..." alt="" coords="963,395,1064,424"/><area shape="rect" id="node35" href="../../d7/def/phys_8tools_8c.html#ab3fd971df8ad09cce2462e78d7735f33" title="MHD stress tensor, with first index up, second index down." alt="" coords="1177,367,1295,396"/><area shape="rect" id="node37" href="../../d7/def/phys_8tools_8c.html#a44930b5d598885afcb717a270f42749f" title="MHD stress tensor, with first index up, second index down avoids catastrophic cancellation with rest&#45;..." alt="" coords="1147,420,1325,450"/><area shape="rect" id="node41" href="../../d7/def/phys_8tools_8c.html#a3552b97ec9f1982094fbc3e3f9af7f05" title="MHD stress tensor, with first index up, second index down mhd^dir_j." alt="" coords="963,606,1064,635"/><area shape="rect" id="node47" href="../../d7/def/phys_8tools_8c.html#a12b4ca77ffbef030f608b079327b4eb7" title="spatial part of dualfaraday" alt="" coords="935,659,1092,688"/><area shape="rect" id="node43" href="../../d7/def/phys_8tools_8c.html#a3f6e052b84282b8db7b05a0acc435622" title="EM part of stress&#45;energy tensor." alt="" coords="1177,606,1295,635"/><area shape="rect" id="node45" href="../../d7/def/phys_8tools_8c.html#a864ca09eade159d4c4b545593c1095de" title="MHD stress tensor, with first index up, second index down avoids catastrophic cancellation with rest&#45;..." alt="" coords="1157,552,1315,582"/><area shape="rect" id="node49" href="../../d7/def/phys_8tools_8c.html#abc846df49f33c007310b52240e099e3b" title="Notation for HARM paper and JCM&#39;s GRFFE paper is that: B^ = &#160;*F^{} and for lab&#45;frame we chose ={&#45;1..." alt="" coords="1168,659,1304,688"/><area shape="rect" id="node53" href="../../d2/d72/phys_8tools_8rad_8c.html#a67b370af2fa58283bc590ff4e895fb90" title="Like u2p_rad_orig(), but uses Jon&#39;s paper draft ZAMO RAD version." alt="" coords="731,182,829,211"/><area shape="rect" id="node55" href="../../d2/d72/phys_8tools_8rad_8c.html#a77c546a7fb064266fef5a9e796dc63dc" title="compute ZAMO version of radiation quantities as in paper draft" alt="" coords="940,128,1087,158"/><area shape="rect" id="node57" href="../../d3/ddc/phys_8funcdeclare_8h.html#abfae38e47b0bd05a4fc38302ff948a96" title="find gamma&#45;factor wrt normal observer This function and qsq_calc() have about the same cache miss amo..." alt="" coords="928,182,1099,211"/><area shape="rect" id="node59" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a3e47afcfc5c42719999d851395fd032d" title="nrad(E)" alt="" coords="949,75,1077,104"/><area shape="rect" id="node61" href="../../df/d21/global_8funcdeclare_8rad_8h.html#af07558357c906b4dfa61cd34656d9f02" title="E=urad=arad T^4 and just solve for T (this is LTE only if assume resulting T is gas T)..." alt="" coords="1173,48,1299,78"/><area shape="rect" id="node63" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a7dc2e853cec9b6f9a5e83ce23c468d03" title="nrad(T) = nrad=arad T^3/2.70118 (this is LTE only if put in T was gas T)" alt="" coords="1172,102,1300,131"/><area shape="rect" id="node67" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a8a762bf6582e6f7e1199de9c43b98454" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="681,128,879,158"/><area shape="rect" id="node71" href="../../d7/def/phys_8tools_8c.html#a3c8277899afc2a48590156971490bb79" title="radiation terms (as if rho=u=p=0)" alt="" coords="728,271,832,300"/><area shape="rect" id="node74" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a389bf7e41d2fd117af996e3392067cdc" title="compute radiation stres&#45;energy tensor assuming M1 closure" alt="" coords="963,235,1064,264"/><area shape="rect" id="node87" href="../../d3/ddc/phys_8funcdeclare_8h.html#a19e08c0d7e5a7c9fb9d97ff5ffab053c" title="Calculate fluxes in direction dir and conserved variable U returntype==0 : flux with geometric factor..." alt="" coords="504,428,581,458"/><area shape="rect" id="node94" href="../../d2/d72/phys_8tools_8rad_8c.html#a795959353203e99366b456b16d0d0bab" title="calculates total opacity over dx[] for given chi or chieff" alt="" coords="480,535,605,564"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri May 20 2016 15:52:38 for HARM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.3.1
</small></address>
</body>
</html>
