<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>HARM: boundsflux.c Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">HARM
   </div>
   <div id="projectbrief">harm and utilities</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">boundsflux.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../db/dec/boundsflux_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &quot;decs.h&quot;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div>
<div class="line"><a name="l00029"></a><span class="lineno"><a class="code" href="../../db/dec/boundsflux_8c.html#a4c8d48cb13d800416e48577263572f3e">   29</a></span>&#160;<span class="preprocessor">#define EXTRAP 0 //atch</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div>
<div class="line"><a name="l00034"></a><span class="lineno"><a class="code" href="../../db/dec/boundsflux_8c.html#a8754d691787753931622044c7f4e2c26">   34</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../db/dec/boundsflux_8c.html#a8754d691787753931622044c7f4e2c26">inboundloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l00035"></a><span class="lineno"><a class="code" href="../../db/dec/boundsflux_8c.html#a8807fc7ac0410e5b4f8946af8d20e5f5">   35</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../db/dec/boundsflux_8c.html#a8807fc7ac0410e5b4f8946af8d20e5f5">outboundloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l00036"></a><span class="lineno"><a class="code" href="../../db/dec/boundsflux_8c.html#a2d80075c76ae3f379ad6b0a76e782564">   36</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../db/dec/boundsflux_8c.html#a2d80075c76ae3f379ad6b0a76e782564">innormalloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l00037"></a><span class="lineno"><a class="code" href="../../db/dec/boundsflux_8c.html#aca97d7ba819c1de5d4e47da493f33623">   37</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../db/dec/boundsflux_8c.html#aca97d7ba819c1de5d4e47da493f33623">outnormalloop</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l00038"></a><span class="lineno"><a class="code" href="../../db/dec/boundsflux_8c.html#a837550a23566d53384a9b084e0dceb33">   38</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../db/dec/boundsflux_8c.html#a837550a23566d53384a9b084e0dceb33">inoutlohi</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a169f8e6d2a36fff12cb4999820e22214">NUMUPDOWN</a>][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a169f8e6d2a36fff12cb4999820e22214">NUMUPDOWN</a>][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l00039"></a><span class="lineno"><a class="code" href="../../db/dec/boundsflux_8c.html#ac2060e4059d47a488d84bf9126c19fca">   39</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../db/dec/boundsflux_8c.html#ac829241613d010b49da556690e5a5dba">riin</a>,<a class="code" href="../../db/dec/boundsflux_8c.html#a9ff963dee6a8ee6dadda7021050f07d1">riout</a>,<a class="code" href="../../db/dec/boundsflux_8c.html#a52d95b79e8bfdeaf3173426e93d4c0bc">rjin</a>,<a class="code" href="../../db/dec/boundsflux_8c.html#a62e6126121a80cd84f5f24116e0ac5e3">rjout</a>,<a class="code" href="../../db/dec/boundsflux_8c.html#a004e2bf74d687fea2dae13579ce6dfd5">rkin</a>,<a class="code" href="../../db/dec/boundsflux_8c.html#ac2060e4059d47a488d84bf9126c19fca">rkout</a>;</div>
<div class="line"><a name="l00040"></a><span class="lineno"><a class="code" href="../../db/dec/boundsflux_8c.html#ae0df21c9bb5d73f77a8cac713c7c9d2c">   40</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../db/dec/boundsflux_8c.html#ae0df21c9bb5d73f77a8cac713c7c9d2c">dosetbc</a>[<a class="code" href="../../da/d3e/definit_8h.html#a1b2ef8afddd2c5d91ab65015bbd7b80b" title="NUMBER OF DIMENSIONS FOR COMPUTATION Can choose 3 and still do 1D optimized problems Choosing 2 or ev...">COMPDIM</a>*2];</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div>
<div class="line"><a name="l00045"></a><span class="lineno"><a class="code" href="../../db/dec/boundsflux_8c.html#a5f4f9381769d3963bdf2dcd0c0202aa4">   45</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d4/dad/bounds_8funcdeclare_8h.html#a5f4f9381769d3963bdf2dcd0c0202aa4">bound_flux_user</a>(<span class="keywordtype">int</span> boundstage, <span class="keywordtype">int</span> finalstep, <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> boundtime, <span class="keywordtype">int</span> boundvartype, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*F1)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*F2)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*F3)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>])</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;{</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#ad21ff679aac3fe28202c6d592eafd3e6">i</a>,<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>,k,pl,pliter;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keyword">struct </span><a class="code" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae" title="typedef struct of_geom struct of_compgeom; force to be the same">of_geom</a> geom,rgeom;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> vcon[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>]; <span class="comment">// coordinate basis vcon</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#if(WHICHVEL==VEL3)</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor"></span>  <span class="keywordtype">int</span> failreturn;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor"></span>  <span class="keywordtype">int</span> ri, rj, rk; <span class="comment">// reference i,j,k</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> prescale[NPR];</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="keywordtype">int</span> enerregion;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordtype">int</span> *localenerpos;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keywordtype">int</span> *<a class="code" href="../../d8/d5b/defs_8general_8h.html#a03344fc1457035406713e8d85d215576" title="used for each region, related to global quantities _tot quantities here are global since used in rest...">doflux</a>;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="comment">// set bound loop</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment"></span>  set_boundloop(boundvartype, <a class="code" href="../../db/dec/boundsflux_8c.html#a8754d691787753931622044c7f4e2c26">inboundloop</a>,<a class="code" href="../../db/dec/boundsflux_8c.html#a8807fc7ac0410e5b4f8946af8d20e5f5">outboundloop</a>,<a class="code" href="../../db/dec/boundsflux_8c.html#a2d80075c76ae3f379ad6b0a76e782564">innormalloop</a>,<a class="code" href="../../db/dec/boundsflux_8c.html#aca97d7ba819c1de5d4e47da493f33623">outnormalloop</a>,<a class="code" href="../../db/dec/boundsflux_8c.html#a837550a23566d53384a9b084e0dceb33">inoutlohi</a>, &amp;<a class="code" href="../../db/dec/boundsflux_8c.html#ac829241613d010b49da556690e5a5dba">riin</a>, &amp;<a class="code" href="../../db/dec/boundsflux_8c.html#a9ff963dee6a8ee6dadda7021050f07d1">riout</a>, &amp;<a class="code" href="../../db/dec/boundsflux_8c.html#a52d95b79e8bfdeaf3173426e93d4c0bc">rjin</a>, &amp;<a class="code" href="../../db/dec/boundsflux_8c.html#a62e6126121a80cd84f5f24116e0ac5e3">rjout</a>, &amp;<a class="code" href="../../db/dec/boundsflux_8c.html#a004e2bf74d687fea2dae13579ce6dfd5">rkin</a>, &amp;<a class="code" href="../../db/dec/boundsflux_8c.html#ac2060e4059d47a488d84bf9126c19fca">rkout</a>, <a class="code" href="../../db/dec/boundsflux_8c.html#ae0df21c9bb5d73f77a8cac713c7c9d2c">dosetbc</a>);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="comment">//  enerregion=ACTIVEREGION; // now replaces TRUEGLOBALENERREGION</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="comment">//  localenerpos=enerposreg[enerregion];</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="comment">//  doflux=dofluxreg[enerregion];</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="comment">// periodic x1</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keywordflow">if</span> ( (<a class="code" href="../../dd/d46/mpidefs_8h.html#ac3a964fb7b8404428db52c2588d52381">mycpupos</a>[1] == 0)&amp;&amp;(<a class="code" href="../../dd/d46/mpidefs_8h.html#ac3a964fb7b8404428db52c2588d52381">mycpupos</a>[1] == <a class="code" href="../../dd/d46/mpidefs_8h.html#a849af7562e98534cd4ea5764f5187bbd">ncpux1</a> - 1) ) {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordflow">if</span>( (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aab7332b2c03d905515d5350d4fd0850f">X1DN</a>]==<a class="code" href="../../da/d3e/definit_8h.html#af36821ad7b93ab31dcfaaa25e134fdf0">PERIODIC</a>)&amp;&amp;(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a6a3603145c91f722d74610fbd6e4f696" title="----------â€”&gt; r | 3 | 1-0 | 2 v theta and likewise for 4,5 (4=out,5=in) directions:">X1UP</a>]==<a class="code" href="../../da/d3e/definit_8h.html#af36821ad7b93ab31dcfaaa25e134fdf0">PERIODIC</a>) ){</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      <span class="comment">// just copy from one side to another</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#a203e3b910738f16ad48b07082cd62797" title="for X1-dir [Note always uses innormal and outnormal so assumed to use this X1-dir loop first]...">LOOPX1dir</a>{</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <span class="comment">// copy from upper side to lower boundary zones</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        ri=<a class="code" href="../../db/dec/boundsflux_8c.html#a9ff963dee6a8ee6dadda7021050f07d1">riout</a>;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        rj=<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        rk=k;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#ac69bc344822b49071d0f205f3f51baed">LOOPBOUND1IN</a> <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#aa96fc40723116a2232f01a9902bfefb8" title="loop over all bounding Primitive variables">PBOUNDLOOP</a>(pliter,pl) <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F1,i,j,k,pl) = <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F1,ri+1+i,rj,rk,pl); <span class="comment">// for i=0 -&gt; i=N1</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a11c4e99e1493d0c1914ad1ab313ea472">FLUXB</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0b6762cef74e396f50a83864bb53fb6c">FLUXCTSTAG</a>){</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a>&gt;1) <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#ac69bc344822b49071d0f205f3f51baed">LOOPBOUND1IN</a> <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#aa96fc40723116a2232f01a9902bfefb8" title="loop over all bounding Primitive variables">PBOUNDLOOP</a>(pliter,pl) <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F2,i,j,k,pl) = <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F2,ri+1+i,rj,rk,pl);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#ad66109fbdc4d3adc9c3d6ff917038aef">N3</a>&gt;1) <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#ac69bc344822b49071d0f205f3f51baed">LOOPBOUND1IN</a> <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#aa96fc40723116a2232f01a9902bfefb8" title="loop over all bounding Primitive variables">PBOUNDLOOP</a>(pliter,pl) <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F3,i,j,k,pl) = <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F3,ri+1+i,rj,rk,pl);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="comment">// copy from lower side to upper boundary zones</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        ri=<a class="code" href="../../db/dec/boundsflux_8c.html#ac829241613d010b49da556690e5a5dba">riin</a>;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        rj=<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        rk=k;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#ab6234714e5a7d10c0ffcb5836cd3894b">LOOPBOUND1OUT</a> <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#aa96fc40723116a2232f01a9902bfefb8" title="loop over all bounding Primitive variables">PBOUNDLOOP</a>(pliter,pl) <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F1,i,j,k,pl) = <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F1,ri+(i-<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>),rj,rk,pl); <span class="comment">// for i=N1 -&gt; i=0</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a11c4e99e1493d0c1914ad1ab313ea472">FLUXB</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0b6762cef74e396f50a83864bb53fb6c">FLUXCTSTAG</a>){</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a>&gt;1) <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#ab6234714e5a7d10c0ffcb5836cd3894b">LOOPBOUND1OUT</a> <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#aa96fc40723116a2232f01a9902bfefb8" title="loop over all bounding Primitive variables">PBOUNDLOOP</a>(pliter,pl) <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F2,i,j,k,pl) = <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F2,ri+(i-<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>),rj,rk,pl); <span class="comment">// for i=N1 -&gt; i=0</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#ad66109fbdc4d3adc9c3d6ff917038aef">N3</a>&gt;1) <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#ab6234714e5a7d10c0ffcb5836cd3894b">LOOPBOUND1OUT</a> <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#aa96fc40723116a2232f01a9902bfefb8" title="loop over all bounding Primitive variables">PBOUNDLOOP</a>(pliter,pl) <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F3,i,j,k,pl) = <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F3,ri+(i-<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>),rj,rk,pl); <span class="comment">// for i=N1 -&gt; i=0</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        }</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    }</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  }</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="comment">// periodic x2</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordflow">if</span> ( (<a class="code" href="../../dd/d46/mpidefs_8h.html#ac3a964fb7b8404428db52c2588d52381">mycpupos</a>[2] == 0)&amp;&amp;(<a class="code" href="../../dd/d46/mpidefs_8h.html#ac3a964fb7b8404428db52c2588d52381">mycpupos</a>[2] == <a class="code" href="../../dd/d46/mpidefs_8h.html#a2b69fb4a20e91ae01ef8452216afb784">ncpux2</a> - 1) ) {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordflow">if</span>( (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aae79dca9f851fb40349156f6bca1f8ca">X2DN</a>]==<a class="code" href="../../da/d3e/definit_8h.html#af36821ad7b93ab31dcfaaa25e134fdf0">PERIODIC</a>)&amp;&amp;(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aa9363649053ac2e906715b3259a14954">X2UP</a>]==<a class="code" href="../../da/d3e/definit_8h.html#af36821ad7b93ab31dcfaaa25e134fdf0">PERIODIC</a>) ){</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      <span class="comment">// just copy from one side to another</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#a8d8b8bb42cbf5b3cbea7d0cfdff08c30" title="for X2-dir [Note innormal and outnormal for 3rd direction and full inbound and outbound for 1st direc...">LOOPX2dir</a>{</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="comment">// copy from upper side to lower boundary zones</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        ri=<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#ad21ff679aac3fe28202c6d592eafd3e6">i</a>;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        rj=<a class="code" href="../../db/dec/boundsflux_8c.html#a62e6126121a80cd84f5f24116e0ac5e3">rjout</a>;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        rk=k;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#a024d4db998ded5c8ed6d1ceabda730ea">LOOPBOUND2IN</a> <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#aa96fc40723116a2232f01a9902bfefb8" title="loop over all bounding Primitive variables">PBOUNDLOOP</a>(pliter,pl) <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F2,i,j,k,pl) = <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F2,ri,rj+1+j,rk,pl); <span class="comment">// for j=0 -&gt; j=N2</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a11c4e99e1493d0c1914ad1ab313ea472">FLUXB</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0b6762cef74e396f50a83864bb53fb6c">FLUXCTSTAG</a>){</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>&gt;1) <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#a024d4db998ded5c8ed6d1ceabda730ea">LOOPBOUND2IN</a> <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#aa96fc40723116a2232f01a9902bfefb8" title="loop over all bounding Primitive variables">PBOUNDLOOP</a>(pliter,pl) <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F1,i,j,k,pl) = <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F1,ri,rj+1+j,rk,pl); <span class="comment">// for j=0 -&gt; j=N2</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#ad66109fbdc4d3adc9c3d6ff917038aef">N3</a>&gt;1) <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#a024d4db998ded5c8ed6d1ceabda730ea">LOOPBOUND2IN</a> <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#aa96fc40723116a2232f01a9902bfefb8" title="loop over all bounding Primitive variables">PBOUNDLOOP</a>(pliter,pl) <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F3,i,j,k,pl) = <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F3,ri,rj+1+j,rk,pl); <span class="comment">// for j=0 -&gt; j=N2</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="comment">// copy from lower side to upper boundary zones</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        ri=<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#ad21ff679aac3fe28202c6d592eafd3e6">i</a>;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        rj=<a class="code" href="../../db/dec/boundsflux_8c.html#a52d95b79e8bfdeaf3173426e93d4c0bc">rjin</a>;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        rk=k;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#a8159ad46bd8e24ba5363b1e4410bc886">LOOPBOUND2OUT</a> <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#aa96fc40723116a2232f01a9902bfefb8" title="loop over all bounding Primitive variables">PBOUNDLOOP</a>(pliter,pl) <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F2,i,j,k,pl) = <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F2,ri,rj+(j-<a class="code" href="../../da/d3e/definit_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a>),rk,pl); <span class="comment">// for j=N2 -&gt; j=0</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a11c4e99e1493d0c1914ad1ab313ea472">FLUXB</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0b6762cef74e396f50a83864bb53fb6c">FLUXCTSTAG</a>){</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>&gt;1) <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#a8159ad46bd8e24ba5363b1e4410bc886">LOOPBOUND2OUT</a> <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#aa96fc40723116a2232f01a9902bfefb8" title="loop over all bounding Primitive variables">PBOUNDLOOP</a>(pliter,pl) <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F1,i,j,k,pl) = <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F1,ri,rj+(j-<a class="code" href="../../da/d3e/definit_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a>),rk,pl); <span class="comment">// for j=N2 -&gt; j=0</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#ad66109fbdc4d3adc9c3d6ff917038aef">N3</a>&gt;1) <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#a8159ad46bd8e24ba5363b1e4410bc886">LOOPBOUND2OUT</a> <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#aa96fc40723116a2232f01a9902bfefb8" title="loop over all bounding Primitive variables">PBOUNDLOOP</a>(pliter,pl) <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F3,i,j,k,pl) = <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F3,ri,rj+(j-<a class="code" href="../../da/d3e/definit_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a>),rk,pl); <span class="comment">// for j=N2 -&gt; j=0</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    }</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  }</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="comment">// periodic x3</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="keywordflow">if</span> ( (<a class="code" href="../../dd/d46/mpidefs_8h.html#ac3a964fb7b8404428db52c2588d52381">mycpupos</a>[3] == 0)&amp;&amp;(<a class="code" href="../../dd/d46/mpidefs_8h.html#ac3a964fb7b8404428db52c2588d52381">mycpupos</a>[3] == <a class="code" href="../../dd/d46/mpidefs_8h.html#abde3246ae6acb0425ffe363997b5f835">ncpux3</a> - 1) ) {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordflow">if</span>( (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ada1c40d716a8e3567377cd77831aca10">X3DN</a>]==<a class="code" href="../../da/d3e/definit_8h.html#af36821ad7b93ab31dcfaaa25e134fdf0">PERIODIC</a>)&amp;&amp;(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a55fd86081e74615c36554fed69074cd2">X3UP</a>]==<a class="code" href="../../da/d3e/definit_8h.html#af36821ad7b93ab31dcfaaa25e134fdf0">PERIODIC</a>) ){</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <span class="comment">// just copy from one side to another</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <a class="code" href="../../da/db2/global_8loops_8manypoints_8h.html#a022dd0f90806f05c82f55c07ee5c882a">LOOPF_12</a>{</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="comment">// copy from upper side to lower boundary zones</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        ri=<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#ad21ff679aac3fe28202c6d592eafd3e6">i</a>;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        rj=<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        rk=<a class="code" href="../../db/dec/boundsflux_8c.html#ac2060e4059d47a488d84bf9126c19fca">rkout</a>;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#ae53db3572dca14448deca44c69114e8e">LOOPBOUND3IN</a> <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#aa96fc40723116a2232f01a9902bfefb8" title="loop over all bounding Primitive variables">PBOUNDLOOP</a>(pliter,pl) <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F3,i,j,k,pl) = <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F3,ri,rj,rk+1+k,pl); <span class="comment">// for k=0 -&gt; k=N3</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a11c4e99e1493d0c1914ad1ab313ea472">FLUXB</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0b6762cef74e396f50a83864bb53fb6c">FLUXCTSTAG</a>){</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>&gt;1) <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#ae53db3572dca14448deca44c69114e8e">LOOPBOUND3IN</a> <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#aa96fc40723116a2232f01a9902bfefb8" title="loop over all bounding Primitive variables">PBOUNDLOOP</a>(pliter,pl) <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F1,i,j,k,pl) = <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F1,ri,rj,rk+1+k,pl); <span class="comment">// for k=0 -&gt; k=N3</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a>&gt;1) <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#ae53db3572dca14448deca44c69114e8e">LOOPBOUND3IN</a> <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#aa96fc40723116a2232f01a9902bfefb8" title="loop over all bounding Primitive variables">PBOUNDLOOP</a>(pliter,pl) <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F2,i,j,k,pl) = <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F2,ri,rj,rk+1+k,pl); <span class="comment">// for k=0 -&gt; k=N3</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="comment">// copy from lower side to upper boundary zones</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        ri=<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#ad21ff679aac3fe28202c6d592eafd3e6">i</a>;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        rj=<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        rk=<a class="code" href="../../db/dec/boundsflux_8c.html#a004e2bf74d687fea2dae13579ce6dfd5">rkin</a>;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#ac517b3c654e10b465c901e777e7b3411">LOOPBOUND3OUT</a> <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#aa96fc40723116a2232f01a9902bfefb8" title="loop over all bounding Primitive variables">PBOUNDLOOP</a>(pliter,pl) <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F3,i,j,k,pl) = <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F3,ri,rj,rk+(k-<a class="code" href="../../da/d3e/definit_8h.html#ad66109fbdc4d3adc9c3d6ff917038aef">N3</a>),pl); <span class="comment">// for k=N3 -&gt; k=0</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a11c4e99e1493d0c1914ad1ab313ea472">FLUXB</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0b6762cef74e396f50a83864bb53fb6c">FLUXCTSTAG</a>){</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>&gt;1) <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#ac517b3c654e10b465c901e777e7b3411">LOOPBOUND3OUT</a> <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#aa96fc40723116a2232f01a9902bfefb8" title="loop over all bounding Primitive variables">PBOUNDLOOP</a>(pliter,pl) <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F1,i,j,k,pl) = <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F1,ri,rj,rk+(k-<a class="code" href="../../da/d3e/definit_8h.html#ad66109fbdc4d3adc9c3d6ff917038aef">N3</a>),pl); <span class="comment">// for k=N3 -&gt; k=0</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a>&gt;1) <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#ac517b3c654e10b465c901e777e7b3411">LOOPBOUND3OUT</a> <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#aa96fc40723116a2232f01a9902bfefb8" title="loop over all bounding Primitive variables">PBOUNDLOOP</a>(pliter,pl) <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F2,i,j,k,pl) = <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F2,ri,rj,rk+(k-<a class="code" href="../../da/d3e/definit_8h.html#ad66109fbdc4d3adc9c3d6ff917038aef">N3</a>),pl); <span class="comment">// for k=N3 -&gt; k=0</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      }</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    }</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  }</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="comment">// X1 inner OUTFLOW/FIXEDOUTFLOW</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="comment">// first allow extrapolation</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../dd/d46/mpidefs_8h.html#ac3a964fb7b8404428db52c2588d52381">mycpupos</a>[1] == 0) {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordflow">if</span>(((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aab7332b2c03d905515d5350d4fd0850f">X1DN</a>]==<a class="code" href="../../da/d3e/definit_8h.html#a537ea156403ef6d3c02745333ecc50d8">OUTFLOW</a> || <a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aab7332b2c03d905515d5350d4fd0850f">X1DN</a>]==<a class="code" href="../../da/d3e/definit_8h.html#a97bad57e68fc4ea363d00790f96547aa">HORIZONOUTFLOW</a>))||(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aab7332b2c03d905515d5350d4fd0850f">X1DN</a>]==<a class="code" href="../../da/d3e/definit_8h.html#a16777f88a9e111cec44faacfcdac776b">FIXEDOUTFLOW</a>)||(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aab7332b2c03d905515d5350d4fd0850f">X1DN</a>]==<a class="code" href="../../da/d3e/definit_8h.html#a20207ffc8e6f0bdcefb5c42a5b5c3fb8">FIXED</a>)){  <span class="comment">//SASMARK: FIXED is not supposed to be here but need to assign sth to fluxes</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <span class="comment">/* inner r boundary condition: u, just copy */</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#a203e3b910738f16ad48b07082cd62797" title="for X1-dir [Note always uses innormal and outnormal so assumed to use this X1-dir loop first]...">LOOPX1dir</a>{</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        ri=<a class="code" href="../../db/dec/boundsflux_8c.html#ac829241613d010b49da556690e5a5dba">riin</a>;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        rj=<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        rk=k;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#ac69bc344822b49071d0f205f3f51baed">LOOPBOUND1IN</a> <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#aa96fc40723116a2232f01a9902bfefb8" title="loop over all bounding Primitive variables">PBOUNDLOOP</a>(pliter,pl){</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="preprocessor">#if(EXTRAP==0)</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="preprocessor"></span>          <span class="comment">// zeroth orde extrap</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;          <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F1,i,j,k,pl) = <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F1,ri,rj,rk,pl);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="preprocessor"></span>          <span class="comment">// linear extrap</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;          <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F1,i,j,k,pl) = <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F1,ri,rj,rk,pl)+(<a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F1,ri+1,rj,rk,pl)-<a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F1,ri,rj,rk,pl))*(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>)(i-ri);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="preprocessor"></span>          <span class="comment">// if OUTFLOW, then disallow extrapolation if flux is from ghost to active zones</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;          <span class="keywordflow">if</span>((pl==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a3bf4402b9e2ae88e4462c3689f5d22b8">RHO</a>)&amp;&amp;((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aab7332b2c03d905515d5350d4fd0850f">X1DN</a>]==<a class="code" href="../../da/d3e/definit_8h.html#a537ea156403ef6d3c02745333ecc50d8">OUTFLOW</a> || <a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aab7332b2c03d905515d5350d4fd0850f">X1DN</a>]==<a class="code" href="../../da/d3e/definit_8h.html#a97bad57e68fc4ea363d00790f96547aa">HORIZONOUTFLOW</a>))){ <span class="comment">// only for RHO is it obvious what to do without primitives</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F1,i,j,k,pl)&gt;0.0) <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F1,i,j,k,pl)=0.0; <span class="comment">// GODMARK: hope this is enough to shut-down inflow (what about energy flux?)</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;          }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        }<span class="comment">// end pl and face loop</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      }<span class="comment">// end 2 3</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    }<span class="comment">// end if correct bound type</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aab7332b2c03d905515d5350d4fd0850f">X1DN</a>]== <a class="code" href="../../da/d3e/definit_8h.html#a60befa4c36c1f9bf2e9f2d44cf5dcf98">ASYMM</a>) {  <span class="comment">//atch: added this; however unsure if any symmetry exists for fluxes</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#a203e3b910738f16ad48b07082cd62797" title="for X1-dir [Note always uses innormal and outnormal so assumed to use this X1-dir loop first]...">LOOPX1dir</a> {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#ac69bc344822b49071d0f205f3f51baed">LOOPBOUND1IN</a> <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#aa96fc40723116a2232f01a9902bfefb8" title="loop over all bounding Primitive variables">PBOUNDLOOP</a>(pliter,pl)  {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;          <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F1,i,j,k,pl) = - <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F1,-i,j,k,pl);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;          <span class="keywordflow">if</span>( <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aacb3eec923047fe7ddf3eda070c600d9">U1</a> == pl || <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a7b21d6a6a4573b4997b1f04b01cd4efb">B1</a> == pl ) <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F1,i,j,k,pl) *= -1.0;  <span class="comment">//resymm them</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        }</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      }</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    }</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aab7332b2c03d905515d5350d4fd0850f">X1DN</a>]== <a class="code" href="../../da/d3e/definit_8h.html#ac07e3708e7706385b46be6c9a5f2f85e">BCEXTRAP_VEL3</a> || <a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aab7332b2c03d905515d5350d4fd0850f">X1DN</a>] == <a class="code" href="../../da/d3e/definit_8h.html#ac435fd93ff4f94b1ccb070aff400f754">BCEXTRAP</a>) { </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <span class="comment">//extrapolates fluxes with 6th order</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#a203e3b910738f16ad48b07082cd62797" title="for X1-dir [Note always uses innormal and outnormal so assumed to use this X1-dir loop first]...">LOOPX1dir</a>{</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#ac69bc344822b49071d0f205f3f51baed">LOOPBOUND1IN</a> <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#aa96fc40723116a2232f01a9902bfefb8" title="loop over all bounding Primitive variables">PBOUNDLOOP</a>(pliter,pl) {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;          <span class="comment">//     MACP0A1(F1,i,j,k,pl) = interpn( 6, i,  </span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;          <span class="comment">//           0, MACP0A1(F1,0,j,k,pl), </span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;          <span class="comment">//           1, MACP0A1(F1,1,j,k,pl), </span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;          <span class="comment">//           2, MACP0A1(F1,2,j,k,pl), </span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;          <span class="comment">//           3, MACP0A1(F1,3,j,k,pl),</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;          <span class="comment">//           4, MACP0A1(F1,4,j,k,pl), </span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;          <span class="comment">//           5, MACP0A1(F1,5,j,k,pl) );</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        }</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      }</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    }</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  }<span class="comment">// end if mycpupos[1]==0</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="comment">// X1 outer OUTFLOW/FIXEDOUTFLOW</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="comment">// outer r BC:</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../dd/d46/mpidefs_8h.html#ac3a964fb7b8404428db52c2588d52381">mycpupos</a>[1] == <a class="code" href="../../dd/d46/mpidefs_8h.html#a849af7562e98534cd4ea5764f5187bbd">ncpux1</a> - 1) {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordflow">if</span>(((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a6a3603145c91f722d74610fbd6e4f696" title="----------â€”&gt; r | 3 | 1-0 | 2 v theta and likewise for 4,5 (4=out,5=in) directions:">X1UP</a>]==<a class="code" href="../../da/d3e/definit_8h.html#a537ea156403ef6d3c02745333ecc50d8">OUTFLOW</a> || <a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a6a3603145c91f722d74610fbd6e4f696" title="----------â€”&gt; r | 3 | 1-0 | 2 v theta and likewise for 4,5 (4=out,5=in) directions:">X1UP</a>]==<a class="code" href="../../da/d3e/definit_8h.html#a97bad57e68fc4ea363d00790f96547aa">HORIZONOUTFLOW</a>))||(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a6a3603145c91f722d74610fbd6e4f696" title="----------â€”&gt; r | 3 | 1-0 | 2 v theta and likewise for 4,5 (4=out,5=in) directions:">X1UP</a>]==<a class="code" href="../../da/d3e/definit_8h.html#a16777f88a9e111cec44faacfcdac776b">FIXEDOUTFLOW</a>)||(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a6a3603145c91f722d74610fbd6e4f696" title="----------â€”&gt; r | 3 | 1-0 | 2 v theta and likewise for 4,5 (4=out,5=in) directions:">X1UP</a>]==<a class="code" href="../../da/d3e/definit_8h.html#a20207ffc8e6f0bdcefb5c42a5b5c3fb8">FIXED</a>)){  <span class="comment">//SASMARK: FIXED is not supposed to be here but need to assign sth to fluxes</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      <span class="comment">/* outer r BC: outflow */</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#a203e3b910738f16ad48b07082cd62797" title="for X1-dir [Note always uses innormal and outnormal so assumed to use this X1-dir loop first]...">LOOPX1dir</a>{</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        ri=<a class="code" href="../../db/dec/boundsflux_8c.html#a9ff963dee6a8ee6dadda7021050f07d1">riout</a>;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        rj=<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        rk=k;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#ab6234714e5a7d10c0ffcb5836cd3894b">LOOPBOUND1OUT</a> <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#aa96fc40723116a2232f01a9902bfefb8" title="loop over all bounding Primitive variables">PBOUNDLOOP</a>(pliter,pl){</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="preprocessor">#if(EXTRAP==0)</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="preprocessor"></span>          <span class="comment">// zeroth orde extrap</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;          <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F1,i,j,k,pl) = <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F1,ri,rj,rk,pl);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="preprocessor"></span>          <span class="comment">// linear extrap</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;          <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F1,i,j,k,pl) = <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F1,ri,rj,rk,pl)+(<a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F1,ri,rj,rk,pl)-<a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F1,ri-1,rj,rk,pl))*(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>)(i-ri);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="preprocessor"></span>          <span class="comment">// if OUTFLOW, then disallow extrapolation if flux is from ghost to active zones</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;          <span class="keywordflow">if</span>((pl==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a3bf4402b9e2ae88e4462c3689f5d22b8">RHO</a>)&amp;&amp;(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a6a3603145c91f722d74610fbd6e4f696" title="----------â€”&gt; r | 3 | 1-0 | 2 v theta and likewise for 4,5 (4=out,5=in) directions:">X1UP</a>]==<a class="code" href="../../da/d3e/definit_8h.html#a16777f88a9e111cec44faacfcdac776b">FIXEDOUTFLOW</a>)){  <span class="comment">//SASMARK:  changed OUTFLOW to FIXEDOUTFLOW here</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F1,i,j,k,pl)&lt;0.0) <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F1,i,j,k,pl)=0.0;  <span class="comment">//SASMARK:  can be a problem for e.g. Noh problem where there is OUTFLOW BC and the matter actually inflows</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;          }</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        }<span class="comment">// end pl and face loop</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      }<span class="comment">// end 2 3</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    }<span class="comment">// end if correct bound type</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a6a3603145c91f722d74610fbd6e4f696" title="----------â€”&gt; r | 3 | 1-0 | 2 v theta and likewise for 4,5 (4=out,5=in) directions:">X1UP</a>]== <a class="code" href="../../da/d3e/definit_8h.html#a60befa4c36c1f9bf2e9f2d44cf5dcf98">ASYMM</a>) {   <span class="comment">//atch: added this; however unsure if any symmetry exists for fluxes</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#a203e3b910738f16ad48b07082cd62797" title="for X1-dir [Note always uses innormal and outnormal so assumed to use this X1-dir loop first]...">LOOPX1dir</a> {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#ab6234714e5a7d10c0ffcb5836cd3894b">LOOPBOUND1OUT</a> <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#aa96fc40723116a2232f01a9902bfefb8" title="loop over all bounding Primitive variables">PBOUNDLOOP</a>(pliter,pl)  {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;          <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F1,i,j,k,pl) = - <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F1,<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a> + <a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a> - i,j,k,pl);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;          <span class="keywordflow">if</span>( <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aacb3eec923047fe7ddf3eda070c600d9">U1</a> == pl || <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a7b21d6a6a4573b4997b1f04b01cd4efb">B1</a> == pl ) <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F1,i,j,k,pl) *= -1.0;  <span class="comment">//resymm them</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        }</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      }</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    }</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a6a3603145c91f722d74610fbd6e4f696" title="----------â€”&gt; r | 3 | 1-0 | 2 v theta and likewise for 4,5 (4=out,5=in) directions:">X1UP</a>]== <a class="code" href="../../da/d3e/definit_8h.html#ac07e3708e7706385b46be6c9a5f2f85e">BCEXTRAP_VEL3</a> || <a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a6a3603145c91f722d74610fbd6e4f696" title="----------â€”&gt; r | 3 | 1-0 | 2 v theta and likewise for 4,5 (4=out,5=in) directions:">X1UP</a>] == <a class="code" href="../../da/d3e/definit_8h.html#ac435fd93ff4f94b1ccb070aff400f754">BCEXTRAP</a>) { </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      <span class="comment">//extrapolates fluxes with 6th order</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#a203e3b910738f16ad48b07082cd62797" title="for X1-dir [Note always uses innormal and outnormal so assumed to use this X1-dir loop first]...">LOOPX1dir</a>{</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#ab6234714e5a7d10c0ffcb5836cd3894b">LOOPBOUND1OUT</a> <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#aa96fc40723116a2232f01a9902bfefb8" title="loop over all bounding Primitive variables">PBOUNDLOOP</a>(pliter,pl) {</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;          <span class="comment">//     MACP0A1(F1,i,j,k,pl) = interpn( 6, i, </span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;          <span class="comment">//           N1,   MACP0A1(F1,N1,j,k,pl), </span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;          <span class="comment">//           N1-1, MACP0A1(F1,N1-1,j,k,pl), </span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;          <span class="comment">//           N1-2, MACP0A1(F1,N1-2,j,k,pl), </span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;          <span class="comment">//           N1-3, MACP0A1(F1,N1-3,j,k,pl),</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;          <span class="comment">//           N1-4, MACP0A1(F1,N1-4,j,k,pl), </span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;          <span class="comment">//           N1-5, MACP0A1(F1,N1-5,j,k,pl) );</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        }</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      }</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    }</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  }<span class="comment">// end if mycpu is correct</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="comment">// X2 inner POLARAXIS</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../dd/d46/mpidefs_8h.html#ac3a964fb7b8404428db52c2588d52381">mycpupos</a>[2] == 0) {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordflow">if</span>(((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aae79dca9f851fb40349156f6bca1f8ca">X2DN</a>]==<a class="code" href="../../da/d3e/definit_8h.html#a537ea156403ef6d3c02745333ecc50d8">OUTFLOW</a> || <a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aae79dca9f851fb40349156f6bca1f8ca">X2DN</a>]==<a class="code" href="../../da/d3e/definit_8h.html#a97bad57e68fc4ea363d00790f96547aa">HORIZONOUTFLOW</a>))||(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aae79dca9f851fb40349156f6bca1f8ca">X2DN</a>]==<a class="code" href="../../da/d3e/definit_8h.html#a16777f88a9e111cec44faacfcdac776b">FIXEDOUTFLOW</a>)||(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aae79dca9f851fb40349156f6bca1f8ca">X2DN</a>]==<a class="code" href="../../da/d3e/definit_8h.html#a20207ffc8e6f0bdcefb5c42a5b5c3fb8">FIXED</a>)){  <span class="comment">//SASMARK: FIXED is not supposed to be here but need to assign sth to fluxes</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      <span class="comment">/* inner 2 BC: outflow */</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#a8d8b8bb42cbf5b3cbea7d0cfdff08c30" title="for X2-dir [Note innormal and outnormal for 3rd direction and full inbound and outbound for 1st direc...">LOOPX2dir</a>{</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        ri=<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#ad21ff679aac3fe28202c6d592eafd3e6">i</a>; <span class="comment">// correct for flux</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        rj=<a class="code" href="../../db/dec/boundsflux_8c.html#a52d95b79e8bfdeaf3173426e93d4c0bc">rjin</a>;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        rk=k;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#a024d4db998ded5c8ed6d1ceabda730ea">LOOPBOUND2IN</a> <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#aa96fc40723116a2232f01a9902bfefb8" title="loop over all bounding Primitive variables">PBOUNDLOOP</a>(pliter,pl){</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="preprocessor">#if(EXTRAP==0)</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="preprocessor"></span>          <span class="comment">// zeroth orde extrap</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;          <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F2,i,j,k,pl) = <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F2,ri,rj,rk,pl);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="preprocessor"></span>          <span class="comment">// linear extrap</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;          <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F2,i,j,k,pl) = <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F2,ri,rj,rk,pl)+(<a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F2,ri,rj,rk,pl)-<a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F2,ri,rj-l,rk,pl))*(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>)(j-rj);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="preprocessor"></span>          <span class="comment">// if OUTFLOW, then disallow extrapolation if flux is from ghost to active zones</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;          <span class="keywordflow">if</span>((pl==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a3bf4402b9e2ae88e4462c3689f5d22b8">RHO</a>)&amp;&amp;(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aae79dca9f851fb40349156f6bca1f8ca">X2DN</a>]==<a class="code" href="../../da/d3e/definit_8h.html#a16777f88a9e111cec44faacfcdac776b">FIXEDOUTFLOW</a>)){  <span class="comment">//SASMARK:  changed OUTFLOW to FIXEDOUTFLOW here</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F2,i,j,k,pl)&lt;0.0) <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F2,i,j,k,pl)=0.0;  <span class="comment">//SASMARK:  can be a problem for e.g. Noh problem where there is OUTFLOW BC and the matter actually inflows</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;          }</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        }<span class="comment">// end pl and face loop</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      }<span class="comment">// end 2 3</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    }<span class="comment">// end if correct bound type</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aae79dca9f851fb40349156f6bca1f8ca">X2DN</a>]==<a class="code" href="../../da/d3e/definit_8h.html#ae81381343e0c525e13866d873d9deb52">POLARAXIS</a>)||(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aae79dca9f851fb40349156f6bca1f8ca">X2DN</a>]==<a class="code" href="../../da/d3e/definit_8h.html#a4ecff02974fdb5f33c5190450ff75615">SYMM</a>)||(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aae79dca9f851fb40349156f6bca1f8ca">X2DN</a>]==<a class="code" href="../../da/d3e/definit_8h.html#a60befa4c36c1f9bf2e9f2d44cf5dcf98">ASYMM</a>) ){</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#a8d8b8bb42cbf5b3cbea7d0cfdff08c30" title="for X2-dir [Note innormal and outnormal for 3rd direction and full inbound and outbound for 1st direc...">LOOPX2dir</a>{</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        ri=<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#ad21ff679aac3fe28202c6d592eafd3e6">i</a>;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        rj=<a class="code" href="../../db/dec/boundsflux_8c.html#a52d95b79e8bfdeaf3173426e93d4c0bc">rjin</a>;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        rk=k;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#a024d4db998ded5c8ed6d1ceabda730ea">LOOPBOUND2IN</a> <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#aa96fc40723116a2232f01a9902bfefb8" title="loop over all bounding Primitive variables">PBOUNDLOOP</a>(pliter,pl)  <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F2,i,j,k,pl) = <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F2,ri,rj+(rj-j),rk,pl); <span class="comment">// self-assigns for j=0</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      }</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    }</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="comment">// F2 of U2/B2 is symmetric, so no need to antisymmetrize</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="comment">// F2 antisymmetric with respect to all other quantities</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keywordflow">if</span>((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aae79dca9f851fb40349156f6bca1f8ca">X2DN</a>]==<a class="code" href="../../da/d3e/definit_8h.html#ae81381343e0c525e13866d873d9deb52">POLARAXIS</a>)||(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aae79dca9f851fb40349156f6bca1f8ca">X2DN</a>]==<a class="code" href="../../da/d3e/definit_8h.html#a60befa4c36c1f9bf2e9f2d44cf5dcf98">ASYMM</a>) ){</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      <span class="comment">/* make sure b and u are antisymmetric at the poles   (preserves u^t rho and u) */</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#a8d8b8bb42cbf5b3cbea7d0cfdff08c30" title="for X2-dir [Note innormal and outnormal for 3rd direction and full inbound and outbound for 1st direc...">LOOPX2dir</a>{</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#a024d4db998ded5c8ed6d1ceabda730ea">LOOPBOUND2IN</a> {</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;          <span class="comment">//if(POSDEFMETRIC==0){  //SASMARK need to asymmetrize the fluxes; don&#39;t understand why should not asymm. the fluxes if POSDEFMETRIC is 0</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;          <span class="comment">// // u^t must be symmetric across pole, which is functions of u2 and u3 as well as their squares and othe products.  u2 in KS happens to be independent of sign, but in general is could be for some other metric.</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;          <span class="comment">// // for now, assume KS-like metric where u2 is antisymmetric and u^t dep only on u2^2, not u2</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;          <span class="comment">//}</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;          <span class="comment">//else{</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;          <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#af1c67086436007e897bccc458390886f" title="PLOOP controls looping over conserved or primitive -type quantities except during interpolation or ot...">PLOOP</a>(pliter,pl) <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F2,i,j,k,pl)*=-1; <span class="comment">// anti-sym all</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;          <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F2,i,j,k,<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ae907e773ef038f3fc0c2ad5de0cb0f07">U2</a>)*=-1; <span class="comment">// re-sym U2</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;          <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F2,i,j,k,<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a6945d50f798e1fde624d70c74457090e">B2</a>)*=-1; <span class="comment">// re-sym B2</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;          <span class="comment">//}</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        }</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      }<span class="comment">// end loop 13</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    } <span class="comment">// end if POLARXIS or ASYMM</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  }<span class="comment">// end if mycpupos[2]==0</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  <span class="comment">// X2 outer POLARAXIS</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../dd/d46/mpidefs_8h.html#ac3a964fb7b8404428db52c2588d52381">mycpupos</a>[2] == <a class="code" href="../../dd/d46/mpidefs_8h.html#a2b69fb4a20e91ae01ef8452216afb784">ncpux2</a>-1) {</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordflow">if</span>(((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aa9363649053ac2e906715b3259a14954">X2UP</a>]==<a class="code" href="../../da/d3e/definit_8h.html#a537ea156403ef6d3c02745333ecc50d8">OUTFLOW</a> || <a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aa9363649053ac2e906715b3259a14954">X2UP</a>]==<a class="code" href="../../da/d3e/definit_8h.html#a97bad57e68fc4ea363d00790f96547aa">HORIZONOUTFLOW</a>))||(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aa9363649053ac2e906715b3259a14954">X2UP</a>]==<a class="code" href="../../da/d3e/definit_8h.html#a16777f88a9e111cec44faacfcdac776b">FIXEDOUTFLOW</a>)||(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aa9363649053ac2e906715b3259a14954">X2UP</a>]==<a class="code" href="../../da/d3e/definit_8h.html#a20207ffc8e6f0bdcefb5c42a5b5c3fb8">FIXED</a>)){  <span class="comment">//SASMARK: FIXED is not supposed to be here but need to assign sth to fluxes</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      <span class="comment">/* outer 2 BC: outflow */</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#a8d8b8bb42cbf5b3cbea7d0cfdff08c30" title="for X2-dir [Note innormal and outnormal for 3rd direction and full inbound and outbound for 1st direc...">LOOPX2dir</a>{</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        ri=<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#ad21ff679aac3fe28202c6d592eafd3e6">i</a>; <span class="comment">// correct for flux</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        rj=<a class="code" href="../../db/dec/boundsflux_8c.html#a62e6126121a80cd84f5f24116e0ac5e3">rjout</a>;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        rk=k;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#a8159ad46bd8e24ba5363b1e4410bc886">LOOPBOUND2OUT</a> <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#aa96fc40723116a2232f01a9902bfefb8" title="loop over all bounding Primitive variables">PBOUNDLOOP</a>(pliter,pl){</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="preprocessor">#if(EXTRAP==0)</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="preprocessor"></span>          <span class="comment">// zeroth orde extrap</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;          <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F2,i,j,k,pl) = <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F2,ri,rj,rk,pl);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="preprocessor"></span>          <span class="comment">// linear extrap</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;          <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F2,i,j,k,pl) = <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F2,ri,rj,rk,pl)+(<a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F2,ri,rj,rk,pl)-<a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F2,ri,rj-l,rk,pl))*(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>)(j-rj);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="preprocessor"></span>          <span class="comment">// if OUTFLOW, then disallow extrapolation if flux is from ghost to active zones</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;          <span class="keywordflow">if</span>((pl==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a3bf4402b9e2ae88e4462c3689f5d22b8">RHO</a>)&amp;&amp;(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aa9363649053ac2e906715b3259a14954">X2UP</a>]==<a class="code" href="../../da/d3e/definit_8h.html#a16777f88a9e111cec44faacfcdac776b">FIXEDOUTFLOW</a>)){  <span class="comment">//SASMARK:  changed OUTFLOW to FIXEDOUTFLOW here</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F2,i,j,k,pl)&gt;0.0) <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F2,i,j,k,pl)=0.0;  <span class="comment">//SASMARK:  can be a problem for e.g. Noh problem where there is OUTFLOW BC and the matter actually inflows</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;          }</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        }<span class="comment">// end pl and face loop</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      }<span class="comment">// end 2 3</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    }<span class="comment">// end if correct bound type</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aa9363649053ac2e906715b3259a14954">X2UP</a>]==<a class="code" href="../../da/d3e/definit_8h.html#ae81381343e0c525e13866d873d9deb52">POLARAXIS</a>)||(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aa9363649053ac2e906715b3259a14954">X2UP</a>]==<a class="code" href="../../da/d3e/definit_8h.html#a4ecff02974fdb5f33c5190450ff75615">SYMM</a>)||(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aa9363649053ac2e906715b3259a14954">X2UP</a>]==<a class="code" href="../../da/d3e/definit_8h.html#a60befa4c36c1f9bf2e9f2d44cf5dcf98">ASYMM</a>) ){</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#a8d8b8bb42cbf5b3cbea7d0cfdff08c30" title="for X2-dir [Note innormal and outnormal for 3rd direction and full inbound and outbound for 1st direc...">LOOPX2dir</a>{</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        ri=<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#ad21ff679aac3fe28202c6d592eafd3e6">i</a>;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        rj=<a class="code" href="../../db/dec/boundsflux_8c.html#a62e6126121a80cd84f5f24116e0ac5e3">rjout</a>;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        rk=k;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#a8159ad46bd8e24ba5363b1e4410bc886">LOOPBOUND2OUT</a> <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#aa96fc40723116a2232f01a9902bfefb8" title="loop over all bounding Primitive variables">PBOUNDLOOP</a>(pliter,pl)  <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F2,i,j,k,pl) = <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F2,ri,rj+(rj-j+2),rk,pl); <span class="comment">// self-assigns for j=N</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      }</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    }</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordflow">if</span>((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aa9363649053ac2e906715b3259a14954">X2UP</a>]==<a class="code" href="../../da/d3e/definit_8h.html#ae81381343e0c525e13866d873d9deb52">POLARAXIS</a>)||(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aa9363649053ac2e906715b3259a14954">X2UP</a>]==<a class="code" href="../../da/d3e/definit_8h.html#a60befa4c36c1f9bf2e9f2d44cf5dcf98">ASYMM</a>) ){</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      <span class="comment">/* make sure b and u are antisymmetric at the poles   (preserves u^t rho and u) */</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#a8d8b8bb42cbf5b3cbea7d0cfdff08c30" title="for X2-dir [Note innormal and outnormal for 3rd direction and full inbound and outbound for 1st direc...">LOOPX2dir</a>{</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#a8159ad46bd8e24ba5363b1e4410bc886">LOOPBOUND2OUT</a> {</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;          <span class="comment">//if(POSDEFMETRIC==0){  //SASMARK need to asymmetrize the fluxes; don&#39;t understand why should not asymm. the fluxes if POSDEFMETRIC is 0</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;          <span class="comment">// // u^t must be symmetric across pole, which is functions of u2 and u3 as well as their squares and othe products.  u2 in KS happens to be independent of sign, but in general is could be for some other metric.</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;          <span class="comment">// // for now, assume KS-like metric where u2 is antisymmetric and u^t dep only on u2^2, not u2</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;          <span class="comment">//}</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;          <span class="comment">//else{</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;          <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#af1c67086436007e897bccc458390886f" title="PLOOP controls looping over conserved or primitive -type quantities except during interpolation or ot...">PLOOP</a>(pliter,pl) <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F2,i,j,k,pl)*=-1; <span class="comment">// anti-sym all</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;          <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F2,i,j,k,<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ae907e773ef038f3fc0c2ad5de0cb0f07">U2</a>)*=-1; <span class="comment">// re-sym U2</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;          <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F2,i,j,k,<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a6945d50f798e1fde624d70c74457090e">B2</a>)*=-1; <span class="comment">// re-sym B2</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;          <span class="comment">//}</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        }</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      }<span class="comment">// end loop 13</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    } <span class="comment">// end if POLARXIS or ASYMM</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  }<span class="comment">// end if mycpupos[2]==ncpux2-1</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <span class="comment">//x3 inner</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="../../dd/d46/mpidefs_8h.html#ac3a964fb7b8404428db52c2588d52381">mycpupos</a>[3] == 0 ) {</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordflow">if</span>(((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ada1c40d716a8e3567377cd77831aca10">X3DN</a>]==<a class="code" href="../../da/d3e/definit_8h.html#a537ea156403ef6d3c02745333ecc50d8">OUTFLOW</a> || <a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ada1c40d716a8e3567377cd77831aca10">X3DN</a>]==<a class="code" href="../../da/d3e/definit_8h.html#a97bad57e68fc4ea363d00790f96547aa">HORIZONOUTFLOW</a>))||(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ada1c40d716a8e3567377cd77831aca10">X3DN</a>]==<a class="code" href="../../da/d3e/definit_8h.html#a16777f88a9e111cec44faacfcdac776b">FIXEDOUTFLOW</a>)||(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ada1c40d716a8e3567377cd77831aca10">X3DN</a>]==<a class="code" href="../../da/d3e/definit_8h.html#a20207ffc8e6f0bdcefb5c42a5b5c3fb8">FIXED</a>)){  <span class="comment">//SASMARK: FIXED is not supposed to be here but need to assign sth to fluxes</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;      <span class="comment">/* inner 3 BC: outflow */</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#af0f29fe7dfd150432258991c71084530" title="for X3-dir [ Note only use of inbound and outbound, so assumes 1st and 2nd directions came first]...">LOOPX3dir</a>{</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        ri=<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#ad21ff679aac3fe28202c6d592eafd3e6">i</a>; <span class="comment">// correct for flux</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        rj=<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        rk=<a class="code" href="../../db/dec/boundsflux_8c.html#a004e2bf74d687fea2dae13579ce6dfd5">rkin</a>;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#ae53db3572dca14448deca44c69114e8e">LOOPBOUND3IN</a> <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#aa96fc40723116a2232f01a9902bfefb8" title="loop over all bounding Primitive variables">PBOUNDLOOP</a>(pliter,pl){</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="preprocessor">#if(EXTRAP==0)</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="preprocessor"></span>          <span class="comment">// zeroth orde extrap</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;          <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F3,i,j,k,pl) = <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F3,ri,rj,rk,pl);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="preprocessor"></span>          <span class="comment">// linear extrap</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;          <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F3,i,j,k,pl) = <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F3,ri,rj,rk,pl)+(<a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F3,ri,rj,rk,pl)-<a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F3,ri,rj,rk-l,pl))*(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>)(k-rk);</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="preprocessor"></span>          <span class="comment">// if OUTFLOW, then disallow extrapolation if flux is from ghost to active zones</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;          <span class="keywordflow">if</span>((pl==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a3bf4402b9e2ae88e4462c3689f5d22b8">RHO</a>)&amp;&amp;(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ada1c40d716a8e3567377cd77831aca10">X3DN</a>]==<a class="code" href="../../da/d3e/definit_8h.html#a16777f88a9e111cec44faacfcdac776b">FIXEDOUTFLOW</a>)){  <span class="comment">//SASMARK:  changed OUTFLOW to FIXEDOUTFLOW here</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F3,i,j,k,pl)&lt;0.0) <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F3,i,j,k,pl)=0.0;  <span class="comment">//SASMARK:  can be a problem for e.g. Noh problem where there is OUTFLOW BC and the matter actually inflows</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;          }</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        }<span class="comment">// end pl and face loop</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      }<span class="comment">// end 2 3</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    }<span class="comment">// end if correct bound type</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  }</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="comment">//x3 outer</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="../../dd/d46/mpidefs_8h.html#ac3a964fb7b8404428db52c2588d52381">mycpupos</a>[3] == <a class="code" href="../../dd/d46/mpidefs_8h.html#abde3246ae6acb0425ffe363997b5f835">ncpux3</a> - 1 ) {</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="keywordflow">if</span>(((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a55fd86081e74615c36554fed69074cd2">X3UP</a>]==<a class="code" href="../../da/d3e/definit_8h.html#a537ea156403ef6d3c02745333ecc50d8">OUTFLOW</a> || <a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a55fd86081e74615c36554fed69074cd2">X3UP</a>]==<a class="code" href="../../da/d3e/definit_8h.html#a97bad57e68fc4ea363d00790f96547aa">HORIZONOUTFLOW</a>))||(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a55fd86081e74615c36554fed69074cd2">X3UP</a>]==<a class="code" href="../../da/d3e/definit_8h.html#a16777f88a9e111cec44faacfcdac776b">FIXEDOUTFLOW</a>)||(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a55fd86081e74615c36554fed69074cd2">X3UP</a>]==<a class="code" href="../../da/d3e/definit_8h.html#a20207ffc8e6f0bdcefb5c42a5b5c3fb8">FIXED</a>)){  <span class="comment">//SASMARK: FIXED is not supposed to be here but need to assign sth to fluxes</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;      <span class="comment">/* outer 3 BC: outflow */</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#af0f29fe7dfd150432258991c71084530" title="for X3-dir [ Note only use of inbound and outbound, so assumes 1st and 2nd directions came first]...">LOOPX3dir</a>{</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        ri=<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#ad21ff679aac3fe28202c6d592eafd3e6">i</a>; <span class="comment">// correct for flux</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        rj=<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        rk=<a class="code" href="../../db/dec/boundsflux_8c.html#ac2060e4059d47a488d84bf9126c19fca">rkout</a>;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        <a class="code" href="../../d9/da3/global_8loops_8boundaries_8h.html#ac517b3c654e10b465c901e777e7b3411">LOOPBOUND3OUT</a> <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#aa96fc40723116a2232f01a9902bfefb8" title="loop over all bounding Primitive variables">PBOUNDLOOP</a>(pliter,pl){</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="preprocessor">#if(EXTRAP==0)</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="preprocessor"></span>          <span class="comment">// zeroth orde extrap</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;          <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F3,i,j,k,pl) = <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F3,ri,rj,rk,pl);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="preprocessor"></span>          <span class="comment">// linear extrap</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;          <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F3,i,j,k,pl) = <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F3,ri,rj,rk,pl)+(<a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F3,ri,rj,rk,pl)-<a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F3,ri,rj,rk-l,pl))*(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>)(k-rk);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="preprocessor"></span>          <span class="comment">// if OUTFLOW, then disallow extrapolation if flux is from ghost to active zones</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;          <span class="keywordflow">if</span>((pl==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a3bf4402b9e2ae88e4462c3689f5d22b8">RHO</a>)&amp;&amp;(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a55fd86081e74615c36554fed69074cd2">X3UP</a>]==<a class="code" href="../../da/d3e/definit_8h.html#a16777f88a9e111cec44faacfcdac776b">FIXEDOUTFLOW</a>)){  <span class="comment">//SASMARK:  changed OUTFLOW to FIXEDOUTFLOW here</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F3,i,j,k,pl)&gt;0.0) <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(F3,i,j,k,pl)=0.0;  <span class="comment">//SASMARK:  can be a problem for e.g. Noh problem where there is OUTFLOW BC and the matter actually inflows</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;          }</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        }<span class="comment">// end pl and face loop</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      }<span class="comment">// end 2 3</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    }<span class="comment">// end if correct bound type</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  }</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  <span class="keywordflow">return</span> (0);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri May 20 2016 15:52:32 for HARM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.3.1
</small></address>
</body>
</html>
