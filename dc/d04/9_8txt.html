<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>HARM: docs/pnmhd/9.txt File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">HARM
   </div>
   <div id="projectbrief">harm and utilities</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">docs/pnmhd/9.txt File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="fragment"><div class="line">Quick Start Guide</div>
<div class="line">Version 1 Created by Jonathan <a class="code" href="../../d9/d53/metric_8c.html#a52037c938e3c1b126c6277da5ca689d0">M</a>. on 30 May 2009.</div>
<div class="line">——-</div>
<div class="line"></div>
<div class="line">You can find the code at:</div>
<div class="line"></div>
<div class="line">http:<span class="comment">//www.stanford.edu/~jmckinne/pnmhd/pnmhd3d_clean.tgz</span></div>
<div class="line"></div>
<div class="line">Looking back at the code it’s certainly lacks modularity and has tons of extra pieces due to various projects, but we’ll see <span class="keywordflow">if</span> that becomes a problem.</div>
<div class="line"></div>
<div class="line">At least at first, I suggest <span class="keyword">using</span> supermongo to work with the code’s data. The macros to use are:</div>
<div class="line"></div>
<div class="line">http:<span class="comment">//www.stanford.edu/~jmckinne/pnmhd/smmacros_twod.tgz</span></div>
<div class="line"></div>
<div class="line">Undo <span class="keyword">this</span> in you home directory and it’ll create a “.sm” file and a “sm” directory. Modify the .sm to be correct. Some directories are hard coded into the SM macros, so look <span class="keywordflow">for</span> “/home/maguilar” and change it to wherever the “sm” directory is located. If your SM doesn’t seem to work to load some files, then probably it’s too limited. My SM is modified to <span class="keyword">remove</span> many restrictions (e.g. on number of columns), and you can then <span class="keywordflow">try</span> that <span class="keywordflow">if</span> yours doesn’t work:</div>
<div class="line"></div>
<div class="line">http:<span class="comment">//www.stanford.edu/~jmckinne/pnmhd/sm_32.tgz</span></div>
<div class="line"></div>
<div class="line">I suggest just trying to go into the sm2_4_1 directory and <span class="keywordflow">do</span>:</div>
<div class="line"></div>
<div class="line">make clean ; make</div>
<div class="line"></div>
<div class="line">You might have to change the makefile and where it points to the X11 directory.</div>
<div class="line"></div>
<div class="line">Then copy the src/sm file to where “jsm” is looking <span class="keywordflow">for</span> it:</div>
<div class="line"></div>
<div class="line">http:<span class="comment">//www.stanford.edu/~jmckinne/pnmhd/jsm</span></div>
<div class="line"></div>
<div class="line">This is just a script to run sm in a reasonable way with my macros. Modify it as necessary. In the end you’ll be running “jsm” to look at the data the code produces.</div>
<div class="line"></div>
<div class="line">—-</div>
<div class="line"></div>
<div class="line">Here are some instructions on how to compile, run, and view the data <span class="keyword">using</span> SM:</div>
<div class="line"></div>
<div class="line">1) Look at the makefile. Right now it’s setup <span class="keywordflow">for</span> GCC since I assume you at least have that. You can use ICC <span class="keywordflow">if</span> you have Intel’s compiler.</div>
<div class="line"></div>
<div class="line">2) put the code tarball in some folder and <span class="keywordflow">do</span>:</div>
<div class="line"></div>
<div class="line">tar xvzf pnmhd3d_clean.tgz</div>
<div class="line"></div>
<div class="line"><a class="code" href="../../d9/d54/other6_8txt.html#abea40877aa2ce569e5f9e3a264872b54">cd</a> pnmhd3d_clean</div>
<div class="line"></div>
<div class="line">This gives the code, run-time directory structure, and provides some random little files and other scripts that are useful. I only cleaned things <a class="code" href="../../dc/dd2/newcodediff_8txt.html#a1df03026db3aa663afda0c9eed67408e">up</a> a little bit. I suggest leaving things in place since many things are <span class="keywordflow">for</span> visualizations you might want later.</div>
<div class="line"></div>
<div class="line">3) Compile the code:</div>
<div class="line"></div>
<div class="line">make</div>
<div class="line"></div>
<div class="line">4) Change to run directory</div>
<div class="line"></div>
<div class="line"><a class="code" href="../../d9/d54/other6_8txt.html#abea40877aa2ce569e5f9e3a264872b54">cd</a> bin</div>
<div class="line"></div>
<div class="line">everything below assumes one is in this directory</div>
<div class="line">5) clean things (can obviously make everything simpler…overkill for any scenario)</div>
<div class="line"></div>
<div class="line">ls | egrep ’\.dat\ | xargs rm</div>
<div class="line"></div>
<div class="line">ls | egrep ’0_’ | xargs rm</div>
<div class="line"></div>
<div class="line">sh rmdatmcpus.sh</div>
<div class="line"></div>
<div class="line"><a class="code" href="../../d9/d54/other6_8txt.html#abea40877aa2ce569e5f9e3a264872b54">cd</a> i</div>
<div class="line"></div>
<div class="line">sh rmimages.sh</div>
<div class="line"></div>
<div class="line">sh rmallgz.sh</div>
<div class="line"></div>
<div class="line">sh rmmcpuall.sh</div>
<div class="line"></div>
<div class="line">sh rmmcpugzip.sh</div>
<div class="line"></div>
<div class="line">sh rmmcpus.sh</div>
<div class="line"></div>
<div class="line">run code</div>
<div class="line">./mhd3d</div>
<div class="line"></div>
<div class="line">And let go.</div>
<div class="line">6) run the script:</div>
<div class="line"></div>
<div class="line">jsm</div>
<div class="line"></div>
<div class="line">7) in SM:</div>
<div class="line"></div>
<div class="line">gopnmhd</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#This loads all the macros one needs for reading the files. The macro file that has alot of reading stuff is in ~/sm/rdreads.m . I went crazy with version numbers and file types and such, so a single macro reads in all files and accounts for the column #numbers and such by the file type and version.</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#The interesting files are:</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">A) 0_gparam.par : parameter file. This should always be done first before anything <span class="keywordflow">else</span>. Rest of files don’t depend on each other.</div>
<div class="line"></div>
<div class="line">#2D or 3D:</div>
<div class="line"></div>
<div class="line">rdbasic 0 0 -1</div>
<div class="line"></div>
<div class="line">#<span class="keywordflow">if</span> doing 3D Cartesian also <span class="keywordflow">do</span>:</div>
<div class="line"></div>
<div class="line">jre cartonly.m</div>
<div class="line"></div>
<div class="line">cartgrid</div>
<div class="line"></div>
<div class="line">#rdbasic loads everything except grid, which isn’t written <span class="keywordflow">for</span> 3D Cartesian, so ignore the errors related to 0_gridact1.par and 0_gridact2.par. Normally those would be the centered and staggered grid positions, metric values, etc. The cartonly.m macro #file has the “cartgrid” macro that makes the grid <span class="keywordflow">for</span> the uniform Cartesian grid.</div>
<div class="line"></div>
<div class="line">B) 0_loss.dat : integrated surface fluxes, <span class="keywordflow">for</span> example to plot the surface flux through the outer-1 surface:</div>
<div class="line"></div>
<div class="line">rd 0_loss.dat</div>
<div class="line"></div>
<div class="line">pl 0 t min1</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#See rdreads.m , macro named rdreads3 under LOSSTYPE</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><a class="code" href="../../d8/d5b/defs_8general_8h.html#a0050aa7bf7fc92a690eec015acb18800">C</a>) 0_ener.dat : volume integrals</div>
<div class="line"></div>
<div class="line">rd 0_ener.dat</div>
<div class="line"></div>
<div class="line">pl 0 t m</div>
<div class="line"></div>
<div class="line">#See rdreads.m, macro named rdreads2 under <a class="code" href="../../d8/d5b/defs_8general_8h.html#a5d70376e052c596ae4e1e156d8026329">ENERTYPE</a></div>
<div class="line"></div>
<div class="line">D) 0_mode.dat : mode structure <span class="keywordflow">for</span> 3D model. $\phi$ Fourier modes? myplots.m uses it. For example, the 5th order density mode is:</div>
<div class="line"></div>
<div class="line">rd 0_mode.m</div>
<div class="line"></div>
<div class="line">pl 0 t rm5</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#Presently NOT dumped, but can.</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><a class="code" href="../../d8/d60/init_8c.html#a07484107e6d9fdf38b53edf631d6511d">E</a>) 0_analdata.dat : output during run of the <a class="code" href="../../d8/df4/global_8funcdeclare_8h.html#ac4110398e386c9888d9565630357dbbe" title="General-Primary init() routine Uses globals inside init() because sets memory and sets physics...">init</a> code in analsol.c</div>
<div class="line"></div>
<div class="line">!less 0_analdata.dat</div>
<div class="line"></div>
<div class="line">F) 0_logdt.out : logs time and <a class="code" href="../../d8/d5b/defs_8general_8h.html#a56db625f31229c5e8b208ff27d464931">dt</a> calculation related stuff during run. So one knows what limits Courant factor. Seems broken.</div>
<div class="line"></div>
<div class="line">rd 0_logdt.out</div>
<div class="line"></div>
<div class="line">pl 0 t <a class="code" href="../../d8/d5b/defs_8general_8h.html#a56db625f31229c5e8b208ff27d464931">dt</a></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#See rdreads.m, macro named rdreads32 under LOGDTTYPE</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><a class="code" href="../../d8/d5b/defs_8general_8h.html#a1b697356441aab8d55c753517a360792">G</a>) 0_logfl.out : Reports when floor activated and where in code that switched was activated and how many times.</div>
<div class="line"></div>
<div class="line">!less 0_logfl.out</div>
<div class="line"></div>
<div class="line"><a class="code" href="../../d8/d5b/defs_8general_8h.html#a333bf60038d1801707ebf78ebdebdaea">H</a>) 0_logfull.out : Report on time step progress <span class="keywordflow">for</span> all CPUs</div>
<div class="line"></div>
<div class="line">!less 0_logfull.out</div>
<div class="line"></div>
<div class="line">I) 0_log.out : Report on time step progress <span class="keywordflow">for each</span> CPU (would have CPU “myid” attached <span class="keywordflow">if</span> in MPI)</div>
<div class="line"></div>
<div class="line">!less 0_log.out</div>
<div class="line"></div>
<div class="line">J) 0_logperf.out : performance of code</div>
<div class="line"></div>
<div class="line">rd 0_logperf.out</div>
<div class="line"></div>
<div class="line">pl 0 t zc # shows zone cycles per second. Should be around 250k <span class="keywordflow">for</span> 1 CPU in 3D.</div>
<div class="line"></div>
<div class="line">#See rdreads.m, macro named rdreads32 under <a class="code" href="../../d8/d5b/defs_8general_8h.html#a33e1b49955b8b1928e89a8d40343ce53">PERFTYPE</a></div>
<div class="line"></div>
<div class="line"><a class="code" href="../../d8/d5b/defs_8general_8h.html#a33aba725064a95e4c33b25ccdc2504a9">K</a>) 0_logstep.out : various stepping counters</div>
<div class="line"></div>
<div class="line">rd 0_logstep.out</div>
<div class="line"></div>
<div class="line">pl 0 t n</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#See rdreads.m, macro named rdreads32 under STEPTYPE</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">L) 0_numadumps.dat : number of analytic <a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89abceb1f5e607b7074378156fa8f94b">dumps</a>, <span class="keyword">this</span> is loaded during rdbasic, as is rest of counters <span class="keywordflow">for</span> dumps</div>
<div class="line"></div>
<div class="line">!cat 0_numadumps.dat</div>
<div class="line"></div>
<div class="line"><a class="code" href="../../d9/d53/metric_8c.html#a52037c938e3c1b126c6277da5ca689d0">M</a>) 0_numdumps.dat : number of dump files</div>
<div class="line"></div>
<div class="line">!cat 0_numdumps.dat</div>
<div class="line"></div>
<div class="line">N) 0_numfloordumps.dat : number of “floor” dump files, should be relevant <span class="keywordflow">for</span> us</div>
<div class="line"></div>
<div class="line">!cat 0_numfloordumps.dat</div>
<div class="line"></div>
<div class="line">O) 0_numnpdumps.dat : other primitives, other calculations besides primitive quantities.</div>
<div class="line"></div>
<div class="line">!cat 0_numnpdumps.dat</div>
<div class="line"></div>
<div class="line">P) dump????.dat : actual 3D dump files, presently in text so can read in SM. Default <span class="keywordflow">for</span> 1 CPU. Default <span class="keywordflow">for</span> &gt;1 CPU is binary.</div>
<div class="line"></div>
<div class="line">rd dump0000.dat</div>
<div class="line"></div>
<div class="line">define PLANE 3 # chooses plane to be <span class="keywordflow">for</span> z=constant.</div>
<div class="line"></div>
<div class="line">define WHICHLEV 0 # chooses index <span class="keywordflow">for</span> k = 0 (only an issue <span class="keywordflow">if</span> doing 3D)</div>
<div class="line"></div>
<div class="line">plc 0 r # density contour plot.</div>
<div class="line"></div>
<div class="line">#See rdreads.m macro rdreads1 under <a class="code" href="../../d8/d5b/defs_8general_8h.html#ad709fc2074ec41362007ae30afe951bd">DTYPE</a></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#For uniform function it returns an error about “lev”, just ignore. One can still see the value by doing:</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">image cursor</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#and moving over the plot and also clicking on the plot.</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><a class="code" href="../../d8/d5b/defs_8general_8h.html#a705c2bce1b829cc90b0d71ac62b0e991">Q</a>) For 3D, one can also view “animation” of slices</div>
<div class="line"></div>
<div class="line">contour slices (ctrl-<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0050aa7bf7fc92a690eec015acb18800">C</a> when want the loop to stop)</div>
<div class="line">rd dump0000.dat</div>
<div class="line"></div>
<div class="line">animzplc 0 r</div>
<div class="line"></div>
<div class="line">or directly <span class="keywordflow">do</span></div>
<div class="line">animzplc dump0001.dat r</div>
<div class="line"></div>
<div class="line">where iitemp shows the slice #</div>
<div class="line">or surface slices</div>
<div class="line">animzpls 0 r</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">for</span> the test problem I created (the bomb), an interesting plot is:</div>
<div class="line">rd dump0001.dat</div>
<div class="line"></div>
<div class="line">animzpls 0 r</div>
<div class="line"></div>
<div class="line"><a class="code" href="../../d8/d5b/defs_8general_8h.html#abf002e87ba3ed4d3c9dcc98216e6d9d6">R</a>) ./i/imx0-0-0-s1/s2/s3/etc. These are 2D or 3D images (1 byte per data point) <span class="keywordflow">for each</span> primitive variable.</div>
<div class="line"></div>
<div class="line">You can use a program Charles/I wrote to view these either indirectly <span class="keyword">using</span> any image viewer or directly <span class="keyword">using</span> “display” from ImageMagik.</div>
<div class="line"></div>
<div class="line">http:<span class="comment">//www.stanford.edu/~jmckinne/pnmhd/r8toras_all.tgz</span></div>
<div class="line"></div>
<div class="line">You should compile the r8toras.c program and copy it to somewhere in your path, copy the “dr8*” files to somewhere in your path, and put the *.pal files somewhere the dr8 files points to (you should modify where dr8 looks <span class="keywordflow">for</span> the .pal file).</div>
<div class="line"></div>
<div class="line">I have lots of complicated utilities to make movies and such out of these in vis5d+, but until you <span class="keywordflow">do</span> 3D that won’t be necessary.</div>
<div class="line">jsm is just a script to run sm. In particular, it sets <a class="code" href="../../dc/dd2/newcodediff_8txt.html#a1df03026db3aa663afda0c9eed67408e">up</a> the terminal to be vt100 so keyboard behavior with SM is more normal. The “dsm” is just sm with a “d” in front to indicate it’s the “double precision” version. You can either rename that to “sm” or copy your sm (or a compiled sm) to dsm in your path. The “-m smstart” loads some needed macros. Leave the rest.</div>
<div class="line"></div>
<div class="line">When making sm, you should also have “lib” related things. You install these by doing “make install” as root or by copying them manually.</div>
<div class="line"></div>
<div class="line">I can give you mine that may work:</div>
<div class="line"></div>
<div class="line">http:<span class="comment">//www.stanford.edu/~jmckinne/pnmhd/smlib.tgz</span></div>
<div class="line"></div>
<div class="line">Untar <span class="keyword">this</span> so that it creates a directory: ~/sm/lib (i.e. /home<span class="comment">//sm/lib)</span></div>
<div class="line"></div>
<div class="line">Then make sure your .sm is changed so anything that looks like “/usr/local/lib” is then “/home<span class="comment">//sm/lib”</span></div>
<div class="line"></div>
<div class="line">-Jon</div>
</div><!-- fragment --> 
<p>Definition in file <a class="el" href="../../dc/d04/9_8txt_source.html">9.txt</a>.</p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri May 20 2016 15:52:36 for HARM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.3.1
</small></address>
</body>
</html>
