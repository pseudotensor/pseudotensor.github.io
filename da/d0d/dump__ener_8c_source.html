<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>HARM: dump_ener.c Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">HARM
   </div>
   <div id="projectbrief">harm and utilities</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">dump_ener.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../da/d0d/dump__ener_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &quot;decs.h&quot;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div>
<div class="line"><a name="l00003"></a><span class="lineno"><a class="code" href="../../da/d0d/dump__ener_8c.html#af02a237a6625e7277c7861e752c136de">    3</a></span>&#160;<span class="preprocessor">#define PROBEFILE (0 &amp;&amp;DOENERDIAG) // whether to do probe file</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="keywordtype">int</span> dump_ener(<span class="keywordtype">int</span> doener, <span class="keywordtype">int</span> dordump, <span class="keywordtype">int</span> call_code)</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;{</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  <span class="keyword">static</span> FILE *flenerreg_file[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ae4512aaf0b87c98f356bd90f83f144bd" title="set enerregion types">NUMENERREGIONS</a>];</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  <span class="keyword">static</span> FILE *flener_file;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  <span class="keywordtype">char</span> FLENERREGIONNAME[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ae4512aaf0b87c98f356bd90f83f144bd" title="set enerregion types">NUMENERREGIONS</a>][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0947c0a3d28c188caa4497cce08539c9" title="maximum char size of filenames or directories or commands">MAXFILENAME</a>];</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  <span class="keywordtype">char</span> *FLENERNAME;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  <span class="keyword">static</span> FILE *enerreg_file[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ae4512aaf0b87c98f356bd90f83f144bd" title="set enerregion types">NUMENERREGIONS</a>];</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  <span class="keyword">static</span> FILE *ener_file;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <span class="keywordtype">char</span> ENERREGIONNAME[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ae4512aaf0b87c98f356bd90f83f144bd" title="set enerregion types">NUMENERREGIONS</a>][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0947c0a3d28c188caa4497cce08539c9" title="maximum char size of filenames or directories or commands">MAXFILENAME</a>];</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <span class="keywordtype">char</span> *ENERNAME;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <span class="keyword">static</span> FILE *generreg_file[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ae4512aaf0b87c98f356bd90f83f144bd" title="set enerregion types">NUMENERREGIONS</a>];</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <span class="keyword">static</span> FILE *gener_file;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="keywordtype">char</span> GENERREGIONNAME[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ae4512aaf0b87c98f356bd90f83f144bd" title="set enerregion types">NUMENERREGIONS</a>][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0947c0a3d28c188caa4497cce08539c9" title="maximum char size of filenames or directories or commands">MAXFILENAME</a>];</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keywordtype">char</span> *GENERNAME;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="keyword">static</span> FILE *metricparmsener_file;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="comment">// per cpu file</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keyword">static</span> FILE *probe_file;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="comment">// single region files</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keyword">static</span> FILE *debug_file;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keyword">static</span> FILE *lumener_file;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keyword">static</span> FILE *dissener_file[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#adde832aa14a494487d47d4fed8268966" title="totals:">NUMDISSVERSIONS</a>];</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordtype">int</span> fileiter;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#define NUMSELFGRAV 9</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor"></span>  <span class="keyword">static</span> FILE *selfgravener_file[<a class="code" href="../../da/d0d/dump__ener_8c.html#a8699b4c4f847b927d66b469288d85599">NUMSELFGRAV</a>];</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keywordtype">char</span> dfnam[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0947c0a3d28c188caa4497cce08539c9" title="maximum char size of filenames or directories or commands">MAXFILENAME</a>], ifnam[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0947c0a3d28c188caa4497cce08539c9" title="maximum char size of filenames or directories or commands">MAXFILENAME</a>];</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#ad21ff679aac3fe28202c6d592eafd3e6">i</a>, <a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>, k, pl, pliter, l, dir,sc,fl,indexfinalstep,floor,tscale;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordtype">int</span> dissloop;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="comment">//  FILE *imagecnt_file, *dumpcnt_file,*avgcnt_file,*debugcnt_file,*lumvsrcnt_file,*dissvsrcnt_file;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="comment">// full grid only</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> divb, divbmax = 0, divbavg =0;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="comment">// special jet2</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> pdottermsjet2_tot[<a class="code" href="../../da/d3e/definit_8h.html#a1b2ef8afddd2c5d91ab65015bbd7b80b" title="NUMBER OF DIMENSIONS FOR COMPUTATION Can choose 3 and still do 1D optimized problems Choosing 2 or ev...">COMPDIM</a>*2][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ae4fbef105053d4de8631922e25d1f4b3" title="max number of terms in stress tensor (for term-level flux diagnostic)">NUMFLUXTERMS</a>][NPR];</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="comment">// all regions, local quantities</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="comment">// these quantities can always be computed, no need in restart file and so in defs.h where many other _tot quantities appear</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> Ureg_tot[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ae4512aaf0b87c98f356bd90f83f144bd" title="set enerregion types">NUMENERREGIONS</a>][NPR];</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> Ureg_final[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ae4512aaf0b87c98f356bd90f83f144bd" title="set enerregion types">NUMENERREGIONS</a>][NPR];</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="comment">// each region, local quantities</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> *U_tot;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> *U_final;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="keywordtype">int</span> enerregion;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">int</span> firsttime = 1;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> ftemp0,ftemp1;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="keywordtype">int</span> ii;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> phibh;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="keyword">extern</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> phibh_compute(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/d53/metric_8c.html#a52037c938e3c1b126c6277da5ca689d0">M</a>, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa73cf2d397cae726436e08d2c891bdb0">a</a>, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> r, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> th);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="comment">// Open/append some files</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="keywordflow">if</span> ((call_code == <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ac7bd3e2d58bb50d2472790a765c0c714" title="mnemonics for diagnostic calls">INIT_OUT</a>) || (firsttime == 1)) {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../da/d0d/dump__ener_8c.html#af02a237a6625e7277c7861e752c136de">PROBEFILE</a>&amp;&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#afbca4918ea5a00b04a471d39f4760924">DOENERDIAG</a>){ <span class="comment">// NOTEMARK: Locking probe output to DOENERDIAG=0/1</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      <span class="comment">// PER CPU FILE</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      sprintf(dfnam,<span class="stringliteral">&quot;probe.dat%s&quot;</span>,myidtxt);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <span class="keywordflow">if</span>((probe_file=fopen(dfnam,<span class="stringliteral">&quot;at&quot;</span>))==NULL){</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Can&#39;t open probe file\n&quot;</span>);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        myexit(1);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    }</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordflow">if</span>(myid==0) <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#aefc47346bd5140a39b6d744385796e56" title="0: don&#39;t output debug dump file or ener file(ener is based on dump counts) 1: do">DODEBUG</a>){</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="comment">// CPU=0 only</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        sprintf(dfnam,<span class="stringliteral">&quot;debug.out&quot;</span>);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        myfopen(dfnam,<span class="stringliteral">&quot;a+&quot;</span>,<span class="stringliteral">&quot;error opening debug output file\n&quot;</span>,&amp;debug_file);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      }</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">if</span>(myid==0) <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#a6c2751c5217b428c5f5faf66a08e2d90" title="0: don&#39;t do calculation 1: do">DOLUMVSR</a>){</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="comment">// CPU=0 only</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        sprintf(dfnam,<span class="stringliteral">&quot;lumvsr.out&quot;</span>);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        myfopen(dfnam,<span class="stringliteral">&quot;a+&quot;</span>,<span class="stringliteral">&quot;error opening lumvsr output file\n&quot;</span>,&amp;lumener_file);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      }</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordflow">if</span>(myid==0) <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#affb54fad9620541e1fcb17f854af9bfe" title="see diag_source()">DODISSVSR</a>){</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="comment">// CPU=0 only</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="keywordflow">for</span>(fileiter=0;fileiter&lt;<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#adde832aa14a494487d47d4fed8268966" title="totals:">NUMDISSVERSIONS</a>;fileiter++){</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;          sprintf(dfnam,<span class="stringliteral">&quot;dissvsr%d.out&quot;</span>,fileiter);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;          myfopen(dfnam,<span class="stringliteral">&quot;a+&quot;</span>,<span class="stringliteral">&quot;error opening dissvsr output file\n&quot;</span>,&amp;dissener_file[fileiter]);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        }</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      }</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordflow">if</span>(myid==0) <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#af35efc27e405b7c3e2c95df8f7559a07" title="#define WHICHENTROPYEVOLVE EVOLVEFULLENTROPY">DOSELFGRAVVSR</a>){</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="comment">// CPU=0 only</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="keywordflow">for</span>(fileiter=0;fileiter&lt;<a class="code" href="../../da/d0d/dump__ener_8c.html#a8699b4c4f847b927d66b469288d85599">NUMSELFGRAV</a>;fileiter++){</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;          sprintf(dfnam,<span class="stringliteral">&quot;selfgravvsr%d.out&quot;</span>,fileiter);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;          myfopen(dfnam,<span class="stringliteral">&quot;a+&quot;</span>,<span class="stringliteral">&quot;error opening selfgravvsr output file\n&quot;</span>,&amp;selfgravener_file[fileiter]);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordflow">if</span>(myid==0) <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#a149d0d31999a38ec3870e1e4a4eecf67" title="careful not to use DOMIXTHETAPHI in .h files since init.h might change it.">DOEVOLVEMETRIC</a>){</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="comment">// CPU=0 only</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        sprintf(dfnam,<span class="stringliteral">&quot;metricparms.out&quot;</span>);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        myfopen(dfnam,<span class="stringliteral">&quot;a+&quot;</span>,<span class="stringliteral">&quot;error opening metricparms output file\n&quot;</span>,&amp;metricparmsener_file);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="comment">// CPU=0 only</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordflow">if</span>(myid==0) <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a2eb6e271008c49cc3feaa64c6eea2ddb" title="loop over ener/flux regions">ENERREGIONLOOP</a>(enerregion){</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="comment">// set some pointers</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        FLENERNAME=FLENERREGIONNAME[enerregion];</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="comment">// when setting file pointers, need pointer to pointer or just set pointers directly (we do latter for naming reasons)</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="comment">/*  flener_file=flenerreg_file[enerregion]; */</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="comment">/*  ener_file=&amp;enerreg_file[enerregion]; */</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="comment">/*  gener_file=generreg_file[enerregion]; */</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        ENERNAME=ENERREGIONNAME[enerregion];</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        GENERNAME=GENERREGIONNAME[enerregion];</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <a class="code" href="../../d8/d5b/defs_8general_8h.html#a5ee2b41485cc8d43886cedf25babc1bd">pcum_tot</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a791371e1aa99d0acfc298b5ee60d2ee6">pcumreg_tot</a>[enerregion];</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <a class="code" href="../../d8/d5b/defs_8general_8h.html#ad9928a4a5651487bce6eeabe3c97ef69">fladd_tot</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae2c39c8253f2546c4a1e014929400743">fladdreg_tot</a>[enerregion];</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <a class="code" href="../../d8/d5b/defs_8general_8h.html#a4ab74e6392365dba9b6ef98fd4d9d995">sourceadd_tot</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae76db216294805f036bcbd39aab9edb6">sourceaddreg_tot</a>[enerregion];</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="comment">// flener</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="keywordflow">if</span>(enerregion==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#adc05fc600cb51df792150fc73fa883f7">GLOBALENERREGION</a>) sprintf(FLENERNAME,<span class="stringliteral">&quot;flener.out&quot;</span>);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="keywordflow">else</span> sprintf(FLENERNAME,<span class="stringliteral">&quot;flenerother%d.out&quot;</span>,enerregion); <span class="comment">// specific naming convention</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        myfopen(FLENERNAME,<span class="stringliteral">&quot;a+&quot;</span>,<span class="stringliteral">&quot;error opening FLenergy output file\n&quot;</span>,&amp;flenerreg_file[enerregion]);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="comment">// ener</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="keywordflow">if</span>(enerregion==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#adc05fc600cb51df792150fc73fa883f7">GLOBALENERREGION</a>) sprintf(ENERNAME,<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#afb17ea9127ed4c7e71e72188bf367cc6">ENERFNAME</a>);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="keywordflow">else</span> sprintf(ENERNAME,<span class="stringliteral">&quot;enerother%d.out&quot;</span>,enerregion); <span class="comment">// specific naming convention</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0323ff1e2a98351ce15b59e945117024">appendold</a> == 0) {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;          <span class="comment">// a+ in general, or w for overwrites, but let&#39;s append for now</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;          myfopen(ENERNAME,<span class="stringliteral">&quot;a+&quot;</span>,<span class="stringliteral">&quot;error opening  energy output file\n&quot;</span>,&amp;enerreg_file[enerregion]);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="keywordflow">else</span> {   <span class="comment">// if appendold==1</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;          trifprintf(<span class="stringliteral">&quot;Start setup of %s file append\n&quot;</span>, ENERNAME);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;          myfopen(ENERNAME,<span class="stringliteral">&quot;a+&quot;</span>,<span class="stringliteral">&quot;error opening  energy output file for append\n&quot;</span>,&amp;enerreg_file[enerregion]);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;          appendener(ener_file,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a5ee2b41485cc8d43886cedf25babc1bd">pcum_tot</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad9928a4a5651487bce6eeabe3c97ef69">fladd_tot</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a4ab74e6392365dba9b6ef98fd4d9d995">sourceadd_tot</a>);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        }</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="comment">// gener</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keywordflow">if</span>(enerregion==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#adc05fc600cb51df792150fc73fa883f7">GLOBALENERREGION</a>) sprintf(GENERNAME,<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ab2165af9595fa18e7a23cb9fbfeb1487">GENERFNAME</a>);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="keywordflow">else</span> sprintf(GENERNAME,<span class="stringliteral">&quot;generjet%d.out&quot;</span>,enerregion-1); <span class="comment">// specific naming convention</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        myfopen(GENERNAME,<span class="stringliteral">&quot;a+&quot;</span>,<span class="stringliteral">&quot;error opening  energy output file\n&quot;</span>,&amp;generreg_file[enerregion]);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      }</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  }</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="comment">// compute divB and output to logs</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  divbmaxavg(<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pdump),&amp;divbmax,&amp;divbavg);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="comment">// ENER/FLENER/FRDOT/DEBUG output integrated diagnostics</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="comment">// for any number of predetermined regions</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a2eb6e271008c49cc3feaa64c6eea2ddb" title="loop over ener/flux regions">ENERREGIONLOOP</a>(enerregion){</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    trifprintf(<span class="stringliteral">&quot;.BE.%d&quot;</span>,enerregion);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="comment">// setup some pointers</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="comment">// each region, local quantities</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    U_tot=Ureg_tot[enerregion];</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    U_final=Ureg_final[enerregion];</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ad02d343a7078e283c737547fff54f8eb" title="kept global">pdot_tot</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a9e849fd3ce87ac2e32c9a447500c6e52" title="below quantities are not kept in restart file since easily recomputed kept global so can always acces...">pdotreg_tot</a>[enerregion];</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a0a00e7be389ef42228620aa2b1ef36b3">pdotterms_tot</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae161dd76534aa4cd9e1218f82713b172">pdottermsreg_tot</a>[enerregion];</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="comment">// used for each region, related to global quantities</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#aebda2a7dfd8109bff10160f9bf2993fa">fladd</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a6707f24b846a9a6236e3f6b2b64e7e82" title="these quantities contain diagnostics all these require writing to restart file other _tot quantities ...">fladdreg</a>[enerregion];</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ad9928a4a5651487bce6eeabe3c97ef69">fladd_tot</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae2c39c8253f2546c4a1e014929400743">fladdreg_tot</a>[enerregion];</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#af56ce3c03a54f45dd2230f39521a1489">fladdterms</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#acd071ad3c75fd969b717fc8872aa70c4">fladdtermsreg</a>[enerregion];</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a7971d92df68fc035a35d3eb714aadbb4">fladdterms_tot</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#aed19121646bc0e629bb918e229cbbfef">fladdtermsreg_tot</a>[enerregion];</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#abf96720f4175a88587273eff6bd609e9">U_init</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a6c600198e62182b798fabbc064dad2d3">Ureg_init</a>[enerregion];</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a1d471d466b12f22fb12e0dfbefc4ba09">U_init_tot</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a395fdeb64b243f03682aa5d8e4e637ab">Ureg_init_tot</a>[enerregion];</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3db95be8997404ffedeec87bbacc78c4">pcum</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2fee8f15a2bd11178d308d2d6c8acc1b">pcumreg</a>[enerregion];</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a5ee2b41485cc8d43886cedf25babc1bd">pcum_tot</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a791371e1aa99d0acfc298b5ee60d2ee6">pcumreg_tot</a>[enerregion];</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a8de8f5aa2639ff085d3aae86a0ab3d74">pdot</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a23cf644ed9f84bfe915ec4e8fe5e48c8">pdotreg</a>[enerregion];</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a08c6cad0da4b86c3230016fcae3a5652">pdotterms</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#afdad79843302d351975cd4f60e86351e">pdottermsreg</a>[enerregion];</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ae8fccff72233de8bd53983760c414795">sourceaddterms</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a4493c5cbc76f78da7e95a5b87f9bf6f6">sourceaddtermsreg</a>[enerregion];</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a8ec5678abebade16c9df0e2d5cdb6a6c">sourceaddterms_tot</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a407628560be0990ee13474d6f23967bc">sourceaddtermsreg_tot</a>[enerregion];</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a9216a94c4f02bd14cdf02129b8d7b6f2">sourceadd</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#abc8a54a29a758e02e4eabaf374bbdfbd">sourceaddreg</a>[enerregion];</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a4ab74e6392365dba9b6ef98fd4d9d995">sourceadd_tot</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae76db216294805f036bcbd39aab9edb6">sourceaddreg_tot</a>[enerregion];</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a169f58cb5a306eec56593fa30f25d28d">diss</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a33837b5474325908836b24ab40fed5b6">dissreg</a>[enerregion];</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    diss_tot=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a41a0f6cdc7048d7876a52437c1931af6">dissreg_tot</a>[enerregion];</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordflow">if</span>(myid==0){ <span class="comment">// only cpu=0 writes to these files, although doesn&#39;t matter</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      ener_file=enerreg_file[enerregion];</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      gener_file=generreg_file[enerregion];</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      flener_file=flenerreg_file[enerregion];</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    }</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="comment">// do some integrations</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordflow">if</span>(dordump||doener){</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      trifprintf(<span class="stringliteral">&quot;BI%d&quot;</span>,enerregion);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      <span class="comment">// things that are done for EVERY region (can&#39;t sum over all regions at once since each region has different WITHINENERREGION() conditional)</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <span class="comment">// Below assumes continuous array starting at some address -- otherwise would have to do per quantity as in prior versions with extra loops</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      <span class="comment">// compute total conserved quantity</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <span class="comment">// SUPERGODMARK: Why is this U_tot,U_tot ?</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <span class="keywordflow">if</span>(integrate(NPR,U_tot,U_tot,<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#af31213679a914b998a2d21c3379509c9">CONSTYPE</a>,enerregion)&gt;=1) <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <span class="comment">// DIRLOOP(dir)</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <span class="keywordflow">if</span>(integrate((<a class="code" href="../../da/d3e/definit_8h.html#a1b2ef8afddd2c5d91ab65015bbd7b80b" title="NUMBER OF DIMENSIONS FOR COMPUTATION Can choose 3 and still do 1D optimized problems Choosing 2 or ev...">COMPDIM</a>*2)*NPR,&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#a8de8f5aa2639ff085d3aae86a0ab3d74">pdot</a>[0][0],&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad02d343a7078e283c737547fff54f8eb" title="kept global">pdot_tot</a>[0][0],<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ad17625fabc8232c022c8e61a76203fe1">SURFACETYPE</a>,enerregion)&gt;=1) <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      <span class="comment">// above should be sum of below, approximately</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      <span class="comment">//      DIRLOOP(dir) FLLOOP(fl)</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      <span class="keywordflow">if</span>(integrate((<a class="code" href="../../da/d3e/definit_8h.html#a1b2ef8afddd2c5d91ab65015bbd7b80b" title="NUMBER OF DIMENSIONS FOR COMPUTATION Can choose 3 and still do 1D optimized problems Choosing 2 or ev...">COMPDIM</a>*2)*<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ae4fbef105053d4de8631922e25d1f4b3" title="max number of terms in stress tensor (for term-level flux diagnostic)">NUMFLUXTERMS</a>*NPR,&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#a08c6cad0da4b86c3230016fcae3a5652">pdotterms</a>[0][0][0],&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0a00e7be389ef42228620aa2b1ef36b3">pdotterms_tot</a>[0][0][0],<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ad17625fabc8232c022c8e61a76203fe1">SURFACETYPE</a>,enerregion)&gt;=1) <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      <span class="comment">//DIRLOOP(dir)</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      <span class="keywordflow">if</span>(integrate((<a class="code" href="../../da/d3e/definit_8h.html#a1b2ef8afddd2c5d91ab65015bbd7b80b" title="NUMBER OF DIMENSIONS FOR COMPUTATION Can choose 3 and still do 1D optimized problems Choosing 2 or ev...">COMPDIM</a>*2)*NPR,&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#a3db95be8997404ffedeec87bbacc78c4">pcum</a>[0][0],&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#a5ee2b41485cc8d43886cedf25babc1bd">pcum_tot</a>[0][0],<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ad17625fabc8232c022c8e61a76203fe1">SURFACETYPE</a>,enerregion)&gt;=1) <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      <span class="comment">//FLOORLOOP(floor)</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      <span class="keywordflow">if</span>(integrate(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ad9bb736bd7bcb5b96bf37975a5b7cbec">NUMFAILFLOORFLAGS</a>*NPR,&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#af56ce3c03a54f45dd2230f39521a1489">fladdterms</a>[0][0],&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#a7971d92df68fc035a35d3eb714aadbb4">fladdterms_tot</a>[0][0],<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a08f7aaae724b378ac86a8fae70777f91">CUMULATIVETYPE</a>,enerregion)&gt;=1) <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <span class="keywordflow">if</span>(integrate(NPR,&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#aebda2a7dfd8109bff10160f9bf2993fa">fladd</a>[0],&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad9928a4a5651487bce6eeabe3c97ef69">fladd_tot</a>[0],<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a08f7aaae724b378ac86a8fae70777f91">CUMULATIVETYPE</a>,enerregion)&gt;=1) <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      <span class="comment">//SCLOOP(sc)</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      <span class="keywordflow">if</span>(integrate(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ac34589654a83c911addd1fda0898e738">NUMSOURCES</a>*NPR,&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae8fccff72233de8bd53983760c414795">sourceaddterms</a>[0][0],&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#a8ec5678abebade16c9df0e2d5cdb6a6c">sourceaddterms_tot</a>[0][0],<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a08f7aaae724b378ac86a8fae70777f91">CUMULATIVETYPE</a>,enerregion)&gt;=1) <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      <span class="keywordflow">if</span>(integrate(NPR,&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#a9216a94c4f02bd14cdf02129b8d7b6f2">sourceadd</a>[0],&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#a4ab74e6392365dba9b6ef98fd4d9d995">sourceadd_tot</a>[0],<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a08f7aaae724b378ac86a8fae70777f91">CUMULATIVETYPE</a>,enerregion)&gt;=1) <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#a702c3f736ffae96949fb85f091aff230">DODISS</a>){</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <span class="keywordflow">if</span>(integrate(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#adde832aa14a494487d47d4fed8268966" title="totals:">NUMDISSVERSIONS</a>,&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#a169f58cb5a306eec56593fa30f25d28d">diss</a>[0],&amp;diss_tot[0],<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a08f7aaae724b378ac86a8fae70777f91">CUMULATIVETYPE</a>,enerregion)&gt;=1) <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      }</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      <span class="comment">// below was subsumed into its own full enerregion (should have done so in first place!)</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      <span class="comment">// OUTSIDEHORIZONENERREGION STUFF (i.e. only done once over that region)</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      <span class="comment">//      if(enerregion==OUTSIDEHORIZONENERREGION){</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      <span class="comment">// now integrate horizon fluces over all CPUs</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <span class="comment">// this is also done during actual evolution in metric.c, but needed here too so diagnostics are correctly updated</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      <span class="comment">// doesn&#39;t hurt evolution at all</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      <span class="comment">// if(integrate(horizonflux,horizonflux_tot,SURFACETYPE,enerregion)&gt;=1) return(1);</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      <span class="comment">// if(integrate(horizoncum,horizoncum_tot,SURFACETYPE,enerregion)&gt;=1) return(1);</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      <span class="comment">// assume DOSELFGRAVVSR has already cumulated dMvsr into dMvsr_tot and computed Mvsr_tot and phivsr_tot</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      <span class="comment">//      }</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      <span class="comment">// GLOBALENERREGION STUFF (i.e. only done once over that region or just simply done once at all and just keeping within loop for simplicity)</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      <span class="keywordflow">if</span>(enerregion==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#adc05fc600cb51df792150fc73fa883f7">GLOBALENERREGION</a>){</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#a6c2751c5217b428c5f5faf66a08e2d90" title="0: don&#39;t do calculation 1: do">DOLUMVSR</a>){</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;          <span class="comment">//for(ii=0;ii&lt;ncpux1*N1;ii++)</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;          <span class="keywordflow">if</span>(integrate(<a class="code" href="../../dd/d46/mpidefs_8h.html#a849af7562e98534cd4ea5764f5187bbd">ncpux1</a>*<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>,&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#a75d4d9f688220e74452609859774e5a0">lumvsr</a>[0],&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#a124c703e3c349fa1c42f6b26dc8ccace">lumvsr_tot</a>[0],<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a08f7aaae724b378ac86a8fae70777f91">CUMULATIVETYPE</a>,enerregion)&gt;=1) <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        }</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#affb54fad9620541e1fcb17f854af9bfe" title="see diag_source()">DODISSVSR</a>){</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;          <span class="keywordflow">for</span>(dissloop=0;dissloop&lt;<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#adde832aa14a494487d47d4fed8268966" title="totals:">NUMDISSVERSIONS</a>;dissloop++){<span class="comment">// this loop is over pointers, not a continuous memory space!</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            <span class="comment">// for(ii=0;ii&lt;ncpux1*N1;ii++)</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            <span class="keywordflow">if</span>(integrate(<a class="code" href="../../dd/d46/mpidefs_8h.html#a849af7562e98534cd4ea5764f5187bbd">ncpux1</a>*<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>,&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#a57d77cd626bfc2578b551b63f7640736">dissvsr</a>[dissloop][0],&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#a44553fca1670897538d6257b335d7914">dissvsr_tot</a>[dissloop][0],<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a08f7aaae724b378ac86a8fae70777f91">CUMULATIVETYPE</a>,enerregion)&gt;=1) <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;          }</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        }</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="comment">// special jet2 accounting</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="comment">//DIRLOOP(dir) FLLOOP(fl) </span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <span class="keywordflow">if</span>(integrate((<a class="code" href="../../da/d3e/definit_8h.html#a1b2ef8afddd2c5d91ab65015bbd7b80b" title="NUMBER OF DIMENSIONS FOR COMPUTATION Can choose 3 and still do 1D optimized problems Choosing 2 or ev...">COMPDIM</a>*2)*<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ae4fbef105053d4de8631922e25d1f4b3" title="max number of terms in stress tensor (for term-level flux diagnostic)">NUMFLUXTERMS</a>*NPR,&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#aff071475bb57622298e44ee438fa0898">pdottermsjet2</a>[0][0][0],&amp;pdottermsjet2_tot[0][0][0],<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ad17625fabc8232c022c8e61a76203fe1">SURFACETYPE</a>,enerregion)&gt;=1) <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <span class="comment">// debug</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#aefc47346bd5140a39b6d744385796e56" title="0: don&#39;t output debug dump file or ener file(ener is based on dump counts) 1: do">DODEBUG</a>){</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;          <span class="comment">//TSCALELOOP(tscale)</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;          <span class="comment">// below is special integratel and for CONSTYPE performs integration over GLOBALMACP0A3(failfloorcount,i,j,k,indexfinalstep,tscale,pl) for each enerregion</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;          <span class="keywordflow">if</span>(integratel(2*<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a97da1b7437d7f64122b5504f054ff27e">NUMTSCALES</a>*<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ad9bb736bd7bcb5b96bf37975a5b7cbec">NUMFAILFLOORFLAGS</a>,&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#a5b97d9e4c75a806486c79b2449106b20">failfloorcountlocal</a>[0][0][0],&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#a7db48a9cd90ac0af7bab5863b55e0c7a">failfloorcountlocal_tot</a>[0][0][0],<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#af31213679a914b998a2d21c3379509c9">CONSTYPE</a>,enerregion)&gt;=1) <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      trifprintf(<span class="stringliteral">&quot;AI%d&quot;</span>,enerregion);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    }<span class="comment">// end if dordump||doener</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="comment">// initialize the total conserved counters</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordflow">if</span> (call_code == <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ac7bd3e2d58bb50d2472790a765c0c714" title="mnemonics for diagnostic calls">INIT_OUT</a> || firsttime) {</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a00bdeb72a08e745eb0a5482af9e8cb74">RESTARTMODE</a>==0)    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#af1c67086436007e897bccc458390886f" title="PLOOP controls looping over conserved or primitive -type quantities except during interpolation or ot...">PLOOP</a>(pliter,pl) <a class="code" href="../../d8/d5b/defs_8general_8h.html#a1d471d466b12f22fb12e0dfbefc4ba09">U_init_tot</a>[pl] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#abf96720f4175a88587273eff6bd609e9">U_init</a>[pl] = U_tot[pl];</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      <span class="comment">// otherwise read from restart file</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    }</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="comment">// output some interesting diagnostics to stderr/log files.</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keywordflow">if</span> (call_code == <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a08fc657d6f1d0641abaaea4efd2e3759">FINAL_OUT</a>) {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#af1c67086436007e897bccc458390886f" title="PLOOP controls looping over conserved or primitive -type quantities except during interpolation or ot...">PLOOP</a>(pliter,pl) U_final[pl] = U_tot[pl];</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad592700218c6ca4bf0543723ee36d028">GAMMIEENER</a>){</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        trifprintf(<span class="stringliteral">&quot;\n\nEnergy: ini,fin,del: %21.15g %21.15g %21.15g\n&quot;</span>,</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                   <a class="code" href="../../d8/d5b/defs_8general_8h.html#abf96720f4175a88587273eff6bd609e9">U_init</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a94db1ec6a412a83becda73ca2a5db0bf">UU</a>], U_final[UU], (U_final[UU] - <a class="code" href="../../d8/d5b/defs_8general_8h.html#abf96720f4175a88587273eff6bd609e9">U_init</a>[UU]) / <a class="code" href="../../d8/d5b/defs_8general_8h.html#abf96720f4175a88587273eff6bd609e9">U_init</a>[UU]);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        trifprintf(<span class="stringliteral">&quot;\n\nMass: ini,fin,del: %21.15g %21.15g %21.15g\n&quot;</span>,</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                   <a class="code" href="../../d8/d5b/defs_8general_8h.html#abf96720f4175a88587273eff6bd609e9">U_init</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a3bf4402b9e2ae88e4462c3689f5d22b8">RHO</a>], U_final[RHO], (U_final[RHO] - <a class="code" href="../../d8/d5b/defs_8general_8h.html#abf96720f4175a88587273eff6bd609e9">U_init</a>[RHO]) / <a class="code" href="../../d8/d5b/defs_8general_8h.html#abf96720f4175a88587273eff6bd609e9">U_init</a>[RHO]);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      }</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        trifprintf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#af1c67086436007e897bccc458390886f" title="PLOOP controls looping over conserved or primitive -type quantities except during interpolation or ot...">PLOOP</a>(pliter,pl){</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;          ftemp0=(U_final[pl] - <a class="code" href="../../d8/d5b/defs_8general_8h.html#abf96720f4175a88587273eff6bd609e9">U_init</a>[pl]);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;          ftemp1=(U_final[pl]-<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad9928a4a5651487bce6eeabe3c97ef69">fladd_tot</a>[pl]-<a class="code" href="../../d8/d5b/defs_8general_8h.html#a4ab74e6392365dba9b6ef98fd4d9d995">sourceadd_tot</a>[pl]-(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a5ee2b41485cc8d43886cedf25babc1bd">pcum_tot</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aab7332b2c03d905515d5350d4fd0850f">X1DN</a>][pl]+<a class="code" href="../../d8/d5b/defs_8general_8h.html#a5ee2b41485cc8d43886cedf25babc1bd">pcum_tot</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aae79dca9f851fb40349156f6bca1f8ca">X2DN</a>][pl]+<a class="code" href="../../d8/d5b/defs_8general_8h.html#a5ee2b41485cc8d43886cedf25babc1bd">pcum_tot</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ada1c40d716a8e3567377cd77831aca10">X3DN</a>][pl]) + (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a5ee2b41485cc8d43886cedf25babc1bd">pcum_tot</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a6a3603145c91f722d74610fbd6e4f696" title="----------&gt; r | 3 | 1-0 | 2 v theta and likewise for 4,5 (4=out,5=in) directions:">X1UP</a>][pl]+<a class="code" href="../../d8/d5b/defs_8general_8h.html#a5ee2b41485cc8d43886cedf25babc1bd">pcum_tot</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aa9363649053ac2e906715b3259a14954">X2UP</a>][pl]+<a class="code" href="../../d8/d5b/defs_8general_8h.html#a5ee2b41485cc8d43886cedf25babc1bd">pcum_tot</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a55fd86081e74615c36554fed69074cd2">X3UP</a>][pl]) - <a class="code" href="../../d8/d5b/defs_8general_8h.html#abf96720f4175a88587273eff6bd609e9">U_init</a>[pl]);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;          trifprintf(<span class="stringliteral">&quot;U[%d]: ini,fin,fdf,del,tfdf,tdel: %21.15g %21.15g %21.15g %21.15g %21.15g %21.15g\n&quot;</span>,</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                     pl,</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                     <a class="code" href="../../d8/d5b/defs_8general_8h.html#abf96720f4175a88587273eff6bd609e9">U_init</a>[pl],</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                     U_final[pl],</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                     <a class="code" href="../../d8/d5b/defs_8general_8h.html#abf96720f4175a88587273eff6bd609e9">U_init</a>[pl]!=0.0 ? ftemp0/<a class="code" href="../../d8/d5b/defs_8general_8h.html#abf96720f4175a88587273eff6bd609e9">U_init</a>[pl] : 0.0,</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                     ftemp0,</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                     <a class="code" href="../../d8/d5b/defs_8general_8h.html#abf96720f4175a88587273eff6bd609e9">U_init</a>[pl]!=0.0 ? ftemp1/<a class="code" href="../../d8/d5b/defs_8general_8h.html#abf96720f4175a88587273eff6bd609e9">U_init</a>[pl] : 0.0,</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                     ftemp1 );</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        } </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      }</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    }</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="comment">//  output some ener diagnostics to ener, flener, debug, and probe(only cpu specific one) files</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keywordflow">if</span> (doener){</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      <span class="keywordflow">if</span>(1||<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad592700218c6ca4bf0543723ee36d028">GAMMIEENER</a>){</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <span class="comment">// 6+3=9 terms</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        myfprintf(gener_file, <span class="stringliteral">&quot;%21.15g %21.15g %21.15g %21.15g %21.15g %21.15g &quot;</span>, <a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>, U_tot[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a3bf4402b9e2ae88e4462c3689f5d22b8">RHO</a>], U_tot[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8de9104f1fffa59f057b214d74c5cfea">U3</a>], U_tot[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a94db1ec6a412a83becda73ca2a5db0bf">UU</a>], GLOBALMACP0A1(pdump,<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a> / 2,<a class="code" href="../../da/d3e/definit_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a> / 2,<a class="code" href="../../da/d3e/definit_8h.html#ad66109fbdc4d3adc9c3d6ff917038aef">N3</a> / 2,UU) * pow(GLOBALMACP0A1(pdump,<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a> / 2,<a class="code" href="../../da/d3e/definit_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a> / 2,<a class="code" href="../../da/d3e/definit_8h.html#ad66109fbdc4d3adc9c3d6ff917038aef">N3</a> / 2,RHO), -<a class="code" href="../../d8/d5b/defs_8general_8h.html#a5db33bd66a02c92d495409fd6d6c7459" title="GLOBAL PARAMETERS SECTION.">gam</a>), GLOBALMACP0A1(pdump,<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a> / 2,<a class="code" href="../../da/d3e/definit_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a> / 2,<a class="code" href="../../da/d3e/definit_8h.html#ad66109fbdc4d3adc9c3d6ff917038aef">N3</a> / 2,UU));</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        myfprintf(gener_file, <span class="stringliteral">&quot;%21.15g %21.15g %21.15g &quot;</span>, <a class="code" href="../../d8/d5b/defs_8general_8h.html#ad02d343a7078e283c737547fff54f8eb" title="kept global">pdot_tot</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aab7332b2c03d905515d5350d4fd0850f">X1DN</a>][RHO], <a class="code" href="../../d8/d5b/defs_8general_8h.html#ad02d343a7078e283c737547fff54f8eb" title="kept global">pdot_tot</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aab7332b2c03d905515d5350d4fd0850f">X1DN</a>][RHO]-<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad02d343a7078e283c737547fff54f8eb" title="kept global">pdot_tot</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aab7332b2c03d905515d5350d4fd0850f">X1DN</a>][UU], <a class="code" href="../../d8/d5b/defs_8general_8h.html#ad02d343a7078e283c737547fff54f8eb" title="kept global">pdot_tot</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aab7332b2c03d905515d5350d4fd0850f">X1DN</a>][U3]);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      }</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      <span class="keywordflow">if</span>(1){</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <span class="comment">// SM use gammie.m macro, jrdpener, gammieener&#39;s</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <span class="comment">// ENER FILE (only dir and pl)</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        <span class="comment">// 2+NPR+COMPDIM*2*NPR+NPR+(2) terms</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <span class="comment">// see jrdp3dener in gammie.m</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        myfprintf(ener_file,<span class="stringliteral">&quot;%21.15g %ld &quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a> ,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0b92e4d6197989f0f9b0609c8615a46f">realnstep</a>);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#af1c67086436007e897bccc458390886f" title="PLOOP controls looping over conserved or primitive -type quantities except during interpolation or ot...">PLOOP</a>(pliter,pl) myfprintf(ener_file, <span class="stringliteral">&quot;%21.15g &quot;</span>, U_tot[pl]);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#af276566d52b9239d67b094c949e15889" title="loop over directions">DIRLOOP</a>(dir) <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#af1c67086436007e897bccc458390886f" title="PLOOP controls looping over conserved or primitive -type quantities except during interpolation or ot...">PLOOP</a>(pliter,pl) myfprintf(ener_file, <span class="stringliteral">&quot;%21.15g &quot;</span>, <a class="code" href="../../d8/d5b/defs_8general_8h.html#ad02d343a7078e283c737547fff54f8eb" title="kept global">pdot_tot</a>[dir][pl]);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        <span class="comment">// COMPDIM*2*NPRDUMP more terms</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#af276566d52b9239d67b094c949e15889" title="loop over directions">DIRLOOP</a>(dir) <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#af1c67086436007e897bccc458390886f" title="PLOOP controls looping over conserved or primitive -type quantities except during interpolation or ot...">PLOOP</a>(pliter,pl) myfprintf(ener_file, <span class="stringliteral">&quot;%21.15g &quot;</span>, <a class="code" href="../../d8/d5b/defs_8general_8h.html#a5ee2b41485cc8d43886cedf25babc1bd">pcum_tot</a>[dir][pl]);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#af1c67086436007e897bccc458390886f" title="PLOOP controls looping over conserved or primitive -type quantities except during interpolation or ot...">PLOOP</a>(pliter,pl) myfprintf(ener_file, <span class="stringliteral">&quot;%21.15g &quot;</span>, <a class="code" href="../../d8/d5b/defs_8general_8h.html#ad9928a4a5651487bce6eeabe3c97ef69">fladd_tot</a>[pl]);</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#af1c67086436007e897bccc458390886f" title="PLOOP controls looping over conserved or primitive -type quantities except during interpolation or ot...">PLOOP</a>(pliter,pl) myfprintf(ener_file, <span class="stringliteral">&quot;%21.15g &quot;</span>, <a class="code" href="../../d8/d5b/defs_8general_8h.html#a4ab74e6392365dba9b6ef98fd4d9d995">sourceadd_tot</a>[pl]);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        myfprintf(ener_file, <span class="stringliteral">&quot;%21.15g %21.15g &quot;</span>, divbmax,divbavg);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#a702c3f736ffae96949fb85f091aff230">DODISS</a>) <span class="keywordflow">for</span>(dissloop=0;dissloop&lt;<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#adde832aa14a494487d47d4fed8268966" title="totals:">NUMDISSVERSIONS</a>;dissloop++) myfprintf(ener_file, <span class="stringliteral">&quot;%21.15g &quot;</span>, diss_tot[dissloop]);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">for</span>(dissloop=0;dissloop&lt;<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#adde832aa14a494487d47d4fed8268966" title="totals:">NUMDISSVERSIONS</a>;dissloop++) myfprintf(ener_file, <span class="stringliteral">&quot;%21.15g &quot;</span>, -1.0); <span class="comment">// dummy space holder</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      }</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      <span class="comment">// FLENER FILE (dir, pl, and linear summed terms for flux, floor, and source quantities)</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      <span class="comment">// (note the change in ordering for external file read in macros/functions)</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      myfprintf(flener_file,<span class="stringliteral">&quot;%21.15g %ld &quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0b92e4d6197989f0f9b0609c8615a46f">realnstep</a>);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#af276566d52b9239d67b094c949e15889" title="loop over directions">DIRLOOP</a>(dir) <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#af1c67086436007e897bccc458390886f" title="PLOOP controls looping over conserved or primitive -type quantities except during interpolation or ot...">PLOOP</a>(pliter,pl) <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a32e091d76a116b4de3b9263bff415fd1" title="loop over fluxterms">FLLOOP</a>(fl) myfprintf(flener_file, <span class="stringliteral">&quot;%21.15g &quot;</span>, <a class="code" href="../../d8/d5b/defs_8general_8h.html#a0a00e7be389ef42228620aa2b1ef36b3">pdotterms_tot</a>[dir][fl][pl]);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#af1c67086436007e897bccc458390886f" title="PLOOP controls looping over conserved or primitive -type quantities except during interpolation or ot...">PLOOP</a>(pliter,pl) <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#aecfc572a5344bcf7fa1a22b51db76b71" title="loop over fair/floor types">FLOORLOOP</a>(floor) myfprintf(flener_file, <span class="stringliteral">&quot;%21.15g &quot;</span>, <a class="code" href="../../d8/d5b/defs_8general_8h.html#a7971d92df68fc035a35d3eb714aadbb4">fladdterms_tot</a>[floor][pl]);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#af1c67086436007e897bccc458390886f" title="PLOOP controls looping over conserved or primitive -type quantities except during interpolation or ot...">PLOOP</a>(pliter,pl) <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a2da8b12fca78064531b9b64e5699e4fc" title="loop over ALL sources (including geometry)">SCLOOP</a>(sc) myfprintf(flener_file, <span class="stringliteral">&quot;%21.15g &quot;</span>, <a class="code" href="../../d8/d5b/defs_8general_8h.html#a8ec5678abebade16c9df0e2d5cdb6a6c">sourceaddterms_tot</a>[sc][pl]);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      <span class="keywordflow">if</span>(enerregion==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#adc05fc600cb51df792150fc73fa883f7">GLOBALENERREGION</a>){ <span class="comment">// only for total region for now</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <span class="comment">// only care about inner and outer radial part</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <span class="keywordflow">for</span>(dir=0;dir&lt;=1;dir++) <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#af1c67086436007e897bccc458390886f" title="PLOOP controls looping over conserved or primitive -type quantities except during interpolation or ot...">PLOOP</a>(pliter,pl) <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a32e091d76a116b4de3b9263bff415fd1" title="loop over fluxterms">FLLOOP</a>(fl) myfprintf(flener_file, <span class="stringliteral">&quot;%21.15g &quot;</span>, pdottermsjet2_tot[dir][fl][pl]); <span class="comment">// jet/pole values only</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#a6c2751c5217b428c5f5faf66a08e2d90" title="0: don&#39;t do calculation 1: do">DOLUMVSR</a>){</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;          <span class="comment">// luminosity vs radius</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;          myfprintf(lumener_file,<span class="stringliteral">&quot;%21.15g %ld &quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0b92e4d6197989f0f9b0609c8615a46f">realnstep</a>);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;          <span class="keywordflow">for</span>(ii=0;ii&lt;<a class="code" href="../../dd/d46/mpidefs_8h.html#a849af7562e98534cd4ea5764f5187bbd">ncpux1</a>*<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>;ii++) myfprintf(lumener_file, <span class="stringliteral">&quot;%21.15g &quot;</span>, <a class="code" href="../../d8/d5b/defs_8general_8h.html#a124c703e3c349fa1c42f6b26dc8ccace">lumvsr_tot</a>[ii]);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        }</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#affb54fad9620541e1fcb17f854af9bfe" title="see diag_source()">DODISSVSR</a>){</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;          <span class="keywordflow">for</span>(dissloop=0;dissloop&lt;<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#adde832aa14a494487d47d4fed8268966" title="totals:">NUMDISSVERSIONS</a>;dissloop++){</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            <span class="comment">// dissipation vs radius</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            myfprintf(dissener_file[dissloop],<span class="stringliteral">&quot;%21.15g %ld &quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0b92e4d6197989f0f9b0609c8615a46f">realnstep</a>);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;            <span class="keywordflow">for</span>(ii=0;ii&lt;<a class="code" href="../../dd/d46/mpidefs_8h.html#a849af7562e98534cd4ea5764f5187bbd">ncpux1</a>*<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>;ii++) myfprintf(dissener_file[dissloop], <span class="stringliteral">&quot;%21.15g &quot;</span>, <a class="code" href="../../d8/d5b/defs_8general_8h.html#a44553fca1670897538d6257b335d7914">dissvsr_tot</a>[dissloop][ii]);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;          }</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        }</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      }</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      <span class="keywordflow">if</span>(enerregion==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ab48e4e45d2434009418d485187e3bdc9" title="&quot;outside&quot; horizon means r&gt;=r_+">OUTSIDEHORIZONENERREGION</a>){ <span class="comment">// only for horizon region for now</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160; </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#a149d0d31999a38ec3870e1e4a4eecf67" title="careful not to use DOMIXTHETAPHI in .h files since init.h might change it.">DOEVOLVEMETRIC</a>){</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;          myfprintf(metricparmsener_file,<span class="stringliteral">&quot;%21.15g %ld &quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0b92e4d6197989f0f9b0609c8615a46f">realnstep</a>);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;          <span class="comment">// below 2 have been subsumed into its own full ener region (should have done in first place!)</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;          <span class="comment">//PLOOP(pliter,pl) myfprintf(metricparmsener_file, &quot;%21.15g &quot;,horizonflux_tot[pl]);</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;          <span class="comment">//PLOOP(pliter,pl) myfprintf(metricparmsener_file, &quot;%21.15g &quot;,horizoncum_tot[pl]);</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;          <span class="comment">// first 2 are cumulative black hole mass and J in black hole metric units</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;          <span class="comment">// next 1 is what black hole mass would be if adding so-far cumulated mass</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;          <span class="comment">// next 1 is a if adding so-far mass and angular momentum</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;          <span class="comment">// next 1 is j=a/M if adding so-far mass and angular momentum</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;          <span class="comment">// next several items are original and present actual mass, a, j, Q, and q</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;          <span class="comment">// by this time of the diagnostics, dE, dJ include horizon flux but MBH and a aren&#39;t yet updated.</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;          <span class="comment">// however, horizoncum_tot IS updated so that for this enerregion u0-horizoncum_tot[0] is conserved exactly</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;          myfprintf(metricparmsener_file,<span class="stringliteral">&quot;%21.15g %21.15g %21.15g %21.15g %21.15g %21.15g %21.15g %21.15g %21.15g %21.15g %21.15g %21.15g %21.15g %21.15g %21.15g %21.15g %21.15g %21.15g %21.15g %21.15g %21.15g %21.15g %21.15g %21.15g %21.15g %d &quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a1764b81f8e8d4337c9ac6b6c618a8e43">dE</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#af8914916405b4022372a86e27b6c9a53">dJ</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a1c7a46e6336f8a47446a7f7d71e29d4d">MBH0</a>+<a class="code" href="../../d8/d5b/defs_8general_8h.html#a1764b81f8e8d4337c9ac6b6c618a8e43">dE</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0263710807f02d8418758c4e3e46bc4e">a0</a>+<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2e1f63ba60e8b09e99c4b01c138c7474">dabh</a>,(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0263710807f02d8418758c4e3e46bc4e">a0</a>+<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2e1f63ba60e8b09e99c4b01c138c7474">dabh</a>)/(<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a09c78d2f8feb311dd9fc969a0bf84979">SMALL</a>+<a class="code" href="../../d8/d5b/defs_8general_8h.html#a1c7a46e6336f8a47446a7f7d71e29d4d">MBH0</a>+<a class="code" href="../../d8/d5b/defs_8general_8h.html#a1764b81f8e8d4337c9ac6b6c618a8e43">dE</a>),<a class="code" href="../../d8/d5b/defs_8general_8h.html#a1c7a46e6336f8a47446a7f7d71e29d4d">MBH0</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a1fb64169459d57727a61a72b6e01ced5">MBH</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0263710807f02d8418758c4e3e46bc4e">a0</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0263710807f02d8418758c4e3e46bc4e">a0</a>/(<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a09c78d2f8feb311dd9fc969a0bf84979">SMALL</a>+<a class="code" href="../../d8/d5b/defs_8general_8h.html#a1c7a46e6336f8a47446a7f7d71e29d4d">MBH0</a>),a,a/(<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a09c78d2f8feb311dd9fc969a0bf84979">SMALL</a>+<a class="code" href="../../d8/d5b/defs_8general_8h.html#a1fb64169459d57727a61a72b6e01ced5">MBH</a>),<a class="code" href="../../d8/d5b/defs_8general_8h.html#ac2458c82775ea2fbba5cd1a289b7779d">QBH0</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#ac2458c82775ea2fbba5cd1a289b7779d">QBH0</a>/(<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a09c78d2f8feb311dd9fc969a0bf84979">SMALL</a>+<a class="code" href="../../d8/d5b/defs_8general_8h.html#a1c7a46e6336f8a47446a7f7d71e29d4d">MBH0</a>),<a class="code" href="../../d8/d5b/defs_8general_8h.html#a60c2aa47ffa41453bf4afb2c19ac2a4e">QBH</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a60c2aa47ffa41453bf4afb2c19ac2a4e">QBH</a>/(<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a09c78d2f8feb311dd9fc969a0bf84979">SMALL</a>+<a class="code" href="../../d8/d5b/defs_8general_8h.html#a1fb64169459d57727a61a72b6e01ced5">MBH</a>),<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa2c1ce9d27f3d7c1b1d9eeb4d89d3401">EP30</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa2c1ce9d27f3d7c1b1d9eeb4d89d3401">EP30</a>/(<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a09c78d2f8feb311dd9fc969a0bf84979">SMALL</a>+<a class="code" href="../../d8/d5b/defs_8general_8h.html#a1c7a46e6336f8a47446a7f7d71e29d4d">MBH0</a>),<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2f09f0f07c81c40846f158024b125ed0">EP3</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2f09f0f07c81c40846f158024b125ed0">EP3</a>/(<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a09c78d2f8feb311dd9fc969a0bf84979">SMALL</a>+<a class="code" href="../../d8/d5b/defs_8general_8h.html#a1fb64169459d57727a61a72b6e01ced5">MBH</a>),<a class="code" href="../../d8/d5b/defs_8general_8h.html#a5bd32ec33416c5c0212739cbb02ed2f4">THETAROT0</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a5bd32ec33416c5c0212739cbb02ed2f4">THETAROT0</a>/(<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a09c78d2f8feb311dd9fc969a0bf84979">SMALL</a>+<a class="code" href="../../d8/d5b/defs_8general_8h.html#a1c7a46e6336f8a47446a7f7d71e29d4d">MBH0</a>),<a class="code" href="../../d8/d5b/defs_8general_8h.html#af850e395071231822a385de91849efd3">THETAROT</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#af850e395071231822a385de91849efd3">THETAROT</a>/(<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a09c78d2f8feb311dd9fc969a0bf84979">SMALL</a>+<a class="code" href="../../d8/d5b/defs_8general_8h.html#a1fb64169459d57727a61a72b6e01ced5">MBH</a>),<a class="code" href="../../d8/d5b/defs_8general_8h.html#a20e81ef2343c6d8db701c6613cbcd279">Rhor</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a13eb494465126d4aa3e4d7657b9ff6ca">Risco</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a3ac70e0bc8f102cca400733fb37c3f54" title="end changes after ...">horizoni</a>+<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>*<a class="code" href="../../d8/d5b/defs_8general_8h.html#a58b9fa3befcf1cde8e143386173d5960">horizoncpupos1</a>);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        }</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#af35efc27e405b7c3e2c95df8f7559a07" title="#define WHICHENTROPYEVOLVE EVOLVEFULLENTROPY">DOSELFGRAVVSR</a>){</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;          <span class="comment">// self-gravitational potential vs radius</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;          fileiter=0;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;          myfprintf(selfgravener_file[fileiter],<span class="stringliteral">&quot;%21.15g %ld &quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0b92e4d6197989f0f9b0609c8615a46f">realnstep</a>);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;          <a class="code" href="../../d9/d37/global_8loops_8manypoints1d_8h.html#a73b76a83b8fd5db79671d0107df97dd4">DUMPGRAVLOOP</a>(ii) myfprintf(selfgravener_file[fileiter], <span class="stringliteral">&quot;%21.15g &quot;</span>, <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac13a98dcfba120d979164962aefc1ec7">rcent_tot</a>[ii]);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;          <span class="comment">// just self-gravitating part of Mvsr</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;          fileiter=1;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;          myfprintf(selfgravener_file[fileiter],<span class="stringliteral">&quot;%21.15g %ld &quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0b92e4d6197989f0f9b0609c8615a46f">realnstep</a>);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;          <a class="code" href="../../d9/d37/global_8loops_8manypoints1d_8h.html#a73b76a83b8fd5db79671d0107df97dd4">DUMPGRAVLOOP</a>(ii) myfprintf(selfgravener_file[fileiter], <span class="stringliteral">&quot;%21.15g &quot;</span>, <a class="code" href="../../d8/d5b/defs_8general_8h.html#acb5b3a91024538974a3d5e6ada6927ab">Mvsr_tot</a>[ii]);</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;          <span class="comment">// true Mvsr with &quot;point&quot; mass included</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;          fileiter=2;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;          myfprintf(selfgravener_file[fileiter],<span class="stringliteral">&quot;%21.15g %ld &quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0b92e4d6197989f0f9b0609c8615a46f">realnstep</a>);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;          <a class="code" href="../../d9/d37/global_8loops_8manypoints1d_8h.html#a73b76a83b8fd5db79671d0107df97dd4">DUMPGRAVLOOP</a>(ii) myfprintf(selfgravener_file[fileiter], <span class="stringliteral">&quot;%21.15g &quot;</span>, <a class="code" href="../../d8/d5b/defs_8general_8h.html#a1fb64169459d57727a61a72b6e01ced5">MBH</a>+<a class="code" href="../../d8/d5b/defs_8general_8h.html#acb5b3a91024538974a3d5e6ada6927ab">Mvsr_tot</a>[ii]);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;          <span class="comment">// self-gravitating part of phivsr</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;          fileiter=3;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;          myfprintf(selfgravener_file[fileiter],<span class="stringliteral">&quot;%21.15g %ld &quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0b92e4d6197989f0f9b0609c8615a46f">realnstep</a>);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;          <a class="code" href="../../d9/d37/global_8loops_8manypoints1d_8h.html#a73b76a83b8fd5db79671d0107df97dd4">DUMPGRAVLOOP</a>(ii) myfprintf(selfgravener_file[fileiter], <span class="stringliteral">&quot;%21.15g &quot;</span>, <a class="code" href="../../d8/d5b/defs_8general_8h.html#a6dfbbf77bc41b0290beace2250e468bd">phivsr_tot</a>[ii]);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;          <span class="comment">// true phivsr that comes into g_{tt} = -exp(2\phi)</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;          fileiter=4;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;          myfprintf(selfgravener_file[fileiter],<span class="stringliteral">&quot;%21.15g %ld &quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0b92e4d6197989f0f9b0609c8615a46f">realnstep</a>);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;          <a class="code" href="../../d9/d37/global_8loops_8manypoints1d_8h.html#a73b76a83b8fd5db79671d0107df97dd4">DUMPGRAVLOOP</a>(ii){</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            phibh = phibh_compute(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a1fb64169459d57727a61a72b6e01ced5">MBH</a>,a,<a class="code" href="../../d8/d5b/defs_8general_8h.html#ac13a98dcfba120d979164962aefc1ec7">rcent_tot</a>[ii], M_PI*0.5);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            <span class="keywordflow">if</span>(!<a class="code" href="../../d8/df4/global_8funcdeclare_8h.html#a9d578d6f7714cd0ca219fc3be5f34422" title="SUPERLONGDOUBLE declarations.">isfinite</a>(phibh)) phibh=-<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a38eb76aa0a9a1bb1dac30c75be4a05b6">BIG</a>; <span class="comment">// in reality g_{tt} stays well-defined</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            myfprintf(selfgravener_file[fileiter], <span class="stringliteral">&quot;%21.15g &quot;</span>, phibh+<a class="code" href="../../d8/d5b/defs_8general_8h.html#a6dfbbf77bc41b0290beace2250e468bd">phivsr_tot</a>[ii]);</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;          }</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;          fileiter=5;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;          myfprintf(selfgravener_file[fileiter],<span class="stringliteral">&quot;%21.15g %ld &quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0b92e4d6197989f0f9b0609c8615a46f">realnstep</a>);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;          <a class="code" href="../../d9/d37/global_8loops_8manypoints1d_8h.html#a73b76a83b8fd5db79671d0107df97dd4">DUMPGRAVLOOP</a>(ii) myfprintf(selfgravener_file[fileiter], <span class="stringliteral">&quot;%21.15g &quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa2da6ec3918c854607b2db601a91df9e">dTrrvsr_tot</a>[ii]);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;          fileiter=6;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;          myfprintf(selfgravener_file[fileiter],<span class="stringliteral">&quot;%21.15g %ld &quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0b92e4d6197989f0f9b0609c8615a46f">realnstep</a>);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;          <a class="code" href="../../d9/d37/global_8loops_8manypoints1d_8h.html#a73b76a83b8fd5db79671d0107df97dd4">DUMPGRAVLOOP</a>(ii) myfprintf(selfgravener_file[fileiter], <span class="stringliteral">&quot;%21.15g &quot;</span>, <a class="code" href="../../d8/d5b/defs_8general_8h.html#a6e4f432380b068b52cf3c5446268eb98">dVvsr_tot</a>[ii]);</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;          fileiter=7;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;          myfprintf(selfgravener_file[fileiter],<span class="stringliteral">&quot;%21.15g %ld &quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0b92e4d6197989f0f9b0609c8615a46f">realnstep</a>);</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;          <a class="code" href="../../d9/d37/global_8loops_8manypoints1d_8h.html#a73b76a83b8fd5db79671d0107df97dd4">DUMPGRAVLOOP</a>(ii) myfprintf(selfgravener_file[fileiter], <span class="stringliteral">&quot;%21.15g &quot;</span>, <a class="code" href="../../d8/d5b/defs_8general_8h.html#aecd8ef56f647bc4f2c6612e35538cfa7">vrsqvsr_tot</a>[ii]);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;          fileiter=8;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;          myfprintf(selfgravener_file[fileiter],<span class="stringliteral">&quot;%21.15g %ld &quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0b92e4d6197989f0f9b0609c8615a46f">realnstep</a>);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;          <a class="code" href="../../d9/d37/global_8loops_8manypoints1d_8h.html#a73b76a83b8fd5db79671d0107df97dd4">DUMPGRAVLOOP</a>(ii) myfprintf(selfgravener_file[fileiter], <span class="stringliteral">&quot;%21.15g &quot;</span>, <a class="code" href="../../d8/d5b/defs_8general_8h.html#a333b185d0b11445f3a880125e7462f5f">Jvsr_tot</a>[ii]);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        }</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;      }</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      <span class="keywordflow">if</span>(enerregion==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#adc05fc600cb51df792150fc73fa883f7">GLOBALENERREGION</a>){ <span class="comment">// only for total region for now</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        <span class="comment">// PROBE FILE</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="../../da/d0d/dump__ener_8c.html#af02a237a6625e7277c7861e752c136de">PROBEFILE</a>&amp;&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#afbca4918ea5a00b04a471d39f4760924">DOENERDIAG</a>){</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;          <span class="comment">// !!per CPU!! probe file NPRDUMP*3 terms</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;          <span class="comment">//</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment"></span><span class="preprocessor">#define ITER1 MAX(N1/4,1)</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define ITER2 MAX(N2/4,1)</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define ITER3 MAX(N3/4,1)</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="preprocessor"></span>          <span class="comment">// 2D probe</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;          <span class="comment">// k  = N3/2+1; for(i=0;i&lt;N1;i+=ITER1) for(j=0;j&lt;N2;j+=ITER2){</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;          <span class="keywordflow">for</span>(i=0;i&lt;<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>;i+=<a class="code" href="../../da/d0d/dump__ener_8c.html#a44e4ab3b375db5077081a7f6d0554d55">ITER1</a>) <span class="keywordflow">for</span>(j=0;j&lt;<a class="code" href="../../da/d3e/definit_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a>;j+=<a class="code" href="../../da/d0d/dump__ener_8c.html#a5c247283713ba6880b9c10384d56828b">ITER2</a>) <span class="keywordflow">for</span>(k=0;k&lt;<a class="code" href="../../da/d3e/definit_8h.html#ad66109fbdc4d3adc9c3d6ff917038aef">N3</a>;k+=<a class="code" href="../../da/d0d/dump__ener_8c.html#ace0e0baee4f4ebad4c7a5e69f4a80e46">ITER3</a>){</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                <span class="comment">// 2D probe (consistent with original SM macro)</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                <span class="comment">//   PDUMPLOOP(pliter,pl) fprintf(probe_file, &quot;%d %d %d %ld %21.15g %21.15g\n&quot;,startpos[1]+i,startpos[2]+j,pl,realnstep, t, GLOBALMACP0A1(p,i,j,k,pl));</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                <span class="comment">// 3d probe</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#ae5cfc6e24a72485e160567ca888fd6b8" title="loop over all dumped Primitive variables">PDUMPLOOP</a>(pliter,pl) fprintf(probe_file, <span class="stringliteral">&quot;%d %d %d %d %ld %21.15g %21.15g\n&quot;</span>,<a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[1]+i,<a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[2]+j,<a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[3]+k,pl,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0b92e4d6197989f0f9b0609c8615a46f">realnstep</a>, <a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>, GLOBALMACP0A1(pdump,i,j,k,pl));</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;              }</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;          fflush(probe_file);</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        }</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        <span class="comment">// DEBUG FILE</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#aefc47346bd5140a39b6d744385796e56" title="0: don&#39;t output debug dump file or ener file(ener is based on dump counts) 1: do">DODEBUG</a>){</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;          myfprintf(debug_file,<span class="stringliteral">&quot;%21.15g %ld &quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0b92e4d6197989f0f9b0609c8615a46f">realnstep</a>);</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;          myfprintf(debug_file,<span class="stringliteral">&quot;%21.15g %21.15g &quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a56db625f31229c5e8b208ff27d464931">dt</a>, 1.0*<a class="code" href="../../d8/d5b/defs_8general_8h.html#a5f1c4a4bf07f7a6010404484cb9e6b50">nstroke</a>/(2.0*<a class="code" href="../../dd/d46/mpidefs_8h.html#a38e1083345af2cf99e31d941f18b56ad">totalzones</a>));</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;          myfprintf(debug_file,<span class="stringliteral">&quot;%21.15g %21.15g %21.15g &quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0e73706eb0db019d8fa67c66f41d93d6">wavedtglobal</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0a7150593e8f78afd7a91cfb19edab08">sourcedtglobal</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae58178ca76ba1f6fd135877e28ca1409">gravitydtglobal</a>);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;          myfprintf(debug_file,<span class="stringliteral">&quot;%d %d %d &quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a60004d0cf271a3424b7d088a58535ca3">waveglobaldti</a>[1],<a class="code" href="../../d8/d5b/defs_8general_8h.html#a3150634683ba5433c6fe8c3d0eda69fb">waveglobaldtj</a>[1],<a class="code" href="../../d8/d5b/defs_8general_8h.html#ab3c7e902be71f8882765fe0a88986925">waveglobaldtk</a>[1]);</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;          myfprintf(debug_file,<span class="stringliteral">&quot;%d %d %d &quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a60004d0cf271a3424b7d088a58535ca3">waveglobaldti</a>[2],<a class="code" href="../../d8/d5b/defs_8general_8h.html#a3150634683ba5433c6fe8c3d0eda69fb">waveglobaldtj</a>[2],<a class="code" href="../../d8/d5b/defs_8general_8h.html#ab3c7e902be71f8882765fe0a88986925">waveglobaldtk</a>[2]);</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;          myfprintf(debug_file,<span class="stringliteral">&quot;%d %d %d &quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a60004d0cf271a3424b7d088a58535ca3">waveglobaldti</a>[3],<a class="code" href="../../d8/d5b/defs_8general_8h.html#a3150634683ba5433c6fe8c3d0eda69fb">waveglobaldtj</a>[3],<a class="code" href="../../d8/d5b/defs_8general_8h.html#ab3c7e902be71f8882765fe0a88986925">waveglobaldtk</a>[3]);</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;          myfprintf(debug_file,<span class="stringliteral">&quot;%d %d &quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a3ac70e0bc8f102cca400733fb37c3f54" title="end changes after ...">horizoni</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a58b9fa3befcf1cde8e143386173d5960">horizoncpupos1</a>);</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;          <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a109c0007f7542c45c42b16a82239df74">FAILFLOORLOOP</a>(indexfinalstep,tscale,floor){</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="preprocessor">#if(COUNTTYPE==LONGLONGINTTYPE)</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="preprocessor"></span>            myfprintf(debug_file, <span class="stringliteral">&quot;%lld &quot;</span>, <a class="code" href="../../d8/d5b/defs_8general_8h.html#a7db48a9cd90ac0af7bab5863b55e0c7a">failfloorcountlocal_tot</a>[indexfinalstep][tscale][floor]);</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="preprocessor">#elif(COUNTTYPE==DOUBLETYPE)</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="preprocessor"></span>            myfprintf(debug_file, <span class="stringliteral">&quot;%21.15g &quot;</span>, <a class="code" href="../../d8/d5b/defs_8general_8h.html#a7db48a9cd90ac0af7bab5863b55e0c7a">failfloorcountlocal_tot</a>[indexfinalstep][tscale][floor]);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="preprocessor"></span>          }</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        }</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      }</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      myfprintf(flener_file,<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      myfprintf(ener_file,<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;      myfprintf(gener_file,<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;      <span class="keywordflow">if</span>(enerregion==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#adc05fc600cb51df792150fc73fa883f7">GLOBALENERREGION</a>){</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#a6c2751c5217b428c5f5faf66a08e2d90" title="0: don&#39;t do calculation 1: do">DOLUMVSR</a>) myfprintf(lumener_file,<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#affb54fad9620541e1fcb17f854af9bfe" title="see diag_source()">DODISSVSR</a>)    <span class="keywordflow">for</span>(dissloop=0;dissloop&lt;<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#adde832aa14a494487d47d4fed8268966" title="totals:">NUMDISSVERSIONS</a>;dissloop++) myfprintf(dissener_file[dissloop],<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#aefc47346bd5140a39b6d744385796e56" title="0: don&#39;t output debug dump file or ener file(ener is based on dump counts) 1: do">DODEBUG</a>) myfprintf(debug_file,<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;      }</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;      <span class="keywordflow">if</span>(enerregion==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ab48e4e45d2434009418d485187e3bdc9" title="&quot;outside&quot; horizon means r&gt;=r_+">OUTSIDEHORIZONENERREGION</a>){</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160; </div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#a149d0d31999a38ec3870e1e4a4eecf67" title="careful not to use DOMIXTHETAPHI in .h files since init.h might change it.">DOEVOLVEMETRIC</a>) myfprintf(metricparmsener_file,<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#af35efc27e405b7c3e2c95df8f7559a07" title="#define WHICHENTROPYEVOLVE EVOLVEFULLENTROPY">DOSELFGRAVVSR</a>){</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;          <span class="keywordflow">for</span>(fileiter=0;fileiter&lt;<a class="code" href="../../da/d0d/dump__ener_8c.html#a8699b4c4f847b927d66b469288d85599">NUMSELFGRAV</a>;fileiter++) myfprintf(selfgravener_file[fileiter],<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        }</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;      }</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      trifprintf(<span class="stringliteral">&quot;W%d&quot;</span>,enerregion);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    }<span class="comment">// end if doener // done if writing to file</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="comment">// close the files at end of simulation</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="keywordflow">if</span>(call_code==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a08fc657d6f1d0641abaaea4efd2e3759">FINAL_OUT</a>){</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;      myfclose(&amp;flener_file,<span class="stringliteral">&quot;Couldn&#39;t close flener_file\n&quot;</span>);</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;      <span class="keywordflow">if</span>(1) myfclose(&amp;ener_file,<span class="stringliteral">&quot;Couldn&#39;t close ener_file\n&quot;</span>);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;      <span class="keywordflow">if</span>(1||<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad592700218c6ca4bf0543723ee36d028">GAMMIEENER</a>) myfclose(&amp;gener_file,<span class="stringliteral">&quot;Couldn&#39;t close gener_file\n&quot;</span>);</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      <span class="keywordflow">if</span>(enerregion==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ab48e4e45d2434009418d485187e3bdc9" title="&quot;outside&quot; horizon means r&gt;=r_+">OUTSIDEHORIZONENERREGION</a>){</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#a149d0d31999a38ec3870e1e4a4eecf67" title="careful not to use DOMIXTHETAPHI in .h files since init.h might change it.">DOEVOLVEMETRIC</a>) myfclose(&amp;metricparmsener_file,<span class="stringliteral">&quot;Couldn&#39;t close metricparmsener_file\n&quot;</span>);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#af35efc27e405b7c3e2c95df8f7559a07" title="#define WHICHENTROPYEVOLVE EVOLVEFULLENTROPY">DOSELFGRAVVSR</a>){</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;          <span class="keywordflow">for</span>(fileiter=0;fileiter&lt;<a class="code" href="../../da/d0d/dump__ener_8c.html#a8699b4c4f847b927d66b469288d85599">NUMSELFGRAV</a>;fileiter++) myfclose(&amp;selfgravener_file[fileiter],<span class="stringliteral">&quot;Couldn&#39;t close selfgravener_file\n&quot;</span>);</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        }</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      }</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      <span class="keywordflow">if</span>(enerregion==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#adc05fc600cb51df792150fc73fa883f7">GLOBALENERREGION</a>){</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#a6c2751c5217b428c5f5faf66a08e2d90" title="0: don&#39;t do calculation 1: do">DOLUMVSR</a>) myfclose(&amp;lumener_file,<span class="stringliteral">&quot;Couldn&#39;t close lumener_file\n&quot;</span>);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#affb54fad9620541e1fcb17f854af9bfe" title="see diag_source()">DODISSVSR</a>)    <span class="keywordflow">for</span>(dissloop=0;dissloop&lt;<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#adde832aa14a494487d47d4fed8268966" title="totals:">NUMDISSVERSIONS</a>;dissloop++) myfclose(&amp;dissener_file[dissloop],<span class="stringliteral">&quot;Couldn&#39;t close dissener_file\n&quot;</span>);</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#aefc47346bd5140a39b6d744385796e56" title="0: don&#39;t output debug dump file or ener file(ener is based on dump counts) 1: do">DODEBUG</a>) myfclose(&amp;debug_file,<span class="stringliteral">&quot;Couldn&#39;t close debug_file\n&quot;</span>);</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="../../da/d0d/dump__ener_8c.html#af02a237a6625e7277c7861e752c136de">PROBEFILE</a>&amp;&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#afbca4918ea5a00b04a471d39f4760924">DOENERDIAG</a>) fclose(probe_file);</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;      }</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    }</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  }<span class="comment">// end enerregion loop</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  trifprintf(<span class="stringliteral">&quot;E&quot;</span>);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  firsttime = 0;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <span class="keywordflow">return</span> (0);</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;}</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="keywordtype">void</span> appendener(FILE* ener_file,<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> (*pcum_totvar)[NPR],<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a>*fladd_totvar,<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> *sourceadd_totvar)</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;{</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  <span class="keywordtype">int</span> gotit;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> tcheck;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  <span class="keywordtype">int</span> l,pl,pliter,dir;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  <span class="keywordtype">long</span> fpos0;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  FILE *ener_file_temp;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  <span class="keywordtype">char</span> dfnam[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0947c0a3d28c188caa4497cce08539c9" title="maximum char size of filenames or directories or commands">MAXFILENAME</a>],dfnamback[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0947c0a3d28c188caa4497cce08539c9" title="maximum char size of filenames or directories or commands">MAXFILENAME</a>], dfnamtemp[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0947c0a3d28c188caa4497cce08539c9" title="maximum char size of filenames or directories or commands">MAXFILENAME</a>];</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <span class="comment">// only CPU=0 does anything here</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  <span class="keywordflow">if</span>(myid==0){</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    </div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    rewind(ener_file); <span class="comment">// go to start</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    </div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    gotit = 0;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="keywordflow">while</span> ((!feof(ener_file)) &amp;&amp; (gotit == 0)) {</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      </div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      fscanf(ener_file, <span class="stringliteral">&quot;%lf&quot;</span>, &amp;tcheck);</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      </div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;      <span class="keywordflow">if</span> (fabs(tcheck - <a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>) &lt; 0.5 *<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2edf04580f3ba6725fface8987e5f533">DTdumpgen</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aa5ccd621a6172085ece31d82bcc8b137">ENERDUMPTYPE</a>]) {</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        gotit = 1;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        <span class="keywordflow">for</span> (l = 1; l &lt;= <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac488a2c2a56087b4d35b1d4be6cadab1">NUMENERVAR</a>; l++) {</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;          <span class="keywordflow">if</span> ((l &gt; 3+NPR+<a class="code" href="../../da/d3e/definit_8h.html#a1b2ef8afddd2c5d91ab65015bbd7b80b" title="NUMBER OF DIMENSIONS FOR COMPUTATION Can choose 3 and still do 1D optimized problems Choosing 2 or ev...">COMPDIM</a>*2*NPR) &amp;&amp; (l &lt; 3+NPR+2*<a class="code" href="../../da/d3e/definit_8h.html#a1b2ef8afddd2c5d91ab65015bbd7b80b" title="NUMBER OF DIMENSIONS FOR COMPUTATION Can choose 3 and still do 1D optimized problems Choosing 2 or ev...">COMPDIM</a>*2*NPR+NPR)) {</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;            <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#af276566d52b9239d67b094c949e15889" title="loop over directions">DIRLOOP</a>(dir) <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#af1c67086436007e897bccc458390886f" title="PLOOP controls looping over conserved or primitive -type quantities except during interpolation or ot...">PLOOP</a>(pliter,pl) {</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;              fscanf(ener_file, <span class="stringliteral">&quot;%lf&quot;</span>, &amp;pcum_totvar[dir][pl]);</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;              l++;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;            }</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#af1c67086436007e897bccc458390886f" title="PLOOP controls looping over conserved or primitive -type quantities except during interpolation or ot...">PLOOP</a>(pliter,pl) {</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;              fscanf(ener_file, <span class="stringliteral">&quot;%lf&quot;</span>, &amp;fladd_totvar[pl]);</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;              l++;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;            }</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;            <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#af1c67086436007e897bccc458390886f" title="PLOOP controls looping over conserved or primitive -type quantities except during interpolation or ot...">PLOOP</a>(pliter,pl) {</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;              fscanf(ener_file, <span class="stringliteral">&quot;%lf&quot;</span>, &amp;sourceadd_totvar[pl]);</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;              l++;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;            }</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;          }</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        }</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        <span class="comment">// skip this bad line </span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        <span class="keywordflow">while</span> ((fgetc(ener_file) != <span class="charliteral">&#39;\n&#39;</span>) &amp;&amp; (!feof(ener_file)));</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      }</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;      <span class="comment">// continue after successful get since successful get is good </span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;      <span class="comment">// data and should keep since corresponds to dump one is</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;      <span class="comment">// keeping</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;      fpos0 = ftell(ener_file); <span class="comment">// position to continue</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;      <span class="comment">// writting at if successful get</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    }</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <span class="keywordflow">if</span> (gotit == 0) {</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;      dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                  <span class="stringliteral">&quot;Never found right time in loss file when appending: looking for t=%21.15g lastt=%21.15g\n&quot;</span>,</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                  <a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>, tcheck);</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;      myexit(1);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;      dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa5d0f5183b267927d3eb00692224be5b">logfull_file</a>,</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                  <span class="stringliteral">&quot;found goodtime t=%21.15g (wanted %21.15g) to restart ener file\n&quot;</span>,</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                  tcheck, <a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>);</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      sprintf(dfnamtemp, <span class="stringliteral">&quot;%s0_ener%s.temp&quot;</span>, <a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#a17897dbbc6ff46c90212d087f60f38c4" title="#define DATADIR &quot;./&quot;">DATADIR</a>, <span class="stringliteral">&quot;.out&quot;</span>);</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;      sprintf(dfnam, <span class="stringliteral">&quot;%sener%s&quot;</span>, <a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#a17897dbbc6ff46c90212d087f60f38c4" title="#define DATADIR &quot;./&quot;">DATADIR</a>, <span class="stringliteral">&quot;.out&quot;</span>);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;      sprintf(dfnamback, <span class="stringliteral">&quot;%s0_ener%s.back&quot;</span>, <a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#a17897dbbc6ff46c90212d087f60f38c4" title="#define DATADIR &quot;./&quot;">DATADIR</a>, <span class="stringliteral">&quot;.out&quot;</span>);</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;      </div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;      <span class="comment">// now that done, fix up file</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;      <span class="keywordflow">if</span> ((ener_file_temp = fopen(dfnamtemp, <span class="stringliteral">&quot;wt&quot;</span>)) == NULL) {</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                    <span class="stringliteral">&quot;Cannot open temp ener file for appending: %s\n&quot;</span>,</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                    dfnamtemp);</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        myexit(1);</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        rewind(ener_file);</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        <span class="keywordflow">while</span> (ftell(ener_file) &lt; fpos0 + 1) { <span class="comment">// +1 is for</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;          <span class="comment">// &#39;\n&#39; at end</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;          <span class="comment">// of line</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;          fputc(fgetc(ener_file), ener_file_temp);</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        }</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        fclose(ener_file_temp);</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        fclose(ener_file);</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        rename(dfnam, dfnamback); <span class="comment">// move old to backup location</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        rename(dfnamtemp, dfnam); <span class="comment">// move new to old name(normal</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        <span class="comment">// name)</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        <span class="comment">// reopen loss_file (now normal name)</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        <span class="keywordflow">if</span> ((ener_file = fopen(dfnam, <span class="stringliteral">&quot;at&quot;</span>)) == NULL) {</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;          dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                      <span class="stringliteral">&quot;2: error opening ener output file %s\n&quot;</span>, dfnam);</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;          myexit(1);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        }</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        trifprintf(<span class="stringliteral">&quot;End setup of ener file append\n&quot;</span>);</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      }   <span class="comment">// end else if can open temp file</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    }   <span class="comment">// end else if gotit==1</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  }</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;}</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="keywordtype">void</span> divbmaxavg(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*prim)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>*ptrdivbmax,<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>*ptrdivbavg)</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;{</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#ad21ff679aac3fe28202c6d592eafd3e6">i</a>,<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>,k;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  <span class="keywordtype">int</span> imax=0,jmax=0,kmax=0;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> divb;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> divbmax=0,divbavg=0;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> divbmaxsend,divbavgsend;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  <a class="code" href="../../da/db2/global_8loops_8manypoints_8h.html#a9f1e56891d194a2292ae57245a249f8a" title="divb loop (for diagnostics only)">LOOPDIVB</a> { <span class="comment">// diagonostic loop // OPENMPOPTMARK: Could optimize this, but not frequently done</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="comment">// avoid measuring divb=0 where don&#39;t treat fluxes</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../d2/dbf/metric_8h.html#a720c791e54d46bbf744b0e3ed7050947">ISSPCMCOORD</a>(<a class="code" href="../../da/d3e/definit_8h.html#ab343edb2f60f3de2d654dcf1c58e06a2" title="#else define MAXBND 3 endif">MCOORD</a>) &amp;&amp; (<a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[1]+i&gt;=<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1]-1 || <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[1]+i&lt;0) ) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    </div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="comment">// doesn&#39;t need geom, just use global gdet</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="comment">// GODMARK: use of globals (for diagnostic this is probably ok)</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <a class="code" href="../../d3/d72/fluxvpot_8c.html#a7277508d423fdc259aa198871f944927" title="find divb if higher order method, then must use conserved value U[] assumed to then exist and be used...">setfdivb</a>(&amp;divb, prim, <a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pstagdump), <a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(udump), <a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(Bhatdump), i, j, k); <span class="comment">// udump set externally GODMARK</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="keywordflow">if</span> (divb &gt; divbmax) {</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      imax = <a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#ad21ff679aac3fe28202c6d592eafd3e6">i</a>;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;      jmax = <a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;      kmax = k;</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      divbmax = divb;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    }</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    divbavg += divb;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  }</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  <span class="comment">// PER CPU</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  logfprintf(<span class="stringliteral">&quot;  proc: %04d : divbmax: %d %d %d : %21.15g divbavg: %21.15g\n&quot;</span>, myid, imax, jmax, kmax, divbmax, divbavg / ((<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>) (<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>*<a class="code" href="../../da/d3e/definit_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a>*<a class="code" href="../../da/d3e/definit_8h.html#ad66109fbdc4d3adc9c3d6ff917038aef">N3</a>)));</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="preprocessor">#if(USEMPI)   // give CPU=0 total</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="preprocessor"></span>  divbmaxsend = divbmax;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  divbavgsend = divbavg;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="preprocessor">#if USINGORANGE == 1</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="preprocessor"></span>  MPI_Barrier(MPI_COMM_GRMHD); <span class="comment">// GODMARK: OpenMP on Orange crashes without this</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="preprocessor"></span>  MPI_Reduce(&amp;divbmaxsend, &amp;divbmax, 1, MPI_FTYPE, MPI_MAX, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="preprocessor">#if USINGORANGE == 1</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="preprocessor"></span>  MPI_Barrier(MPI_COMM_GRMHD); <span class="comment">// GODMARK: OpenMP on Orange crashes without this</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="preprocessor"></span>  MPI_Reduce(&amp;divbavgsend, &amp;divbavg, 1, MPI_FTYPE, MPI_SUM, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="preprocessor">#if USINGORANGE == 1</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="preprocessor"></span>  MPI_Barrier(MPI_COMM_GRMHD); <span class="comment">// GODMARK: OpenMP on Orange crashes without this</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="preprocessor"></span>  divbavg /= (<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>) (<a class="code" href="../../dd/d46/mpidefs_8h.html#a38e1083345af2cf99e31d941f18b56ad">totalzones</a>);</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  <span class="comment">// Total over all CPUs</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  myfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa5d0f5183b267927d3eb00692224be5b">logfull_file</a>,<span class="stringliteral">&quot;  divbmax: %21.15g divbavg: %21.15g\n&quot;</span>,divbmax, divbavg);</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  *ptrdivbmax=divbmax;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  *ptrdivbavg=divbavg;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;}</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="keywordtype">void</span> setrestart(<span class="keywordtype">int</span>*appendoldvar)</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;{</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  *appendoldvar = 0;</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  <span class="comment">// 0: deal with ener.out manually</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  <span class="comment">// 1: append automatically (no longer used)</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;}</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="keywordtype">void</span> gettotal(<span class="keywordtype">int</span> doall, <span class="keywordtype">int</span> numvars, <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a>* vars[],<span class="keywordtype">int</span>*sizes,<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a>*vars_tot[])</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;{</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>,k;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> *ptrsend;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> send;</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  <span class="keywordtype">int</span> didmalloc;</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160; </div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  <span class="comment">// for 1 CPU</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../dd/d46/mpidefs_8h.html#a31bfe068640b411bea3df0d69177ded5">numprocs</a> == 1) {</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    <span class="comment">// must use _tot since can&#39;t overwrite normal global integrator </span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <span class="comment">// variable</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    <span class="keywordflow">for</span>(k=0;k&lt;numvars;k++){</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;      <span class="keywordflow">for</span>(j=0;j&lt;sizes[k];j++){</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        vars_tot[k][<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>] = vars[k][<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>];</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;      }</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    }</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    <span class="comment">// give CPU=0 the totals</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;<span class="preprocessor">#if(USEMPI)</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <span class="keywordflow">for</span>(k=0;k&lt;numvars;k++){</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;      didmalloc=0;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;      <span class="comment">// at least assume each pointer is a continuous array of memory and avoid extra MPI_Reduce()&#39;s</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;      <span class="comment">// send and receive can&#39;t be same address, hence &quot;ptrsend&quot; variable</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;      <span class="keywordflow">if</span>(&amp;vars[k][0] == &amp;vars_tot[k][0]){</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        <span class="comment">// then need to make scratch space since send and recieve can&#39;t be same address</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        <span class="comment">// assume not too large</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        ptrsend = (<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a>*) malloc(sizes[k]*<span class="keyword">sizeof</span>(<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a>));</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        <span class="keywordflow">if</span>(ptrsend==NULL){</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;          dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Couldn&#39;t get memory for ptrsend in gettotal with k=%d numvars=%d sizes=%d\n&quot;</span>,k,numvars,sizes[k]);</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;          myexit(496365763);</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        }</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        didmalloc=1;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        <span class="comment">// now copy over to temporary space</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        <span class="keywordflow">for</span>(j=0;j&lt;sizes[k];j++){</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;          ptrsend[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>] = vars[k][<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>];</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        }</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      }</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        <span class="comment">// input and output not same space so can use vars directly as input</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        ptrsend = &amp;vars[k][0];</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      }</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;      <span class="keywordflow">if</span>(doall==0) MPI_Reduce(ptrsend, &amp;vars_tot[k][0], sizes[k], MPI_SFTYPE, MPI_SUM, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;      <span class="keywordflow">else</span> MPI_Allreduce(ptrsend, &amp;vars_tot[k][0], sizes[k], MPI_SFTYPE, MPI_SUM, MPI_COMM_GRMHD);</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;      <span class="comment">// free malloc&#39;ed memory</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;      <span class="keywordflow">if</span>(didmalloc) free(ptrsend);</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;      <span class="comment">// OLD WAY:</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;      <span class="comment">//      for(j=0;j&lt;sizes[k];j++){</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;      <span class="comment">// send=vars[k][j];</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;      <span class="comment">// // send and receive can&#39;t be same address, hence &quot;send&quot; variable</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;      <span class="comment">// MPI_Reduce(&amp;send, &amp;vars_tot[k][j], 1, MPI_SFTYPE, MPI_SUM, MPIid[0], MPI_COMM_GRMHD);</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;      <span class="comment">//      }</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    } <span class="comment">// end loop over pointers [k]</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="preprocessor"></span>  }</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;}</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="keywordtype">void</span> getalltotal(<span class="keywordtype">int</span> numvars, <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a>* vars[],<span class="keywordtype">int</span>*sizes,<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a>*vars_tot[])</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;{</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>,k;</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> send;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;  </div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  <span class="comment">// for 1 CPU</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../dd/d46/mpidefs_8h.html#a31bfe068640b411bea3df0d69177ded5">numprocs</a> == 1) {</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <span class="comment">// must use _tot since can&#39;t overwrite normal global integrator </span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <span class="comment">// variable</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    <span class="keywordflow">for</span>(k=0;k&lt;numvars;k++){</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;      <span class="keywordflow">for</span>(j=0;j&lt;sizes[k];j++){</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        vars_tot[k][<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>] = vars[k][<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>];</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;      }</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    }</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <span class="comment">// give all CPUs the totals</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="preprocessor">#if(USEMPI)</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">for</span>(k=0;k&lt;numvars;k++){</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;      <span class="keywordflow">for</span>(j=0;j&lt;sizes[k];j++){</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        send=vars[k][<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>];</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        <span class="comment">// send and receive can&#39;t be same address, hence &quot;send&quot; variable</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        <span class="comment">// GODMARK: This could be optimized like gettotal, but not necessary for now since only used with CUMULATIVETYPE3 and not used right now</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        MPI_Allreduce(&amp;send, &amp;vars_tot[k][j], 1, MPI_SFTYPE, MPI_SUM, MPI_COMM_GRMHD);</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;      }</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    }</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="preprocessor"></span>  }</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;}</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="keywordtype">void</span> gettotall(<span class="keywordtype">int</span> numvars, CTYPE* vars[],<span class="keywordtype">int</span>*sizes,CTYPE *vars_tot[])</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;{</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>,k;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;  CTYPE send;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;  </div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  <span class="comment">// for 1 CPU</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../dd/d46/mpidefs_8h.html#a31bfe068640b411bea3df0d69177ded5">numprocs</a> == 1) {</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <span class="comment">// must use _tot since can&#39;t overwrite normal global integrator </span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <span class="comment">// variable</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    <span class="keywordflow">for</span>(k=0;k&lt;numvars;k++){</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;      <span class="keywordflow">for</span>(j=0;j&lt;sizes[k];j++){</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        vars_tot[k][<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>] = vars[k][<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>];</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;      }</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    }</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    <span class="comment">// give CPU=0 the totals</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="preprocessor">#if(USEMPI)</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">for</span>(k=0;k&lt;numvars;k++){</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;      <span class="keywordflow">for</span>(j=0;j&lt;sizes[k];j++){</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        send=vars[k][<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>];</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;        <span class="comment">// send and receive can&#39;t be same address, hence &quot;send&quot; variable</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        MPI_Reduce(&amp;send, &amp;vars_tot[k][j], 1, MPI_CTYPE, MPI_SUM, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;      }</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    }</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="preprocessor"></span>  }</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;}</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="keywordtype">int</span> constotal(<span class="keywordtype">int</span> enerregion, <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> *vars)</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;{</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#ad21ff679aac3fe28202c6d592eafd3e6">i</a>,<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>,k,pl,pliter;</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> U[NPR];</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  <span class="keyword">struct </span><a class="code" href="../../d1/d83/structof__state.html" title="state structure">of_state</a> q;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> ftemp[NPR];</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  <span class="keyword">struct </span><a class="code" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae" title="typedef struct of_geom struct of_compgeom; force to be the same">of_geom</a> geomdontuse;</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;  <span class="keyword">struct </span><a class="code" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae" title="typedef struct of_geom struct of_compgeom; force to be the same">of_geom</a> *ptrgeom=&amp;geomdontuse;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#af1c67086436007e897bccc458390886f" title="PLOOP controls looping over conserved or primitive -type quantities except during interpolation or ot...">PLOOP</a>(pliter,pl) vars[pl]= 0.0;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac5158fb917bf2fb5e916aec0b420439c">enerpos</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad41a84c69f5ec4a51492e96b4dc61ac4">enerposreg</a>[enerregion];</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;  <a class="code" href="../../da/db2/global_8loops_8manypoints_8h.html#ac8b973bce4dcedb06b10ea23d7fe6d4a">ZLOOP</a>{ <span class="comment">// diagonostic loop // OPENMPOPTMARK: Could optimize this, but not frequently done</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../dd/d5e/global_8loops_8diagnostics_8h.html#adce09b604562ed55df79f487e8d038e4" title="defines whether within the enerregion considered loop-related macro">WITHINENERREGION</a>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ac5158fb917bf2fb5e916aec0b420439c">enerpos</a>,i,j,k)){</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a55732148d2616d6d1f5d2abbe8710850">DOENOFLUX</a> != <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#adacaaf8526353cfe870206f0cf4d2ca7" title="for DOENOFLUX: 0: no ENO flux reconstruction 1: reconstruct F for finite difference rep...">NOENOFLUX</a>){</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        <span class="comment">// GODMARK</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        <span class="comment">// then need to use stored averaged conserved quantity</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        <span class="comment">// assume done with all timesteps when here, so using unew</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        <span class="comment">// for substep access one would need to know which substep and then use the correct version (ulast) on all substeps except in between full steps when unew is the correct answer</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#af1c67086436007e897bccc458390886f" title="PLOOP controls looping over conserved or primitive -type quantities except during interpolation or ot...">PLOOP</a>(pliter,pl){</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;          ftemp[pl]=GLOBALMACP0A1(udump,i,j,k,pl)*<a class="code" href="../../d8/d5b/defs_8general_8h.html#a9e6da72f4fb3e32d9bbf657ae60ec39c">dVF</a>;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;          vars[pl] += ftemp[pl];</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;        }</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;      }</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;      <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        <a class="code" href="../../d3/ddc/phys_8funcdeclare_8h.html#a3059ed7bfcfb692cbe8014d55fd7c1e4">get_geometry</a>(i,j,k,<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8936711f57f82d1fc75c21fa2894e1c6">CENT</a>,ptrgeom) ;</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        <span class="keywordflow">if</span>(!<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad4ec5aab9b62fbbe9b8fc2d8ac0a5989">failed</a>){</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="../../d3/ddc/phys_8funcdeclare_8h.html#a11e17cd8b0594d1ad52e3594aa9f477e" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e...">get_state</a>(<a class="code" href="../../df/d1c/global_8storage_8h.html#a5dd5a282922755d8516bcbf69ccfa767">GLOBALMAC</a>(pdump,i,j,k),ptrgeom,&amp;q)&gt;=1) <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="../../d3/ddc/phys_8funcdeclare_8h.html#a9a54096e4c40a15a2c1bf74266153616" title="calculate &quot;conserved&quot; quantities">primtoU</a>(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0339344098add3b8dbaaf3f753ed4b4f">UDIAG</a>,<a class="code" href="../../df/d1c/global_8storage_8h.html#a5dd5a282922755d8516bcbf69ccfa767">GLOBALMAC</a>(pdump,i,j,k),&amp;q,ptrgeom,U, NULL)&gt;=1) <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        }</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;        <span class="comment">// must use centered primitive for non-field stuff if staggered (or all if non-staggered) so *true* primitive-based conservative that we are really tracking</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;        <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#af1c67086436007e897bccc458390886f" title="PLOOP controls looping over conserved or primitive -type quantities except during interpolation or ot...">PLOOP</a>(pliter,pl){</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a56c640597356b6f642dd6ee1afb87e74">BPL</a>(pl)==0 &amp;&amp; <a class="code" href="../../d8/d5b/defs_8general_8h.html#a11c4e99e1493d0c1914ad1ab313ea472">FLUXB</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0b6762cef74e396f50a83864bb53fb6c">FLUXCTSTAG</a> || <a class="code" href="../../d8/d5b/defs_8general_8h.html#a11c4e99e1493d0c1914ad1ab313ea472">FLUXB</a>!=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0b6762cef74e396f50a83864bb53fb6c">FLUXCTSTAG</a>){</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;            ftemp[pl]=U[pl]*<a class="code" href="../../d8/d5b/defs_8general_8h.html#a9e6da72f4fb3e32d9bbf657ae60ec39c">dVF</a>;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;            vars[pl] += ftemp[pl];</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;          }</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;        }</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;        </div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;        <span class="comment">// must use staggered field because using true emf fluxes</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a11c4e99e1493d0c1914ad1ab313ea472">FLUXB</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0b6762cef74e396f50a83864bb53fb6c">FLUXCTSTAG</a>){</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;          <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#af1c67086436007e897bccc458390886f" title="PLOOP controls looping over conserved or primitive -type quantities except during interpolation or ot...">PLOOP</a>(pliter,pl){</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a56c640597356b6f642dd6ee1afb87e74">BPL</a>(pl)==1){</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;              ftemp[pl]=GLOBALMACP0A1(unewglobal,i,j,k,pl)*<a class="code" href="../../d8/d5b/defs_8general_8h.html#a9e6da72f4fb3e32d9bbf657ae60ec39c">dVF</a>;</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;              vars[pl] += ftemp[pl];</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;            }</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;          }</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;        }</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;      }</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    }</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  }</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;}</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="keywordtype">int</span> constotal2(<span class="keywordtype">int</span> enerregion, <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> *vars)</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;{</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#ad21ff679aac3fe28202c6d592eafd3e6">i</a>,<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>,k,pl,pliter;</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> U[NPR];</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;  <span class="keyword">struct </span><a class="code" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae" title="typedef struct of_geom struct of_compgeom; force to be the same">of_geom</a> geom;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;  <span class="keyword">struct </span><a class="code" href="../../d1/d83/structof__state.html" title="state structure">of_state</a> q;</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> ftemp[NPR];</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;  <span class="comment">//  int dissloop;</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;  vars[0]= 0.0;</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac5158fb917bf2fb5e916aec0b420439c">enerpos</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad41a84c69f5ec4a51492e96b4dc61ac4">enerposreg</a>[enerregion];</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;  <a class="code" href="../../da/db2/global_8loops_8manypoints_8h.html#ac8b973bce4dcedb06b10ea23d7fe6d4a">ZLOOP</a>{ <span class="comment">// diagonostic loop // OPENMPOPTMARK: Could optimize this, but not frequently done</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../dd/d5e/global_8loops_8diagnostics_8h.html#adce09b604562ed55df79f487e8d038e4" title="defines whether within the enerregion considered loop-related macro">WITHINENERREGION</a>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ac5158fb917bf2fb5e916aec0b420439c">enerpos</a>,i,j,k) ){</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;      <span class="comment">//      for(dissloop=0;dissloop&lt;NUMDISSVERSIONS;dissloop++){</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;      vars[0] += GLOBALMACP0A1(dissfunpos,i,j,k,0);</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;      <span class="comment">//      }</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    }</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  }</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;}</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="keywordtype">int</span> counttotal(<span class="keywordtype">int</span> enerregion, CTYPE *vars, <span class="keywordtype">int</span> num)</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;{</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#ad21ff679aac3fe28202c6d592eafd3e6">i</a>,<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>,k,variter;</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;  <span class="keywordflow">for</span>(variter=0;variter&lt;num;variter++) vars[variter]= 0;</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac5158fb917bf2fb5e916aec0b420439c">enerpos</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad41a84c69f5ec4a51492e96b4dc61ac4">enerposreg</a>[enerregion];</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;  </div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;  <span class="comment">// looping over [0][variter] is equivalent to original FINALSTEPLOOP TSCALELOOP FLLOOP since at least last two entries in failfloorcount array are continuous in memory</span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;  <span class="comment">// ZLOOP: diagonostic loop // OPENMPOPTMARK: Could optimize this, but not frequently done</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;  <a class="code" href="../../da/db2/global_8loops_8manypoints_8h.html#ac8b973bce4dcedb06b10ea23d7fe6d4a">ZLOOP</a> {</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../dd/d5e/global_8loops_8diagnostics_8h.html#adce09b604562ed55df79f487e8d038e4" title="defines whether within the enerregion considered loop-related macro">WITHINENERREGION</a>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ac5158fb917bf2fb5e916aec0b420439c">enerpos</a>,i,j,k) ){</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;      <span class="keywordflow">for</span>(variter=0;variter&lt;num;variter++) vars[variter] += <a class="code" href="../../df/d1c/global_8storage_8h.html#a4ca176a81d2229ced28a5c53ebeacc06">GLOBALMACP0A3</a>(failfloorcount,i,j,k,0,0,variter) ;</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    }</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;  }</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;  <span class="comment">// below for restarting with counters in case no spatial counters</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;  <span class="comment">// see restart.c and restart_read_defs_new()</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;  i=-<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a51b48b29d7903bb94a3d7879c3ff8eb9">N1NOT1</a>;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;  j=-<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a9d8b7e3d088c68f51e7b29b95326a4ac">N2NOT1</a>;</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;  k=-<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#aabbd6bada71f73d78d57d14e9adc0c29">N3NOT1</a>;</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;  <span class="keywordflow">for</span>(variter=0;variter&lt;num;variter++) vars[variter] += <a class="code" href="../../df/d1c/global_8storage_8h.html#a4ca176a81d2229ced28a5c53ebeacc06">GLOBALMACP0A3</a>(failfloorcount,i,j,k,0,0,variter) ;</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;}</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;</div>
<div class="line"><a name="l01018"></a><span class="lineno"><a class="code" href="../../da/d0d/dump__ener_8c.html#aee239034bc1a9927ee2d4dfc4b188773"> 1018</a></span>&#160;<span class="preprocessor">#define MAXPTRS 10</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="keywordtype">int</span> integrate(<span class="keywordtype">int</span> numelements, <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> * var,<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> *var_tot,<span class="keywordtype">int</span> type, <span class="keywordtype">int</span> enerregion)</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;{</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;  <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> *totalptrs[<a class="code" href="../../da/d0d/dump__ener_8c.html#aee239034bc1a9927ee2d4dfc4b188773">MAXPTRS</a>],*totaloptrs[<a class="code" href="../../da/d0d/dump__ener_8c.html#aee239034bc1a9927ee2d4dfc4b188773">MAXPTRS</a>];</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;  <span class="keywordtype">int</span> totalsizes[<a class="code" href="../../da/d0d/dump__ener_8c.html#aee239034bc1a9927ee2d4dfc4b188773">MAXPTRS</a>],numptrs;</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  <span class="keywordflow">switch</span>(type){</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#af31213679a914b998a2d21c3379509c9">CONSTYPE</a>:</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    <span class="keywordflow">if</span>(constotal(enerregion,var)&gt;=1) <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    totalsizes[0]=numelements;</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    gettotal(0,1,&amp;var,totalsizes,&amp;var_tot); <span class="comment">// if only 1 object, then just send address</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    <span class="comment">// below not used or deprecated</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    <span class="comment">//  case CONSTYPE2:</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    <span class="comment">//    if(constotal2(enerregion,var)&gt;=1) return(1);</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    <span class="comment">//    totalsizes[0]=1;</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    <span class="comment">//    gettotal(0,1,&amp;var,totalsizes,&amp;var_tot); // if only 1 object, then just send address</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    <span class="comment">//    break;</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ad17625fabc8232c022c8e61a76203fe1">SURFACETYPE</a>:</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a08f7aaae724b378ac86a8fae70777f91">CUMULATIVETYPE</a>:</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    totalsizes[0]=numelements;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    gettotal(0,1,&amp;var,totalsizes,&amp;var_tot);</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ac27889127ca0a1c3d14e0a9bcc9a9445">CUMULATIVETYPE2</a>:</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    <span class="comment">// CUMULATIVETYPE2 for 1 data object per ii</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    totalsizes[0]=1; <span class="comment">// GODMARK: don&#39;t see point in this since just ignore numelements</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    gettotal(0,1,&amp;var,totalsizes,&amp;var_tot);</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    <span class="comment">// this case makes no sense currently, so fail</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    myexit(4983463);</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ac14d7f12b5b9453cbeb6744d923b2e4d">CUMULATIVETYPE3</a>:</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    <span class="comment">// Like CUMULATIVETYPE, but put result in all cores.</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    totalsizes[0]=numelements;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    <span class="comment">//    getalltotal(1,&amp;var,totalsizes,&amp;var_tot);</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    gettotal(1,1,&amp;var,totalsizes,&amp;var_tot);</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;No defined type=%d in integrate\n&quot;</span>,type);</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    myexit(1);</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;  }</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;}</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="keywordtype">int</span> integratel(<span class="keywordtype">int</span> numelements, CTYPE * var, CTYPE *var_tot,<span class="keywordtype">int</span> type, <span class="keywordtype">int</span> enerregion)</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;{</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;  CTYPE *totalptrs[<a class="code" href="../../da/d0d/dump__ener_8c.html#aee239034bc1a9927ee2d4dfc4b188773">MAXPTRS</a>],*totaloptrs[<a class="code" href="../../da/d0d/dump__ener_8c.html#aee239034bc1a9927ee2d4dfc4b188773">MAXPTRS</a>];</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;  <span class="keywordtype">int</span> totalsizes[<a class="code" href="../../da/d0d/dump__ener_8c.html#aee239034bc1a9927ee2d4dfc4b188773">MAXPTRS</a>],numptrs;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;  <span class="keywordflow">switch</span>(type){</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#af31213679a914b998a2d21c3379509c9">CONSTYPE</a>:</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    <span class="comment">// first add up over entire grid for each CPU</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    <span class="keywordflow">if</span>(counttotal(enerregion,var,numelements)&gt;=1) <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    totalsizes[0]=numelements;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    gettotall(1,&amp;var,totalsizes,&amp;var_tot);</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;No defined type=%d in integratel\n&quot;</span>,type);</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    myexit(1);</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;  }</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;}</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;</div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri May 20 2016 15:52:33 for HARM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.3.1
</small></address>
</body>
</html>
