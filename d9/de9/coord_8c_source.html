<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>HARM: coord.c Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">HARM
   </div>
   <div id="projectbrief">harm and utilities</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">coord.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d9/de9/coord_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &quot;decs.h&quot;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d9/de9/coord_8c.html#af7a086e6042d598aea95c2360d07a99b">blcoord_singfixes</a>(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *<a class="code" href="../../dc/dd2/newcodediff_8txt.html#a933233ff9879962bcc2ff987c6920f90">X</a>, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *<a class="code" href="../../dc/dd2/newcodediff_8txt.html#af84f2c3bf153920b7c8d186132d39bc7">V</a>);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">// These static variables can only be set in set_coord_parms() type functions, not bl_coord() or dxdxp().  if need to set inside bl_coord() or dxdxp(), then move variable there!</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment"></span><span class="comment">// for defcoord==COMPLEX1TH</span></div>
<div class="line"><a name="l00036"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#ae91faa22bb51b3003d7a140fd4a100ff">   36</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#ae91faa22bb51b3003d7a140fd4a100ff">der0</a>=9;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">//static FTYPE Ri=8.0; // too unresolved for 256x128</span></div>
<div class="line"><a name="l00038"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a7cc367c90dd3a8d7608984c311cb6c9b">   38</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a7cc367c90dd3a8d7608984c311cb6c9b">Ri</a>=20.0;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">// for defcoord==COMPLEX2TH</span></div>
<div class="line"><a name="l00041"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a460b151eb6590a200f27826e97dcc248">   41</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a460b151eb6590a200f27826e97dcc248">x2trans</a>;</div>
<div class="line"><a name="l00042"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a7ddf946840a6c53afc9e37674503dd79">   42</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#adf33edafc727f90e926d3f491f6bb4cb">m2</a>,<a class="code" href="../../d9/de9/coord_8c.html#aab5d055c59dc5dbfcaef566bb6061530">d2</a>,<a class="code" href="../../d9/de9/coord_8c.html#a30a1474e2de8b7ed353e5948debd63b0">c2</a>,<a class="code" href="../../d9/de9/coord_8c.html#a1965dec5c9e70ada83cd756e549d5891">m3</a>,<a class="code" href="../../d9/de9/coord_8c.html#ada4d4828a4429bb1fbae02df87b2d79c">b3</a>,<a class="code" href="../../d9/de9/coord_8c.html#a7ddf946840a6c53afc9e37674503dd79">thetatores</a>;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">// for defcoord==JET1COORDS</span></div>
<div class="line"><a name="l00045"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a057ccc6a8480fa1e4b95bb8e928a27c0">   45</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#af5c3d95ab07a3b7fdff23bdde44b6ed0">h0</a>,<a class="code" href="../../d9/de9/coord_8c.html#ad92c165f272791724422d0628071b170">hf</a>,<a class="code" href="../../d9/de9/coord_8c.html#ac07d708f65a53c2ed0761d11bc97d46d">rh0</a>,<a class="code" href="../../d9/de9/coord_8c.html#a35f9f2c4f84077be4f200673dffd57ca">myrout</a>,<a class="code" href="../../d9/de9/coord_8c.html#a73f761b44de3c4480a924658b0f3efc5">dmyhslope1dr</a>,<a class="code" href="../../d9/de9/coord_8c.html#a084470ae408b08254f2247015f988570">dmyhslope2dx1</a>,<a class="code" href="../../d9/de9/coord_8c.html#a05bf2e602378f34e74ff69f35b1991d9">x1in</a>,<a class="code" href="../../d9/de9/coord_8c.html#a057ccc6a8480fa1e4b95bb8e928a27c0">x1out</a>;</div>
<div class="line"><a name="l00046"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">   46</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">// for defcoord=JET2COORDS</span></div>
<div class="line"><a name="l00049"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a508726935adb05ad4291b8c77897f8c5">   49</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a941700197dd24e782cbb0add66a42dbd">r1jet</a>,<a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>,<a class="code" href="../../d9/de9/coord_8c.html#a508726935adb05ad4291b8c77897f8c5">rpjet</a>;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">// for defcoord=JET3COORDS</span></div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">   52</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>,<a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>,<a class="code" href="../../d9/de9/coord_8c.html#ab0e0c0acf7cc9040907c895921b3fed7">Qjet</a>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">// for SJETCOORDS</span></div>
<div class="line"><a name="l00055"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a9c9f5f22dd4a5da08e734903ab82659f">   55</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a9c9f5f22dd4a5da08e734903ab82659f">fracphi</a>;</div>
<div class="line"><a name="l00056"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a119eed5c7b218e4a9547a2e0c1a8d4fe">   56</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a119eed5c7b218e4a9547a2e0c1a8d4fe">npow2</a>;</div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a9b4b0ea2888bdfb7e987f43be8dee6db">   57</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a9b4b0ea2888bdfb7e987f43be8dee6db">cpow2</a>;</div>
<div class="line"><a name="l00058"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a1196767f0fc1292fff1d9ee90d7fd3ff">   58</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a1196767f0fc1292fff1d9ee90d7fd3ff">rbr</a>;</div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a7c7295d071bc7960f6b2fe9b8ab730ac">   59</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a7c7295d071bc7960f6b2fe9b8ab730ac">x1br</a>;</div>
<div class="line"><a name="l00060"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a8365b4ccf09b73479da0374726417db8">   60</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a8365b4ccf09b73479da0374726417db8">fracdisk</a>;</div>
<div class="line"><a name="l00061"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a8d5416128840a1ac3f7c18af1619e553">   61</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a8d5416128840a1ac3f7c18af1619e553">fracjet</a>;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="keyword">static</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>;</div>
<div class="line"><a name="l00063"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a785b0a4bf2ba821005a429e176f8e130">   63</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a785b0a4bf2ba821005a429e176f8e130">r0grid</a>;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="keyword">static</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>;</div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a46d4c41abf34a76cec7353209c94905c">   65</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a46d4c41abf34a76cec7353209c94905c">rjetend</a>;</div>
<div class="line"><a name="l00066"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#af36620e0e23c6f08616e2be183b09958">   66</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#af36620e0e23c6f08616e2be183b09958">r0disk</a>;</div>
<div class="line"><a name="l00067"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a40bbfe3eb99d3c1da07a520db92a243e">   67</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a40bbfe3eb99d3c1da07a520db92a243e">rdiskend</a>;</div>
<div class="line"><a name="l00068"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a771a5cedc0bb12d13ea9cb76eff5cd42">   68</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a771a5cedc0bb12d13ea9cb76eff5cd42">jetnu</a>;</div>
<div class="line"><a name="l00069"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a7c9ef3dd93e82818da1c93b9d159483d">   69</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a7c9ef3dd93e82818da1c93b9d159483d">x10</a>;</div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a3b4850579b329099634861408a9e25df">   70</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a3b4850579b329099634861408a9e25df">x20</a>;</div>
<div class="line"><a name="l00071"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a9826dcbe26a0043f9ed08533a459ae28">   71</a></span>&#160;<span class="preprocessor">#define USESJETLOGHOVERR 1</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#if(USESJETLOGHOVERR)</span></div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a5ea0fae0c3b762346c819d02b056c61b">   73</a></span>&#160;<span class="preprocessor"></span><span class="keyword">static</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a5ea0fae0c3b762346c819d02b056c61b">torusrmax</a>; <span class="comment">// was extern and original located in init.sashatorus.c, but should be inverted as now is so extern is in init.sashatorus.c.</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00075"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#ae069412a47af2715a20ebd2cb47513e9">   75</a></span>&#160;<span class="preprocessor"></span><span class="keyword">static</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#ae069412a47af2715a20ebd2cb47513e9">torusrmax_loc</a>;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">// for defcoord=JET6COORDS</span></div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a336034dbc5239e0fe15a337c19903374">   80</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a83fde478856d3e284e192734eb140ce5">ntheta</a>,<a class="code" href="../../d9/de9/coord_8c.html#a2e5b7193188d9601aadc8d7f06fe121c">htheta</a>,<a class="code" href="../../d9/de9/coord_8c.html#a6ae559d1c0eb70aefa1b83129530a2fd">rsjet2</a>,<a class="code" href="../../d9/de9/coord_8c.html#a10ea48caa54649707c33041bc3bc298c">r0jet2</a>,<a class="code" href="../../d9/de9/coord_8c.html#a336034dbc5239e0fe15a337c19903374">rsjet3</a>,<a class="code" href="../../d9/de9/coord_8c.html#a7406e3812b73aed1b3ccef19bec31dab">r0jet3</a>; <span class="comment">// and rs,r0</span></div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a26ece82e6d552d80914dd5ae149ade6f">   81</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a26ece82e6d552d80914dd5ae149ade6f">cpow3</a>;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">// for defcoord=BPTHIN1</span></div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a4fa1cafdb60ad24851dcf7f6a85d196c">   84</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a565a42e16bf3620bb640120f8c1a4e2a">bp_npow</a>,<a class="code" href="../../d9/de9/coord_8c.html#a7a94b12c588980b5ab27f7eeafb87cff">bp_r1jet</a>,<a class="code" href="../../d9/de9/coord_8c.html#a9892e7346ba03577d51d6df7813b8558">bp_njet1</a>,<a class="code" href="../../d9/de9/coord_8c.html#af88a4fd7d71742e941f216f36ad6b54a">bp_njet</a>,<a class="code" href="../../d9/de9/coord_8c.html#a54158096cc3ecff6f170b1c73f37b4eb">bp_r0jet</a>,<a class="code" href="../../d9/de9/coord_8c.html#a089b6a95e1b9ff1c17894dc843624fdc">bp_rsjet</a>,<a class="code" href="../../d9/de9/coord_8c.html#a50374ed958868696ce52b141be1e7677">bp_Qjet</a>, <a class="code" href="../../d9/de9/coord_8c.html#a0cb81219b4699253263ef5166f5fcb5f">bp_ntheta</a>,<a class="code" href="../../d9/de9/coord_8c.html#a2c9c35b3b93e28fb584cd7abc86177aa">bp_htheta</a>,<a class="code" href="../../d9/de9/coord_8c.html#a0bd0efdb0c8c30cbfa8174f4786c260d">bp_rsjet2</a>,<a class="code" href="../../d9/de9/coord_8c.html#a5bb1f817cc895142f229f3275204fb08">bp_r0jet2</a>,<a class="code" href="../../d9/de9/coord_8c.html#a4094a39b7ecf5cd989692b3997bc2f0a">bp_rsjet3</a>,<a class="code" href="../../d9/de9/coord_8c.html#a5a867407978fba43d13a1bf73039e623">bp_r0jet3</a>, <a class="code" href="../../d9/de9/coord_8c.html#a00cd3b5afe216561157f1f3a53d8610e">bp_rs</a>, <a class="code" href="../../d9/de9/coord_8c.html#ac6c2bb2b523c5805b7df12b34a6287eb">bp_r0</a>,<a class="code" href="../../d9/de9/coord_8c.html#aa54849ebc8093319bbf05517dfc21110">bp_rsinner</a>,<a class="code" href="../../d9/de9/coord_8c.html#aa35f0e92f938a8111f280383c6c34697">bp_r0inner</a>,<a class="code" href="../../d9/de9/coord_8c.html#a0cce4548534baf8c1e0f2fbdd706117c">bp_npow2</a>,<a class="code" href="../../d9/de9/coord_8c.html#aa3c25e2dcf468d66d223576997aaa124">bp_cpow2</a>,<a class="code" href="../../d9/de9/coord_8c.html#a51855c9f2c2f77df27842fd0cdcb25f6">bp_rbr</a>,<a class="code" href="../../d9/de9/coord_8c.html#a4fa1cafdb60ad24851dcf7f6a85d196c">bp_x1br</a>, <a class="code" href="../../d9/de9/coord_8c.html#a95ffc6e8abca3051b2b5163e21d0c135">bp_h0</a>; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">// for defcoord=PULSARCOORDS</span></div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a808590103058909774d170d48f1e5723">   87</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#adb91c14ac2eecf2e4745073392a7af6f">hinner</a>,<a class="code" href="../../d9/de9/coord_8c.html#a808590103058909774d170d48f1e5723">houter</a>;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">// for defcoord=JET4COORDS</span></div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#aaa4f963acaccd1ea63a18f800fd576a1">   90</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#aaa4f963acaccd1ea63a18f800fd576a1">rs</a>,<a class="code" href="../../d9/de9/coord_8c.html#a54081391e09395407d47aec84f3d97c9">r0</a>;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">// UNI2LOG similar to LOGSINTH with new features and simpler startx/dx and grid growth factor</span></div>
<div class="line"><a name="l00093"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a71a9672d1d7564295af1d92b16656ed2">   93</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/de9/coord_8c.html#a71a9672d1d7564295af1d92b16656ed2">Nstar</a>;</div>
<div class="line"><a name="l00094"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#acbb89ba805d17640710dea9b25fc385e">   94</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#acbb89ba805d17640710dea9b25fc385e">Rstar</a>,<a class="code" href="../../d9/de9/coord_8c.html#a9a25d0159341c4801263a705248546a9">Afactor</a>;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">// for defcoord=JET5COORDS</span></div>
<div class="line"><a name="l00097"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#abf5c838329a6a04b2bc88d8b71ae1bba">   97</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a4a1725236323ec7cbb4359d2485c529d">AAAA</a>,<a class="code" href="../../d9/de9/coord_8c.html#a2c72f016de11e17e0a2e6fa70d147632">AAA</a>,<a class="code" href="../../d9/de9/coord_8c.html#ae48fe9ae969558bf17a1cdbd2d0deb5b">BBB</a>,<a class="code" href="../../d9/de9/coord_8c.html#a333d082b5608e2d1dc51ef0194ed866e">DDD</a>,<a class="code" href="../../d9/de9/coord_8c.html#abcc0aa57debd9aa5e7f1aa918a2a3c1a">CCCC</a>,<a class="code" href="../../d9/de9/coord_8c.html#abf5c838329a6a04b2bc88d8b71ae1bba">Rj</a>;</div>
<div class="line"><a name="l00098"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a5c290996245039518a5b33e0ea065efc">   98</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a5c290996245039518a5b33e0ea065efc">ii0</a>;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">// for defcoord=SJETCOORDS</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> vofx_sjetcoords( <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *<a class="code" href="../../dc/dd2/newcodediff_8txt.html#a933233ff9879962bcc2ff987c6920f90">X</a>, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *<a class="code" href="../../dc/dd2/newcodediff_8txt.html#af84f2c3bf153920b7c8d186132d39bc7">V</a> );  <span class="comment">//original coordinates</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> vofx_cylindrified( <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *Xin, <span class="keywordtype">void</span> (*vofx)(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>*, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>*), <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *Vout ); <span class="comment">//coordinate &quot;cylindrifier&quot;</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">// for defcoord=JET6COORDSTHIN</span></div>
<div class="line"><a name="l00105"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a5c90a66307da98c5b41bfb5f3ed38c4e">  105</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#ae5abebf1f6c7a6931bf0136d15cebc1c">th_npow</a>,<a class="code" href="../../d9/de9/coord_8c.html#a527c4120bc2acd2f39c94365a93c0daf">th_r1jet</a>,<a class="code" href="../../d9/de9/coord_8c.html#a1e6b34dd3a0b8e4c3f2e9337c46bfbc8">th_njet1</a>,<a class="code" href="../../d9/de9/coord_8c.html#a5c7e50892f84b146d3a7d02b3f160a30">th_njet</a>,<a class="code" href="../../d9/de9/coord_8c.html#a24dd2c220273395f57553f6c60280a1c">th_r0jet</a>,<a class="code" href="../../d9/de9/coord_8c.html#a5323899c26b7b58cd21c82ea426c5484">th_rsjet</a>,<a class="code" href="../../d9/de9/coord_8c.html#a2d954245da7e993a749e4dcf62e021e0">th_Qjet</a>, <a class="code" href="../../d9/de9/coord_8c.html#ade6ca4233fd1d4a9ac150c9fc57d383b">th_ntheta</a>,<a class="code" href="../../d9/de9/coord_8c.html#ad1bfc9d7b5de958b272f91284b3e74fc">th_htheta</a>,<a class="code" href="../../d9/de9/coord_8c.html#a45bf49dc033739ee6be930169d1328cb">th_rsjet2</a>,<a class="code" href="../../d9/de9/coord_8c.html#abfa8655740f5e617829f065886d25e9a">th_r0jet2</a>,<a class="code" href="../../d9/de9/coord_8c.html#a17c673e8c84f6b882729068c21722f3f">th_rsjet3</a>,<a class="code" href="../../d9/de9/coord_8c.html#a7b555157af12104a3765cbcb3957ad26">th_r0jet3</a>, <a class="code" href="../../d9/de9/coord_8c.html#a35fb02c9daff9b418d73f4b874886cc4">th_rs</a>, <a class="code" href="../../d9/de9/coord_8c.html#a2d0661cc7d58c434e2fe8ab6839767dd">th_r0</a>,<a class="code" href="../../d9/de9/coord_8c.html#ae20b8f52e8f49574772a0a21dd288f42">th_npow2</a>,<a class="code" href="../../d9/de9/coord_8c.html#ae920eb024efe4118674afa4440a62d65">th_cpow2</a>,<a class="code" href="../../d9/de9/coord_8c.html#a88ca16f7e0cf47cda85d2e397c62d557">th_rbr</a>,<a class="code" href="../../d9/de9/coord_8c.html#a5c90a66307da98c5b41bfb5f3ed38c4e">th_x1br</a>, <a class="code" href="../../d9/de9/coord_8c.html#a999aa17446433d62ba5a24e0128f3a79">th_h0</a>; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div>
<div class="line"><a name="l00110"></a><span class="lineno"><a class="code" href="../../d6/d85/coord_8funcdeclare_8h.html#afadc9671fb01ff346f980daeee9780ca">  110</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d9/de9/coord_8c.html#afadc9671fb01ff346f980daeee9780ca" title="can call when no dependencies">set_coord_parms</a>(<span class="keywordtype">int</span> defcoordlocal)</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;{</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <a class="code" href="../../d9/de9/coord_8c.html#a60cc2ae07fc7fa7fe31f94d01bc7f4f8" title="Things to set that only depend upon defcoord and nothing else NOTEMARK: By nothing else...">set_coord_parms_nodeps</a>(defcoordlocal);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <a class="code" href="../../d9/de9/coord_8c.html#afe287fe0a55bbf3b69020d103da8b6cd" title="stuff that depends upon ANYTHING external that might be set by user in init_grid() or by system in in...">set_coord_parms_deps</a>(defcoordlocal);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;}</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div>
<div class="line"><a name="l00124"></a><span class="lineno"><a class="code" href="../../d6/d85/coord_8funcdeclare_8h.html#a60cc2ae07fc7fa7fe31f94d01bc7f4f8">  124</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d9/de9/coord_8c.html#a60cc2ae07fc7fa7fe31f94d01bc7f4f8" title="Things to set that only depend upon defcoord and nothing else NOTEMARK: By nothing else...">set_coord_parms_nodeps</a>(<span class="keywordtype">int</span> defcoordlocal)</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;{</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="preprocessor">#if(USEOPENMP)</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">if</span>(omp_in_parallel()){</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;set_coord_parms_nodeps() called in parallel region\n&quot;</span>);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    myexit(784653446);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  }</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="comment">// assumes R0, Rin, Rout, and hslope are so general that are set in init.c</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#abbc29b306372314c9c2c6cb50fadbe6f">USERCOORD</a>) {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="../../d8/d60/init_8c.html#ab63654049a6dd03a5005f66433622180">set_coord_parms_nodeps_user</a>(<span class="keywordtype">int</span> defcoordlocal);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <a class="code" href="../../d8/d60/init_8c.html#ab63654049a6dd03a5005f66433622180">set_coord_parms_nodeps_user</a>(defcoordlocal);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a99c6ba3b86430e6eb5a179c57fd58070">LOGRSINTH</a>) {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a174565dd3f50428c4c4d1e4a23019414">REBECCAGRID</a>) {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  }</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a3ebede6f897039b55ee0d8f75b359640">COMPLEX0TH</a>) {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  }</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#aeb733e0ec20094a219e120e3e9b22a0f">UNIRSINTH</a> || defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a8e2797c3dc060d13c29fd562d98d3bf8">UNIRSINTH2</a>){</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  }</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#aa2630728190374841bd88da517faffb9">EQMIRROR</a>) {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  }</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a3ba253bfcb09b67c4f83cf604be1b4c4">COMPLEX1TH</a>) {</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  }</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a363db929c2617ac441c63fe7d9847d30">COMPLEX2TH</a>) {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a460b151eb6590a200f27826e97dcc248">x2trans</a>=0.1; <span class="comment">// user settable, must be same as below in dxdxp</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  }</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a78f877fef6d5148b40adc3d6d93c7ad0">LOGRUNITH</a>) { <span class="comment">// uniform theta and log in radius</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  }</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a6903d2cdfaf212b975c4fffa9402fa9c">JET1COORDS</a>) {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="comment">// optimal is npow=10 R0=-3</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>=1.0;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="comment">//R0=0.0;</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="comment">// must be same as in dxdxp()</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#ad92c165f272791724422d0628071b170">hf</a>=2.0-0.22;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#ac07d708f65a53c2ed0761d11bc97d46d">rh0</a>=40.0;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a3e3cceb2f708009494c25912bd2470f4">JET2COORDS</a>) {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>=1.0;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="comment">// must be same as in dxdxp()</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordflow">if</span>(1){</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a941700197dd24e782cbb0add66a42dbd">r1jet</a>=16.0;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>=0.3;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a508726935adb05ad4291b8c77897f8c5">rpjet</a>=0.9;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a941700197dd24e782cbb0add66a42dbd">r1jet</a>=9.0;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>=0.3;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a508726935adb05ad4291b8c77897f8c5">rpjet</a>=.9;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  }</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a77ba1498bcda3890f2a37bb5979a1eec">JET3COORDS</a>) {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>=1.0;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="comment">// must be same as in dxdxp()</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">if</span>(0){ <span class="comment">// first attempt</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a941700197dd24e782cbb0add66a42dbd">r1jet</a>=2.8;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>=0.3;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>=7.0;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>=21.0;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#ab0e0c0acf7cc9040907c895921b3fed7">Qjet</a>=1.7;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    }</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(0){ <span class="comment">// chosen to resolve disk then resolve jet</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a941700197dd24e782cbb0add66a42dbd">r1jet</a>=2.8;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>=0.3;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>=20.0;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>=80.0;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#ab0e0c0acf7cc9040907c895921b3fed7">Qjet</a>=1.8;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    }</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(1){</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a941700197dd24e782cbb0add66a42dbd">r1jet</a>=2.8;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>=0.3;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>=20.0;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>=80.0;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#ab0e0c0acf7cc9040907c895921b3fed7">Qjet</a>=1.3; <span class="comment">// chosen to help keep jet resolved even within disk region</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    }</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  }</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a8cb1a8a42445cede081c2ddfaa98113f">SJETCOORDS</a>) {</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  }</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a725469cd082a278dfc44a41e28eca44c">JET6COORDS</a>) {</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="comment">// see jet3coords_checknew.nb</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>=1.0;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="comment">// RADIAL GRID SETUP</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment"></span>    <a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>=1.0;  <span class="comment">//don&#39;t change it, essentially equivalent to changing cpow2</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="comment">//radial hyperexponential grid</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="comment">//power exponent</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a119eed5c7b218e4a9547a2e0c1a8d4fe">npow2</a>=6.0; <span class="comment">// WALD: 6.0-&gt;4.0</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a9b4b0ea2888bdfb7e987f43be8dee6db">cpow2</a>=1.0; <span class="comment">//exponent prefactor (the larger it is, the more hyperexponentiation is)</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="comment">//    cpow3=0.01;</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a26ece82e6d552d80914dd5ae149ade6f">cpow3</a>=1.0;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="comment">//radius at which hyperexponentiation kicks in</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="comment">//    rbr = 1E3;</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="comment">//    rbr = 5E2; // WALD 5E2-&gt;5E7 // SUPER-EDD: 2E3</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a1196767f0fc1292fff1d9ee90d7fd3ff">rbr</a> = 2E3; <span class="comment">// SUPERMADNEW</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="comment">// must be same as in dxdxp()</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="comment">// GODMARK: Note njet here is overwritten by njet later, but could have been different values if setup variable names differently.</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordflow">if</span>(0){ <span class="comment">// first attempt</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a941700197dd24e782cbb0add66a42dbd">r1jet</a>=2.8;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>=0.3;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>=7.0;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>=21.0;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#ab0e0c0acf7cc9040907c895921b3fed7">Qjet</a>=1.7;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    }</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(0){ <span class="comment">// chosen to resolve disk then resolve jet</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a941700197dd24e782cbb0add66a42dbd">r1jet</a>=2.8;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>=0.3;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>=20.0;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>=80.0;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#ab0e0c0acf7cc9040907c895921b3fed7">Qjet</a>=1.8;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    }</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(0){</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a941700197dd24e782cbb0add66a42dbd">r1jet</a>=2.8;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>=0.3;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>=15.0;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>=40.0;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#ab0e0c0acf7cc9040907c895921b3fed7">Qjet</a>=1.3; <span class="comment">// chosen to help keep jet resolved even within disk region</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      <span class="comment">//      Qjet=1.7; // chosen to help keep jet resolved even within disk region</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    }</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(1){ <span class="comment">// SUPERMADNEW</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a941700197dd24e782cbb0add66a42dbd">r1jet</a>=30.0;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>=0.7;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>=30.0;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>=40.0;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#ab0e0c0acf7cc9040907c895921b3fed7">Qjet</a>=1.6;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    }</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="comment">// for switches from normal theta to ramesh theta</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordflow">if</span>(0){</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#aaa4f963acaccd1ea63a18f800fd576a1">rs</a>=40.0; <span class="comment">// shift</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a54081391e09395407d47aec84f3d97c9">r0</a>=20.0; <span class="comment">// divisor</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a7406e3812b73aed1b3ccef19bec31dab">r0jet3</a>=20.0; <span class="comment">// divisor</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a336034dbc5239e0fe15a337c19903374">rsjet3</a>=0.0; <span class="comment">// subtractor</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    }</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordflow">else</span>{<span class="comment">// SUPERMADNEW</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#aaa4f963acaccd1ea63a18f800fd576a1">rs</a>=40.0; <span class="comment">// shift</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a54081391e09395407d47aec84f3d97c9">r0</a>=40.0; <span class="comment">// divisor</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a7406e3812b73aed1b3ccef19bec31dab">r0jet3</a>=40.0; <span class="comment">// divisor</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a336034dbc5239e0fe15a337c19903374">rsjet3</a>=0.0; <span class="comment">// subtractor</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="comment">// for theta1</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="comment">//    hslope=0.3 ; // resolve inner-radial region near equator</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="comment">// for theta2</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="comment">//h0=0.3; // inner-radial &quot;hslope&quot; for theta2</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#af5c3d95ab07a3b7fdff23bdde44b6ed0">h0</a>=0.2; <span class="comment">// inner-radial &quot;hslope&quot; for theta2</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="comment">//h0=0.1; // inner-radial &quot;hslope&quot; for theta2 // for thinner disks, change this.</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="comment">// GODMARK: Note that this overwrites above njet!</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="comment">// power \theta_j \propto r^{-njet}</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordflow">if</span>(0){</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>=1.0; <span class="comment">// WALD: 1.0-&gt;0.0</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    }</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordflow">else</span>{<span class="comment">//SUPERMADNEW</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      <span class="comment">// no change</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    }</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="comment">// see fix_3dpoledtissue.nb</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordflow">if</span>(0){</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="preprocessor">#if(0)</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="preprocessor"></span>      <a class="code" href="../../d9/de9/coord_8c.html#a83fde478856d3e284e192734eb140ce5">ntheta</a>=21.0;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a2e5b7193188d9601aadc8d7f06fe121c">htheta</a>=0.15;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a6ae559d1c0eb70aefa1b83129530a2fd">rsjet2</a>=5.0;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a10ea48caa54649707c33041bc3bc298c">r0jet2</a>=2.0;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="preprocessor"></span>      <a class="code" href="../../d9/de9/coord_8c.html#a83fde478856d3e284e192734eb140ce5">ntheta</a>=5.0;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a2e5b7193188d9601aadc8d7f06fe121c">htheta</a>=0.15;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a6ae559d1c0eb70aefa1b83129530a2fd">rsjet2</a>=5.0;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a10ea48caa54649707c33041bc3bc298c">r0jet2</a>=2.0;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="preprocessor"></span>    }</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keywordflow">else</span>{ <span class="comment">// SUPERMADNEW</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a83fde478856d3e284e192734eb140ce5">ntheta</a>=5.0;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa73cf2d397cae726436e08d2c891bdb0">a</a>&lt;0.4){</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        <a class="code" href="../../d9/de9/coord_8c.html#a2e5b7193188d9601aadc8d7f06fe121c">htheta</a>=0.15;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <a class="code" href="../../d9/de9/coord_8c.html#a6ae559d1c0eb70aefa1b83129530a2fd">rsjet2</a>=5.0;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <a class="code" href="../../d9/de9/coord_8c.html#a10ea48caa54649707c33041bc3bc298c">r0jet2</a>=2.0;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      }</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <a class="code" href="../../d9/de9/coord_8c.html#a2e5b7193188d9601aadc8d7f06fe121c">htheta</a>=0.15;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <a class="code" href="../../d9/de9/coord_8c.html#a6ae559d1c0eb70aefa1b83129530a2fd">rsjet2</a>=8.0;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        <a class="code" href="../../d9/de9/coord_8c.html#a10ea48caa54649707c33041bc3bc298c">r0jet2</a>=3.0;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    }</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  }</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a0e5331f6ac2b706aa4e76de967dcb1d7">JET6COORDSTHIN</a>) {</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="comment">// see jet3coords_checknew.nb</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    th_npow=1.0;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="comment">// RADIAL GRID SETUP</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment"></span>    th_npow=1.0;  <span class="comment">//don&#39;t change it, essentially equivalent to changing cpow2</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="comment">//radial hyperexponential grid</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="comment">//    npow2=4.0; //power exponent</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    th_npow2=4.0; <span class="comment">//power exponent</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    th_cpow2=1.0; <span class="comment">//exponent prefactor (the larger it is, the more hyperexponentiation is)</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="comment">//    rbr = 1E3;  //radius at which hyperexponentiation kicks in</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    th_rbr = 1E2;  <span class="comment">//radius at which hyperexponentiation kicks in</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="comment">// must be same as in dxdxp()</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="comment">// GODMARK: Note njet here is overwritten by njet later, but could have been different values if setup variable names differently.</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordflow">if</span>(0){ <span class="comment">// first attempt</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      th_r1jet=2.8;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      th_njet=0.3;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      th_r0jet=7.0;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      th_rsjet=21.0;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      th_Qjet=1.7;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    }</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(0){ <span class="comment">// chosen to resolve disk then resolve jet</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      th_r1jet=2.8;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      th_njet=0.3;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      th_r0jet=20.0;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      th_rsjet=80.0;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      th_Qjet=1.8;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    }</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(1){</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      th_r1jet=2.8;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      th_njet=0.3;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      th_r0jet=15.0;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      th_rsjet=40.0;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      th_Qjet=2.0-0.05; <span class="comment">// chosen to help keep jet resolved even within disk region</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    }</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="comment">// for switches from normal theta to ramesh theta</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    th_rs=60.0; <span class="comment">// shift</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    th_r0=20.0; <span class="comment">// divisor</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="comment">// for theta1</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="comment">//    hslope=0.3 ; // resolve inner-radial region near equator</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    th_r0jet3=20.0; <span class="comment">// divisor</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    th_rsjet3=0.0; <span class="comment">// subtractor</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="comment">// for theta2</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    th_h0=0.05; <span class="comment">// inner-radial &quot;hslope&quot; for theta2</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="comment">//h0=0.1; // inner-radial &quot;hslope&quot; for theta2 // for thinner disks, change this.</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="comment">// GODMARK: Note that this overwrites above njet!</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    th_njet=0.0; <span class="comment">// power \theta_j \propto r^{-njet}</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="comment">// see fix_3dpoledtissue.nb</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="preprocessor">#if(0)</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="preprocessor"></span>    th_ntheta=21.0;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    th_htheta=0.15;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    th_rsjet2=5.0;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    th_r0jet2=2.0;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="preprocessor"></span>    th_ntheta=5.0;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    th_htheta=0.02;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    th_rsjet2=5.0;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    th_r0jet2=2.0;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  }</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a22ccf670681b96ce61d974db87204a10">BPTHIN1</a>) {</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="comment">// see jet3coords_checknew.nb</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a565a42e16bf3620bb640120f8c1a4e2a">bp_npow</a>=1.0;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="comment">// RADIAL GRID SETUP</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment"></span>    <a class="code" href="../../d9/de9/coord_8c.html#a565a42e16bf3620bb640120f8c1a4e2a">bp_npow</a>=1.0;  <span class="comment">//don&#39;t change it, essentially equivalent to changing cpow2</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="comment">//radial hyperexponential grid</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="comment">//    npow2=4.0; //power exponent</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a0cce4548534baf8c1e0f2fbdd706117c">bp_npow2</a>=5.0; <span class="comment">//MAVARANOTE must be odd now unless I add a sign explicitly to power component this contributes to sum in exponent //10.0; //5.0; // 10.0;    // MARKNOTE set to 10.0 before using BP values //power exponent</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#aa3c25e2dcf468d66d223576997aaa124">bp_cpow2</a>=1.0; <span class="comment">//exponent prefactor (the larger it is, the more hyperexponentiation is)</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="comment">//    rbr = 1E3;  //radius at which hyperexponentiation kicks in</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a51855c9f2c2f77df27842fd0cdcb25f6">bp_rbr</a> = 200.0;  <span class="comment">//radius at which hyperexponentiation kicks in</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="comment">// must be same as in dxdxp()</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="comment">// GODMARK: Note njet here is overwritten by njet later, but could have been different values if setup variable names differently.</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordflow">if</span>(0){ <span class="comment">// first attempt</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a7a94b12c588980b5ab27f7eeafb87cff">bp_r1jet</a>=2.8;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a9892e7346ba03577d51d6df7813b8558">bp_njet1</a>=0.3;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a54158096cc3ecff6f170b1c73f37b4eb">bp_r0jet</a>=7.0;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a089b6a95e1b9ff1c17894dc843624fdc">bp_rsjet</a>=21.0;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a50374ed958868696ce52b141be1e7677">bp_Qjet</a>=1.7;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    }</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(0){ <span class="comment">// chosen to resolve disk then resolve jet</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a7a94b12c588980b5ab27f7eeafb87cff">bp_r1jet</a>=2.8;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a9892e7346ba03577d51d6df7813b8558">bp_njet1</a>=0.3;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a54158096cc3ecff6f170b1c73f37b4eb">bp_r0jet</a>=20.0;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a089b6a95e1b9ff1c17894dc843624fdc">bp_rsjet</a>=80.0;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a50374ed958868696ce52b141be1e7677">bp_Qjet</a>=1.8;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    }</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(1){</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a7a94b12c588980b5ab27f7eeafb87cff">bp_r1jet</a>=2.8;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a9892e7346ba03577d51d6df7813b8558">bp_njet1</a>=0.1; <span class="comment">// MARKNOTE set to 0.3 before using BP values</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a54158096cc3ecff6f170b1c73f37b4eb">bp_r0jet</a>=35.0;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a089b6a95e1b9ff1c17894dc843624fdc">bp_rsjet</a>=30.0;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a50374ed958868696ce52b141be1e7677">bp_Qjet</a>=1.9;<span class="comment">//-hslope; // chosen to help keep jet resolved even within disk region</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    }</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="comment">// for switches from normal theta to ramesh theta</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a00cd3b5afe216561157f1f3a53d8610e">bp_rs</a>=200.0; <span class="comment">// shift</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#ac6c2bb2b523c5805b7df12b34a6287eb">bp_r0</a>=60.0; <span class="comment">// divisor</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160; </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="comment">// for switches from innermost region of disk (inside horizon) to regular disk to increase timestep set by smallest vertical cell size</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#aa54849ebc8093319bbf05517dfc21110">bp_rsinner</a>=2.0;<span class="comment">//5.6;//4.0*Rin; //MAVARACHANGE changed from 4. and added the Rin so that the ratio bp_rsinner/r doesn&#39;t grow too large or too fast. maybe make that ratio **.5 to be even safer?</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#aa35f0e92f938a8111f280383c6c34697">bp_r0inner</a>=1.33; <span class="comment">//maybe 1.0 is too quick? not really same problem as outer radii I suppose since it just flattens off;</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="comment">// for theta1</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="comment">//    hslope=0.3 ; // resolve inner-radial region near equator</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a5a867407978fba43d13a1bf73039e623">bp_r0jet3</a>=200.0; <span class="comment">// divisor</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a4094a39b7ecf5cd989692b3997bc2f0a">bp_rsjet3</a>=0.0; <span class="comment">//MAVARANOTE0.0; // subtractor</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="comment">// for theta2</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a95ffc6e8abca3051b2b5163e21d0c135">bp_h0</a>=0.1; <span class="comment">// inner-radial &quot;hslope&quot; for theta2</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="comment">// GODMARK: Note that this overwrites above njet!</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#af88a4fd7d71742e941f216f36ad6b54a">bp_njet</a>=0.5;  <span class="comment">// MARKNOTE set to 1.0 before using BP values // power \theta_j \propto r^{-njet}</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="comment">// see fix_3dpoledtissue.nb</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="preprocessor">#if(0)//HIGHRES // MAVARACHANGE I choose this because bp_ntheta 5 is less than the 0 used for the thin regime for the bp study. so, 5 note extreme enough.</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="preprocessor"></span>    <a class="code" href="../../d9/de9/coord_8c.html#a0cb81219b4699253263ef5166f5fcb5f">bp_ntheta</a>=21.0; <span class="comment">//13.0; // MAVARANOTE only use 21 for high res, use 15 for mid-res, non for low-res</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a2c9c35b3b93e28fb584cd7abc86177aa">bp_htheta</a>=0.45; <span class="comment">// changed from .15 to be in line with my own additions for theta-flaring</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a0bd0efdb0c8c30cbfa8174f4786c260d">bp_rsjet2</a>=5.0;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a5bb1f817cc895142f229f3275204fb08">bp_r0jet2</a>=2.0;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#if(1) //MIDRES    note that lowres doesn&#39;t use polefix code</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="preprocessor"></span>    <a class="code" href="../../d9/de9/coord_8c.html#a0cb81219b4699253263ef5166f5fcb5f">bp_ntheta</a>=15.0;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a2c9c35b3b93e28fb584cd7abc86177aa">bp_htheta</a>=0.15;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a0bd0efdb0c8c30cbfa8174f4786c260d">bp_rsjet2</a>=5.0;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a5bb1f817cc895142f229f3275204fb08">bp_r0jet2</a>=2.0;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  }</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a5e2e2deaaa6af505fdb3c7b3c2f817a5">JET5COORDS</a>) {</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="comment">// exp grid merged with exp-exp grid</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="comment">// parameters solved using hyperexp_gridnew.nb</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="comment">// Depends upon Rin, Rout, Rj, totalsize[1], and for below we used Rin=1.2, Rout=10^(10), Rj=200, TS1=256, and ii0,CC,Rj for radial arctan</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="comment">// Rj probably doesn&#39;t have to be the same thing, but for now it is since this is where grid changes alot and after which much lower resolution</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="preprocessor">#define JET5TOTALSIZE (256)</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define JET5RIN (1.2)</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define JET5ROUT (1.0E10)</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="comment">// checks</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1]!=<a class="code" href="../../d9/de9/coord_8c.html#a66c5b3605607b94455d0c6bb598334f6">JET5TOTALSIZE</a>){</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;      dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Current version of JET5COORDS requires totalsize[1]=256\n&quot;</span>);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      myexit(348766346);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    }</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="comment">// probably don&#39;t need to set Rout, but should in case user expects it</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>=<a class="code" href="../../d9/de9/coord_8c.html#ac37b157905a8fc5a13832315dfaf4c15">JET5RIN</a>;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>=<a class="code" href="../../d9/de9/coord_8c.html#ad7eca34ae4210e8457830eb7dff9e0e3">JET5ROUT</a>;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a4a1725236323ec7cbb4359d2485c529d">AAAA</a>=1999999.0/10000000.0; <span class="comment">// 0.1999999</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>=<a class="code" href="../../d9/de9/coord_8c.html#a4a1725236323ec7cbb4359d2485c529d">AAAA</a>; <span class="comment">// effectively R0 is AAAA</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a2c72f016de11e17e0a2e6fa70d147632">AAA</a>=0.0413459589685779052930351140071389811117796472908765122327766247871075306910922595355681060060416677474341974954736231119642058094;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="comment">//         \</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">    //      4691814961939384683077670140242359180355488020296128748293771170061841869426340268505040612342717691948841149166838622798123171255523798596 \</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment">    //      5818680547438536476798449141070248313113472199351567812172169767872353912078416440520778774394376979127646837398673038048093220394452697865 \</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">    //      6270959185899435937659309684785579314134506823471357528404980034204759236451791458247221099942310718563615360919275492961171913096250029921 \</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment">    //      4602829374292931981963109018352727784709700476977587800651816760158953266217495724111120779750291873137970716049214552447910902507302350084 \</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment">    //      8366635098055440220680071046750709751515603946356328254368704921793804765397498748680467740257796496333857261456594221499641719912265168350 \</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment">    //      4446757128527854665947791196023009608509876847107243924551220166086198337782848685465542023953471925358173682394567187686793903610577481426 \</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment">    //      443229809938992518536215813767712488;</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#ae48fe9ae969558bf17a1cdbd2d0deb5b">BBB</a>=-11.730265173318042629015657514515818843547237290015385234914265620733433049284290050282184485;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="comment">//         \</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">    //      2224409622873658975481691490225985175297668826368377571878745806585146061321107420949292473465725043868512923396688827607703073903863397993 \</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">    //      2646469619777851403629789176127509226495862609935541778298333029485043643870849780090683673135501928153917249217151527805740858293313649525 \</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">    //      1577278440925240711864457756461606512526439401436022717818816632223921127138564528631741386676062985954517161211597241100034689634177608896 \</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">    //      2609005653930210512763437351860547338180817425783109360814416873897105930531521949202423966791692201348394578245024979983828552773565452313 \</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">    //      9427391374740569005171185204456464084827678985364372511780199067938494425840793867427758167352923180341529476553568176436448946131066359190 \</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">    //      5940692681151957860911707070494249851557079085990630079038126862565401104450140890585318688339870170091825436768403083368348398427545899255 \</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">    //      91796942327692774760083202686018064712337746785361430187509415618384926325;</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a333d082b5608e2d1dc51ef0194ed866e">DDD</a>=0.055717934049496306640561701541245682756775321774122925900528950779091605796182691888079948813285317249415181430716632182425357598150;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="comment">//         \</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">    //      9878315509631578902141939586183299923885176395546296181175926730413185041822815279504848229461737912619728960820136753407636343528158363579 \</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">    //      3015197668283754748946354820375719585870499599501931419253237151291548191762172574322092394412311930543039905230389647665970462514296542459 \</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">    //      6284119291308204987329361603064178657563059514526318343174490238136571828705510375083642956288576409110703492926390263521348433706396587719 \</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">    //      4076567127699214794076208495287633220730415894184618889390695112123895752908866508866230483057346798669374527001159485781544411226064994838 \</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">    //      9334249843823760573294461519240571810219944708047592001849464422681300782954876398308748055099942704435601529920984600254710048152168797114 \</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment">    //      1500470907761667436213106445853175905130588447192393215135706743963572902579082652204804896110286228839660989062139576983695311500579346405 \</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment">    //      67924814417848136324354859648264319;</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="comment">// control radial arctan</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a5c290996245039518a5b33e0ea065efc">ii0</a>=(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>)(<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1])*0.5;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#abcc0aa57debd9aa5e7f1aa918a2a3c1a">CCCC</a>=5.0;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#abf5c838329a6a04b2bc88d8b71ae1bba">Rj</a>=200.0;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;   </div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="comment">// control \theta&#39;s arctan</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a941700197dd24e782cbb0add66a42dbd">r1jet</a>=2.8;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>=0.3;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>=20.0;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>=80.0;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#ab0e0c0acf7cc9040907c895921b3fed7">Qjet</a>=1.3; <span class="comment">// chosen to help keep jet resolved even within disk region</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  }</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a87e4392d8d6cdc988ced46d7e7a2dfe2">PULSARCOORDS</a>) {</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="keywordflow">if</span>(0){<span class="comment">// pulsar in force free</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      <span class="comment">// pulsar_grid.nb for theta part and for the radial part:</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;      <span class="comment">// see pulsar_gridnew.nb</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      <span class="comment">// for Rout=10^6 and R0=0.786*Rin Rin=4.84, npow=10 gives same dr/r as npow=1 R0=0.9*Rin at r=Rin</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>=1.0;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;      </div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;      <span class="comment">// must be same as in dxdxp()</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>=5.0; <span class="comment">// spread in radius over which hslope changes</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>=18.0; <span class="comment">// location of current sheet beginning for NS pulsar</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    }</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(1){ <span class="comment">// NS-pulsar in GRMHD</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>=10.0;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>=5.0; <span class="comment">// spread in radius over which hslope changes</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>=15.0; <span class="comment">// location of current sheet beginning for NS pulsar</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    }</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  }</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a47b225226fbd0e3e573ec095071ecc10">UNIFORMCOORDS</a>) {</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="comment">//uniform grid for Cartesian coordinates</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  }</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#adf7ec499e840df38ef6d0230239d75e2">BILOGCYLCOORDS</a>) {</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>=10.0; <span class="comment">// exponential rate</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  }</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#aa0a3d1a614796ea8787d7360932b121c">RAMESHCOORDS</a> || defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a320ee4f267db4b195bbde94bec748a29">RAMESHCOORDS_HALFDISK</a>) {</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="comment">//    myhslope=pow( (*r-rsjet)/r0jet , njet);</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>=10.0;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="comment">//npow=3.0;</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>=2.0; <span class="comment">// divisor</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>=0.34; <span class="comment">// power \theta_j \propto r^{-njet}</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="comment">//njet=1.0;</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>=0.5; <span class="comment">// subtractor</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  }</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a6e1b80715afcab76e5ec0827d7113aa9">JET4COORDS</a> ) {</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="comment">// see net_jet_grid.nb</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="comment">// for small Rout, should use R0~0 (i.e. instead  use R0~-3) or hslope&gt;1</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <span class="comment">// this coordinate system uses:  R0 and npow for radius , hslope for theta1 , rsjet and r0 for switch and switchi , h0, rs, r0, njet for theta2 (as in JET3COORDS)</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="comment">// npow, R0, rs, r0, hslope, h0, r0jet, rsjet, njet</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="comment">// for radial grid</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>=1.0;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="comment">// npow=10.0;</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="comment">//npow=3.0;</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a> = -3.0;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;   </div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="comment">// for switches</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#aaa4f963acaccd1ea63a18f800fd576a1">rs</a>=15.0;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a54081391e09395407d47aec84f3d97c9">r0</a>=25.0;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160; </div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="comment">// for theta1</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a93f06eb0b7c274f722a7e09d4861a941">hslope</a>=0.3 ; <span class="comment">// resolve inner-radial region near equator</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="comment">// below 2 not used right now</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>=15.0; <span class="comment">// divisor</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>=0.0; <span class="comment">// subtractor</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="comment">// for theta2</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>=0.34; <span class="comment">// power \theta_j \propto r^{-njet}</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  }</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a35d1eed7020c0beb59e9b6432fd68175">UNI2LOG</a>) {</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <span class="keywordflow">if</span>(1){</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a71a9672d1d7564295af1d92b16656ed2">Nstar</a> = 20; <span class="comment">// # of cells between Rin and Rstar (probably Rin=0)</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a9a25d0159341c4801263a705248546a9">Afactor</a> = 1000.0; <span class="comment">// roughly Rout/Rstar</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    }</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      <span class="comment">// GODMARK</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a71a9672d1d7564295af1d92b16656ed2">Nstar</a> = 0; </div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a9a25d0159341c4801263a705248546a9">Afactor</a> = 1.01;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    }</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  }</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Shouldn&#39;t reach end of set_coord_parms: You set defcoordlocal=%d\n&quot;</span>,defcoordlocal);</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    myexit(1);</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  }</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;}</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;</div>
<div class="line"><a name="l00631"></a><span class="lineno"><a class="code" href="../../d6/d85/coord_8funcdeclare_8h.html#afe287fe0a55bbf3b69020d103da8b6cd">  631</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d9/de9/coord_8c.html#afe287fe0a55bbf3b69020d103da8b6cd" title="stuff that depends upon ANYTHING external that might be set by user in init_grid() or by system in in...">set_coord_parms_deps</a>(<span class="keywordtype">int</span> defcoordlocal)</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;{</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="preprocessor">#if(USEOPENMP)</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">if</span>(omp_in_parallel()){</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;set_coord_parms_deps() called in parallel region\n&quot;</span>);</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    myexit(784653446);</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  }</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  <span class="comment">// assumes R0, Rin, Rout, and hslope are so general that are set in init.c</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#abbc29b306372314c9c2c6cb50fadbe6f">USERCOORD</a>) {</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="../../d8/d60/init_8c.html#a10c3c3d6904d7adfe36e271a5dbe3bff">set_coord_parms_deps_user</a>(<span class="keywordtype">int</span> defcoordlocal);</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <a class="code" href="../../d8/d60/init_8c.html#a10c3c3d6904d7adfe36e271a5dbe3bff">set_coord_parms_deps_user</a>(defcoordlocal);</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  }</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a99c6ba3b86430e6eb5a179c57fd58070">LOGRSINTH</a>) {</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  }</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a174565dd3f50428c4c4d1e4a23019414">REBECCAGRID</a>) {</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  }</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a3ebede6f897039b55ee0d8f75b359640">COMPLEX0TH</a>) {</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  }</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#aeb733e0ec20094a219e120e3e9b22a0f">UNIRSINTH</a> || defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a8e2797c3dc060d13c29fd562d98d3bf8">UNIRSINTH2</a>){</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  }</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#aa2630728190374841bd88da517faffb9">EQMIRROR</a>) {</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  }</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a3ba253bfcb09b67c4f83cf604be1b4c4">COMPLEX1TH</a>) {</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  }</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a363db929c2617ac441c63fe7d9847d30">COMPLEX2TH</a>) {</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a7ddf946840a6c53afc9e37674503dd79">thetatores</a>=2.5*<a class="code" href="../../d8/d5b/defs_8general_8h.html#adde294c8217a66e6dd6605a392901ac9" title="IC.">h_over_r</a>;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <span class="comment">// fixed coefficients</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#adf33edafc727f90e926d3f491f6bb4cb">m2</a>=(3.*(-2.*<a class="code" href="../../d9/de9/coord_8c.html#a7ddf946840a6c53afc9e37674503dd79">thetatores</a> + M_PI))/(2.*<a class="code" href="../../d9/de9/coord_8c.html#a460b151eb6590a200f27826e97dcc248">x2trans</a>) + (4.*<a class="code" href="../../d9/de9/coord_8c.html#a7ddf946840a6c53afc9e37674503dd79">thetatores</a>)/(-1. + 2.*<a class="code" href="../../d9/de9/coord_8c.html#a460b151eb6590a200f27826e97dcc248">x2trans</a>);</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#aab5d055c59dc5dbfcaef566bb6061530">d2</a>=(2.*<a class="code" href="../../d9/de9/coord_8c.html#a7ddf946840a6c53afc9e37674503dd79">thetatores</a> - M_PI + 2.*M_PI*<a class="code" href="../../d9/de9/coord_8c.html#a460b151eb6590a200f27826e97dcc248">x2trans</a>)/(-2.*pow(<a class="code" href="../../d9/de9/coord_8c.html#a460b151eb6590a200f27826e97dcc248">x2trans</a>,3.) + 4.*pow(<a class="code" href="../../d9/de9/coord_8c.html#a460b151eb6590a200f27826e97dcc248">x2trans</a>,4.));</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a30a1474e2de8b7ed353e5948debd63b0">c2</a>=(6.*<a class="code" href="../../d9/de9/coord_8c.html#a7ddf946840a6c53afc9e37674503dd79">thetatores</a> - 3.*M_PI + 6.*M_PI*<a class="code" href="../../d9/de9/coord_8c.html#a460b151eb6590a200f27826e97dcc248">x2trans</a>)/(2.*pow(<a class="code" href="../../d9/de9/coord_8c.html#a460b151eb6590a200f27826e97dcc248">x2trans</a>,2.) - 4.*pow(<a class="code" href="../../d9/de9/coord_8c.html#a460b151eb6590a200f27826e97dcc248">x2trans</a>, 3.));</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a1965dec5c9e70ada83cd756e549d5891">m3</a>=(2.*<a class="code" href="../../d9/de9/coord_8c.html#a7ddf946840a6c53afc9e37674503dd79">thetatores</a>)/(1. - 2.*<a class="code" href="../../d9/de9/coord_8c.html#a460b151eb6590a200f27826e97dcc248">x2trans</a>);</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#ada4d4828a4429bb1fbae02df87b2d79c">b3</a>=M_PI/2. + <a class="code" href="../../d9/de9/coord_8c.html#a7ddf946840a6c53afc9e37674503dd79">thetatores</a>/(-1. + 2.*<a class="code" href="../../d9/de9/coord_8c.html#a460b151eb6590a200f27826e97dcc248">x2trans</a>);</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  }</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a78f877fef6d5148b40adc3d6d93c7ad0">LOGRUNITH</a>) { <span class="comment">// uniform theta and log in radius</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  }</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a6903d2cdfaf212b975c4fffa9402fa9c">JET1COORDS</a>) {</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#af5c3d95ab07a3b7fdff23bdde44b6ed0">h0</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a93f06eb0b7c274f722a7e09d4861a941">hslope</a>;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a35f9f2c4f84077be4f200673dffd57ca">myrout</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a73f761b44de3c4480a924658b0f3efc5">dmyhslope1dr</a> = (<a class="code" href="../../d9/de9/coord_8c.html#ad92c165f272791724422d0628071b170">hf</a>-<a class="code" href="../../d9/de9/coord_8c.html#af5c3d95ab07a3b7fdff23bdde44b6ed0">h0</a>)/(<a class="code" href="../../d9/de9/coord_8c.html#a35f9f2c4f84077be4f200673dffd57ca">myrout</a>-<a class="code" href="../../d9/de9/coord_8c.html#ac07d708f65a53c2ed0761d11bc97d46d">rh0</a>);</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a084470ae408b08254f2247015f988570">dmyhslope2dx1</a>=(<a class="code" href="../../d9/de9/coord_8c.html#ad92c165f272791724422d0628071b170">hf</a>-<a class="code" href="../../d9/de9/coord_8c.html#af5c3d95ab07a3b7fdff23bdde44b6ed0">h0</a>)/(<a class="code" href="../../d9/de9/coord_8c.html#a057ccc6a8480fa1e4b95bb8e928a27c0">x1out</a>-<a class="code" href="../../d9/de9/coord_8c.html#a05bf2e602378f34e74ff69f35b1991d9">x1in</a>);</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a05bf2e602378f34e74ff69f35b1991d9">x1in</a>=log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>-<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>);</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a057ccc6a8480fa1e4b95bb8e928a27c0">x1out</a>=log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>);</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  }</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a3e3cceb2f708009494c25912bd2470f4">JET2COORDS</a>) {</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  }</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a77ba1498bcda3890f2a37bb5979a1eec">JET3COORDS</a>) {</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  }</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a8cb1a8a42445cede081c2ddfaa98113f">SJETCOORDS</a>) {   <span class="comment">// AKMARK</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment"></span>    <span class="comment">// RADIAL GRID SETUP</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="comment"></span>    <a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a7577be3f38a9fdd3221a033524626c42" title="SOME GRID VARIABLES.">global_npow</a>;  <span class="comment">//don&#39;t change it, essentially equivalent to changing cpow2</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="comment">//radial hyperexponential grid</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a119eed5c7b218e4a9547a2e0c1a8d4fe">npow2</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a14b0c95c8d7fb6f3ce4e3df01890256f">global_npow2</a>; <span class="comment">//power exponent</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a9b4b0ea2888bdfb7e987f43be8dee6db">cpow2</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a39fd23945d6f97b35b751c9099572346">global_cpow2</a>; <span class="comment">//exponent prefactor (the larger it is, the more hyperexponentiation is)</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a1196767f0fc1292fff1d9ee90d7fd3ff">rbr</a> = <a class="code" href="../../d8/d5b/defs_8general_8h.html#a6ada59d8a0cc78531f368020b79ed4c2">global_rbr</a>;  <span class="comment">//radius at which hyperexponentiation kicks in</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a7c7295d071bc7960f6b2fe9b8ab730ac">x1br</a> = log( <a class="code" href="../../d9/de9/coord_8c.html#a1196767f0fc1292fff1d9ee90d7fd3ff">rbr</a> - <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a> ) / <a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>;  <span class="comment">//the corresponding X[1] value</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="comment">//ANGULAR GRID SETUP</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a7c9ef3dd93e82818da1c93b9d159483d">x10</a> = <a class="code" href="../../d8/d5b/defs_8general_8h.html#a6cf3d433fa9e13d01e8551ff43685aa6" title="ANGULAR GRID SETUP.">global_x10</a>;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a3b4850579b329099634861408a9e25df">x20</a> = <a class="code" href="../../d8/d5b/defs_8general_8h.html#a7eec213317856fd5caaeee5290ce2d55">global_x20</a>;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;     </div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <span class="comment">//transverse resolution fraction devoted to different components</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="comment">//(sum should be &lt;1)</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a8365b4ccf09b73479da0374726417db8">fracdisk</a> = <a class="code" href="../../d8/d5b/defs_8general_8h.html#adeb2843de4df91556dbea17be71baafc">global_fracdisk</a>;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a8d5416128840a1ac3f7c18af1619e553">fracjet</a> = <a class="code" href="../../d8/d5b/defs_8general_8h.html#a44e39041bafac22b73007bef21e8b578">global_fracjet</a>;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a771a5cedc0bb12d13ea9cb76eff5cd42">jetnu</a> = <a class="code" href="../../d8/d5b/defs_8general_8h.html#a65e36a8b4c3d27926c2cb39778027741">global_jetnu</a>;  <span class="comment">//the nu-parameter that determines jet shape</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="comment">//subtractor, controls the size of the last few cells close to axis:</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="comment">//if rsjet = 0, then no modification &lt;- *** default for use with grid cylindrification</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <span class="comment">//if rsjet ~ 0.5, the grid is nearly vertical rather than monopolar,</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="comment">//                which makes the timestep larger</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a> = <a class="code" href="../../d8/d5b/defs_8general_8h.html#a619586f3509c6b5538021dd9f5452cb5">global_rsjet</a>; </div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="comment">//distance at which theta-resolution is *exactly* uniform in the jet grid -- want to have this at BH horizon;</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="comment">//otherwise, near-uniform near jet axis but less resolution (much) further from it</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="comment">//the larger r0grid, the larger the thickness of the jet </span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <span class="comment">//to resolve</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a785b0a4bf2ba821005a429e176f8e130">r0grid</a> = <a class="code" href="../../d8/d5b/defs_8general_8h.html#a7b65fd929bc29a1658b89bf13f082861">global_r0grid</a>;    </div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <span class="comment">//distance at which jet part of the grid becomes monopolar</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <span class="comment">//should be the same as r0disk to avoid cell crowding at the interface of jet and disk grids</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a> = <a class="code" href="../../d8/d5b/defs_8general_8h.html#a8c637b70816fa40ba3ad07d7eb209c9e">global_r0jet</a>;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    </div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <span class="comment">//distance after which the jet grid collimates according to the usual jet formula</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <span class="comment">//the larger this distance, the wider is the jet region of the grid</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a46d4c41abf34a76cec7353209c94905c">rjetend</a> = <a class="code" href="../../d8/d5b/defs_8general_8h.html#a0bb499f12a59b1376c71eab4398643a3">global_rjetend</a>;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    </div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <span class="comment">//distance at which disk part of the grid becomes monopolar</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <span class="comment">//the larger r0disk, the larger the thickness of the disk </span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="comment">//to resolve</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#af36620e0e23c6f08616e2be183b09958">r0disk</a> = <a class="code" href="../../d8/d5b/defs_8general_8h.html#a91b9435a7fff8277d5de66790697a339">global_r0disk</a>;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="comment">//distance after which the disk grid collimates to merge with the jet grid</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="comment">//should be roughly outer edge of the disk</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a40bbfe3eb99d3c1da07a520db92a243e">rdiskend</a> = <a class="code" href="../../d8/d5b/defs_8general_8h.html#a29e59899e4aef1f29183565cdebf989e">global_rdiskend</a>;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="preprocessor">#if(USESJETLOGHOVERR)</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="preprocessor"></span>    <a class="code" href="../../d9/de9/coord_8c.html#ae069412a47af2715a20ebd2cb47513e9">torusrmax_loc</a> = <a class="code" href="../../d9/de9/coord_8c.html#a5ea0fae0c3b762346c819d02b056c61b">torusrmax</a>;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="preprocessor"></span>    <a class="code" href="../../d9/de9/coord_8c.html#ae069412a47af2715a20ebd2cb47513e9">torusrmax_loc</a> = 0.; <span class="comment">//if not used, fill with dummy value</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <span class="comment">//PHI GRID SETUP</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="comment"></span>    <span class="keywordflow">if</span>( <a class="code" href="../../d8/d5b/defs_8general_8h.html#a089706c546fc30d0b60ae9d6eb0a89ea">dofull2pi</a> ) {</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a9c9f5f22dd4a5da08e734903ab82659f">fracphi</a> = 1;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    }</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a9c9f5f22dd4a5da08e734903ab82659f">fracphi</a> = <a class="code" href="../../d8/d5b/defs_8general_8h.html#a73770f2b80a456c7547fdf67da59a133" title="PHI GRID SETUP.">global_fracphi</a>;  <span class="comment">//phi-extent measured in units of 2*PI, i.e. 0.25 means PI/2</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    }   </div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  }</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a725469cd082a278dfc44a41e28eca44c">JET6COORDS</a>) {</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a7c7295d071bc7960f6b2fe9b8ab730ac">x1br</a> = log( <a class="code" href="../../d9/de9/coord_8c.html#a1196767f0fc1292fff1d9ee90d7fd3ff">rbr</a> - <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a> ) / <a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>;  <span class="comment">//the corresponding X[1] value</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  }</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a22ccf670681b96ce61d974db87204a10">BPTHIN1</a>) {</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <span class="comment">//PHI GRID SETUP</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="comment"></span>    <span class="keywordflow">if</span>( <a class="code" href="../../d8/d5b/defs_8general_8h.html#a089706c546fc30d0b60ae9d6eb0a89ea">dofull2pi</a> ) {</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a9c9f5f22dd4a5da08e734903ab82659f">fracphi</a> = 1;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    }</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a9c9f5f22dd4a5da08e734903ab82659f">fracphi</a> = <a class="code" href="../../d8/d5b/defs_8general_8h.html#a73770f2b80a456c7547fdf67da59a133" title="PHI GRID SETUP.">global_fracphi</a>;  <span class="comment">//phi-extent measured in units of 2*PI, i.e. 0.25 means PI/2</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    }   </div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a4fa1cafdb60ad24851dcf7f6a85d196c">bp_x1br</a> = log( <a class="code" href="../../d9/de9/coord_8c.html#a51855c9f2c2f77df27842fd0cdcb25f6">bp_rbr</a> - <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a> ) / <a class="code" href="../../d9/de9/coord_8c.html#a565a42e16bf3620bb640120f8c1a4e2a">bp_npow</a>;  <span class="comment">//the corresponding X[1] value</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  }</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a0e5331f6ac2b706aa4e76de967dcb1d7">JET6COORDSTHIN</a>) {</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    th_x1br = log( th_rbr - <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a> ) / <a class="code" href="../../d9/de9/coord_8c.html#ae5abebf1f6c7a6931bf0136d15cebc1c">th_npow</a>;  <span class="comment">//the corresponding X[1] value</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;  }</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a5e2e2deaaa6af505fdb3c7b3c2f817a5">JET5COORDS</a>) {</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  }</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a87e4392d8d6cdc988ced46d7e7a2dfe2">PULSARCOORDS</a>) {</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <span class="keywordflow">if</span>(0){<span class="comment">// pulsar in force free</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#adb91c14ac2eecf2e4745073392a7af6f">hinner</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a93f06eb0b7c274f722a7e09d4861a941">hslope</a>; <span class="comment">// hslope specifies inner hslope</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a808590103058909774d170d48f1e5723">houter</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a93f06eb0b7c274f722a7e09d4861a941">hslope</a>*0.05; <span class="comment">// reduce by some arbitrary factor (currently 1/20)</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    }</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(1){ <span class="comment">// NS-pulsar in GRMHD</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#adb91c14ac2eecf2e4745073392a7af6f">hinner</a>=1.9*<a class="code" href="../../d8/d5b/defs_8general_8h.html#a93f06eb0b7c274f722a7e09d4861a941">hslope</a>; <span class="comment">// hslope specifies inner hslope</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;      <span class="comment">//houter=hslope*0.001; // reduce by some arbitrary factor (currently 1/20)</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a808590103058909774d170d48f1e5723">houter</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a93f06eb0b7c274f722a7e09d4861a941">hslope</a>*1.5; <span class="comment">// increase houter up to 2.0</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    }</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;  }</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a47b225226fbd0e3e573ec095071ecc10">UNIFORMCOORDS</a>) {</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;  }</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#adf7ec499e840df38ef6d0230239d75e2">BILOGCYLCOORDS</a>) {</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;  }</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#aa0a3d1a614796ea8787d7360932b121c">RAMESHCOORDS</a> || defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a320ee4f267db4b195bbde94bec748a29">RAMESHCOORDS_HALFDISK</a>) {</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  }</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a6e1b80715afcab76e5ec0827d7113aa9">JET4COORDS</a> ) {</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <span class="comment">// for theta2</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#af5c3d95ab07a3b7fdff23bdde44b6ed0">h0</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a93f06eb0b7c274f722a7e09d4861a941">hslope</a>; <span class="comment">// inner-radial &quot;hslope&quot; for theta2</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;  }</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a35d1eed7020c0beb59e9b6432fd68175">UNI2LOG</a>) {</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <span class="keywordflow">if</span>(1){</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#acbb89ba805d17640710dea9b25fc385e">Rstar</a> = 10.0*1E5/<a class="code" href="../../d8/d5b/defs_8general_8h.html#a73328c615b6665ae65a6b5cce39ca977">Lunit</a>; <span class="comment">// 10km</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    }</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;      <span class="comment">// GODMARK</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#acbb89ba805d17640710dea9b25fc385e">Rstar</a> = <a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    }</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    </div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../d9/de9/coord_8c.html#a71a9672d1d7564295af1d92b16656ed2">Nstar</a>==0){</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      <span class="keywordflow">if</span>(fabs(<a class="code" href="../../d9/de9/coord_8c.html#acbb89ba805d17640710dea9b25fc385e">Rstar</a>-<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>)&gt;<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a09c78d2f8feb311dd9fc969a0bf84979">SMALL</a>){</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;If Nstar=0 then Rstar=Rin must be set\n&quot;</span>);</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        myexit(9279);</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      }</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    }</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    </div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    trifprintf(<span class="stringliteral">&quot;Rstar = %26.20g Nstar=%d Afactor=%26.20g\n&quot;</span>,<a class="code" href="../../d9/de9/coord_8c.html#acbb89ba805d17640710dea9b25fc385e">Rstar</a>,<a class="code" href="../../d9/de9/coord_8c.html#a71a9672d1d7564295af1d92b16656ed2">Nstar</a>,<a class="code" href="../../d9/de9/coord_8c.html#a9a25d0159341c4801263a705248546a9">Afactor</a>);</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  }</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Shouldn&#39;t reach end of set_coord_parms: You set defcoordlocal=%d\n&quot;</span>,defcoordlocal);</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    myexit(1);</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;  }</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;}</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;</div>
<div class="line"><a name="l00826"></a><span class="lineno"><a class="code" href="../../d6/d85/coord_8funcdeclare_8h.html#a3a0b85792ff4269484f48bb95a0f0a3e">  826</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d9/de9/coord_8c.html#a3a0b85792ff4269484f48bb95a0f0a3e" title="write coordinate parameters">write_coord_parms</a>(<span class="keywordtype">int</span> defcoordlocal)</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;{</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;  FILE *out;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;  <span class="keywordtype">int</span> dimen;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="preprocessor">#if(USEOPENMP)</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">if</span>(omp_in_parallel()){</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;write_coord_parms_parms() called in parallel region\n&quot;</span>);</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    myexit(784653446);</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;  }</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;  <span class="keywordflow">if</span>(myid==0){</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <span class="keywordflow">if</span>((out=fopen(<span class="stringliteral">&quot;coordparms.dat&quot;</span>,<span class="stringliteral">&quot;wt&quot;</span>))==NULL){</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;      dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Couldn&#39;t write coordparms.dat file\n&quot;</span>);</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;      myexit(1);</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    }</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;      <span class="comment">// same for all coords (notice no carraige return)</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      fprintf(out,<span class="stringliteral">&quot;%26.20g %26.20g %26.20g %26.20g %d &quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a93f06eb0b7c274f722a7e09d4861a941">hslope</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a089706c546fc30d0b60ae9d6eb0a89ea">dofull2pi</a>);</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;      <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#abbc29b306372314c9c2c6cb50fadbe6f">USERCOORD</a>) {</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;        <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="../../d8/d60/init_8c.html#a7c6164a33eaf47d35c7fd283fdfbdc50">write_coord_parms_user</a>(<span class="keywordtype">int</span> defcoordlocal, FILE *out);</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        <a class="code" href="../../d8/d60/init_8c.html#a7c6164a33eaf47d35c7fd283fdfbdc50">write_coord_parms_user</a>(defcoordlocal,out);</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;      }</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a99c6ba3b86430e6eb5a179c57fd58070">LOGRSINTH</a>) {</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;      }</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a174565dd3f50428c4c4d1e4a23019414">REBECCAGRID</a>) {</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;      }</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a3ebede6f897039b55ee0d8f75b359640">COMPLEX0TH</a>) {</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;      }</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#aeb733e0ec20094a219e120e3e9b22a0f">UNIRSINTH</a> || defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a8e2797c3dc060d13c29fd562d98d3bf8">UNIRSINTH2</a>){</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;      }</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#aa2630728190374841bd88da517faffb9">EQMIRROR</a>) {</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;      }</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a3ba253bfcb09b67c4f83cf604be1b4c4">COMPLEX1TH</a>) {</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;      }</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a363db929c2617ac441c63fe7d9847d30">COMPLEX2TH</a>) {</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        fprintf(out,<span class="stringliteral">&quot;%26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g\n&quot;</span>,<a class="code" href="../../d9/de9/coord_8c.html#a460b151eb6590a200f27826e97dcc248">x2trans</a>,<a class="code" href="../../d9/de9/coord_8c.html#a7ddf946840a6c53afc9e37674503dd79">thetatores</a>,<a class="code" href="../../d9/de9/coord_8c.html#adf33edafc727f90e926d3f491f6bb4cb">m2</a>,<a class="code" href="../../d9/de9/coord_8c.html#aab5d055c59dc5dbfcaef566bb6061530">d2</a>,<a class="code" href="../../d9/de9/coord_8c.html#a30a1474e2de8b7ed353e5948debd63b0">c2</a>,<a class="code" href="../../d9/de9/coord_8c.html#a1965dec5c9e70ada83cd756e549d5891">m3</a>,<a class="code" href="../../d9/de9/coord_8c.html#ada4d4828a4429bb1fbae02df87b2d79c">b3</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#adde294c8217a66e6dd6605a392901ac9" title="IC.">h_over_r</a>);</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;      }</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a78f877fef6d5148b40adc3d6d93c7ad0">LOGRUNITH</a>) { <span class="comment">// uniform theta and log in radius</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a8cbb473515f18fcae523329c93f140dc">DIMENLOOP</a>(dimen) fprintf(out,<span class="stringliteral">&quot;%26.20g &quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a20ba1a68d196e97fa84463164fd907d1">Rin_array</a>[dimen]);</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a8cbb473515f18fcae523329c93f140dc">DIMENLOOP</a>(dimen) fprintf(out,<span class="stringliteral">&quot;%26.20g &quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#aff141f9f52f9bbd4911d4dabcf2aaec9">Rout_array</a>[dimen]);</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;        fprintf(out,<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;      }</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a6903d2cdfaf212b975c4fffa9402fa9c">JET1COORDS</a>) {</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        fprintf(out,<span class="stringliteral">&quot;%26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g\n&quot;</span>,<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>,<a class="code" href="../../d9/de9/coord_8c.html#af5c3d95ab07a3b7fdff23bdde44b6ed0">h0</a>,<a class="code" href="../../d9/de9/coord_8c.html#ad92c165f272791724422d0628071b170">hf</a>,<a class="code" href="../../d9/de9/coord_8c.html#ac07d708f65a53c2ed0761d11bc97d46d">rh0</a>,<a class="code" href="../../d9/de9/coord_8c.html#a35f9f2c4f84077be4f200673dffd57ca">myrout</a>,<a class="code" href="../../d9/de9/coord_8c.html#a73f761b44de3c4480a924658b0f3efc5">dmyhslope1dr</a>,<a class="code" href="../../d9/de9/coord_8c.html#a084470ae408b08254f2247015f988570">dmyhslope2dx1</a>,<a class="code" href="../../d9/de9/coord_8c.html#a05bf2e602378f34e74ff69f35b1991d9">x1in</a>,<a class="code" href="../../d9/de9/coord_8c.html#a057ccc6a8480fa1e4b95bb8e928a27c0">x1out</a>);</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;      }</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a3e3cceb2f708009494c25912bd2470f4">JET2COORDS</a>) {</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        fprintf(out,<span class="stringliteral">&quot;%26.20g %26.20g %26.20g %26.20g\n&quot;</span>,<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>,<a class="code" href="../../d9/de9/coord_8c.html#a941700197dd24e782cbb0add66a42dbd">r1jet</a>,<a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>,<a class="code" href="../../d9/de9/coord_8c.html#a508726935adb05ad4291b8c77897f8c5">rpjet</a>);</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;      }</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a77ba1498bcda3890f2a37bb5979a1eec">JET3COORDS</a>) {</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        fprintf(out,<span class="stringliteral">&quot;%26.20g %26.20g %26.20g %26.20g %26.20g %26.20g\n&quot;</span>,<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>,<a class="code" href="../../d9/de9/coord_8c.html#a941700197dd24e782cbb0add66a42dbd">r1jet</a>,<a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>,<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>,<a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>,<a class="code" href="../../d9/de9/coord_8c.html#ab0e0c0acf7cc9040907c895921b3fed7">Qjet</a>);</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;      }</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a8cb1a8a42445cede081c2ddfaa98113f">SJETCOORDS</a>) {</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        fprintf(out,<span class="stringliteral">&quot;%26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g\n&quot;</span>,<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>,<a class="code" href="../../d9/de9/coord_8c.html#a941700197dd24e782cbb0add66a42dbd">r1jet</a>,<a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>,<a class="code" href="../../d9/de9/coord_8c.html#a785b0a4bf2ba821005a429e176f8e130">r0grid</a>,<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>,<a class="code" href="../../d9/de9/coord_8c.html#a46d4c41abf34a76cec7353209c94905c">rjetend</a>,<a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>,<a class="code" href="../../d9/de9/coord_8c.html#ab0e0c0acf7cc9040907c895921b3fed7">Qjet</a>,<a class="code" href="../../d9/de9/coord_8c.html#a9c9f5f22dd4a5da08e734903ab82659f">fracphi</a>,<a class="code" href="../../d9/de9/coord_8c.html#a119eed5c7b218e4a9547a2e0c1a8d4fe">npow2</a>,<a class="code" href="../../d9/de9/coord_8c.html#a9b4b0ea2888bdfb7e987f43be8dee6db">cpow2</a>,<a class="code" href="../../d9/de9/coord_8c.html#a1196767f0fc1292fff1d9ee90d7fd3ff">rbr</a>,<a class="code" href="../../d9/de9/coord_8c.html#a7c7295d071bc7960f6b2fe9b8ab730ac">x1br</a>,<a class="code" href="../../d9/de9/coord_8c.html#a8365b4ccf09b73479da0374726417db8">fracdisk</a>,<a class="code" href="../../d9/de9/coord_8c.html#a8d5416128840a1ac3f7c18af1619e553">fracjet</a>,<a class="code" href="../../d9/de9/coord_8c.html#af36620e0e23c6f08616e2be183b09958">r0disk</a>,<a class="code" href="../../d9/de9/coord_8c.html#a40bbfe3eb99d3c1da07a520db92a243e">rdiskend</a>,<a class="code" href="../../d9/de9/coord_8c.html#ae069412a47af2715a20ebd2cb47513e9">torusrmax_loc</a>,<a class="code" href="../../d9/de9/coord_8c.html#a771a5cedc0bb12d13ea9cb76eff5cd42">jetnu</a>,<a class="code" href="../../d9/de9/coord_8c.html#a7c9ef3dd93e82818da1c93b9d159483d">x10</a>,<a class="code" href="../../d9/de9/coord_8c.html#a3b4850579b329099634861408a9e25df">x20</a>);</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;      }</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a725469cd082a278dfc44a41e28eca44c">JET6COORDS</a>) {</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        fprintf(out,<span class="stringliteral">&quot;%26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g\n&quot;</span>,<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>,<a class="code" href="../../d9/de9/coord_8c.html#a941700197dd24e782cbb0add66a42dbd">r1jet</a>,<a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>,<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>,<a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>,<a class="code" href="../../d9/de9/coord_8c.html#ab0e0c0acf7cc9040907c895921b3fed7">Qjet</a>,<a class="code" href="../../d9/de9/coord_8c.html#a83fde478856d3e284e192734eb140ce5">ntheta</a>,<a class="code" href="../../d9/de9/coord_8c.html#a2e5b7193188d9601aadc8d7f06fe121c">htheta</a>,<a class="code" href="../../d9/de9/coord_8c.html#a6ae559d1c0eb70aefa1b83129530a2fd">rsjet2</a>,<a class="code" href="../../d9/de9/coord_8c.html#a10ea48caa54649707c33041bc3bc298c">r0jet2</a>,<a class="code" href="../../d9/de9/coord_8c.html#a336034dbc5239e0fe15a337c19903374">rsjet3</a>,<a class="code" href="../../d9/de9/coord_8c.html#a7406e3812b73aed1b3ccef19bec31dab">r0jet3</a>,<a class="code" href="../../d9/de9/coord_8c.html#aaa4f963acaccd1ea63a18f800fd576a1">rs</a>,<a class="code" href="../../d9/de9/coord_8c.html#a54081391e09395407d47aec84f3d97c9">r0</a>,<a class="code" href="../../d9/de9/coord_8c.html#a119eed5c7b218e4a9547a2e0c1a8d4fe">npow2</a>,<a class="code" href="../../d9/de9/coord_8c.html#a9b4b0ea2888bdfb7e987f43be8dee6db">cpow2</a>,<a class="code" href="../../d9/de9/coord_8c.html#a1196767f0fc1292fff1d9ee90d7fd3ff">rbr</a>,<a class="code" href="../../d9/de9/coord_8c.html#a7c7295d071bc7960f6b2fe9b8ab730ac">x1br</a>,<a class="code" href="../../d9/de9/coord_8c.html#a26ece82e6d552d80914dd5ae149ade6f">cpow3</a>);</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;      }</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a0e5331f6ac2b706aa4e76de967dcb1d7">JET6COORDSTHIN</a>) {</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;        fprintf(out,<span class="stringliteral">&quot;%26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g\n&quot;</span>,th_npow,th_r1jet,th_njet,th_r0jet,th_rsjet,th_Qjet,th_ntheta,th_htheta,th_rsjet2,th_r0jet2,th_rsjet3,th_r0jet3,th_rs,th_r0,th_npow2,th_cpow2,th_rbr,th_x1br,th_rbr,th_h0,th_njet1);</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;      }</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a22ccf670681b96ce61d974db87204a10">BPTHIN1</a>) {</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        fprintf(out,<span class="stringliteral">&quot;%21.15g %21.15g %21.15g %21.15g %21.15g %21.15g %21.15g %21.15g %21.15g %21.15g %21.15g %21.15g %21.15g %21.15g %21.15g %21.15g %21.15g %21.15g %21.15g %21.15g %21.15g\n&quot;</span>,<a class="code" href="../../d9/de9/coord_8c.html#a565a42e16bf3620bb640120f8c1a4e2a">bp_npow</a>,<a class="code" href="../../d9/de9/coord_8c.html#a7a94b12c588980b5ab27f7eeafb87cff">bp_r1jet</a>,<a class="code" href="../../d9/de9/coord_8c.html#af88a4fd7d71742e941f216f36ad6b54a">bp_njet</a>,<a class="code" href="../../d9/de9/coord_8c.html#a54158096cc3ecff6f170b1c73f37b4eb">bp_r0jet</a>,<a class="code" href="../../d9/de9/coord_8c.html#a089b6a95e1b9ff1c17894dc843624fdc">bp_rsjet</a>,<a class="code" href="../../d9/de9/coord_8c.html#a50374ed958868696ce52b141be1e7677">bp_Qjet</a>,<a class="code" href="../../d9/de9/coord_8c.html#a0cb81219b4699253263ef5166f5fcb5f">bp_ntheta</a>,<a class="code" href="../../d9/de9/coord_8c.html#a2c9c35b3b93e28fb584cd7abc86177aa">bp_htheta</a>,<a class="code" href="../../d9/de9/coord_8c.html#a0bd0efdb0c8c30cbfa8174f4786c260d">bp_rsjet2</a>,<a class="code" href="../../d9/de9/coord_8c.html#a5bb1f817cc895142f229f3275204fb08">bp_r0jet2</a>,<a class="code" href="../../d9/de9/coord_8c.html#a4094a39b7ecf5cd989692b3997bc2f0a">bp_rsjet3</a>,<a class="code" href="../../d9/de9/coord_8c.html#a5a867407978fba43d13a1bf73039e623">bp_r0jet3</a>,<a class="code" href="../../d9/de9/coord_8c.html#a00cd3b5afe216561157f1f3a53d8610e">bp_rs</a>,<a class="code" href="../../d9/de9/coord_8c.html#ac6c2bb2b523c5805b7df12b34a6287eb">bp_r0</a>,<a class="code" href="../../d9/de9/coord_8c.html#aa54849ebc8093319bbf05517dfc21110">bp_rsinner</a>,<a class="code" href="../../d9/de9/coord_8c.html#aa35f0e92f938a8111f280383c6c34697">bp_r0inner</a>,<a class="code" href="../../d9/de9/coord_8c.html#a0cce4548534baf8c1e0f2fbdd706117c">bp_npow2</a>,<a class="code" href="../../d9/de9/coord_8c.html#aa3c25e2dcf468d66d223576997aaa124">bp_cpow2</a>,<a class="code" href="../../d9/de9/coord_8c.html#a51855c9f2c2f77df27842fd0cdcb25f6">bp_rbr</a>,<a class="code" href="../../d9/de9/coord_8c.html#a4fa1cafdb60ad24851dcf7f6a85d196c">bp_x1br</a>,<a class="code" href="../../d9/de9/coord_8c.html#a9c9f5f22dd4a5da08e734903ab82659f">fracphi</a>);   <span class="comment">// MARKTODO   add bp_h0? and add bp_njet1</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;      }</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a5e2e2deaaa6af505fdb3c7b3c2f817a5">JET5COORDS</a>) {</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        fprintf(out,<span class="stringliteral">&quot;%26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g\n&quot;</span>,<a class="code" href="../../d9/de9/coord_8c.html#a4a1725236323ec7cbb4359d2485c529d">AAAA</a>,<a class="code" href="../../d9/de9/coord_8c.html#a2c72f016de11e17e0a2e6fa70d147632">AAA</a>,<a class="code" href="../../d9/de9/coord_8c.html#ae48fe9ae969558bf17a1cdbd2d0deb5b">BBB</a>,<a class="code" href="../../d9/de9/coord_8c.html#a333d082b5608e2d1dc51ef0194ed866e">DDD</a>,<a class="code" href="../../d9/de9/coord_8c.html#a5c290996245039518a5b33e0ea065efc">ii0</a>,<a class="code" href="../../d9/de9/coord_8c.html#abcc0aa57debd9aa5e7f1aa918a2a3c1a">CCCC</a>,<a class="code" href="../../d9/de9/coord_8c.html#abf5c838329a6a04b2bc88d8b71ae1bba">Rj</a>);</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        fprintf(out,<span class="stringliteral">&quot;%26.20g %26.20g %26.20g %26.20g %26.20g\n&quot;</span>,<a class="code" href="../../d9/de9/coord_8c.html#a941700197dd24e782cbb0add66a42dbd">r1jet</a>,<a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>,<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>,<a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>,<a class="code" href="../../d9/de9/coord_8c.html#ab0e0c0acf7cc9040907c895921b3fed7">Qjet</a>);</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;      }</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a87e4392d8d6cdc988ced46d7e7a2dfe2">PULSARCOORDS</a>) {</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        fprintf(out,<span class="stringliteral">&quot;%26.20g %26.20g %26.20g %26.20g %26.20g\n&quot;</span>,<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>,<a class="code" href="../../d9/de9/coord_8c.html#adb91c14ac2eecf2e4745073392a7af6f">hinner</a>,<a class="code" href="../../d9/de9/coord_8c.html#a808590103058909774d170d48f1e5723">houter</a>,<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>,<a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>);</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;      }</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a47b225226fbd0e3e573ec095071ecc10">UNIFORMCOORDS</a>) {</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        <span class="comment">//uniform grid for Cartesian coordinates</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a8cbb473515f18fcae523329c93f140dc">DIMENLOOP</a>(dimen) fprintf(out,<span class="stringliteral">&quot;%26.20g &quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a20ba1a68d196e97fa84463164fd907d1">Rin_array</a>[dimen]);</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;        <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a8cbb473515f18fcae523329c93f140dc">DIMENLOOP</a>(dimen) fprintf(out,<span class="stringliteral">&quot;%26.20g &quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#aff141f9f52f9bbd4911d4dabcf2aaec9">Rout_array</a>[dimen]);</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;        fprintf(out,<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;      }</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#adf7ec499e840df38ef6d0230239d75e2">BILOGCYLCOORDS</a>) {</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        fprintf(out,<span class="stringliteral">&quot;%26.20g\n&quot;</span>,<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>);</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;      }</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#aa0a3d1a614796ea8787d7360932b121c">RAMESHCOORDS</a> || defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a320ee4f267db4b195bbde94bec748a29">RAMESHCOORDS_HALFDISK</a>) {</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        fprintf(out,<span class="stringliteral">&quot;%26.20g %26.20g %26.20g %26.20g\n&quot;</span>,<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>,<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>,<a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>,<a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>);</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;      }</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a6e1b80715afcab76e5ec0827d7113aa9">JET4COORDS</a>) {</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        <span class="comment">// npow, rs, r0, h0, r0jet, njet, rsjet</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        fprintf(out,<span class="stringliteral">&quot;%26.20g %26.20g %26.20g %26.20g %26.20g %26.20g %26.20g\n&quot;</span>,<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>,<a class="code" href="../../d9/de9/coord_8c.html#aaa4f963acaccd1ea63a18f800fd576a1">rs</a>,<a class="code" href="../../d9/de9/coord_8c.html#a54081391e09395407d47aec84f3d97c9">r0</a>,<a class="code" href="../../d9/de9/coord_8c.html#af5c3d95ab07a3b7fdff23bdde44b6ed0">h0</a>,<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>,<a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>,<a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>);</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;      }</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a35d1eed7020c0beb59e9b6432fd68175">UNI2LOG</a>) {</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        fprintf(out,<span class="stringliteral">&quot;%d %26.20g %26.20g\n&quot;</span>,<a class="code" href="../../d9/de9/coord_8c.html#a71a9672d1d7564295af1d92b16656ed2">Nstar</a>,<a class="code" href="../../d9/de9/coord_8c.html#acbb89ba805d17640710dea9b25fc385e">Rstar</a>,<a class="code" href="../../d9/de9/coord_8c.html#a9a25d0159341c4801263a705248546a9">Afactor</a>);</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;      }</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;      <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Shouldn&#39;t reach end of write_coord_parms: You set defcoordlocal=%d\n&quot;</span>,defcoordlocal);</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        myexit(1);</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;      }</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;      fclose(out);</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    }</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;  }</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;}</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;</div>
<div class="line"><a name="l00932"></a><span class="lineno"><a class="code" href="../../d6/d85/coord_8funcdeclare_8h.html#a78425dc3bae629a1a4f7f9926de1aba3">  932</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d9/de9/coord_8c.html#a78425dc3bae629a1a4f7f9926de1aba3" title="read coordinate parameters">read_coord_parms</a>(<span class="keywordtype">int</span> defcoordlocal)</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;{</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  FILE *in;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> ftemp;</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;  <span class="keywordtype">int</span> dimen;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;<span class="preprocessor">#if(USEOPENMP)</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">if</span>(omp_in_parallel()){</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;read_coord_parms_parms() called in parallel region\n&quot;</span>);</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    myexit(784653446);</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;  }</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="preprocessor"></span>  </div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;  <span class="keywordflow">if</span>(myid==0){</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    in=fopen(<span class="stringliteral">&quot;coordparms.dat&quot;</span>,<span class="stringliteral">&quot;rt&quot;</span>);</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <span class="keywordflow">if</span>(in==NULL){</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;      dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Couldn&#39;t read coordparms.dat file.  I&#39;ll assume coded coordinates and let restart header overwrite any global restart parameters\n&quot;</span>);</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#afadc9671fb01ff346f980daeee9780ca" title="can call when no dependencies">set_coord_parms</a>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a>);</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    }</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;      <span class="comment">// don&#39;t want to overwrite since restart file sets this</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;      <span class="comment">//      fscanf(in,HEADER5IN,&amp;ftemp,&amp;ftemp,&amp;ftemp,&amp;ftemp,&amp;ftemp);</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;      <span class="comment">// NO: jon_interp.c requires read these in, so assume restart file has equal values to coordparms.dat file</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;      fscanf(in,<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a36e0602776f31a0172894322f1cf1427">HEADER4IN</a>,&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>,&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>,&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>,&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#a93f06eb0b7c274f722a7e09d4861a941">hslope</a>);</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;      fscanf(in,<span class="stringliteral">&quot;%d&quot;</span>,&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#a089706c546fc30d0b60ae9d6eb0a89ea">dofull2pi</a>);</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;      <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#abbc29b306372314c9c2c6cb50fadbe6f">USERCOORD</a>) {</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;        <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="../../d8/d60/init_8c.html#a096639e4541e9201ce3e4d4688d401c2">read_coord_parms_user</a>(<span class="keywordtype">int</span> defcoordlocal, FILE *in);</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;        <a class="code" href="../../d8/d60/init_8c.html#a096639e4541e9201ce3e4d4688d401c2">read_coord_parms_user</a>(defcoordlocal, in);</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;      }</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a99c6ba3b86430e6eb5a179c57fd58070">LOGRSINTH</a>) {</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;      }</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a174565dd3f50428c4c4d1e4a23019414">REBECCAGRID</a>) {</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;      }</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a3ebede6f897039b55ee0d8f75b359640">COMPLEX0TH</a>) {</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;      }</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#aeb733e0ec20094a219e120e3e9b22a0f">UNIRSINTH</a> || defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a8e2797c3dc060d13c29fd562d98d3bf8">UNIRSINTH2</a>){</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;      }</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#aa2630728190374841bd88da517faffb9">EQMIRROR</a>) {</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;      }</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a3ba253bfcb09b67c4f83cf604be1b4c4">COMPLEX1TH</a>) {</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;      }</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a363db929c2617ac441c63fe7d9847d30">COMPLEX2TH</a>) {</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;        fscanf(in,<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a68725b6be93d92f9bf1c8b2fe2e097f8">HEADER8IN</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a460b151eb6590a200f27826e97dcc248">x2trans</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a7ddf946840a6c53afc9e37674503dd79">thetatores</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#adf33edafc727f90e926d3f491f6bb4cb">m2</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#aab5d055c59dc5dbfcaef566bb6061530">d2</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a30a1474e2de8b7ed353e5948debd63b0">c2</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a1965dec5c9e70ada83cd756e549d5891">m3</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#ada4d4828a4429bb1fbae02df87b2d79c">b3</a>,&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#adde294c8217a66e6dd6605a392901ac9" title="IC.">h_over_r</a>);</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;      }</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a78f877fef6d5148b40adc3d6d93c7ad0">LOGRUNITH</a>) { <span class="comment">// uniform theta and log in radius</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a8cbb473515f18fcae523329c93f140dc">DIMENLOOP</a>(dimen) fscanf(in,<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a27a988716acb13db2b6d39c7b2a8cf2d">HEADERONEIN</a>,&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#a20ba1a68d196e97fa84463164fd907d1">Rin_array</a>[dimen]);</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a8cbb473515f18fcae523329c93f140dc">DIMENLOOP</a>(dimen) fscanf(in,<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a27a988716acb13db2b6d39c7b2a8cf2d">HEADERONEIN</a>,&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#aff141f9f52f9bbd4911d4dabcf2aaec9">Rout_array</a>[dimen]);</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;      }</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a6903d2cdfaf212b975c4fffa9402fa9c">JET1COORDS</a>) {</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;        fscanf(in,<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a3e85fd719629c25c801a667204100596">HEADER9IN</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#af5c3d95ab07a3b7fdff23bdde44b6ed0">h0</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#ad92c165f272791724422d0628071b170">hf</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#ac07d708f65a53c2ed0761d11bc97d46d">rh0</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a35f9f2c4f84077be4f200673dffd57ca">myrout</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a73f761b44de3c4480a924658b0f3efc5">dmyhslope1dr</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a084470ae408b08254f2247015f988570">dmyhslope2dx1</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a05bf2e602378f34e74ff69f35b1991d9">x1in</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a057ccc6a8480fa1e4b95bb8e928a27c0">x1out</a>);</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;      }</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a3e3cceb2f708009494c25912bd2470f4">JET2COORDS</a>) {</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;        fscanf(in,<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a36e0602776f31a0172894322f1cf1427">HEADER4IN</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a941700197dd24e782cbb0add66a42dbd">r1jet</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a508726935adb05ad4291b8c77897f8c5">rpjet</a>);</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;      }</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a77ba1498bcda3890f2a37bb5979a1eec">JET3COORDS</a>) {</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        fscanf(in,<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#aa5e05b1973568f5930a91eb822bfee3c">HEADER6IN</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a941700197dd24e782cbb0add66a42dbd">r1jet</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#ab0e0c0acf7cc9040907c895921b3fed7">Qjet</a>);</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;      }</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a8cb1a8a42445cede081c2ddfaa98113f">SJETCOORDS</a>) {</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        fscanf(in,<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a3e85fd719629c25c801a667204100596">HEADER9IN</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a941700197dd24e782cbb0add66a42dbd">r1jet</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a785b0a4bf2ba821005a429e176f8e130">r0grid</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a46d4c41abf34a76cec7353209c94905c">rjetend</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#ab0e0c0acf7cc9040907c895921b3fed7">Qjet</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a9c9f5f22dd4a5da08e734903ab82659f">fracphi</a>);</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;        fscanf(in,<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a3e85fd719629c25c801a667204100596">HEADER9IN</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a119eed5c7b218e4a9547a2e0c1a8d4fe">npow2</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a9b4b0ea2888bdfb7e987f43be8dee6db">cpow2</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a1196767f0fc1292fff1d9ee90d7fd3ff">rbr</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a7c7295d071bc7960f6b2fe9b8ab730ac">x1br</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a8365b4ccf09b73479da0374726417db8">fracdisk</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a8d5416128840a1ac3f7c18af1619e553">fracjet</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#af36620e0e23c6f08616e2be183b09958">r0disk</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a40bbfe3eb99d3c1da07a520db92a243e">rdiskend</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#ae069412a47af2715a20ebd2cb47513e9">torusrmax_loc</a>);</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        fscanf(in,<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a1329e9081665ebb8cfcad46dd53982c3">HEADER3IN</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a771a5cedc0bb12d13ea9cb76eff5cd42">jetnu</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a7c9ef3dd93e82818da1c93b9d159483d">x10</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a3b4850579b329099634861408a9e25df">x20</a>);</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;      }</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a725469cd082a278dfc44a41e28eca44c">JET6COORDS</a>) {</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        fscanf(in,<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#aa6e29c76aa1d52627ceb7eb232dfb903">HEADER19IN</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a941700197dd24e782cbb0add66a42dbd">r1jet</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#ab0e0c0acf7cc9040907c895921b3fed7">Qjet</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a83fde478856d3e284e192734eb140ce5">ntheta</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a2e5b7193188d9601aadc8d7f06fe121c">htheta</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a6ae559d1c0eb70aefa1b83129530a2fd">rsjet2</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a10ea48caa54649707c33041bc3bc298c">r0jet2</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a336034dbc5239e0fe15a337c19903374">rsjet3</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a7406e3812b73aed1b3ccef19bec31dab">r0jet3</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#aaa4f963acaccd1ea63a18f800fd576a1">rs</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a54081391e09395407d47aec84f3d97c9">r0</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a119eed5c7b218e4a9547a2e0c1a8d4fe">npow2</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a9b4b0ea2888bdfb7e987f43be8dee6db">cpow2</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a1196767f0fc1292fff1d9ee90d7fd3ff">rbr</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a7c7295d071bc7960f6b2fe9b8ab730ac">x1br</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a26ece82e6d552d80914dd5ae149ade6f">cpow3</a>);</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;      }</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a0e5331f6ac2b706aa4e76de967dcb1d7">JET6COORDSTHIN</a>) {</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        fscanf(in,<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a6949947eae96eea26b9599f900bfd54e">HEADER21IN</a>,&amp;th_npow,&amp;th_r1jet,&amp;th_njet,&amp;th_r0jet,&amp;th_rsjet,&amp;th_Qjet,&amp;th_ntheta,&amp;th_htheta,&amp;th_rsjet2,&amp;th_r0jet2,&amp;th_rsjet3,&amp;th_r0jet3,&amp;th_rs,&amp;th_r0,&amp;th_npow2,&amp;th_cpow2,&amp;th_rbr,&amp;th_x1br,&amp;th_rbr,&amp;th_h0,&amp;th_njet1);</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;      }</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a22ccf670681b96ce61d974db87204a10">BPTHIN1</a>) {</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        fscanf(in,<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a6949947eae96eea26b9599f900bfd54e">HEADER21IN</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a565a42e16bf3620bb640120f8c1a4e2a">bp_npow</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a7a94b12c588980b5ab27f7eeafb87cff">bp_r1jet</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#af88a4fd7d71742e941f216f36ad6b54a">bp_njet</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a54158096cc3ecff6f170b1c73f37b4eb">bp_r0jet</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a089b6a95e1b9ff1c17894dc843624fdc">bp_rsjet</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a50374ed958868696ce52b141be1e7677">bp_Qjet</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a0cb81219b4699253263ef5166f5fcb5f">bp_ntheta</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a2c9c35b3b93e28fb584cd7abc86177aa">bp_htheta</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a0bd0efdb0c8c30cbfa8174f4786c260d">bp_rsjet2</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a5bb1f817cc895142f229f3275204fb08">bp_r0jet2</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a4094a39b7ecf5cd989692b3997bc2f0a">bp_rsjet3</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a5a867407978fba43d13a1bf73039e623">bp_r0jet3</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a00cd3b5afe216561157f1f3a53d8610e">bp_rs</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#ac6c2bb2b523c5805b7df12b34a6287eb">bp_r0</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#aa54849ebc8093319bbf05517dfc21110">bp_rsinner</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#aa35f0e92f938a8111f280383c6c34697">bp_r0inner</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a0cce4548534baf8c1e0f2fbdd706117c">bp_npow2</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#aa3c25e2dcf468d66d223576997aaa124">bp_cpow2</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a51855c9f2c2f77df27842fd0cdcb25f6">bp_rbr</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a4fa1cafdb60ad24851dcf7f6a85d196c">bp_x1br</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a9c9f5f22dd4a5da08e734903ab82659f">fracphi</a>);</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;      }</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a5e2e2deaaa6af505fdb3c7b3c2f817a5">JET5COORDS</a>) {</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        fscanf(in,<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#abad4e861e340b54c75cae5134ae3b170">HEADER7IN</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a4a1725236323ec7cbb4359d2485c529d">AAAA</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a2c72f016de11e17e0a2e6fa70d147632">AAA</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#ae48fe9ae969558bf17a1cdbd2d0deb5b">BBB</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a333d082b5608e2d1dc51ef0194ed866e">DDD</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a5c290996245039518a5b33e0ea065efc">ii0</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#abcc0aa57debd9aa5e7f1aa918a2a3c1a">CCCC</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#abf5c838329a6a04b2bc88d8b71ae1bba">Rj</a>);</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;        fscanf(in,<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a8381cb3f3c3b88f01deaef6e85fcf2eb">HEADER5IN</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a941700197dd24e782cbb0add66a42dbd">r1jet</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#ab0e0c0acf7cc9040907c895921b3fed7">Qjet</a>);</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;      }</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a87e4392d8d6cdc988ced46d7e7a2dfe2">PULSARCOORDS</a>) {</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        fscanf(in,<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a8381cb3f3c3b88f01deaef6e85fcf2eb">HEADER5IN</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#adb91c14ac2eecf2e4745073392a7af6f">hinner</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a808590103058909774d170d48f1e5723">houter</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>);</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;      }</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a47b225226fbd0e3e573ec095071ecc10">UNIFORMCOORDS</a>) {</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        <span class="comment">//uniform grid for Cartesian coordinates</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;        <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a8cbb473515f18fcae523329c93f140dc">DIMENLOOP</a>(dimen) fscanf(in,<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a27a988716acb13db2b6d39c7b2a8cf2d">HEADERONEIN</a>,&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#a20ba1a68d196e97fa84463164fd907d1">Rin_array</a>[dimen]);</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;        <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a8cbb473515f18fcae523329c93f140dc">DIMENLOOP</a>(dimen) fscanf(in,<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a27a988716acb13db2b6d39c7b2a8cf2d">HEADERONEIN</a>,&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#aff141f9f52f9bbd4911d4dabcf2aaec9">Rout_array</a>[dimen]);</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;      }</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#adf7ec499e840df38ef6d0230239d75e2">BILOGCYLCOORDS</a>) {</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;        fscanf(in,<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a27a988716acb13db2b6d39c7b2a8cf2d">HEADERONEIN</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>);</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;      }</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#aa0a3d1a614796ea8787d7360932b121c">RAMESHCOORDS</a>|| defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a320ee4f267db4b195bbde94bec748a29">RAMESHCOORDS_HALFDISK</a>) {</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;        fscanf(in,<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a36e0602776f31a0172894322f1cf1427">HEADER4IN</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>);</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;      }</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a6e1b80715afcab76e5ec0827d7113aa9">JET4COORDS</a>) {</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;        fscanf(in,<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#abad4e861e340b54c75cae5134ae3b170">HEADER7IN</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#aaa4f963acaccd1ea63a18f800fd576a1">rs</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a54081391e09395407d47aec84f3d97c9">r0</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#af5c3d95ab07a3b7fdff23bdde44b6ed0">h0</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>);</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;        <span class="comment">// npow, rs, r0, h0, r0jet, njet, rsjet</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;      }</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a35d1eed7020c0beb59e9b6432fd68175">UNI2LOG</a>) {</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        fscanf(in,<span class="stringliteral">&quot;%d&quot;</span>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a71a9672d1d7564295af1d92b16656ed2">Nstar</a>);</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;        fscanf(in,<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a27a988716acb13db2b6d39c7b2a8cf2d">HEADERONEIN</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#acbb89ba805d17640710dea9b25fc385e">Rstar</a>);</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;        fscanf(in,<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a27a988716acb13db2b6d39c7b2a8cf2d">HEADERONEIN</a>,&amp;<a class="code" href="../../d9/de9/coord_8c.html#a9a25d0159341c4801263a705248546a9">Afactor</a>);</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;      }</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;      <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;        dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Shouldn&#39;t reach end of read_coord_parms: You set defcoordlocal=%d\n&quot;</span>,defcoordlocal);</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;        myexit(1);</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;      }</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;      fclose(in);</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    }</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;  }</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="preprocessor">#if(USEMPI)</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="preprocessor"></span>  <span class="comment">// broadcast</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;  MPI_Bcast(&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;  MPI_Bcast(&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;  MPI_Bcast(&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;  MPI_Bcast(&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#a93f06eb0b7c274f722a7e09d4861a941">hslope</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;  MPI_Bcast(&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#a089706c546fc30d0b60ae9d6eb0a89ea">dofull2pi</a>, 1, MPI_INT, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;  </div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;  <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#abbc29b306372314c9c2c6cb50fadbe6f">USERCOORD</a>) {</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    <span class="keyword">extern</span> <span class="keywordtype">void</span> read_coord_parms_mpi_user(<span class="keywordtype">int</span> defcoordlocal);</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    read_coord_parms_mpi_user(defcoordlocal);</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;  }</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a99c6ba3b86430e6eb5a179c57fd58070">LOGRSINTH</a>) {</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;  }</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a174565dd3f50428c4c4d1e4a23019414">REBECCAGRID</a>) {</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;  }</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a3ebede6f897039b55ee0d8f75b359640">COMPLEX0TH</a>) {</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;  }</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#aeb733e0ec20094a219e120e3e9b22a0f">UNIRSINTH</a> || defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a8e2797c3dc060d13c29fd562d98d3bf8">UNIRSINTH2</a>){</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;  }</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#aa2630728190374841bd88da517faffb9">EQMIRROR</a>) {</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;  }</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a3ba253bfcb09b67c4f83cf604be1b4c4">COMPLEX1TH</a>) {</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;  }</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a363db929c2617ac441c63fe7d9847d30">COMPLEX2TH</a>) {</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a460b151eb6590a200f27826e97dcc248">x2trans</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a7ddf946840a6c53afc9e37674503dd79">thetatores</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#adf33edafc727f90e926d3f491f6bb4cb">m2</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#aab5d055c59dc5dbfcaef566bb6061530">d2</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a30a1474e2de8b7ed353e5948debd63b0">c2</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a1965dec5c9e70ada83cd756e549d5891">m3</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#ada4d4828a4429bb1fbae02df87b2d79c">b3</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    <span class="comment">//  MPI_Bcast(&amp;h_over_r, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD); // set by pre_init_specific_init() in init.c</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;  }</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a78f877fef6d5148b40adc3d6d93c7ad0">LOGRUNITH</a>) { <span class="comment">// uniform theta and log in radius</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a8cbb473515f18fcae523329c93f140dc">DIMENLOOP</a>(dimen) MPI_Bcast(&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#a20ba1a68d196e97fa84463164fd907d1">Rin_array</a>[dimen], 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a8cbb473515f18fcae523329c93f140dc">DIMENLOOP</a>(dimen) MPI_Bcast(&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#aff141f9f52f9bbd4911d4dabcf2aaec9">Rout_array</a>[dimen], 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;  }</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a6903d2cdfaf212b975c4fffa9402fa9c">JET1COORDS</a>) {</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#af5c3d95ab07a3b7fdff23bdde44b6ed0">h0</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#ad92c165f272791724422d0628071b170">hf</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#ac07d708f65a53c2ed0761d11bc97d46d">rh0</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a35f9f2c4f84077be4f200673dffd57ca">myrout</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a73f761b44de3c4480a924658b0f3efc5">dmyhslope1dr</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a084470ae408b08254f2247015f988570">dmyhslope2dx1</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a05bf2e602378f34e74ff69f35b1991d9">x1in</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a057ccc6a8480fa1e4b95bb8e928a27c0">x1out</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;  }</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a3e3cceb2f708009494c25912bd2470f4">JET2COORDS</a>) {</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a941700197dd24e782cbb0add66a42dbd">r1jet</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a508726935adb05ad4291b8c77897f8c5">rpjet</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  }</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a77ba1498bcda3890f2a37bb5979a1eec">JET3COORDS</a>) {</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a941700197dd24e782cbb0add66a42dbd">r1jet</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#ab0e0c0acf7cc9040907c895921b3fed7">Qjet</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;  }</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a8cb1a8a42445cede081c2ddfaa98113f">SJETCOORDS</a>) {</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a941700197dd24e782cbb0add66a42dbd">r1jet</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a785b0a4bf2ba821005a429e176f8e130">r0grid</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a46d4c41abf34a76cec7353209c94905c">rjetend</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#ab0e0c0acf7cc9040907c895921b3fed7">Qjet</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    <span class="comment">//new params</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a9c9f5f22dd4a5da08e734903ab82659f">fracphi</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a119eed5c7b218e4a9547a2e0c1a8d4fe">npow2</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a9b4b0ea2888bdfb7e987f43be8dee6db">cpow2</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a1196767f0fc1292fff1d9ee90d7fd3ff">rbr</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a7c7295d071bc7960f6b2fe9b8ab730ac">x1br</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a8365b4ccf09b73479da0374726417db8">fracdisk</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a8d5416128840a1ac3f7c18af1619e553">fracjet</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#af36620e0e23c6f08616e2be183b09958">r0disk</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a40bbfe3eb99d3c1da07a520db92a243e">rdiskend</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#ae069412a47af2715a20ebd2cb47513e9">torusrmax_loc</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a771a5cedc0bb12d13ea9cb76eff5cd42">jetnu</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a7c9ef3dd93e82818da1c93b9d159483d">x10</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a3b4850579b329099634861408a9e25df">x20</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;  }</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a725469cd082a278dfc44a41e28eca44c">JET6COORDS</a>) {</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a941700197dd24e782cbb0add66a42dbd">r1jet</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#ab0e0c0acf7cc9040907c895921b3fed7">Qjet</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a83fde478856d3e284e192734eb140ce5">ntheta</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a2e5b7193188d9601aadc8d7f06fe121c">htheta</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a6ae559d1c0eb70aefa1b83129530a2fd">rsjet2</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a10ea48caa54649707c33041bc3bc298c">r0jet2</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a336034dbc5239e0fe15a337c19903374">rsjet3</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a7406e3812b73aed1b3ccef19bec31dab">r0jet3</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#aaa4f963acaccd1ea63a18f800fd576a1">rs</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a54081391e09395407d47aec84f3d97c9">r0</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a119eed5c7b218e4a9547a2e0c1a8d4fe">npow2</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a9b4b0ea2888bdfb7e987f43be8dee6db">cpow2</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a1196767f0fc1292fff1d9ee90d7fd3ff">rbr</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a7c7295d071bc7960f6b2fe9b8ab730ac">x1br</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a26ece82e6d552d80914dd5ae149ade6f">cpow3</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;  }</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a0e5331f6ac2b706aa4e76de967dcb1d7">JET6COORDSTHIN</a>) {</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    MPI_Bcast(&amp;th_npow, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    MPI_Bcast(&amp;th_r1jet, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    MPI_Bcast(&amp;th_njet, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    MPI_Bcast(&amp;th_r0jet, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    MPI_Bcast(&amp;th_rsjet, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    MPI_Bcast(&amp;th_Qjet, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    MPI_Bcast(&amp;th_ntheta, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    MPI_Bcast(&amp;th_htheta, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    MPI_Bcast(&amp;th_rsjet2, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    MPI_Bcast(&amp;th_r0jet2, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    MPI_Bcast(&amp;th_rsjet3, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    MPI_Bcast(&amp;th_r0jet3, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    MPI_Bcast(&amp;th_rs, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    MPI_Bcast(&amp;th_r0, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    MPI_Bcast(&amp;th_npow2, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    MPI_Bcast(&amp;th_cpow2, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    MPI_Bcast(&amp;th_rbr, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    MPI_Bcast(&amp;th_x1br, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    MPI_Bcast(&amp;th_rbr, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    MPI_Bcast(&amp;th_h0, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    MPI_Bcast(&amp;th_njet1, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  }</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a22ccf670681b96ce61d974db87204a10">BPTHIN1</a>) {</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a565a42e16bf3620bb640120f8c1a4e2a">bp_npow</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a7a94b12c588980b5ab27f7eeafb87cff">bp_r1jet</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#af88a4fd7d71742e941f216f36ad6b54a">bp_njet</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a54158096cc3ecff6f170b1c73f37b4eb">bp_r0jet</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a089b6a95e1b9ff1c17894dc843624fdc">bp_rsjet</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a50374ed958868696ce52b141be1e7677">bp_Qjet</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a0cb81219b4699253263ef5166f5fcb5f">bp_ntheta</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a2c9c35b3b93e28fb584cd7abc86177aa">bp_htheta</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a0bd0efdb0c8c30cbfa8174f4786c260d">bp_rsjet2</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a5bb1f817cc895142f229f3275204fb08">bp_r0jet2</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a4094a39b7ecf5cd989692b3997bc2f0a">bp_rsjet3</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a5a867407978fba43d13a1bf73039e623">bp_r0jet3</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a00cd3b5afe216561157f1f3a53d8610e">bp_rs</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#ac6c2bb2b523c5805b7df12b34a6287eb">bp_r0</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#aa54849ebc8093319bbf05517dfc21110">bp_rsinner</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#aa35f0e92f938a8111f280383c6c34697">bp_r0inner</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a0cce4548534baf8c1e0f2fbdd706117c">bp_npow2</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#aa3c25e2dcf468d66d223576997aaa124">bp_cpow2</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a51855c9f2c2f77df27842fd0cdcb25f6">bp_rbr</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a4fa1cafdb60ad24851dcf7f6a85d196c">bp_x1br</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a9c9f5f22dd4a5da08e734903ab82659f">fracphi</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;  }</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a5e2e2deaaa6af505fdb3c7b3c2f817a5">JET5COORDS</a>) {</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a4a1725236323ec7cbb4359d2485c529d">AAAA</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a2c72f016de11e17e0a2e6fa70d147632">AAA</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#ae48fe9ae969558bf17a1cdbd2d0deb5b">BBB</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a333d082b5608e2d1dc51ef0194ed866e">DDD</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a5c290996245039518a5b33e0ea065efc">ii0</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#abcc0aa57debd9aa5e7f1aa918a2a3c1a">CCCC</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#abf5c838329a6a04b2bc88d8b71ae1bba">Rj</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a941700197dd24e782cbb0add66a42dbd">r1jet</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#ab0e0c0acf7cc9040907c895921b3fed7">Qjet</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;  }</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a87e4392d8d6cdc988ced46d7e7a2dfe2">PULSARCOORDS</a>) {</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#adb91c14ac2eecf2e4745073392a7af6f">hinner</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a808590103058909774d170d48f1e5723">houter</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;  }</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a47b225226fbd0e3e573ec095071ecc10">UNIFORMCOORDS</a>) {</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    <span class="comment">//uniform grid for Cartesian coordinates</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a8cbb473515f18fcae523329c93f140dc">DIMENLOOP</a>(dimen) MPI_Bcast(&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#a20ba1a68d196e97fa84463164fd907d1">Rin_array</a>[dimen], 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a8cbb473515f18fcae523329c93f140dc">DIMENLOOP</a>(dimen) MPI_Bcast(&amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#aff141f9f52f9bbd4911d4dabcf2aaec9">Rout_array</a>[dimen], 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;  }</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#adf7ec499e840df38ef6d0230239d75e2">BILOGCYLCOORDS</a>) {</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;  }</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#aa0a3d1a614796ea8787d7360932b121c">RAMESHCOORDS</a>|| defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a320ee4f267db4b195bbde94bec748a29">RAMESHCOORDS_HALFDISK</a>) {</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;  }</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a6e1b80715afcab76e5ec0827d7113aa9">JET4COORDS</a>) {</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#aaa4f963acaccd1ea63a18f800fd576a1">rs</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a54081391e09395407d47aec84f3d97c9">r0</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#af5c3d95ab07a3b7fdff23bdde44b6ed0">h0</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;  }</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (defcoordlocal == <a class="code" href="../../d7/d56/coord_8h.html#a35d1eed7020c0beb59e9b6432fd68175">UNI2LOG</a>) {</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a71a9672d1d7564295af1d92b16656ed2">Nstar</a>, 1, MPI_INT, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#acbb89ba805d17640710dea9b25fc385e">Rstar</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    MPI_Bcast(&amp;<a class="code" href="../../d9/de9/coord_8c.html#a9a25d0159341c4801263a705248546a9">Afactor</a>, 1, MPI_FTYPE, MPIid[0], MPI_COMM_GRMHD);</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;  }</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Shouldn&#39;t reach end of read_coord_parms MPI stuff: You set defcoordlocal=%d\n&quot;</span>,defcoordlocal);</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    myexit(1);</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;  }</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;  </div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;}</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;</div>
<div class="line"><a name="l01260"></a><span class="lineno"><a class="code" href="../../d6/d85/coord_8funcdeclare_8h.html#a65ad4ca9656d141cc995fd35ed31dc40"> 1260</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d9/de9/coord_8c.html#a65ad4ca9656d141cc995fd35ed31dc40" title="Returns boyer-lindquist coordinte of point.">bl_coord</a>(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *<a class="code" href="../../dc/dd2/newcodediff_8txt.html#a933233ff9879962bcc2ff987c6920f90">X</a>, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *<a class="code" href="../../dc/dd2/newcodediff_8txt.html#af84f2c3bf153920b7c8d186132d39bc7">V</a>)</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;{</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;  <span class="keyword">extern</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> mysin(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> th);</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> myx2;</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> mysign,ts1,fnstar,myNrat;</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> BB,CC;</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> myhslope1,myhslope2,myhslope;</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> flip1,flip2;</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> th0,th0toprint,th2,switch0,switch2,switchinner0,switchinner2,switchrad0,switchrad2,thetasign,x2temp;</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> r,dtheta2dx1,dtheta2dx2,dtheta0dx2,dtheta0dx1,dswitch0dr,dswitch2dr;</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;  <span class="comment">//  FTYPE th0,th2,switch0,switch2;</span></div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;  <span class="comment">//  FTYPE r,dtheta2dx1,dtheta2dx2,dtheta0dx2,dtheta0dx1,dswitch0dr,dswitch2dr;</span></div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> X0;</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;  <span class="comment">// for defcoord=JET5COORDS</span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> ii,logform,radialarctan,thetaarctan; <span class="comment">// temp vars</span></div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;  <span class="comment">//for SJETCOORDS</span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> theexp,theexp1,theexp2;</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;  <span class="comment">// AKMARK: coordinates defined, in particular, phi wedge (e.g., V[3]=2.0*M_PI*X[3])</span></div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;  <span class="comment">// below will give correct dxdxp[1][1], etc.</span></div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;  V[0]=X[0]; <span class="comment">// assume time = X[0] means time now and negative means time in past and positive means future</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;  <span class="comment">// in spherical polar coords: t=V[0] r=V[1] th=V[2] phi=V[3]</span></div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#abbc29b306372314c9c2c6cb50fadbe6f">USERCOORD</a>) {</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="../../d8/d60/init_8c.html#a27c01fe4532cf3e10d467517403dbf70">blcoord_user</a>(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *X, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *V);</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    <a class="code" href="../../d8/d60/init_8c.html#a27c01fe4532cf3e10d467517403dbf70">blcoord_user</a>(X,V);</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;  }</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a99c6ba3b86430e6eb5a179c57fd58070">LOGRSINTH</a>) {</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;<span class="preprocessor">#if(1)</span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aab7332b2c03d905515d5350d4fd0850f">X1DN</a>]==<a class="code" href="../../da/d3e/definit_8h.html#a94f10ecb00225a561c8fad850f7386f7">R0SING</a>){</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>&gt;=0.0){</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;        dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;With log grid and R0SING must have R0&lt;0 instead of %26.20g\n&quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>);</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;        myexit(8274);</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;      }</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;      X0 = log(-<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>);</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;      <span class="keywordflow">if</span>(X[1]&gt;X0) V[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>+exp(X[1]) ;</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;      <span class="keywordflow">else</span> V[1] = -(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>+<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>*<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>*exp(-X[1])) ;</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;      <span class="comment">//      dualfprintf(fail_file,&quot;X0=%26.20g V[1]=%26.20g\n&quot;,X0,V[1]);</span></div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    }</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;      V[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>+exp(X[1]) ;</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;      <span class="comment">// if V[1]=r&lt;0 here, the presume only where interpolation boundaries are, not evolved quantities, and not extending so far negative radius that reach beyond, e.g. light cylinder so that velocities will be undefined with simple extrapolation</span></div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    }</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    V[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>+exp(X[1]) ;</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    <span class="comment">//    V[1] = Rin*exp(X[1]) ;</span></div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    <span class="comment">//V[1] = Rin * exp(X[1]);</span></div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    <span class="keywordflow">if</span>(X[2]&lt;0.5){</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;      V[2] = M_PI * X[2] + ((1. - <a class="code" href="../../d8/d5b/defs_8general_8h.html#a93f06eb0b7c274f722a7e09d4861a941">hslope</a>) / 2.) * mysin(2. * M_PI * X[2]);</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    }</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;      <span class="comment">//      V[2] = 0.5*M_PI + M_PI * fabs(X[2]-0.5) + ((1. - hslope) / 2.) * (-mysin(2. * M_PI * (1.0-X[2])));</span></div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;      V[2] = M_PI - (M_PI * (1.0-X[2])) + ((1. - <a class="code" href="../../d8/d5b/defs_8general_8h.html#a93f06eb0b7c274f722a7e09d4861a941">hslope</a>) / 2.) * (-mysin(2. * M_PI * (1.0-X[2])));</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    }</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <span class="comment">// default is uniform \phi grid</span></div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    V[3]=2.0*M_PI*X[3];</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;  }</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a174565dd3f50428c4c4d1e4a23019414">REBECCAGRID</a>) {</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    <span class="comment">//    V[1] = Rin*exp(X[1]) ;</span></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    V[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>+exp(X[1]) ;</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;    <span class="comment">//V[1] = Rin * exp(X[1]);</span></div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;    <span class="comment">//  if(X[2]&lt;0.5){</span></div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;    <span class="comment">//  V[2] = M_PI * X[2] + ((1. - hslope) / 2.) * mysin(2. * M_PI * X[2]);</span></div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    <span class="comment">// }</span></div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;    <span class="comment">// else{</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    <span class="comment">//      V[2] = 0.5*M_PI + M_PI * fabs(X[2]-0.5) + ((1. - hslope) / 2.) * (-mysin(2. * M_PI * (1.0-X[2])));</span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    <span class="comment">// V[2] = M_PI - (M_PI * (1.0-X[2])) + ((1. - hslope) / 2.) * (-mysin(2. * M_PI * (1.0-X[2])));</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    <span class="comment">// }</span></div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;    V[2]=(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a93f06eb0b7c274f722a7e09d4861a941">hslope</a>*((X[2]-0.5)/0.5) + (1-<a class="code" href="../../d8/d5b/defs_8general_8h.html#a93f06eb0b7c274f722a7e09d4861a941">hslope</a>)*pow((X[2]-0.5)/0.5, 7.0)+1.)*M_PI/2.;</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    <span class="comment">// default is uniform \phi grid</span></div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    V[3]=0.5*M_PI*X[3];</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;  }</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a3ebede6f897039b55ee0d8f75b359640">COMPLEX0TH</a>) {</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    V[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>+<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a> * exp(X[1] * log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a> / <a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>));</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;    V[2] =</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;      ((-49. * <a class="code" href="../../d8/d5b/defs_8general_8h.html#a93f06eb0b7c274f722a7e09d4861a941">hslope</a> + 60. * M_PI) * X[2]) / 12. +</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;      ((247. * <a class="code" href="../../d8/d5b/defs_8general_8h.html#a93f06eb0b7c274f722a7e09d4861a941">hslope</a> - 240. * M_PI) * pow(X[2],2)) / 12. +</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;      ((-83. * <a class="code" href="../../d8/d5b/defs_8general_8h.html#a93f06eb0b7c274f722a7e09d4861a941">hslope</a> + 80. * M_PI) * pow(X[2],3)) / 2. -</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;      (5. * (-25. * <a class="code" href="../../d8/d5b/defs_8general_8h.html#a93f06eb0b7c274f722a7e09d4861a941">hslope</a> + 24. * M_PI) * pow(X[2], 4)) / 3. +</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;      (2. * (-25. * <a class="code" href="../../d8/d5b/defs_8general_8h.html#a93f06eb0b7c274f722a7e09d4861a941">hslope</a> + 24. * M_PI) * pow(X[2], 5)) / 3.;</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;    <span class="comment">// default is uniform \phi grid</span></div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    V[3]=2.0*M_PI*X[3];</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;  }</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a>==<a class="code" href="../../d7/d56/coord_8h.html#aeb733e0ec20094a219e120e3e9b22a0f">UNIRSINTH</a>){</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;    V[1]=X[1];</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    V[2] = M_PI* X[2] + ((1. - <a class="code" href="../../d8/d5b/defs_8general_8h.html#a93f06eb0b7c274f722a7e09d4861a941">hslope</a>) / 2.) * sin(2. * M_PI * X[2]);</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    <span class="comment">// default is uniform \phi grid</span></div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    V[3]=2.0*M_PI*X[3];</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;  }</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a>==<a class="code" href="../../d7/d56/coord_8h.html#a8e2797c3dc060d13c29fd562d98d3bf8">UNIRSINTH2</a>){</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    V[1]=<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a> + (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>)*X[1];</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;    V[2] = M_PI* X[2] + ((1. - <a class="code" href="../../d8/d5b/defs_8general_8h.html#a93f06eb0b7c274f722a7e09d4861a941">hslope</a>) / 2.) * sin(2. * M_PI * X[2]);</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;    <span class="comment">// default is uniform \phi grid</span></div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;    V[3]=2.0*M_PI*X[3];</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;  }</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#aa2630728190374841bd88da517faffb9">EQMIRROR</a>) {</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;    <span class="comment">// MIRROR at equator, equator is outer theta edge</span></div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;    V[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>+exp(X[1]) ;</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;    V[2] = M_PI * X[2] + ((1. - <a class="code" href="../../d8/d5b/defs_8general_8h.html#a93f06eb0b7c274f722a7e09d4861a941">hslope</a>) / 2.) * sin(2. * M_PI * X[2]);</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    <span class="comment">// default is uniform \phi grid</span></div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    V[3]=2.0*M_PI*X[3];</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;  }</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a3ba253bfcb09b67c4f83cf604be1b4c4">COMPLEX1TH</a>) {</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;    V[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>+exp(X[1]) ;</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;    V[2] = (<a class="code" href="../../d9/de9/coord_8c.html#ae91faa22bb51b3003d7a140fd4a100ff">der0</a>*X[2]*(-32.*pow(-1. + X[2],3.)*pow(X[2],2.)*(-1. + 2.*X[2]) - </div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;                       <a class="code" href="../../d9/de9/coord_8c.html#a7cc367c90dd3a8d7608984c311cb6c9b">Ri</a>*(-1. + X[2])*pow(-1. + 2.*X[2],3.)*</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;                       (-1. + 7.*(-1. + X[2])*X[2])) + </div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;            M_PI*<a class="code" href="../../d9/de9/coord_8c.html#a7cc367c90dd3a8d7608984c311cb6c9b">Ri</a>*pow(X[2],3.)*(70. + </div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;                                  3.*X[2]*(-105. + 2.*X[2]*(91. + 10.*X[2]*(-7. + 2.*X[2])))))/<a class="code" href="../../d9/de9/coord_8c.html#a7cc367c90dd3a8d7608984c311cb6c9b">Ri</a>;</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    <span class="comment">// default is uniform \phi grid</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    V[3]=2.0*M_PI*X[3];</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;  }</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a363db929c2617ac441c63fe7d9847d30">COMPLEX2TH</a>) {</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    V[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>+exp(X[1]) ;</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    <span class="comment">// now assign values</span></div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    <span class="keywordflow">if</span>(X[2]&lt;0.5){ myx2=X[2]; flip1=0.0; flip2=1.0;}</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    <span class="keywordflow">else</span>{ myx2=1.0-X[2]; flip1=M_PI; flip2=-1.0;}</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    <span class="keywordflow">if</span>(myx2&lt;=<a class="code" href="../../d9/de9/coord_8c.html#a460b151eb6590a200f27826e97dcc248">x2trans</a>){</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;      V[2] = flip1+flip2*(<a class="code" href="../../d9/de9/coord_8c.html#aab5d055c59dc5dbfcaef566bb6061530">d2</a>*pow(myx2,3.0)+<a class="code" href="../../d9/de9/coord_8c.html#a30a1474e2de8b7ed353e5948debd63b0">c2</a>*pow(myx2,2.0)+<a class="code" href="../../d9/de9/coord_8c.html#adf33edafc727f90e926d3f491f6bb4cb">m2</a>*myx2);</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    }</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;      V[2] = flip1+flip2*(<a class="code" href="../../d9/de9/coord_8c.html#a1965dec5c9e70ada83cd756e549d5891">m3</a>*myx2+<a class="code" href="../../d9/de9/coord_8c.html#ada4d4828a4429bb1fbae02df87b2d79c">b3</a>);</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    }</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    <span class="comment">// default is uniform \phi grid</span></div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    V[3]=2.0*M_PI*X[3];</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;  }</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a78f877fef6d5148b40adc3d6d93c7ad0">LOGRUNITH</a>) { <span class="comment">// uniform theta and log in radius</span></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    V[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>+exp(X[1]) ;</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    V[2] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#a20ba1a68d196e97fa84463164fd907d1">Rin_array</a>[2] + X[2] * ( <a class="code" href="../../d8/d5b/defs_8general_8h.html#aff141f9f52f9bbd4911d4dabcf2aaec9">Rout_array</a>[2] - <a class="code" href="../../d8/d5b/defs_8general_8h.html#a20ba1a68d196e97fa84463164fd907d1">Rin_array</a>[2] );</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    V[3] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#a20ba1a68d196e97fa84463164fd907d1">Rin_array</a>[3] + X[3] * ( <a class="code" href="../../d8/d5b/defs_8general_8h.html#aff141f9f52f9bbd4911d4dabcf2aaec9">Rout_array</a>[3] - <a class="code" href="../../d8/d5b/defs_8general_8h.html#a20ba1a68d196e97fa84463164fd907d1">Rin_array</a>[3] );</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;  }</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a6903d2cdfaf212b975c4fffa9402fa9c">JET1COORDS</a>) {</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    V[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>+exp(pow(X[1],<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>)) ;</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    myhslope1 = <a class="code" href="../../d9/de9/coord_8c.html#af5c3d95ab07a3b7fdff23bdde44b6ed0">h0</a>+<a class="code" href="../../d9/de9/coord_8c.html#a73f761b44de3c4480a924658b0f3efc5">dmyhslope1dr</a>*((V[1])-<a class="code" href="../../d9/de9/coord_8c.html#ac07d708f65a53c2ed0761d11bc97d46d">rh0</a>);</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    myhslope2 = <a class="code" href="../../d9/de9/coord_8c.html#af5c3d95ab07a3b7fdff23bdde44b6ed0">h0</a>+(<a class="code" href="../../d9/de9/coord_8c.html#ad92c165f272791724422d0628071b170">hf</a>-<a class="code" href="../../d9/de9/coord_8c.html#af5c3d95ab07a3b7fdff23bdde44b6ed0">h0</a>)*(X[1]-<a class="code" href="../../d9/de9/coord_8c.html#a05bf2e602378f34e74ff69f35b1991d9">x1in</a>)/(<a class="code" href="../../d9/de9/coord_8c.html#a057ccc6a8480fa1e4b95bb8e928a27c0">x1out</a>-<a class="code" href="../../d9/de9/coord_8c.html#a05bf2e602378f34e74ff69f35b1991d9">x1in</a>);</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;    myhslope=(myhslope1+myhslope2)*0.5;</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    V[2] = M_PI * X[2] + ((1. - myhslope) / 2.) * sin(2. * M_PI * X[2]);</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    <span class="comment">// default is uniform \phi grid</span></div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    V[3]=2.0*M_PI*X[3];</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;  }</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a3e3cceb2f708009494c25912bd2470f4">JET2COORDS</a>) {</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;    V[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>+exp(pow(X[1],<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>)) ;</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    myhslope=2.0-pow(V[1]/<a class="code" href="../../d9/de9/coord_8c.html#a941700197dd24e782cbb0add66a42dbd">r1jet</a>,<a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>*(-1.0+exp(1.0)/exp(V[1]+<a class="code" href="../../d9/de9/coord_8c.html#a508726935adb05ad4291b8c77897f8c5">rpjet</a>)));</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    V[2] = M_PI * X[2] + ((1. - myhslope) / 2.) * sin(2. * M_PI * X[2]);</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    <span class="comment">// default is uniform \phi grid</span></div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    V[3]=2.0*M_PI*X[3];</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;  }</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a77ba1498bcda3890f2a37bb5979a1eec">JET3COORDS</a>) {</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;    V[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>+exp(pow(X[1],<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>)) ;</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    myhslope=2.0-<a class="code" href="../../d9/de9/coord_8c.html#ab0e0c0acf7cc9040907c895921b3fed7">Qjet</a>*pow(V[1]/<a class="code" href="../../d9/de9/coord_8c.html#a941700197dd24e782cbb0add66a42dbd">r1jet</a>,-<a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>*(0.5+1.0/M_PI*atan(V[1]/<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>-<a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>/<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>)));</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    <span class="keywordflow">if</span>(X[2]&lt;0.5){</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;      V[2] = M_PI * X[2] + ((1. - myhslope) / 2.) * mysin(2. * M_PI * X[2]);</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    }</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;      V[2] = M_PI - (M_PI * (1.0-X[2])) + ((1. - myhslope) / 2.) * (-mysin(2. * M_PI * (1.0-X[2])));</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    }</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;    <span class="comment">// default is uniform \phi grid</span></div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    V[3]=2.0*M_PI*X[3];</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;  }</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a8cb1a8a42445cede081c2ddfaa98113f">SJETCOORDS</a>) {</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;<span class="preprocessor">#if(0)</span></div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;<span class="preprocessor"></span>    <span class="comment">//use original coordinates</span></div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    vofx_sjetcoords( X, V );</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;<span class="preprocessor"></span>    <span class="comment">//apply cylindrification to original coordinates</span></div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    <span class="comment">//[this internally calls vofx_sjetcoords()] </span></div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    vofx_cylindrified( X, vofx_sjetcoords, V );</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;<span class="preprocessor"></span>    </div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;  }</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a725469cd082a278dfc44a41e28eca44c">JET6COORDS</a>) {</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;<span class="preprocessor">#if(0) // no change in exponentiation</span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;<span class="preprocessor"></span>    <span class="comment">// JET3COORDS-like radial grid</span></div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;    V[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>+exp(pow(X[1],<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>)) ;</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;<span class="preprocessor">#elif(1)</span></div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    theexp = <a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>*X[1];</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    <span class="keywordflow">if</span>( X[1] &gt; <a class="code" href="../../d9/de9/coord_8c.html#a7c7295d071bc7960f6b2fe9b8ab730ac">x1br</a> ) {</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;      theexp += <a class="code" href="../../d9/de9/coord_8c.html#a9b4b0ea2888bdfb7e987f43be8dee6db">cpow2</a> * pow(X[1]-<a class="code" href="../../d9/de9/coord_8c.html#a7c7295d071bc7960f6b2fe9b8ab730ac">x1br</a>,<a class="code" href="../../d9/de9/coord_8c.html#a119eed5c7b218e4a9547a2e0c1a8d4fe">npow2</a>);</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;    }</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    V[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>+exp(theexp);</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    <span class="comment">//    FTYPE npowtrue,npowlarger=10.0;</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    <span class="comment">//    FTYPE npowrs=1E3;</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    <span class="comment">//    FTYPE npowr0=2E2;</span></div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    <span class="comment">//    npowtrue = npow + (npowlarger-npow)*(0.5+1.0/M_PI*atan((V[1]-npowrs)/npowr0));</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    <span class="comment">//    V[1] = R0+exp(pow(X[1],npowtrue)) ;</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;<span class="preprocessor">#elif(0)</span></div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;<span class="preprocessor"></span>    <span class="comment">// avoid jump in grid at rbr</span></div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    <span class="comment">// determine switches</span></div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> r0rbr=<a class="code" href="../../d9/de9/coord_8c.html#a1196767f0fc1292fff1d9ee90d7fd3ff">rbr</a>/2.0;</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;    switch0 = 0.5+1.0/M_PI*atan((V[1]-<a class="code" href="../../d9/de9/coord_8c.html#a1196767f0fc1292fff1d9ee90d7fd3ff">rbr</a>)/r0rbr); <span class="comment">// 1 for outer r</span></div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> V1 = <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>+exp(<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>*X[1]);</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;    <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> V2 = <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>+exp(<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>*X[1] + <a class="code" href="../../d9/de9/coord_8c.html#a9b4b0ea2888bdfb7e987f43be8dee6db">cpow2</a> * pow(<a class="code" href="../../d9/de9/coord_8c.html#a26ece82e6d552d80914dd5ae149ade6f">cpow3</a>*(X[1]-<a class="code" href="../../d9/de9/coord_8c.html#a7c7295d071bc7960f6b2fe9b8ab730ac">x1br</a>*1.0),<a class="code" href="../../d9/de9/coord_8c.html#a119eed5c7b218e4a9547a2e0c1a8d4fe">npow2</a>));</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    V[1] = V1*(1.0-switch0) + V2*switch0;</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;    <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> theta1,theta2,arctan2;</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;<span class="preprocessor">#if(0)</span></div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;<span class="preprocessor"></span>    <span class="comment">// JET3COORDS-based:</span></div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    myhslope=2.0-<a class="code" href="../../d9/de9/coord_8c.html#ab0e0c0acf7cc9040907c895921b3fed7">Qjet</a>*pow(V[1]/<a class="code" href="../../d9/de9/coord_8c.html#a941700197dd24e782cbb0add66a42dbd">r1jet</a>,-<a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>*(0.5+1.0/M_PI*atan(V[1]/<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>-<a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>/<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>)));</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;    theta1 = M_PI * X[2] + ((1. - myhslope) * 0.5) * mysin(2. * M_PI * X[2]);</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;<span class="preprocessor"></span>    <span class="comment">// RAMESH BASED</span></div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    <span class="comment">// myhslope here is h2 in MCAF paper</span></div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    <span class="comment">//    // h0 here is h3 in MCAF paper</span></div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    <span class="comment">//FTYPE njetvsr;</span></div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    <span class="comment">//if(V[1]&lt;rbr) njetvsr=njet;</span></div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;    <span class="comment">//    else njetvsr=njet/(V[1])*rbr;</span></div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    <span class="comment">//else njetvsr=</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    <span class="comment">//njetvsr=njet;</span></div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> localrbr=<a class="code" href="../../d9/de9/coord_8c.html#a1196767f0fc1292fff1d9ee90d7fd3ff">rbr</a>; <span class="comment">//500.0; // rbr;</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;<span class="comment">//    FTYPE localrbrr0=MAX(100.0,localrbr/2.0);</span></div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> localrbrr0=100.0;</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;    switch0 = 0.5+1.0/M_PI*atan((V[1]-localrbr)/localrbrr0); <span class="comment">// large r</span></div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;    switch2 = 1.0-switch0; <span class="comment">// small r</span></div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;    <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> myhslope1=<a class="code" href="../../d9/de9/coord_8c.html#af5c3d95ab07a3b7fdff23bdde44b6ed0">h0</a> + pow( (V[1]-<a class="code" href="../../d9/de9/coord_8c.html#a336034dbc5239e0fe15a337c19903374">rsjet3</a>)/<a class="code" href="../../d9/de9/coord_8c.html#a7406e3812b73aed1b3ccef19bec31dab">r0jet3</a> , <a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>);</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;    <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> myhslope2=<a class="code" href="../../d9/de9/coord_8c.html#af5c3d95ab07a3b7fdff23bdde44b6ed0">h0</a> + pow( (localrbr-<a class="code" href="../../d9/de9/coord_8c.html#a336034dbc5239e0fe15a337c19903374">rsjet3</a>)/<a class="code" href="../../d9/de9/coord_8c.html#a7406e3812b73aed1b3ccef19bec31dab">r0jet3</a> , <a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>);</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;    myhslope = myhslope1*switch2 + myhslope2*switch0;</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;    <span class="comment">// determine theta2</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;    <span class="keywordflow">if</span>(X[2]&gt;1.0) myx2=2.0-X[2];</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(X[2]&lt;0.0) myx2=-X[2];</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;    <span class="keywordflow">else</span> myx2=X[2];</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;    th2 = 0.5*M_PI*(1.0 + atan(myhslope*(myx2-0.5))/atan(myhslope*0.5));</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;    <span class="keywordflow">if</span>(X[2]&gt;1.0) th2=2.0*M_PI-th2;</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(X[2]&lt;0.0) th2=-th2;</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;    <span class="comment">// determine theta0</span></div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    <span class="comment">// JET3COORDS-based:</span></div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;    myhslope1=2.0-<a class="code" href="../../d9/de9/coord_8c.html#ab0e0c0acf7cc9040907c895921b3fed7">Qjet</a>*pow(V[1]/<a class="code" href="../../d9/de9/coord_8c.html#a941700197dd24e782cbb0add66a42dbd">r1jet</a>,-<a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>*(0.5+1.0/M_PI*atan(V[1]/<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>-<a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>/<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>)));</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;    myhslope2=2.0-<a class="code" href="../../d9/de9/coord_8c.html#ab0e0c0acf7cc9040907c895921b3fed7">Qjet</a>*pow(localrbr/<a class="code" href="../../d9/de9/coord_8c.html#a941700197dd24e782cbb0add66a42dbd">r1jet</a>,-<a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>*(0.5+1.0/M_PI*atan(localrbr/<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>-<a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>/<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>)));</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;    myhslope = myhslope1*switch2 + myhslope2*switch0;</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;    <span class="keywordflow">if</span>(0){</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;      <span class="comment">// myhslope here is h0 in MCAF paper</span></div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;      th0 = M_PI * X[2] + ((1. - myhslope) * 0.5) * mysin(2. * M_PI * X[2]);</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;    }</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;    <span class="keywordflow">else</span>{  <span class="comment">// SUPERMADNEW</span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;      <span class="comment">// poly grid</span></div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;      <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> xi=((1. - myhslope) * 0.5);</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;      th0 = M_PI * .5 * (myhslope*(2.0*X[2]-1.0) + (1.0-myhslope)*pow(2.0*X[2]-1.0,3.0)+1.);</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;      <span class="comment">//      dualfprintf(fail_file,&quot;myhslope=%g th0=%g\n&quot;,myhslope,th0);</span></div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;    }</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;    <span class="comment">// determine switches (only function of radius and not x2 or theta)</span></div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    switch0 = 0.5+1.0/M_PI*atan((V[1]-<a class="code" href="../../d9/de9/coord_8c.html#aaa4f963acaccd1ea63a18f800fd576a1">rs</a>)/<a class="code" href="../../d9/de9/coord_8c.html#a54081391e09395407d47aec84f3d97c9">r0</a>); <span class="comment">// switch in .nb file // switch0-&gt;1 as r-&gt;infinity</span></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    switch2 = 1.0-switch0; <span class="comment">// for inner radial region</span></div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    <span class="comment">// this works because all functions are monotonic, so final result is monotonic.  Also, th(x2=1)=Pi and th(x2=0)=0 as required</span></div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;    theta1 = th0*switch2 + th2*switch0; <span class="comment">// th0 is activated for small V[1] and th2 is activated at large radii.  Notice that sum of switch2+switch0=1 so normalization correct.</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;<span class="preprocessor"></span>    </div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;    <span class="comment">// fix_3dpoledtissue.nb based:</span></div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;    theta2 = M_PI*0.5*(<a class="code" href="../../d9/de9/coord_8c.html#a2e5b7193188d9601aadc8d7f06fe121c">htheta</a>*(2.0*X[2]-1.0)+(1.0-<a class="code" href="../../d9/de9/coord_8c.html#a2e5b7193188d9601aadc8d7f06fe121c">htheta</a>)*pow(2.0*X[2]-1.0,<a class="code" href="../../d9/de9/coord_8c.html#a83fde478856d3e284e192734eb140ce5">ntheta</a>)+1.0);</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;    <span class="comment">// generate interpolation factor</span></div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;    arctan2 = 0.5 + 1.0/M_PI*(atan( (V[1]-<a class="code" href="../../d9/de9/coord_8c.html#a6ae559d1c0eb70aefa1b83129530a2fd">rsjet2</a>)/<a class="code" href="../../d9/de9/coord_8c.html#a10ea48caa54649707c33041bc3bc298c">r0jet2</a>) );</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;    <span class="comment">// now interpolate between them</span></div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;    V[2] = theta2 + arctan2*(theta1-theta2);</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;    </div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;    <span class="comment">// default is uniform \phi grid</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;    V[3]=2.0*M_PI*X[3];</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;  }</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a22ccf670681b96ce61d974db87204a10">BPTHIN1</a>) {</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;<span class="preprocessor">#if(0) // no change in exponentiation</span></div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;<span class="preprocessor"></span>    <span class="comment">// JET3COORDS-like radial grid</span></div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;    V[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>+exp(pow(X[1],<a class="code" href="../../d9/de9/coord_8c.html#a565a42e16bf3620bb640120f8c1a4e2a">bp_npow</a>)) ;</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;<span class="preprocessor">#if(0)</span></div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;<span class="preprocessor"></span>    theexp = <a class="code" href="../../d9/de9/coord_8c.html#a565a42e16bf3620bb640120f8c1a4e2a">bp_npow</a>*X[1];</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;    <span class="keywordflow">if</span>( X[1] &gt; <a class="code" href="../../d9/de9/coord_8c.html#a4fa1cafdb60ad24851dcf7f6a85d196c">bp_x1br</a> ) {</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;      theexp += <a class="code" href="../../d9/de9/coord_8c.html#aa3c25e2dcf468d66d223576997aaa124">bp_cpow2</a> * pow(X[1]-<a class="code" href="../../d9/de9/coord_8c.html#a4fa1cafdb60ad24851dcf7f6a85d196c">bp_x1br</a>,<a class="code" href="../../d9/de9/coord_8c.html#a0cce4548534baf8c1e0f2fbdd706117c">bp_npow2</a>);</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;    }</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    V[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>+exp(theexp);</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;<span class="preprocessor"></span>    <span class="comment">/*if(X[1]&lt;bp_x1br){</span></div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;<span class="comment">      switchrad0=0.0;</span></div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;<span class="comment">      switchrad2=1.0;</span></div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;<span class="comment">    }</span></div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;<span class="comment">    else</span></div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;<span class="comment">    {</span></div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;<span class="comment">        switchrad0=1.0;</span></div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;<span class="comment">        switchrad2=0.0;</span></div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;<span class="comment">        }*/</span></div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;    switchrad0 = 0.5+1.0/M_PI*atan((X[1]-<a class="code" href="../../d9/de9/coord_8c.html#a4fa1cafdb60ad24851dcf7f6a85d196c">bp_x1br</a>)*5.*10./<a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[1]/<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1]); <span class="comment">//dx[1]/N1);//totalsize[1]); // switch in .nb file</span></div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;    switchrad2 = 0.5-1.0/M_PI*atan((X[1]-<a class="code" href="../../d9/de9/coord_8c.html#a4fa1cafdb60ad24851dcf7f6a85d196c">bp_x1br</a>)*5.*10./<a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[1]/<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1]); <span class="comment">//dx[1]~.03151/N1);//totalsize[1]); // switchi in .nb file</span></div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    theexp1 = <a class="code" href="../../d9/de9/coord_8c.html#a565a42e16bf3620bb640120f8c1a4e2a">bp_npow</a>*X[1];</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    theexp2 = theexp1+<a class="code" href="../../d9/de9/coord_8c.html#aa3c25e2dcf468d66d223576997aaa124">bp_cpow2</a> * pow(X[1]-<a class="code" href="../../d9/de9/coord_8c.html#a4fa1cafdb60ad24851dcf7f6a85d196c">bp_x1br</a>,<a class="code" href="../../d9/de9/coord_8c.html#a0cce4548534baf8c1e0f2fbdd706117c">bp_npow2</a>);</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;    V[1] = (<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>+exp(theexp1))*switchrad2 + (<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>+exp(theexp2))*switchrad0; </div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    <span class="comment">//    FTYPE npowtrue,npowlarger=10.0;</span></div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;    <span class="comment">//    FTYPE npowrs=1E3;</span></div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;    <span class="comment">//    FTYPE npowr0=2E2;</span></div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;    <span class="comment">//    npowtrue = npow + (npowlarger-npow)*(0.5+1.0/M_PI*atan((V[1]-npowrs)/npowr0));</span></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    <span class="comment">//    V[1] = R0+exp(pow(X[1],npowtrue)) ;</span></div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;    <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> theta1,theta2,arctan2;</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;<span class="preprocessor">#if(0)</span></div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;<span class="preprocessor"></span>    <span class="comment">// JET3COORDS-based:</span></div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    myhslope=2.0-<a class="code" href="../../d9/de9/coord_8c.html#a50374ed958868696ce52b141be1e7677">bp_Qjet</a>*pow(V[1]/<a class="code" href="../../d9/de9/coord_8c.html#a7a94b12c588980b5ab27f7eeafb87cff">bp_r1jet</a>,-<a class="code" href="../../d9/de9/coord_8c.html#af88a4fd7d71742e941f216f36ad6b54a">bp_njet</a>*(0.5+1.0/M_PI*atan(V[1]/<a class="code" href="../../d9/de9/coord_8c.html#a54158096cc3ecff6f170b1c73f37b4eb">bp_r0jet</a>-<a class="code" href="../../d9/de9/coord_8c.html#a089b6a95e1b9ff1c17894dc843624fdc">bp_rsjet</a>/<a class="code" href="../../d9/de9/coord_8c.html#a54158096cc3ecff6f170b1c73f37b4eb">bp_r0jet</a>)));</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    theta1 = M_PI * X[2] + ((1. - myhslope) * 0.5) * mysin(2. * M_PI * X[2]);</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;<span class="preprocessor"></span>    <span class="comment">// RAMESH BASED</span></div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;    <span class="comment">// myhslope here is h2 in MCAF paper</span></div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;    <span class="comment">// h0 here is h3 in MCAF paper</span></div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;    <span class="comment">//if(V[1] &gt; bp_rsjet3){</span></div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;    myhslope=<a class="code" href="../../d9/de9/coord_8c.html#a95ffc6e8abca3051b2b5163e21d0c135">bp_h0</a> + pow( (V[1]-<a class="code" href="../../d9/de9/coord_8c.html#a4094a39b7ecf5cd989692b3997bc2f0a">bp_rsjet3</a>)/<a class="code" href="../../d9/de9/coord_8c.html#a5a867407978fba43d13a1bf73039e623">bp_r0jet3</a> , <a class="code" href="../../d9/de9/coord_8c.html#af88a4fd7d71742e941f216f36ad6b54a">bp_njet</a>);</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;    <span class="comment">//}</span></div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;    <span class="comment">/*else {</span></div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;<span class="comment">    myhslope=bp_h0;</span></div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;<span class="comment">    }*/</span></div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;    <span class="comment">// determine theta2</span></div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;    <span class="keywordflow">if</span>(X[2]&gt;1.0) myx2=2.0-X[2];</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(X[2]&lt;0.0) myx2=-X[2];</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;    <span class="keywordflow">else</span> myx2=X[2];</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    th2 = M_PI*.5*(.2*(2.0*myx2-1.0) + (1.0-.2)*pow(2.0*myx2-1,3.0)+1.0);</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    <span class="keywordflow">if</span>(X[2]&gt;1.0) th2=2.0*M_PI-th2;</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(X[2]&lt;0.0) th2=-th2;</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;    <span class="comment">// determine theta0</span></div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    <span class="comment">// JET3COORDS-based:</span></div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    <span class="comment">//    myhslope=2.0-bp_Qjet*pow(V[1]/bp_r1jet,-bp_njet1*(0.5+1.0/M_PI*atan(V[1]/bp_r0jet-bp_rsjet/bp_r0jet)));</span></div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;    myhslope=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a93f06eb0b7c274f722a7e09d4861a941">hslope</a>;</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;    <span class="comment">// myhslope here is h0 in MCAF paper</span></div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;    <span class="comment">//    th0 = M_PI * .5 * (1. + (1.-((1. - myhslope) * 0.5))*(2.*X[2]-1.) + ((1. - myhslope) * 0.5)*pow(2.*X[2]-1.,9) ) ; // MARKTODODONE  switched to poly type from Noble+ 2010 on June 10, 2013</span></div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;    <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> xi=((1. - myhslope) * 0.5);</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;    <span class="comment">//  th0 = M_PI * .5 * (1. + (1.-xi)*(2.*X[2]-1.) + xi*pow(2.*X[2]-1.,9) ) ; // MARKTODODONE  switched to poly type from Noble+ 2010 on June 10, 2013</span></div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;    <span class="comment">//switchinner0 = 0.5+1.0/M_PI*atan((V[1]-bp_rsinner)/bp_r0inner); // switch in .nb file</span></div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    <span class="comment">//switchinner2 = 0.5-1.0/M_PI*atan((V[1]-bp_rsinner)/bp_r0inner); // switchi in .nb file</span></div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    </div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;    <span class="comment">//th0 = M_PI * .5 * (.2*(2.0*X[2]-1.0) + (1.0-.2)*pow(2.0*X[2]-1.0,9.0)+1.) ;</span></div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;<span class="comment">    if(X[2]&gt;=.5){</span></div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;<span class="comment">      thetasign=+1.0;</span></div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;<span class="comment">      x2temp=X[2];</span></div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;<span class="comment">        }</span></div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;<span class="comment">    else {</span></div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;<span class="comment">      thetasign=-1.0;</span></div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;<span class="comment">      x2temp=1.0-X[2];</span></div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;<span class="comment">    }</span></div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;    th0 = M_PI * .5 * (.11875*(1.+(<a class="code" href="../../d9/de9/coord_8c.html#aa54849ebc8093319bbf05517dfc21110">bp_rsinner</a>/V[1]))*(2.0*X[2]-1.0) +(1.0-.11875*(1.+(<a class="code" href="../../d9/de9/coord_8c.html#aa54849ebc8093319bbf05517dfc21110">bp_rsinner</a>/V[1])))*pow(2.0*X[2]-1.0,9.0)+1.) ; <span class="comment">// .1096=.1425/(1+6/20) -- .11875 is .1425/(1+4/20) --- .17 is .2/(1.+4/15.)</span></div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;    <span class="comment">//    if(X[2]&gt;=0.5 &amp;&amp; (mycpupos[2]==ncpux2/2 &amp;&amp; ncpux2&gt;1 || ncpux2==1)) printf(&quot;at radius %21.15g and X[2] = %21.15g the diff is %21.15e\n&quot;,V[1],X[2],th0toprint);</span></div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    <span class="comment">// th0 = M_PI * .5 * (.2*(2.0*X[2]-1.0) + (1.0-.2)*pow(2.0*X[2]-1.0,9.0)+1.) ;</span></div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    </div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    <span class="comment">// determine switches (only function of radius and not x2 or theta)</span></div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;    switch0 = 0.5+1.0/M_PI*atan((V[1]-<a class="code" href="../../d9/de9/coord_8c.html#a00cd3b5afe216561157f1f3a53d8610e">bp_rs</a>)/<a class="code" href="../../d9/de9/coord_8c.html#ac6c2bb2b523c5805b7df12b34a6287eb">bp_r0</a>); <span class="comment">// switch in .nb file</span></div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;    switch2 = 0.5-1.0/M_PI*atan((V[1]-<a class="code" href="../../d9/de9/coord_8c.html#a00cd3b5afe216561157f1f3a53d8610e">bp_rs</a>)/<a class="code" href="../../d9/de9/coord_8c.html#ac6c2bb2b523c5805b7df12b34a6287eb">bp_r0</a>); <span class="comment">// switchi in .nb file</span></div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    <span class="comment">// this works because all functions are monotonic, so final result is monotonic.  Also, th(x2=1)=Pi and th(x2=0)=0 as required</span></div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    theta1 = th0*switch2 + th2*switch0; <span class="comment">// th0 is activated for small V[1] and th2 is activated at large radii.  Notice that sum of switch2+switch0=1 so normalization correct.</span></div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;<span class="preprocessor">#if(1)    </span></div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;<span class="preprocessor"></span>    <span class="comment">// fix_3dpoledtissue.nb based:</span></div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;    theta2 = M_PI*0.5*(.11875*(1.+(<a class="code" href="../../d9/de9/coord_8c.html#aa54849ebc8093319bbf05517dfc21110">bp_rsinner</a>/V[1]))*(2.0*X[2]-1.0)+(1.0-.11875*(1.+(<a class="code" href="../../d9/de9/coord_8c.html#aa54849ebc8093319bbf05517dfc21110">bp_rsinner</a>/V[1])))*pow(2.0*X[2]-1.0,<a class="code" href="../../d9/de9/coord_8c.html#a0cb81219b4699253263ef5166f5fcb5f">bp_ntheta</a>)+1.0);</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    <span class="comment">// generate interpolation factor</span></div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;    arctan2 = 0.5 + 1.0/M_PI*(atan( (V[1]-<a class="code" href="../../d9/de9/coord_8c.html#a0bd0efdb0c8c30cbfa8174f4786c260d">bp_rsjet2</a>)/<a class="code" href="../../d9/de9/coord_8c.html#a5bb1f817cc895142f229f3275204fb08">bp_r0jet2</a>) ); <span class="comment">// MAVARA: outside a certain radius this switches the v2 dependence from theta2 to theta1....known as interpolation. this interpolation fixes pole issue. previous involving switch0/2 involves more fundamental difference in vertical distribution.</span></div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;    <span class="comment">// now interpolate between them</span></div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;    V[2] = theta2 + arctan2*(theta1-theta2);</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;<span class="preprocessor"></span>    V[2] = theta1;</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;    <span class="comment">// default is uniform \phi grid</span></div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;    V[3]=2.0*M_PI*X[3];</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;  }</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a5e2e2deaaa6af505fdb3c7b3c2f817a5">JET5COORDS</a>) {</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    <span class="comment">// radial grid</span></div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    ii=X[1]*((<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>)<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1]); <span class="comment">// assume X[1]=0..1 for active grid going from Rin to Rout</span></div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;    <span class="comment">// radial arctan</span></div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;    radialarctan=(1.0/2.0) + (1.0/M_PI)*atan((ii-<a class="code" href="../../d9/de9/coord_8c.html#a5c290996245039518a5b33e0ea065efc">ii0</a>)/<a class="code" href="../../d9/de9/coord_8c.html#abcc0aa57debd9aa5e7f1aa918a2a3c1a">CCCC</a>);</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;    <span class="comment">// merge of exp grid and exp-exp grid</span></div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;    <span class="comment">// first term is normal exp, second term is exp-exp</span></div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;    logform = <a class="code" href="../../d9/de9/coord_8c.html#a2c72f016de11e17e0a2e6fa70d147632">AAA</a>*ii + exp(<a class="code" href="../../d9/de9/coord_8c.html#ae48fe9ae969558bf17a1cdbd2d0deb5b">BBB</a>+<a class="code" href="../../d9/de9/coord_8c.html#a333d082b5608e2d1dc51ef0194ed866e">DDD</a>*ii)*radialarctan;</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;    <span class="comment">// final radius</span></div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;    V[1] = <a class="code" href="../../d9/de9/coord_8c.html#a4a1725236323ec7cbb4359d2485c529d">AAAA</a>+exp(logform);</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    </div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;    <span class="comment">// \theta grid</span></div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;    <span class="comment">// theta arctan</span></div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;    thetaarctan=(1.0/2.0) + (1.0/M_PI)*atan((V[1]-<a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>)/<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>);</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;    <span class="comment">// h(r)</span></div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;    myhslope=2.0-<a class="code" href="../../d9/de9/coord_8c.html#ab0e0c0acf7cc9040907c895921b3fed7">Qjet</a>*pow(V[1]/<a class="code" href="../../d9/de9/coord_8c.html#a941700197dd24e782cbb0add66a42dbd">r1jet</a>,-<a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>*thetaarctan);</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;    <span class="comment">// final theta</span></div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;    <span class="keywordflow">if</span>(X[2]&lt;0.5){</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;      V[2] = M_PI * X[2] + ((1. - myhslope) / 2.) * mysin(2. * M_PI * X[2]);</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;    }</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;      V[2] = M_PI - (M_PI * (1.0-X[2])) + ((1. - myhslope) / 2.) * (-mysin(2. * M_PI * (1.0-X[2])));</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;    }</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;    <span class="comment">// \phi grid</span></div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;    <span class="comment">// default is uniform \phi grid</span></div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;    V[3]=2.0*M_PI*X[3];</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;  }</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a0e5331f6ac2b706aa4e76de967dcb1d7">JET6COORDSTHIN</a>) {</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;<span class="preprocessor">#if(0) // no change in exponentiation</span></div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;<span class="preprocessor"></span>    <span class="comment">// JET3COORDS-like radial grid</span></div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;    V[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>+exp(pow(X[1],th_npow)) ;</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;    theexp = th_npow*X[1];</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    <span class="keywordflow">if</span>( X[1] &gt; th_x1br ) {</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;      theexp += th_cpow2 * pow(X[1]-th_x1br,th_npow2);</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    }</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    V[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>+exp(theexp);</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    <span class="comment">//    FTYPE npowtrue,npowlarger=10.0;</span></div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;    <span class="comment">//    FTYPE th_npowrs=1E3;</span></div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;    <span class="comment">//    FTYPE th_npowr0=2E2;</span></div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;    <span class="comment">//    npowtrue = th_npow + (npowlarger-th_npow)*(0.5+1.0/M_PI*atan((V[1]-th_npowrs)/th_npowr0));</span></div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    <span class="comment">//    V[1] = R0+exp(pow(X[1],npowtrue)) ;</span></div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> theta1,theta2,arctan2;</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;<span class="preprocessor">#if(0)</span></div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;<span class="preprocessor"></span>    <span class="comment">// JET3COORDS-based:</span></div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;    myhslope=2.0-th_Qjet*pow(V[1]/th_r1jet,-th_njet*(0.5+1.0/M_PI*atan(V[1]/th_r0jet-th_rsjet/th_r0jet)));</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;    theta1 = M_PI * X[2] + ((1. - myhslope) * 0.5) * mysin(2. * M_PI * X[2]);</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;<span class="preprocessor"></span>    <span class="comment">// RAMESH BASED</span></div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;    <span class="comment">// myhslope here is h2 in MCAF paper</span></div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    <span class="comment">//    // h0 here is h3 in MCAF paper</span></div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;    <span class="comment">//FTYPE njetvsr;</span></div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;    <span class="comment">//if(V[1]&lt;th_rbr) njetvsr=th_njet;</span></div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;    <span class="comment">//    else njetvsr=th_njet/(V[1])*th_rbr;</span></div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;    <span class="comment">//else njetvsr=</span></div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;    <span class="comment">//njetvsr=th_njet;</span></div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;    </div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    <span class="keywordflow">if</span>(V[1]&lt;th_rbr){</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;      myhslope=th_h0 + pow( (V[1]-th_rsjet3)/th_r0jet3 , th_njet);</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;    }</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;    <span class="keywordflow">else</span> myhslope=th_h0 + pow( (th_rbr-th_rsjet3)/th_r0jet3 , th_njet);</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;    <span class="comment">// determine theta2</span></div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;    <span class="keywordflow">if</span>(X[2]&gt;1.0) myx2=2.0-X[2];</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(X[2]&lt;0.0) myx2=-X[2];</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;    <span class="keywordflow">else</span> myx2=X[2];</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;    th2 = 0.5*M_PI*(1.0 + atan(myhslope*(myx2-0.5))/atan(myhslope*0.5));</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;    <span class="keywordflow">if</span>(X[2]&gt;1.0) th2=2.0*M_PI-th2;</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(X[2]&lt;0.0) th2=-th2;</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;    <span class="comment">// determine theta0</span></div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;    <span class="comment">// JET3COORDS-based:</span></div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    <span class="keywordflow">if</span>(V[1]&lt;th_rbr){</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;      myhslope=2.0-th_Qjet*pow(V[1]/th_r1jet,-th_njet*(0.5+1.0/M_PI*atan(V[1]/th_r0jet-th_rsjet/th_r0jet)));</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;    }</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;    <span class="keywordflow">else</span> myhslope=2.0-th_Qjet*pow(th_rbr/th_r1jet,-th_njet*(0.5+1.0/M_PI*atan(th_rbr/th_r0jet-th_rsjet/th_r0jet)));</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;    <span class="keywordflow">if</span>(0){</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;      <span class="comment">// myhslope here is h0 in MCAF paper</span></div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;      th0 = M_PI * X[2] + ((1. - myhslope) * 0.5) * mysin(2. * M_PI * X[2]);</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;    }</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;    <span class="keywordflow">if</span>(1){</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;      <span class="comment">// poly grid</span></div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;      <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> xi=((1. - myhslope) * 0.5);</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;      th0 = M_PI * .5 * (myhslope*(2.0*X[2]-1.0) + (1.0-myhslope)*pow(2.0*X[2]-1.0,9.0)+1.);</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;    }</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;    <span class="comment">// determine switches (only function of radius and not x2 or theta)</span></div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;    switch0 = 0.5+1.0/M_PI*atan((V[1]-th_rs)/th_r0); <span class="comment">// switch in .nb file</span></div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;    switch2 = 0.5-1.0/M_PI*atan((V[1]-th_rs)/th_r0); <span class="comment">// switchi in .nb file</span></div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;    <span class="comment">// this works because all functions are monotonic, so final result is monotonic.  Also, th(x2=1)=Pi and th(x2=0)=0 as required</span></div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;    theta1 = th0*switch2 + th2*switch0; <span class="comment">// th0 is activated for small V[1] and th2 is activated at large radii.  Notice that sum of switch2+switch0=1 so normalization correct.</span></div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;<span class="preprocessor"></span>    </div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;    <span class="comment">// fix_3dpoledtissue.nb based:</span></div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;    theta2 = M_PI*0.5*(th_htheta*(2.0*X[2]-1.0)+(1.0-<a class="code" href="../../d9/de9/coord_8c.html#ad1bfc9d7b5de958b272f91284b3e74fc">th_htheta</a>)*pow(2.0*X[2]-1.0,th_ntheta)+1.0);</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    <span class="comment">// generate interpolation factor</span></div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;    arctan2 = 0.5 + 1.0/M_PI*(atan( (V[1]-th_rsjet2)/th_r0jet2) );</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;    <span class="comment">// now interpolate between them</span></div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;    V[2] = theta2 + arctan2*(theta1-theta2);</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;    </div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;    <span class="comment">// default is uniform \phi grid</span></div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;    V[3]=2.0*M_PI*X[3];</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;  }</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a5e2e2deaaa6af505fdb3c7b3c2f817a5">JET5COORDS</a>) {</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;    <span class="comment">// radial grid</span></div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;    ii=X[1]*((<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>)<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1]); <span class="comment">// assume X[1]=0..1 for active grid going from Rin to Rout</span></div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;    <span class="comment">// radial arctan</span></div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;    radialarctan=(1.0/2.0) + (1.0/M_PI)*atan((ii-<a class="code" href="../../d9/de9/coord_8c.html#a5c290996245039518a5b33e0ea065efc">ii0</a>)/<a class="code" href="../../d9/de9/coord_8c.html#abcc0aa57debd9aa5e7f1aa918a2a3c1a">CCCC</a>);</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;    <span class="comment">// merge of exp grid and exp-exp grid</span></div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;    <span class="comment">// first term is normal exp, second term is exp-exp</span></div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;    logform = <a class="code" href="../../d9/de9/coord_8c.html#a2c72f016de11e17e0a2e6fa70d147632">AAA</a>*ii + exp(<a class="code" href="../../d9/de9/coord_8c.html#ae48fe9ae969558bf17a1cdbd2d0deb5b">BBB</a>+<a class="code" href="../../d9/de9/coord_8c.html#a333d082b5608e2d1dc51ef0194ed866e">DDD</a>*ii)*radialarctan;</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;    <span class="comment">// final radius</span></div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;    V[1] = <a class="code" href="../../d9/de9/coord_8c.html#a4a1725236323ec7cbb4359d2485c529d">AAAA</a>+exp(logform);</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;    </div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;    <span class="comment">// \theta grid</span></div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;    <span class="comment">// theta arctan</span></div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;    thetaarctan=(1.0/2.0) + (1.0/M_PI)*atan((V[1]-<a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>)/<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>);</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;    <span class="comment">// h(r)</span></div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;    myhslope=2.0-<a class="code" href="../../d9/de9/coord_8c.html#ab0e0c0acf7cc9040907c895921b3fed7">Qjet</a>*pow(V[1]/<a class="code" href="../../d9/de9/coord_8c.html#a941700197dd24e782cbb0add66a42dbd">r1jet</a>,-<a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>*thetaarctan);</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;    <span class="comment">// final theta</span></div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;    <span class="keywordflow">if</span>(X[2]&lt;0.5){</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;      V[2] = M_PI * X[2] + ((1. - myhslope) / 2.) * mysin(2. * M_PI * X[2]);</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;    }</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;      V[2] = M_PI - (M_PI * (1.0-X[2])) + ((1. - myhslope) / 2.) * (-mysin(2. * M_PI * (1.0-X[2])));</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;    }</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;    <span class="comment">// \phi grid</span></div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;    <span class="comment">// default is uniform \phi grid</span></div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;    V[3]=2.0*M_PI*X[3];</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;  }</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a87e4392d8d6cdc988ced46d7e7a2dfe2">PULSARCOORDS</a>) {</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;    V[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>+exp(pow(X[1],<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>)) ;</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;    myhslope=(0.5+1.0/M_PI*atan((V[1]-<a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>)/<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>))*(<a class="code" href="../../d9/de9/coord_8c.html#a808590103058909774d170d48f1e5723">houter</a>-<a class="code" href="../../d9/de9/coord_8c.html#adb91c14ac2eecf2e4745073392a7af6f">hinner</a>)+<a class="code" href="../../d9/de9/coord_8c.html#adb91c14ac2eecf2e4745073392a7af6f">hinner</a>;</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;    <span class="keywordflow">if</span>(X[2]&lt;0.5){</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;      V[2] = M_PI * X[2] + ((1. - myhslope) / 2.) * mysin(2. * M_PI * X[2]);</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;    }</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;      V[2] = M_PI - (M_PI * (1.0-X[2])) + ((1. - myhslope) / 2.) * (-mysin(2. * M_PI * (1.0-X[2])));</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;    }</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;    <span class="comment">// default is uniform \phi grid</span></div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;    V[3]=2.0*M_PI*X[3];</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;  }</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a47b225226fbd0e3e573ec095071ecc10">UNIFORMCOORDS</a>) {</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;    <span class="comment">//uniform grid for Cartesian coordinates</span></div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;    V[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#a20ba1a68d196e97fa84463164fd907d1">Rin_array</a>[1] + X[1] * ( <a class="code" href="../../d8/d5b/defs_8general_8h.html#aff141f9f52f9bbd4911d4dabcf2aaec9">Rout_array</a>[1] - <a class="code" href="../../d8/d5b/defs_8general_8h.html#a20ba1a68d196e97fa84463164fd907d1">Rin_array</a>[1] );</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;    V[2] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#a20ba1a68d196e97fa84463164fd907d1">Rin_array</a>[2] + X[2] * ( <a class="code" href="../../d8/d5b/defs_8general_8h.html#aff141f9f52f9bbd4911d4dabcf2aaec9">Rout_array</a>[2] - <a class="code" href="../../d8/d5b/defs_8general_8h.html#a20ba1a68d196e97fa84463164fd907d1">Rin_array</a>[2] );</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;    V[3] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#a20ba1a68d196e97fa84463164fd907d1">Rin_array</a>[3] + X[3] * ( <a class="code" href="../../d8/d5b/defs_8general_8h.html#aff141f9f52f9bbd4911d4dabcf2aaec9">Rout_array</a>[3] - <a class="code" href="../../d8/d5b/defs_8general_8h.html#a20ba1a68d196e97fa84463164fd907d1">Rin_array</a>[3] );</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;  }</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#adf7ec499e840df38ef6d0230239d75e2">BILOGCYLCOORDS</a>) {</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;    <span class="comment">// R : cylindrical radius, assumes X[1]=0..1</span></div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;    <span class="comment">// exponential grid</span></div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;    V[1] = ((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>)*exp(<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>*X[1])+<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>*exp(<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>)-<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>)/(exp(<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>)-1.0);</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;    </div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;    <span class="comment">// z : cylindrical height, assumes X[2]=-1..1</span></div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;    <span class="comment">// bi-exponential grid</span></div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;    <span class="comment">// here the grid goes from Zin to Zout in a bi-log way, and X[2]=0 is Z=0</span></div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;    <span class="keywordflow">if</span>(X[2]&gt;0.0) V[2] = ((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a85aa83ad1ffba6b0ff5e357304685949">Zout</a>-0)*exp(<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>*fabs(X[2])) + 0*exp(<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>)-<a class="code" href="../../d8/d5b/defs_8general_8h.html#a85aa83ad1ffba6b0ff5e357304685949">Zout</a>)/(exp(<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>)-1.0);</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;    <span class="keywordflow">else</span> V[2] = ((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a77542ce754587f4fccf3eac160629d5d">Zin</a>-0)*exp(<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>*fabs(X[2])) + 0*exp(<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>)-<a class="code" href="../../d8/d5b/defs_8general_8h.html#a77542ce754587f4fccf3eac160629d5d">Zin</a>)/(exp(<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>)-1.0);</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;    </div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;  } </div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#aa0a3d1a614796ea8787d7360932b121c">RAMESHCOORDS</a>|| <a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a320ee4f267db4b195bbde94bec748a29">RAMESHCOORDS_HALFDISK</a>) {</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;    V[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>+exp(pow(X[1],<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>)) ;</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;    myhslope=pow( (V[1]-<a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>)/<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a> , <a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>);</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;    <span class="keywordflow">if</span>(X[2]&gt;1.0) myx2=2.0-X[2];</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(X[2]&lt;0.0) myx2=-X[2];</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;    <span class="keywordflow">else</span> myx2=X[2];</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;    V[2] = 0.5*M_PI*(1.0 + atan(myhslope*(myx2-0.5))/atan(myhslope*0.5));</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;    <span class="keywordflow">if</span>(X[2]&gt;1.0) V[2]=2.0*M_PI-V[2];</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(X[2]&lt;0.0) V[2]=-V[2];</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;    <span class="comment">// default is uniform \phi grid</span></div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;    V[3]=2.0*M_PI*X[3];</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;  }</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a6e1b80715afcab76e5ec0827d7113aa9">JET4COORDS</a>) {</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;<span class="preprocessor">#if(0)</span></div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;<span class="preprocessor"></span>    <span class="comment">// combines RAMESHCOORDS with original simple SINTH grid</span></div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aab7332b2c03d905515d5350d4fd0850f">X1DN</a>]==<a class="code" href="../../da/d3e/definit_8h.html#a94f10ecb00225a561c8fad850f7386f7">R0SING</a>){</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>&gt;=0.0){</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;        dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;With log grid and R0SING must have R0&lt;0 instead of %26.20g\n&quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>);</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;        myexit(8274);</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;      }</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;      X0 = log(-<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>);</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;      <span class="keywordflow">if</span>(X[1]&gt;X0) V[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>+exp(X[1]) ;</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;      <span class="keywordflow">else</span> V[1] = -(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>+<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>*<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>*exp(-X[1])) ;</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;      <span class="comment">//      dualfprintf(fail_file,&quot;X0=%26.20g V[1]=%26.20g\n&quot;,X0,V[1]);</span></div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;    }</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;      V[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>+exp(X[1]) ;</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;      <span class="comment">// if V[1]=r&lt;0 here, the presume only where interpolation boundaries are, not evolved quantities, and not extending so far negative radius that reach beyond, e.g. light cylinder so that velocities will be undefined with simple extrapolation</span></div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;    }</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;<span class="preprocessor"></span>    <span class="comment">// JET3COORDS-like radial grid</span></div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;    V[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>+exp(pow(X[1],<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>)) ;</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;    myhslope=<a class="code" href="../../d9/de9/coord_8c.html#af5c3d95ab07a3b7fdff23bdde44b6ed0">h0</a> + pow( (V[1]-<a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>)/<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a> , <a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>);</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;    <span class="comment">// determine theta2</span></div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;    <span class="keywordflow">if</span>(X[2]&gt;1.0) myx2=2.0-X[2];</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(X[2]&lt;0.0) myx2=-X[2];</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;    <span class="keywordflow">else</span> myx2=X[2];</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;    th2 = 0.5*M_PI*(1.0 + atan(myhslope*(myx2-0.5))/atan(myhslope*0.5));</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;    <span class="keywordflow">if</span>(X[2]&gt;1.0) th2=2.0*M_PI-th2;</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(X[2]&lt;0.0) th2=-th2;</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;    <span class="comment">// determine theta0</span></div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;    myhslope=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a93f06eb0b7c274f722a7e09d4861a941">hslope</a>;</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;    <span class="keywordflow">if</span>(X[2]&lt;0.5){</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;      th0 = M_PI * X[2] + ((1. - myhslope) / 2.) * mysin(2. * M_PI * X[2]);</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;    }</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;      th0 = M_PI - (M_PI * (1.0-X[2])) + ((1. - myhslope) / 2.) * (-mysin(2. * M_PI * (1.0-X[2])));</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;    }</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;    <span class="comment">// determine switches (only function of radius and not x2 or theta)</span></div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;    switch0 = 0.5+1.0/M_PI*atan((V[1]-<a class="code" href="../../d9/de9/coord_8c.html#aaa4f963acaccd1ea63a18f800fd576a1">rs</a>)/<a class="code" href="../../d9/de9/coord_8c.html#a54081391e09395407d47aec84f3d97c9">r0</a>); <span class="comment">// switch in .nb file</span></div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;    switch2 = 0.5-1.0/M_PI*atan((V[1]-<a class="code" href="../../d9/de9/coord_8c.html#aaa4f963acaccd1ea63a18f800fd576a1">rs</a>)/<a class="code" href="../../d9/de9/coord_8c.html#a54081391e09395407d47aec84f3d97c9">r0</a>); <span class="comment">// switchi in .nb file</span></div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;    <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> theta1,theta2,arctan2;</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;    <span class="comment">// this works because all functions are monotonic, so final result is monotonic.  Also, th(x2=1)=Pi and th(x2=0)=0 as required</span></div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;    theta1 = th0*switch2 + th2*switch0; <span class="comment">// th0 is activated for small V[1] and th2 is activated at large radii.  Notice that sum of switch2+switch0=1 so normalization correct.</span></div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;    <span class="comment">// fix_3dpoledtissue.nb based:</span></div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;    theta2 = M_PI*0.5*(<a class="code" href="../../d9/de9/coord_8c.html#a2e5b7193188d9601aadc8d7f06fe121c">htheta</a>*(2.0*X[2]-1.0)+(1.0-<a class="code" href="../../d9/de9/coord_8c.html#a2e5b7193188d9601aadc8d7f06fe121c">htheta</a>)*pow(2.0*X[2]-1.0,<a class="code" href="../../d9/de9/coord_8c.html#a83fde478856d3e284e192734eb140ce5">ntheta</a>)+1.0);</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;    <span class="comment">// generate interpolation factor</span></div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;    arctan2 = 0.5 + 1.0/M_PI*(atan( (V[1]-<a class="code" href="../../d9/de9/coord_8c.html#a6ae559d1c0eb70aefa1b83129530a2fd">rsjet2</a>)/<a class="code" href="../../d9/de9/coord_8c.html#a10ea48caa54649707c33041bc3bc298c">r0jet2</a>) );</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;    <span class="comment">// now interpolate between them</span></div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;    V[2] = theta2 + arctan2*(theta1-theta2);</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;    <span class="comment">// default is uniform \phi grid</span></div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;    V[3]=2.0*M_PI*X[3];</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;  }</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a35d1eed7020c0beb59e9b6432fd68175">UNI2LOG</a>) {</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aab7332b2c03d905515d5350d4fd0850f">X1DN</a>]==<a class="code" href="../../da/d3e/definit_8h.html#a94f10ecb00225a561c8fad850f7386f7">R0SING</a> &amp;&amp; X[1]&lt;0.0){</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;      mysign=-1.0;</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;    }</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;      mysign=1.0;</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;    }</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;    ts1 = (<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>)<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;    fnstar = ((<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>)<a class="code" href="../../d9/de9/coord_8c.html#a71a9672d1d7564295af1d92b16656ed2">Nstar</a>);</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;    myNrat = ts1/(fnstar+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a09c78d2f8feb311dd9fc969a0bf84979">SMALL</a>);</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="../../d9/de9/coord_8c.html#a71a9672d1d7564295af1d92b16656ed2">Nstar</a>==0 || fabs(X[1])&gt;=1.0/myNrat ){ <span class="comment">// same as if(fabs(i)&gt;=Nstar)</span></div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;      <span class="comment">// log grid (similar to UNIRSINTH, but now such that startx=0 and dx=1/totalsize[1] and starts at Rstar and arbitrary growth factor Afactor)</span></div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;      V[1] = mysign*(<a class="code" href="../../d9/de9/coord_8c.html#acbb89ba805d17640710dea9b25fc385e">Rstar</a> + (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-<a class="code" href="../../d9/de9/coord_8c.html#acbb89ba805d17640710dea9b25fc385e">Rstar</a>)*(pow(<a class="code" href="../../d9/de9/coord_8c.html#a9a25d0159341c4801263a705248546a9">Afactor</a>, (fabs(X[1])*ts1-fnstar)/(ts1-fnstar))-1.0)/(<a class="code" href="../../d9/de9/coord_8c.html#a9a25d0159341c4801263a705248546a9">Afactor</a>-1.0));</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;    }</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;      <span class="comment">// see UNI2LOGgrid.nb in mathematica</span></div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;      <span class="comment">// uniform grid (sign is correct already with uniform grid)</span></div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;      <span class="comment">//      V[1] = Rin + (Rstar-Rin)*myNrat*X[1];  // purely uniform grid leads to big connection coefficient at i=Nstar-1</span></div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;      <span class="comment">// so use smoother transition</span></div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;      <span class="comment">// i/Nstar = x1*totalsize[1]/Nstar = x1*myNrat</span></div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;      <span class="comment">// sign is not correct for this grid, so fix it</span></div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;      BB = ( (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-<a class="code" href="../../d9/de9/coord_8c.html#acbb89ba805d17640710dea9b25fc385e">Rstar</a>)*log(<a class="code" href="../../d9/de9/coord_8c.html#a9a25d0159341c4801263a705248546a9">Afactor</a>)/( (<a class="code" href="../../d9/de9/coord_8c.html#a9a25d0159341c4801263a705248546a9">Afactor</a>-1.0)*(myNrat-1.0) ) );</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;      CC = BB + (<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>-<a class="code" href="../../d9/de9/coord_8c.html#acbb89ba805d17640710dea9b25fc385e">Rstar</a>);</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;      V[1] = mysign*( <a class="code" href="../../d9/de9/coord_8c.html#acbb89ba805d17640710dea9b25fc385e">Rstar</a> + BB*(fabs(X[1])*myNrat-1.0) + CC*(fabs(X[1])*myNrat-1.0)*(fabs(X[1])*myNrat-1.0) );</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;    }</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;    <span class="comment">// fully express r=0 coordinate singularity</span></div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;    <span class="comment">// V[1]\sim 1E-14 if don&#39;t do this, and then gdet!=0 at r=0 and then flux through r=0 causes MBH and $a$ to be computed wrong.</span></div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aab7332b2c03d905515d5350d4fd0850f">X1DN</a>]==<a class="code" href="../../da/d3e/definit_8h.html#a94f10ecb00225a561c8fad850f7386f7">R0SING</a> &amp;&amp; fabs(V[1]-10.0*<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a8913cb5d64cfec23ae1a3052930ec468">NUMEPSILON</a>)&lt;10.0*<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a8913cb5d64cfec23ae1a3052930ec468">NUMEPSILON</a> ){</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;      V[1] = 0.0; <span class="comment">// so coordinate singularity is fully represented in metric, etc.</span></div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;    }</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;    </div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;    <span class="comment">// x2-direction</span></div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;    <span class="keywordflow">if</span>(X[2]&lt;0.5){</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;      V[2] = M_PI * X[2] + ((1. - <a class="code" href="../../d8/d5b/defs_8general_8h.html#a93f06eb0b7c274f722a7e09d4861a941">hslope</a>) / 2.) * mysin(2. * M_PI * X[2]);</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;    }</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;      <span class="comment">//      V[2] = 0.5*M_PI + M_PI * fabs(X[2]-0.5) + ((1. - hslope) / 2.) * (-mysin(2. * M_PI * (1.0-X[2])));</span></div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;      V[2] = M_PI - (M_PI * (1.0-X[2])) + ((1. - <a class="code" href="../../d8/d5b/defs_8general_8h.html#a93f06eb0b7c274f722a7e09d4861a941">hslope</a>) / 2.) * (-mysin(2. * M_PI * (1.0-X[2])));</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;    }</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;    <span class="comment">// x3-direction</span></div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;    <span class="comment">// default is uniform \phi grid</span></div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;    V[3]=2.0*M_PI*X[3];</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;  }</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Shouldn&#39;t reach end of bl_coord: defcoord=%d\n&quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a>);</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;    myexit(1);</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;  }</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;  <a class="code" href="../../d9/de9/coord_8c.html#af7a086e6042d598aea95c2360d07a99b">blcoord_singfixes</a>(X,V);</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;}</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;</div>
<div class="line"><a name="l02069"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#af7a086e6042d598aea95c2360d07a99b"> 2069</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d9/de9/coord_8c.html#af7a086e6042d598aea95c2360d07a99b">blcoord_singfixes</a>(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *<a class="code" href="../../dc/dd2/newcodediff_8txt.html#a933233ff9879962bcc2ff987c6920f90">X</a>, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *<a class="code" href="../../dc/dd2/newcodediff_8txt.html#af84f2c3bf153920b7c8d186132d39bc7">V</a>)</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;{</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;  <span class="comment">// don&#39;t allow to be smaller to avoid singularity</span></div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;  <span class="comment">// noted this caused problems with jon_interp in calculating jacobian</span></div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;<span class="comment"></span>  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a263ad60a48b4d3fe687c524e69465cc9">POSDEFMETRIC</a>){</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;    <span class="keywordflow">if</span>(V[2]&lt;0) V[2] = -V[2];</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;    <span class="keywordflow">if</span>(V[2]&gt;M_PI) V[2]=2.0*M_PI-V[2];</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;    <span class="keywordflow">if</span>(V[3]&lt;0) V[3] = -V[3];</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;    <span class="keywordflow">if</span>(V[3]&gt;2.0*M_PI) V[3]=4.0*M_PI-V[3];</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;  }</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;<span class="preprocessor">#if( COORDSINGFIXCYL )   //SUPERSASMARK fix the singularity for the cylinrical coordinates</span></div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;<span class="preprocessor"></span>  <span class="comment">// NOTEMARK: just shifting (e.g.) i=0 cell up a bit, nothing else to do. Assume only 1 grid cell (in &quot;i&quot;) is there within such tolerance of SINGSMALL</span></div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;  <span class="keywordflow">if</span>(fabs(V[1]-0.0)&lt;<a class="code" href="../../da/d3e/definit_8h.html#ab279035c1cbedbf8f4aa5a04bb26b442" title="whether to move polar axis to a bit larger theta theta value where singularity is displaced to...">SINGSMALL</a>) V[1]=<a class="code" href="../../da/d3e/definit_8h.html#ab279035c1cbedbf8f4aa5a04bb26b442" title="whether to move polar axis to a bit larger theta theta value where singularity is displaced to...">SINGSMALL</a>;</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d2/dbf/metric_8h.html#ac565810c37e91f851ac3bda28ec35e39">ISSPCMCOORDNATIVE</a>(<a class="code" href="../../da/d3e/definit_8h.html#ab343edb2f60f3de2d654dcf1c58e06a2" title="#else define MAXBND 3 endif">MCOORD</a>) &amp;&amp; <a class="code" href="../../da/d3e/definit_8h.html#a47eb3650d14f676236387261e5d37427">COORDSINGFIX</a>){</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;    <span class="comment">// avoid polar axis if SPC.  Also used for CTSTAG approach so can evolve B2</span></div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;<span class="preprocessor">#if(1)</span></div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;<span class="preprocessor"></span>    <span class="comment">// So use X[2] only -- closer to using j itself that we don&#39;t have available.</span></div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aae79dca9f851fb40349156f6bca1f8ca">X2DN</a>]==<a class="code" href="../../da/d3e/definit_8h.html#ae81381343e0c525e13866d873d9deb52">POLARAXIS</a> &amp;&amp; fabs(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8ccbf4850176503992b0295081d5f4bc">TH</a>]-X[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8ccbf4850176503992b0295081d5f4bc">TH</a>])&lt;<a class="code" href="../../da/d3e/definit_8h.html#ab279035c1cbedbf8f4aa5a04bb26b442" title="whether to move polar axis to a bit larger theta theta value where singularity is displaced to...">SINGSMALL</a>) V[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8ccbf4850176503992b0295081d5f4bc">TH</a>]=<a class="code" href="../../da/d3e/definit_8h.html#ab279035c1cbedbf8f4aa5a04bb26b442" title="whether to move polar axis to a bit larger theta theta value where singularity is displaced to...">SINGSMALL</a>;</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;    <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> endx2=<a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8ccbf4850176503992b0295081d5f4bc">TH</a>]+<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8ccbf4850176503992b0295081d5f4bc">TH</a>]*<a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8ccbf4850176503992b0295081d5f4bc">TH</a>];</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aa9363649053ac2e906715b3259a14954">X2UP</a>]==<a class="code" href="../../da/d3e/definit_8h.html#ae81381343e0c525e13866d873d9deb52">POLARAXIS</a> &amp;&amp; fabs(endx2-X[TH])&lt;<a class="code" href="../../da/d3e/definit_8h.html#ab279035c1cbedbf8f4aa5a04bb26b442" title="whether to move polar axis to a bit larger theta theta value where singularity is displaced to...">SINGSMALL</a>) V[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8ccbf4850176503992b0295081d5f4bc">TH</a>]=M_PI-<a class="code" href="../../da/d3e/definit_8h.html#ab279035c1cbedbf8f4aa5a04bb26b442" title="whether to move polar axis to a bit larger theta theta value where singularity is displaced to...">SINGSMALL</a>;</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#if(0)</span></div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;<span class="preprocessor"></span>    <span class="comment">// OK, but worry about large radii where \theta is small towards axis</span></div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aae79dca9f851fb40349156f6bca1f8ca">X2DN</a>]==<a class="code" href="../../da/d3e/definit_8h.html#ae81381343e0c525e13866d873d9deb52">POLARAXIS</a> &amp;&amp; fabs(V[TH]) &lt; SINGSMALL) V[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8ccbf4850176503992b0295081d5f4bc">TH</a>]+=<a class="code" href="../../da/d3e/definit_8h.html#ab279035c1cbedbf8f4aa5a04bb26b442" title="whether to move polar axis to a bit larger theta theta value where singularity is displaced to...">SINGSMALL</a>;</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aa9363649053ac2e906715b3259a14954">X2UP</a>]==<a class="code" href="../../da/d3e/definit_8h.html#ae81381343e0c525e13866d873d9deb52">POLARAXIS</a> &amp;&amp; fabs(M_PI-V[TH]) &lt; SINGSMALL)  V[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8ccbf4850176503992b0295081d5f4bc">TH</a>]-=<a class="code" href="../../da/d3e/definit_8h.html#ab279035c1cbedbf8f4aa5a04bb26b442" title="whether to move polar axis to a bit larger theta theta value where singularity is displaced to...">SINGSMALL</a>;</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#if(0)</span></div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;<span class="preprocessor"></span>    <span class="comment">// WRONG!</span></div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aae79dca9f851fb40349156f6bca1f8ca">X2DN</a>]==<a class="code" href="../../da/d3e/definit_8h.html#ae81381343e0c525e13866d873d9deb52">POLARAXIS</a> &amp;&amp; fabs(V[TH]) &lt; SINGSMALL){</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;      <span class="keywordflow">if</span>(V[TH]&gt;=0) V[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8ccbf4850176503992b0295081d5f4bc">TH</a>]=<a class="code" href="../../da/d3e/definit_8h.html#ab279035c1cbedbf8f4aa5a04bb26b442" title="whether to move polar axis to a bit larger theta theta value where singularity is displaced to...">SINGSMALL</a>;</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;      <span class="keywordflow">if</span>(V[TH]&lt;0) V[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8ccbf4850176503992b0295081d5f4bc">TH</a>]=-<a class="code" href="../../da/d3e/definit_8h.html#ab279035c1cbedbf8f4aa5a04bb26b442" title="whether to move polar axis to a bit larger theta theta value where singularity is displaced to...">SINGSMALL</a>;</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;    }</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aa9363649053ac2e906715b3259a14954">X2UP</a>]==<a class="code" href="../../da/d3e/definit_8h.html#ae81381343e0c525e13866d873d9deb52">POLARAXIS</a> &amp;&amp; fabs(M_PI-V[TH]) &lt; SINGSMALL){</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;      <span class="keywordflow">if</span>(V[TH]&gt;=M_PI) V[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8ccbf4850176503992b0295081d5f4bc">TH</a>]=M_PI+<a class="code" href="../../da/d3e/definit_8h.html#ab279035c1cbedbf8f4aa5a04bb26b442" title="whether to move polar axis to a bit larger theta theta value where singularity is displaced to...">SINGSMALL</a>;</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;      <span class="keywordflow">if</span>(V[TH]&lt;M_PI) V[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8ccbf4850176503992b0295081d5f4bc">TH</a>]=M_PI-<a class="code" href="../../da/d3e/definit_8h.html#ab279035c1cbedbf8f4aa5a04bb26b442" title="whether to move polar axis to a bit larger theta theta value where singularity is displaced to...">SINGSMALL</a>;</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;    }</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;  }</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;}</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;<span class="keywordtype">void</span> vofx_sjetcoords( <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *<a class="code" href="../../dc/dd2/newcodediff_8txt.html#a933233ff9879962bcc2ff987c6920f90">X</a>, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *<a class="code" href="../../dc/dd2/newcodediff_8txt.html#af84f2c3bf153920b7c8d186132d39bc7">V</a> )</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;{</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;  <span class="comment">//for SJETCOORDS</span></div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> theexp;</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#aeb2e04dce7e492b341f52ddd5b134f8b">Ftrgen</a>( <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> x, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> xa, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> xb, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> ya, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> yb );</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#aa1a68b393c2ada1f3abf179be623a83c">limlin</a>( <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> x, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> x0, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> y0 );</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a59056786b13f7f91e4eddd7679b4c4e1">minlin</a>( <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> x, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> x0, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> y0 );</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a1f2270dea241e5cc21135803a397b7db">mins</a>( <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> f1, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> f2, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> df );</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a88f9330b4045c924440d283f835c23c3">maxs</a>( <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> f1, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> f2, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> df );</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#afd1c9815a323d900fe37c33c5290efa8" title="theta(x2) special">thetaofx2</a>(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> x2, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> ror0nu);</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>  fac, faker, ror0nu;</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> fakerdisk, fakerjet;</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> rbeforedisk, rinsidedisk, rinsidediskmax, rafterdisk;</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;    </div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;<span class="preprocessor">#define DOIMPROVEJETCOORDS 1</span></div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#if(DOIMPROVEJETCOORDS)</span></div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;<span class="preprocessor"></span>  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> ror0nudisk, ror0nujet, thetadisk, thetajet;</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;  V[0] = X[0];</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;  theexp = <a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>*X[1];</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;  <span class="keywordflow">if</span>( X[1] &gt; <a class="code" href="../../d9/de9/coord_8c.html#a7c7295d071bc7960f6b2fe9b8ab730ac">x1br</a> ) {</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;    theexp += <a class="code" href="../../d9/de9/coord_8c.html#a9b4b0ea2888bdfb7e987f43be8dee6db">cpow2</a> * pow(X[1]-<a class="code" href="../../d9/de9/coord_8c.html#a7c7295d071bc7960f6b2fe9b8ab730ac">x1br</a>,<a class="code" href="../../d9/de9/coord_8c.html#a119eed5c7b218e4a9547a2e0c1a8d4fe">npow2</a>);</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;  }</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;  V[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>+exp(theexp);</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;<span class="preprocessor">#if(0) //JON&#39;s method</span></div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;<span class="preprocessor"></span>  myhslope=2.0-<a class="code" href="../../d9/de9/coord_8c.html#ab0e0c0acf7cc9040907c895921b3fed7">Qjet</a>*pow(V[1]/<a class="code" href="../../d9/de9/coord_8c.html#a941700197dd24e782cbb0add66a42dbd">r1jet</a>,-<a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>*(0.5+1.0/M_PI*atan(V[1]/<a class="code" href="../../d9/de9/coord_8c.html#a785b0a4bf2ba821005a429e176f8e130">r0grid</a>-<a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>/<a class="code" href="../../d9/de9/coord_8c.html#a785b0a4bf2ba821005a429e176f8e130">r0grid</a>)));</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;  <span class="keywordflow">if</span>(X[2]&lt;0.5){</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;    V[2] = M_PI * X[2] + ((1. - myhslope) / 2.) * mysin(2. * M_PI * X[2]);</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;  }</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;    V[2] = M_PI - (M_PI * (1.0-X[2])) + ((1. - myhslope) / 2.) * (-mysin(2. * M_PI * (1.0-X[2])));</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;  }</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;<span class="preprocessor">#elif(1) //SASHA&#39;s</span></div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;<span class="preprocessor"></span>  fac = <a class="code" href="../../d9/de9/coord_8c.html#aeb2e04dce7e492b341f52ddd5b134f8b">Ftrgen</a>( fabs(X[2]), <a class="code" href="../../d9/de9/coord_8c.html#a8365b4ccf09b73479da0374726417db8">fracdisk</a>, 1-<a class="code" href="../../d9/de9/coord_8c.html#a8d5416128840a1ac3f7c18af1619e553">fracjet</a>, 0, 1 );</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;  <span class="comment">//faker = fac*V[1] + (1 - fac)*limlin(V[1],r0disk,0.5*r0disk,r0disk)*minlin(V[1],rdiskend,0.5*rdiskend,r0disk)/r0disk - rsjet*Rin;</span></div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;    </div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;  rbeforedisk = <a class="code" href="../../d9/de9/coord_8c.html#a1f2270dea241e5cc21135803a397b7db">mins</a>( V[1], <a class="code" href="../../d9/de9/coord_8c.html#af36620e0e23c6f08616e2be183b09958">r0disk</a>, 0.5*<a class="code" href="../../d9/de9/coord_8c.html#af36620e0e23c6f08616e2be183b09958">r0disk</a> );</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;<span class="preprocessor">#if(USESJETLOGHOVERR)</span></div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;<span class="preprocessor"></span>  <span class="comment">//rinsidedisk = 1 for r &lt; torusrmax_loc and increases logarithmically while r &lt;= rdiskend, after which it  </span></div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;  <span class="comment">//levels off to the value = rinsidediskmax</span></div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;  rinsidedisk = pow( 1. + 0.5*log10(<a class="code" href="../../d9/de9/coord_8c.html#a1f2270dea241e5cc21135803a397b7db">mins</a>(<a class="code" href="../../d9/de9/coord_8c.html#a88f9330b4045c924440d283f835c23c3">maxs</a>(1,V[1]/<a class="code" href="../../d9/de9/coord_8c.html#ae069412a47af2715a20ebd2cb47513e9">torusrmax_loc</a>,0.5),<a class="code" href="../../d9/de9/coord_8c.html#a40bbfe3eb99d3c1da07a520db92a243e">rdiskend</a>/<a class="code" href="../../d9/de9/coord_8c.html#ae069412a47af2715a20ebd2cb47513e9">torusrmax_loc</a>,0.5*<a class="code" href="../../d9/de9/coord_8c.html#a40bbfe3eb99d3c1da07a520db92a243e">rdiskend</a>/<a class="code" href="../../d9/de9/coord_8c.html#ae069412a47af2715a20ebd2cb47513e9">torusrmax_loc</a>)), 2./<a class="code" href="../../d9/de9/coord_8c.html#a771a5cedc0bb12d13ea9cb76eff5cd42">jetnu</a> );</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;  rinsidediskmax = pow( 1. + 0.5*log10(<a class="code" href="../../d9/de9/coord_8c.html#a40bbfe3eb99d3c1da07a520db92a243e">rdiskend</a>/<a class="code" href="../../d9/de9/coord_8c.html#ae069412a47af2715a20ebd2cb47513e9">torusrmax_loc</a>), 2./<a class="code" href="../../d9/de9/coord_8c.html#a771a5cedc0bb12d13ea9cb76eff5cd42">jetnu</a>);</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;<span class="preprocessor"></span>  rinsidedisk = 1.;</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;  rinsidediskmax = 1.;</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;<span class="preprocessor"></span>  rafterdisk = <a class="code" href="../../d9/de9/coord_8c.html#a88f9330b4045c924440d283f835c23c3">maxs</a>( 1, 1 + (V[1]-<a class="code" href="../../d9/de9/coord_8c.html#a40bbfe3eb99d3c1da07a520db92a243e">rdiskend</a>)*<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>/(<a class="code" href="../../d9/de9/coord_8c.html#a46d4c41abf34a76cec7353209c94905c">rjetend</a>*<a class="code" href="../../d9/de9/coord_8c.html#af36620e0e23c6f08616e2be183b09958">r0disk</a>*rinsidediskmax), 0.5*<a class="code" href="../../d9/de9/coord_8c.html#a40bbfe3eb99d3c1da07a520db92a243e">rdiskend</a>*<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>/(<a class="code" href="../../d9/de9/coord_8c.html#a46d4c41abf34a76cec7353209c94905c">rjetend</a>*<a class="code" href="../../d9/de9/coord_8c.html#af36620e0e23c6f08616e2be183b09958">r0disk</a>*rinsidediskmax) );</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;    </div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;  fakerdisk = rbeforedisk * rinsidedisk * rafterdisk;</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;    </div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;  fakerjet = <a class="code" href="../../d9/de9/coord_8c.html#a1f2270dea241e5cc21135803a397b7db">mins</a>( V[1], <a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>, 0.5*<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a> ) * <a class="code" href="../../d9/de9/coord_8c.html#a88f9330b4045c924440d283f835c23c3">maxs</a>( 1, V[1]/<a class="code" href="../../d9/de9/coord_8c.html#a46d4c41abf34a76cec7353209c94905c">rjetend</a>, 0.5 );</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;    </div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;<span class="preprocessor">#if( DOIMPROVEJETCOORDS )</span></div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;<span class="preprocessor"></span>  ror0nudisk = pow( (fakerdisk - <a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>*<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>)/<a class="code" href="../../d9/de9/coord_8c.html#a785b0a4bf2ba821005a429e176f8e130">r0grid</a>, <a class="code" href="../../d9/de9/coord_8c.html#a771a5cedc0bb12d13ea9cb76eff5cd42">jetnu</a>/2 );</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;  ror0nujet = pow( (fakerjet - <a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>*<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>)/<a class="code" href="../../d9/de9/coord_8c.html#a785b0a4bf2ba821005a429e176f8e130">r0grid</a>, <a class="code" href="../../d9/de9/coord_8c.html#a771a5cedc0bb12d13ea9cb76eff5cd42">jetnu</a>/2 );</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;  thetadisk = <a class="code" href="../../d9/de9/coord_8c.html#afd1c9815a323d900fe37c33c5290efa8" title="theta(x2) special">thetaofx2</a>( X[2], ror0nudisk );</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;  thetajet = <a class="code" href="../../d9/de9/coord_8c.html#afd1c9815a323d900fe37c33c5290efa8" title="theta(x2) special">thetaofx2</a>( X[2], ror0nujet );</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;  V[2] = fac*thetajet + (1 - fac)*thetadisk; </div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;<span class="preprocessor"></span>  faker = fac*fakerjet + (1 - fac)*fakerdisk - <a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>*<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>;</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;  ror0nu = pow( faker/<a class="code" href="../../d9/de9/coord_8c.html#a785b0a4bf2ba821005a429e176f8e130">r0grid</a>, <a class="code" href="../../d9/de9/coord_8c.html#a771a5cedc0bb12d13ea9cb76eff5cd42">jetnu</a>/2 );</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;  V[2] = <a class="code" href="../../d9/de9/coord_8c.html#afd1c9815a323d900fe37c33c5290efa8" title="theta(x2) special">thetaofx2</a>( X[2], ror0nu );</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;<span class="preprocessor"></span>  </div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;  </div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;  </div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;<span class="preprocessor"></span>  <span class="comment">//if((1+X[2])/2.&lt;0.5){</span></div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;  <span class="comment">//  V[2] = M_PI * (1+X[2])/2. + ((1. - hslope) / 2.) * mysin(2. * M_PI * (1+X[2])/2.);</span></div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;  <span class="comment">//}</span></div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;  <span class="comment">//else{</span></div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;  <span class="comment">//  //      V[2] = 0.5*M_PI + M_PI * fabs(X[2]-0.5) + ((1. - hslope) / 2.) * (-mysin(2. * M_PI * (1.0-X[2])));</span></div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;  <span class="comment">//  V[2] = M_PI - (M_PI * (1.0-(1+X[2])/2.)) + ((1. - hslope) / 2.) * (-mysin(2. * M_PI * (1.0-(1+X[2])/2.)));</span></div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;  <span class="comment">//}</span></div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;  V[2] = <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#afb951b3cb9bee66be6b0fa2f337308be">M_PI_2l</a> * (1.0+ X[2]); </div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;  <span class="comment">// default is uniform \phi grid</span></div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;  V[3]=2.0*M_PI*X[3];</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;}</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;</div>
<div class="line"><a name="l02215"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#afd1c9815a323d900fe37c33c5290efa8"> 2215</a></span>&#160;<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#afd1c9815a323d900fe37c33c5290efa8" title="theta(x2) special">thetaofx2</a>(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> x2, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> ror0nu)</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;{</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> theta;</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;  <span class="keywordflow">if</span>( x2 &lt; -0.5 ) {</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;    theta = 0       + atan( tan((x2+1)*<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#afb951b3cb9bee66be6b0fa2f337308be">M_PI_2l</a>)/ror0nu );</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;  }</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>( x2 &gt;  0.5 ) {</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;    theta = M_PI    + atan( tan((x2-1)*<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#afb951b3cb9bee66be6b0fa2f337308be">M_PI_2l</a>)/ror0nu );</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;  }</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;    theta = <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#afb951b3cb9bee66be6b0fa2f337308be">M_PI_2l</a> + atan( tan(x2*<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#afb951b3cb9bee66be6b0fa2f337308be">M_PI_2l</a>)*ror0nu );</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;  }</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;  <span class="keywordflow">return</span>(theta);</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;}  </div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;</div>
<div class="line"><a name="l02239"></a><span class="lineno"><a class="code" href="../../d6/d85/coord_8funcdeclare_8h.html#a64a4372100fc55abf546f02c8b779595"> 2239</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d9/de9/coord_8c.html#a64a4372100fc55abf546f02c8b779595" title="Jacobian for dx uniform per dx nonuniform (dx/dr / dx/dr&#39;) i.e.">dxdxprim</a>(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *X, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *V, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*<a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>)[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>])</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;{</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d9/de9/coord_8c.html#a56c4b5c03b74a33a7d809daecfa6925e" title="numerical derivative of V w.r.t. X">dxdxp_numerical</a>(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *X, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*<a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>)[NDIM]);</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;  <span class="keywordtype">void</span> dxdxp_analytic(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *X, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *V, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*<a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>)[NDIM]);</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a>&lt;<a class="code" href="../../d7/d56/coord_8h.html#a1ea3626ed3bedbecd776e0002fe36684" title="lower have analytic dxdxp">ANALYTICSWITCH</a>){ <span class="comment">// then have analytic dxdxp</span></div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;    dxdxp_analytic(X,V,<a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>);</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;  }</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a56c4b5c03b74a33a7d809daecfa6925e" title="numerical derivative of V w.r.t. X">dxdxp_numerical</a>(X,<a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>);</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;  }</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d2/dbf/metric_8h.html#a720c791e54d46bbf744b0e3ed7050947">ISSPCMCOORD</a>(<a class="code" href="../../da/d3e/definit_8h.html#ab343edb2f60f3de2d654dcf1c58e06a2" title="#else define MAXBND 3 endif">MCOORD</a>)){</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;    <span class="comment">// below is because \int_0^\theta sin\theta d\theta d\phi is approximated as locally instead of finite volume</span></div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[2]==1 &amp;&amp; <a class="code" href="../../da/d3e/definit_8h.html#aeac98cd8d4bc6e01e17ff4b1aeb10999" title="whether to make gdet finite volume-like when reverting to 1D spherical polar coordinates">FIXGDETSPC_WHEN_1DRADIAL</a>){</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;      <a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>[2][2] = 2.0/<a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[2]; <span class="comment">// so that d\theta = 2</span></div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;    }</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;<span class="preprocessor">#if(1)</span></div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;<span class="preprocessor"></span>    <span class="comment">// dxdxp[2][1] changes sign across axis if consistently decollimate/collimate grid.  Yet, this will cause gv311 [primecoords] to be asymmetric for any given theta,phi when theta goes negative or beyond \pi.</span></div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;    <span class="comment">// To have correct symmetries in true SPC (not just extended \theta meanginless domain) must change sign and use FLIPU3AXIS 0 , FLIPB3AXIS 0 , FLIPU2AXIS 0 , and FLIPB2AXIS 0 .</span></div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;    <span class="comment">// This is the only way (e.g.) uu1 will be properly symmetric at respective theta,\phi positions when including ghost zones.  EMF needs v1=uu1/u0, so symmetry requires this to be correct.</span></div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;    <span class="comment">// This forces symmetry on primitives across pole, but may be bad for interpolation unless flip sign when doing interpolation itself.</span></div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;    <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> endx2=<a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8ccbf4850176503992b0295081d5f4bc">TH</a>]+<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8ccbf4850176503992b0295081d5f4bc">TH</a>]*<a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8ccbf4850176503992b0295081d5f4bc">TH</a>];</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;    <span class="keywordflow">if</span>(X[2]&lt;<a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] || X[2]&gt;endx2){</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;      <a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>[2][0]*=-1.0;</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;      <a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>[2][1]*=-1.0;</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;      <a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>[2][3]*=-1.0;</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;    }</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;  }</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;}</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;<span class="keywordtype">void</span> dxdxp_analytic(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *X, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *V, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*<a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>)[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>])</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;{</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>,k;</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;  <span class="keyword">extern</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> mycos(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> th);</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;  <span class="keyword">extern</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> mysin(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> th);</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> myhslope1,myhslope2,myhslope;</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> dmyhslopedr,dmyhslopedx1;</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> myx2;</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> flip1,flip2;</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> th0,th2,switch0,switch2;</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> r,dtheta2dx1,dtheta2dx2,dtheta0dx2,dtheta0dx1,dswitch0dr,dswitch2dr;</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> X0;</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;  <span class="comment">// for defcoord=JET5COORDS</span></div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> ii,logform,radialarctan,thetaarctan; <span class="comment">// temp vars</span></div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;  <span class="comment">// default identity transformation</span></div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(j,k) <a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>[j][k]=0.0;</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(j) <a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>[j][j]=1.0;</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;  if (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#abbc29b306372314c9c2c6cb50fadbe6f">USERCOORD</a>) {</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;    <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="../../d8/d60/init_8c.html#a5268358342648e771402684c7e1d95b0">dxdxp_analytic_user</a>(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *X, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *V, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*<a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>)[NDIM]);</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;    <a class="code" href="../../d8/d60/init_8c.html#a5268358342648e771402684c7e1d95b0">dxdxp_analytic_user</a>(X,V,<a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>);</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;  }</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a99c6ba3b86430e6eb5a179c57fd58070">LOGRSINTH</a>) {</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;    <a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>[1][1] = V[1]-<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>;</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;    <span class="keywordflow">if</span>(X[2]&lt;0.5){</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;      <a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>[2][2] = M_PI + (1. - <a class="code" href="../../d8/d5b/defs_8general_8h.html#a93f06eb0b7c274f722a7e09d4861a941">hslope</a>) * M_PI * mycos(2. * M_PI * X[2]);</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;    }</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;      <a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>[2][2] = M_PI + (1. - <a class="code" href="../../d8/d5b/defs_8general_8h.html#a93f06eb0b7c274f722a7e09d4861a941">hslope</a>) * M_PI * mycos(2. * M_PI * (1.0-X[2]) );</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;    }</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;    <a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>[3][3] = 2.0*M_PI;</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;  }</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a174565dd3f50428c4c4d1e4a23019414">REBECCAGRID</a>) {</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;    <a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>[1][1] = V[1]-<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>;</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;    <a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>[2][2]=M_PI/2.*( (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a93f06eb0b7c274f722a7e09d4861a941">hslope</a> * X[2])/0.5 + (7. * (1-<a class="code" href="../../d8/d5b/defs_8general_8h.html#a93f06eb0b7c274f722a7e09d4861a941">hslope</a>))/(pow(0.5, 7.)) *pow(X[2]-0.5, 6.)) ;</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;    <span class="comment">// if(X[2]&lt;0.5){</span></div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;    <span class="comment">//  dxdxp[2][2] = M_PI + (1. - hslope) * M_PI * mycos(2. * M_PI * X[2]);</span></div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;    <span class="comment">// }</span></div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;    <span class="comment">// else{</span></div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;    <span class="comment">//  dxdxp[2][2] = M_PI + (1. - hslope) * M_PI * mycos(2. * M_PI * (1.0-X[2]) );</span></div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;    <span class="comment">//  }</span></div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;    <a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>[3][3] = 0.5*M_PI;</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;  }</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a3ebede6f897039b55ee0d8f75b359640">COMPLEX0TH</a>) {</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;    <a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>[1][1] = (V[1]-<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>) * log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a> / <a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>);</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;    <a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>[2][2] = (-49. * <a class="code" href="../../d8/d5b/defs_8general_8h.html#a93f06eb0b7c274f722a7e09d4861a941">hslope</a> + 60. * M_PI) / 12. +</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;      ((247. * <a class="code" href="../../d8/d5b/defs_8general_8h.html#a93f06eb0b7c274f722a7e09d4861a941">hslope</a> - 240. * M_PI) * X[2]) / 6. +</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;      (3. * (-83. * <a class="code" href="../../d8/d5b/defs_8general_8h.html#a93f06eb0b7c274f722a7e09d4861a941">hslope</a> + 80. * M_PI) * pow(X[2], 2)) / 2. -</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;      (20. * (-25. * <a class="code" href="../../d8/d5b/defs_8general_8h.html#a93f06eb0b7c274f722a7e09d4861a941">hslope</a> + 24. * M_PI) * pow(X[2], 3)) / 3. +</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;      (10. * (-25. * <a class="code" href="../../d8/d5b/defs_8general_8h.html#a93f06eb0b7c274f722a7e09d4861a941">hslope</a> + 24. * M_PI) * pow(X[2], 4)) / 3.;</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;    <a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>[3][3] = 2.0*M_PI;</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#aeb733e0ec20094a219e120e3e9b22a0f">UNIRSINTH</a> || <a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a8e2797c3dc060d13c29fd562d98d3bf8">UNIRSINTH2</a>){</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;    <a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>[2][2] = (<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[2]==1) ? (2.0) : (M_PI + (1. - <a class="code" href="../../d8/d5b/defs_8general_8h.html#a93f06eb0b7c274f722a7e09d4861a941">hslope</a>) * M_PI * cos(2. * M_PI * X[2]));</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;    <a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>[3][3] = 2.0*M_PI;</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;  }</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#aa2630728190374841bd88da517faffb9">EQMIRROR</a>) {</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;    <a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>[1][1] = V[1]-<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>;</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;    <a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>[2][2] = M_PI + (1. - <a class="code" href="../../d8/d5b/defs_8general_8h.html#a93f06eb0b7c274f722a7e09d4861a941">hslope</a>) * M_PI * cos(2. * M_PI * X[2]);</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;    <a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>[3][3] = 2.0*M_PI;</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;  } </div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a3ba253bfcb09b67c4f83cf604be1b4c4">COMPLEX1TH</a>) {</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;    <a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>[1][1] = V[1]-<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>;</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;    <a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>[2][2] = (210.*M_PI*<a class="code" href="../../d9/de9/coord_8c.html#a7cc367c90dd3a8d7608984c311cb6c9b">Ri</a>*pow(1. - 2.*X[2],2.)*pow(-1. + X[2],2.)*</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;                   pow(X[2],2.) + <a class="code" href="../../d9/de9/coord_8c.html#ae91faa22bb51b3003d7a140fd4a100ff">der0</a>*</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;                   (-32.*pow(-1. + X[2],2.)*pow(X[2],2.)*</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;                    (3. + 14.*(-1. + X[2])*X[2]) - </div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;                    <a class="code" href="../../d9/de9/coord_8c.html#a7cc367c90dd3a8d7608984c311cb6c9b">Ri</a>*pow(1. - 2.*X[2],2.)*</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;                    (-1. + 2.*(-1. + X[2])*X[2]*(2. + 49.*(-1. + X[2])*X[2]))))/<a class="code" href="../../d9/de9/coord_8c.html#a7cc367c90dd3a8d7608984c311cb6c9b">Ri</a>;</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;    <a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>[3][3] = 2.0*M_PI;</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;  } </div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a363db929c2617ac441c63fe7d9847d30">COMPLEX2TH</a>) {</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;    <a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>[1][1] = V[1]-<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>;</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;    <span class="comment">// now assign values</span></div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;    <span class="keywordflow">if</span>(X[2]&lt;0.5){ myx2=X[2]; flip1=0.0; flip2=1.0;}</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;    <span class="keywordflow">else</span>{ myx2=1.0-X[2]; flip1=M_PI; flip2=-1.0;}</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;    <span class="keywordflow">if</span>(myx2&lt;=<a class="code" href="../../d9/de9/coord_8c.html#a460b151eb6590a200f27826e97dcc248">x2trans</a>){</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;      <a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>[2][2] = (3.0*<a class="code" href="../../d9/de9/coord_8c.html#aab5d055c59dc5dbfcaef566bb6061530">d2</a>*pow(myx2,2.0)+2.0*<a class="code" href="../../d9/de9/coord_8c.html#a30a1474e2de8b7ed353e5948debd63b0">c2</a>*pow(myx2,1.0)+<a class="code" href="../../d9/de9/coord_8c.html#adf33edafc727f90e926d3f491f6bb4cb">m2</a>);</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;    }</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;      <a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>[2][2] = (<a class="code" href="../../d9/de9/coord_8c.html#a1965dec5c9e70ada83cd756e549d5891">m3</a>);</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;    }</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;    <a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>[3][3] = 2.0*M_PI;</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;  }</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a78f877fef6d5148b40adc3d6d93c7ad0">LOGRUNITH</a>) {</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;    <a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>[1][1] = V[1]-<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>;</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;    <a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>[2][2] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#aff141f9f52f9bbd4911d4dabcf2aaec9">Rout_array</a>[2] - <a class="code" href="../../d8/d5b/defs_8general_8h.html#a20ba1a68d196e97fa84463164fd907d1">Rin_array</a>[2];</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;    <a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>[3][3] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#aff141f9f52f9bbd4911d4dabcf2aaec9">Rout_array</a>[3] - Rin_array[3];</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;  }</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a6903d2cdfaf212b975c4fffa9402fa9c">JET1COORDS</a>) {</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;    <span class="comment">//dxdxp[1][1] = npow*(V[1]-R0)*pow(log(V[1]-R0),(npow-1.0)/npow);</span></div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;    <a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>[1][1] = <a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>*(V[1]-<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>)*pow(X[1],<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>-1.0);</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;    myhslope1 = <a class="code" href="../../d9/de9/coord_8c.html#af5c3d95ab07a3b7fdff23bdde44b6ed0">h0</a>+<a class="code" href="../../d9/de9/coord_8c.html#a73f761b44de3c4480a924658b0f3efc5">dmyhslope1dr</a>*(V[1]-<a class="code" href="../../d9/de9/coord_8c.html#ac07d708f65a53c2ed0761d11bc97d46d">rh0</a>);</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;    myhslope2 = <a class="code" href="../../d9/de9/coord_8c.html#af5c3d95ab07a3b7fdff23bdde44b6ed0">h0</a>+<a class="code" href="../../d9/de9/coord_8c.html#a084470ae408b08254f2247015f988570">dmyhslope2dx1</a>*(X[1]-<a class="code" href="../../d9/de9/coord_8c.html#a05bf2e602378f34e74ff69f35b1991d9">x1in</a>);</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;    dmyhslopedx1=0.5*(<a class="code" href="../../d9/de9/coord_8c.html#a73f761b44de3c4480a924658b0f3efc5">dmyhslope1dr</a>*<a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>[1][1]+<a class="code" href="../../d9/de9/coord_8c.html#a084470ae408b08254f2247015f988570">dmyhslope2dx1</a>);</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;    myhslope=0.5*(myhslope1+myhslope2);</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;    <a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>[2][2] = M_PI + (1. - myhslope) * M_PI * cos(2. * M_PI * X[2]);</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;    <span class="comment">// d\theta/dx1 not 0</span></div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;    <span class="comment">// d\theta/dx1 = (d\theta/dr)*(dr/dx1)  (is this generally true or just when V[1](x1)?</span></div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;    <a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>[2][1] = -0.5*dmyhslopedx1* sin(2. * M_PI * X[2]);</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;    <a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>[3][3] = 2.0*M_PI;</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;  }</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a3e3cceb2f708009494c25912bd2470f4">JET2COORDS</a>) {</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;    <span class="comment">// drdx1</span></div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;    <a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>[1][1] = <a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>*(V[1]-<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>)*pow(X[1],<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>-1.0);</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;    myhslope=2.0-pow(V[1]/<a class="code" href="../../d9/de9/coord_8c.html#a941700197dd24e782cbb0add66a42dbd">r1jet</a>,<a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>*(-1.0+exp(1.0)/exp(V[1]+<a class="code" href="../../d9/de9/coord_8c.html#a508726935adb05ad4291b8c77897f8c5">rpjet</a>)));</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;    dmyhslopedr=-((pow(exp(1.0),-V[1] - <a class="code" href="../../d9/de9/coord_8c.html#a508726935adb05ad4291b8c77897f8c5">rpjet</a>)*myhslope*<a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>*(-exp(1.0) + pow(exp(1.0),V[1] + <a class="code" href="../../d9/de9/coord_8c.html#a508726935adb05ad4291b8c77897f8c5">rpjet</a>) + exp(1.0)*V[1]*log(V[1]/<a class="code" href="../../d9/de9/coord_8c.html#a941700197dd24e782cbb0add66a42dbd">r1jet</a>)))/V[1]);</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;    dmyhslopedx1=dmyhslopedr*<a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>[1][1];</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;    dxdxp[2][2] = M_PI + (1. - myhslope) * M_PI * cos(2. * M_PI * X[2]);</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;    dxdxp[2][1] = -0.5*dmyhslopedx1* sin(2. * M_PI * X[2]);</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;    dxdxp[3][3] = 2.0*M_PI;</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;  }</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a77ba1498bcda3890f2a37bb5979a1eec">JET3COORDS</a>){</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;    <span class="comment">// drdx1</span></div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;    <a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>[1][1] = <a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>*(V[1]-<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>)*pow(X[1],<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>-1.0);</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;    myhslope=2.0-<a class="code" href="../../d9/de9/coord_8c.html#ab0e0c0acf7cc9040907c895921b3fed7">Qjet</a>*pow(V[1]/<a class="code" href="../../d9/de9/coord_8c.html#a941700197dd24e782cbb0add66a42dbd">r1jet</a>,-<a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>*(0.5+1.0/M_PI*atan(V[1]/<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>-<a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>/<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>)));</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;    dmyhslopedr=-((<a class="code" href="../../d9/de9/coord_8c.html#ab0e0c0acf7cc9040907c895921b3fed7">Qjet</a>*(-((<a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>*(0.5 + atan(V[1]/<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a> - <a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>/<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>)/M_PI))/V[1]) - (<a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>*<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>*log(V[1]/<a class="code" href="../../d9/de9/coord_8c.html#a941700197dd24e782cbb0add66a42dbd">r1jet</a>))/(M_PI*(pow(<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>,2) + pow(V[1] - <a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>,2)))))/pow(V[1]/<a class="code" href="../../d9/de9/coord_8c.html#a941700197dd24e782cbb0add66a42dbd">r1jet</a>,<a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>*(0.5 + atan(V[1]/<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a> - <a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>/<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>)/M_PI)));</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;    dmyhslopedx1=dmyhslopedr*<a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>[1][1];</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;    <span class="keywordflow">if</span>(X[2]&lt;0.5){</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;      dxdxp[2][2] = M_PI + (1. - myhslope) * M_PI * mycos(2. * M_PI * X[2]);</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;      dxdxp[2][1] = -0.5*dmyhslopedx1* mysin(2. * M_PI * X[2]);</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;    }</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;      dxdxp[2][2] = M_PI + (1. - myhslope) * M_PI * mycos(2. * M_PI * (1.0-X[2]));</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;      dxdxp[2][1] = -0.5*dmyhslopedx1* (-mysin(2. * M_PI * (1.0-X[2])));</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;    }</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;    dxdxp[3][3] = 2.0*M_PI;</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;    </div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;  }</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a725469cd082a278dfc44a41e28eca44c">JET6COORDS</a>){</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Should not be computing JET6COORDS analytically\n&quot;</span>);</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;    myexit(34698346);</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;    dxdxp[3][3] = 2.0*M_PI;    </div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;  }</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a0e5331f6ac2b706aa4e76de967dcb1d7">JET6COORDSTHIN</a>){</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Should not be computing JET6COORDSTHIN analytically\n&quot;</span>);</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;    myexit(34698346);</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;    dxdxp[3][3] = 2.0*M_PI;    </div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;  }</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a22ccf670681b96ce61d974db87204a10">BPTHIN1</a>){</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Should not be computing BPTHIN1 analytically\n&quot;</span>);</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;    myexit(34698346);</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;    dxdxp[3][3] = 2.0*M_PI;    </div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;  }</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a5e2e2deaaa6af505fdb3c7b3c2f817a5">JET5COORDS</a>){</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Should not be computing JET5COORDS analytically\n&quot;</span>);</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;    myexit(34698346);</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;    dxdxp[3][3] = 2.0*M_PI;</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;  }</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a87e4392d8d6cdc988ced46d7e7a2dfe2">PULSARCOORDS</a>){</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;    <span class="comment">// drdx1</span></div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;    dxdxp[1][1] = <a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>*(V[1]-<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>)*pow(X[1],<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>-1.0);</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;    myhslope=(0.5+1.0/M_PI*atan((V[1]-<a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>)/<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>))*(<a class="code" href="../../d9/de9/coord_8c.html#a808590103058909774d170d48f1e5723">houter</a>-<a class="code" href="../../d9/de9/coord_8c.html#adb91c14ac2eecf2e4745073392a7af6f">hinner</a>)+<a class="code" href="../../d9/de9/coord_8c.html#adb91c14ac2eecf2e4745073392a7af6f">hinner</a>;</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;    dmyhslopedr=(<a class="code" href="../../d9/de9/coord_8c.html#a808590103058909774d170d48f1e5723">houter</a>-<a class="code" href="../../d9/de9/coord_8c.html#adb91c14ac2eecf2e4745073392a7af6f">hinner</a>)*<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>/(M_PI*(<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>*<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>+(V[1]-<a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>)*(V[1]-<a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>)));</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;    dmyhslopedx1=dmyhslopedr*dxdxp[1][1];</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;    dxdxp[2][2] = M_PI + (1. - myhslope) * M_PI * cos(2. * M_PI * X[2]);</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;    dxdxp[2][1] = -0.5*dmyhslopedx1* sin(2. * M_PI * X[2]);</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;    dxdxp[3][3] = 2.0*M_PI;</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;    </div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;  }</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a47b225226fbd0e3e573ec095071ecc10">UNIFORMCOORDS</a>) {</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;    <span class="comment">//uniform grid for Cartesian coordinates</span></div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;    dxdxp[1][1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#aff141f9f52f9bbd4911d4dabcf2aaec9">Rout_array</a>[1] - <a class="code" href="../../d8/d5b/defs_8general_8h.html#a20ba1a68d196e97fa84463164fd907d1">Rin_array</a>[1];</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;    dxdxp[2][2] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#aff141f9f52f9bbd4911d4dabcf2aaec9">Rout_array</a>[2] - Rin_array[2];</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;    dxdxp[3][3] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#aff141f9f52f9bbd4911d4dabcf2aaec9">Rout_array</a>[3] - Rin_array[3];</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;    <span class="comment">//    dualfprintf(fail_file,&quot;COORD.c: dxdxp[1][1]=%26.20g\n&quot;,dxdxp[1][1]);</span></div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;  }</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#adf7ec499e840df38ef6d0230239d75e2">BILOGCYLCOORDS</a>) {</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;    myexit(6666);</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;  }</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a>==<a class="code" href="../../d7/d56/coord_8h.html#aa0a3d1a614796ea8787d7360932b121c">RAMESHCOORDS</a>|| <a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a320ee4f267db4b195bbde94bec748a29">RAMESHCOORDS_HALFDISK</a>){</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;    <span class="comment">//    V[1] = R0+exp(pow(X[1],npow)) ;</span></div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;    <span class="comment">//    myhslope=pow( (*r-rsjet)/r0jet , njet);</span></div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;    <span class="comment">//    V[2] = 0.5*M_PI*(1.0 + atan(myhslope*(X[2]-0.5))/atan(myhslope*0.5));</span></div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;    <span class="comment">// drdx1</span></div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;    dxdxp[1][1] = <a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>*(V[1]-<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>)*pow(X[1],<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>-1.0);</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;    <span class="comment">// drdx2 = 0</span></div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;    myhslope=pow( (V[1]-<a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>)/<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a> , <a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>);</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;    dmyhslopedr=(<a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>/<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>)*pow( (V[1]-<a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>)/<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a> , <a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>-1.0);</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;    <span class="keywordflow">if</span>(!finite(dmyhslopedr)){</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;      dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Problem with dmyhslopedr=%g\n&quot;</span>,dmyhslopedr);</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;      dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;njet=%g r=%g rsjet=%g r0jet=%g\n&quot;</span>,<a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>,V[1],<a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>,<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>);</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;      myexit(1);</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;    }</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;    <span class="comment">// dhslope/dx1</span></div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;    dmyhslopedx1=dmyhslopedr*dxdxp[1][1];</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;    <span class="keywordflow">if</span>(X[2]&gt;1.0) myx2=2.0-X[2];</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(X[2]&lt;0.0) myx2=-X[2];</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;    <span class="keywordflow">else</span> myx2=X[2];</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;    <span class="comment">// d\theta/dx2</span></div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;    <span class="comment">// (2*Pi*h(r))/(ArcTan(h(r)/2.)*(4 + Power(1 - 2*x2,2)*Power(h(r),2)))</span></div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;    </div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;    dxdxp[2][2] = (2.0*M_PI*myhslope)/(atan(myhslope*0.5)*(4.0 + pow(1.0 - 2.0*myx2,2.0)*pow(myhslope,2.0)));</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;    <span class="comment">// d\theta/dr</span></div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;    <span class="comment">//(Pi*((-4*ArcTan((-0.5 + x2)*h(r)))/(4 + Power(h(r),2)) + </span></div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;    <span class="comment">//       (4*(-1 + 2*x2)*ArcTan(h(r)/2.))/</span></div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;    <span class="comment">//        (4 + Power(1 - 2*x2,2)*Power(h(r),2)))*</span></div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;    <span class="comment">//     Derivative(1)(h)(r))/(4.*Power(ArcTan(h(r)/2.),2))</span></div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;    <span class="comment">// d\theta/dx1  = d\theta/dr dr/dx1</span></div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;    dxdxp[2][1] =     (M_PI*dmyhslopedx1*(</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;                                          (-4.0*atan((-0.5 + myx2)*myhslope))/(4. + pow(myhslope,2.)) + </div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;                                          (4.*(-1. + 2.*myx2)*atan(myhslope/2.))/(4. + pow(1. - 2.*myx2,2.)*pow(myhslope,2.))</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;                                          )</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;                       )/(4.*pow(atan(myhslope/2.),2.));</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;    <span class="keywordflow">if</span>(X[2]&gt;1.0) dxdxp[2][1]*=-1.0;</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;    <span class="keywordflow">if</span>(X[2]&lt;0.0) dxdxp[2][1]*=-1.0;</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;    </div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;    dxdxp[3][3] = 2.0*M_PI;</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;  }</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a6e1b80715afcab76e5ec0827d7113aa9">JET4COORDS</a>){</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;    r=V[1];</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;    <span class="comment">// determine theta2</span></div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;    myhslope=<a class="code" href="../../d9/de9/coord_8c.html#af5c3d95ab07a3b7fdff23bdde44b6ed0">h0</a> + pow( (V[1]-<a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>)/<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a> , <a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>);</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;    <span class="keywordflow">if</span>(X[2]&gt;1.0) myx2=2.0-X[2];</div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(X[2]&lt;0.0) myx2=-X[2];</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;    <span class="keywordflow">else</span> myx2=X[2];</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;    th2 = 0.5*M_PI*(1.0 + atan(myhslope*(myx2-0.5))/atan(myhslope*0.5));</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;    <span class="keywordflow">if</span>(X[2]&gt;1.0) th2=2.0*M_PI-th2;</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(X[2]&lt;0.0) th2=-th2;</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;    <span class="comment">// determine theta0</span></div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;    myhslope=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a93f06eb0b7c274f722a7e09d4861a941">hslope</a>;</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;    <span class="keywordflow">if</span>(X[2]&lt;0.5){</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;      th0 = M_PI * X[2] + ((1. - myhslope) / 2.) * mysin(2. * M_PI * X[2]);</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;    }</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;      th0 = M_PI - (M_PI * (1.0-X[2])) + ((1. - myhslope) / 2.) * (-mysin(2. * M_PI * (1.0-X[2])));</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;    }</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;    <span class="comment">// determine switches (only function of radius and not x2 or theta)</span></div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;    switch0 = 0.5+1.0/M_PI*atan((V[1]-<a class="code" href="../../d9/de9/coord_8c.html#aaa4f963acaccd1ea63a18f800fd576a1">rs</a>)/<a class="code" href="../../d9/de9/coord_8c.html#a54081391e09395407d47aec84f3d97c9">r0</a>); <span class="comment">// switch in .nb file</span></div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;    switch2 = 0.5-1.0/M_PI*atan((V[1]-<a class="code" href="../../d9/de9/coord_8c.html#aaa4f963acaccd1ea63a18f800fd576a1">rs</a>)/<a class="code" href="../../d9/de9/coord_8c.html#a54081391e09395407d47aec84f3d97c9">r0</a>); <span class="comment">// switchi in .nb file</span></div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;    <span class="comment">// now get derivatives</span></div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;    <span class="comment">// drdx1</span></div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;    dxdxp[1][1] = <a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>*(V[1]-<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa4c9c8191d78fb683d1b8947f026afcb">R0</a>)*pow(X[1],<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>-1.0);</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;    <span class="comment">// drdx2 = 0</span></div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;    <span class="comment">// for theta0</span></div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;<span class="comment"></span>    <span class="keywordflow">if</span>(X[2]&lt;0.5){</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;      dtheta0dx2 = M_PI + (1. - <a class="code" href="../../d8/d5b/defs_8general_8h.html#a93f06eb0b7c274f722a7e09d4861a941">hslope</a>) * M_PI * mycos(2. * M_PI * X[2]);</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;    }</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;      dtheta0dx2 = M_PI + (1. - <a class="code" href="../../d8/d5b/defs_8general_8h.html#a93f06eb0b7c274f722a7e09d4861a941">hslope</a>) * M_PI * mycos(2. * M_PI * (1.0-X[2]) );</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;    }</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;    dtheta0dx1 = 0.0; <span class="comment">// for this simple grid with fixed hslope</span></div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;</div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;    <span class="comment">// for theta2</span></div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;<span class="comment"></span>    myhslope=pow( (V[1]-<a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>)/<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a> , <a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>);</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;    dmyhslopedr=(<a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>/<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>)*pow( (V[1]-<a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>)/<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a> , <a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>-1.0);</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;</div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;    <span class="keywordflow">if</span>(!finite(dmyhslopedr)){</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;      dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Problem with dmyhslopedr=%g\n&quot;</span>,dmyhslopedr);</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;      dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;njet=%g r=%g rsjet=%g r0jet=%g\n&quot;</span>,<a class="code" href="../../d9/de9/coord_8c.html#ad46327f26bb8f749581284ff7608147e">njet</a>,V[1],<a class="code" href="../../d9/de9/coord_8c.html#a4c6a090a443770b7df4c72188de904e3">rsjet</a>,<a class="code" href="../../d9/de9/coord_8c.html#a5f9d0973e31ee4e0bf05cb7a8eb62c94">r0jet</a>);</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;      myexit(1);</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;    }</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;    <span class="comment">// dhslope/dx1</span></div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;    dmyhslopedx1=dmyhslopedr*dxdxp[1][1];</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;    <span class="keywordflow">if</span>(X[2]&gt;1.0) myx2=2.0-X[2];</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(X[2]&lt;0.0) myx2=-X[2];</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;    <span class="keywordflow">else</span> myx2=X[2];</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;    </div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;    dtheta2dx2 = (2.0*M_PI*myhslope)/(atan(myhslope*0.5)*(4.0 + pow(1.0 - 2.0*myx2,2.0)*pow(myhslope,2.0)));</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;    <span class="comment">// d\theta/dx1  = d\theta/dr dr/dx1</span></div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;    dtheta2dx1 =     (M_PI*dmyhslopedx1*(</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;                                         (-4.0*atan((-0.5 + myx2)*myhslope))/(4. + pow(myhslope,2.)) + </div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;                                         (4.*(-1. + 2.*myx2)*atan(myhslope/2.))/(4. + pow(1. - 2.*myx2,2.)*pow(myhslope,2.))</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;                                         )</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;                      )/(4.*pow(atan(myhslope/2.),2.));</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;    <span class="keywordflow">if</span>(X[2]&gt;1.0) dtheta2dx1*=-1.0;</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;    <span class="keywordflow">if</span>(X[2]&lt;0.0) dtheta2dx1*=-1.0;</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;</div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;    <span class="comment">// switches</span></div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;    dswitch0dr=1.0/(M_PI*<a class="code" href="../../d9/de9/coord_8c.html#a54081391e09395407d47aec84f3d97c9">r0</a>*(1.0 + (r - <a class="code" href="../../d9/de9/coord_8c.html#aaa4f963acaccd1ea63a18f800fd576a1">rs</a>)*(r - <a class="code" href="../../d9/de9/coord_8c.html#aaa4f963acaccd1ea63a18f800fd576a1">rs</a>)/(<a class="code" href="../../d9/de9/coord_8c.html#a54081391e09395407d47aec84f3d97c9">r0</a>*<a class="code" href="../../d9/de9/coord_8c.html#a54081391e09395407d47aec84f3d97c9">r0</a>)));</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;    dswitch2dr=-dswitch0dr;</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;    <span class="comment">// actual final derivatives</span></div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;    dxdxp[2][2] = dtheta0dx2*switch2 + dtheta2dx2*switch0;</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;    <span class="comment">// assumes r doesn&#39;t depend on x2</span></div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;    dxdxp[2][1] =  dtheta0dx1*switch2 + th0*dswitch2dr*dxdxp[1][1] + dtheta2dx1*switch0+th2*dswitch0dr*dxdxp[1][1] ;</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;    dxdxp[3][3] = 2.0*M_PI;</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;  }</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Shouldn&#39;t reach end of dxdxp: defcoord=%d\n&quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a>);</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;    myexit(1);</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;  }</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;}</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;</div>
<div class="line"><a name="l02677"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#ad37f5f446337c1fcac32f31b87781e84"> 2677</a></span>&#160;<span class="preprocessor">#define GAMMIEDERIVATIVE 0</span></div>
<div class="line"><a name="l02678"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a20dfa29e71098bf20819f73582f1447b"> 2678</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define NUMREC 1  // at present this is too slow since dxdxp is called many times.  Could setup permenant memory space, but kinda stupid</span></div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;<span class="comment">// Note that can&#39;t use NUMREC for connection if using numerical dxdxp.  Any other form of connection and then any dxdxp can be used.</span></div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;<span class="comment">// For example, if both connection and dxdxp are computed using GAMMIEDERIVATIVE, seems to work fine as a decent numerical approximation</span></div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;<span class="comment">// Also, one can use NUMREC for dxdxp if using analytic connection or GAMMIEDERIVATIVE connection.</span></div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;<span class="comment">//#define DXDERTYPE DIFFNUMREC </span></div>
<div class="line"><a name="l02687"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#af6808e18cfd4e559a5914ab141195a9a"> 2687</a></span>&#160;<span class="preprocessor">#define DXDERTYPE DIFFGAMMIE</span></div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;<span class="comment">// see conn_func() for notes</span></div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;<span class="preprocessor">#if((REALTYPE==DOUBLETYPE)||(REALTYPE==FLOATTYPE))</span></div>
<div class="line"><a name="l02691"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a90a276dc2deb4fde76a71a58fe6d3769"> 2691</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define DXDELTA (MY1EM5)</span></div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;<span class="preprocessor"></span><span class="comment">//#define DXDELTA (dx[1])</span></div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;<span class="preprocessor">#elif(REALTYPE==LONGDOUBLETYPE)</span></div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define DXDELTA (MY1EM6)</span></div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;<span class="comment">// finite volume form (nice if one could express so exact cancellation occurs in equations, but some errors vanish so that cannot identify how close to continuous solution one is since here one solves particular discrete equations)</span></div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;<span class="comment">//#define GENDXDELTA(k) (k==TT ? DXDELTA*Diffx[k] : 0.5*dx[k])</span></div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;<span class="comment">// finite difference form (nice to have &quot;analytical&quot; solution for dxdxp (and connection) so errors result that can be used to indicate how close to continuous solution one is)</span></div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;<span class="comment">// Diffx[k] enters because DXDELTA is relative to total scale involved, which is Diffx[k], not always 1.0</span></div>
<div class="line"><a name="l02702"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a60161df5107f23bd4bedc668170993e2"> 2702</a></span>&#160;<span class="preprocessor">#define GENDXDELTA(k) (DXDELTA*Diffx[k])</span></div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02705"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a56c4b5c03b74a33a7d809daecfa6925e"> 2705</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d9/de9/coord_8c.html#a56c4b5c03b74a33a7d809daecfa6925e" title="numerical derivative of V w.r.t. X">dxdxp_numerical</a>(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *X, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*dxdxp)[NDIM])</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;{</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>,k,l;</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> Xh[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>], Xl[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> Vh[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>],Vl[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> blcoordsimple(<span class="keyword">struct</span> <a class="code" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae" title="typedef struct of_geom struct of_compgeom; force to be the same">of_geom</a> *ptrgeom, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>*X, <span class="keywordtype">int</span> <a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#ad21ff679aac3fe28202c6d592eafd3e6">i</a>, <span class="keywordtype">int</span> j);</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;  <span class="keyword">extern</span> <span class="keywordtype">int</span> dfridr(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*func)(<span class="keyword">struct</span> <a class="code" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae" title="typedef struct of_geom struct of_compgeom; force to be the same">of_geom</a> *,<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>*,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>), <span class="keyword">struct</span> <a class="code" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae" title="typedef struct of_geom struct of_compgeom; force to be the same">of_geom</a> *ptrgeom, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *X,<span class="keywordtype">int</span> ii, <span class="keywordtype">int</span> jj, <span class="keywordtype">int</span> kk, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *ans);</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;  <span class="keywordtype">void</span> donothing(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *temp);</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> temp;</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> dxmachine[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;  <span class="keyword">struct </span><a class="code" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae" title="typedef struct of_geom struct of_compgeom; force to be the same">of_geom</a> geom;</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;  <span class="keyword">struct </span><a class="code" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae" title="typedef struct of_geom struct of_compgeom; force to be the same">of_geom</a> *ptrgeom;</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;  <span class="keywordtype">int</span> failreturn;</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;  <span class="comment">// setup dummy grid location since dxdxp doesn&#39;t need to know if on grid since don&#39;t store dxdxp (needed for dfridr())</span></div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;  ptrgeom=&amp;geom;</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;  ptrgeom-&gt;i=0;</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;  ptrgeom-&gt;j=0;</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;  ptrgeom-&gt;k=0;</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;  ptrgeom-&gt;p=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8bf292e53bd4a7ca0cf7b164daf1997a">NOWHERE</a>;</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;  <span class="comment">//  for(k=0;k&lt;NDIM;k++) for(j=0;j&lt;NDIM;j++){</span></div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(j,k){</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;    failreturn=0;</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../d9/de9/coord_8c.html#af6808e18cfd4e559a5914ab141195a9a">DXDERTYPE</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ae62e36a8fb8b0fa34b625c8934ce4947">DIFFNUMREC</a>){</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;      failreturn=dfridr(blcoordsimple,ptrgeom,X,0,j,k,&amp;(dxdxp[j][k]));</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;    }</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../d9/de9/coord_8c.html#af6808e18cfd4e559a5914ab141195a9a">DXDERTYPE</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0bebb8a47e2a0ea6225daa0a8ea7bf1c">DIFFGAMMIE</a> || failreturn==1){</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;      <span class="comment">// I setup X and V relationship for time and phi to be correct now</span></div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;      <span class="comment">// Was usind dxdxp[3][3]=1 when V[3]=2.0*M_PI*X[3], so that was incorrect -- a bug</span></div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;      <span class="comment">/*</span></div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;<span class="comment">        if((j==TT)||(k==TT)){</span></div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;<span class="comment">        // assume no transformation of time coordinate and no mixing of t-coordinate with other coordinates (except what already in metric)</span></div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;<span class="comment">        if(j!=k) dxdxp[j][k]=0.0;</span></div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;<span class="comment">        else dxdxp[j][k]=1.0;</span></div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;<span class="comment">        }</span></div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;<span class="comment">        else if((j==PH)||(k==PH)){</span></div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;<span class="comment">        // assume no transformation of phi coordinate and no mixing of phi coordinate with other coordinates (at least no additional to existing metric)</span></div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;<span class="comment">        if(j!=k) dxdxp[j][k]=0.0;</span></div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;<span class="comment">        else dxdxp[j][k]=1.0;</span></div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;<span class="comment">        }</span></div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;<span class="comment">        else{</span></div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;<span class="comment">      */</span></div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;      <span class="keywordflow">for</span>(l=0;l&lt;<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>;l++){</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;        Xl[l]=Xh[l]=X[l]; <span class="comment">// location of derivative</span></div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;        temp = X[l]-<a class="code" href="../../d9/de9/coord_8c.html#a60161df5107f23bd4bedc668170993e2">GENDXDELTA</a>(l);</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;        donothing(&amp;temp);</div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;        X[l] = temp+<a class="code" href="../../d9/de9/coord_8c.html#a60161df5107f23bd4bedc668170993e2">GENDXDELTA</a>(l);</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;        temp = X[l]+<a class="code" href="../../d9/de9/coord_8c.html#a60161df5107f23bd4bedc668170993e2">GENDXDELTA</a>(l);</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;        donothing(&amp;temp);</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;        dxmachine[l] = temp-X[l];</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;      }</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;   </div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;      <span class="comment">//   Xh[k]+=dxmachine[k]; // shift up</span></div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;      <span class="comment">//   Xl[k]-=dxmachine[k]; // shift down</span></div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;      Xh[k]+=<a class="code" href="../../d9/de9/coord_8c.html#a60161df5107f23bd4bedc668170993e2">GENDXDELTA</a>(k); <span class="comment">// shift up</span></div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;      Xl[k]-=<a class="code" href="../../d9/de9/coord_8c.html#a60161df5107f23bd4bedc668170993e2">GENDXDELTA</a>(k); <span class="comment">// shift down</span></div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;      <span class="comment">//   dualfprintf(fail_file,&quot;k=%d del=%g\n&quot;,k,GENDXDELTA(k));</span></div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;      <span class="comment">// below 2 lines redundant because gets both coordinates, but ok</span></div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a65ad4ca9656d141cc995fd35ed31dc40" title="Returns boyer-lindquist coordinte of point.">bl_coord</a>(Xh, Vh);</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;      <a class="code" href="../../d9/de9/coord_8c.html#a65ad4ca9656d141cc995fd35ed31dc40" title="Returns boyer-lindquist coordinte of point.">bl_coord</a>(Xl, Vl);</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;      dxdxp[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>][k] = (Vh[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>] - Vl[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>]) / (Xh[k] - Xl[k]);</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;      <span class="comment">// GODMARK: unless N is a power of 2, X causes V to not be machine representable</span></div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;      <span class="comment">// GODMARK: Also, not only Xh-Xl, but each Xl and Xh must be machine representable</span></div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;      <span class="comment">// So even for a uniform grid dxdxp can vary near machine level</span></div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;      <span class="comment">//      dualfprintf(fail_file,&quot;Vh=%26.20g Vl=%26.20g Xh=%2.15g Xl=%26.20g DX=%26.20g\n&quot;,Vh[j],Vl[j],Xh[k],Xl[k],GENDXDELTA(k));</span></div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;      <span class="comment">//      dualfprintf(fail_file,&quot;(Vh[%d] - Vl[%d])=%26.20g (Xh[%d] - Xl[%d])=%26.20g\n&quot;,j,j,(Vh[j] - Vl[j]),k,k,(Xh[k] - Xl[k]));</span></div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;      <span class="comment">// }</span></div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;      <span class="keywordflow">if</span>(j==k &amp;&amp; fabs(dxdxp[j][k])&lt;<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a8913cb5d64cfec23ae1a3052930ec468">NUMEPSILON</a>){</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;        dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;dxdxp[%d][%d]=%g is too small.  Ensure SINGSMALL=%g &lt; %g\n&quot;</span>,j,k,dxdxp[j][k],<a class="code" href="../../da/d3e/definit_8h.html#ab279035c1cbedbf8f4aa5a04bb26b442" title="whether to move polar axis to a bit larger theta theta value where singularity is displaced to...">SINGSMALL</a>,(Xh[k] - Xl[k]));</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;      }</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;    }</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;  }</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;}</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;<span class="keywordtype">void</span> donothing(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *temp)</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;{</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;  *temp=*temp;</div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;}</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> blcoordsimple(<span class="keyword">struct</span> <a class="code" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae" title="typedef struct of_geom struct of_compgeom; force to be the same">of_geom</a> *ptrgeom, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>*X, <span class="keywordtype">int</span> <a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#ad21ff679aac3fe28202c6d592eafd3e6">i</a>, <span class="keywordtype">int</span> j) <span class="comment">// i not used</span></div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;{</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> V[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;  </div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;  <span class="comment">// &quot;dummy linear relationship&quot; is right way and now setup when calling bl_coord()</span></div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;  <span class="comment">//  if((j==TT)||(j==PH)) return(X[j]); // dummy linear relationship</span></div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;  <span class="comment">//  else{</span></div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;  <a class="code" href="../../d9/de9/coord_8c.html#a65ad4ca9656d141cc995fd35ed31dc40" title="Returns boyer-lindquist coordinte of point.">bl_coord</a>(X, V);</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;  <span class="keywordflow">return</span>(V[j]);</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;  <span class="comment">//  }</span></div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;}</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;</div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;<span class="comment">// </span></div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;<span class="comment">// Below set X uniform grid -- usually doesn&#39;t change.</span></div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;<span class="comment">// Can usually force startx[1]=startx[2]=0. and dx[1]=1./N1 dx[2]=1./N2</span></div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;<span class="comment">// </span></div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;</div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;<span class="keywordtype">void</span> set_points()</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;{</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;  <span class="keywordtype">int</span> jj;</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;  <span class="comment">//for SJETCOORDS</span></div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> x1max0, x1max,dxmax;</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;  <span class="keywordtype">int</span> iter;</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> RELACC = <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a8913cb5d64cfec23ae1a3052930ec468">NUMEPSILON</a>*100.0;</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> ITERMAX = 100;</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;  <span class="comment">// below 2 things not used since we set X[0] directly using t</span></div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[0]=0;</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[0]=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a56db625f31229c5e8b208ff27d464931">dt</a>;</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == USERCOORD) {</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;    <span class="keyword">extern</span> <span class="keywordtype">void</span> set_points_user(<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;    set_points_user();</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;  }</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a99c6ba3b86430e6eb5a179c57fd58070">LOGRSINTH</a>) {</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] = log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>-R0);</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] = 0.;</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] = 0.;</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[1] = log((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-R0)/(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>-R0)) / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[2] = 1. / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[2];</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[3] = 1.0/<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[3];</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;  }</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a174565dd3f50428c4c4d1e4a23019414">REBECCAGRID</a>) {</div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] = log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>-R0);</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] = 0.;</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] = 0.;</div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[1] = log((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-R0)/(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>-R0)) / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[2] = 1. / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[2];</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[3] = 1.0/<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[3];</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;  }</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a3ebede6f897039b55ee0d8f75b359640">COMPLEX0TH</a>) {</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] = 0.;</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] = 0.;</div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] = 0.;</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[1] = 1. / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[2] = 1. / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[2];</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[3] = 1.0/<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[3];</div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#aeb733e0ec20094a219e120e3e9b22a0f">UNIRSINTH</a>) {</div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>;</div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;    <span class="comment">//    startx[2] = 0.324;</span></div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] = 0.0;</div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] = 0.;</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[1] = (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>) / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;    <span class="comment">//    dx[2] = (1.0-2*.324) / totalsize[2];</span></div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[2] = 1.0 / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[2];</div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[3] = 1.0/<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[3];</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a8e2797c3dc060d13c29fd562d98d3bf8">UNIRSINTH2</a>) {</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] = 0.0;</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] = 0.0;</div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] = 0.0;</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[1] = 1.0 / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[2] = 1.0 / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[2];</div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[3] = 1.0 / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[3];</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;  }</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#aa2630728190374841bd88da517faffb9">EQMIRROR</a>) {</div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] = log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>-R0);</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] = 0.;</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] = 0.;</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[1] = log((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-R0)/(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>-R0)) / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[2] = 0.5 / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[2];</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[3] = 1.0/<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[3];</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;  }</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a3ba253bfcb09b67c4f83cf604be1b4c4">COMPLEX1TH</a>) {</div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] = log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>-R0);</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] = 0.;</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] = 0.;</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[1] = log((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-R0)/(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>-R0)) / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[2] = 1. / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[2];</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[3] = 1.0/<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[3];</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;  }</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a363db929c2617ac441c63fe7d9847d30">COMPLEX2TH</a>) {</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] = log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>-R0);</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] = 0.;</div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] = 0.;</div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[1] = log((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-R0)/(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>-R0)) / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[2] = 1. / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[2];</div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[3] = 1.0/<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[3];</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;  }</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a78f877fef6d5148b40adc3d6d93c7ad0">LOGRUNITH</a>) {</div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] = log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>-R0);</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] = 0.;</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] = 0.;</div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[1] = log((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-R0)/(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>-R0)) / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[2] = 1. / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[2];</div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[3] = 1.0/<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[3];</div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;  } </div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a6903d2cdfaf212b975c4fffa9402fa9c">JET1COORDS</a>) {</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] = pow(log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>-R0),1.0/<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>);</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] = 0.;</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] = 0.;</div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[1] = (pow(log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-R0),1.0/<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>)-pow(log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>-R0),1.0/<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>)) / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[2] = 1. / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[2];</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[3] = 1.0/<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[3];</div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;  } </div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a3e3cceb2f708009494c25912bd2470f4">JET2COORDS</a>) {</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] = pow(log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>-R0),1.0/<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>);</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] = 0.;</div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] = 0.;</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[1] = (pow(log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-R0),1.0/<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>)-pow(log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>-R0),1.0/<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>)) / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[2] = 1. / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[2];</div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[3] = 1.0/<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[3];</div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;  } </div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a77ba1498bcda3890f2a37bb5979a1eec">JET3COORDS</a>) {</div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] = pow(log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>-R0),1.0/<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>);</div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] = 0.;</div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] = 0.;</div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[1] = (pow(log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-R0),1.0/<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>)-pow(log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>-R0),1.0/<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>)) / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[2] = 1. / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[2];</div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[3] = 1.0/<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[3];</div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;  } </div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a8cb1a8a42445cede081c2ddfaa98113f">SJETCOORDS</a>) {</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] = log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>-R0)/<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>;</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a> &lt; <a class="code" href="../../d9/de9/coord_8c.html#a1196767f0fc1292fff1d9ee90d7fd3ff">rbr</a> ) {</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;      x1max = log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-R0)/<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>;</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;    }</div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;      x1max0 = 1;</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;      x1max = 2;</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;</div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;      <span class="comment">//find the root via iterations</span></div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;      <span class="keywordflow">for</span>( iter = 0; iter &lt; ITERMAX; iter++ ) {</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;        <span class="keywordflow">if</span>( fabs((x1max - x1max0)/x1max) &lt; RELACC ) {</div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;        }</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;        x1max0 = x1max;</div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;        dxmax= (pow( (log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-R0) - <a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>*x1max0)/<a class="code" href="../../d9/de9/coord_8c.html#a9b4b0ea2888bdfb7e987f43be8dee6db">cpow2</a>, 1./<a class="code" href="../../d9/de9/coord_8c.html#a119eed5c7b218e4a9547a2e0c1a8d4fe">npow2</a> ) + <a class="code" href="../../d9/de9/coord_8c.html#a7c7295d071bc7960f6b2fe9b8ab730ac">x1br</a>) - x1max0;</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;</div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;        <span class="comment">// need a slight damping factor</span></div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;        <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> dampingfactor=0.5;</div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;        x1max = x1max0 + dampingfactor*dxmax;</div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;      }</div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;</div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;      <span class="keywordflow">if</span>( iter == ITERMAX ) {</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;        trifprintf( <span class="stringliteral">&quot;Error: iteration procedure for finding x1max has not converged: x1max = %g, dx1max/x1max = %g, iter = %d\n&quot;</span>,</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;                    x1max, (x1max-x1max0)/x1max, iter );</div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;        exit(1);</div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;      }</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;        trifprintf( <span class="stringliteral">&quot;x1max = %g (dx1max/x1max = %g, itno = %d)\n&quot;</span>, x1max, (x1max-x1max0)/x1max, iter );</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;      }</div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;    }</div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;</div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] = -1.;</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] = 0.;</div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[1] = ( x1max - <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] ) /<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[2] = 2. / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[2];</div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[3] = <a class="code" href="../../d9/de9/coord_8c.html#a9c9f5f22dd4a5da08e734903ab82659f">fracphi</a>/<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[3];</div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;  } </div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a725469cd082a278dfc44a41e28eca44c">JET6COORDS</a>) { <span class="comment">// same as JET3COORDS since radial grid same</span></div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] = pow(log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>-R0),1.0/<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>);</div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] = 0.;</div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] = 0.;</div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[1] = (pow(log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-R0),1.0/<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>)-pow(log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>-R0),1.0/<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>)) / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[2] = 1. / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[2];</div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[3] = 1.0/<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[3];</div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;</div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;<span class="preprocessor">#if(1)</span></div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;<span class="preprocessor"></span>    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] = log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>-R0)/<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>;</div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;</div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;    trifprintf( <span class="stringliteral">&quot;ITERATIVE dx1: Rout=%26.20g R0=%26.20g npow=%26.20g cpow2=%26.20g cpow3=%26.20g npow2=%26.20g x1br=%26.20g rbr=%26.20g\n&quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>,R0,<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>,<a class="code" href="../../d9/de9/coord_8c.html#a9b4b0ea2888bdfb7e987f43be8dee6db">cpow2</a>,<a class="code" href="../../d9/de9/coord_8c.html#a26ece82e6d552d80914dd5ae149ade6f">cpow3</a>,<a class="code" href="../../d9/de9/coord_8c.html#a119eed5c7b218e4a9547a2e0c1a8d4fe">npow2</a>,<a class="code" href="../../d9/de9/coord_8c.html#a7c7295d071bc7960f6b2fe9b8ab730ac">x1br</a>,<a class="code" href="../../d9/de9/coord_8c.html#a1196767f0fc1292fff1d9ee90d7fd3ff">rbr</a>);</div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;</div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a> &lt; <a class="code" href="../../d9/de9/coord_8c.html#a1196767f0fc1292fff1d9ee90d7fd3ff">rbr</a> ) {</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;      x1max = log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-R0)/<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>;</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;    }</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;      x1max0 = 1.1*<a class="code" href="../../d9/de9/coord_8c.html#a7c7295d071bc7960f6b2fe9b8ab730ac">x1br</a>;</div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;      x1max = 1.2*<a class="code" href="../../d9/de9/coord_8c.html#a7c7295d071bc7960f6b2fe9b8ab730ac">x1br</a>;</div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;</div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;      <span class="comment">//find the root via iterations</span></div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;      <span class="keywordflow">for</span>( iter = 0; iter &lt; ITERMAX; iter++ ) {</div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;</div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;        <span class="comment">// trifprintf( &quot;iter=%d x1max=%26.20g x2max0=%26.20g\n&quot;,iter,x1max0,x1max);</span></div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;</div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;        <span class="keywordflow">if</span>( fabs((x1max - x1max0)/x1max) &lt; RELACC ) {</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;        }</div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;        x1max0 = x1max;</div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;</div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;        <span class="keywordflow">if</span>(1){</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;          dxmax= (pow( (log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-R0) - <a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>*x1max0)/<a class="code" href="../../d9/de9/coord_8c.html#a9b4b0ea2888bdfb7e987f43be8dee6db">cpow2</a>, 1./<a class="code" href="../../d9/de9/coord_8c.html#a119eed5c7b218e4a9547a2e0c1a8d4fe">npow2</a> ) + <a class="code" href="../../d9/de9/coord_8c.html#a7c7295d071bc7960f6b2fe9b8ab730ac">x1br</a>*1.0) - x1max0;</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;        }</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;        <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;          <span class="comment">// f-f0 = (x-x0)*dfdx -&gt; if f=Rout -&gt; x = (Rout-f0)/dfdx+x0</span></div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;          </div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;          <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> dVdx1=(<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a> + <a class="code" href="../../d9/de9/coord_8c.html#a9b4b0ea2888bdfb7e987f43be8dee6db">cpow2</a>*<a class="code" href="../../d9/de9/coord_8c.html#a119eed5c7b218e4a9547a2e0c1a8d4fe">npow2</a>*<a class="code" href="../../d9/de9/coord_8c.html#a26ece82e6d552d80914dd5ae149ade6f">cpow3</a>*pow(<a class="code" href="../../d9/de9/coord_8c.html#a26ece82e6d552d80914dd5ae149ade6f">cpow3</a>*(x1max0-<a class="code" href="../../d9/de9/coord_8c.html#a7c7295d071bc7960f6b2fe9b8ab730ac">x1br</a>*1.0),<a class="code" href="../../d9/de9/coord_8c.html#a119eed5c7b218e4a9547a2e0c1a8d4fe">npow2</a>-1.0)) * exp(<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>*x1max0 + <a class="code" href="../../d9/de9/coord_8c.html#a9b4b0ea2888bdfb7e987f43be8dee6db">cpow2</a> * pow(<a class="code" href="../../d9/de9/coord_8c.html#a26ece82e6d552d80914dd5ae149ade6f">cpow3</a>*(x1max0-<a class="code" href="../../d9/de9/coord_8c.html#a7c7295d071bc7960f6b2fe9b8ab730ac">x1br</a>*1.0),<a class="code" href="../../d9/de9/coord_8c.html#a119eed5c7b218e4a9547a2e0c1a8d4fe">npow2</a>));</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;          <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> V0 = R0 + exp(<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>*x1max0 + <a class="code" href="../../d9/de9/coord_8c.html#a9b4b0ea2888bdfb7e987f43be8dee6db">cpow2</a> * pow(<a class="code" href="../../d9/de9/coord_8c.html#a26ece82e6d552d80914dd5ae149ade6f">cpow3</a>*(x1max0-<a class="code" href="../../d9/de9/coord_8c.html#a7c7295d071bc7960f6b2fe9b8ab730ac">x1br</a>*1.0),<a class="code" href="../../d9/de9/coord_8c.html#a119eed5c7b218e4a9547a2e0c1a8d4fe">npow2</a>));</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;          </div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;          dxmax=(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-V0)/dVdx1; <span class="comment">// x-x0</span></div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;          dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;dVdx1=%g V0=%g dxmax=%g x1max=%g x1max0=%g\n&quot;</span>,dVdx1,V0,dxmax,x1max,x1max0);</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;        }</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;</div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;        <span class="comment">// need a slight damping factor</span></div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;        <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> dampingfactor=0.5;</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;        x1max = x1max0 + dampingfactor*dxmax;</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;      }</div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;</div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;      <span class="keywordflow">if</span>( iter == ITERMAX ) {</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;        trifprintf( <span class="stringliteral">&quot;Error: iteration procedure for finding x1max has not converged: x1max = %g, dx1max/x1max = %g, iter = %d\n&quot;</span>,</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;                    x1max, (x1max-x1max0)/x1max, iter );</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;        exit(1);</div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;      }</div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;        trifprintf( <span class="stringliteral">&quot;x1max = %g (dx1max/x1max = %g, itno = %d)\n&quot;</span>, x1max, (x1max-x1max0)/x1max, iter );</div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;      }</div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;    }</div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;</div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[1] = ( x1max - <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] ) /<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;</div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;  } </div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a0e5331f6ac2b706aa4e76de967dcb1d7">JET6COORDSTHIN</a>) {</div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] = pow(log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>-R0),1.0/th_npow);</div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] = 0.;</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] = 0.;</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[1] = (pow(log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-R0),1.0/th_npow)-pow(log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>-R0),1.0/th_npow)) / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[2] = 1. / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[2];</div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[3] = 1.0/<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[3];</div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;</div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;<span class="preprocessor">#if(1)</span></div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;<span class="preprocessor"></span>    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] = log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>-R0)/<a class="code" href="../../d9/de9/coord_8c.html#ae5abebf1f6c7a6931bf0136d15cebc1c">th_npow</a>;</div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;</div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;    trifprintf( <span class="stringliteral">&quot;ITERATIVE dx1: Rout=%26.20g R0=%26.20g npow=%26.20g cpow2=%26.20g npow2=%26.20g x1br=%26.20g rbr=%26.20g\n&quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>,R0,th_npow,th_cpow2,th_npow2,th_x1br,th_rbr);</div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;</div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a> &lt; th_rbr ) {</div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;      x1max = log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-R0)/<a class="code" href="../../d9/de9/coord_8c.html#ae5abebf1f6c7a6931bf0136d15cebc1c">th_npow</a>;</div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;    }</div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;      x1max0 = 1;</div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;      x1max = 2;</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;</div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;      <span class="comment">//find the root via iterations</span></div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;      <span class="keywordflow">for</span>( iter = 0; iter &lt; ITERMAX; iter++ ) {</div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;</div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;        <span class="comment">// trifprintf( &quot;iter=%d x1max=%26.20g x2max0=%26.20g\n&quot;,iter,x1max0,x1max);</span></div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;</div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;        <span class="keywordflow">if</span>( fabs((x1max - x1max0)/x1max) &lt; RELACC ) {</div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;        }</div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;        x1max0 = x1max;</div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;        dxmax= (pow( (log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-R0) - th_npow*x1max0)/th_cpow2, 1./th_npow2 ) + <a class="code" href="../../d9/de9/coord_8c.html#a5c90a66307da98c5b41bfb5f3ed38c4e">th_x1br</a>) - x1max0;</div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;</div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;        <span class="comment">// need a slight damping factor</span></div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;        <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> dampingfactor=0.5;</div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;        x1max = x1max0 + dampingfactor*dxmax;</div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;</div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;      }</div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;</div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;      <span class="keywordflow">if</span>( iter == ITERMAX ) {</div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;        trifprintf( <span class="stringliteral">&quot;Error: iteration procedure for finding x1max has not converged: x1max = %g, dx1max/x1max = %g, iter = %d\n&quot;</span>,</div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;                    x1max, (x1max-x1max0)/x1max, iter );</div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;        exit(1);</div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;      }</div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;        trifprintf( <span class="stringliteral">&quot;x1max = %g (dx1max/x1max = %g, itno = %d)\n&quot;</span>, x1max, (x1max-x1max0)/x1max, iter );</div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;      }</div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;    }</div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;</div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[1] = ( x1max - <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] ) /<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;</div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;  } </div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a22ccf670681b96ce61d974db87204a10">BPTHIN1</a>) { <span class="comment">// same as JET3COORDS since radial grid same</span></div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] = pow(log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>-R0),1.0/<a class="code" href="../../d9/de9/coord_8c.html#a565a42e16bf3620bb640120f8c1a4e2a">bp_npow</a>);</div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] = 0.;</div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] = 0.;</div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[1] = (pow(log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-R0),1.0/<a class="code" href="../../d9/de9/coord_8c.html#a565a42e16bf3620bb640120f8c1a4e2a">bp_npow</a>)-pow(log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>-R0),1.0/<a class="code" href="../../d9/de9/coord_8c.html#a565a42e16bf3620bb640120f8c1a4e2a">bp_npow</a>)) / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[2] = 1. / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[2];</div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[3] = <a class="code" href="../../d9/de9/coord_8c.html#a9c9f5f22dd4a5da08e734903ab82659f">fracphi</a>/<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[3];</div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;</div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;<span class="preprocessor">#if(1)</span></div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;<span class="preprocessor"></span>    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] = log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>-R0)/<a class="code" href="../../d9/de9/coord_8c.html#a565a42e16bf3620bb640120f8c1a4e2a">bp_npow</a>;</div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;</div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;    trifprintf( <span class="stringliteral">&quot;ITERATIVE dx1: Rout=%21.15g R0=%21.15g bp_npow=%21.15g bp_cpow2=%21.15g bp_npow2=%21.15g bp_x1br=%21.15g bp_rbr=%21.15g\n&quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>,R0,<a class="code" href="../../d9/de9/coord_8c.html#a565a42e16bf3620bb640120f8c1a4e2a">bp_npow</a>,<a class="code" href="../../d9/de9/coord_8c.html#aa3c25e2dcf468d66d223576997aaa124">bp_cpow2</a>,<a class="code" href="../../d9/de9/coord_8c.html#a0cce4548534baf8c1e0f2fbdd706117c">bp_npow2</a>,<a class="code" href="../../d9/de9/coord_8c.html#a4fa1cafdb60ad24851dcf7f6a85d196c">bp_x1br</a>,<a class="code" href="../../d9/de9/coord_8c.html#a51855c9f2c2f77df27842fd0cdcb25f6">bp_rbr</a>);</div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;</div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a> &lt; <a class="code" href="../../d9/de9/coord_8c.html#a51855c9f2c2f77df27842fd0cdcb25f6">bp_rbr</a> ) {</div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;      x1max = log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-R0)/<a class="code" href="../../d9/de9/coord_8c.html#a565a42e16bf3620bb640120f8c1a4e2a">bp_npow</a>;</div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;    }</div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;      x1max0 = 1;</div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;      x1max = 2;</div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;</div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;      <span class="comment">//find the root via iterations</span></div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;      <span class="keywordflow">for</span>( iter = 0; iter &lt; ITERMAX; iter++ ) {</div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;</div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;        <span class="comment">//      trifprintf( &quot;iter=%d x1max=%21.15g x2max0=%21.15g\n&quot;,iter,x1max0,x1max);</span></div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;</div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;        <span class="keywordflow">if</span>( fabs((x1max - x1max0)/x1max) &lt; RELACC ) {</div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;        }</div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;        x1max0 = x1max;</div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;        dxmax= (pow( (log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-R0) - <a class="code" href="../../d9/de9/coord_8c.html#a565a42e16bf3620bb640120f8c1a4e2a">bp_npow</a>*x1max0)/<a class="code" href="../../d9/de9/coord_8c.html#aa3c25e2dcf468d66d223576997aaa124">bp_cpow2</a>, 1./<a class="code" href="../../d9/de9/coord_8c.html#a0cce4548534baf8c1e0f2fbdd706117c">bp_npow2</a> ) + <a class="code" href="../../d9/de9/coord_8c.html#a4fa1cafdb60ad24851dcf7f6a85d196c">bp_x1br</a>) - x1max0;</div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;</div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;        <span class="comment">// need a slight damping factor</span></div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;        <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> dampingfactor=0.5;</div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;        x1max = x1max0 + dampingfactor*dxmax;</div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;</div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;      }</div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;</div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;      <span class="keywordflow">if</span>( iter == ITERMAX ) {</div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;        trifprintf( <span class="stringliteral">&quot;Error: iteration procedure for finding x1max has not converged: x1max = %g, dx1max/x1max = %g, iter = %d\n&quot;</span>,</div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;                    x1max, (x1max-x1max0)/x1max, iter );</div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;        exit(1);</div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;      }</div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;        trifprintf( <span class="stringliteral">&quot;x1max = %g (dx1max/x1max = %g, itno = %d)\n&quot;</span>, x1max, (x1max-x1max0)/x1max, iter );</div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;      }</div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;    }</div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;</div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[1] = ( x1max - <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] ) /<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;</div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;  } </div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a5e2e2deaaa6af505fdb3c7b3c2f817a5">JET5COORDS</a>) {</div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] = 0.0;</div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] = 0.0;</div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] = 0.0;</div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[1] = 1.0 / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[2] = 1.0 / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[2];</div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[3] = 1.0 / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[3];</div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;  } </div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a87e4392d8d6cdc988ced46d7e7a2dfe2">PULSARCOORDS</a>) {</div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] = pow(log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>-R0),1.0/<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>);</div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] = 0.;</div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] = 0.;</div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[1] = (pow(log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-R0),1.0/<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>)-pow(log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>-R0),1.0/<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>)) / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[2] = 1. / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[2];</div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;</div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[3] = 1.0 / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[3];</div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;    <span class="comment">//    dx[3] = 2.0*M_PI;</span></div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;  } </div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#adf7ec499e840df38ef6d0230239d75e2">BILOGCYLCOORDS</a>) {</div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] = 0.;</div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] = -1.0;</div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] = 0.0;</div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[1] = 1.0 / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[2] = 2.0 / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[2];</div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[3] = 1.0 / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[3];</div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;  }</div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a47b225226fbd0e3e573ec095071ecc10">UNIFORMCOORDS</a>) {</div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;    <span class="comment">//uniform grid for Cartesian coordinates</span></div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] = 0.;</div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] = 0.;</div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] = 0.;</div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[1] = 1. / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[2] = 1. / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[2];</div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[3] = 1. / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[3];</div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;  }</div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#aa0a3d1a614796ea8787d7360932b121c">RAMESHCOORDS</a>) {</div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] = pow(log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>-R0),1.0/<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>);</div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] = 0.;</div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] = 0.;</div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[1] = (pow(log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-R0),1.0/<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>)-pow(log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>-R0),1.0/<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>)) / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[2] = 1. / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[2];</div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[3] = 1. / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[3];</div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;  } </div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a320ee4f267db4b195bbde94bec748a29">RAMESHCOORDS_HALFDISK</a>) {</div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] = pow(log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>-R0),1.0/<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>);</div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;</div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aae79dca9f851fb40349156f6bca1f8ca">X2DN</a>]==DISKSURFACE){</div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] = 0.5;</div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;    }</div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a516ad1adc872921939df143a56a721af">BCtype</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aa9363649053ac2e906715b3259a14954">X2UP</a>]==DISKSURFACE){</div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] = 0.0;</div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;    }</div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;</div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] = 0.;</div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[1] = (pow(log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-R0),1.0/<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>)-pow(log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>-R0),1.0/<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>)) / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[2] = 0.5 / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[2];</div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;</div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[3] = 1. / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[3];</div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;  } </div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a6e1b80715afcab76e5ec0827d7113aa9">JET4COORDS</a>) {</div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] = pow(log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>-R0),1.0/<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>);</div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] = 0.;</div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] = 0.;</div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[1] = (pow(log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-R0),1.0/<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>)-pow(log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aede4c57c0916c7d1ba3760915a650067">Rin</a>-R0),1.0/<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>)) / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[2] = 1. / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[2];</div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[3] = 1. / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[3];</div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;  } </div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a35d1eed7020c0beb59e9b6432fd68175">UNI2LOG</a>) {</div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] = 0.0;</div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] = 0.0;</div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] = 0.0;</div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[1] = 1.0 / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[2] = 1.0 / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[2];</div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[3] = 1.0 / <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[3];</div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;  }</div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Shouldn&#39;t reach end of set_points: defcoord=%d\n&quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a>);</div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;    myexit(1);</div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;  }</div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;</div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;  </div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a178a272c173e58474f2f400efde4afda">dV</a> = <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[1] * <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[2] * <a class="code" href="../../d8/d5b/defs_8general_8h.html#a99b91d8e229e5df70958f2aed7fd15bf">dx</a>[3]; <span class="comment">// computational volume </span></div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a9e6da72f4fb3e32d9bbf657ae60ec39c">dVF</a> = <a class="code" href="../../d8/d5b/defs_8general_8h.html#a178a272c173e58474f2f400efde4afda">dV</a> ; <span class="comment">// full 3d volume</span></div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;</div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;  <span class="comment">// determine endx[]</span></div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(jj) <a class="code" href="../../d8/d5b/defs_8general_8h.html#a33836a977039b0d5c25a1817425658dc">endx</a>[jj] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[jj] + <a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[jj]*dx[jj];</div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;  <span class="comment">// overwrite TT term so Diffx[TT] = DXDELTA, which is used</span></div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;  jj=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a08ca909b46b12e894320afaabce3056e" title="time period between dumps for various types of dumps NO, use &quot;DUMPTYPE&quot; names now">TT</a>; <a class="code" href="../../d8/d5b/defs_8general_8h.html#a33836a977039b0d5c25a1817425658dc">endx</a>[TT] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[TT] + <a class="code" href="../../d9/de9/coord_8c.html#a90a276dc2deb4fde76a71a58fe6d3769">DXDELTA</a>;</div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;</div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;  <span class="comment">// total endx-startx</span></div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;  <span class="comment">// fabs() used since only ever used as absolute value</span></div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(jj) <a class="code" href="../../d8/d5b/defs_8general_8h.html#a6ac48c1b0aa6fae2692a7179ffbc70e1">Diffx</a>[jj] = fabs(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a33836a977039b0d5c25a1817425658dc">endx</a>[jj] - <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[jj]);</div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;</div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;  <span class="comment">//  DLOOPA(jj) fprintf(stderr,&quot;jj=%d Diffx=%26.20g endx=%26.20g startx=%26.20g\n&quot;,jj,Diffx[jj],endx[jj],startx[jj]);</span></div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;</div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;</div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;}</div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;</div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;</div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;</div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;<span class="preprocessor">#undef DXDERTYPE</span></div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#undef DXDELTA</span></div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;</div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;</div>
<div class="line"><a name="l03255"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a2be8a5b9260fc1eec1e6bf4711038aa1"> 3255</a></span>&#160;<span class="preprocessor">#define MAXIHOR MAXBND</span></div>
<div class="line"><a name="l03256"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a70ce0b3bd2642a44a9d3db67f4e3a999"> 3256</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define FRACN1 (0.1)</span></div>
<div class="line"><a name="l03257"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a9e33bf043c177269843ecd0186920ee8"> 3257</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define ADJUSTFRACT (0.25)</span></div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;</div>
<div class="line"><a name="l03261"></a><span class="lineno"><a class="code" href="../../d6/d85/coord_8funcdeclare_8h.html#a2f39db7b2d9cb7ea17ff2813438bd32c"> 3261</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d9/de9/coord_8c.html#a2f39db7b2d9cb7ea17ff2813438bd32c" title="set i(horizon)">setihor</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;{</div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;  <span class="comment">// set to smaller of either totalsize[1]*0.1 or MAXIHOR</span></div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1]*<a class="code" href="../../d9/de9/coord_8c.html#a70ce0b3bd2642a44a9d3db67f4e3a999">FRACN1</a>&gt;<a class="code" href="../../d9/de9/coord_8c.html#a2be8a5b9260fc1eec1e6bf4711038aa1">MAXIHOR</a>) <span class="keywordflow">return</span>((<span class="keywordtype">int</span>)<a class="code" href="../../d9/de9/coord_8c.html#a2be8a5b9260fc1eec1e6bf4711038aa1">MAXIHOR</a>);</div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">return</span>((<span class="keywordtype">int</span>)((<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>)<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1]*(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>)<a class="code" href="../../d9/de9/coord_8c.html#a70ce0b3bd2642a44a9d3db67f4e3a999">FRACN1</a>));</div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;}</div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;</div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;</div>
<div class="line"><a name="l03272"></a><span class="lineno"><a class="code" href="../../d6/d85/coord_8funcdeclare_8h.html#ae0931a086386bdc85e72a8601fffd0d2"> 3272</a></span>&#160;<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#ae0931a086386bdc85e72a8601fffd0d2" title="there&#39;s probably a way to do this in general probably can root find to get this set Rin so horizon ex...">setRin</a>(<span class="keywordtype">int</span> ihor)</div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;{</div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160; </div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> ftemp;</div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> ihoradjust;</div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;</div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;</div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;  ihoradjust=((<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>)ihor)+<a class="code" href="../../d9/de9/coord_8c.html#a9e33bf043c177269843ecd0186920ee8">ADJUSTFRACT</a>; <span class="comment">// can&#39;t have grid edge exactly on horizon due to ucon_calc()</span></div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;</div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;  <span class="comment">//  fprintf(stderr,&quot;ihoradjust = %26.20g\n&quot;,ihoradjust);</span></div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;</div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == USERCOORD){</div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;    <span class="keyword">extern</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d8/d60/init_8c.html#a0177ade0d9f7c34a133aa8dd46111c05">setRin_user</a>(<span class="keywordtype">int</span> ihor, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> ihoradjust);</div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;    <span class="keywordflow">return</span>(<a class="code" href="../../d8/d60/init_8c.html#a0177ade0d9f7c34a133aa8dd46111c05">setRin_user</a>(ihor,ihoradjust));</div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;  }</div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a99c6ba3b86430e6eb5a179c57fd58070">LOGRSINTH</a>){</div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;    ftemp=ihoradjust/(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>)<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;    <span class="keywordflow">return</span>(R0+pow((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a20e81ef2343c6d8db701c6613cbcd279">Rhor</a>-R0)/pow(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-R0,ftemp),1.0/(1.0-ftemp)));</div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;  }</div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a174565dd3f50428c4c4d1e4a23019414">REBECCAGRID</a>){</div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;    ftemp=ihoradjust/(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>)<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;    <span class="keywordflow">return</span>(R0+pow((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a20e81ef2343c6d8db701c6613cbcd279">Rhor</a>-R0)/pow(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-R0,ftemp),1.0/(1.0-ftemp)));</div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;  }</div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a3ebede6f897039b55ee0d8f75b359640">COMPLEX0TH</a>){ <span class="comment">// even though form appears different in X1, same Rin results</span></div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;    ftemp=ihoradjust/(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>)<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;    <span class="keywordflow">return</span>(R0+pow((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a20e81ef2343c6d8db701c6613cbcd279">Rhor</a>-R0)/pow(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-R0,ftemp),1.0/(1.0-ftemp)));</div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;  }</div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#aeb733e0ec20094a219e120e3e9b22a0f">UNIRSINTH</a> || <a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a8e2797c3dc060d13c29fd562d98d3bf8">UNIRSINTH2</a>){ <span class="comment">// uniform</span></div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;    ftemp=ihoradjust/(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>)<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;    <span class="keywordflow">return</span>((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a20e81ef2343c6d8db701c6613cbcd279">Rhor</a>-ftemp*<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>)/(1.0-ftemp));</div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;  }</div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#aa2630728190374841bd88da517faffb9">EQMIRROR</a>){ <span class="comment">// as defcoord=0</span></div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;    ftemp=ihoradjust/(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>)<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;    <span class="keywordflow">return</span>(R0+pow((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a20e81ef2343c6d8db701c6613cbcd279">Rhor</a>-R0)/pow(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-R0,ftemp),1.0/(1.0-ftemp)));</div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;  }</div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a3ba253bfcb09b67c4f83cf604be1b4c4">COMPLEX1TH</a>){ <span class="comment">// as above</span></div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;    ftemp=ihoradjust/(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>)<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;    <span class="keywordflow">return</span>(R0+pow((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a20e81ef2343c6d8db701c6613cbcd279">Rhor</a>-R0)/pow(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-R0,ftemp),1.0/(1.0-ftemp)));</div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;  }</div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a363db929c2617ac441c63fe7d9847d30">COMPLEX2TH</a>){ <span class="comment">// as above</span></div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;    ftemp=ihoradjust/(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>)<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;    <span class="keywordflow">return</span>(R0+pow((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a20e81ef2343c6d8db701c6613cbcd279">Rhor</a>-R0)/pow(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-R0,ftemp),1.0/(1.0-ftemp)));</div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;  }</div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a78f877fef6d5148b40adc3d6d93c7ad0">LOGRUNITH</a>){ <span class="comment">// as above</span></div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;    ftemp=ihoradjust/(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>)<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;    <span class="keywordflow">return</span>(R0+pow((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a20e81ef2343c6d8db701c6613cbcd279">Rhor</a>-R0)/pow(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-R0,ftemp),1.0/(1.0-ftemp)));</div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;  }</div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a6903d2cdfaf212b975c4fffa9402fa9c">JET1COORDS</a>){</div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>==1.0){</div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;      ftemp=ihoradjust/(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>)<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;      <span class="keywordflow">return</span>(R0+pow((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a20e81ef2343c6d8db701c6613cbcd279">Rhor</a>-R0)/pow(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-R0,ftemp),1.0/(1.0-ftemp)));</div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;    }</div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;      <span class="comment">// SUPERGODMARK : need to change for npow&gt;1.0</span></div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;      <span class="keywordflow">return</span>(1.1);</div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;    }</div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;  }</div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a3e3cceb2f708009494c25912bd2470f4">JET2COORDS</a>){</div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>==1.0){</div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;      ftemp=ihoradjust/(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>)<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;      <span class="keywordflow">return</span>(R0+pow((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a20e81ef2343c6d8db701c6613cbcd279">Rhor</a>-R0)/pow(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-R0,ftemp),1.0/(1.0-ftemp)));</div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;    }</div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;      <span class="comment">// SUPERGODMARK : need to change for npow&gt;1.0</span></div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;      <span class="keywordflow">return</span>(1.1);</div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;    }</div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;  }</div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a77ba1498bcda3890f2a37bb5979a1eec">JET3COORDS</a>){</div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;    <span class="comment">// see jet3coords_checknew.nb to have chosen Rin and ihor and compute required R0</span></div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>==1.0){</div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;      ftemp=ihoradjust/(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>)<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;      <span class="keywordflow">return</span>(R0+pow((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a20e81ef2343c6d8db701c6613cbcd279">Rhor</a>-R0)/pow(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-R0,ftemp),1.0/(1.0-ftemp)));</div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;    }</div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;      dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;ihoradjust=%26.20g totalsize[1]=%d Rhor=%26.20g R0=%26.20g npow=%26.20g Rout=%26.20g\n&quot;</span>,ihoradjust,<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1],<a class="code" href="../../d8/d5b/defs_8general_8h.html#a20e81ef2343c6d8db701c6613cbcd279">Rhor</a>,R0,<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>);</div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;      <span class="keywordflow">return</span>(R0+exp( pow((<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1]*pow(log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a20e81ef2343c6d8db701c6613cbcd279">Rhor</a>-R0),1.0/<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>) - ihoradjust*pow(log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-R0),1.0/<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>))/(<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1]-ihoradjust),<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>)));</div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;    }</div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;  }</div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a8cb1a8a42445cede081c2ddfaa98113f">SJETCOORDS</a>){</div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;    dualfprintf( <a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>, <span class="stringliteral">&quot;setRin(): not implemented for SJETCOORDS\n&quot;</span> );</div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;    myexit(1);</div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;  }</div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a725469cd082a278dfc44a41e28eca44c">JET6COORDS</a>){</div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;    <span class="comment">// see jet3coords_checknew.nb (and fix_3dpolestissue.nb) to have chosen Rin and ihor and compute required R0</span></div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>==1.0){</div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;      ftemp=ihoradjust/(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>)<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;      <span class="keywordflow">return</span>(R0+pow((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a20e81ef2343c6d8db701c6613cbcd279">Rhor</a>-R0)/pow(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-R0,ftemp),1.0/(1.0-ftemp)));</div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;    }</div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d9/de9/coord_8c.html#a119eed5c7b218e4a9547a2e0c1a8d4fe">npow2</a>&gt;0){</div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;      <span class="keywordflow">return</span>(1.2);</div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;    }</div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;      dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;ihoradjust=%26.20g totalsize[1]=%d Rhor=%26.20g R0=%26.20g npow=%26.20g Rout=%26.20g\n&quot;</span>,ihoradjust,<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1],<a class="code" href="../../d8/d5b/defs_8general_8h.html#a20e81ef2343c6d8db701c6613cbcd279">Rhor</a>,R0,<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>);</div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;      <span class="keywordflow">return</span>(R0+exp( pow((<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1]*pow(log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a20e81ef2343c6d8db701c6613cbcd279">Rhor</a>-R0),1.0/<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>) - ihoradjust*pow(log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-R0),1.0/<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>))/(<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1]-ihoradjust),<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>)));</div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;    }</div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;  }</div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a0e5331f6ac2b706aa4e76de967dcb1d7">JET6COORDSTHIN</a>){</div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;    <span class="comment">// see jet3coords_checknew.nb (and fix_3dpolestissue.nb) to have chosen Rin and ihor and compute required R0</span></div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;    <span class="keywordflow">if</span>(th_npow==1.0){</div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;      ftemp=ihoradjust/(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>)<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;      <span class="keywordflow">return</span>(R0+pow((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a20e81ef2343c6d8db701c6613cbcd279">Rhor</a>-R0)/pow(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-R0,ftemp),1.0/(1.0-ftemp)));</div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;    }</div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(th_npow2&gt;0){</div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;      <span class="keywordflow">return</span>(1.2);</div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;    }</div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;      dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;ihoradjust=%26.20g totalsize[1]=%d Rhor=%26.20g R0=%26.20g npow=%26.20g Rout=%26.20g\n&quot;</span>,ihoradjust,<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1],<a class="code" href="../../d8/d5b/defs_8general_8h.html#a20e81ef2343c6d8db701c6613cbcd279">Rhor</a>,R0,th_npow,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>);</div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;      <span class="keywordflow">return</span>(R0+exp( pow((<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1]*pow(log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a20e81ef2343c6d8db701c6613cbcd279">Rhor</a>-R0),1.0/th_npow) - ihoradjust*pow(log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-R0),1.0/th_npow))/(<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1]-ihoradjust),th_npow)));</div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;    }</div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;  }</div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a22ccf670681b96ce61d974db87204a10">BPTHIN1</a>){</div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;    <span class="comment">// see jet3coords_checknew.nb (and fix_3dpolestissue.nb) to have chosen Rin and ihor and compute required R0</span></div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../d9/de9/coord_8c.html#a565a42e16bf3620bb640120f8c1a4e2a">bp_npow</a>==1.0){</div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;      ftemp=ihoradjust/(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>)<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;      <span class="keywordflow">return</span>(R0+pow((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a20e81ef2343c6d8db701c6613cbcd279">Rhor</a>-R0)/pow(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-R0,ftemp),1.0/(1.0-ftemp)));</div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;    }</div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d9/de9/coord_8c.html#a0cce4548534baf8c1e0f2fbdd706117c">bp_npow2</a>&gt;0){</div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;      <span class="keywordflow">return</span>(1.2);</div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;    }</div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;      dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;ihoradjust=%21.15g totalsize[1]=%d Rhor=%21.15g R0=%21.15g bp_npow=%21.15g Rout=%21.15g\n&quot;</span>,ihoradjust,<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1],<a class="code" href="../../d8/d5b/defs_8general_8h.html#a20e81ef2343c6d8db701c6613cbcd279">Rhor</a>,R0,<a class="code" href="../../d9/de9/coord_8c.html#a565a42e16bf3620bb640120f8c1a4e2a">bp_npow</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>);</div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;      <span class="keywordflow">return</span>(R0+exp( pow((<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1]*pow(log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a20e81ef2343c6d8db701c6613cbcd279">Rhor</a>-R0),1.0/<a class="code" href="../../d9/de9/coord_8c.html#a565a42e16bf3620bb640120f8c1a4e2a">bp_npow</a>) - ihoradjust*pow(log(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-R0),1.0/<a class="code" href="../../d9/de9/coord_8c.html#a565a42e16bf3620bb640120f8c1a4e2a">bp_npow</a>))/(<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1]-ihoradjust),<a class="code" href="../../d9/de9/coord_8c.html#a565a42e16bf3620bb640120f8c1a4e2a">bp_npow</a>)));</div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;    }</div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;  }</div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a5e2e2deaaa6af505fdb3c7b3c2f817a5">JET5COORDS</a>){</div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;    <span class="keywordflow">return</span>(<a class="code" href="../../d9/de9/coord_8c.html#ac37b157905a8fc5a13832315dfaf4c15">JET5RIN</a>); <span class="comment">// not free!  Must be consistent with how determine coordinates</span></div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;  }</div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a87e4392d8d6cdc988ced46d7e7a2dfe2">PULSARCOORDS</a>){</div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>==1.0){</div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;      ftemp=ihoradjust/(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>)<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;      <span class="keywordflow">return</span>(R0+pow((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a20e81ef2343c6d8db701c6613cbcd279">Rhor</a>-R0)/pow(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-R0,ftemp),1.0/(1.0-ftemp)));</div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;    }</div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;      <span class="comment">// SUPERGODMARK : need to change for npow&gt;1.0</span></div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;      <span class="keywordflow">return</span>(1.1);</div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;    }</div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;  }</div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a47b225226fbd0e3e573ec095071ecc10">UNIFORMCOORDS</a>) {</div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;    <span class="comment">//uniform grid for Cartesian coordinates</span></div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;    <span class="comment">//no horizon in Cartesian coords -&gt; do not set anything</span></div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;    <span class="keywordflow">return</span>( 1.0 );</div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;  }</div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a>==<a class="code" href="../../d7/d56/coord_8h.html#aa0a3d1a614796ea8787d7360932b121c">RAMESHCOORDS</a> || <a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a>==<a class="code" href="../../d7/d56/coord_8h.html#a320ee4f267db4b195bbde94bec748a29">RAMESHCOORDS_HALFDISK</a>){</div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>==1.0){</div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;      ftemp=ihoradjust/(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>)<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;      <span class="keywordflow">return</span>(R0+pow((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a20e81ef2343c6d8db701c6613cbcd279">Rhor</a>-R0)/pow(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-R0,ftemp),1.0/(1.0-ftemp)));</div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;    }</div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;      <span class="comment">// SUPERGODMARK : need to change for npow&gt;1.0</span></div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;      <span class="keywordflow">return</span>(1.1);</div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;    }</div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;  }</div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a6e1b80715afcab76e5ec0827d7113aa9">JET4COORDS</a>){</div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../d9/de9/coord_8c.html#ac2a68254de2b98475aad56af7a36d343">npow</a>==1.0){</div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;      ftemp=ihoradjust/(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>)<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1];</div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;      <span class="keywordflow">return</span>(R0+pow((<a class="code" href="../../d8/d5b/defs_8general_8h.html#a20e81ef2343c6d8db701c6613cbcd279">Rhor</a>-R0)/pow(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a2b3e48ba92bae56a9925460125e78367">Rout</a>-R0,ftemp),1.0/(1.0-ftemp)));</div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;    }</div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;      <span class="comment">// SUPERGODMARK : need to change for npow&gt;1.0</span></div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;      <span class="keywordflow">return</span>(1.1);</div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;    }</div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;  }</div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a> == <a class="code" href="../../d7/d56/coord_8h.html#a35d1eed7020c0beb59e9b6432fd68175">UNI2LOG</a>){</div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;This grid&#39;s setRin is not setup defcoord=%d\n&quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a>);</div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;    myexit(1);</div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;    <span class="keywordflow">return</span>(-1);</div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;  }</div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;</div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;  dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Shouldn&#39;t reach end of setRin: defcoord=%d\n&quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a07aa730709566649748925d2ae0aae77">defcoord</a>);</div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;  myexit(1);</div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;  <span class="keywordflow">return</span>(-1);</div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;</div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;}</div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;</div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;</div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;</div>
<div class="line"><a name="l03450"></a><span class="lineno"><a class="code" href="../../d6/d85/coord_8funcdeclare_8h.html#a041e7b005310415c97d90f4b8521ed1a"> 3450</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d9/de9/coord_8c.html#a041e7b005310415c97d90f4b8521ed1a" title="get X(i,j,k) CENT is default position in degenerate cases">coord</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> loc, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *X)</div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;{</div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;  <span class="comment">// as in get_geometry(), these ?global&#39;s are used by other routines as a global indicator of where in position space we are so don&#39;t have to pass to all subfunctions</span></div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;  <span class="comment">//iglobal=i;</span></div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;  <span class="comment">//jglobal=j;</span></div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;  <span class="comment">//kglobal=k;</span></div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;  <span class="comment">//pglobal=loc;</span></div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;</div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;</div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;  <span class="keywordflow">if</span> (loc == <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8936711f57f82d1fc75c21fa2894e1c6">CENT</a>) {</div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;    X[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] + (i + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[1] + 0.5) * dx[1];</div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;    X[2] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] + (j + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[2] + 0.5) * dx[2];</div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;    X[3] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] + (k + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[3] + 0.5) * dx[3];</div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;  }</div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (loc == <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a1df736ddba855d7b429869f9f09dbd66">FACE1</a>) {</div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;<span class="preprocessor">#if(N1&gt;1)</span></div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;<span class="preprocessor"></span>    X[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] + (i + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[1]      ) * dx[1];</div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;<span class="preprocessor"></span>    X[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] + (i + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[1] + 0.5) * dx[1];</div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;    X[2] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] + (j + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[2] + 0.5) * dx[2];</div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;    X[3] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] + (k + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[3] + 0.5) * dx[3];</div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;  }</div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (loc == <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a5b4b42f50fd7667c7d22d8001811bc7e">FACE2</a>) {</div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;    X[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] + (i + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[1] + 0.5) * dx[1];</div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;</div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;<span class="preprocessor">#if(N2&gt;1)</span></div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;<span class="preprocessor"></span>    X[2] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] + (j + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[2]      ) * dx[2];</div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;<span class="preprocessor">#else </span></div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;<span class="preprocessor"></span>    X[2] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] + (j + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[2] + 0.5) * dx[2];</div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;    X[3] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] + (k + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[3] + 0.5) * dx[3];</div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;  }</div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (loc == <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a630fdcefb04bdca66118cfd21476e8fd">FACE3</a>) {</div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;    X[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] + (i + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[1] + 0.5) * dx[1];</div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;    X[2] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] + (j + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[2] + 0.5) * dx[2];</div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;</div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;<span class="preprocessor">#if(N3&gt;1)</span></div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;<span class="preprocessor"></span>    X[3] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] + (k + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[3]      ) * dx[3];</div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;<span class="preprocessor"></span>    X[3] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] + (k + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[3] + 0.5) * dx[3];</div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;<span class="preprocessor"></span>  }</div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (loc == <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a1068bcf25c9f187a8db0f422e0af64c8">CORN1</a>) {</div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;    X[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] + (i + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[1] + 0.5) * dx[1];</div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;</div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;<span class="preprocessor">#if(N2&gt;1)</span></div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;<span class="preprocessor"></span>    X[2] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] + (j + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[2]      ) * dx[2];</div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;<span class="preprocessor"></span>    X[2] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] + (j + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[2] + 0.5) * dx[2];</div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#if(N3&gt;1)</span></div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;<span class="preprocessor"></span>    X[3] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] + (k + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[3]      ) * dx[3];</div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;<span class="preprocessor"></span>    X[3] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] + (k + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[3] + 0.5) * dx[3];</div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;<span class="preprocessor"></span>  }</div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (loc == <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ab10e4ab484f1edd4cecb418ff22a743a">CORN2</a>) {</div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;<span class="preprocessor">#if(N1&gt;1)</span></div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;<span class="preprocessor"></span>    X[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] + (i + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[1]      ) * dx[1];</div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;<span class="preprocessor"></span>    X[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] + (i + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[1] + 0.5) * dx[1];</div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;    X[2] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] + (j + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[2] + 0.5) * dx[2];</div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;</div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;<span class="preprocessor">#if(N3&gt;1)</span></div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;<span class="preprocessor"></span>    X[3] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] + (k + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[3]      ) * dx[3];</div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;<span class="preprocessor"></span>    X[3] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] + (k + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[3] + 0.5) * dx[3];</div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;<span class="preprocessor"></span>  }</div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (loc == <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a1a05e117efd4dbc39b7c590141004470">CORN3</a>) {</div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;<span class="preprocessor">#if(N1&gt;1)</span></div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;<span class="preprocessor"></span>    X[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] + (i + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[1]      ) * dx[1];</div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;<span class="preprocessor"></span>    X[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] + (i + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[1] + 0.5) * dx[1];</div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#if(N2&gt;1)</span></div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;<span class="preprocessor"></span>    X[2] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] + (j + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[2]      ) * dx[2];</div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;<span class="preprocessor"></span>    X[2] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] + (j + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[2] + 0.5) * dx[2];</div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;    X[3] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] + (k + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[3] + 0.5) * dx[3];</div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;  }</div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (loc == <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aca28d3c01bd5d2739e54d08b3336c54a">CORNT</a>) {</div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;<span class="preprocessor">#if(N1&gt;1)</span></div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;<span class="preprocessor"></span>    X[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] + (i + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[1]      ) * dx[1];</div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;<span class="preprocessor"></span>    X[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] + (i + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[1] + 0.5) * dx[1];</div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#if(N2&gt;1)</span></div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;<span class="preprocessor"></span>    X[2] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] + (j + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[2]      ) * dx[2];</div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;<span class="preprocessor"></span>    X[2] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] + (j + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[2] + 0.5) * dx[2];</div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#if(N3&gt;1)</span></div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;<span class="preprocessor"></span>    X[3] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] + (k + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[3]      ) * dx[3];</div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;<span class="preprocessor"></span>    X[3] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] + (k + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[3] + 0.5) * dx[3];</div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;<span class="preprocessor"></span>  }</div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;</div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;  <span class="comment">// present time is always denoted by X[0]=0 so that past times are negative X[0]</span></div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;  <span class="comment">//  X[0]=0.0;</span></div>
<div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;  <span class="comment">// below only applies for longsteps method</span></div>
<div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;  <span class="comment">//  X[0]=t; // use X[0] to indicate time in standard temporal coordinates</span></div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;</div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;  <span class="comment">// present time of metric quantities</span></div>
<div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;  <span class="comment">// assume Xmetricnew setup in set_grid before this function (coord) is called</span></div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;  X[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a08ca909b46b12e894320afaabce3056e" title="time period between dumps for various types of dumps NO, use &quot;DUMPTYPE&quot; names now">TT</a>] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#a0606a9242a6f0be89cdf25ca20e90090">Xmetricnew</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a08ca909b46b12e894320afaabce3056e" title="time period between dumps for various types of dumps NO, use &quot;DUMPTYPE&quot; names now">TT</a>];</div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;</div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;}</div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;</div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;</div>
<div class="line"><a name="l03573"></a><span class="lineno"><a class="code" href="../../d6/d85/coord_8funcdeclare_8h.html#ab0f945e1e1bea3416e687db5f22af236"> 3573</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d9/de9/coord_8c.html#ab0f945e1e1bea3416e687db5f22af236" title="Get X(i,j,k) like coord() but does not constrain X when in reduced dimensionality used for infinitesi...">coord_free</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> loc, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *X)</div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;{</div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;</div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;  <span class="comment">//iglobal=i;</span></div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;  <span class="comment">//jglobal=j;</span></div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;  <span class="comment">//kglobal=k;</span></div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;  <span class="comment">//pglobal=loc;</span></div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;</div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;  <span class="keywordflow">if</span> (loc == <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8936711f57f82d1fc75c21fa2894e1c6">CENT</a>) {</div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;    X[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] + (i + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[1] + 0.5) * dx[1];</div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;    X[2] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] + (j + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[2] + 0.5) * dx[2];</div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;    X[3] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] + (k + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[3] + 0.5) * dx[3];</div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;  }</div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (loc == <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a1df736ddba855d7b429869f9f09dbd66">FACE1</a>) {</div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;    X[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] + (i + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[1]      ) * dx[1];</div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;    X[2] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] + (j + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[2] + 0.5) * dx[2];</div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;    X[3] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] + (k + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[3] + 0.5) * dx[3];</div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;  }</div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (loc == <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a5b4b42f50fd7667c7d22d8001811bc7e">FACE2</a>) {</div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;    X[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] + (i + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[1] + 0.5) * dx[1];</div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;    X[2] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] + (j + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[2]      ) * dx[2];</div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;    X[3] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] + (k + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[3] + 0.5) * dx[3];</div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;  }</div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (loc == <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a630fdcefb04bdca66118cfd21476e8fd">FACE3</a>) {</div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;    X[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] + (i + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[1] + 0.5) * dx[1];</div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;    X[2] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] + (j + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[2] + 0.5) * dx[2];</div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;    X[3] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] + (k + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[3]      ) * dx[3];</div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;  }</div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (loc == <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a1068bcf25c9f187a8db0f422e0af64c8">CORN1</a>) {</div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;    X[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] + (i + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[1] + 0.5) * dx[1];</div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;    X[2] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] + (j + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[2]      ) * dx[2];</div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;    X[3] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] + (k + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[3]      ) * dx[3];</div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;  }</div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (loc == <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ab10e4ab484f1edd4cecb418ff22a743a">CORN2</a>) {</div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;    X[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] + (i + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[1]      ) * dx[1];</div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;    X[2] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] + (j + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[2] + 0.5) * dx[2];</div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;    X[3] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] + (k + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[3]      ) * dx[3];</div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;  }</div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (loc == <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a1a05e117efd4dbc39b7c590141004470">CORN3</a>) {</div>
<div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;    X[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] + (i + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[1]      ) * dx[1];</div>
<div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;    X[2] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] + (j + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[2]      ) * dx[2];</div>
<div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;    X[3] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] + (k + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[3] + 0.5) * dx[3];</div>
<div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;  }</div>
<div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (loc == <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aca28d3c01bd5d2739e54d08b3336c54a">CORNT</a>) {</div>
<div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;    X[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] + (i + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[1]      ) * dx[1];</div>
<div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;    X[2] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] + (j + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[2]      ) * dx[2];</div>
<div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;    X[3] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] + (k + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[3]      ) * dx[3];</div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;  }</div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;</div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;  <span class="comment">// present time is always denoted by X[0]=0 so that past times are negative X[0]</span></div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;  <span class="comment">//  X[0]=0.0;</span></div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;  <span class="comment">// below only applies for longsteps method</span></div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;  <span class="comment">//  X[0]=t; // use X[0] to indicate time in standard temporal coordinates</span></div>
<div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;</div>
<div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;  <span class="comment">// present time of metric quantities</span></div>
<div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;  <span class="comment">// assume Xmetricnew setup in set_grid before this function (coord) is called</span></div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;  X[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a08ca909b46b12e894320afaabce3056e" title="time period between dumps for various types of dumps NO, use &quot;DUMPTYPE&quot; names now">TT</a>] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#a0606a9242a6f0be89cdf25ca20e90090">Xmetricnew</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a08ca909b46b12e894320afaabce3056e" title="time period between dumps for various types of dumps NO, use &quot;DUMPTYPE&quot; names now">TT</a>];</div>
<div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;</div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;}</div>
<div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;</div>
<div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;</div>
<div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;</div>
<div class="line"><a name="l03637"></a><span class="lineno"><a class="code" href="../../d6/d85/coord_8funcdeclare_8h.html#aeed6033e7c6024f16d830a672c223f28"> 3637</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d9/de9/coord_8c.html#aeed6033e7c6024f16d830a672c223f28" title="identical to coord except declaration using FTYPEs">coordf</a>(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> i, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> j, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> k, <span class="keywordtype">int</span> loc, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *X)</div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;{</div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;  <span class="comment">//iglobal=ROUND2INT(i);</span></div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;  <span class="comment">//jglobal=ROUND2INT(j);</span></div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;  <span class="comment">//kglobal=ROUND2INT(k);</span></div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;  <span class="comment">//pglobal=loc;</span></div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;</div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;  <span class="keywordflow">if</span> (loc == <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8936711f57f82d1fc75c21fa2894e1c6">CENT</a>) {</div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;    X[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] + (i + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[1] + 0.5) * dx[1];</div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;    X[2] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] + (j + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[2] + 0.5) * dx[2];</div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;    X[3] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] + (k + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[3] + 0.5) * dx[3];</div>
<div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;  }</div>
<div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (loc == <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a1df736ddba855d7b429869f9f09dbd66">FACE1</a>) {</div>
<div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;<span class="preprocessor">#if(N1&gt;1)</span></div>
<div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;<span class="preprocessor"></span>    X[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] + (i + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[1]      ) * dx[1];</div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;<span class="preprocessor"></span>    X[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] + (i + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[1] + 0.5) * dx[1];</div>
<div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;    X[2] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] + (j + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[2] + 0.5) * dx[2];</div>
<div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;    X[3] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] + (k + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[3] + 0.5) * dx[3];</div>
<div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;  }</div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (loc == <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a5b4b42f50fd7667c7d22d8001811bc7e">FACE2</a>) {</div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;    X[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] + (i + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[1] + 0.5) * dx[1];</div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;</div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;<span class="preprocessor">#if(N2&gt;1)</span></div>
<div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;<span class="preprocessor"></span>    X[2] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] + (j + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[2]      ) * dx[2];</div>
<div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;<span class="preprocessor">#else </span></div>
<div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;<span class="preprocessor"></span>    X[2] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] + (j + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[2] + 0.5) * dx[2];</div>
<div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;    X[3] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] + (k + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[3] + 0.5) * dx[3];</div>
<div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;  }</div>
<div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (loc == <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a630fdcefb04bdca66118cfd21476e8fd">FACE3</a>) {</div>
<div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;    X[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] + (i + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[1] + 0.5) * dx[1];</div>
<div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;    X[2] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] + (j + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[2] + 0.5) * dx[2];</div>
<div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;</div>
<div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;<span class="preprocessor">#if(N3&gt;1)</span></div>
<div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;<span class="preprocessor"></span>    X[3] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] + (k + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[3]      ) * dx[3];</div>
<div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;<span class="preprocessor"></span>    X[3] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] + (k + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[3] + 0.5) * dx[3];</div>
<div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;<span class="preprocessor"></span>  }</div>
<div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (loc == <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a1068bcf25c9f187a8db0f422e0af64c8">CORN1</a>) {</div>
<div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;    X[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] + (i + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[1] + 0.5) * dx[1];</div>
<div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;</div>
<div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;<span class="preprocessor">#if(N2&gt;1)</span></div>
<div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;<span class="preprocessor"></span>    X[2] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] + (j + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[2]      ) * dx[2];</div>
<div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;<span class="preprocessor"></span>    X[2] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] + (j + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[2] + 0.5) * dx[2];</div>
<div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#if(N3&gt;1)</span></div>
<div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;<span class="preprocessor"></span>    X[3] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] + (k + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[3]      ) * dx[3];</div>
<div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;<span class="preprocessor"></span>    X[3] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] + (k + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[3] + 0.5) * dx[3];</div>
<div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;<span class="preprocessor"></span>  }</div>
<div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (loc == <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ab10e4ab484f1edd4cecb418ff22a743a">CORN2</a>) {</div>
<div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;<span class="preprocessor">#if(N1&gt;1)</span></div>
<div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;<span class="preprocessor"></span>    X[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] + (i + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[1]      ) * dx[1];</div>
<div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;<span class="preprocessor"></span>    X[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] + (i + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[1] + 0.5) * dx[1];</div>
<div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;    X[2] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] + (j + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[2] + 0.5) * dx[2];</div>
<div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;</div>
<div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;<span class="preprocessor">#if(N3&gt;1)</span></div>
<div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;<span class="preprocessor"></span>    X[3] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] + (k + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[3]      ) * dx[3];</div>
<div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;<span class="preprocessor"></span>    X[3] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] + (k + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[3] + 0.5) * dx[3];</div>
<div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;<span class="preprocessor"></span>  }</div>
<div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (loc == <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a1a05e117efd4dbc39b7c590141004470">CORN3</a>) {</div>
<div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;<span class="preprocessor">#if(N1&gt;1)</span></div>
<div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;<span class="preprocessor"></span>    X[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] + (i + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[1]      ) * dx[1];</div>
<div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;<span class="preprocessor"></span>    X[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] + (i + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[1] + 0.5) * dx[1];</div>
<div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#if(N2&gt;1)</span></div>
<div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;<span class="preprocessor"></span>    X[2] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] + (j + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[2]      ) * dx[2];</div>
<div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;<span class="preprocessor"></span>    X[2] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] + (j + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[2] + 0.5) * dx[2];</div>
<div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;    X[3] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] + (k + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[3] + 0.5) * dx[3];</div>
<div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;  }</div>
<div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (loc == <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aca28d3c01bd5d2739e54d08b3336c54a">CORNT</a>) {</div>
<div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;<span class="preprocessor">#if(N1&gt;1)</span></div>
<div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;<span class="preprocessor"></span>    X[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] + (i + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[1]      ) * dx[1];</div>
<div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;<span class="preprocessor"></span>    X[1] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1] + (i + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[1] + 0.5) * dx[1];</div>
<div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#if(N2&gt;1)</span></div>
<div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;<span class="preprocessor"></span>    X[2] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] + (j + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[2]      ) * dx[2];</div>
<div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;<span class="preprocessor"></span>    X[2] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2] + (j + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[2] + 0.5) * dx[2];</div>
<div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#if(N3&gt;1)</span></div>
<div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;<span class="preprocessor"></span>    X[3] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] + (k + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[3]      ) * dx[3];</div>
<div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;<span class="preprocessor"></span>    X[3] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3] + (k + <a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[3] + 0.5) * dx[3];</div>
<div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;<span class="preprocessor"></span>  }</div>
<div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;</div>
<div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;  <span class="comment">// present time is always denoted by X[0]=0 so that past times are negative X[0]</span></div>
<div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;  <span class="comment">//  X[0]=0.0;</span></div>
<div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;  <span class="comment">// below only applies for longsteps method</span></div>
<div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;  <span class="comment">//  X[0]=t; // use X[0] to indicate time in standard temporal coordinates</span></div>
<div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;</div>
<div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;  <span class="comment">// present time of metric quantities</span></div>
<div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;  <span class="comment">// assume Xmetricnew setup in set_grid before this function (coord) is called</span></div>
<div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;  X[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a08ca909b46b12e894320afaabce3056e" title="time period between dumps for various types of dumps NO, use &quot;DUMPTYPE&quot; names now">TT</a>] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#a0606a9242a6f0be89cdf25ca20e90090">Xmetricnew</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a08ca909b46b12e894320afaabce3056e" title="time period between dumps for various types of dumps NO, use &quot;DUMPTYPE&quot; names now">TT</a>];</div>
<div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;</div>
<div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;}</div>
<div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;</div>
<div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;</div>
<div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;<span class="keywordtype">void</span> icoord(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *X,<span class="keywordtype">int</span> loc, <span class="keywordtype">int</span> *i, <span class="keywordtype">int</span> *j, <span class="keywordtype">int</span> *k)</div>
<div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;{</div>
<div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;  <span class="keywordflow">if</span>(loc == <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8936711f57f82d1fc75c21fa2894e1c6">CENT</a>){</div>
<div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;    *i = (int)((X[1]-<a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1])/dx[1] - 0.5) ;</div>
<div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;    *j = (int)((X[2]-<a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2])/dx[2] - 0.5) ;</div>
<div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;    *k = (int)((X[3]-<a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3])/dx[3] - 0.5) ;</div>
<div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;  }</div>
<div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;</div>
<div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[1]+ *i&gt;=<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1]+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#aa00aaa6c09563827fbe601635b149ef8">N1BND</a>) *i=<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1]-1+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#aa00aaa6c09563827fbe601635b149ef8">N1BND</a>;</div>
<div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[2]+ *j&gt;=<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[2]+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a4053d825930f47a796f9f13678ef32e3">N2BND</a>) *j=<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[2]-1+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a4053d825930f47a796f9f13678ef32e3">N2BND</a>;</div>
<div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[3]+ *k&gt;=<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[3]+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a90d132cb201447b8fe71388f1b0ffe93">N3BND</a>) *k=<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[3]-1+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a90d132cb201447b8fe71388f1b0ffe93">N3BND</a>;</div>
<div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;  </div>
<div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[1]+ *i&lt;-N1BND) *i=-<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#aa00aaa6c09563827fbe601635b149ef8">N1BND</a>;</div>
<div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[2]+ *j&lt;-N2BND) *j=-<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a4053d825930f47a796f9f13678ef32e3">N2BND</a>;</div>
<div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[3]+ *k&lt;-N3BND) *k=-<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a90d132cb201447b8fe71388f1b0ffe93">N3BND</a>;</div>
<div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;</div>
<div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;}</div>
<div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;</div>
<div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;<span class="preprocessor">#define INCLUDEROUND 0 // default</span></div>
<div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;<span class="preprocessor">#ifdef WIN32</span></div>
<div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#undef INCLUDEROUND</span></div>
<div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define INCLUDEROUND 1</span></div>
<div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;<span class="comment">// roundl is not part of long double library</span></div>
<div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;<span class="preprocessor">#if(REALTYPE==LONGDOUBLETYPE)</span></div>
<div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#undef INCLUDEROUND</span></div>
<div class="line"><a name="l03783"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a40e8ffd4aea7db489a1615e178163082"> 3783</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define INCLUDEROUND 1</span></div>
<div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;<span class="preprocessor">#if(INCLUDEROUND)</span></div>
<div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l03788"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a577f8f0b00b59615104419c160e78dcf"> 3788</a></span>&#160;<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a577f8f0b00b59615104419c160e78dcf" title="get rounded value of x">round</a>(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> x)</div>
<div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;{</div>
<div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> xfloor,xceil;</div>
<div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;</div>
<div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;  xfloor=floor(x);</div>
<div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;  xceil=ceil(x);</div>
<div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;  <span class="keywordflow">if</span>(fabs(x-xfloor)&gt;fabs(x-xceil)) <span class="keywordflow">return</span>(xceil);</div>
<div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">return</span>(xfloor);</div>
<div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;}</div>
<div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;</div>
<div class="line"><a name="l03799"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a1dd6f49f54400659fdbb05ca2b151000"> 3799</a></span>&#160;<span class="keywordtype">long</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/de9/coord_8c.html#a1dd6f49f54400659fdbb05ca2b151000" title="get rounded value of x">lrint</a>(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> x)</div>
<div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;{</div>
<div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;  <span class="keywordflow">return</span>((<span class="keywordtype">long</span> <span class="keywordtype">int</span>)<a class="code" href="../../d9/de9/coord_8c.html#a577f8f0b00b59615104419c160e78dcf" title="get rounded value of x">round</a>(x));</div>
<div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;}</div>
<div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;</div>
<div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;</div>
<div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> myround(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> x)</div>
<div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;{</div>
<div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;</div>
<div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;<span class="preprocessor">#if(REALTYPE==FLOATTYPE)</span></div>
<div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">return</span>(roundf(x));</div>
<div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;<span class="preprocessor">#elif(REALTYPE==DOUBLETYPE || REALTYPE==LONGDOUBLETYPE)</span></div>
<div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;<span class="preprocessor"></span>  <span class="comment">// ceill will be used automatically by conversion to long doubles</span></div>
<div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;  <span class="keywordflow">return</span>(<a class="code" href="../../d9/de9/coord_8c.html#a577f8f0b00b59615104419c160e78dcf" title="get rounded value of x">round</a>(x));</div>
<div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;}</div>
<div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;</div>
<div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;</div>
<div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;<span class="preprocessor">#if(0)</span></div>
<div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;<span class="keywordtype">long</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/de9/coord_8c.html#a83bc5be5647d147a26a42e994e02b1ea">myround2int</a>(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> x)</div>
<div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;{</div>
<div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;</div>
<div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;<span class="preprocessor">#if(REALTYPE==FLOATTYPE)</span></div>
<div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">return</span>(lrintf(x));</div>
<div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;<span class="preprocessor">#elif(REALTYPE==DOUBLETYPE)</span></div>
<div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">return</span>(<a class="code" href="../../d9/de9/coord_8c.html#a1dd6f49f54400659fdbb05ca2b151000" title="get rounded value of x">lrint</a>(x));</div>
<div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;<span class="preprocessor">#elif(REALTYPE==LONGDOUBLETYPE)</span></div>
<div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">return</span>(lrintl(x));</div>
<div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;<span class="preprocessor"></span>}</div>
<div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l03835"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a83bc5be5647d147a26a42e994e02b1ea"> 3835</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define myround2int(x) (ROUND2INT(x))</span></div>
<div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;<span class="keywordtype">void</span> icoord_round(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *X,<span class="keywordtype">int</span> loc, <span class="keywordtype">int</span> *i, <span class="keywordtype">int</span> *j, <span class="keywordtype">int</span> *k)</div>
<div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;{</div>
<div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> myround(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> x);</div>
<div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;  <span class="comment">//  long int myround2int(FTYPE x);</span></div>
<div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;</div>
<div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;  <span class="keywordflow">if</span>(loc == <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8936711f57f82d1fc75c21fa2894e1c6">CENT</a>){</div>
<div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;    *i = <a class="code" href="../../d9/de9/coord_8c.html#a83bc5be5647d147a26a42e994e02b1ea">myround2int</a>((X[1]-<a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1])/dx[1] - 0.5) ;</div>
<div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;    *j = <a class="code" href="../../d9/de9/coord_8c.html#a83bc5be5647d147a26a42e994e02b1ea">myround2int</a>((X[2]-<a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[2])/dx[2] - 0.5) ;</div>
<div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;    *k = <a class="code" href="../../d9/de9/coord_8c.html#a83bc5be5647d147a26a42e994e02b1ea">myround2int</a>((X[3]-<a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[3])/dx[3] - 0.5) ;</div>
<div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;  }</div>
<div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;</div>
<div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[1]+ *i&gt;=<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1]+N1BND) *i=<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[1]-1+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#aa00aaa6c09563827fbe601635b149ef8">N1BND</a>;</div>
<div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[2]+ *j&gt;=<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[2]+N2BND) *j=<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[2]-1+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a4053d825930f47a796f9f13678ef32e3">N2BND</a>;</div>
<div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[3]+ *k&gt;=<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[3]+N3BND) *k=<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[3]-1+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a90d132cb201447b8fe71388f1b0ffe93">N3BND</a>;</div>
<div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;  </div>
<div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[1]+ *i&lt;-N1BND) *i=-<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#aa00aaa6c09563827fbe601635b149ef8">N1BND</a>;</div>
<div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[2]+ *j&lt;-N2BND) *j=-<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a4053d825930f47a796f9f13678ef32e3">N2BND</a>;</div>
<div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[3]+ *k&lt;-N3BND) *k=-<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a90d132cb201447b8fe71388f1b0ffe93">N3BND</a>;</div>
<div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;</div>
<div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;}</div>
<div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;</div>
<div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;</div>
<div class="line"><a name="l03863"></a><span class="lineno"><a class="code" href="../../d6/d85/coord_8funcdeclare_8h.html#abcadd702f25f3bf1c271767b3402fc05"> 3863</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d9/de9/coord_8c.html#abcadd702f25f3bf1c271767b3402fc05" title="see if point inside surface dir=X1UP,X1DN,etc.">is_inside_surface</a>(<span class="keywordtype">int</span> dir, <span class="keywordtype">int</span> ii, <span class="keywordtype">int</span> jj, <span class="keywordtype">int</span> kk, <span class="keywordtype">int</span> pp)</div>
<div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;{</div>
<div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d9/de9/coord_8c.html#ab3117341ce3b93c54683196284a004c3" title="see if point is on surface">is_on_surface</a>(<span class="keywordtype">int</span> dir, <span class="keywordtype">int</span> ii, <span class="keywordtype">int</span> jj, <span class="keywordtype">int</span> kk, <span class="keywordtype">int</span> pp);</div>
<div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;  <span class="keywordtype">int</span> ijk[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;  <span class="keywordtype">int</span> dimen;</div>
<div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;  <span class="keywordtype">int</span> dirsign;</div>
<div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;  <span class="keywordtype">int</span> isonsurf;</div>
<div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;</div>
<div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;  ijk[1]=ii;</div>
<div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;  ijk[2]=jj;</div>
<div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;  ijk[3]=kk;</div>
<div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;</div>
<div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;</div>
<div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;  dimen=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#af042ecb1035f9983def6c551b070d0ce" title="dimension=1,2,3 for given direction defined above">DIMEN</a>(dir);</div>
<div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;  dirsign=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a778d32170eca63213bffc9e712f151e8" title="direction (-1,+1) for a given direction as defined above">DIRSIGN</a>(dir);</div>
<div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;  </div>
<div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;  isonsurf=<a class="code" href="../../d9/de9/coord_8c.html#ab3117341ce3b93c54683196284a004c3" title="see if point is on surface">is_on_surface</a>(dir,ii,jj,kk,pp);</div>
<div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;</div>
<div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;  <span class="keywordflow">if</span>(isonsurf){</div>
<div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;    <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;  }</div>
<div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(</div>
<div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;          (<a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[dimen]+ijk[dimen]&lt;0 &amp;&amp; dirsign==-1)</div>
<div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;          || </div>
<div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;          (<a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[dimen]+ijk[dimen]&gt;<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[dimen]-1 &amp;&amp; dirsign==1)</div>
<div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;          ){</div>
<div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;    <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;  }</div>
<div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;</div>
<div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;}</div>
<div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;</div>
<div class="line"><a name="l03896"></a><span class="lineno"><a class="code" href="../../d6/d85/coord_8funcdeclare_8h.html#ab3117341ce3b93c54683196284a004c3"> 3896</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d9/de9/coord_8c.html#ab3117341ce3b93c54683196284a004c3" title="see if point is on surface">is_on_surface</a>(<span class="keywordtype">int</span> dir, <span class="keywordtype">int</span> ii, <span class="keywordtype">int</span> jj, <span class="keywordtype">int</span> kk, <span class="keywordtype">int</span> pp)</div>
<div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;{</div>
<div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;  <span class="keywordtype">int</span> ijk[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;  <span class="keywordtype">int</span> dimen;</div>
<div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;  <span class="keywordtype">int</span> dirsign;</div>
<div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;</div>
<div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;  ijk[1]=ii;</div>
<div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;  ijk[2]=jj;</div>
<div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;  ijk[3]=kk;</div>
<div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;</div>
<div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;</div>
<div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;  dimen=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#af042ecb1035f9983def6c551b070d0ce" title="dimension=1,2,3 for given direction defined above">DIMEN</a>(dir);</div>
<div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;  dirsign=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a778d32170eca63213bffc9e712f151e8" title="direction (-1,+1) for a given direction as defined above">DIRSIGN</a>(dir);</div>
<div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;</div>
<div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;  <span class="keywordflow">if</span>(</div>
<div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;     ((dimen==1)&amp;&amp;(dirsign==-1)&amp;&amp;(<a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[dimen]+ii==0)                 &amp;&amp; (pp==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a1df736ddba855d7b429869f9f09dbd66">FACE1</a> || pp==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ab10e4ab484f1edd4cecb418ff22a743a">CORN2</a> || pp==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a1a05e117efd4dbc39b7c590141004470">CORN3</a> || pp==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aca28d3c01bd5d2739e54d08b3336c54a">CORNT</a>))||</div>
<div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;     ((dimen==1)&amp;&amp;(dirsign==1) &amp;&amp;(<a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[dimen]+ii==<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[dimen])  &amp;&amp; (pp==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a1df736ddba855d7b429869f9f09dbd66">FACE1</a> || pp==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ab10e4ab484f1edd4cecb418ff22a743a">CORN2</a> || pp==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a1a05e117efd4dbc39b7c590141004470">CORN3</a> || pp==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aca28d3c01bd5d2739e54d08b3336c54a">CORNT</a>))||</div>
<div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;     ((dimen==2)&amp;&amp;(dirsign==-1)&amp;&amp;(<a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[dimen]+jj==0)                 &amp;&amp; (pp==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a5b4b42f50fd7667c7d22d8001811bc7e">FACE2</a> || pp==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a1068bcf25c9f187a8db0f422e0af64c8">CORN1</a> || pp==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a1a05e117efd4dbc39b7c590141004470">CORN3</a> || pp==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aca28d3c01bd5d2739e54d08b3336c54a">CORNT</a>))||</div>
<div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;     ((dimen==2)&amp;&amp;(dirsign==1) &amp;&amp;(<a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[dimen]+jj==<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[dimen])  &amp;&amp; (pp==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a5b4b42f50fd7667c7d22d8001811bc7e">FACE2</a> || pp==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a1068bcf25c9f187a8db0f422e0af64c8">CORN1</a> || pp==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a1a05e117efd4dbc39b7c590141004470">CORN3</a> || pp==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aca28d3c01bd5d2739e54d08b3336c54a">CORNT</a>))||</div>
<div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;     ((dimen==3)&amp;&amp;(dirsign==-1)&amp;&amp;(<a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[dimen]+kk==0)                 &amp;&amp; (pp==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a630fdcefb04bdca66118cfd21476e8fd">FACE3</a> || pp==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ab10e4ab484f1edd4cecb418ff22a743a">CORN2</a> || pp==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a1068bcf25c9f187a8db0f422e0af64c8">CORN1</a> || pp==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aca28d3c01bd5d2739e54d08b3336c54a">CORNT</a>))||</div>
<div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;     ((dimen==3)&amp;&amp;(dirsign==1) &amp;&amp;(<a class="code" href="../../dd/d46/mpidefs_8h.html#a23649bd7d99c7d81c59db19199e2f11d">startpos</a>[dimen]+kk==<a class="code" href="../../dd/d46/mpidefs_8h.html#ab3efab8b1f2dffc5907e0b0a5aa3988f">totalsize</a>[dimen])  &amp;&amp; (pp==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a630fdcefb04bdca66118cfd21476e8fd">FACE3</a> || pp==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ab10e4ab484f1edd4cecb418ff22a743a">CORN2</a> || pp==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a1068bcf25c9f187a8db0f422e0af64c8">CORN1</a> || pp==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aca28d3c01bd5d2739e54d08b3336c54a">CORNT</a>))</div>
<div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;     ){</div>
<div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;    <span class="keywordflow">return</span>(1);</div>
<div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;  }</div>
<div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;</div>
<div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;}</div>
<div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;</div>
<div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;</div>
<div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;</div>
<div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;<span class="comment">// GODMARK: Should improve this.  Right now if I call coord_ijk and then immediately bl_coord_ijk and first time called, then expensive since coord() called twice</span></div>
<div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;<span class="comment">// NEVER CALL *_ijk_*() type functions if input i,j,k is meant to be related to total grid that would access beyond stored arrays</span></div>
<div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;</div>
<div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;</div>
<div class="line"><a name="l03932"></a><span class="lineno"><a class="code" href="../../d6/d85/coord_8funcdeclare_8h.html#a0672d8c0ee4ff07c7265d0ecbc365cdc"> 3932</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d9/de9/coord_8c.html#a0672d8c0ee4ff07c7265d0ecbc365cdc" title="normally-used dxdxp[i,j,k] = dV/dX">dxdxprim_ijk</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> loc, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*dxdxp)[NDIM])</div>
<div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;{</div>
<div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;  <span class="keywordtype">int</span> jj,kk;</div>
<div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> X[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>],V[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;</div>
<div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;  <span class="comment">//iglobal=i;</span></div>
<div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;  <span class="comment">//jglobal=j;</span></div>
<div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;  <span class="comment">//kglobal=k;</span></div>
<div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;  <span class="comment">//pglobal=loc;</span></div>
<div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;</div>
<div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;</div>
<div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a1ede5cdf31ba2dd54327d558e786f7d6">didstorepositiondata</a> &amp;&amp; loc!=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8bf292e53bd4a7ca0cf7b164daf1997a">NOWHERE</a>){</div>
<div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(jj,kk) dxdxp[jj][kk] = <a class="code" href="../../df/d1c/global_8storage_8h.html#a8c27ba787d80fbfe0fe30ade21ad5c0c">GLOBALMETMACP1A2</a>(dxdxpstore,loc,i,j,k,jj,kk);</div>
<div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;<span class="preprocessor">#if(PRODUCTION==0)</span></div>
<div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span>(i&lt;-N1BND || i&gt;<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>-1+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a2fb146af349ab49ff48fa36b12b9e4fe" title="x1">SHIFT1</a>+N1BND || j&lt;-N2BND || j&gt;<a class="code" href="../../da/d3e/definit_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a>-1+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a4601f340e88302d63182d0844c4e3c09" title="x2">SHIFT2</a>+N2BND || k&lt;-N3BND || k&gt;<a class="code" href="../../da/d3e/definit_8h.html#ad66109fbdc4d3adc9c3d6ff917038aef">N3</a>-1+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac3ff9bd198294b5b3a9c6a22b9cf456a" title="x3">SHIFT3</a>+N3BND){</div>
<div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;      dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Beyond stored location: %d %d %d\n&quot;</span>,i,j,k);</div>
<div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;      myexit(10365262);</div>
<div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;    }</div>
<div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;<span class="preprocessor"></span>  }</div>
<div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(loc!=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8bf292e53bd4a7ca0cf7b164daf1997a">NOWHERE</a>){</div>
<div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;    bl_coord_ijk_2(i, j, k, loc, X, V);</div>
<div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a64a4372100fc55abf546f02c8b779595" title="Jacobian for dx uniform per dx nonuniform (dx/dr / dx/dr&#39;) i.e.">dxdxprim</a>(X,V,dxdxp);</div>
<div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;  }</div>
<div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;dxdxprim_ijk(): No X to compute V or dxdxp ijk=%d %d %d loc=%d\n&quot;</span>,i,j,k,loc);</div>
<div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;    myexit(8813);</div>
<div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;  }</div>
<div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;</div>
<div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;}</div>
<div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;</div>
<div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;</div>
<div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;<span class="keywordtype">void</span> dxdxprim_ijk_2(<span class="keyword">struct</span> <a class="code" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae" title="typedef struct of_geom struct of_compgeom; force to be the same">of_geom</a> *ptrgeom, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *X, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *V, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*dxdxp)[NDIM])</div>
<div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;{</div>
<div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#ad21ff679aac3fe28202c6d592eafd3e6">i</a>,<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>,k,loc;</div>
<div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;  <span class="keywordtype">int</span> jj,kk;</div>
<div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;</div>
<div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;</div>
<div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;</div>
<div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;  i=ptrgeom-&gt;i;</div>
<div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;  j=ptrgeom-&gt;j;</div>
<div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;  k=ptrgeom-&gt;k;</div>
<div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;  loc=ptrgeom-&gt;p;</div>
<div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;</div>
<div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;  <span class="comment">//iglobal=i;</span></div>
<div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;  <span class="comment">//jglobal=j;</span></div>
<div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;  <span class="comment">//kglobal=k;</span></div>
<div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;  <span class="comment">//pglobal=loc;</span></div>
<div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;</div>
<div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;</div>
<div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a1ede5cdf31ba2dd54327d558e786f7d6">didstorepositiondata</a> &amp;&amp; loc!=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8bf292e53bd4a7ca0cf7b164daf1997a">NOWHERE</a>){</div>
<div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(jj,kk) dxdxp[jj][kk] = <a class="code" href="../../df/d1c/global_8storage_8h.html#a8c27ba787d80fbfe0fe30ade21ad5c0c">GLOBALMETMACP1A2</a>(dxdxpstore,loc,i,j,k,jj,kk);</div>
<div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;<span class="preprocessor">#if(PRODUCTION==0)</span></div>
<div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span>(i&lt;-N1BND || i&gt;<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>-1+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a2fb146af349ab49ff48fa36b12b9e4fe" title="x1">SHIFT1</a>+N1BND || j&lt;-N2BND || j&gt;<a class="code" href="../../da/d3e/definit_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a>-1+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a4601f340e88302d63182d0844c4e3c09" title="x2">SHIFT2</a>+N2BND || k&lt;-N3BND || k&gt;<a class="code" href="../../da/d3e/definit_8h.html#ad66109fbdc4d3adc9c3d6ff917038aef">N3</a>-1+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac3ff9bd198294b5b3a9c6a22b9cf456a" title="x3">SHIFT3</a>+N3BND){</div>
<div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;      dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Beyond stored location: %d %d %d\n&quot;</span>,i,j,k);</div>
<div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;      myexit(10365263);</div>
<div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;    }</div>
<div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;<span class="preprocessor"></span>  }</div>
<div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(loc!=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8bf292e53bd4a7ca0cf7b164daf1997a">NOWHERE</a>){</div>
<div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;    bl_coord_ijk_2(i, j, k, loc, X, V);</div>
<div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a64a4372100fc55abf546f02c8b779595" title="Jacobian for dx uniform per dx nonuniform (dx/dr / dx/dr&#39;) i.e.">dxdxprim</a>(X,V,dxdxp);</div>
<div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;  }</div>
<div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a64a4372100fc55abf546f02c8b779595" title="Jacobian for dx uniform per dx nonuniform (dx/dr / dx/dr&#39;) i.e.">dxdxprim</a>(X,V,dxdxp);</div>
<div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;  }</div>
<div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;</div>
<div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;}</div>
<div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;</div>
<div class="line"><a name="l04003"></a><span class="lineno"><a class="code" href="../../d6/d85/coord_8funcdeclare_8h.html#a8a51ec95e21441bc2c561af70a1037de"> 4003</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d9/de9/coord_8c.html#a8a51ec95e21441bc2c561af70a1037de" title="Get (dV/dX)^{-1}.">idxdxprim</a>(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*dxdxp)[NDIM], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*idxdxp)[NDIM])</div>
<div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;{</div>
<div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;</div>
<div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;  <a class="code" href="../../d6/d1b/metric_8tools_8c.html#af5438dd54272eb585ff5acb06d7195d4">matrix_inverse</a>(<a class="code" href="../../d2/dbf/metric_8h.html#a401668353c0216165cf6f1c7b2d34e94">PRIMECOORDS</a>, dxdxp,idxdxp);</div>
<div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;</div>
<div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;}</div>
<div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;</div>
<div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;</div>
<div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;</div>
<div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;</div>
<div class="line"><a name="l04014"></a><span class="lineno"><a class="code" href="../../d6/d85/coord_8funcdeclare_8h.html#a6b81e8ff9e3ef5fdf6eade928726f237"> 4014</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d9/de9/coord_8c.html#a6b81e8ff9e3ef5fdf6eade928726f237" title="normally-used dxdxp[i,j,k]">idxdxprim_ijk</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> loc, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*idxdxp)[NDIM])</div>
<div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;{</div>
<div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;  <span class="keywordtype">int</span> jj,kk;</div>
<div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> X[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>],V[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> dxdxp[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;</div>
<div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;  <span class="comment">//iglobal=i;</span></div>
<div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;  <span class="comment">//jglobal=j;</span></div>
<div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;  <span class="comment">//kglobal=k;</span></div>
<div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;  <span class="comment">//pglobal=loc;</span></div>
<div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;</div>
<div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;</div>
<div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a1ede5cdf31ba2dd54327d558e786f7d6">didstorepositiondata</a> &amp;&amp; loc!=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8bf292e53bd4a7ca0cf7b164daf1997a">NOWHERE</a>){</div>
<div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(jj,kk) idxdxp[jj][kk] = <a class="code" href="../../df/d1c/global_8storage_8h.html#a8c27ba787d80fbfe0fe30ade21ad5c0c">GLOBALMETMACP1A2</a>(idxdxpstore,loc,i,j,k,jj,kk);</div>
<div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;<span class="preprocessor">#if(PRODUCTION==0)</span></div>
<div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span>(i&lt;-N1BND || i&gt;<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>-1+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a2fb146af349ab49ff48fa36b12b9e4fe" title="x1">SHIFT1</a>+N1BND || j&lt;-N2BND || j&gt;<a class="code" href="../../da/d3e/definit_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a>-1+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a4601f340e88302d63182d0844c4e3c09" title="x2">SHIFT2</a>+N2BND || k&lt;-N3BND || k&gt;<a class="code" href="../../da/d3e/definit_8h.html#ad66109fbdc4d3adc9c3d6ff917038aef">N3</a>-1+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac3ff9bd198294b5b3a9c6a22b9cf456a" title="x3">SHIFT3</a>+N3BND){</div>
<div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;      dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Beyond stored location: %d %d %d\n&quot;</span>,i,j,k);</div>
<div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;      myexit(10365264);</div>
<div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;    }</div>
<div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;<span class="preprocessor"></span>  }</div>
<div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(loc!=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8bf292e53bd4a7ca0cf7b164daf1997a">NOWHERE</a>){</div>
<div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;    bl_coord_ijk_2(i, j, k, loc, X, V);</div>
<div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a64a4372100fc55abf546f02c8b779595" title="Jacobian for dx uniform per dx nonuniform (dx/dr / dx/dr&#39;) i.e.">dxdxprim</a>(X,V,dxdxp);</div>
<div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a8a51ec95e21441bc2c561af70a1037de" title="Get (dV/dX)^{-1}.">idxdxprim</a>(dxdxp,idxdxp);</div>
<div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;  }</div>
<div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;idxdxprim_ijk(): No X, V, or dxdxp to compute idxdxp\n&quot;</span>);</div>
<div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;    myexit(8814);</div>
<div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;  }</div>
<div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;</div>
<div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;}</div>
<div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;</div>
<div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;</div>
<div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;<span class="keywordtype">void</span> idxdxprim_ijk_2(<span class="keyword">struct</span> <a class="code" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae" title="typedef struct of_geom struct of_compgeom; force to be the same">of_geom</a> *ptrgeom, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *X, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *V, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*idxdxp)[NDIM])</div>
<div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;{</div>
<div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#ad21ff679aac3fe28202c6d592eafd3e6">i</a>,<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>,k,loc;</div>
<div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;  <span class="keywordtype">int</span> jj,kk;</div>
<div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> dxdxp[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;</div>
<div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;</div>
<div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;  i=ptrgeom-&gt;i;</div>
<div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;  j=ptrgeom-&gt;j;</div>
<div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;  k=ptrgeom-&gt;k;</div>
<div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;  loc=ptrgeom-&gt;p;</div>
<div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;</div>
<div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;  <span class="comment">//iglobal=i;</span></div>
<div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;  <span class="comment">//jglobal=j;</span></div>
<div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;  <span class="comment">//kglobal=k;</span></div>
<div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;  <span class="comment">//pglobal=loc;</span></div>
<div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;</div>
<div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;</div>
<div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a1ede5cdf31ba2dd54327d558e786f7d6">didstorepositiondata</a> &amp;&amp; loc!=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8bf292e53bd4a7ca0cf7b164daf1997a">NOWHERE</a>){</div>
<div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;    <span class="comment">// if here, don&#39;t assume X and V already set, so set them both:</span></div>
<div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;    bl_coord_ijk_2(ptrgeom-&gt;i,ptrgeom-&gt;j,ptrgeom-&gt;k,ptrgeom-&gt;p,X,V);</div>
<div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(jj,kk) idxdxp[jj][kk] = <a class="code" href="../../df/d1c/global_8storage_8h.html#a8c27ba787d80fbfe0fe30ade21ad5c0c">GLOBALMETMACP1A2</a>(idxdxpstore,loc,i,j,k,jj,kk);</div>
<div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;<span class="preprocessor">#if(PRODUCTION==0)</span></div>
<div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span>(i&lt;-N1BND || i&gt;<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>-1+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a2fb146af349ab49ff48fa36b12b9e4fe" title="x1">SHIFT1</a>+N1BND || j&lt;-N2BND || j&gt;<a class="code" href="../../da/d3e/definit_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a>-1+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a4601f340e88302d63182d0844c4e3c09" title="x2">SHIFT2</a>+N2BND || k&lt;-N3BND || k&gt;<a class="code" href="../../da/d3e/definit_8h.html#ad66109fbdc4d3adc9c3d6ff917038aef">N3</a>-1+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac3ff9bd198294b5b3a9c6a22b9cf456a" title="x3">SHIFT3</a>+N3BND){</div>
<div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;      dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Beyond stored location: %d %d %d\n&quot;</span>,i,j,k);</div>
<div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;      myexit(10365265);</div>
<div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;    }</div>
<div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;<span class="preprocessor"></span>  }</div>
<div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(loc!=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8bf292e53bd4a7ca0cf7b164daf1997a">NOWHERE</a>){</div>
<div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;    <span class="comment">// then assume ptrgeom-&gt;{i,j,k} is good for ptrgeom-&gt;p</span></div>
<div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;    bl_coord_ijk_2(ptrgeom-&gt;i,ptrgeom-&gt;j,ptrgeom-&gt;k,ptrgeom-&gt;p,X,V);</div>
<div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a64a4372100fc55abf546f02c8b779595" title="Jacobian for dx uniform per dx nonuniform (dx/dr / dx/dr&#39;) i.e.">dxdxprim</a>(X,V,dxdxp);</div>
<div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a8a51ec95e21441bc2c561af70a1037de" title="Get (dV/dX)^{-1}.">idxdxprim</a>(dxdxp,idxdxp);</div>
<div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;  }</div>
<div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;    <span class="comment">// if idxdxprim_ijk_2 is called, assume fed in X and V already</span></div>
<div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a64a4372100fc55abf546f02c8b779595" title="Jacobian for dx uniform per dx nonuniform (dx/dr / dx/dr&#39;) i.e.">dxdxprim</a>(X,V,dxdxp);</div>
<div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a8a51ec95e21441bc2c561af70a1037de" title="Get (dV/dX)^{-1}.">idxdxprim</a>(dxdxp,idxdxp);</div>
<div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;  }</div>
<div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;</div>
<div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;}</div>
<div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;</div>
<div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;</div>
<div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;</div>
<div class="line"><a name="l04098"></a><span class="lineno"><a class="code" href="../../d6/d85/coord_8funcdeclare_8h.html#a96290375e27d5d0aa4d843b07e228e14"> 4098</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d9/de9/coord_8c.html#a96290375e27d5d0aa4d843b07e228e14" title="normally-used bl_coord[i,j,k] {i,j,k} -&gt; V only">bl_coord_ijk</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> loc, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *V)</div>
<div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;{</div>
<div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;  <span class="keywordtype">int</span> jj;</div>
<div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> X[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;</div>
<div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;  <span class="comment">//iglobal=i;</span></div>
<div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;  <span class="comment">//jglobal=j;</span></div>
<div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;  <span class="comment">//kglobal=k;</span></div>
<div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;  <span class="comment">//pglobal=loc;</span></div>
<div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;</div>
<div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;  </div>
<div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;</div>
<div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a1ede5cdf31ba2dd54327d558e786f7d6">didstorepositiondata</a> &amp;&amp; loc!=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8bf292e53bd4a7ca0cf7b164daf1997a">NOWHERE</a>){</div>
<div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(jj) V[jj] = <a class="code" href="../../df/d1c/global_8storage_8h.html#ad72b4d1450b9b8c3abdcf9fb88acfba9">GLOBALMACP1A1</a>(Vstore,loc,i,j,k,jj);</div>
<div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;<span class="preprocessor">#if(PRODUCTION==0)</span></div>
<div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span>(i&lt;-N1BND-SHIFT1 || i&gt;<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>-1+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a2fb146af349ab49ff48fa36b12b9e4fe" title="x1">SHIFT1</a>*2+N1BND || j&lt;-N2BND-SHIFT2 || j&gt;<a class="code" href="../../da/d3e/definit_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a>-1+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a4601f340e88302d63182d0844c4e3c09" title="x2">SHIFT2</a>*2+N2BND || k&lt;-N3BND-SHIFT3 || k&gt;<a class="code" href="../../da/d3e/definit_8h.html#ad66109fbdc4d3adc9c3d6ff917038aef">N3</a>-1+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac3ff9bd198294b5b3a9c6a22b9cf456a" title="x3">SHIFT3</a>*2+N3BND){</div>
<div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;      dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Beyond stored location: %d %d %d\n&quot;</span>,i,j,k);</div>
<div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;      myexit(10365266);</div>
<div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;    }</div>
<div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;<span class="preprocessor"></span>    V[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a08ca909b46b12e894320afaabce3056e" title="time period between dumps for various types of dumps NO, use &quot;DUMPTYPE&quot; names now">TT</a>]=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0606a9242a6f0be89cdf25ca20e90090">Xmetricnew</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a08ca909b46b12e894320afaabce3056e" title="time period between dumps for various types of dumps NO, use &quot;DUMPTYPE&quot; names now">TT</a>];</div>
<div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;  }</div>
<div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(loc!=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8bf292e53bd4a7ca0cf7b164daf1997a">NOWHERE</a>){</div>
<div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a041e7b005310415c97d90f4b8521ed1a" title="get X(i,j,k) CENT is default position in degenerate cases">coord</a>(i, j, k, loc, X);</div>
<div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a65ad4ca9656d141cc995fd35ed31dc40" title="Returns boyer-lindquist coordinte of point.">bl_coord</a>(X,V);</div>
<div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;  }</div>
<div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;bl_coord_ijk(): No X to compute V : ijk=%d %d %d loc=%d\n&quot;</span>,i,j,k,loc);</div>
<div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;    myexit(8815);</div>
<div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;  }</div>
<div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;</div>
<div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;</div>
<div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;}</div>
<div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;</div>
<div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;<span class="keywordtype">void</span> bl_coord_ijk_2(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> loc, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *X, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *V)</div>
<div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;{</div>
<div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;  <span class="keywordtype">int</span> jj;</div>
<div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;</div>
<div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;  <span class="comment">//iglobal=i;</span></div>
<div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;  <span class="comment">//jglobal=j;</span></div>
<div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;  <span class="comment">//kglobal=k;</span></div>
<div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;  <span class="comment">//pglobal=loc;</span></div>
<div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;</div>
<div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;  </div>
<div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;  <span class="comment">//  dualfprintf(fail_file,&quot;i=%d didstorepositiondata=%d loc=%d\n&quot;,i,didstorepositiondata,loc);</span></div>
<div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;</div>
<div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a1ede5cdf31ba2dd54327d558e786f7d6">didstorepositiondata</a> &amp;&amp; loc!=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8bf292e53bd4a7ca0cf7b164daf1997a">NOWHERE</a>){</div>
<div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;</div>
<div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a1e1d4fd69f1234cb8751c4ea66297995" title="normally-used bl_coord[i,j,k] {i,j,k} -&gt; X only">coord_ijk</a>(i,j,k,loc,X); <span class="comment">// get X</span></div>
<div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;</div>
<div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(jj) V[jj] = <a class="code" href="../../df/d1c/global_8storage_8h.html#ad72b4d1450b9b8c3abdcf9fb88acfba9">GLOBALMACP1A1</a>(Vstore,loc,i,j,k,jj);</div>
<div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;<span class="preprocessor">#if(PRODUCTION==0)</span></div>
<div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span>(i&lt;-N1BND-SHIFT1 || i&gt;<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>-1+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a2fb146af349ab49ff48fa36b12b9e4fe" title="x1">SHIFT1</a>*2+N1BND || j&lt;-N2BND-SHIFT2 || j&gt;<a class="code" href="../../da/d3e/definit_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a>-1+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a4601f340e88302d63182d0844c4e3c09" title="x2">SHIFT2</a>*2+N2BND || k&lt;-N3BND-SHIFT3 || k&gt;<a class="code" href="../../da/d3e/definit_8h.html#ad66109fbdc4d3adc9c3d6ff917038aef">N3</a>-1+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac3ff9bd198294b5b3a9c6a22b9cf456a" title="x3">SHIFT3</a>*2+N3BND){</div>
<div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;      dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Beyond stored location: %d %d %d\n&quot;</span>,i,j,k);</div>
<div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;      myexit(10365267);</div>
<div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;    }</div>
<div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;<span class="preprocessor"></span>    V[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a08ca909b46b12e894320afaabce3056e" title="time period between dumps for various types of dumps NO, use &quot;DUMPTYPE&quot; names now">TT</a>]=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0606a9242a6f0be89cdf25ca20e90090">Xmetricnew</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a08ca909b46b12e894320afaabce3056e" title="time period between dumps for various types of dumps NO, use &quot;DUMPTYPE&quot; names now">TT</a>];  <span class="comment">// not really true, but dont use V[TT] yet</span></div>
<div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;  }</div>
<div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(loc!=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8bf292e53bd4a7ca0cf7b164daf1997a">NOWHERE</a>){</div>
<div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;    <span class="comment">// Assume X is output, not input, if using bl_coord_ijk_?.  If didn&#39;t know i,j,k, then would have been forced to use bl_coord(X,V) anyways.</span></div>
<div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a041e7b005310415c97d90f4b8521ed1a" title="get X(i,j,k) CENT is default position in degenerate cases">coord</a>(i,j,k,loc,X);</div>
<div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a65ad4ca9656d141cc995fd35ed31dc40" title="Returns boyer-lindquist coordinte of point.">bl_coord</a>(X,V);</div>
<div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;  }</div>
<div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;    <span class="comment">// then must use X directly</span></div>
<div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a65ad4ca9656d141cc995fd35ed31dc40" title="Returns boyer-lindquist coordinte of point.">bl_coord</a>(X,V);</div>
<div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;    <span class="comment">// if really NOWHERE, then not associated with i,j,k at all, so can&#39;t use coord() to get X, so shouldn&#39;t be using bl_coord_ijk_2() in first place.  But assume X is already set</span></div>
<div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;  }</div>
<div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;</div>
<div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;</div>
<div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;}</div>
<div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;</div>
<div class="line"><a name="l04176"></a><span class="lineno"><a class="code" href="../../d6/d85/coord_8funcdeclare_8h.html#a8c24ff6f907fe950467425a020efd62d"> 4176</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d9/de9/coord_8c.html#a8c24ff6f907fe950467425a020efd62d" title="normally-used bl_coord[i,j,k] returns both X and V given i,j,k,loc and does NOT try to use stored mem...">bl_coord_coord</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> loc, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *X, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *V)</div>
<div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;{</div>
<div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;  </div>
<div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;  <a class="code" href="../../d9/de9/coord_8c.html#a041e7b005310415c97d90f4b8521ed1a" title="get X(i,j,k) CENT is default position in degenerate cases">coord</a>(i,j,k,loc,X);</div>
<div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;  <a class="code" href="../../d9/de9/coord_8c.html#a65ad4ca9656d141cc995fd35ed31dc40" title="Returns boyer-lindquist coordinte of point.">bl_coord</a>(X,V);</div>
<div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;</div>
<div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;}</div>
<div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;</div>
<div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;</div>
<div class="line"><a name="l04187"></a><span class="lineno"><a class="code" href="../../d6/d85/coord_8funcdeclare_8h.html#a1e1d4fd69f1234cb8751c4ea66297995"> 4187</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d9/de9/coord_8c.html#a1e1d4fd69f1234cb8751c4ea66297995" title="normally-used bl_coord[i,j,k] {i,j,k} -&gt; X only">coord_ijk</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> loc, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *X)</div>
<div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;{</div>
<div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;  <span class="keywordtype">int</span> jj;</div>
<div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;</div>
<div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;  <span class="comment">//iglobal=i;</span></div>
<div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;  <span class="comment">//jglobal=j;</span></div>
<div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;  <span class="comment">//kglobal=k;</span></div>
<div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;  <span class="comment">//pglobal=loc;</span></div>
<div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;</div>
<div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;  </div>
<div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a1ede5cdf31ba2dd54327d558e786f7d6">didstorepositiondata</a> &amp;&amp; loc!=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8bf292e53bd4a7ca0cf7b164daf1997a">NOWHERE</a>){</div>
<div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(jj) X[jj] = <a class="code" href="../../df/d1c/global_8storage_8h.html#ad72b4d1450b9b8c3abdcf9fb88acfba9">GLOBALMACP1A1</a>(Xstore,loc,i,j,k,jj);</div>
<div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;<span class="preprocessor">#if(PRODUCTION==0)</span></div>
<div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span>(i&lt;-N1BND-SHIFT1 || i&gt;<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>-1+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a2fb146af349ab49ff48fa36b12b9e4fe" title="x1">SHIFT1</a>*2+N1BND || j&lt;-N2BND-SHIFT2 || j&gt;<a class="code" href="../../da/d3e/definit_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a>-1+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a4601f340e88302d63182d0844c4e3c09" title="x2">SHIFT2</a>*2+N2BND || k&lt;-N3BND-SHIFT3 || k&gt;<a class="code" href="../../da/d3e/definit_8h.html#ad66109fbdc4d3adc9c3d6ff917038aef">N3</a>-1+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac3ff9bd198294b5b3a9c6a22b9cf456a" title="x3">SHIFT3</a>*2+N3BND){</div>
<div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;      dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Beyond stored location: %d %d %d\n&quot;</span>,i,j,k);</div>
<div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;      myexit(10365268);</div>
<div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;    }</div>
<div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;<span class="preprocessor"></span>    <span class="comment">// time is not constant</span></div>
<div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;    X[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a08ca909b46b12e894320afaabce3056e" title="time period between dumps for various types of dumps NO, use &quot;DUMPTYPE&quot; names now">TT</a>] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#a0606a9242a6f0be89cdf25ca20e90090">Xmetricnew</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a08ca909b46b12e894320afaabce3056e" title="time period between dumps for various types of dumps NO, use &quot;DUMPTYPE&quot; names now">TT</a>];</div>
<div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;  }</div>
<div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(loc!=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a8bf292e53bd4a7ca0cf7b164daf1997a">NOWHERE</a>){</div>
<div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;    <span class="comment">// coord must use i,j,k, so always safe for any loc?</span></div>
<div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a041e7b005310415c97d90f4b8521ed1a" title="get X(i,j,k) CENT is default position in degenerate cases">coord</a>(i, j, k, loc, X);</div>
<div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;  }</div>
<div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;coord_ijk() NOWHERE: Can&#39;t use loc=%d to compute X\n&quot;</span>,loc);</div>
<div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;    myexit(8816);</div>
<div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;  }</div>
<div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;</div>
<div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;</div>
<div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;}</div>
<div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;</div>
<div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;</div>
<div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;</div>
<div class="line"><a name="l04224"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a29da697fcb21f44540180bbdb9c91186"> 4224</a></span>&#160;<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a29da697fcb21f44540180bbdb9c91186" title="smooth step function: Ftr = 0 if x &lt; 0, Ftr = 1 if x &gt; 1 and smoothly interps.">Ftr</a>( <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> x )</div>
<div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;{</div>
<div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> res;</div>
<div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;</div>
<div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;  <span class="keywordflow">if</span>( x &lt;= 0 ) {</div>
<div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;    res = 0;</div>
<div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;  }</div>
<div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>( x &gt;= 1 ) {</div>
<div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;    res = 1;</div>
<div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;  }</div>
<div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;    res = (64 + cos(5*M_PI*x) + 70*sin((M_PI*(-1 + 2*x))/2.) + 5*sin((3*M_PI*(-1 + 2*x))/2.))/128.;</div>
<div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;  }</div>
<div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;</div>
<div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;  <span class="keywordflow">return</span>( res );</div>
<div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;}</div>
<div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;</div>
<div class="line"><a name="l04241"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a617a8a29249932055f80963f4af93d23"> 4241</a></span>&#160;<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a617a8a29249932055f80963f4af93d23">Ftrgenlin</a>( <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> x, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> xa, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> xb, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> ya, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> yb )</div>
<div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;{</div>
<div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a29da697fcb21f44540180bbdb9c91186" title="smooth step function: Ftr = 0 if x &lt; 0, Ftr = 1 if x &gt; 1 and smoothly interps.">Ftr</a>( <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> x );</div>
<div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> res;</div>
<div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;</div>
<div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;  res = (x*ya)/xa + (-((x*ya)/xa) + ((x - xb)*(1 - yb))/(1 - xb) + yb)*<a class="code" href="../../d9/de9/coord_8c.html#a29da697fcb21f44540180bbdb9c91186" title="smooth step function: Ftr = 0 if x &lt; 0, Ftr = 1 if x &gt; 1 and smoothly interps.">Ftr</a>((x - xa)/(-xa + xb));</div>
<div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;  </div>
<div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;  <span class="keywordflow">return</span>( res );</div>
<div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;}</div>
<div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;</div>
<div class="line"><a name="l04251"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#aeb2e04dce7e492b341f52ddd5b134f8b"> 4251</a></span>&#160;<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#aeb2e04dce7e492b341f52ddd5b134f8b">Ftrgen</a>( <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> x, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> xa, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> xb, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> ya, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> yb )</div>
<div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;{</div>
<div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a29da697fcb21f44540180bbdb9c91186" title="smooth step function: Ftr = 0 if x &lt; 0, Ftr = 1 if x &gt; 1 and smoothly interps.">Ftr</a>( <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> x );</div>
<div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> res;</div>
<div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;</div>
<div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;  res = ya + (yb-ya)*<a class="code" href="../../d9/de9/coord_8c.html#a29da697fcb21f44540180bbdb9c91186" title="smooth step function: Ftr = 0 if x &lt; 0, Ftr = 1 if x &gt; 1 and smoothly interps.">Ftr</a>( (x-xa)/(xb-xa) );</div>
<div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;  </div>
<div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;  <span class="keywordflow">return</span>( res );</div>
<div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;}</div>
<div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;</div>
<div class="line"><a name="l04261"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a3038355b0f82e19ac34911b015a2828a"> 4261</a></span>&#160;<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a3038355b0f82e19ac34911b015a2828a">Fangle</a>( <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> x )</div>
<div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;{</div>
<div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> res;</div>
<div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;</div>
<div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;  <span class="keywordflow">if</span>( x &lt;= -1 ) {</div>
<div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;    res = 0;</div>
<div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;  }</div>
<div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>( x &gt;= 1 ) {</div>
<div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;    res = x;</div>
<div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;  }</div>
<div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;    res = (1 + x + (-140*sin((M_PI*(1 + x))/2.) + (10*sin((3*M_PI*(1 + x))/2.))/3. + (2*sin((5*M_PI*(1 + x))/2.))/5.)/(64.*M_PI))/2.;</div>
<div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;  }</div>
<div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;</div>
<div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;  <span class="keywordflow">return</span>( res );</div>
<div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;  </div>
<div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;}</div>
<div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;</div>
<div class="line"><a name="l04279"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#aa1a68b393c2ada1f3abf179be623a83c"> 4279</a></span>&#160;<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#aa1a68b393c2ada1f3abf179be623a83c">limlin</a>( <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> x, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> x0, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> dxx, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> y0 )</div>
<div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;{</div>
<div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a3038355b0f82e19ac34911b015a2828a">Fangle</a>( <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> x );</div>
<div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;  <span class="keywordflow">return</span>( y0 - dxx * <a class="code" href="../../d9/de9/coord_8c.html#a3038355b0f82e19ac34911b015a2828a">Fangle</a>(-(x-x0)/dxx) );</div>
<div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;}</div>
<div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;</div>
<div class="line"><a name="l04285"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a59056786b13f7f91e4eddd7679b4c4e1"> 4285</a></span>&#160;<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a59056786b13f7f91e4eddd7679b4c4e1">minlin</a>( <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> x, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> x0, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> dxx, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> y0 )</div>
<div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;{</div>
<div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a3038355b0f82e19ac34911b015a2828a">Fangle</a>( <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> x );</div>
<div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;  <span class="keywordflow">return</span>( y0 + dxx * <a class="code" href="../../d9/de9/coord_8c.html#a3038355b0f82e19ac34911b015a2828a">Fangle</a>((x-x0)/dxx) );</div>
<div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;}</div>
<div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;</div>
<div class="line"><a name="l04291"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a1f2270dea241e5cc21135803a397b7db"> 4291</a></span>&#160;<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a1f2270dea241e5cc21135803a397b7db">mins</a>( <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> f1, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> f2, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> df )</div>
<div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;{</div>
<div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#aa1a68b393c2ada1f3abf179be623a83c">limlin</a>( <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> x, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> x0, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> dxx, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> y0 );</div>
<div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;  <span class="keywordflow">return</span>( <a class="code" href="../../d9/de9/coord_8c.html#aa1a68b393c2ada1f3abf179be623a83c">limlin</a>(f1, f2, df, f2) );</div>
<div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;}</div>
<div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;</div>
<div class="line"><a name="l04297"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a88f9330b4045c924440d283f835c23c3"> 4297</a></span>&#160;<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a88f9330b4045c924440d283f835c23c3">maxs</a>( <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> f1, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> f2, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> df )</div>
<div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;{</div>
<div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a1f2270dea241e5cc21135803a397b7db">mins</a>( <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> f1, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> f2, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> df );</div>
<div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;  <span class="keywordflow">return</span>( -<a class="code" href="../../d9/de9/coord_8c.html#a1f2270dea241e5cc21135803a397b7db">mins</a>(-f1, -f2, df) );</div>
<div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;}</div>
<div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;</div>
<div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;</div>
<div class="line"><a name="l04306"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a423b0068484133016645a61602c58287"> 4306</a></span>&#160;<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a423b0068484133016645a61602c58287" title="=mins if dir &lt; 0 =maxs if dir &gt;= 0">minmaxs</a>( <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> f1, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> f2, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> df, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> dir )</div>
<div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;{</div>
<div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a1f2270dea241e5cc21135803a397b7db">mins</a>( <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> f1, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> f2, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> df );</div>
<div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a88f9330b4045c924440d283f835c23c3">maxs</a>( <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> f1, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> f2, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> df );</div>
<div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;  <span class="keywordflow">if</span>( dir&gt;=0 ) {</div>
<div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;    <span class="keywordflow">return</span>( <a class="code" href="../../d9/de9/coord_8c.html#a88f9330b4045c924440d283f835c23c3">maxs</a>(f1, f2, df) );</div>
<div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;  }</div>
<div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;  </div>
<div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;  <span class="keywordflow">return</span>( <a class="code" href="../../d9/de9/coord_8c.html#a1f2270dea241e5cc21135803a397b7db">mins</a>(f1, f2, df) );</div>
<div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;}</div>
<div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;</div>
<div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;<span class="keyword">static</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a293f69058a92329c99b1473740cccfeb" title="for sjet coords">sinth0</a>( <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *X0, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *X, <span class="keywordtype">void</span> (*vofx)(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>*, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>*) );</div>
<div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;<span class="keyword">static</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a678440e26c75d6a9079c656e2781167f" title="for sjet coords">sinth1in</a>( <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *X0, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *X, <span class="keywordtype">void</span> (*vofx)(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>*, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>*) );</div>
<div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;<span class="keyword">static</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a498d34d95c498dd3b01dbe334b1e05fd" title="for sjet coords">th2in</a>( <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *X0, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *X, <span class="keywordtype">void</span> (*vofx)(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>*, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>*) );</div>
<div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d9/de9/coord_8c.html#a1bde1dbe72804335be48e8d95bdd3832" title="for sjet coords Converts copies Xin to Xout and converts but sets Xout[2] to lie in the 1st quadrant...">to1stquadrant</a>( <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *Xin, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *Xout, <span class="keywordtype">int</span> *ismirrored );</div>
<div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160;<span class="keyword">static</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a204998f2813b14a00cd7e367bc11ea4b" title="for sjet coords">func1</a>( <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *X0, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *X,  <span class="keywordtype">void</span> (*vofx)(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>*, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>*) );</div>
<div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;<span class="keyword">static</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a903c2af253a5f2cac063d020db8f640d" title="for sjet coords">func2</a>( <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *X0, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *X,  <span class="keywordtype">void</span> (*vofx)(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>*, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>*) );</div>
<div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;</div>
<div class="line"><a name="l04328"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a1bde1dbe72804335be48e8d95bdd3832"> 4328</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d9/de9/coord_8c.html#a1bde1dbe72804335be48e8d95bdd3832" title="for sjet coords Converts copies Xin to Xout and converts but sets Xout[2] to lie in the 1st quadrant...">to1stquadrant</a>( <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *Xin, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *Xout, <span class="keywordtype">int</span> *ismirrored )</div>
<div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;{</div>
<div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> ntimes;</div>
<div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;  <span class="keywordtype">int</span> dim;</div>
<div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;  </div>
<div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(dim) Xout[dim] = Xin[dim];</div>
<div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;  </div>
<div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;  <span class="comment">//bring the angle variables to -2..2 (for X) and -2pi..2pi (for V)</span></div>
<div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;  ntimes = floor( (Xin[2]+2.0)/4.0 );</div>
<div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;  <span class="comment">//this forces -2 &lt; Xout[2] &lt; 2</span></div>
<div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;  Xout[2] -= 4 * ntimes;</div>
<div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;  </div>
<div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;  *ismirrored = 0;</div>
<div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;  </div>
<div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;  <span class="keywordflow">if</span>( Xout[2] &gt; 0. ) {</div>
<div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;    Xout[2] = -Xout[2];</div>
<div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;    *ismirrored = 1-*ismirrored;</div>
<div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;  }    </div>
<div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;</div>
<div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;  <span class="comment">//now force -1 &lt; Xout[2] &lt; 0</span></div>
<div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;  <span class="keywordflow">if</span>( Xout[2] &lt; -1. ) {</div>
<div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;    Xout[2] = -2. - Xout[2];</div>
<div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;    *ismirrored = 1-*ismirrored;</div>
<div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;  }</div>
<div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;}</div>
<div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;</div>
<div class="line"><a name="l04355"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a293f69058a92329c99b1473740cccfeb"> 4355</a></span>&#160;<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a293f69058a92329c99b1473740cccfeb" title="for sjet coords">sinth0</a>( <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *X0, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *X, <span class="keywordtype">void</span> (*vofx)(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>*, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>*) )</div>
<div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;{</div>
<div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> V0[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> Vc0[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> Xc0[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;  <span class="keywordtype">int</span> dim;</div>
<div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;  </div>
<div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;  <span class="comment">//X1 = {0, X[1], X0[1], 0}</span></div>
<div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(dim) Xc0[dim] = X[dim];</div>
<div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;  Xc0[2] = X0[2];</div>
<div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;  </div>
<div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;  vofx( Xc0, Vc0 );</div>
<div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;  vofx( X0, V0 );</div>
<div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;  </div>
<div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;  </div>
<div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;  <span class="keywordflow">return</span>( V0[1] * sin(V0[2]) / Vc0[1] );</div>
<div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;}</div>
<div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;</div>
<div class="line"><a name="l04374"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a678440e26c75d6a9079c656e2781167f"> 4374</a></span>&#160;<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a678440e26c75d6a9079c656e2781167f" title="for sjet coords">sinth1in</a>( <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *X0, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *X, <span class="keywordtype">void</span> (*vofx)(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>*, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>*) )</div>
<div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;{</div>
<div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> V[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> V0[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> V0c[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> X0c[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;  <span class="keywordtype">int</span> dim;</div>
<div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;  </div>
<div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;  <span class="comment">//X1 = {0, X[1], X0[1], 0}</span></div>
<div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(dim) X0c[dim] = X0[dim];</div>
<div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;  X0c[2] = X[2];</div>
<div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;  </div>
<div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;  vofx( X, V );</div>
<div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;  vofx( X0c, V0c );</div>
<div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;  vofx( X0, V0 );</div>
<div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160;  </div>
<div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160;  <span class="keywordflow">return</span>( V0[1] * sin(V0c[2]) / V[1] );</div>
<div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160;}</div>
<div class="line"><a name="l04392"></a><span class="lineno"> 4392</span>&#160;</div>
<div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160;</div>
<div class="line"><a name="l04395"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a498d34d95c498dd3b01dbe334b1e05fd"> 4395</a></span>&#160;<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a498d34d95c498dd3b01dbe334b1e05fd" title="for sjet coords">th2in</a>( <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *X0, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *X, <span class="keywordtype">void</span> (*vofx)(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>*, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>*) )</div>
<div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;{</div>
<div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> V[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> V0[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> Vc0[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> Xc0[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> Xcmid[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> Vcmid[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;  <span class="keywordtype">int</span> dim;</div>
<div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> res;</div>
<div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> th0;</div>
<div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;  </div>
<div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(dim) Xc0[dim] = X[dim];</div>
<div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;  Xc0[2] = X0[2];</div>
<div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;  vofx( Xc0, Vc0 ); </div>
<div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;  </div>
<div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(dim) Xcmid[dim] = X[dim];</div>
<div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;  Xcmid[2] = 0;</div>
<div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;  vofx( Xcmid, Vcmid ); </div>
<div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160;</div>
<div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160;  vofx( X0, V0 ); </div>
<div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;  vofx( X, V ); </div>
<div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;  </div>
<div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;  th0 = asin( <a class="code" href="../../d9/de9/coord_8c.html#a293f69058a92329c99b1473740cccfeb" title="for sjet coords">sinth0</a>(X0, X, vofx) );</div>
<div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;  </div>
<div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;  res = (V[2] - Vc0[2])/(Vcmid[2] - Vc0[2]) * (Vcmid[2]-th0) + th0;</div>
<div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;  </div>
<div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160;  <span class="keywordflow">return</span>( res );</div>
<div class="line"><a name="l04423"></a><span class="lineno"> 4423</span>&#160;}</div>
<div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;</div>
<div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;<span class="keywordtype">void</span> vofx_cylindrified( <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *Xin, <span class="keywordtype">void</span> (*vofx)(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>*, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>*), <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *Vout )</div>
<div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;{</div>
<div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> npiovertwos;</div>
<div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> X[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>], V[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> Vin[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> X0[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>], V0[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> Xtr[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>], Vtr[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> f1, f2, dftr;</div>
<div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> sinth, th;</div>
<div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;  <span class="keywordtype">int</span> dim, ismirrored;</div>
<div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160;  </div>
<div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160;  vofx( Xin, Vin );</div>
<div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160;</div>
<div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;  <span class="comment">// BRING INPUT TO 1ST QUADRANT:  X[2] \in [-1 and 0]</span></div>
<div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;  <a class="code" href="../../d9/de9/coord_8c.html#a1bde1dbe72804335be48e8d95bdd3832" title="for sjet coords Converts copies Xin to Xout and converts but sets Xout[2] to lie in the 1st quadrant...">to1stquadrant</a>( Xin, X, &amp;ismirrored );  </div>
<div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;  vofx( X, V );</div>
<div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;</div>
<div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;  <span class="comment">//initialize X0: cylindrify region</span></div>
<div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;  <span class="comment">//X[1] &lt; X0[1] &amp;&amp; X[2] &lt; X0[2] (value of X0[3] not used)</span></div>
<div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;  X0[0] = Xin[0];</div>
<div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;  X0[1] = <a class="code" href="../../d9/de9/coord_8c.html#a7c9ef3dd93e82818da1c93b9d159483d">x10</a>;</div>
<div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;  X0[2] = <a class="code" href="../../d9/de9/coord_8c.html#a3b4850579b329099634861408a9e25df">x20</a>;</div>
<div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;  X0[3] = 0;</div>
<div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160;  vofx( X0, V0 );</div>
<div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160;  </div>
<div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160;  <span class="comment">//{0, roughly midpoint between grid origin and x10, -1, 0}</span></div>
<div class="line"><a name="l04457"></a><span class="lineno"> 4457</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(dim) Xtr[dim] = X[dim];</div>
<div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160;  Xtr[1] = log( 0.5*( exp(X0[1])+exp(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ac886aed06ffd7de9e67227db5502ff97">startx</a>[1]) ) );   <span class="comment">//always bound to be between startx[1] and X0[1]</span></div>
<div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;  vofx( Xtr, Vtr );</div>
<div class="line"><a name="l04460"></a><span class="lineno"> 4460</span>&#160;</div>
<div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;  f1 = <a class="code" href="../../d9/de9/coord_8c.html#a204998f2813b14a00cd7e367bc11ea4b" title="for sjet coords">func1</a>( X0, X, vofx );</div>
<div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160;  f2 = <a class="code" href="../../d9/de9/coord_8c.html#a903c2af253a5f2cac063d020db8f640d" title="for sjet coords">func2</a>( X0, X, vofx );</div>
<div class="line"><a name="l04463"></a><span class="lineno"> 4463</span>&#160;  dftr = <a class="code" href="../../d9/de9/coord_8c.html#a903c2af253a5f2cac063d020db8f640d" title="for sjet coords">func2</a>( X0, Xtr, vofx ) - <a class="code" href="../../d9/de9/coord_8c.html#a204998f2813b14a00cd7e367bc11ea4b" title="for sjet coords">func1</a>( X0, Xtr, vofx );</div>
<div class="line"><a name="l04464"></a><span class="lineno"> 4464</span>&#160;      </div>
<div class="line"><a name="l04465"></a><span class="lineno"> 4465</span>&#160;  <span class="comment">// Compute new theta</span></div>
<div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;  sinth = <a class="code" href="../../d9/de9/coord_8c.html#a88f9330b4045c924440d283f835c23c3">maxs</a>( V[1]*f1, V[1]*f2, Vtr[1]*fabs(dftr)+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a09c78d2f8feb311dd9fc969a0bf84979">SMALL</a> ) / V[1];</div>
<div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;  </div>
<div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160;  th = asin( sinth ); </div>
<div class="line"><a name="l04469"></a><span class="lineno"> 4469</span>&#160;  </div>
<div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;  <span class="comment">//initialize Vout with the original values</span></div>
<div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(dim) Vout[dim] = Vin[dim];</div>
<div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;</div>
<div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160;  <span class="comment">//apply change in theta in the original quadrant</span></div>
<div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160;  if( 0 == ismirrored ) {</div>
<div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160;    Vout[2] = Vin[2] + (th - V[2]);</div>
<div class="line"><a name="l04476"></a><span class="lineno"> 4476</span>&#160;  }</div>
<div class="line"><a name="l04477"></a><span class="lineno"> 4477</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04478"></a><span class="lineno"> 4478</span>&#160;    <span class="comment">//if mirrrored, flip the sign </span></div>
<div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160;    Vout[2] = Vin[2] - (th - V[2]);</div>
<div class="line"><a name="l04480"></a><span class="lineno"> 4480</span>&#160;  }</div>
<div class="line"><a name="l04481"></a><span class="lineno"> 4481</span>&#160;}</div>
<div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;</div>
<div class="line"><a name="l04484"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a204998f2813b14a00cd7e367bc11ea4b"> 4484</a></span>&#160;<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a204998f2813b14a00cd7e367bc11ea4b" title="for sjet coords">func1</a>( <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *X0, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *X,  <span class="keywordtype">void</span> (*vofx)(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>*, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>*) )</div>
<div class="line"><a name="l04485"></a><span class="lineno"> 4485</span>&#160;{</div>
<div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> V[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160;  </div>
<div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160;  vofx( X, V );</div>
<div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;  </div>
<div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;  <span class="keywordflow">return</span>( sin(V[2]) ); </div>
<div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160;}</div>
<div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;</div>
<div class="line"><a name="l04494"></a><span class="lineno"><a class="code" href="../../d9/de9/coord_8c.html#a903c2af253a5f2cac063d020db8f640d"> 4494</a></span>&#160;<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a903c2af253a5f2cac063d020db8f640d" title="for sjet coords">func2</a>( <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *X0, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *X,  <span class="keywordtype">void</span> (*vofx)(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>*, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>*) )</div>
<div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;{</div>
<div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> V[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> Xca[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d9/de9/coord_8c.html#a903c2af253a5f2cac063d020db8f640d" title="for sjet coords">func2</a>;</div>
<div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;  <span class="keywordtype">int</span> dim;</div>
<div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> sth1in, sth2in, sth1inaxis, sth2inaxis;</div>
<div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;  </div>
<div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;  <span class="comment">//{0, X[1], -1, 0}</span></div>
<div class="line"><a name="l04503"></a><span class="lineno"> 4503</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(dim) Xca[dim] = X[dim];</div>
<div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160;  Xca[2] = -1;</div>
<div class="line"><a name="l04505"></a><span class="lineno"> 4505</span>&#160;  </div>
<div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160;  vofx( X, V );</div>
<div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160;  </div>
<div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160;  sth1in = <a class="code" href="../../d9/de9/coord_8c.html#a678440e26c75d6a9079c656e2781167f" title="for sjet coords">sinth1in</a>( X0, X, vofx );</div>
<div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;  sth2in = sin( <a class="code" href="../../d9/de9/coord_8c.html#a498d34d95c498dd3b01dbe334b1e05fd" title="for sjet coords">th2in</a>(X0, X, vofx) );</div>
<div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;  </div>
<div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160;  sth1inaxis = <a class="code" href="../../d9/de9/coord_8c.html#a678440e26c75d6a9079c656e2781167f" title="for sjet coords">sinth1in</a>( X0, Xca, vofx );</div>
<div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;  sth2inaxis = sin( <a class="code" href="../../d9/de9/coord_8c.html#a498d34d95c498dd3b01dbe334b1e05fd" title="for sjet coords">th2in</a>(X0, Xca, vofx) );</div>
<div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160;  </div>
<div class="line"><a name="l04514"></a><span class="lineno"> 4514</span>&#160;  func2 = <a class="code" href="../../d9/de9/coord_8c.html#a423b0068484133016645a61602c58287" title="=mins if dir &lt; 0 =maxs if dir &gt;= 0">minmaxs</a>( sth1in, sth2in, fabs(sth2inaxis-sth1inaxis)+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a09c78d2f8feb311dd9fc969a0bf84979">SMALL</a>, X[1] - X0[1] );</div>
<div class="line"><a name="l04515"></a><span class="lineno"> 4515</span>&#160;  </div>
<div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160;  <span class="keywordflow">return</span>( func2 ); </div>
<div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160;}</div>
<div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160;</div>
<div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160;</div>
<div class="line"><a name="l04520"></a><span class="lineno"> 4520</span>&#160;</div>
<div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160;</div>
<div class="line"><a name="l04522"></a><span class="lineno"> 4522</span>&#160;</div>
<div class="line"><a name="l04523"></a><span class="lineno"> 4523</span>&#160;</div>
<div class="line"><a name="l04524"></a><span class="lineno"> 4524</span>&#160;</div>
<div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160;</div>
<div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;</div>
<div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160;</div>
<div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;</div>
<div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160;</div>
<div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160;</div>
<div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160;</div>
<div class="line"><a name="l04532"></a><span class="lineno"> 4532</span>&#160;</div>
<div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160;</div>
<div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160;</div>
<div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;</div>
<div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;</div>
<div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160;</div>
<div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160;</div>
<div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160;</div>
<div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;</div>
<div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160;</div>
<div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160;</div>
<div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160;</div>
<div class="line"><a name="l04544"></a><span class="lineno"> 4544</span>&#160;</div>
<div class="line"><a name="l04545"></a><span class="lineno"> 4545</span>&#160;</div>
<div class="line"><a name="l04546"></a><span class="lineno"> 4546</span>&#160;</div>
<div class="line"><a name="l04547"></a><span class="lineno"> 4547</span>&#160;</div>
<div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160;</div>
<div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;</div>
<div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160;</div>
<div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160;</div>
<div class="line"><a name="l04552"></a><span class="lineno"> 4552</span>&#160;</div>
<div class="line"><a name="l04553"></a><span class="lineno"> 4553</span>&#160;</div>
<div class="line"><a name="l04554"></a><span class="lineno"> 4554</span>&#160;</div>
<div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160;</div>
<div class="line"><a name="l04556"></a><span class="lineno"> 4556</span>&#160;</div>
<div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160;</div>
<div class="line"><a name="l04558"></a><span class="lineno"> 4558</span>&#160;</div>
<div class="line"><a name="l04559"></a><span class="lineno"> 4559</span>&#160;</div>
<div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160;</div>
<div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160;</div>
<div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160;</div>
<div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;</div>
<div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160;</div>
<div class="line"><a name="l04565"></a><span class="lineno"> 4565</span>&#160;</div>
<div class="line"><a name="l04566"></a><span class="lineno"> 4566</span>&#160;</div>
<div class="line"><a name="l04567"></a><span class="lineno"> 4567</span>&#160;</div>
<div class="line"><a name="l04568"></a><span class="lineno"> 4568</span>&#160;</div>
<div class="line"><a name="l04569"></a><span class="lineno"> 4569</span>&#160;</div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri May 20 2016 15:52:32 for HARM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.3.1
</small></address>
</body>
</html>
