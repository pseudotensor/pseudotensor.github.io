<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>HARM: step_ch.c Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">HARM
   </div>
   <div id="projectbrief">harm and utilities</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">step_ch.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d9/de0/step__ch_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &quot;decs.h&quot;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d9/de0/step__ch_8c.html#a3a2639f03dc596fb0eed62598b420880" title="Setup RK steps for the ith stage:">setup_rktimestep</a>(<span class="keywordtype">int</span> truestep, <span class="keywordtype">int</span> *numtimeorders,</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;                             <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pstag)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*ucons)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*vpot)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a1c452bce7a227fd9f2c8f937a3c7841c">SHIFTSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#adfe8c351b7f60e189dbd9bfca47af5c5">SHIFTSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a6dc540b0373d80d3ea2db53d03a9fa72">SHIFTSTORE3</a>], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*Bhat)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR],</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;                             <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pk)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR],</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;                             <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pii[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0a72db4856620ff1b9551c885f1b32b5">MAXTIMEORDER</a>])[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pbb[MAXTIMEORDER])[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pff[MAXTIMEORDER])[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR],</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;                             <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*uii[MAXTIMEORDER])[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*uff[MAXTIMEORDER])[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*ucum[MAXTIMEORDER])[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR],</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;                             <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*CUf)[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ab17e7e66eb2bc86b9d61d6bb61a0a4a3" title="NUMDTCUFS also includes what&#39;s necessary for IMEX.">NUMDTCUFS</a>],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*CUnew)[NUMDTCUFS]);</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/de0/step__ch_8c.html#a4c42d9adb1cef442b95fd62f99ee087a" title="things to do before taking a full timestep assume not called when dt==0.0">pre_stepch</a>(<span class="keywordtype">int</span> *dumpingnext, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*prim)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR]);</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/de0/step__ch_8c.html#af5697900c6e22d9c48ffdb8b59eb8384" title="things to do after taking a full timestep assume not called when dt==0.0">post_stepch</a>(<span class="keywordtype">int</span> *dumpingnext, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> fullndt, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*prim)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*ucons)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR]);</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself">step_ch</a>(<span class="keywordtype">int</span> truestep, <span class="keywordtype">int</span> *dumpingnext, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *fullndt,<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*prim)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pstag)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*ucons)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*vpot)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a1c452bce7a227fd9f2c8f937a3c7841c">SHIFTSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#adfe8c351b7f60e189dbd9bfca47af5c5">SHIFTSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a6dc540b0373d80d3ea2db53d03a9fa72">SHIFTSTORE3</a>], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*Bhat)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pl_ct)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR2INTERP], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pr_ct)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR2INTERP],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*F1)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*F2)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*F3)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*Atemp)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a1c452bce7a227fd9f2c8f937a3c7841c">SHIFTSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#adfe8c351b7f60e189dbd9bfca47af5c5">SHIFTSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a6dc540b0373d80d3ea2db53d03a9fa72">SHIFTSTORE3</a>],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*uconstemp)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR]);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/de0/step__ch_8c.html#ad36a0f9f915547477e3bb2405f8166b9" title="things to do after advance()">post_advance</a>(<span class="keywordtype">int</span> truestep, <span class="keywordtype">int</span> *dumpingnext, <span class="keywordtype">int</span> timeorder, <span class="keywordtype">int</span> numtimeorders, <span class="keywordtype">int</span> finalstep, <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> boundtime, <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> fluxtime, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pi)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pb)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pf)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pstag)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*ucons)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*vpot)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a1c452bce7a227fd9f2c8f937a3c7841c">SHIFTSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#adfe8c351b7f60e189dbd9bfca47af5c5">SHIFTSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a6dc540b0373d80d3ea2db53d03a9fa72">SHIFTSTORE3</a>],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*Bhat)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*F1)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*F2)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*F3)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*Atemp)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a1c452bce7a227fd9f2c8f937a3c7841c">SHIFTSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#adfe8c351b7f60e189dbd9bfca47af5c5">SHIFTSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a6dc540b0373d80d3ea2db53d03a9fa72">SHIFTSTORE3</a>], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*uconstemp)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR]);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div>
<div class="line"><a name="l00034"></a><span class="lineno"><a class="code" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf">   34</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d5/d2f/flux_8funcdeclare_8h.html#a306fe858d9befc91e386212efe65acaf" title="stepping">step_ch_full</a>(<span class="keywordtype">int</span> truestep, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*prim)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pstag)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*ucons)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*vpot)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a1c452bce7a227fd9f2c8f937a3c7841c">SHIFTSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#adfe8c351b7f60e189dbd9bfca47af5c5">SHIFTSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a6dc540b0373d80d3ea2db53d03a9fa72">SHIFTSTORE3</a>], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*Bhat)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pl_ct)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR2INTERP], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pr_ct)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR2INTERP],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*F1)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*F2)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*F3)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*Atemp)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a1c452bce7a227fd9f2c8f937a3c7841c">SHIFTSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#adfe8c351b7f60e189dbd9bfca47af5c5">SHIFTSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a6dc540b0373d80d3ea2db53d03a9fa72">SHIFTSTORE3</a>],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*uconstemp)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR])</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;{</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> fullndt;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="comment">// dumpingnext[0] = dumping just after this step</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="comment">// dumpingnext[1] = dumping just after the step after this step</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keywordtype">int</span> dumpingnext[2];</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="comment">// things to do before taking full step</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="keywordflow">if</span>(truestep) <a class="code" href="../../d9/de0/step__ch_8c.html#a4c42d9adb1cef442b95fd62f99ee087a" title="things to do before taking a full timestep assume not called when dt==0.0">pre_stepch</a>(dumpingnext,prim);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="comment">// take full step</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <a class="code" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself">step_ch</a>(truestep,dumpingnext, &amp;fullndt,prim,pstag,ucons,vpot,Bhat,pl_ct, pr_ct, F1, F2, F3,Atemp,uconstemp);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="comment">// things to do after taking full step</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="keywordflow">if</span>(truestep) <a class="code" href="../../d9/de0/step__ch_8c.html#af5697900c6e22d9c48ffdb8b59eb8384" title="things to do after taking a full timestep assume not called when dt==0.0">post_stepch</a>(dumpingnext, fullndt, prim, ucons);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keywordflow">if</span>(truestep){ <span class="comment">// don&#39;t do if just passing through -- otherwise would end up looping endlessly!</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="comment">// add up contributions to flux through horizon (really inner boundary)</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#a149d0d31999a38ec3870e1e4a4eecf67" title="careful not to use DOMIXTHETAPHI in .h files since init.h might change it.">DOEVOLVEMETRIC</a> &amp;&amp; (<a class="code" href="../../da/d3e/definit_8h.html#a8d133d1d94fabd8ad6975ca9bd7f9a27" title="0 = evolve only infrequently after many steps 1 = evolve on every substep in full RK form 2 = use acc...">EVOLVEMETRICSUBSTEP</a>==0 || <a class="code" href="../../da/d3e/definit_8h.html#a8d133d1d94fabd8ad6975ca9bd7f9a27" title="0 = evolve only infrequently after many steps 1 = evolve on every substep in full RK form 2 = use acc...">EVOLVEMETRICSUBSTEP</a>==2) ){</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      compute_new_metric_longsteps(prim,pstag,ucons,vpot,Bhat,pl_ct, pr_ct, F1, F2, F3,Atemp,uconstemp);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    }</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="comment">// below must come after longstep update so that don&#39;t change before metric step taken!</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    control_metric_update();</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    postdt(); <span class="comment">// here one can alter variables and try to restart, or implement any post step operations</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  }</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="comment">// must check before MPI operation (since asymmetries would desynchronize cpus)</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a0163a499c88dd8b07688e3dbd7007f0e">MYFUN</a>(error_check(2),<span class="stringliteral">&quot;main.c&quot;</span>,<span class="stringliteral">&quot;error_check&quot;</span>,1);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="comment">//^^ otherwise ok</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="comment">// eventually all cpus come here, either in failure mode or not, and cleanly tell others if failed/exit/dump/etc.</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;}</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div>
<div class="line"><a name="l00083"></a><span class="lineno"><a class="code" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8">   83</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself">step_ch</a>(<span class="keywordtype">int</span> truestep, <span class="keywordtype">int</span> *dumpingnext, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *fullndt,<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*prim)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pstag)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*ucons)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*vpot)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a1c452bce7a227fd9f2c8f937a3c7841c">SHIFTSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#adfe8c351b7f60e189dbd9bfca47af5c5">SHIFTSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a6dc540b0373d80d3ea2db53d03a9fa72">SHIFTSTORE3</a>], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*Bhat)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pl_ct)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR2INTERP], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pr_ct)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR2INTERP],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*F1)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*F2)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*F3)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*Atemp)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a1c452bce7a227fd9f2c8f937a3c7841c">SHIFTSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#adfe8c351b7f60e189dbd9bfca47af5c5">SHIFTSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a6dc540b0373d80d3ea2db53d03a9fa72">SHIFTSTORE3</a>],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*uconstemp)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR])</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;{</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin...">step_ch_simplempi</a>(<span class="keywordtype">int</span> truestep, <span class="keywordtype">int</span> *dumpingnext, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *fullndt,<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*prim)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pstag)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*ucons)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*vpot)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a1c452bce7a227fd9f2c8f937a3c7841c">SHIFTSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#adfe8c351b7f60e189dbd9bfca47af5c5">SHIFTSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a6dc540b0373d80d3ea2db53d03a9fa72">SHIFTSTORE3</a>], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*Bhat)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pl_ct)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR2INTERP], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pr_ct)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR2INTERP],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*F1)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*F2)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*F3)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*Atemp)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a1c452bce7a227fd9f2c8f937a3c7841c">SHIFTSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#adfe8c351b7f60e189dbd9bfca47af5c5">SHIFTSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a6dc540b0373d80d3ea2db53d03a9fa72">SHIFTSTORE3</a>],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*uconstemp)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR]);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="keywordtype">int</span> step_ch_supermpi(<span class="keywordtype">int</span> truestep, <span class="keywordtype">int</span> *dumpingnext, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *fullndt,<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*prim)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pstag)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*ucons)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*vpot)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a1c452bce7a227fd9f2c8f937a3c7841c">SHIFTSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#adfe8c351b7f60e189dbd9bfca47af5c5">SHIFTSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a6dc540b0373d80d3ea2db53d03a9fa72">SHIFTSTORE3</a>], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*Bhat)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pl_ct)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR2INTERP], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pr_ct)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR2INTERP],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*F1)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*F2)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*F3)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*Atemp)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a1c452bce7a227fd9f2c8f937a3c7841c">SHIFTSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#adfe8c351b7f60e189dbd9bfca47af5c5">SHIFTSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a6dc540b0373d80d3ea2db53d03a9fa72">SHIFTSTORE3</a>],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*uconstemp)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR]);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="preprocessor">#if(SIMULBCCALC==-1)</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="preprocessor"></span>  <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a0163a499c88dd8b07688e3dbd7007f0e">MYFUN</a>(<a class="code" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin...">step_ch_simplempi</a>(truestep, dumpingnext, fullndt,prim,pstag,ucons,vpot,Bhat,pl_ct, pr_ct,F1,F2,F3,Atemp,uconstemp),<span class="stringliteral">&quot;step_ch.c:step_ch()&quot;</span>, <span class="stringliteral">&quot;step_ch_simplempi()&quot;</span>, 1);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="preprocessor"></span>  <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a0163a499c88dd8b07688e3dbd7007f0e">MYFUN</a>(step_ch_supermpi(truestep, dumpingnext, fullndt,prim,pstag,ucons,vpot,Bhat,pl_ct, pr_ct,F1,F2,F3,Atemp,uconstemp),<span class="stringliteral">&quot;step_ch.c:step_ch()&quot;</span>, <span class="stringliteral">&quot;step_ch_supermpi()&quot;</span>, 1);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="comment">/* done! */</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="keywordflow">return</span> (0);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;}</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div>
<div class="line"><a name="l00105"></a><span class="lineno"><a class="code" href="../../d9/de0/step__ch_8c.html#a4c42d9adb1cef442b95fd62f99ee087a">  105</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d9/de0/step__ch_8c.html#a4c42d9adb1cef442b95fd62f99ee087a" title="things to do before taking a full timestep assume not called when dt==0.0">pre_stepch</a>(<span class="keywordtype">int</span> *dumpingnext, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*prim)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR])</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;{</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="preprocessor">#if(PRODUCTION==0)</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="preprocessor"></span>  trifprintf( <span class="stringliteral">&quot;\n#step=%ld&quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0b92e4d6197989f0f9b0609c8615a46f">realnstep</a>);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="comment">// if not doing diagnostics, then dumpingnext will be 0</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="comment">// first check if dumping next step</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="comment">// note dt is already set to correct value here</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  dumpingnext[0]=(<a class="code" href="../../d3/da1/diag_8c.html#a33d4865bef4d1e548c3d10b3839adf67" title="main diag() call for diagnostics OPENMPNOTE: Assume diag() not called by multiple threads...">diag</a>(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a9253dbbb23bc91ca3e15ccb9bc5c56cc">FUTURE_OUT</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>+<a class="code" href="../../d8/d5b/defs_8general_8h.html#a56db625f31229c5e8b208ff27d464931">dt</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a1a1088d87617078680f1fd0f0d707384">nstep</a>+1,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0b92e4d6197989f0f9b0609c8615a46f">realnstep</a>+1)==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a5a250d9181997aecbf9cf55228145fde" title="below should not be &gt;=0">DOINGFUTUREOUT</a>);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  dumpingnext[1]=(<a class="code" href="../../d3/da1/diag_8c.html#a33d4865bef4d1e548c3d10b3839adf67" title="main diag() call for diagnostics OPENMPNOTE: Assume diag() not called by multiple threads...">diag</a>(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a9253dbbb23bc91ca3e15ccb9bc5c56cc">FUTURE_OUT</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>+<a class="code" href="../../d8/d5b/defs_8general_8h.html#a56db625f31229c5e8b208ff27d464931">dt</a>+<a class="code" href="../../d8/d5b/defs_8general_8h.html#a56db625f31229c5e8b208ff27d464931">dt</a>/2,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a1a1088d87617078680f1fd0f0d707384">nstep</a>+2,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0b92e4d6197989f0f9b0609c8615a46f">realnstep</a>+2)==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a5a250d9181997aecbf9cf55228145fde" title="below should not be &gt;=0">DOINGFUTUREOUT</a>); <span class="comment">// estimate of t+dt+dt/2 good with 1&lt;SAFEFACTOR&lt;2</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="keywordflow">if</span>(dumpingnext[0] || dumpingnext[1]){</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="preprocessor">#if(CALCFARADAYANDCURRENTS)</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span>((<a class="code" href="../../da/d3e/definit_8h.html#a74985ff4d0f832956e97389873e29731">WHICHCURRENTCALC</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2e0b0bbda834334e507843bdd0718472" title="for WHICHCURRENTCALC 0: original time is on edge and spatial on edge, but spatials are different loca...">CURRENTCALC0</a>)||(<a class="code" href="../../da/d3e/definit_8h.html#a74985ff4d0f832956e97389873e29731">WHICHCURRENTCALC</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a02595a7fb5c0bff24672ef70afc374f6">CURRENTCALC2</a>)){</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <span class="comment">// for this method, all J components are located back in time</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      current_doprecalc(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a526b60e23f8603587743fd662455013e">CURTYPEX</a>,prim);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      current_doprecalc(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0ad9c88320c2d415738cdbe52dd57839">CURTYPEY</a>,prim);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      current_doprecalc(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a4541757ca92b743ff88ea353fe0bb887">CURTYPEZ</a>,prim);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      <span class="comment">// get faraday in case used for time averaging or dumping it</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      current_doprecalc(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a127d2636bce00224377a0d84fe478719">CURTYPEFARADAY</a>,prim);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="preprocessor"></span>  }</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;}</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div>
<div class="line"><a name="l00149"></a><span class="lineno"><a class="code" href="../../d9/de0/step__ch_8c.html#af5697900c6e22d9c48ffdb8b59eb8384">  149</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d9/de0/step__ch_8c.html#af5697900c6e22d9c48ffdb8b59eb8384" title="things to do after taking a full timestep assume not called when dt==0.0">post_stepch</a>(<span class="keywordtype">int</span> *dumpingnext, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> fullndt, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*prim)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*ucons)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR])</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;{</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="keywordflow">if</span>(dumpingnext[0]){</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="preprocessor">#if(CALCFARADAYANDCURRENTS)</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="preprocessor"></span>    <span class="comment">// compute final faradays</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#a74985ff4d0f832956e97389873e29731">WHICHCURRENTCALC</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a5f6a37039525c5ad846c4d2df03b3ae3">CURRENTCALC1</a>){</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      <span class="comment">// compute faraday components needed for time centering of J</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      current_doprecalc(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a273ed7511282d8abfa2e69104310fc7f">CURTYPET</a>,prim);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      <span class="comment">// J is located at this time</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      current_doprecalc(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a526b60e23f8603587743fd662455013e">CURTYPEX</a>,prim);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      current_doprecalc(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0ad9c88320c2d415738cdbe52dd57839">CURTYPEY</a>,prim);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      current_doprecalc(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a4541757ca92b743ff88ea353fe0bb887">CURTYPEZ</a>,prim);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      current_doprecalc(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a127d2636bce00224377a0d84fe478719">CURTYPEFARADAY</a>,prim); <span class="comment">// for diagnostics</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    }</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment">// compute current</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    current_calc(<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(cfaraday));</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="preprocessor"></span>  }</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="preprocessor">#if(ACCURATEDIAG==0)</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="preprocessor"></span>  <span class="comment">// compute flux diagnostics</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="comment">// this doesn&#39;t exactly make conservation work -- should have in middle step point using full step.  But if PARA, no middle point that&#39;s exact.</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="comment">// think about where to put this</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="comment">// GODMARK : use of globals</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  diag_flux(prim,F1, F2, F3, <a class="code" href="../../d8/d5b/defs_8general_8h.html#a56db625f31229c5e8b208ff27d464931">dt</a>); <span class="comment">// should use REAL dt, not within a timeorderd RK integration step</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="comment">//    horizon_flux(F1,dt); // subsumed</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="comment">// general flux only done on full steps since no requirement for accuracy and code can be expensive computationally</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  diag_flux_general(prim,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a56db625f31229c5e8b208ff27d464931">dt</a>);<span class="comment">// Should be full dt, not substep dt.</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#a6e256baea18bc9d8cc4ae78ec73d4886">DOONESTEPDUACCOUNTING</a>){</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="comment">// do one-step accounting for fixup related things (failures, floors, fixups, etc.)</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="comment">// ucons is in UEVOLVE form (originates from unewglobal in step_ch_full() called in main.c)</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    diag_fixup_allzones(prim, ucons);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  }</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="preprocessor">#if(PRODUCTION==0)</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="preprocessor"></span>  trifprintf( <span class="stringliteral">&quot;[d]&quot;</span>);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="comment">// increment time</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment"></span>  <a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a> += <a class="code" href="../../d8/d5b/defs_8general_8h.html#a56db625f31229c5e8b208ff27d464931">dt</a>;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a66ee7a124e4ae5f84428f69f625c8851">tstepparti</a> = <a class="code" href="../../d8/d5b/defs_8general_8h.html#a207dd7fd301c011f173d6cc43b5823c1">tsteppartf</a> = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a0b92e4d6197989f0f9b0609c8615a46f">realnstep</a>++;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <span class="comment">// set next timestep</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="comment">// Notes:</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <span class="comment">// </span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <span class="comment">// dt is computed in a few different places for different steps of the calculation:</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="comment">// 1) flux.c (per dimension over all cells):</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="comment">//    A) dtij = cour * dx[dir] / ctop;</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="comment">//    B) if (dtij &lt; *ndt){ *ndt = dtij; }</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="comment">// 2) advance.c: prepare_globaldt() (&quot;min&quot; over each dimension and operator):</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="comment">//    A) wavedt = 1. / (1. / ndt1 + 1. / ndt2 + 1. / ndt3);</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="comment">//    B) *ndt = defcon * MIN(wavedt , accdt);</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="comment">//    C) etc...</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="comment">// </span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="comment">// 3) step_ch.c:  (&quot;min&quot; over each substep of RK steps):</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="comment">//    A) step_ch_simplempi(): if(ndt&lt;lastndt) lastndt=ndt;</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="comment">//    B) HERE: to find global minimum over all CPUs</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="comment">//    C) HERE: to use safety factor</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="comment">//    D) HERE: constrain new dt if near end of calculation</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="comment">// But, should do #1&#39;s MIN over all cells per CPU and #3&#39;s global MIN over all CPUs together for perfect MPI consistency.</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="comment">//  Further, should compute &quot;wavedt&quot; per cell since otherwise non-local dt_i can impact minimum dt.  Can lead to dt smaller by as much as 3X (with no correct numerical method effect) !</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="comment">// </span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment"></span>  <span class="comment">// find global minimum value of ndt over all cpus</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  mpifmin(&amp;fullndt);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="comment">// note that this assignment to fullndt doesn&#39;t get returned outside function</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="keywordflow">if</span> (fullndt &gt; <a class="code" href="../../d8/d5b/defs_8general_8h.html#a73deb5caf870e00d9b50f194357000dd">SAFE</a> * <a class="code" href="../../d8/d5b/defs_8general_8h.html#a56db625f31229c5e8b208ff27d464931">dt</a>)    fullndt = <a class="code" href="../../d8/d5b/defs_8general_8h.html#a73deb5caf870e00d9b50f194357000dd">SAFE</a> * <a class="code" href="../../d8/d5b/defs_8general_8h.html#a56db625f31229c5e8b208ff27d464931">dt</a>;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  dt = fullndt;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="comment">// don&#39;t step beyond end of run</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment"></span>  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#aded151ceac3dfe5b3e913e1c42b3798a">onemorestep</a>){</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Got onemorestep dt=%g\n&quot;</span>,dt);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="comment">// check if previous step was onemorestep==1</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a0ecb55383085396667eb4792440ac75c">reallaststep</a>=1;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    dt=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a09c78d2f8feb311dd9fc969a0bf84979">SMALL</a>;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  }</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a> + dt &gt; <a class="code" href="../../d8/d5b/defs_8general_8h.html#a19a363a93267c97a3d521293fc39d942">tf</a>){</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Got t+dt&gt;tf : %g %g %g\n&quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>,dt,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a19a363a93267c97a3d521293fc39d942">tf</a>);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      dt = <a class="code" href="../../d8/d5b/defs_8general_8h.html#a19a363a93267c97a3d521293fc39d942">tf</a> - <a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#aded151ceac3dfe5b3e913e1c42b3798a">onemorestep</a>=1;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    }</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a> + dt == <a class="code" href="../../d8/d5b/defs_8general_8h.html#a19a363a93267c97a3d521293fc39d942">tf</a>){</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Got t+dt==tf : %g %g %g\n&quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>,dt,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a19a363a93267c97a3d521293fc39d942">tf</a>);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a0ecb55383085396667eb4792440ac75c">reallaststep</a>=1;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    }</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="comment">// make sure don&#39;t get pathological case of dt=0 on last step</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordflow">if</span>(dt&lt;<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a09c78d2f8feb311dd9fc969a0bf84979">SMALL</a>){</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Got dt&lt;SMALL : %g\n&quot;</span>,dt);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a0ecb55383085396667eb4792440ac75c">reallaststep</a>=1;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      dt=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a09c78d2f8feb311dd9fc969a0bf84979">SMALL</a>;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  }</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="keywordflow">if</span>(dt==0.0 &amp;&amp; <a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>&gt;=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a19a363a93267c97a3d521293fc39d942">tf</a>){</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="comment">// somehow got here, then finish</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;SOMEHOW GOT HERE\n&quot;</span>);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a0ecb55383085396667eb4792440ac75c">reallaststep</a>=1;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  }</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;}</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div>
<div class="line"><a name="l00296"></a><span class="lineno"><a class="code" href="../../d9/de0/step__ch_8c.html#a3b26d4bb7df497aa517553dc6decd60d">  296</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d9/de0/step__ch_8c.html#a3b26d4bb7df497aa517553dc6decd60d" title="things to do during substep before advance()">pre_advance</a>(<span class="keywordtype">int</span> timeorder, <span class="keywordtype">int</span> numtimeorders, <span class="keywordtype">int</span> finalstep, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pi)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pb)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pf)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR])</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;{</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <span class="comment">// prefixup</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment"></span><span class="preprocessor">#if(EOMTYPE!=EOMFFDE &amp;&amp; EOMTYPE!=EOMFFDE2)</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="preprocessor"></span>  <span class="comment">// force-free and cold GRMHD don&#39;t use pre_fixup, currently, even if could</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a0163a499c88dd8b07688e3dbd7007f0e">MYFUN</a>(pre_fixup(<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#affb13608b845e81f4595b80927fbedbd" title="for various uses (dumping and special boundary/comp interchange routine">STAGEM1</a>, pi),<span class="stringliteral">&quot;step_ch.c:step_ch_simple()&quot;</span>, <span class="stringliteral">&quot;pre_fixup()&quot;</span>, 1);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;}</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div>
<div class="line"><a name="l00321"></a><span class="lineno"><a class="code" href="../../d9/de0/step__ch_8c.html#ad36a0f9f915547477e3bb2405f8166b9">  321</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d9/de0/step__ch_8c.html#ad36a0f9f915547477e3bb2405f8166b9" title="things to do after advance()">post_advance</a>(<span class="keywordtype">int</span> truestep, <span class="keywordtype">int</span> *dumpingnext, <span class="keywordtype">int</span> timeorder, <span class="keywordtype">int</span> numtimeorders, <span class="keywordtype">int</span> finalstep, <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> boundtime, <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> fluxtime, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pi)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pb)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pf)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pstag)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*ucons)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*vpot)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a1c452bce7a227fd9f2c8f937a3c7841c">SHIFTSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#adfe8c351b7f60e189dbd9bfca47af5c5">SHIFTSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a6dc540b0373d80d3ea2db53d03a9fa72">SHIFTSTORE3</a>],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*Bhat)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*F1)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*F2)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*F3)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*Atemp)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a1c452bce7a227fd9f2c8f937a3c7841c">SHIFTSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#adfe8c351b7f60e189dbd9bfca47af5c5">SHIFTSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a6dc540b0373d80d3ea2db53d03a9fa72">SHIFTSTORE3</a>], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*uconstemp)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR])</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;{</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="comment">// Use tracked A_i to update magnetic field</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="comment">// Required to keep A_i in synch with field and only is different at the machine error level (which grows over long times, so why this is required and hardless)</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment"></span>  <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#a10c2a32787a08dc5ca8ee25788232ab5" title="whether to redefine fields from A_i during evolution currently only done after each full timestep to ...">EVOLVEWITHVPOT</a> &amp;&amp; <a class="code" href="../../da/d3e/definit_8h.html#a3a15a632c4a89c05af66b680733eb82c" title="whether to track and dump A_i the vector potential">TRACKVPOT</a> &amp;&amp; (finalstep)){</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="comment">// if evolving with vpot, then assume good enough to use final full timestep A_i to obtain new point fields</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="comment">// less expensive than doing every substep and only wrong at machine error with factors extra for number of substeps</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="comment">// SUPERGODMARK: Check convergence rate and check errors!!  SUPERCHANGINGMARK</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="comment">//  only do this on the final step where A_i has been set as the cumulative Acum  (like ucum) so that not just an arbitrary intermediate step that redefines B&#39;s.</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="comment">// NOTEMARK: No, actually want to do on every substep that defines vpot (vpot holds substep (Uf-like) value on substeps except final step where it holds cumulative final value (Ucum-like)) since need staggered field (say inside NS for init.nsbh.c) to be consistent with A_i so that the smooth extrapolation of A_i translates into smooth Bstag^i so that interpolation of Bstag-&gt;Bcent gives smooth results.</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="comment">// NOTEMARK: If A_i is set inconsistent with EMF_i, then this step will reveal A_i overridding EMF_i results and probably producing undesirable results.</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="comment">// NOTEMARK: No again, if vpot update is consistent with EMFs (as it should be as code is setup in fluxvpot.c), then Bstag only off by machine error from A_i, so only need to do this infrequently.</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    evolve_withvpot(boundtime, pf, pstag, ucons, vpot, Bhat, F1, F2, F3, Atemp,uconstemp); <span class="comment">// boundtime since this time is used for a boundary call inside this function</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="comment">// need to compute various things for EOS</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="comment">// use primitive located where EOS will be used (pb)</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment"></span>  compute_EOS_parms(<a class="code" href="../../da/d3e/definit_8h.html#ad7d4ae935d29d9f729e14124b737a430" title="which EOS (EoS) (equation of state) to use">WHICHEOS</a>,<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(EOSextraglobal),pb);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="comment">// post-advance bound and fixup</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="preprocessor">#if( (1 == CHECKSOLUTION || UTOPRIMADJUST == UTOPRIMAVG) )</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="preprocessor"></span>  <span class="comment">// if CHECKSOLUTION==1, then need values to be bounded right now, since use them to check whether even good solutions are really good.</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <span class="comment">// post_fixup() will use previous time step pff boundary values to fixup_utoprim() if this is not called.</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="comment">// bound advanced values before post_fixup() so fixup_utoprim() has updated boundary values to base fixup on.</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad4ec5aab9b62fbbe9b8fc2d8ac0a5989">failed</a>&gt;0) dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;1failed=%d\n&quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad4ec5aab9b62fbbe9b8fc2d8ac0a5989">failed</a>);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="comment">// bounding 1 layer so fixups have that layer available for fixing up inversion failures</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <span class="comment">// not done if don&#39;t care about perfect MPI consistency with failures -- then fixups don&#39;t use values across MPI boundaries.  Will be less robust in general, but still consistent behavior across MPI boundaries.</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="preprocessor">#if(PRODUCTION==0)</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="preprocessor"></span>  trifprintf(<span class="stringliteral">&quot;[b1&quot;</span>);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a0163a499c88dd8b07688e3dbd7007f0e">MYFUN</a>(<a class="code" href="../../d4/dad/bounds_8funcdeclare_8h.html#a4079244d85c301885c1363ca41502869" title="simple bounding during evolution NOTEMARK: Was previously also bounding pstag here, but not necessary since done by calling bound_pstag in fluxctstag.c">bound_beforeevolveprim</a>(<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#affb13608b845e81f4595b80927fbedbd" title="for various uses (dumping and special boundary/comp interchange routine">STAGEM1</a>,finalstep,boundtime,pf,pstag,ucons,UTOPRIMFIXMPICONSISTENT&gt;0),<span class="stringliteral">&quot;step_ch.c:post_advance()&quot;</span>, <span class="stringliteral">&quot;bound_beforeevolveprim()&quot;</span>, 1);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="preprocessor">#if(PRODUCTION==0)</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="preprocessor"></span>  trifprintf(<span class="stringliteral">&quot;]&quot;</span>);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad4ec5aab9b62fbbe9b8fc2d8ac0a5989">failed</a>&gt;0) dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;2failed=%d\n&quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad4ec5aab9b62fbbe9b8fc2d8ac0a5989">failed</a>);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="preprocessor">#if(PRODUCTION==0)</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="preprocessor"></span>  trifprintf(<span class="stringliteral">&quot;[x&quot;</span>);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <span class="comment">// done when all timeorders are completed, so stencil used doesn&#39;t matter</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <span class="comment">// postfixup</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="comment">// post_fixup: If this modifies values and then uses the modified values for other modified values, then must bound_prim() after this</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <span class="comment">// if one doesn&#39;t care about MPI being same as non-MPI, then can move bound_prim() above to below error_check() and then remove prc&lt;-pv in fixup_utoprim()</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment"></span>  <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a0163a499c88dd8b07688e3dbd7007f0e">MYFUN</a>(post_fixup(<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#affb13608b845e81f4595b80927fbedbd" title="for various uses (dumping and special boundary/comp interchange routine">STAGEM1</a>,finalstep,boundtime, pf,pb,ucons),<span class="stringliteral">&quot;step_ch.c:advance()&quot;</span>, <span class="stringliteral">&quot;post_fixup()&quot;</span>, 1);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="preprocessor">#if(PRODUCTION==0)</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="preprocessor"></span>  trifprintf( <span class="stringliteral">&quot;]&quot;</span>);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <span class="comment">// just report problems, don&#39;t fix them</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <span class="comment">// Then no need for boundary calls</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment"></span>  <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a0163a499c88dd8b07688e3dbd7007f0e">MYFUN</a>(post_fixup_nofixup(<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#affb13608b845e81f4595b80927fbedbd" title="for various uses (dumping and special boundary/comp interchange routine">STAGEM1</a>,finalstep,boundtime, pf,pb,ucons),<span class="stringliteral">&quot;step_ch.c:advance()&quot;</span>, <span class="stringliteral">&quot;post_fixup_nofixup()&quot;</span>, 1);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <span class="comment">// Synch CPUs</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  <span class="comment">// must check before MPI operation (since asymmetries would</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <span class="comment">// desynchronize cpus</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a0163a499c88dd8b07688e3dbd7007f0e">MYFUN</a>(error_check(1),<span class="stringliteral">&quot;step_ch.c&quot;</span>, <span class="stringliteral">&quot;error_check&quot;</span>, 1);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <span class="comment">// bound final values (comes after post_fixup() since changes made by post_fixup)</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <span class="comment">//#if(MPIEQUALNONMPI)</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="preprocessor">#if(ASYMDIAGCHECK)</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="preprocessor"></span>  dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;1before bound\n&quot;</span>);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  asym_compute_2(pf);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;2before bound\n&quot;</span>);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="preprocessor">#if(PRODUCTION==0)</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="preprocessor"></span>  trifprintf(<span class="stringliteral">&quot;[rf&quot;</span>);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <span class="keywordflow">if</span>( <a class="code" href="../../da/d3e/definit_8h.html#ae2cc56909ed67595b899f79bfe6fe8c3" title="whether to do ENO debug">DOGRIDSECTIONING</a>){</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="comment">// this must come before last bound() call so boundary conditions set consistently with new section so next step has all values needed in ghost cells</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="comment">// redo all such enerregions since may be time-dependent</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    recompute_fluxpositions(0,timeorder, numtimeorders, <a class="code" href="../../d8/d5b/defs_8general_8h.html#a1a1088d87617078680f1fd0f0d707384">nstep</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>);</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  }</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="preprocessor">#if(PRODUCTION==0)</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="preprocessor"></span>  trifprintf(<span class="stringliteral">&quot;]&quot;</span>);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  <span class="keywordflow">if</span>(timeorder==numtimeorders-1){</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="comment">// ensure total e-m conservation for final solution after all sub-steps</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="keywordtype">int</span> finaluu=1;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    consfixup_allzones(finaluu,pf,ucons);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  }</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="preprocessor">#if(PRODUCTION==0)</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="preprocessor"></span>  trifprintf( <span class="stringliteral">&quot;[b2&quot;</span>);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <span class="comment">// normal bondary call (only bounds p (centered) and pstag (staggered field) and not A_i or F or other things)</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  <span class="comment">// required in general</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment"></span>  <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a0163a499c88dd8b07688e3dbd7007f0e">MYFUN</a>(<a class="code" href="../../d4/dad/bounds_8funcdeclare_8h.html#a689fddc1949b1a1d390b59d10d17d83c" title="normal full bounding during evolution NOTEMARK: Was previously also bounding pstag here...">bound_evolveprim</a>(<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#affb13608b845e81f4595b80927fbedbd" title="for various uses (dumping and special boundary/comp interchange routine">STAGEM1</a>,finalstep,boundtime,pf,pstag,ucons,USEMPI),<span class="stringliteral">&quot;step_ch.c:post_advance()&quot;</span>, <span class="stringliteral">&quot;bound_evolveprim()&quot;</span>, 2);</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="comment">//#endif</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="preprocessor">#if(PRODUCTION==0)</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="preprocessor"></span>  trifprintf( <span class="stringliteral">&quot;]&quot;</span>);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  <span class="comment">// Compute divb for point-field method</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment"></span>  <span class="keywordflow">if</span>(truestep){</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="comment">// update Bhat so later can compute divb</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a11c4e99e1493d0c1914ad1ab313ea472">FLUXB</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0b6762cef74e396f50a83864bb53fb6c">FLUXCTSTAG</a> &amp;&amp; <a class="code" href="../../d8/d5b/defs_8general_8h.html#a41163ae4887e295df142ae7fc9b4829c">extrazones4emf</a>==0 &amp;&amp; <a class="code" href="../../d8/d5b/defs_8general_8h.html#ad5c8369abdf1833b4afc10d11d52b537">dofluxreconevolvepointfield</a>==1 &amp;&amp; <a class="code" href="../../d8/d5b/defs_8general_8h.html#a55732148d2616d6d1f5d2abbe8710850">DOENOFLUX</a> == <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a81c6be7c38a1e29b40efa57ca47d0d02">ENOFLUXRECON</a>){</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      <span class="comment">//bound_uavg(STAGEM1,unew); // DEBUG</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      <span class="comment">// here utoinvert is point conserved field at staggered FACE position</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;      field_Bhat_fluxrecon(pf,ucons,Bhat);</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    }</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  }</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  <span class="comment">// Compute current update</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment"></span>  <span class="keywordflow">if</span>(truestep){ <span class="comment">// don&#39;t do if just passing through</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="keywordflow">if</span>(dumpingnext[0] || dumpingnext[1]){</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="preprocessor">#if(CALCFARADAYANDCURRENTS)</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="preprocessor">#if(PRODUCTION==0)</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="preprocessor"></span>      trifprintf( <span class="stringliteral">&quot;[cu&quot;</span>);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;      <span class="keywordflow">if</span>((<a class="code" href="../../da/d3e/definit_8h.html#a74985ff4d0f832956e97389873e29731">WHICHCURRENTCALC</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2e0b0bbda834334e507843bdd0718472" title="for WHICHCURRENTCALC 0: original time is on edge and spatial on edge, but spatials are different loca...">CURRENTCALC0</a>)||(<a class="code" href="../../da/d3e/definit_8h.html#a74985ff4d0f832956e97389873e29731">WHICHCURRENTCALC</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a02595a7fb5c0bff24672ef70afc374f6">CURRENTCALC2</a>)){</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        <span class="comment">// puts J at the time center, but hard to know if RK is at mid point in time except for midpoint method</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        <span class="comment">// compute current_doprecalc if near half-step in time</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        <span class="keywordflow">if</span>(</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;           ((numtimeorders&gt;=3)&amp;&amp;(timeorder==1))</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;           ||((numtimeorders&lt;=2)&amp;&amp;(timeorder==0))</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;           )</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;          current_doprecalc(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a273ed7511282d8abfa2e69104310fc7f">CURTYPET</a>,pf); <span class="comment">// should be called using half-time step data</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;      }</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="preprocessor">#if(PRODUCTION==0)</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="preprocessor"></span>      trifprintf( <span class="stringliteral">&quot;]&quot;</span>);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="preprocessor"></span>    }<span class="comment">// end if dumping next</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  }<span class="comment">// end if truestep</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  <span class="comment">// Diagnostics</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment"></span>  <span class="keywordflow">if</span>(truestep){ <span class="comment">// don&#39;t do if just passing through</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="comment">/* perform diagnostics */</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="comment">// no error check since assume if step_ch passed, diag(1) will pass</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5b/defs_8general_8h.html#aac5486df6a846aa6cb47c73202ac0485">DODIAGS</a> &amp;&amp; <a class="code" href="../../d8/d5b/defs_8general_8h.html#a813cffebecba4a98b088087f80250ba0">DODIAGEVERYSUBSTEP</a> ){ <span class="comment">//SASMARK -- moved the diags calls here</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;      <a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pdump) = pf;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;      <a class="code" href="../../d3/da1/diag_8c.html#a33d4865bef4d1e548c3d10b3839adf67" title="main diag() call for diagnostics OPENMPNOTE: Assume diag() not called by multiple threads...">diag</a>(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#aeffe06fa68e390e1d00f688afe298562">DUMP_OUT</a>,boundtime,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a1a1088d87617078680f1fd0f0d707384">nstep</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0b92e4d6197989f0f9b0609c8615a46f">realnstep</a>); <span class="comment">// boundtime corresponds to pf for this timeorder</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="preprocessor">#if(PRODUCTION==0)</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="preprocessor"></span>      trifprintf( <span class="stringliteral">&quot;D&quot;</span>);</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="preprocessor"></span>    }</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  }</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;}</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;</div>
<div class="line"><a name="l00589"></a><span class="lineno"><a class="code" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2">  589</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin...">step_ch_simplempi</a>(<span class="keywordtype">int</span> truestep, <span class="keywordtype">int</span> *dumpingnext, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *fullndt, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*prim)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pstag)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*ucons)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*vpot)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a1c452bce7a227fd9f2c8f937a3c7841c">SHIFTSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#adfe8c351b7f60e189dbd9bfca47af5c5">SHIFTSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a6dc540b0373d80d3ea2db53d03a9fa72">SHIFTSTORE3</a>], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*Bhat)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pl_ct)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR2INTERP], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pr_ct)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR2INTERP],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*F1)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*F2)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*F3)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*Atemp)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a1c452bce7a227fd9f2c8f937a3c7841c">SHIFTSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#adfe8c351b7f60e189dbd9bfca47af5c5">SHIFTSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a6dc540b0373d80d3ea2db53d03a9fa72">SHIFTSTORE3</a>],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*uconstemp)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR])</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;{</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl...">advance</a>(<span class="keywordtype">int</span> truestep, <span class="keywordtype">int</span> stage, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pi)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pb)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pf)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR],</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;              <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pstag)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR],</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;              <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pl_ct)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR2INTERP], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pr_ct)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR2INTERP],</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;              <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*F1)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*F2)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*F3)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>],</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;              <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*vpot)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a1c452bce7a227fd9f2c8f937a3c7841c">SHIFTSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#adfe8c351b7f60e189dbd9bfca47af5c5">SHIFTSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a6dc540b0373d80d3ea2db53d03a9fa72">SHIFTSTORE3</a>],</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;              <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*ui)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*uf)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*ucum)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR],</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;              <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *CUf,<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *CUnew,<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> fluxdt, <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> boundtime, <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> fluxtime, <span class="keywordtype">int</span> timeorder, <span class="keywordtype">int</span> numtimeorders, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *ndt);</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  </div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d9/de0/step__ch_8c.html#a3b26d4bb7df497aa517553dc6decd60d" title="things to do during substep before advance()">pre_advance</a>(<span class="keywordtype">int</span> timeorder, <span class="keywordtype">int</span> numtimeorders, <span class="keywordtype">int</span> finalstep, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pi)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pb)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pf)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR]);</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  <span class="keywordtype">int</span> asym_compute_2(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*prim)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR]);</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  <span class="keywordtype">int</span> pl,pliter;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <span class="keywordtype">int</span> boundstage;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> mydt;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  <span class="keywordtype">int</span> stage, stagei,stagef;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> ndt,lastndt;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pi)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR];</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pb)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR];</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pf)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR];</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*prevpf)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR];</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pii[MAXTIMEORDER])[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR];</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pbb[MAXTIMEORDER])[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR];</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pff[MAXTIMEORDER])[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR];</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*uii[MAXTIMEORDER])[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR];</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*uff[MAXTIMEORDER])[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR];</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*ucum[MAXTIMEORDER])[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR];</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  <span class="comment">//  FTYPE alphaik[MAXSTAGES][MAXSTAGES],betaik[MAXSTAGES];</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> CUf[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0a72db4856620ff1b9551c885f1b32b5">MAXTIMEORDER</a>][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ab17e7e66eb2bc86b9d61d6bb61a0a4a3" title="NUMDTCUFS also includes what&#39;s necessary for IMEX.">NUMDTCUFS</a>],CUnew[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0a72db4856620ff1b9551c885f1b32b5">MAXTIMEORDER</a>][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ab17e7e66eb2bc86b9d61d6bb61a0a4a3" title="NUMDTCUFS also includes what&#39;s necessary for IMEX.">NUMDTCUFS</a>];</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#ad21ff679aac3fe28202c6d592eafd3e6">i</a>, <a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>, k;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  <span class="keywordtype">int</span> numtimeorders;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  <span class="keywordtype">int</span> timeorder;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  <span class="keywordtype">int</span> finalstep,initialstep;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> fluxdt[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0a72db4856620ff1b9551c885f1b32b5">MAXTIMEORDER</a>], boundtime[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0a72db4856620ff1b9551c885f1b32b5">MAXTIMEORDER</a>], fluxtime[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0a72db4856620ff1b9551c885f1b32b5">MAXTIMEORDER</a>];</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  <span class="comment">// setup time-stepping</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="comment"></span>  <a class="code" href="../../d9/de0/step__ch_8c.html#a3a2639f03dc596fb0eed62598b420880" title="Setup RK steps for the ith stage:">setup_rktimestep</a>(truestep, &amp;numtimeorders,prim,pstag,ucons,vpot,Bhat,<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pk),pii,pbb,pff,uii,uff,ucum,CUf,CUnew);</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  <span class="comment">// Obtain initial time of substep, final time of substep, and true dt used for flux conservation that is used to iterate ucum in advance.c</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="comment"></span>  get_truetime_fluxdt(numtimeorders, <a class="code" href="../../d8/d5b/defs_8general_8h.html#a56db625f31229c5e8b208ff27d464931">dt</a>, CUf, CUnew, fluxdt, boundtime, fluxtime, NULL,NULL);</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  <span class="comment">// global debug tracking var</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a4aa8d6658437fa43b57a498c7230bf27">numstepparts</a>=numtimeorders;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  <span class="comment">// Initialize old and new dt to be very large so minimization procedure always obtains new dt</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  ndt=lastndt=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a38eb76aa0a9a1bb1dac30c75be4a05b6">BIG</a>;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  <span class="comment">// general temporal loop</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment"></span>  <span class="keywordflow">for</span>(timeorder=0;timeorder&lt;numtimeorders;timeorder++){</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    </div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <span class="comment">//the starting and the ending times of the current substep</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment"></span>    <span class="keywordflow">if</span>(timeorder!=numtimeorders-1){</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a66ee7a124e4ae5f84428f69f625c8851">tstepparti</a> = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a> + CUf[timeorder][3] * <a class="code" href="../../d8/d5b/defs_8general_8h.html#a56db625f31229c5e8b208ff27d464931">dt</a>;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a207dd7fd301c011f173d6cc43b5823c1">tsteppartf</a> = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a> + CUf[timeorder][2] * dt +  CUf[timeorder][3] * <a class="code" href="../../d8/d5b/defs_8general_8h.html#a56db625f31229c5e8b208ff27d464931">dt</a>;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    }</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a66ee7a124e4ae5f84428f69f625c8851">tstepparti</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a207dd7fd301c011f173d6cc43b5823c1">tsteppartf</a>=<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>+<a class="code" href="../../d8/d5b/defs_8general_8h.html#a56db625f31229c5e8b208ff27d464931">dt</a>;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    }</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="comment">// global debug tracking var</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment"></span>    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a70170b90229f9fc05eebf8508a685c70">steppart</a>=timeorder;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="keywordflow">if</span>(timeorder==numtimeorders-1) finalstep=1; <span class="keywordflow">else</span> finalstep=0;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <span class="keywordflow">if</span>(timeorder==0) initialstep=1; <span class="keywordflow">else</span> initialstep=0;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="preprocessor">#if(PRODUCTION==0)</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="preprocessor"></span>    trifprintf(<span class="stringliteral">&quot;|%ds&quot;</span>,timeorder);</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="comment">// BEFORE ADVANCE</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="comment"></span>    <a class="code" href="../../d9/de0/step__ch_8c.html#a3b26d4bb7df497aa517553dc6decd60d" title="things to do during substep before advance()">pre_advance</a>(timeorder, numtimeorders, finalstep, pii[timeorder],pbb[timeorder],pff[timeorder]);</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160; </div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="comment">// ADVANCE</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="comment"></span>    <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#a7cc014dd95a474090673bded978ae1e1" title="whether to split NPR PLOOPs">SPLITNPR</a>){</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      <span class="comment">// SPLITNPR ADVANCE</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="comment"></span>    </div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="preprocessor">#if(SPLITNPR&amp;&amp;(USESTOREDSPEEDSFORFLUX==0 || STOREWAVESPEEDS==0))</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#error Not correct use of SPLITNPR and wavespeeds</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="preprocessor"></span>      <span class="comment">// Note that even though PLOOP is split-up, some things are still repeated for these 2 advance() calls:</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;      <span class="comment">// 1) vchar for Riemann solver still needed -- could store vchar on first pass and use on second pass, but then using old B for vchar() on second pass and want to use new B everywhere for second pass</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;      <span class="comment">// 2) dt is minimized twice -- seems second pass will overwrite first pass</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;      <span class="comment">// 3) getting of geometry and state everywhere is duplicated</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;      <span class="comment">//    NOTE OF IMPORTANCE: get_state needs all primitives, so must feed non-PLOOP quantities</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;      <span class="comment">// 4) get_wavespeeds requires ALL quantities during interpolation -- must set USESTOREDSPEEDSFORFLUX==1 and STOREWAVESPEEDS&gt;0 so computes wave speeds across 2 advance() calls and uses centered speed for interface to avoid needing during interpolation for p_l,p_r-&gt;wavespeed@interface</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;      <span class="comment">//    Basically flux_compute_general(p_l,p_r needs velocities too) for first pass</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;      <span class="comment">// 5) p2SFUevolve&#39;s get_state needs velocity -- that is, flux_B(B,v) so have to still interpolate v with B -- save v-interpolation (all interpolations) and avoid interpolations on second pass.</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;      <span class="comment">//    Made pleft and pright [3]X in size to store across advance(), dq is already this way</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;      <span class="comment">// 6) checked NPR and NPR2INTERP uses.  All such explicit uses are ok</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;      <span class="comment">//    e.g. grep -e &quot;[^\[]NPR&quot; *.c</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;      <span class="comment">// Things NOT done on first pass:</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;      <span class="comment">// 1) source term if NOGDETBi=0</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;      <span class="comment">// 2) metric update if evolving metric</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      <span class="comment">// 3) all non-B quantities if doing PLOOP or PLOOPINTERP</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      <span class="comment">// 4) diag_flux, diag_source, diag_source_all -- all use PDIAGLOOP</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      <span class="comment">// 5) fixup1zone() or fixup()</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;      <span class="comment">// Things to fix:</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;      <span class="comment">// 3) compute_df_line_new during interpolation needs get_state for u and b -- only for pressure indicator for WENO</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;      <span class="comment">// 4) calculation of bsq requires b^\mu requires B and v/u/urel -- called PLOOP or what?</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      <span class="comment">// 5) Check all PLOOP&#39;s everywhere to ensure doing ALL NPR if required</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;      <span class="comment">// 6) could bound only field when bounding between</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      <span class="comment">// choice for range of PLOOP</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;      <span class="comment">// choose to only update magnetic field</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa513122b9e25a436a0e98805e46961af" title="OPENMPNOTE: Ensure all pl&#39;s are set as private as required [only npr2interp and npr2notinterp changed...">nprstart</a>=0;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a11c2c3ace90a795cd7a910ac0a6256d2">nprend</a>=2;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#af637e542453ec23c1a41a1038b223040">nprlist</a>[0]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a7b21d6a6a4573b4997b1f04b01cd4efb">B1</a>;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#af637e542453ec23c1a41a1038b223040">nprlist</a>[1]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a6945d50f798e1fde624d70c74457090e">B2</a>;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#af637e542453ec23c1a41a1038b223040">nprlist</a>[2]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ae6ac0edb1e2c9c7672ab9488d8b65be9">B3</a>;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      <span class="comment">// choice for range of PLOOPINTERP</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;      <span class="comment">// but interpolate everything on first pass (GODMARK: in reality only need to do field on timeorder=0 since last field update is next field pbb??? -- probably only true if doing simple RK methods (1,2))</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="preprocessor">#pragma omp parallel private(pl)</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="preprocessor"></span>      {</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        <a class="code" href="../../d8/d5b/defs_8general_8h.html#a0698381e35c41efe1e8e744c563346ca" title="for choosing range of PLOOPINTERP type arrays">npr2interpstart</a>=0;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        <a class="code" href="../../d8/d5b/defs_8general_8h.html#ab8d17d77cf16ec7a4448add3fc8710f8">npr2interpend</a>=NPR2INTERP-1;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        <span class="keywordflow">for</span>(pl=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0698381e35c41efe1e8e744c563346ca" title="for choosing range of PLOOPINTERP type arrays">npr2interpstart</a>;pl&lt;=<a class="code" href="../../d8/d5b/defs_8general_8h.html#ab8d17d77cf16ec7a4448add3fc8710f8">npr2interpend</a>;pl++)  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a647235f9afd0ad17f188ed43fe23997f">npr2interplist</a>[pl]=pl;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        <span class="comment">// choice for range of PLOOPNOTINTERP</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac99c90682b12a247322e31858c1587ae" title="for choosing range of PLOOPNOTINTERP type arrays">npr2notinterpstart</a>=0;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        <a class="code" href="../../d8/d5b/defs_8general_8h.html#a05fc347d92006848324d7c53e17d9139">npr2notinterpend</a>=-1;</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        <a class="code" href="../../d8/d5b/defs_8general_8h.html#add80b9385c492cbd8e72f4940dd1973f">npr2notinterplist</a>[0]=0;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;      }</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa2010d23a21177641277f5119a2705c7">advancepassnumber</a>=0;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;      <span class="comment">// advance (field only)</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;      <span class="comment">// Only field parts of pff, uff, and ucum updated</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;      <span class="comment">// on final timeorder, ucum used to get final B that will be used as B for final timeorder for non-field quantities</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;      <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a0163a499c88dd8b07688e3dbd7007f0e">MYFUN</a>(<a class="code" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl...">advance</a>(truestep, <a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#affb13608b845e81f4595b80927fbedbd" title="for various uses (dumping and special boundary/comp interchange routine">STAGEM1</a>, pii[timeorder], pbb[timeorder], pff[timeorder], pstag, pl_ct, pr_ct, F1, F2, F3, vpot, uii[timeorder], uff[timeorder], ucum[timeorder], CUf[timeorder], CUnew[timeorder], fluxdt[timeorder], boundtime[timeorder], fluxtime[timeorder], timeorder,numtimeorders,&amp;ndt),<span class="stringliteral">&quot;step_ch.c:step_ch_simplempi()&quot;</span>, <span class="stringliteral">&quot;advance()&quot;</span>, 1);</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;      <span class="comment">// only need to bound field, so control PLOOPMPI</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a37f8921de34ae87d6e4f8cf01a907de5" title="for choosing range of PBOUNDLOOP and PLOOPMPI type arrays">nprboundstart</a>=0;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3d3b30e5230109a1a182199aa17ab084">nprboundend</a>=2;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a6dba6fb1a43922f6b8c4e933ad8b51bc">nprboundlist</a>[0]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a7b21d6a6a4573b4997b1f04b01cd4efb">B1</a>;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a6dba6fb1a43922f6b8c4e933ad8b51bc">nprboundlist</a>[1]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a6945d50f798e1fde624d70c74457090e">B2</a>;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a6dba6fb1a43922f6b8c4e933ad8b51bc">nprboundlist</a>[2]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ae6ac0edb1e2c9c7672ab9488d8b65be9">B3</a>;</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;      <span class="comment">// with magnetic field, only  need to bound</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;      <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a0163a499c88dd8b07688e3dbd7007f0e">MYFUN</a>(<a class="code" href="../../d4/dad/bounds_8funcdeclare_8h.html#a689fddc1949b1a1d390b59d10d17d83c" title="normal full bounding during evolution NOTEMARK: Was previously also bounding pstag here...">bound_evolveprim</a>(<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#affb13608b845e81f4595b80927fbedbd" title="for various uses (dumping and special boundary/comp interchange routine">STAGEM1</a>,finalstep,boundtime[timeorder],pff[timeorder],pstag,uff[timeorder],USEMPI),<span class="stringliteral">&quot;step_ch.c:step_ch_simplempi()&quot;</span>, <span class="stringliteral">&quot;bound_evolveprim()&quot;</span>, 1);</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;      <span class="comment">// now copy over pff to pbb so Bnew is used in flux calculation of non-field quantities</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;      <a class="code" href="../../df/da8/global_8comploops_8h.html#a73344b9115781fb6586768527d859edd">COMPFULLLOOP</a>{</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a9afde1f1647e18e733406a1566b8b550">PLOOPBONLY</a>(pl) <a class="code" href="../../df/d1c/global_8storage_8h.html#aa8b43b4fc3603af92ea833ece0a76c00">MACP1A1</a>(pbb,timeorder,i,j,k,pl)=<a class="code" href="../../df/d1c/global_8storage_8h.html#aa8b43b4fc3603af92ea833ece0a76c00">MACP1A1</a>(pff,timeorder,i,j,k,pl);</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;      }</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;      <span class="comment">// choice for range of PLOOP</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;      <span class="comment">// don&#39;t update field on second pass (result overwritten in utoprimgen.c even if done)</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa513122b9e25a436a0e98805e46961af" title="OPENMPNOTE: Ensure all pl&#39;s are set as private as required [only npr2interp and npr2notinterp changed...">nprstart</a>=0;</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a11c2c3ace90a795cd7a910ac0a6256d2">nprend</a>=NPR-1-3; <span class="comment">// no field</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;      <span class="keywordflow">for</span>(pl=<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa513122b9e25a436a0e98805e46961af" title="OPENMPNOTE: Ensure all pl&#39;s are set as private as required [only npr2interp and npr2notinterp changed...">nprstart</a>;pl&lt;=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a11c2c3ace90a795cd7a910ac0a6256d2">nprend</a>;pl++){</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        <span class="keywordflow">if</span>(pl&gt;=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a7b21d6a6a4573b4997b1f04b01cd4efb">B1</a>) <a class="code" href="../../d8/d5b/defs_8general_8h.html#af637e542453ec23c1a41a1038b223040">nprlist</a>[pl]=pl+3; <span class="comment">// skip field</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        <span class="keywordflow">else</span> <a class="code" href="../../d8/d5b/defs_8general_8h.html#af637e542453ec23c1a41a1038b223040">nprlist</a>[pl]=pl;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;      }</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;      <span class="comment">// choice for range of PLOOPINTERP</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;      <span class="comment">// Interpolation of only fields on second pass since want to use updated field to compute flux and so at end of both steps first updated field and non-field quantites are fed to inversion for consistent P(Bnew) and Bnew is used</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="preprocessor">#pragma omp parallel private(pl)</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="preprocessor"></span>      {</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        <a class="code" href="../../d8/d5b/defs_8general_8h.html#a0698381e35c41efe1e8e744c563346ca" title="for choosing range of PLOOPINTERP type arrays">npr2interpstart</a>=0;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        <a class="code" href="../../d8/d5b/defs_8general_8h.html#ab8d17d77cf16ec7a4448add3fc8710f8">npr2interpend</a>=2;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        <a class="code" href="../../d8/d5b/defs_8general_8h.html#a647235f9afd0ad17f188ed43fe23997f">npr2interplist</a>[0]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a7b21d6a6a4573b4997b1f04b01cd4efb">B1</a>;</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        <a class="code" href="../../d8/d5b/defs_8general_8h.html#a647235f9afd0ad17f188ed43fe23997f">npr2interplist</a>[1]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a6945d50f798e1fde624d70c74457090e">B2</a>;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        <a class="code" href="../../d8/d5b/defs_8general_8h.html#a647235f9afd0ad17f188ed43fe23997f">npr2interplist</a>[2]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ae6ac0edb1e2c9c7672ab9488d8b65be9">B3</a>;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        <span class="comment">// choice for range of PLOOPNOTINTERP</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        <span class="comment">// what not interpolating (all non-field):</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac99c90682b12a247322e31858c1587ae" title="for choosing range of PLOOPNOTINTERP type arrays">npr2notinterpstart</a>=0;</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;        <a class="code" href="../../d8/d5b/defs_8general_8h.html#a05fc347d92006848324d7c53e17d9139">npr2notinterpend</a>=NPR-1-3; <span class="comment">// no field</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        <span class="keywordflow">for</span>(pl=<a class="code" href="../../d8/d5b/defs_8general_8h.html#ac99c90682b12a247322e31858c1587ae" title="for choosing range of PLOOPNOTINTERP type arrays">npr2notinterpstart</a>;pl&lt;=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a05fc347d92006848324d7c53e17d9139">npr2notinterpend</a>;pl++){</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;          <span class="keywordflow">if</span>(pl&gt;=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a7b21d6a6a4573b4997b1f04b01cd4efb">B1</a>) <a class="code" href="../../d8/d5b/defs_8general_8h.html#add80b9385c492cbd8e72f4940dd1973f">npr2notinterplist</a>[pl]=pl+3; <span class="comment">// skip field</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;          <span class="keywordflow">else</span> <a class="code" href="../../d8/d5b/defs_8general_8h.html#add80b9385c492cbd8e72f4940dd1973f">npr2notinterplist</a>[pl]=pl;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        }</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;      }</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa2010d23a21177641277f5119a2705c7">advancepassnumber</a>=1;</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;      <span class="comment">// advance (non-field quantities)</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;      <span class="comment">// only non-field parts of pff, uff, ucum updated</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;      <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a0163a499c88dd8b07688e3dbd7007f0e">MYFUN</a>(<a class="code" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl...">advance</a>(truestep, <a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#affb13608b845e81f4595b80927fbedbd" title="for various uses (dumping and special boundary/comp interchange routine">STAGEM1</a>, pii[timeorder], pbb[timeorder], pff[timeorder], pstag, pl_ct, pr_ct, F1, F2, F3, vpot, uii[timeorder], uff[timeorder], ucum[timeorder], CUf[timeorder], CUnew[timeorder], fluxdt[timeorder], boundtime[timeorder], fluxtime[timeorder], timeorder,numtimeorders,&amp;ndt),<span class="stringliteral">&quot;step_ch.c:step_ch_simplempi()&quot;</span>, <span class="stringliteral">&quot;advance()&quot;</span>, 1);</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;      <span class="comment">// go back to defaults</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;      <span class="comment">// choice for range of PLOOP</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa513122b9e25a436a0e98805e46961af" title="OPENMPNOTE: Ensure all pl&#39;s are set as private as required [only npr2interp and npr2notinterp changed...">nprstart</a>=0;</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a11c2c3ace90a795cd7a910ac0a6256d2">nprend</a>=NPR-1;</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;      <span class="keywordflow">for</span>(pl=<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa513122b9e25a436a0e98805e46961af" title="OPENMPNOTE: Ensure all pl&#39;s are set as private as required [only npr2interp and npr2notinterp changed...">nprstart</a>;pl&lt;=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a11c2c3ace90a795cd7a910ac0a6256d2">nprend</a>;pl++) <a class="code" href="../../d8/d5b/defs_8general_8h.html#af637e542453ec23c1a41a1038b223040">nprlist</a>[pl]=pl;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="preprocessor">#pragma omp parallel private(pl)</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="preprocessor"></span>      {</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        <span class="comment">// choice for range of PLOOPINTERP</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        <a class="code" href="../../d8/d5b/defs_8general_8h.html#a0698381e35c41efe1e8e744c563346ca" title="for choosing range of PLOOPINTERP type arrays">npr2interpstart</a>=0;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        <a class="code" href="../../d8/d5b/defs_8general_8h.html#ab8d17d77cf16ec7a4448add3fc8710f8">npr2interpend</a>=NPR2INTERP-1;</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        <span class="keywordflow">for</span>(pl=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0698381e35c41efe1e8e744c563346ca" title="for choosing range of PLOOPINTERP type arrays">npr2interpstart</a>;pl&lt;=<a class="code" href="../../d8/d5b/defs_8general_8h.html#ab8d17d77cf16ec7a4448add3fc8710f8">npr2interpend</a>;pl++) <a class="code" href="../../d8/d5b/defs_8general_8h.html#a647235f9afd0ad17f188ed43fe23997f">npr2interplist</a>[pl]=pl;</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        <span class="comment">// choice for range of PLOOPNOTINTERP</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        <a class="code" href="../../d8/d5b/defs_8general_8h.html#ac99c90682b12a247322e31858c1587ae" title="for choosing range of PLOOPNOTINTERP type arrays">npr2notinterpstart</a>=0;</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        <a class="code" href="../../d8/d5b/defs_8general_8h.html#a05fc347d92006848324d7c53e17d9139">npr2notinterpend</a>=-1;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        <a class="code" href="../../d8/d5b/defs_8general_8h.html#add80b9385c492cbd8e72f4940dd1973f">npr2notinterplist</a>[0]=0;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;      }</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa2010d23a21177641277f5119a2705c7">advancepassnumber</a>=-1;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;      <span class="comment">// default choice for range of PLOOPMPI</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a37f8921de34ae87d6e4f8cf01a907de5" title="for choosing range of PBOUNDLOOP and PLOOPMPI type arrays">nprboundstart</a>=0;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3d3b30e5230109a1a182199aa17ab084">nprboundend</a>=NPRBOUND-1;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;      <span class="keywordflow">for</span>(pl=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a37f8921de34ae87d6e4f8cf01a907de5" title="for choosing range of PBOUNDLOOP and PLOOPMPI type arrays">nprboundstart</a>;pl&lt;=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a3d3b30e5230109a1a182199aa17ab084">nprboundend</a>;pl++) <a class="code" href="../../d8/d5b/defs_8general_8h.html#a6dba6fb1a43922f6b8c4e933ad8b51bc">nprboundlist</a>[pl]=pl;</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    }</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;      <span class="comment">// NORMAL (not SPLITNPR) ADVANCE</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa2010d23a21177641277f5119a2705c7">advancepassnumber</a>=-1; <span class="comment">// implies do all things, no split</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;      <span class="comment">// advance (all)</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;      <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a0163a499c88dd8b07688e3dbd7007f0e">MYFUN</a>(<a class="code" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl...">advance</a>(truestep, <a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#affb13608b845e81f4595b80927fbedbd" title="for various uses (dumping and special boundary/comp interchange routine">STAGEM1</a>, pii[timeorder], pbb[timeorder], pff[timeorder], pstag, pl_ct, pr_ct, F1, F2, F3, vpot, uii[timeorder], uff[timeorder], ucum[timeorder], CUf[timeorder], CUnew[timeorder], fluxdt[timeorder], boundtime[timeorder], fluxtime[timeorder], timeorder,numtimeorders,&amp;ndt),<span class="stringliteral">&quot;step_ch.c:step_ch_simplempi()&quot;</span>, <span class="stringliteral">&quot;advance()&quot;</span>, 1);</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    } <span class="comment">// end else if normal advance()</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <span class="comment">//    </span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <span class="comment">// need to minimize dt over all substeps rather than just last step</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    <span class="comment">// lastndt holds cumulative-all-substep ndt</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="comment"></span>    <span class="keywordflow">if</span>(ndt&lt;lastndt) lastndt=ndt;</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <span class="comment">// POST ADVANCE</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="comment"></span>    <a class="code" href="../../d9/de0/step__ch_8c.html#ad36a0f9f915547477e3bb2405f8166b9" title="things to do after advance()">post_advance</a>(truestep, dumpingnext, timeorder, numtimeorders, finalstep, boundtime[timeorder], fluxtime[timeorder], pii[timeorder],pbb[timeorder],pff[timeorder],pstag,ucons,vpot,Bhat, F1, F2, F3, Atemp, uconstemp);</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;  }<span class="comment">// end timeorder</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;  </div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  <span class="comment">// pass back the final minimal dt over all substeps</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="comment"></span>  *fullndt = lastndt;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  <span class="comment">/* done! */</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  <span class="keywordflow">return</span> (0);</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;}</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="keywordtype">void</span> get_truetime_fluxdt(<span class="keywordtype">int</span> numtimeorders, <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> localdt, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*CUf)[NUMDTCUFS], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*CUnew)[NUMDTCUFS], <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> *fluxdt, <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> *boundtime, <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> *fluxtime, <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> *<a class="code" href="../../d8/d5b/defs_8general_8h.html#a66ee7a124e4ae5f84428f69f625c8851">tstepparti</a>, <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> *<a class="code" href="../../d8/d5b/defs_8general_8h.html#a207dd7fd301c011f173d6cc43b5823c1">tsteppartf</a>)</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;{</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;  <span class="keywordtype">int</span> timeorder;</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;  <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> ufdt[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0a72db4856620ff1b9551c885f1b32b5">MAXTIMEORDER</a>],ucumdt[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0a72db4856620ff1b9551c885f1b32b5">MAXTIMEORDER</a>];</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> oldufdt,olducumdt;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> Ui, dUriemann, dUgeom ;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  <span class="comment">//  NOT YET:</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="comment"></span>  <span class="comment">//</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;  <span class="comment">//the starting and the ending times of the current substep</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="comment"></span>  <span class="comment">//  if(timeorder!=numtimeorders-1){</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;  <span class="comment">//    *tstepparti = t + CUf[timeorder][3] * localdt;</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  <span class="comment">//    *tsteppartf = t + CUf[timeorder][2] * localdt +  CUf[timeorder][3] * localdt;</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  <span class="comment">//  }</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;  <span class="comment">//  else{</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;  <span class="comment">//    *tstepparti=t;</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;  <span class="comment">//    *tsteppartf=t+localdt;</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;  <span class="comment">//  }</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;  <span class="comment">// initialize</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  <span class="keywordflow">for</span>(timeorder=0;timeorder&lt;numtimeorders;timeorder++){</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    fluxdt[timeorder] = 0.0;</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    boundtime[timeorder] = 0.0;</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    fluxtime[timeorder] = 0.0;</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  }</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;  <span class="comment">// Get fluxdt (for up to explicit RK5)</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  <span class="comment">// See setup_rktimestep() for how Uf^i and unew^i are defined, such that fluxdt[] below just adds all dUe terms appropriately.</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="comment"></span>  <span class="keywordflow">for</span>(timeorder=4;timeorder&lt;numtimeorders;timeorder++){ <span class="comment">// for &gt;=RK5</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    fluxdt[timeorder-4] += CUnew[timeorder][2]*CUf[timeorder][1]*CUf[timeorder-1][1]*CUf[timeorder-2][1]*CUf[timeorder-3][1]*CUf[timeorder-4][2]*localdt;</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;  }</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;  <span class="keywordflow">for</span>(timeorder=3;timeorder&lt;numtimeorders;timeorder++){ <span class="comment">// for &gt;=RK4</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    fluxdt[timeorder-3] += CUnew[timeorder][2]*CUf[timeorder][1]*CUf[timeorder-1][1]*CUf[timeorder-2][1]*CUf[timeorder-3][2]*localdt;</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;  }</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;  <span class="keywordflow">for</span>(timeorder=2;timeorder&lt;numtimeorders;timeorder++){ <span class="comment">// for &gt;=RK3</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    fluxdt[timeorder-2] += CUnew[timeorder][2]*CUf[timeorder][1]*CUf[timeorder-1][1]*CUf[timeorder-2][2]*localdt;</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  }</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  <span class="keywordflow">for</span>(timeorder=1;timeorder&lt;numtimeorders;timeorder++){ <span class="comment">// for &gt;=RK2</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    fluxdt[timeorder-1] += CUnew[timeorder][2]*CUf[timeorder][1]*CUf[timeorder-1][2]*localdt;</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;  }</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;  <span class="keywordflow">for</span>(timeorder=0;timeorder&lt;numtimeorders;timeorder++){ <span class="comment">// for &gt;=RK1</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    fluxdt[timeorder] += (CUnew[timeorder][1] + CUnew[timeorder][2]*CUf[timeorder][2])*localdt;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  }</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a1a1088d87617078680f1fd0f0d707384">nstep</a>==0){</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    <span class="keywordflow">for</span>(timeorder=0;timeorder&lt;numtimeorders;timeorder++){</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;      dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;timeorder=%d fluxdt/dt=%g\n&quot;</span>,timeorder,fluxdt[timeorder]/localdt);</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    }</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;  }</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;  <span class="comment">// assuming fluxdt used before any calls in advance.c</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;  <span class="comment">// then represents *amount* of flux&#39;ed stuff in time dt</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;  <span class="comment">// This is NOT the time of the flux evaluation</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;  <span class="comment">// This is to be used with diag_flux and other things multiplied by dt for diagnostics only</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;  <span class="comment">// Other things (e.g. sources()) use same dt as dUriemann automatically, so fluxdt is not for anything but diagnostics</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;  <span class="comment">// Only exception is updating vpot that is out of place and uses ucum-type updates</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;  <span class="comment">// loop up to current substep to get current fluxdt</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;  Ui=dUgeom=0.0; <span class="comment">// don&#39;t care about update from non-flux terms</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> uf;</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> dUnongeomall[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0a72db4856620ff1b9551c885f1b32b5">MAXTIMEORDER</a>]={0.0};</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;  <span class="keywordflow">for</span>(timeorder=0;timeorder&lt;numtimeorders;timeorder++){</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    <span class="keywordflow">if</span>(timeorder==0){</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;      oldufdt=0.0;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    }</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;      oldufdt=ufdt[timeorder-1];</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    }</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    <span class="comment">// follows dUtoU() in advance.c</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    ufdt[timeorder] = UFSET(CUf[timeorder],localdt,Ui,oldufdt,dUriemann,dUgeom,dUnongeomall);</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    <span class="comment">// below is NOT += since just want current change, not all prior changes</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    <span class="comment">// if did +=, then get 1 for timeorder==numtimeorders-1 as required!</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    ucumdt[timeorder] = UCUMUPDATE(CUnew[timeorder],localdt,Ui,ufdt[timeorder],dUriemann,dUgeom,dUnongeomall);</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    <span class="comment">//  time of pf at end of substep</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    boundtime[timeorder] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a> + ufdt[timeorder];</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    <span class="comment">// time of pb when used to compute flux</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    <span class="comment">// and time of pb corresponds to time of previous pf (except for first substep where it&#39;s just t)</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    <span class="comment">//     tstepparti = t + CUf[timeorder][3] * dt;</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    <span class="comment">//      tsteppartf = t + CUf[timeorder][2] * dt +  CUf[timeorder][3] * dt;</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    <span class="keywordflow">if</span>(timeorder&gt;0) fluxtime[timeorder] =  <a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a> + CUf[timeorder-1][2] * <a class="code" href="../../d8/d5b/defs_8general_8h.html#a56db625f31229c5e8b208ff27d464931">dt</a> +  CUf[timeorder-1][3] * <a class="code" href="../../d8/d5b/defs_8general_8h.html#a56db625f31229c5e8b208ff27d464931">dt</a>;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    <span class="keywordflow">else</span> fluxtime[timeorder] =  <a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>;</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  }</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;  </div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="preprocessor">#if(0)</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;  <span class="comment">// Get boundtime</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  <span class="comment">// Get current time for pf</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;  <span class="comment">// The below works because pi=p always and so always just use </span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  <span class="comment">// assuming bound called after advance(), then need to get time of next flux evaluation</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  <span class="comment">// This corresponds to time where pb *will be* located</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;  <span class="comment">// </span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="comment"></span>  <span class="keywordflow">for</span>(timeorder=0;timeorder&lt;numtimeorders;timeorder++){</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    <span class="keywordflow">if</span>(timeorder&lt;numtimeorders-1){</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;      boundtime[timeorder] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a> + localdt*CUf[timeorder][3]+ localdt*CUf[timeorder][2];</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    }</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;      <span class="comment">// if timeorder==numtimeorders-1, then final step and bound should be set for time of flux of next step, which is full t+dt</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;      boundtime[timeorder] = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a> + localdt;</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    }</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;  }</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="preprocessor">#if(0)</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="preprocessor"></span>  <span class="comment">// DEBUG:</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;  dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;FLUXDT/BOUNDTIME: nstep=%ld &quot;</span>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a1a1088d87617078680f1fd0f0d707384">nstep</a>);</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;  <span class="keywordflow">for</span>(timeorder=0;timeorder&lt;numtimeorders;timeorder++){</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;to=%d fluxdt=%21.15g fluxdtperdt=%21.15g boundtime=%21.15g fluxtime=%21.15g\n&quot;</span>,timeorder,fluxdt[timeorder],fluxdt[timeorder]/<a class="code" href="../../d8/d5b/defs_8general_8h.html#a56db625f31229c5e8b208ff27d464931">dt</a>,boundtime[timeorder],fluxtime[timeorder]);</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  }</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;  dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;}</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="keywordtype">int</span> step_ch_supermpi(<span class="keywordtype">int</span> truestep, <span class="keywordtype">int</span> *dumpingnext, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *fullndt, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*prim)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pstag)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*ucons)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*vpot)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a1c452bce7a227fd9f2c8f937a3c7841c">SHIFTSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#adfe8c351b7f60e189dbd9bfca47af5c5">SHIFTSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a6dc540b0373d80d3ea2db53d03a9fa72">SHIFTSTORE3</a>], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*Bhat)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pl_ct)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR2INTERP], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pr_ct)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR2INTERP],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*F1)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*F2)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*F3)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*Atemp)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a1c452bce7a227fd9f2c8f937a3c7841c">SHIFTSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#adfe8c351b7f60e189dbd9bfca47af5c5">SHIFTSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a6dc540b0373d80d3ea2db53d03a9fa72">SHIFTSTORE3</a>],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*uconstemp)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR])</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;{</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl...">advance</a>(<span class="keywordtype">int</span> truestep, <span class="keywordtype">int</span> stage, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pi)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pb)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pf)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR],</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;              <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pstag)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR],</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;              <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pl_ct)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR2INTERP], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pr_ct)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR2INTERP],</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;              <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*F1)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*F2)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*F3)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>],</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;              <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*vpot)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a1c452bce7a227fd9f2c8f937a3c7841c">SHIFTSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#adfe8c351b7f60e189dbd9bfca47af5c5">SHIFTSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a6dc540b0373d80d3ea2db53d03a9fa72">SHIFTSTORE3</a>],</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;              <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*ui)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*uf)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*ucum)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR],</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;              <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *CUf,<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *CUnew,<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> fluxdt, <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> boundtime, <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> fluxtime, <span class="keywordtype">int</span> timeorder, <span class="keywordtype">int</span> numtimeorders, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *ndt);</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;  <span class="keywordtype">int</span> boundstage;</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;  <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> mydt;</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;  <span class="keywordtype">int</span> stage, stagei,stagef;</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;  <span class="keywordtype">int</span> timeorder;</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> ndt,lastndt;</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pi)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR];</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pb)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR];</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pf)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR];</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*prevpf)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR];</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pii[MAXTIMEORDER])[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR];</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pbb[MAXTIMEORDER])[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR];</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pff[MAXTIMEORDER])[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR];</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*uii[MAXTIMEORDER])[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR];</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*uff[MAXTIMEORDER])[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR];</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*ucum[MAXTIMEORDER])[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR];</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;  <span class="comment">//  FTYPE alphaik[MAXSTAGES][MAXSTAGES],betaik[MAXSTAGES];</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> CUf[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0a72db4856620ff1b9551c885f1b32b5">MAXTIMEORDER</a>][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ab17e7e66eb2bc86b9d61d6bb61a0a4a3" title="NUMDTCUFS also includes what&#39;s necessary for IMEX.">NUMDTCUFS</a>],CUnew[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0a72db4856620ff1b9551c885f1b32b5">MAXTIMEORDER</a>][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ab17e7e66eb2bc86b9d61d6bb61a0a4a3" title="NUMDTCUFS also includes what&#39;s necessary for IMEX.">NUMDTCUFS</a>];</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#ad21ff679aac3fe28202c6d592eafd3e6">i</a>, <a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>, k, pl, pliter;</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;  <span class="keywordtype">int</span> numtimeorders;</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;  <span class="keywordtype">int</span> finalstep;</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;  <span class="comment">//  extern int horizon_flux(FTYPE (*F1)[NSTORE2][NSTORE3][NPR+NSPECIAL], SFTYPE Dt);</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;  <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> fluxdt[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0a72db4856620ff1b9551c885f1b32b5">MAXTIMEORDER</a>], boundtime[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0a72db4856620ff1b9551c885f1b32b5">MAXTIMEORDER</a>], fluxtime[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0a72db4856620ff1b9551c885f1b32b5">MAXTIMEORDER</a>];</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;  <span class="comment">// setup time-stepping</span></div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<span class="comment"></span>  <a class="code" href="../../d9/de0/step__ch_8c.html#a3a2639f03dc596fb0eed62598b420880" title="Setup RK steps for the ith stage:">setup_rktimestep</a>(truestep, &amp;numtimeorders,prim,pstag,ucons,vpot,Bhat,<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pk),pii,pbb,pff,uii,uff,ucum,CUf,CUnew);</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;  <span class="comment">// Obtain initial time of substep, final time of substep, and true dt used for flux conservation that is used to iterate ucum in advance.c</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;<span class="comment"></span>  get_truetime_fluxdt(numtimeorders, <a class="code" href="../../d8/d5b/defs_8general_8h.html#a56db625f31229c5e8b208ff27d464931">dt</a>, CUf, CUnew, fluxdt, boundtime, fluxtime, NULL, NULL);</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  <span class="comment">// SPECIAL BOUNDARY/COMPUTATION MPI METHOD (out of date, and doesn&#39;t yet work right even if essentially complete code)</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;  <span class="comment">/* check timestep */</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;  <span class="comment">//  if (dt &lt; MINDT) {</span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;  <span class="comment">//  trifprintf( &quot;timestep too small\n&quot;);</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;  <span class="comment">//  myexit(11);</span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;  <span class="comment">// }</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;  </div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;  lastndt=1E30; <span class="comment">// initialize lastndt</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;  <span class="keywordflow">for</span>(timeorder=1;timeorder&lt;=numtimeorders;timeorder++){</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    <span class="comment">//the starting and the ending times of the current substep</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;<span class="comment"></span>    <span class="keywordflow">if</span>(timeorder!=numtimeorders-1){</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;      tstepparti = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a> + CUf[timeorder][3] * <a class="code" href="../../d8/d5b/defs_8general_8h.html#a56db625f31229c5e8b208ff27d464931">dt</a>;</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;      tsteppartf = <a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a> + CUf[timeorder][2] * dt +  CUf[timeorder][3] * <a class="code" href="../../d8/d5b/defs_8general_8h.html#a56db625f31229c5e8b208ff27d464931">dt</a>;</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    }</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;      tstepparti=<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>;</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;      tsteppartf=<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a>+<a class="code" href="../../d8/d5b/defs_8general_8h.html#a56db625f31229c5e8b208ff27d464931">dt</a>;</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    }</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    <span class="keywordflow">if</span>(timeorder==numtimeorders-1) finalstep=1; <span class="keywordflow">else</span> finalstep=0;</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;<span class="preprocessor">#if(PRODUCTION==0)</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;<span class="preprocessor"></span>    trifprintf(<span class="stringliteral">&quot;-to%d/%d-&quot;</span>,timeorder,numtimeorders);</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span>(numtimeorders==2){</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;      <span class="comment">// note that pb (used for flux calc which has a stencil</span></div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;      <span class="comment">// calculation) must be different from pf so new stencils in</span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;      <span class="comment">// different stages won&#39;t affect stencil calculations -- must</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;      <span class="comment">// use old values, not new from most previous temporary stage</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;      <span class="comment">// pi however can be the same as pf since each pi is replaced 1</span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;      <span class="comment">// zone at a time with a 0 stencil.</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;      <span class="keywordflow">if</span>(timeorder==1){</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;        pi=prim;</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;        pb=prim;</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;        pf=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pk)[0]; <span class="comment">// different already, so good for simulbccalc</span></div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;        prevpf=prim; <span class="comment">// previous final true array</span></div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;        mydt=0.5*<a class="code" href="../../d8/d5b/defs_8general_8h.html#a56db625f31229c5e8b208ff27d464931">dt</a>;</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;      }</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(timeorder==2){</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;        pi=prim;</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;        pb=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pk)[0];</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;        pf=prim;</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;        prevpf=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pk)[0];</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;        mydt=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a56db625f31229c5e8b208ff27d464931">dt</a>;</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;      }</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    }</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(numtimeorders==1){</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;      pi=prim;</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;      pb=prim;</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="../../dc/dd8/mympi_8definit_8h.html#a03f1dae933f1317ed8f046b200e4963e">SIMULBCCALC</a>&lt;=0) pf=prim; <span class="keywordflow">else</span> pf=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(pk)[0]; <span class="comment">// need to be different if doing simulbccalc</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;      prevpf=prim;</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;      mydt=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a56db625f31229c5e8b208ff27d464931">dt</a>;</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    }</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../dc/dd8/mympi_8definit_8h.html#a03f1dae933f1317ed8f046b200e4963e">SIMULBCCALC</a>&lt;=0){ stagei=<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#affb13608b845e81f4595b80927fbedbd" title="for various uses (dumping and special boundary/comp interchange routine">STAGEM1</a>; stagef=<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#affb13608b845e81f4595b80927fbedbd" title="for various uses (dumping and special boundary/comp interchange routine">STAGEM1</a>; }</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../dc/dd8/mympi_8definit_8h.html#a03f1dae933f1317ed8f046b200e4963e">SIMULBCCALC</a>==1) { stagei=<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#a55cd17c293a7db0ea2fce2d2be563ad8">STAGE0</a>; stagef=<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#a5b294b2a38519989044561129393a5c3">STAGE2</a>;}</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../dc/dd8/mympi_8definit_8h.html#a03f1dae933f1317ed8f046b200e4963e">SIMULBCCALC</a>==2) { stagei=<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#a55cd17c293a7db0ea2fce2d2be563ad8">STAGE0</a>; stagef=<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#ac9e39afa6c08127945b21e93f02a63b0">STAGE5</a>;}</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    </div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    <span class="comment">// initialize bound stage</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../dc/dd8/mympi_8definit_8h.html#a03f1dae933f1317ed8f046b200e4963e">SIMULBCCALC</a>&gt;=1) boundstage=<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#a55cd17c293a7db0ea2fce2d2be563ad8">STAGE0</a>;</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    <span class="keywordflow">else</span> boundstage=<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#affb13608b845e81f4595b80927fbedbd" title="for various uses (dumping and special boundary/comp interchange routine">STAGEM1</a>;</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    <span class="keywordflow">for</span>(stage=stagei;stage&lt;=stagef;stage++){</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;<span class="preprocessor">#if(PRODUCTION==0)</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;<span class="preprocessor"></span>      <span class="keywordflow">if</span>(<a class="code" href="../../dc/dd8/mympi_8definit_8h.html#a03f1dae933f1317ed8f046b200e4963e">SIMULBCCALC</a>&gt;=1) trifprintf(<span class="stringliteral">&quot;!s%d!&quot;</span>,stage);</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;<span class="preprocessor"></span>      <span class="comment">// setup stage loop</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;<span class="preprocessor">#if(SIMULBCCALC==2)</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#if(TYPE2==1)</span></div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;<span class="preprocessor"></span>      <span class="comment">// GODMARK: isf1, etc. are NOT defined?!</span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;      STAGECONDITION(0,<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>-1,0,<a class="code" href="../../da/d3e/definit_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a>-1,<a class="code" href="../../d8/d5b/defs_8general_8h.html#ac769548371cfdcb104296aa22811333a" title="int istart, istop, jstart, jstop;">isc</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#ace42474a807dfc57e99bb79d528b78c0">iec</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa90f6e52a17de1562dcdd726eb291b38">jsc</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a3aac8dc1cb572f01f8f7f5a0de35b76a">jec</a>);</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;      STAGECONDITION(0,<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>,-1,<a class="code" href="../../da/d3e/definit_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a650612b5202ed92c02e960e78e1e9ff7">isf1</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a76b4fc558d1a7e8ea1a0533ffef50834">ief1</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#abaea12b6faca1604cbe559d20621a42d">jsf1</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#adffb8c510a9668c5c79392b0d4b274d6">jef1</a>);</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;      STAGECONDITION(-1,<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>,0,<a class="code" href="../../da/d3e/definit_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a23d6b2064938a152ef9c1d25c555e76c">isf2</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a47d693c9c7280743616e001d1173847b">ief2</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#ab4b09ac6d87218de53ae4724c7fd1c22">jsf2</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a5028d330958e56338b08636b2efaf8ac">jef2</a>);</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;      STAGECONDITION(0,<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>,0,<a class="code" href="../../da/d3e/definit_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a46d98ee4ccf158bb32397df4e6e2a699">ise</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a1902e965378deac60b188bfabfa5a8cb">iee</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a3176f9900037b983a505b27a8b98d86e">jse</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a1b5d2bffcd7e65d93c2fa350e8616862">jee</a>);</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;      STAGECONDITION(0,<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>,0,<a class="code" href="../../da/d3e/definit_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a>-1,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a174cd8e221da77d5138f6ea11c9c1134">isf1ct</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a97efe03a16f8a3b6774ad34f5bca09c8">ief1ct</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a5def428f09feccab9f9679960ab72767">jsf1ct</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a16a0224b4a81b627f2e218f2ffdde0ee">jef1ct</a>);</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;      STAGECONDITION(0,<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>-1,0,<a class="code" href="../../da/d3e/definit_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#acdaeb0b729a1e8ed24e452fafd705e2d">isf2ct</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa2cc2097c2d5016eb369982a8772f063">ief2ct</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#af6793b1aad7290cf173796dd9d298a5e">jsf2ct</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a44ec627200c1a37000f0ba0aabbe0a90">jef2ct</a>);</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;      STAGECONDITION(-1,<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>,-1,<a class="code" href="../../da/d3e/definit_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#af4e0451cc19f8397b9607dac1b578b9c">isdq</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a97e31df4ad51b903d2d6a18f3b49d078">iedq</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a52d44c354d1dfbeaaf816e4dd0a9e699">jsdq</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a096effbc9836605fb005c4bdca9de561">jedq</a>);</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;      STAGECONDITION(-2,<a class="code" href="../../da/d3e/definit_8h.html#abd7b39be02bc15d79b73e5cf2b531299" title="#define CORNGDETVERSION 0">N1</a>+1,-2,<a class="code" href="../../da/d3e/definit_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a>+1,<a class="code" href="../../d8/d5b/defs_8general_8h.html#adf4572f0d0473b3527b3ef992848eaf1">ispdq</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a888b9e762d3818f2b03d4d0c9aa938a3">iepdq</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a7896c1fc09e8fb56b2284aaebd96b582">jspdq</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a3df15866d22e9abf9907385568c7b305">jepdq</a>);</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;      <span class="comment">// GODMARK : probably not right for general boundary condition size</span></div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;      <span class="comment">// only bounding if safe zones, unsafe needs bz complete</span></div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;      <span class="keywordflow">if</span>(stage&lt;<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#a5b294b2a38519989044561129393a5c3">STAGE2</a>){</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;        <a class="code" href="../../d4/dad/bounds_8funcdeclare_8h.html#a4079244d85c301885c1363ca41502869" title="simple bounding during evolution NOTEMARK: Was previously also bounding pstag here, but not necessary since done by calling bound_pstag in fluxctstag.c">bound_beforeevolveprim</a>(boundstage, finalstep, boundtime[timeorder], prevpf,pstag,ucons,USEMPI); <span class="comment">// pstag,ucons not right for supermpi</span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;        <span class="keywordflow">if</span>(stage!=<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#affb13608b845e81f4595b80927fbedbd" title="for various uses (dumping and special boundary/comp interchange routine">STAGEM1</a>) boundstage++;</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;      }</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;      <span class="comment">// done here instead of local since pseudo-complicated calculation that might slow the dq calculation if done locally per zone</span></div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;      <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a0163a499c88dd8b07688e3dbd7007f0e">MYFUN</a>(pre_fixup(stage, prevpf),<span class="stringliteral">&quot;step_ch.c:advance()&quot;</span>, <span class="stringliteral">&quot;pre_fixup()&quot;</span>, 1);</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;      <span class="comment">// go from previous solution to new solution</span></div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;      <a class="code" href="../../d8/d5b/defs_8general_8h.html#afcca9480be48eb42bf67a7290e80e1fe">partialstep</a>=timeorder;      </div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;      <span class="comment">// not right for numtimeorders==4 // GODMARK</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;      <span class="comment">// advance</span></div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;      <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a0163a499c88dd8b07688e3dbd7007f0e">MYFUN</a>(<a class="code" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl...">advance</a>(truestep,-1, pii[timeorder], pbb[timeorder], pff[timeorder], pstag, pl_ct, pr_ct, F1, F2, F3, vpot, uii[timeorder], uff[timeorder], ucum[timeorder],CUf[timeorder], CUnew[timeorder], fluxdt[timeorder], boundtime[timeorder], fluxtime[timeorder], timeorder,numtimeorders,&amp;ndt),<span class="stringliteral">&quot;step_ch.c:step_ch_supermpi()&quot;</span>, <span class="stringliteral">&quot;advance()&quot;</span>, 1);</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;      <span class="comment">// must check before MPI operation (since asymmetries would desynchronize cpus)</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;      <span class="keywordflow">if</span>(stage&lt;<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#a5b294b2a38519989044561129393a5c3">STAGE2</a>){</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;        <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a0163a499c88dd8b07688e3dbd7007f0e">MYFUN</a>(error_check(1),<span class="stringliteral">&quot;step_ch.c&quot;</span>, <span class="stringliteral">&quot;error_check&quot;</span>, 1);</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;      }</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;      <span class="keywordflow">if</span>(stage!=<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#affb13608b845e81f4595b80927fbedbd" title="for various uses (dumping and special boundary/comp interchange routine">STAGEM1</a>){</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;        <span class="keywordflow">if</span>(stage&lt;<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#a5b294b2a38519989044561129393a5c3">STAGE2</a>){</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;          <a class="code" href="../../d4/dad/bounds_8funcdeclare_8h.html#a689fddc1949b1a1d390b59d10d17d83c" title="normal full bounding during evolution NOTEMARK: Was previously also bounding pstag here...">bound_evolveprim</a>(boundstage,finalstep, boundtime[timeorder], prevpf,pstag,ucons,USEMPI);</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;          boundstage++;</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;        }</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;      }</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;      <span class="keywordflow">if</span>(timeorder==numtimeorders){</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;        <span class="keywordflow">if</span>(ndt&gt;lastndt) ndt=lastndt; <span class="comment">// don&#39;t change if last was lower</span></div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;        <span class="keywordflow">else</span> lastndt=ndt; <span class="comment">// new is lower, keep it</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;      }</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;    }</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;    <span class="keywordflow">if</span>(timeorder==numtimeorders){<span class="comment">// only do on full step</span></div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;      <span class="comment">// find global minimum value of ndt over all cpus</span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;      mpifmin(&amp;ndt);</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    }</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    <span class="comment">// done when all stages are completed, so stencil used doesn&#39;t matter</span></div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    </div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a0163a499c88dd8b07688e3dbd7007f0e">MYFUN</a>(post_fixup(<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#affb13608b845e81f4595b80927fbedbd" title="for various uses (dumping and special boundary/comp interchange routine">STAGEM1</a>,finalstep, boundtime[timeorder], pf,pb,ucons),<span class="stringliteral">&quot;step_ch.c:advance()&quot;</span>, <span class="stringliteral">&quot;post_fixup()&quot;</span>, 1);</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;  }</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;  <span class="comment">// pass back the final minimal dt over all substeps</span></div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;  *fullndt = lastndt;</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;  <span class="comment">// copy the contents to the final working array</span></div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;  <span class="keywordflow">if</span>((numtimeorders==1)&amp;&amp;(<a class="code" href="../../dc/dd8/mympi_8definit_8h.html#a03f1dae933f1317ed8f046b200e4963e">SIMULBCCALC</a>&gt;=1)) <a class="code" href="../../df/da8/global_8comploops_8h.html#a73344b9115781fb6586768527d859edd">COMPFULLLOOP</a> <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#af1c67086436007e897bccc458390886f" title="PLOOP controls looping over conserved or primitive -type quantities except during interpolation or ot...">PLOOP</a>(pliter,pl) <a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(prim,i,j,k,pl)=<a class="code" href="../../df/d1c/global_8storage_8h.html#a42b71f60b3fac655a8770411acf0ab62">MACP0A1</a>(pf,i,j,k,pl);</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;  </div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;  <span class="comment">/* done! */</span></div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;  return (0);</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;}</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;</div>
<div class="line"><a name="l01317"></a><span class="lineno"><a class="code" href="../../d9/de0/step__ch_8c.html#a3a2639f03dc596fb0eed62598b420880"> 1317</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d9/de0/step__ch_8c.html#a3a2639f03dc596fb0eed62598b420880" title="Setup RK steps for the ith stage:">setup_rktimestep</a>(<span class="keywordtype">int</span> truestep, <span class="keywordtype">int</span> *numtimeorders,</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;                      <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pstag)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*ucons)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*vpot)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a1c452bce7a227fd9f2c8f937a3c7841c">SHIFTSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#adfe8c351b7f60e189dbd9bfca47af5c5">SHIFTSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a6dc540b0373d80d3ea2db53d03a9fa72">SHIFTSTORE3</a>], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*Bhat)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR],</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;                      <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pk)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR],</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;                      <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pii[MAXTIMEORDER])[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pbb[MAXTIMEORDER])[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pff[MAXTIMEORDER])[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR],</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;                      <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*uii[MAXTIMEORDER])[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*uff[MAXTIMEORDER])[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*ucum[MAXTIMEORDER])[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR],</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;                      <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*CUf)[NUMDTCUFS],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*CUnew)[NUMDTCUFS])</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;{</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;  <span class="comment">// initialize CUf and CUnew to be zero</span></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;  <span class="keywordtype">int</span> ii,jj;</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;  <span class="keywordflow">for</span>(ii=0;ii&lt;<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0a72db4856620ff1b9551c885f1b32b5">MAXTIMEORDER</a>;ii++){</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;    <span class="keywordflow">for</span>(jj=0;jj&lt;<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ab17e7e66eb2bc86b9d61d6bb61a0a4a3" title="NUMDTCUFS also includes what&#39;s necessary for IMEX.">NUMDTCUFS</a>;jj++){</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;      CUf[ii][jj]=CUnew[ii][jj]=0.0;</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;    }</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;  }</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;  </div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;  <span class="comment">// EXPLICIT TIME STEPPING</span></div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a10228b0cb639e1d94eded72900312334">TIMETYPE</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a56de233d8b42babd780f075b155863fa">TIMEEXPLICIT</a>){</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    <span class="comment">// to avoid special copying of final pff-&gt;p, always use p as final pff</span></div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae202d8b69a0ef3f07651368c3de9ca25">TIMEORDER</a>==4 &amp;&amp; truestep){</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;      <span class="comment">// RK4 stepping</span></div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;      *numtimeorders=4;</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;      <span class="comment">// Ui ulast dUe(pb) &lt;timestuff&gt; dUi(Uf)</span></div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;      CUf[0][0]=1.0;  CUf[0][1]=0.0;      CUf[0][2]=0.5;  CUf[0][3] = 0.0;  CUf[0][4+0] = CUf[0][2];</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;      CUf[1][0]=1.0;  CUf[1][1]=0.0;      CUf[1][2]=0.5;  CUf[1][3] = 0.0;  CUf[1][4+1] = CUf[1][2];</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;      CUf[2][0]=1.0;  CUf[2][1]=0.0;      CUf[2][2]=1.0;  CUf[2][3] = 0.0;  CUf[2][4+2] = CUf[2][2];</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;      CUf[3][0]=1.0;  CUf[3][1]=0.0;      CUf[3][2]=1.0;  CUf[3][3] = 0.0;  CUf[3][4+3] = CUf[3][2];</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;      <span class="comment">// Ui dUe(Ub) Uf &lt;timestuff&gt; dUi(Uf)</span></div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;      CUnew[0][0]=1.0;  CUnew[0][1]=1.0/6.0;      CUnew[0][2]=0.0;  CUnew[0][3] = 0.0;  CUnew[0][4+0] = CUnew[0][1];</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;      CUnew[1][0]=0.0;  CUnew[1][1]=1.0/3.0;      CUnew[1][2]=0.0;  CUnew[1][3] = 0.5;  CUnew[1][4+1] = CUnew[1][1];</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;      CUnew[2][0]=0.0;  CUnew[2][1]=1.0/3.0;      CUnew[2][2]=0.0;  CUnew[2][3] = 0.5;  CUnew[2][4+2] = CUnew[2][1];</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;      CUnew[3][0]=0.0;  CUnew[3][1]=1.0/6.0;      CUnew[3][2]=0.0;  CUnew[3][3] = 1.0;  CUnew[3][4+3] = CUnew[3][1];</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;      <span class="comment">//primitive values used for initial state, fluxes, final state (where you output)</span></div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;      pii[0]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>;    pbb[0]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>;       pff[0]=pk[0]; <span class="comment">// produces U1</span></div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;      pii[1]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>;    pbb[1]=pk[0];   pff[1]=pk[1]; <span class="comment">// produces U2</span></div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;      pii[2]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>;    pbb[2]=pk[1];   pff[2]=pk[0]; <span class="comment">// produces U3</span></div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;      pii[3]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>;    pbb[3]=pk[0];   pff[3]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>; <span class="comment">// produces U4 (only dUe part used)</span></div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    </div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;      <span class="comment">// GODMARK: use of globals: just scratch anyways</span></div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;      uii[0]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(uinitialglobal);  uff[0]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(ulastglobal); ucum[0]=ucons;</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;      uii[1]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(uinitialglobal);  uff[1]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(ulastglobal); ucum[1]=ucons;</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;      uii[2]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(uinitialglobal);  uff[2]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(ulastglobal); ucum[2]=ucons;</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;      uii[3]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(uinitialglobal);  uff[3]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(ulastglobal); ucum[3]=ucons;</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;      <span class="comment">// GODMARK: note that pbstag (staggered field from conserved de-averaging and inversion to primitive no geometry version) is always same memory space and comes from operating on final inverted quantity (ulastglobal or ucons), so just use same quantity for now and avoid adding extra code for pbstag[]</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;      <span class="comment">//    pbstag[0]=pstagglobal;</span></div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;      <span class="comment">//    pbstag[1]=pstagglobal;</span></div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;      <span class="comment">//    pbstag[2]=pstagglobal;</span></div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;      <span class="comment">//    pbstag[3]=pstagglobal;</span></div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    }</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae202d8b69a0ef3f07651368c3de9ca25">TIMEORDER</a>==3  &amp;&amp; truestep){</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;      <span class="comment">// TVD optimal RK3 method as in Shu&#39;s report</span></div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;      *numtimeorders=3;</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    </div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;      <span class="comment">// Ui ulastglobal dUe(pb) &lt;timestuff&gt; dUi(Uf)</span></div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;      CUf[0][0]=1.0;      CUf[0][1]=0.0;      CUf[0][2]=1.0;      CUf[0][3] = 0.0;  CUf[0][4+0] = CUf[0][2];</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;      CUf[1][0]=3.0/4.0;  CUf[1][1]=1.0/4.0;  CUf[1][2]=1.0/4.0;  CUf[1][3] = 0.0;  CUf[1][4+1] = CUf[1][2];</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;      CUf[2][0]=1.0/3.0;  CUf[2][1]=2.0/3.0;  CUf[2][2]=2.0/3.0;  CUf[2][3] = 0.0;  CUf[2][4+2] = CUf[2][2];</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    </div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;      <span class="comment">// Ui dUe(Ub) Uf &lt;timestuff&gt; dUi(Uf)</span></div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;      <span class="comment">// ucons=U3</span></div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;      CUnew[0][0]=0.0;   CUnew[0][1]=0.0;      CUnew[0][2]=0.0;  CUnew[0][3] = 0.0;     CUnew[0][4+0] = CUnew[0][1];</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;      CUnew[1][0]=0.0;   CUnew[1][1]=0.0;      CUnew[1][2]=0.0;  CUnew[1][3] = 1.0;     CUnew[1][4+1] = CUnew[1][1];</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;      CUnew[2][0]=0.0;   CUnew[2][1]=0.0;      CUnew[2][2]=1.0;  CUnew[2][3] = 1.0/4.0; CUnew[2][4+2] = CUnew[2][1];</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    </div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;      <span class="comment">//always starting the substeps from the initial time</span></div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;      pii[0]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>;      pbb[0]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>;       pff[0]=pk[0]; <span class="comment">// produces U1</span></div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;      pii[1]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>;      pbb[1]=pk[0];   pff[1]=pk[1]; <span class="comment">// produces U2</span></div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;      pii[2]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>;      pbb[2]=pk[1];   pff[2]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>; <span class="comment">// produces U3</span></div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;      <span class="comment">// GODMARK: use of globals: just scratch anyways</span></div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;      uii[0]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(uinitialglobal);  uff[0]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(ulastglobal); ucum[0]=ucons;</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;      uii[1]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(uinitialglobal);  uff[1]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(ulastglobal); ucum[1]=ucons;</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;      uii[2]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(uinitialglobal);  uff[2]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(ulastglobal); ucum[2]=ucons;</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    }</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae202d8b69a0ef3f07651368c3de9ca25">TIMEORDER</a>==2  &amp;&amp; truestep){</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;<span class="preprocessor">#if(1)</span></div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;<span class="preprocessor"></span>      <span class="comment">// midpoint method</span></div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;      *numtimeorders=2;</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;      <span class="comment">// old ucons not used for this method (i.e. [?][1]=0)</span></div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;      <span class="comment">// Ui ulast dUe(pb) &lt;timestuff&gt; dUi(Uf)</span></div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;      CUf[0][0]=1.0; CUf[0][1]=0.0; CUf[0][2]=0.5; CUf[0][3] = 0.0;  CUf[0][4+0] = CUf[0][2];</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;      CUf[1][0]=1.0; CUf[1][1]=0.0; CUf[1][2]=1.0; CUf[1][3] = 0.0;  CUf[1][4+1] = CUf[1][2];</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;      <span class="comment">// Ui dUe(Ub) Uf &lt;timestuff&gt; dUi(Uf)</span></div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;      <span class="comment">// ucons=U2</span></div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;      CUnew[0][0]=0.0;   CUnew[0][1]=0.0;      CUnew[0][2]=0.0;  CUnew[0][3] = 0.0;  CUnew[0][4+0] = CUnew[0][1];</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;      CUnew[1][0]=0.0;   CUnew[1][1]=0.0;      CUnew[1][2]=1.0;  CUnew[1][3] = 0.5;  CUnew[1][4+1] = CUnew[1][1];</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;      pii[0]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>;    pbb[0]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>;       pff[0]=pk[0];</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;      pii[1]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>;    pbb[1]=pk[0];   pff[1]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>;</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;      <span class="comment">// GODMARK: use of globals: just scratch anyways</span></div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;      uii[0]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(uinitialglobal);  uff[0]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(ulastglobal); ucum[0]=ucons;</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;      uii[1]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(uinitialglobal);  uff[1]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(ulastglobal); ucum[1]=ucons;</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;<span class="preprocessor"></span>      *numtimeorders=2;</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;      <span class="comment">// TVD RK2 (Chi-Wang Shu 1997 - eq 4.10)</span></div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;      <span class="comment">// actually less robust than generic midpoint method above</span></div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;      <span class="comment">// Ui ulast dUe(pb) &lt;timestuff&gt; dUi(Uf)</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;      CUf[0][0]=1.0; CUf[0][1]=0.0; CUf[0][2]=1.0; CUf[0][3] = 0.0;  CUf[0][4+0] = CUf[0][2];</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;      CUf[1][0]=0.5; CUf[1][1]=0.5; CUf[1][2]=0.5; CUf[1][3] = 0.0;  CUf[1][4+1] = CUf[1][2];</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;      <span class="comment">// Ui dUe(Ub) Uf &lt;timestuff&gt; dUi(Uf)</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;      <span class="comment">// ucons=U2</span></div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;      CUnew[0][0]=0.0;   CUnew[0][1]=0.0;      CUnew[0][2]=0.0;   CUnew[0][3] = 0.0;  CUnew[0][4+0] = CUnew[0][1];</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;      CUnew[1][0]=0.0;   CUnew[1][1]=0.0;      CUnew[1][2]=1.0;   CUnew[1][3] = 1.0;  CUnew[1][4+1] = CUnew[1][1];</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;      pii[0]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>;    pbb[0]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>;       pff[0]=pk[0];</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;      pii[1]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>;    pbb[1]=pk[0];   pff[1]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>;</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;      <span class="comment">// GODMARK: use of globals: just scratch anyways</span></div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;      uii[0]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(uinitialglobal);  uff[0]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(ulastglobal); ucum[0]=ucons;</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;      uii[1]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(uinitialglobal);  uff[1]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(ulastglobal); ucum[1]=ucons;</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;<span class="preprocessor"></span>    }</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae202d8b69a0ef3f07651368c3de9ca25">TIMEORDER</a>==1 ||  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a56db625f31229c5e8b208ff27d464931">dt</a>==0.0){ <span class="comment">// dt==0.0 case is case when just passing through</span></div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;      <span class="comment">// Euler method</span></div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;      *numtimeorders=1;</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;      <span class="comment">// Ui ulast dUe(pb) &lt;timestuff&gt; dUi(Uf)</span></div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;      CUf[0][0]=1.0; CUf[0][1]=0.0; CUf[0][2]=1.0; CUf[0][3] = 0.0;   CUf[0][4] = CUf[0][2];</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;      <span class="comment">// Ui dUe(Ub) Uf &lt;timestuff&gt; dUi(Uf)</span></div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;      <span class="comment">// ucons=U1</span></div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;      CUnew[0][0]=0.0;   CUnew[0][1]=0.0;      CUnew[0][2]=1.0;   CUnew[1][3] = 0.0;     CUnew[1][4] = CUnew[0][1];</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;      pii[0]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>;    pbb[0]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>;    pff[0]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>;</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;      <span class="comment">// GODMARK: use of globals: just scratch anyways</span></div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;      uii[0]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(uinitialglobal);  uff[0]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(ulastglobal); ucum[0]=ucons;</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    }</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;  }</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;  <span class="comment">// IMPLICIT TIME STEPPING</span></div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;  <span class="comment">// First stage is just implicit solution (no flux needed)</span></div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;  <span class="comment">// Last stage is just flux (no implicit source term needed (i.e. no M[timeorder-1] needed), but geometry or any other explicits still needed)</span></div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;  <span class="comment">// to avoid special copying of final pff-&gt;p, always use p as final pff</span></div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;<span class="comment"></span>  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a10228b0cb639e1d94eded72900312334">TIMETYPE</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ad898cf724e1b1416d754ec94320d9770">TIMEIMPLICIT</a>){</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae202d8b69a0ef3f07651368c3de9ca25">TIMEORDER</a>==5 &amp;&amp; truestep){</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;      <span class="comment">// IMEX3</span></div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;      *numtimeorders=5;</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;      <span class="keyword">static</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> imp_alpha=0.24169426078821;</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;      <span class="keyword">static</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> imp_beta=0.06042356519705;</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;      <span class="keyword">static</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> imp_eta=0.12915286960590;</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;      <span class="comment">// Ui ulast dUe(pb) &lt;timestuff&gt; dUi(Uf)</span></div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;      CUf[0][0]=1.0;     CUf[0][1]=0.0;      CUf[0][2]=0.0;     CUf[0][3] = 0.0;  CUf[0][4+0] = imp_alpha; <span class="comment">// M0 no flux step : U0 = [Un] + \alpha dt M0</span></div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;      CUf[1][0]=2.0;     CUf[1][1]=-1.0;     CUf[1][2]=0.0;     CUf[1][3] = 0.0;  CUf[1][4+1] = imp_alpha; <span class="comment">// M1 no flux step : U1 = [2Un - U0] + \alpha dt M1</span></div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;      CUf[2][0]=1.0;     CUf[2][1]=0.0;      CUf[2][2]=1.0;     CUf[2][3] = 0.0;  CUf[2][4+1] = (1.0-imp_alpha);  CUf[2][4+2] = imp_alpha; <span class="comment">// M2 and F1 : U2 = [Un + dt F1 + (1-\alpha) dt M1] + \alpha dt M2</span></div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;      CUf[3][0]=3.0/4.0; CUf[3][1]=1.0/4.0;  CUf[3][2]=1.0/4.0; CUf[3][3] = 0.0;  CUf[3][4+0] = imp_beta; CUf[3][4+1] = (-1.0+imp_alpha+4.0*imp_eta)/4.0;  CUf[3][4+2] = (2.0-5.0*imp_alpha-4.0*(imp_beta+imp_eta))/4.0; CUf[3][4+3] = imp_alpha; <span class="comment">// M3 and F2 : U3 = [(3/4)Un + (1/4)U2 + (dt/4)F2 + \beta dt M0 + (1/4)(-1+\alpha+4\eta) dt M1 + (1/4)(2-5\alpha-4(\beta+\eta)) dt M2] + \alpha dt M3</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;      CUf[4][0]=1.0/3.0; CUf[4][1]=2.0/3.0;  CUf[4][2]=2.0/3.0; CUf[4][3] = 0.0;  CUf[4][4+0] = (-2.0*imp_beta/3.0); CUf[4][4+1] = (1.0-4.0*imp_eta)/6.0; CUf[4][4+2] = (-1.0+4.0*imp_alpha+4.0*(imp_beta+imp_eta))/6.0; CUf[4][4+3] = 4.0*(1.0-imp_alpha)/6.0; <span class="comment">// F3 : U4 = [(1/3)Un + (2/3)U3 + (2dt/3) F3 + (-2beta dt/3) M0 + (1/6)(1-4\eta) dt M1 + (1/6)(-1 + 4\alpha + 4(\beta+\eta)) dt M2 + (1/6)(4(1-\alpha))dt M3]</span></div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;      <span class="comment">// Ui dUe(Ub) Uf &lt;timestuff&gt; dUi(Uf)</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;      <span class="comment">// NOTE: Could instead only use final U^{n+1} = U4 as possible for this case and setup above for final step, but current way is more local and really would require less memory (but not implemented to do that)</span></div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;      CUnew[0][0]=1.0/3.0; CUnew[0][1]=0.0;          CUnew[0][2]=0.0;     CUnew[0][3] = 0.0;  CUnew[0][4+0] = (-2.0*imp_beta/3.0); <span class="comment">// + (1/3)Un + (-2\beta/3) dt M0</span></div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;      CUnew[1][0]=0.0;     CUnew[1][1]=0.0;          CUnew[1][2]=0.0;     CUnew[1][3] = 0.0;  CUnew[1][4+1] = (1.0-4.0*imp_eta)/6.0; <span class="comment">// + ((1-4\eta)/6) dt M1</span></div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;      CUnew[2][0]=0.0;     CUnew[2][1]=0.0;          CUnew[2][2]=0.0;     CUnew[2][3] = 0.0;  CUnew[2][4+2] = (-1.0+4.0*imp_alpha+4.0*(imp_beta+imp_eta))/6.0; <span class="comment">// + ( (-1 + 4\alpha + 4(\beta+\eta))/6) dt M2</span></div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;      CUnew[3][0]=0.0;     CUnew[3][1]=0.0;          CUnew[3][2]=2.0/3.0; CUnew[3][3] = 0.0;  CUnew[3][4+3] = 4.0*(1.0-imp_alpha)/6.0; <span class="comment">// + (2/3)U3 + (4(1-\alpha)/6) dt M3</span></div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;      CUnew[4][0]=0.0;     CUnew[4][1]=2.0/3.0;      CUnew[4][2]=0.0;     CUnew[4][3] = 0.0;  CUnew[4][4+4] = 0.0; <span class="comment">// + (2/3)dt F3</span></div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;      <span class="comment">//primitive values used for initial state, fluxes, final state (where you output)</span></div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;      pii[0]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>;    pbb[0]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>;       pff[0]=pk[0]; <span class="comment">// produces U1</span></div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;      pii[1]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>;    pbb[1]=pk[0];   pff[1]=pk[1]; <span class="comment">// produces U2</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;      pii[2]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>;    pbb[2]=pk[1];   pff[2]=pk[0]; <span class="comment">// produces U3</span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;      pii[3]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>;    pbb[3]=pk[0];   pff[3]=pk[1]; <span class="comment">// produces U4 (only dUe part used)</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;      pii[4]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>;    pbb[4]=pk[1];   pff[4]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>; <span class="comment">// produces U5 (only dUe part used)</span></div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    </div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;      <span class="comment">// GODMARK: use of globals: just scratch anyways</span></div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;      uii[0]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(uinitialglobal);  uff[0]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(ulastglobal); ucum[0]=ucons;</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;      uii[1]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(uinitialglobal);  uff[1]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(ulastglobal); ucum[1]=ucons;</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;      uii[2]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(uinitialglobal);  uff[2]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(ulastglobal); ucum[2]=ucons;</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;      uii[3]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(uinitialglobal);  uff[3]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(ulastglobal); ucum[3]=ucons;</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;      uii[4]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(uinitialglobal);  uff[4]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(ulastglobal); ucum[4]=ucons;</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;    }</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae202d8b69a0ef3f07651368c3de9ca25">TIMEORDER</a>==4 &amp;&amp; truestep){</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;      <span class="comment">// IMEX2B</span></div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;      *numtimeorders=4;</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;      <span class="comment">// Ui ulast dUe(pb) &lt;timestuff&gt; dUi(Uf)</span></div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;      CUf[0][0]=1.0;     CUf[0][1]=0.0;      CUf[0][2]=0.0;     CUf[0][3] = 0.0;  CUf[0][4+0] = 1.0/4.0;   <span class="comment">// M0 no flux step : U0 = [Un] + (dt/4)M0</span></div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;      CUf[1][0]=1.0;     CUf[1][1]=0.0;      CUf[1][2]=0.5;     CUf[1][3] = 0.0;  CUf[1][4+1] = 1.0/4.0;   <span class="comment">// F0 and M1 : U1 = [Un + (dt/2)F0] + (dt/4)M1</span></div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;      CUf[2][0]=0.0;     CUf[2][1]=1.0;      CUf[2][2]=1.0/2.0; CUf[2][3] = 0.0;  CUf[2][4+0] = 1.0/3.0; CUf[2][4+1] = 1.0/12.0; CUf[2][4+2] = 1.0/3.0; <span class="comment">// F1 and M2 : U2 = [U1 + (dt/2)F1 + (dt/3)M0 + (dt/12)M1] + (dt/3)M2</span></div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;      CUf[3][0]=1.0/3.0; CUf[3][1]=2.0/3.0;  CUf[3][2]=1.0/3.0; CUf[3][3] = 0.0;  CUf[3][4+0] = 1.0/9.0; CUf[3][4+1] = 1.0/9.0;  CUf[3][4+2] = 1.0/9.0; <span class="comment">// F2 no new implicit step // U3 = [(1/3)Un + (2/3)U2 + (dt/3)F2 + (dt/9)(M0 + M1 + M2)]</span></div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;      <span class="comment">// Ui dUe(Ub) Uf &lt;timestuff&gt; dUi(Uf)</span></div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;      <span class="comment">// NOTE: Could instead only use final U^{n+1} = U3 as possible for this case and setup above for final step, but current way is more local and really would require less memory (but not implemented to do that)</span></div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;      CUnew[0][0]=1.0/3.0; CUnew[0][1]=0.0;          CUnew[0][2]=0.0;     CUnew[0][3] = 0.0;  CUnew[0][4+0] = (1.0/9.0);   <span class="comment">// + (1/3)Un + (1/9)M0</span></div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;      CUnew[1][0]=0.0;     CUnew[1][1]=0.0;          CUnew[1][2]=0.0;     CUnew[1][3] = 0.0;  CUnew[1][4+1] = (1.0/9.0);   <span class="comment">// + (1/9)dt M1</span></div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;      CUnew[2][0]=0.0;     CUnew[2][1]=0.0;          CUnew[2][2]=2.0/3.0; CUnew[2][3] = 0.0;  CUnew[2][4+2] = (1.0/9.0);   <span class="comment">// + (2/3)U2 + (1/9)dt M2</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;      CUnew[3][0]=0.0;     CUnew[3][1]=1.0/3.0;      CUnew[3][2]=0.0;     CUnew[3][3] = 0.0;  CUnew[3][4+3] = 0.0;         <span class="comment">// + (1/3)dt F2</span></div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;      <span class="comment">//primitive values used for initial state, fluxes, final state (where you output)</span></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;      pii[0]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>;    pbb[0]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>;       pff[0]=pk[0]; <span class="comment">// produces U1</span></div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;      pii[1]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>;    pbb[1]=pk[0];   pff[1]=pk[1]; <span class="comment">// produces U2</span></div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;      pii[2]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>;    pbb[2]=pk[1];   pff[2]=pk[0]; <span class="comment">// produces U3</span></div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;      pii[3]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>;    pbb[3]=pk[0];   pff[3]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>; <span class="comment">// produces U4 (only dUe part used)</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;    </div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;      <span class="comment">// GODMARK: use of globals: just scratch anyways</span></div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;      uii[0]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(uinitialglobal);  uff[0]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(ulastglobal); ucum[0]=ucons;</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;      uii[1]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(uinitialglobal);  uff[1]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(ulastglobal); ucum[1]=ucons;</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;      uii[2]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(uinitialglobal);  uff[2]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(ulastglobal); ucum[2]=ucons;</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;      uii[3]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(uinitialglobal);  uff[3]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(ulastglobal); ucum[3]=ucons;</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;    }</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae202d8b69a0ef3f07651368c3de9ca25">TIMEORDER</a>==3  &amp;&amp; truestep){</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;      <span class="comment">// IMEX2</span></div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;      *numtimeorders=3;</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;      <span class="comment">//      static FTYPE sqrt2=1.414213562373095048802;</span></div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;      <span class="keyword">static</span> <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> imp_gamma = 0.2928932188134524755992; <span class="comment">// 1.0 - 1.0/sqrt2;</span></div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160; </div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;      <span class="comment">// Ui ulastglobal dUe(pb) &lt;timestuff&gt; dUi(Uf)</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;      CUf[0][0]=1.0;                            CUf[0][1]=0.0;                            CUf[0][2]=0.0;      CUf[0][3] = 0.0;  CUf[0][4+0] = imp_gamma; <span class="comment">// M0 no flux step : U0 = [Un] + \gamma dt M0</span></div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;      CUf[1][0]=(3.0*imp_gamma-1.0)/imp_gamma;  CUf[1][1]=(1.0-2.0*imp_gamma)/imp_gamma;  CUf[1][2]=1.0;      CUf[1][3] = 0.0;  CUf[1][4+1] = imp_gamma; <span class="comment">// computes F0 and M1 : U1 = [ (1/gamma)(3\gamma-1) Un + (1/\gamma)(1-2\gamma) U0 + dt F0] + \gamma dt M1</span></div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;      CUf[2][0]=1.0/2.0;                        CUf[2][1]=1.0/2.0;                        CUf[2][2]=1.0/2.0;  CUf[2][3] = 0.0;  CUf[2][4+0] = imp_gamma; CUf[2][4+1]=(1.0-imp_gamma)/2.0; <span class="comment">// F1 no new implicit step : U2 = [(1/2)Un + (1/2)U1 + (dt/2)F1 + \gamma dt M0 + (1/2)(1-\gamma) dt M1]</span></div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;    </div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;      <span class="comment">// Ui dUe(Ub) Uf &lt;timestuff&gt; dUi(Uf)</span></div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;      <span class="comment">// ucons=U3</span></div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;      <span class="comment">// NOTE: Could instead only use final U^{n+1} = U2 as possible for this case and setup above for final step, but current way is more local and really would require less memory (but not implemented to do that)</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;      CUnew[0][0]=0.5;   CUnew[0][1]=0.0;      CUnew[0][2]=0.0;  CUnew[0][3] = 0.0;  CUnew[0][4+0]=imp_gamma;             <span class="comment">// + (1/2)Un + dt\gamma M0</span></div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;      CUnew[1][0]=0.0;   CUnew[1][1]=0.0;      CUnew[1][2]=0.5;  CUnew[1][3] = 0.0;  CUnew[1][4+1]=(1.0-imp_gamma)/2.0;   <span class="comment">// + (1/2)U1 + (1/2)(1-\gamma)M1</span></div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;      CUnew[2][0]=0.0;   CUnew[2][1]=1.0/2.0;  CUnew[2][2]=0.0;  CUnew[2][3] = 0.0;                                       <span class="comment">// + (1/2)dt F1</span></div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;    </div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;      <span class="comment">//always starting the substeps from the initial time</span></div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;      pii[0]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>;      pbb[0]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>;       pff[0]=pk[0]; <span class="comment">// produces U1</span></div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;      pii[1]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>;      pbb[1]=pk[0];   pff[1]=pk[1]; <span class="comment">// produces U2</span></div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;      pii[2]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>;      pbb[2]=pk[1];   pff[2]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>; <span class="comment">// produces U3</span></div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;      <span class="comment">// GODMARK: use of globals: just scratch anyways</span></div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;      uii[0]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(uinitialglobal);  uff[0]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(ulastglobal); ucum[0]=ucons;</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;      uii[1]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(uinitialglobal);  uff[1]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(ulastglobal); ucum[1]=ucons;</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;      uii[2]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(uinitialglobal);  uff[2]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(ulastglobal); ucum[2]=ucons;</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;    }</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae202d8b69a0ef3f07651368c3de9ca25">TIMEORDER</a>==2  &amp;&amp; truestep){</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;      <span class="comment">// IMEX1B = Backward Euler (1st order implicit, 2nd order explicit)</span></div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;      *numtimeorders=2;</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;      <span class="comment">// old ucons not used for this method (i.e. [?][1]=0)</span></div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;      <span class="comment">// Ui ulast dUe(pb) &lt;timestuff&gt; dUi(Uf)</span></div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;      CUf[0][0]=1.0; CUf[0][1]=0.0; CUf[0][2]=0.5; CUf[0][3] = 0.0;  CUf[0][4+0] = CUf[0][2];</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;      CUf[1][0]=1.0; CUf[1][1]=0.0; CUf[1][2]=1.0; CUf[1][3] = 0.0;  CUf[1][4+1] = CUf[1][2];</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;      <span class="comment">// Ui dUe(Ub) Uf &lt;timestuff&gt; dUi(Uf)</span></div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;      <span class="comment">// ucons=U2</span></div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;      CUnew[0][0]=0.0;   CUnew[0][1]=0.0;      CUnew[0][2]=0.0;  CUnew[0][3] = 0.0;  CUnew[0][4+0] = CUnew[0][1];</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;      CUnew[1][0]=0.0;   CUnew[1][1]=0.0;      CUnew[1][2]=1.0;  CUnew[1][3] = 0.0;  CUnew[1][4+1] = CUnew[1][1];</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;      pii[0]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>;    pbb[0]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>;       pff[0]=pk[0];</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;      pii[1]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>;    pbb[1]=pk[0];   pff[1]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>;</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;      <span class="comment">// GODMARK: use of globals: just scratch anyways</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;      uii[0]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(uinitialglobal);  uff[0]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(ulastglobal); ucum[0]=ucons;</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;      uii[1]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(uinitialglobal);  uff[1]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(ulastglobal); ucum[1]=ucons;</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;    }</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae202d8b69a0ef3f07651368c3de9ca25">TIMEORDER</a>==1 ||  <a class="code" href="../../d8/d5b/defs_8general_8h.html#a56db625f31229c5e8b208ff27d464931">dt</a>==0.0){ <span class="comment">// dt==0.0 case is case when just passing through</span></div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;      <span class="comment">// Euler method = IMEX1 (1st order implicit, 1st order explicit)</span></div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;      *numtimeorders=1;</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;      <span class="comment">// Ui ulast dUe(pb) &lt;timestuff&gt; dUi(Uf)</span></div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;      CUf[0][0]=1.0; CUf[0][1]=0.0; CUf[0][2]=1.0; CUf[0][3] = 0.0;   CUf[0][4] = CUf[0][2];</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;      <span class="comment">// Ui dUe(Ub) Uf &lt;timestuff&gt; dUi(Uf)</span></div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;      <span class="comment">// ucons=U1</span></div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;      CUnew[0][0]=0.0;   CUnew[0][1]=0.0;      CUnew[0][2]=1.0;   CUnew[1][3] = 0.0;     CUnew[1][4] = CUnew[0][1];</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;      pii[0]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>;    pbb[0]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>;    pff[0]=<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>;</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;      <span class="comment">// GODMARK: use of globals: just scratch anyways</span></div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;      uii[0]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(uinitialglobal);  uff[0]=<a class="code" href="../../df/d1c/global_8storage_8h.html#ad89dafa5d772b862a44b0f576983ead3" title="shifted pointer (a_s_) wrappers Couldn&#39;t figure out how to macrofy a_s_ or a_, so when changing have ...">GLOBALPOINT</a>(ulastglobal); ucum[0]=ucons;</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;    }</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;  }</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;  </div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;}</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;<span class="comment">// System boundary routines that calls other system routines and user routines</span></div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;<span class="comment">// Who calls bound_anypstag():</span></div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;<span class="comment">// v1)</span></div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;<span class="comment">// step_ch.c: bound_evolveprim calls bound_allprim calls bound_anyallprim calls bound_anypstag</span></div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;<span class="comment">// step_ch.c: bound_beforeevolveprim calls bound_anyallprim calls bound_anypstag</span></div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;<span class="comment">// fluxctstag.c : bound_pstag calls bound_anypstag</span></div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;<span class="comment">// v2)</span></div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;<span class="comment">// But if bound pstag in fluxctstag.c so Bcent can be interpolated from Bstag, then don&#39;t need to do it again!</span></div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;<span class="comment">// fluxctstag.c : bound_pstag calls bound_anypstag</span></div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;</div>
<div class="line"><a name="l01663"></a><span class="lineno"><a class="code" href="../../d9/de0/step__ch_8c.html#a689fddc1949b1a1d390b59d10d17d83c"> 1663</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d4/dad/bounds_8funcdeclare_8h.html#a689fddc1949b1a1d390b59d10d17d83c" title="normal full bounding during evolution NOTEMARK: Was previously also bounding pstag here...">bound_evolveprim</a>(<span class="keywordtype">int</span> boundstage, <span class="keywordtype">int</span> finalstep, <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> boundtime, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*prim)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pstag)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*ucons)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <span class="keywordtype">int</span> doboundmpi)</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;{</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;  <span class="keywordtype">int</span> boundvartype=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2eddd9ab5ac3f8f5a8a8b62288b76f89">BOUNDPRIMTYPE</a>;</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;  <a class="code" href="../../d4/dad/bounds_8funcdeclare_8h.html#adbe0e3ba8a74f09ab928a96bd68cab6d" title="bound any prim type CALLS directly real and MPI boundary functions pstag = pstagglobal ucons = unewgl...">bound_anyprim</a>(boundstage, finalstep, boundtime, boundvartype, prim, pstag, ucons,doboundmpi);</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#af8fe447ae4f447a0823daaedab6364f9">unewisavg</a> &amp;&amp; <a class="code" href="../../da/d3e/definit_8h.html#aa34f95834323f30fabab0fe40f6782e0" title="whether to bound unew (GODMARK: no separate algorithm yet, so only works for non-outflow boundary con...">BOUNDUNEW</a>){</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;    <span class="comment">// SUPERGODMARK:</span></div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;    <span class="comment">// if not outflow boundary, then can bound u as p</span></div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;    <span class="comment">// desirable since machine errors can be different and lead to secular changes</span></div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    <span class="comment">// esp. in MPI</span></div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;    bound_uavg(boundstage, finalstep, boundtime, boundvartype, ucons,pstag, ucons,doboundmpi);</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;  }</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;  <span class="comment">//  bound_allprim(boundstage,finalstep, boundtime, prim,pstag,ucons,doboundmpi);</span></div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;}</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;</div>
<div class="line"><a name="l01688"></a><span class="lineno"><a class="code" href="../../d9/de0/step__ch_8c.html#a4079244d85c301885c1363ca41502869"> 1688</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d4/dad/bounds_8funcdeclare_8h.html#a4079244d85c301885c1363ca41502869" title="simple bounding during evolution NOTEMARK: Was previously also bounding pstag here, but not necessary since done by calling bound_pstag in fluxctstag.c">bound_beforeevolveprim</a>(<span class="keywordtype">int</span> boundstage,<span class="keywordtype">int</span> finalstep, <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> boundtime, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*prim)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pstag)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*ucons)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <span class="keywordtype">int</span> doboundmpi)</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;{</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;  <span class="keywordtype">int</span> boundvartype=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a5a2d92d15a373d4e19c816cf1e631d4a">BOUNDPRIMSIMPLETYPE</a>; <span class="comment">// tells boundary routines that only bounding 1 layer deep</span></div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;  <a class="code" href="../../d4/dad/bounds_8funcdeclare_8h.html#adbe0e3ba8a74f09ab928a96bd68cab6d" title="bound any prim type CALLS directly real and MPI boundary functions pstag = pstagglobal ucons = unewgl...">bound_anyprim</a>(boundstage, finalstep, boundtime, boundvartype, prim, pstag, ucons,doboundmpi);</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#af8fe447ae4f447a0823daaedab6364f9">unewisavg</a> &amp;&amp; <a class="code" href="../../da/d3e/definit_8h.html#aa34f95834323f30fabab0fe40f6782e0" title="whether to bound unew (GODMARK: no separate algorithm yet, so only works for non-outflow boundary con...">BOUNDUNEW</a>){</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;    <span class="comment">// SUPERGODMARK:</span></div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;    <span class="comment">// if not outflow boundary, then can bound u as p</span></div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;    <span class="comment">// desirable since machine errors can be different and lead to secular changes</span></div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;    <span class="comment">// esp. in MPI</span></div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;    bound_uavg(boundstage, finalstep, boundtime, boundvartype, ucons,pstag, ucons,doboundmpi);</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;  }</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;}</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;</div>
<div class="line"><a name="l01709"></a><span class="lineno"><a class="code" href="../../d9/de0/step__ch_8c.html#addca75a18cc861326a321565a2e81aa0"> 1709</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d4/dad/bounds_8funcdeclare_8h.html#addca75a18cc861326a321565a2e81aa0" title="normal bounding of non-staggered primitives">bound_prim</a>(<span class="keywordtype">int</span> boundstage, <span class="keywordtype">int</span> finalstep, <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> boundtime, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*prim)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pstag)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*ucons)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <span class="keywordtype">int</span> doboundmpi)</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;{</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;  <span class="keywordtype">int</span> boundvartype=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2eddd9ab5ac3f8f5a8a8b62288b76f89">BOUNDPRIMTYPE</a>;</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;  <a class="code" href="../../d4/dad/bounds_8funcdeclare_8h.html#adbe0e3ba8a74f09ab928a96bd68cab6d" title="bound any prim type CALLS directly real and MPI boundary functions pstag = pstagglobal ucons = unewgl...">bound_anyprim</a>(boundstage, finalstep, boundtime, boundvartype, prim, pstag, ucons,doboundmpi);</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;}</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;</div>
<div class="line"><a name="l01721"></a><span class="lineno"><a class="code" href="../../d9/de0/step__ch_8c.html#a6f4b963a50a7288964f01775f2f18bb9"> 1721</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d4/dad/bounds_8funcdeclare_8h.html#a6f4b963a50a7288964f01775f2f18bb9" title="normal bounding of staggered primitives">bound_pstag</a>(<span class="keywordtype">int</span> boundstage, <span class="keywordtype">int</span> finalstep, <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> boundtime, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*prim)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pstag)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*ucons)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <span class="keywordtype">int</span> doboundmpi)</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;{</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;  <span class="keywordtype">int</span> boundvartype=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a27c72ab7c1aed0da90fe96a0c6c3ac36">BOUNDPSTAGTYPE</a>;</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;  <a class="code" href="../../d4/dad/bounds_8funcdeclare_8h.html#abdea68b778dc9253324da69d3c376965" title="bound any pstag type CALLS directly real and MPI boundary functions pstag is at FACE1,2,3 for fields, so user bound is different MPI bounding is the same as CENT quantities used when restarting in initbase.c to bound unewglobal for FLUXB==FLUXCTSTAG">bound_anypstag</a>(boundstage, finalstep, boundtime, boundvartype, prim, pstag, ucons,doboundmpi);</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;}</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;</div>
<div class="line"><a name="l01733"></a><span class="lineno"><a class="code" href="../../d9/de0/step__ch_8c.html#a91fe5c4370e3292a19e7f794797a407f"> 1733</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d4/dad/bounds_8funcdeclare_8h.html#a91fe5c4370e3292a19e7f794797a407f" title="normal bounding of all primitives">bound_allprim</a>(<span class="keywordtype">int</span> boundstage, <span class="keywordtype">int</span> finalstep, <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> boundtime, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*prim)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pstag)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*ucons)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <span class="keywordtype">int</span> doboundmpi)</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;{</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;  <span class="keywordtype">int</span> boundvartype=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2eddd9ab5ac3f8f5a8a8b62288b76f89">BOUNDPRIMTYPE</a>;</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;  <a class="code" href="../../d4/dad/bounds_8funcdeclare_8h.html#a460b84e1112e3aef17209c20e22e1cf1" title="bound all prims">bound_anyallprim</a>(boundstage, finalstep, boundtime, boundvartype, prim, pstag,ucons,doboundmpi);</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;}</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;</div>
<div class="line"><a name="l01748"></a><span class="lineno"><a class="code" href="../../d9/de0/step__ch_8c.html#a460b84e1112e3aef17209c20e22e1cf1"> 1748</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d4/dad/bounds_8funcdeclare_8h.html#a460b84e1112e3aef17209c20e22e1cf1" title="bound all prims">bound_anyallprim</a>(<span class="keywordtype">int</span> boundstage, <span class="keywordtype">int</span> finalstep, <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> boundtime, <span class="keywordtype">int</span> boundvartype, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*prim)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pstag)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*ucons)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR],<span class="keywordtype">int</span> doboundmpi)</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;{</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;  <span class="keywordtype">int</span> mystagboundvar;</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a11c4e99e1493d0c1914ad1ab313ea472">FLUXB</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0b6762cef74e396f50a83864bb53fb6c">FLUXCTSTAG</a>){</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;    <a class="code" href="../../d4/dad/bounds_8funcdeclare_8h.html#adbe0e3ba8a74f09ab928a96bd68cab6d" title="bound any prim type CALLS directly real and MPI boundary functions pstag = pstagglobal ucons = unewgl...">bound_anyprim</a>(boundstage, finalstep, boundtime, boundvartype, prim, pstag, ucons,doboundmpi);</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;    <span class="keywordflow">if</span>(boundvartype==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2eddd9ab5ac3f8f5a8a8b62288b76f89">BOUNDPRIMTYPE</a>) mystagboundvar=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a27c72ab7c1aed0da90fe96a0c6c3ac36">BOUNDPSTAGTYPE</a>;</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(boundvartype==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a5a2d92d15a373d4e19c816cf1e631d4a">BOUNDPRIMSIMPLETYPE</a>) mystagboundvar=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ae8250514c2a764de11180b30e6ee2a67">BOUNDPSTAGSIMPLETYPE</a>;</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;    <span class="keywordflow">else</span>  mystagboundvar=boundvartype;</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;    <a class="code" href="../../d4/dad/bounds_8funcdeclare_8h.html#abdea68b778dc9253324da69d3c376965" title="bound any pstag type CALLS directly real and MPI boundary functions pstag is at FACE1,2,3 for fields, so user bound is different MPI bounding is the same as CENT quantities used when restarting in initbase.c to bound unewglobal for FLUXB==FLUXCTSTAG">bound_anypstag</a>(boundstage, finalstep, boundtime, mystagboundvar, prim, pstag, ucons,doboundmpi);</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;  }</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    <a class="code" href="../../d4/dad/bounds_8funcdeclare_8h.html#adbe0e3ba8a74f09ab928a96bd68cab6d" title="bound any prim type CALLS directly real and MPI boundary functions pstag = pstagglobal ucons = unewgl...">bound_anyprim</a>(boundstage, finalstep, boundtime, boundvartype, prim, pstag, ucons,doboundmpi);</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;  }</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#af8fe447ae4f447a0823daaedab6364f9">unewisavg</a> &amp;&amp; <a class="code" href="../../da/d3e/definit_8h.html#aa34f95834323f30fabab0fe40f6782e0" title="whether to bound unew (GODMARK: no separate algorithm yet, so only works for non-outflow boundary con...">BOUNDUNEW</a>){</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;    <span class="comment">// SUPERGODMARK:</span></div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;    <span class="comment">// if not outflow boundary, then can bound u as p</span></div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    <span class="comment">// desirable since machine errors can be different and lead to secular changes</span></div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    <span class="comment">// esp. in MPI</span></div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;    bound_uavg(boundstage, finalstep, boundtime, boundvartype, ucons,pstag, ucons,doboundmpi);</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;  }</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;}</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;<span class="keywordtype">int</span> bound_uavg(<span class="keywordtype">int</span> boundstage, <span class="keywordtype">int</span> finalstep, <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> boundtime, <span class="keywordtype">int</span> boundvartype, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*prim)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pstag)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*ucons)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <span class="keywordtype">int</span> doboundmpi)</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;{</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;  <span class="keywordtype">int</span> mystagboundvar;</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*uavg)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR];</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;  <span class="comment">// assign uavg</span></div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;  uavg=ucons;</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;  <span class="comment">// for now only worry about bounding staggered fields since that&#39;s what can do given &quot;general&quot; boundary condition code</span></div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;  <span class="keywordflow">if</span>(1||<a class="code" href="../../d8/d5b/defs_8general_8h.html#a55732148d2616d6d1f5d2abbe8710850">DOENOFLUX</a> != <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#adacaaf8526353cfe870206f0cf4d2ca7" title="for DOENOFLUX: 0: no ENO flux reconstruction 1: reconstruct F for finite difference rep...">NOENOFLUX</a>){</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;    <span class="comment">// CHANGINGMARK: DEBUG:</span></div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;    <span class="comment">// can modify for diag call if choose to avoid if outflow condition</span></div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;    <span class="comment">// or do something simple for outflow just for diagnostics</span></div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;<span class="preprocessor">#if(FULLOUTPUT!=0 &amp;&amp; PRODUCTION==0)</span></div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;<span class="preprocessor"></span>    <a class="code" href="../../d4/dad/bounds_8funcdeclare_8h.html#adbe0e3ba8a74f09ab928a96bd68cab6d" title="bound any prim type CALLS directly real and MPI boundary functions pstag = pstagglobal ucons = unewgl...">bound_anyprim</a>(boundstage, finalstep, boundtime, boundvartype, uavg,pstag, uavg,doboundmpi);</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a55732148d2616d6d1f5d2abbe8710850">DOENOFLUX</a> == <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ac634a307561f486f9df8ba8a67c21c19">ENOFINITEVOLUME</a>){</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;      <span class="comment">// then need to bound all conservative quantities</span></div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;      <span class="comment">// SUPERGODMARK -- CHANGINGMARK -- need to generalize so bound knows if p or U quantity</span></div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;      <span class="comment">// other methods have only field &quot;averaged&quot; so only need to modify it</span></div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;      <a class="code" href="../../d4/dad/bounds_8funcdeclare_8h.html#adbe0e3ba8a74f09ab928a96bd68cab6d" title="bound any prim type CALLS directly real and MPI boundary functions pstag = pstagglobal ucons = unewgl...">bound_anyprim</a>(boundstage, finalstep, boundtime, boundvartype, uavg, pstag, uavg,doboundmpi);</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;    }</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a11c4e99e1493d0c1914ad1ab313ea472">FLUXB</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0b6762cef74e396f50a83864bb53fb6c">FLUXCTSTAG</a>){</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;      <span class="comment">// bound unew for staggered fields</span></div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;      <span class="comment">// SUPERGODMARK -- CHANGINGMARK: need to tell bound if p or U</span></div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;      <span class="keywordflow">if</span>(boundvartype==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2eddd9ab5ac3f8f5a8a8b62288b76f89">BOUNDPRIMTYPE</a>) mystagboundvar=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a27c72ab7c1aed0da90fe96a0c6c3ac36">BOUNDPSTAGTYPE</a>;</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(boundvartype==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a5a2d92d15a373d4e19c816cf1e631d4a">BOUNDPRIMSIMPLETYPE</a>) mystagboundvar=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ae8250514c2a764de11180b30e6ee2a67">BOUNDPSTAGSIMPLETYPE</a>;</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;      <span class="keywordflow">else</span>  mystagboundvar=boundvartype;</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;      <a class="code" href="../../d4/dad/bounds_8funcdeclare_8h.html#abdea68b778dc9253324da69d3c376965" title="bound any pstag type CALLS directly real and MPI boundary functions pstag is at FACE1,2,3 for fields, so user bound is different MPI bounding is the same as CENT quantities used when restarting in initbase.c to bound unewglobal for FLUXB==FLUXCTSTAG">bound_anypstag</a>(boundstage, finalstep, boundtime, mystagboundvar, uavg, pstag, uavg,doboundmpi);</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;    }</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;  }</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;}</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;</div>
<div class="line"><a name="l01834"></a><span class="lineno"><a class="code" href="../../d9/de0/step__ch_8c.html#adbe0e3ba8a74f09ab928a96bd68cab6d"> 1834</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d4/dad/bounds_8funcdeclare_8h.html#adbe0e3ba8a74f09ab928a96bd68cab6d" title="bound any prim type CALLS directly real and MPI boundary functions pstag = pstagglobal ucons = unewgl...">bound_anyprim</a>(<span class="keywordtype">int</span> boundstage, <span class="keywordtype">int</span> finalstep, <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> boundtime, <span class="keywordtype">int</span> boundvartype, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*prim)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pstag)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*ucons)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <span class="keywordtype">int</span> doboundmpi)</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;{</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;  <span class="keywordtype">int</span> whichpltoavg[NPR];</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;  <span class="keywordtype">int</span> ifnotavgthencopy[NPR];</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;  <span class="keywordtype">int</span> nprlocalstart,nprlocalend;</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;  <span class="keywordtype">int</span> nprlocallist[MAXNPR];</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;  <span class="keywordtype">int</span> pl,pliter;</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;  <span class="keywordtype">int</span> dir;</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#ae2cc56909ed67595b899f79bfe6fe8c3" title="whether to do ENO debug">DOGRIDSECTIONING</a>){</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;    <span class="keywordflow">if</span>((boundstage==<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#a55cd17c293a7db0ea2fce2d2be563ad8">STAGE0</a>)||(boundstage==<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#affb13608b845e81f4595b80927fbedbd" title="for various uses (dumping and special boundary/comp interchange routine">STAGEM1</a>)){</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;      <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a0163a499c88dd8b07688e3dbd7007f0e">MYFUN</a>(bound_gridsectioning(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a61ee6cbd80338b6dffb4944343d0ba1d" title="primitive type">CENTEREDPRIM</a>,prim,pstag,ucons,finalstep),<span class="stringliteral">&quot;step_ch.c:bound_pstag()&quot;</span>, <span class="stringliteral">&quot;bound_pstag_user()&quot;</span>, 1);</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;    }</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;  }</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a8cbb473515f18fcae523329c93f140dc">DIMENLOOP</a>(dir){</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;    <span class="keywordflow">if</span>(0 &amp;&amp; <a class="code" href="../../d8/d5b/defs_8general_8h.html#a11c4e99e1493d0c1914ad1ab313ea472">FLUXB</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0b6762cef74e396f50a83864bb53fb6c">FLUXCTSTAG</a>){ <span class="comment">// apparently need to bound both fields SUPERGODMARK</span></div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;      <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#ad5ba6b43c072aca55951657f023cbfc3" title="always goes over all conserved">PALLLOOP</a>(pl) whichpltoavg[pl]=1;</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;      <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a9afde1f1647e18e733406a1566b8b550">PLOOPBONLY</a>(pl) whichpltoavg[pl]=0;</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;      <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#ad5ba6b43c072aca55951657f023cbfc3" title="always goes over all conserved">PALLLOOP</a>(pl) ifnotavgthencopy[pl]=0;</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;      <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a9afde1f1647e18e733406a1566b8b550">PLOOPBONLY</a>(pl) ifnotavgthencopy[pl]=0;</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;      addremovefromanynpr(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a70da358c1e7cdf376febfedff5f8ede4">REMOVEFROMNPR</a>, whichpltoavg, ifnotavgthencopy, &amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#a37f8921de34ae87d6e4f8cf01a907de5" title="for choosing range of PBOUNDLOOP and PLOOPMPI type arrays">nprboundstart</a>, &amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#a3d3b30e5230109a1a182199aa17ab084">nprboundend</a>, <a class="code" href="../../d8/d5b/defs_8general_8h.html#a6dba6fb1a43922f6b8c4e933ad8b51bc">nprboundlist</a>, &amp;nprlocalstart, &amp;nprlocalend, nprlocallist, NULL, NULL);</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;    }</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;      <span class="comment">// no change then, doing all variables</span></div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;    }</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;    <span class="comment">// pre-post MPI recv&#39;s</span></div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;    <span class="keywordflow">if</span>(doboundmpi){</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;      <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a0163a499c88dd8b07688e3dbd7007f0e">MYFUN</a>(bound_mpi_dir(boundstage, finalstep, -dir, boundvartype, prim, NULL, NULL, NULL,NULL),<span class="stringliteral">&quot;step_ch.c:bound_prim()&quot;</span>, <span class="stringliteral">&quot;bound_mpi()&quot;</span>, 1);</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;    }</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;    <span class="comment">// real boundary zones</span></div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;    <span class="keywordflow">if</span>((boundstage==<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#a55cd17c293a7db0ea2fce2d2be563ad8">STAGE0</a>)||(boundstage==<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#affb13608b845e81f4595b80927fbedbd" title="for various uses (dumping and special boundary/comp interchange routine">STAGEM1</a>)){</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;      <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a0163a499c88dd8b07688e3dbd7007f0e">MYFUN</a>(<a class="code" href="../../de/d51/bounds_8c.html#a4bc7413b2cdb89e070f38bbb689ae555">bound_prim_user_dir</a>(boundstage, finalstep, boundtime, dir, boundvartype, prim),<span class="stringliteral">&quot;step_ch.c:bound_prim()&quot;</span>, <span class="stringliteral">&quot;bound_prim_user()&quot;</span>, 1);</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;    }<span class="comment">// end if stage0 or stagem1</span></div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;  </div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;    <span class="keywordflow">if</span>(doboundmpi){</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;      <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a0163a499c88dd8b07688e3dbd7007f0e">MYFUN</a>(bound_mpi_dir(boundstage, finalstep, +dir, boundvartype, prim, NULL, NULL, NULL,NULL),<span class="stringliteral">&quot;step_ch.c:bound_prim()&quot;</span>, <span class="stringliteral">&quot;bound_mpi()&quot;</span>, 1);</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;    }</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;    <span class="comment">// real boundary zones</span></div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;    <span class="keywordflow">if</span>((boundstage==<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#a55cd17c293a7db0ea2fce2d2be563ad8">STAGE0</a>)||(boundstage==<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#affb13608b845e81f4595b80927fbedbd" title="for various uses (dumping and special boundary/comp interchange routine">STAGEM1</a>)){</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;      <span class="keywordtype">int</span> ispstag=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a260d8a61fc4a84966bcb5a784be4238e" title="ispstag:">BOUNDPRIMLOC</a>;</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;      <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a0163a499c88dd8b07688e3dbd7007f0e">MYFUN</a>(bound_prim_user_after_mpi_dir(boundstage, finalstep, boundtime, dir, boundvartype, ispstag, prim),<span class="stringliteral">&quot;step_ch.c:bound_prim()&quot;</span>, <span class="stringliteral">&quot;bound_prim_user_after_mpi()&quot;</span>, 1);</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;    }<span class="comment">// end if stage0 or stagem1</span></div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;    <span class="comment">// restore choice for bounding</span></div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;    <span class="keywordflow">if</span>(0 &amp;&amp; <a class="code" href="../../d8/d5b/defs_8general_8h.html#a11c4e99e1493d0c1914ad1ab313ea472">FLUXB</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0b6762cef74e396f50a83864bb53fb6c">FLUXCTSTAG</a>){ <span class="comment">// apparently need to bound both fields SUPERGODMARK</span></div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;      addremovefromanynpr(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#af732fdf2d9fc1059109b57109f6dde39">RESTORENPR</a>, whichpltoavg, ifnotavgthencopy, &amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#a37f8921de34ae87d6e4f8cf01a907de5" title="for choosing range of PBOUNDLOOP and PLOOPMPI type arrays">nprboundstart</a>, &amp;<a class="code" href="../../d8/d5b/defs_8general_8h.html#a3d3b30e5230109a1a182199aa17ab084">nprboundend</a>, <a class="code" href="../../d8/d5b/defs_8general_8h.html#a6dba6fb1a43922f6b8c4e933ad8b51bc">nprboundlist</a>, &amp;nprlocalstart, &amp;nprlocalend, nprlocallist, NULL, NULL);</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    }</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;  }</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;  </div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;}</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;</div>
<div class="line"><a name="l01912"></a><span class="lineno"><a class="code" href="../../d9/de0/step__ch_8c.html#abdea68b778dc9253324da69d3c376965"> 1912</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d4/dad/bounds_8funcdeclare_8h.html#abdea68b778dc9253324da69d3c376965" title="bound any pstag type CALLS directly real and MPI boundary functions pstag is at FACE1,2,3 for fields, so user bound is different MPI bounding is the same as CENT quantities used when restarting in initbase.c to bound unewglobal for FLUXB==FLUXCTSTAG">bound_anypstag</a>(<span class="keywordtype">int</span> boundstage, <span class="keywordtype">int</span> finalstep, <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> boundtime, <span class="keywordtype">int</span> boundvartype, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*prim)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*pstag)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*ucons)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <span class="keywordtype">int</span> doboundmpi)</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;{</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;  <span class="keywordtype">int</span> pl,pliter;</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;  <span class="keywordtype">int</span> nprlocalstart,nprlocalend;</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;  <span class="keywordtype">int</span> nprlocallist[MAXNPR];</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;  <span class="keywordtype">int</span> dir;</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;  <span class="keywordtype">int</span> mystagboundvar;</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;  <span class="keywordflow">if</span>(boundvartype==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2eddd9ab5ac3f8f5a8a8b62288b76f89">BOUNDPRIMTYPE</a>) mystagboundvar=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a27c72ab7c1aed0da90fe96a0c6c3ac36">BOUNDPSTAGTYPE</a>;</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(boundvartype==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a5a2d92d15a373d4e19c816cf1e631d4a">BOUNDPRIMSIMPLETYPE</a>) mystagboundvar=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ae8250514c2a764de11180b30e6ee2a67">BOUNDPSTAGSIMPLETYPE</a>;</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;  <span class="keywordflow">else</span>  mystagboundvar=boundvartype;</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#ae2cc56909ed67595b899f79bfe6fe8c3" title="whether to do ENO debug">DOGRIDSECTIONING</a>){</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;    <span class="keywordflow">if</span>((boundstage==<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#a55cd17c293a7db0ea2fce2d2be563ad8">STAGE0</a>)||(boundstage==<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#affb13608b845e81f4595b80927fbedbd" title="for various uses (dumping and special boundary/comp interchange routine">STAGEM1</a>)){</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;      <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a0163a499c88dd8b07688e3dbd7007f0e">MYFUN</a>(bound_gridsectioning(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a9aacd1e18bd7dddda3ae0d00fda42766">STAGGEREDPRIM</a>,prim,pstag,ucons,finalstep),<span class="stringliteral">&quot;step_ch.c:bound_pstag()&quot;</span>, <span class="stringliteral">&quot;bound_pstag_user()&quot;</span>, 1);</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;    }</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;  }</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a8cbb473515f18fcae523329c93f140dc">DIMENLOOP</a>(dir){</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;  </div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;    <span class="comment">// save choice for bounding</span></div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;    nprlocalstart=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a37f8921de34ae87d6e4f8cf01a907de5" title="for choosing range of PBOUNDLOOP and PLOOPMPI type arrays">nprboundstart</a>;</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;    nprlocalend=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a3d3b30e5230109a1a182199aa17ab084">nprboundend</a>;</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#ae3d8ba1d892944d94ad9f496a3fb3566" title="goes over all/any npr lists for copying one list to another">PMAXNPRLOOP</a>(pl) nprlocallist[pl]=<a class="code" href="../../d8/d5b/defs_8general_8h.html#a6dba6fb1a43922f6b8c4e933ad8b51bc">nprboundlist</a>[pl];</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;    <span class="comment">// choose range of PBOUNDLOOP and PLOOPMPI</span></div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a37f8921de34ae87d6e4f8cf01a907de5" title="for choosing range of PBOUNDLOOP and PLOOPMPI type arrays">nprboundstart</a>=0;</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3d3b30e5230109a1a182199aa17ab084">nprboundend</a>=2;</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a6dba6fb1a43922f6b8c4e933ad8b51bc">nprboundlist</a>[0]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a7b21d6a6a4573b4997b1f04b01cd4efb">B1</a>;</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a6dba6fb1a43922f6b8c4e933ad8b51bc">nprboundlist</a>[1]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a6945d50f798e1fde624d70c74457090e">B2</a>;</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a6dba6fb1a43922f6b8c4e933ad8b51bc">nprboundlist</a>[2]=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ae6ac0edb1e2c9c7672ab9488d8b65be9">B3</a>;</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;    <span class="comment">// pre-post MPI recvs</span></div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;    <span class="keywordflow">if</span>(doboundmpi){</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;      <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a0163a499c88dd8b07688e3dbd7007f0e">MYFUN</a>(bound_mpi_dir(boundstage, finalstep, -dir, mystagboundvar, pstag, NULL, NULL, NULL,NULL),<span class="stringliteral">&quot;step_ch.c:bound_pstag()&quot;</span>, <span class="stringliteral">&quot;bound_mpi()&quot;</span>, 1);</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;    }</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;    <span class="comment">// real boundary zones</span></div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;    <span class="keywordflow">if</span>((boundstage==<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#a55cd17c293a7db0ea2fce2d2be563ad8">STAGE0</a>)||(boundstage==<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#affb13608b845e81f4595b80927fbedbd" title="for various uses (dumping and special boundary/comp interchange routine">STAGEM1</a>)){</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;      <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a0163a499c88dd8b07688e3dbd7007f0e">MYFUN</a>(<a class="code" href="../../de/d51/bounds_8c.html#a3246b706b24adb6265016a8954807f6f" title="assume single user function takes care of primitive locations">bound_pstag_user_dir</a>(boundstage, finalstep, boundtime, dir,mystagboundvar,pstag),<span class="stringliteral">&quot;step_ch.c:bound_pstag()&quot;</span>, <span class="stringliteral">&quot;bound_pstag_user()&quot;</span>, 1);</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;    }<span class="comment">// end if stage0 or stagem1</span></div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;    <span class="keywordflow">if</span>(doboundmpi){</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;      <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a0163a499c88dd8b07688e3dbd7007f0e">MYFUN</a>(bound_mpi_dir(boundstage, finalstep, +dir, mystagboundvar, pstag, NULL, NULL, NULL,NULL),<span class="stringliteral">&quot;step_ch.c:bound_pstag()&quot;</span>, <span class="stringliteral">&quot;bound_mpi()&quot;</span>, 1);</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;    }</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;    <span class="comment">// real boundary zones</span></div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;    <span class="keywordflow">if</span>((boundstage==<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#a55cd17c293a7db0ea2fce2d2be563ad8">STAGE0</a>)||(boundstage==<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#affb13608b845e81f4595b80927fbedbd" title="for various uses (dumping and special boundary/comp interchange routine">STAGEM1</a>)){</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;      <span class="keywordtype">int</span> ispstag=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a0f0e0c27dd139a7d5194855fe7f26a76">BOUNDPSTAGLOC</a>;</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;      <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a0163a499c88dd8b07688e3dbd7007f0e">MYFUN</a>(bound_prim_user_after_mpi_dir(boundstage, finalstep, boundtime, dir, mystagboundvar, ispstag, pstag),<span class="stringliteral">&quot;step_ch.c:bound_pstag()&quot;</span>, <span class="stringliteral">&quot;bound_prim_user_after_mpi()&quot;</span>, 1);</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;    }<span class="comment">// end if stage0 or stagem1</span></div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;    <span class="comment">// restore choice for bounding</span></div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a37f8921de34ae87d6e4f8cf01a907de5" title="for choosing range of PBOUNDLOOP and PLOOPMPI type arrays">nprboundstart</a>=nprlocalstart;</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;    <a class="code" href="../../d8/d5b/defs_8general_8h.html#a3d3b30e5230109a1a182199aa17ab084">nprboundend</a>=nprlocalend;</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#ae3d8ba1d892944d94ad9f496a3fb3566" title="goes over all/any npr lists for copying one list to another">PMAXNPRLOOP</a>(pl) <a class="code" href="../../d8/d5b/defs_8general_8h.html#a6dba6fb1a43922f6b8c4e933ad8b51bc">nprboundlist</a>[pl]=nprlocallist[pl];</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;  }</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;}</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;<span class="keywordtype">int</span> bound_flux(<span class="keywordtype">int</span> boundstage, <span class="keywordtype">int</span> finalstep, <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> boundtime, <span class="keywordtype">int</span> boundvartype, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*F1)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*F2)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*F3)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>], <span class="keywordtype">int</span> doboundmpi)</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;{</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;  <span class="keywordtype">int</span> dir;</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;  <span class="keywordflow">if</span>(boundvartype==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a435fa02094f996d08cfc56b1290c1de2">BOUNDFLUXTYPE</a> || boundvartype==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a9e0d0172132d3c2316bbacd5a577b1c0">BOUNDFLUXSIMPLETYPE</a>){</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;    <span class="comment">// then can stay</span></div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;  }</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Shouldn&#39;t be in bound_flux() with boundvartype=%d\n&quot;</span>,boundvartype);</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;    myexit(2467367);</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;  }</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#a55732148d2616d6d1f5d2abbe8710850">DOENOFLUX</a>==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a81c6be7c38a1e29b40efa57ca47d0d02">ENOFLUXRECON</a> &amp;&amp; <a class="code" href="../../da/d3e/definit_8h.html#ad7e13921b31c5752ef7475a7a2237854" title="whether to bound flux if doing fluxrecon">BOUNDFLUXRECON</a>==0){</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;DEBUG: Assuming bound_flux() called only for debugging purposes\n&quot;</span>);</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;  }</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;  <span class="comment">// pre-post recv&#39;s</span></div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;  <span class="keywordflow">if</span>(doboundmpi){</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;    <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a0163a499c88dd8b07688e3dbd7007f0e">MYFUN</a>(bound_mpi(boundstage, finalstep, -1, boundvartype, NULL, F1, F2, F3, NULL),<span class="stringliteral">&quot;step_ch.c:bound_flux()&quot;</span>, <span class="stringliteral">&quot;bound_mpi()&quot;</span>, 1);</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;  }</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;  </div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;  <span class="comment">// real boundary zones</span></div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;  <span class="keywordflow">if</span>((boundstage==<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#a55cd17c293a7db0ea2fce2d2be563ad8">STAGE0</a>)||(boundstage==<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#affb13608b845e81f4595b80927fbedbd" title="for various uses (dumping and special boundary/comp interchange routine">STAGEM1</a>)){</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;    <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a0163a499c88dd8b07688e3dbd7007f0e">MYFUN</a>(<a class="code" href="../../d4/dad/bounds_8funcdeclare_8h.html#a5f4f9381769d3963bdf2dcd0c0202aa4">bound_flux_user</a>(boundstage, finalstep, boundtime, boundvartype,F1,F2,F3),<span class="stringliteral">&quot;step_ch.c:bound_flux()&quot;</span>, <span class="stringliteral">&quot;bound_flux_user()&quot;</span>, 1);</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;  }<span class="comment">// end if stage0 or stagem1</span></div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;  <span class="keywordflow">if</span>(doboundmpi){</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;    <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a0163a499c88dd8b07688e3dbd7007f0e">MYFUN</a>(bound_mpi(boundstage, finalstep, +1, boundvartype, NULL, F1, F2, F3, NULL),<span class="stringliteral">&quot;step_ch.c:bound_flux()&quot;</span>, <span class="stringliteral">&quot;bound_mpi()&quot;</span>, 1);</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;  }</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;}</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;<span class="keywordtype">int</span> bound_vpot(<span class="keywordtype">int</span> boundstage, <span class="keywordtype">int</span> finalstep, <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> boundtime, <span class="keywordtype">int</span> boundvartype, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*vpot)[<a class="code" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823" title="123">NSTORE1</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a1c452bce7a227fd9f2c8f937a3c7841c">SHIFTSTORE1</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#adfe8c351b7f60e189dbd9bfca47af5c5">SHIFTSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>+<a class="code" href="../../df/d1c/global_8storage_8h.html#a6dc540b0373d80d3ea2db53d03a9fa72">SHIFTSTORE3</a>], <span class="keywordtype">int</span> doboundmpi, <span class="keywordtype">int</span> doboundnonmpi)</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;{</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;  <span class="keywordtype">int</span> dir;</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;  <span class="keywordflow">if</span>(boundvartype==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2a10dbc87550637eb2582e022436108d">BOUNDVPOTTYPE</a> || boundvartype==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a5e5da02b8601cef68e1ed99bf49a52b4">BOUNDVPOTSIMPLETYPE</a>){</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;    <span class="comment">// then can stay</span></div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;  }</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Shouldn&#39;t be in bound_vpot() with boundvartype=%d\n&quot;</span>,boundvartype);</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;    myexit(3483466);</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;  }</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;  <span class="comment">// pre-post MPI recv&#39;s</span></div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;  <span class="keywordflow">if</span>(doboundmpi){</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;    <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a0163a499c88dd8b07688e3dbd7007f0e">MYFUN</a>(bound_mpi(boundstage, finalstep, -1, boundvartype, NULL, NULL, NULL, NULL, vpot),<span class="stringliteral">&quot;step_ch.c:bound_flux()&quot;</span>, <span class="stringliteral">&quot;bound_mpi()&quot;</span>, 1);</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;  }</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;  <span class="comment">// real boundary zones</span></div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;  <span class="keywordflow">if</span>(doboundnonmpi){</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;    <span class="keywordflow">if</span>((boundstage==<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#a55cd17c293a7db0ea2fce2d2be563ad8">STAGE0</a>)||(boundstage==<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#affb13608b845e81f4595b80927fbedbd" title="for various uses (dumping and special boundary/comp interchange routine">STAGEM1</a>)){</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;      <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a0163a499c88dd8b07688e3dbd7007f0e">MYFUN</a>(bound_vpot_user(boundstage, finalstep, boundtime, boundvartype,vpot),<span class="stringliteral">&quot;step_ch.c:bound_vpot()&quot;</span>, <span class="stringliteral">&quot;bound_vpot_user()&quot;</span>, 1);</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;    }<span class="comment">// end if stage0 or stagem1</span></div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;  }</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;  <span class="keywordflow">if</span>(doboundmpi){</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;    <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a0163a499c88dd8b07688e3dbd7007f0e">MYFUN</a>(bound_mpi(boundstage, finalstep, +1, boundvartype, NULL, NULL, NULL, NULL, vpot),<span class="stringliteral">&quot;step_ch.c:bound_flux()&quot;</span>, <span class="stringliteral">&quot;bound_mpi()&quot;</span>, 1);</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;  }</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;}</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;<span class="keywordtype">int</span> bound_pflag(<span class="keywordtype">int</span> boundstage, <span class="keywordtype">int</span> finalstep, <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> boundtime, <a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a9377001671b5ece8bb2a2cf636de4b8a">PFTYPE</a> (*prim)[<a class="code" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="code" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2769e7932b44819ba2a159091c5def43" title="flag failures/problems for correction/check in fixup">NUMPFLAGS</a>], <span class="keywordtype">int</span> doboundmpi)</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;{</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;  <span class="keywordtype">int</span> boundvartype=<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2df7b4dfa08af2809ff7293c3f6645bd">BOUNDINTTYPE</a>;</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;  </div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;  <span class="keywordflow">if</span>(doboundmpi){</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;    <span class="keywordflow">if</span>(UTOPRIMFIXMPICONSISTENT==1){</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;      <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a0163a499c88dd8b07688e3dbd7007f0e">MYFUN</a>(bound_mpi_int(boundstage, finalstep, -1, boundvartype, prim),<span class="stringliteral">&quot;step_ch.c:bound_pflag()&quot;</span>, <span class="stringliteral">&quot;bound_mpi_int()&quot;</span>, 1);</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;    }</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;      <span class="comment">// need to fill boundary cells with failure</span></div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;      <span class="comment">// otherwise, would have to go deeper into fixups and dependency chain for the UTOPRIMFIXMPICONSISTENT chocie would become too deep</span></div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;      <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a0163a499c88dd8b07688e3dbd7007f0e">MYFUN</a>(bound_mpi_int_fakeutoprimmpiinconsisent(boundstage, finalstep, -1, boundvartype, prim,<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a1cfd743fe705971858ab82d45846e1c0">UTOPRIMFAILFAKEVALUE</a>),<span class="stringliteral">&quot;step_ch.c:bound_pflag()&quot;</span>, <span class="stringliteral">&quot;bound_mpi_int()&quot;</span>, 1);</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;    }</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;  }</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;  <span class="keywordflow">if</span>((boundstage==<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#a55cd17c293a7db0ea2fce2d2be563ad8">STAGE0</a>)||(boundstage==<a class="code" href="../../d5/d14/mympi_8global_8nondepmnemonics_8h.html#affb13608b845e81f4595b80927fbedbd" title="for various uses (dumping and special boundary/comp interchange routine">STAGEM1</a>)){</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;    <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a0163a499c88dd8b07688e3dbd7007f0e">MYFUN</a>(bound_pflag_user(boundstage, finalstep, boundtime, boundvartype, prim),<span class="stringliteral">&quot;step_ch.c:bound_pflag()&quot;</span>, <span class="stringliteral">&quot;bound_pflag_user()&quot;</span>, 1);</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;  }<span class="comment">// end bound stage</span></div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;  <span class="keywordflow">if</span>(doboundmpi){</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;    <span class="keywordflow">if</span>(UTOPRIMFIXMPICONSISTENT==1){</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;      <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a0163a499c88dd8b07688e3dbd7007f0e">MYFUN</a>(bound_mpi_int(boundstage, finalstep, +1, boundvartype, prim),<span class="stringliteral">&quot;step_ch.c:bound_pflag()&quot;</span>, <span class="stringliteral">&quot;bound_mpi_int()&quot;</span>, 1);</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;    }</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;      <span class="comment">// need to fill boundary cells with failure</span></div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;      <span class="comment">// otherwise, would have to go deeper into fixups and dependency chain for the UTOPRIMFIXMPICONSISTENT chocie would become too deep</span></div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;      <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a0163a499c88dd8b07688e3dbd7007f0e">MYFUN</a>(bound_mpi_int_fakeutoprimmpiinconsisent(boundstage, finalstep, +1, boundvartype, prim,<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a1cfd743fe705971858ab82d45846e1c0">UTOPRIMFAILFAKEVALUE</a>),<span class="stringliteral">&quot;step_ch.c:bound_pflag()&quot;</span>, <span class="stringliteral">&quot;bound_mpi_int()&quot;</span>, 1);</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;    }</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;  }</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;}</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;</div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri May 20 2016 15:52:35 for HARM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.3.1
</small></address>
</body>
</html>
