<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>HARM: phys.funcdeclare.h File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">HARM
   </div>
   <div id="projectbrief">harm and utilities</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">phys.funcdeclare.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Function declarations for global use of things in <a class="el" href="../../de/d8c/phys_8c.html" title="All globally-related physics calculations THINGS IN HERE ARE NOT PER POINT OR USE GLOBAL VARIABLES or...">phys.c</a>.  
<a href="#details">More...</a></p>
<div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="../../d8/da0/phys_8funcdeclare_8h__dep__incl.png" border="0" usemap="#phys_8funcdeclare_8hdep" alt=""/></div>
<map name="phys_8funcdeclare_8hdep" id="phys_8funcdeclare_8hdep">
<area shape="rect" id="node3" href="../../d8/df4/global_8funcdeclare_8h.html" title="Function declarations (used globally) by entire code." alt="" coords="41,83,180,112"/><area shape="rect" id="node5" href="../../d3/d67/global_8general_8h.html" title="General code definitions with specific order from independent to dependent definitions." alt="" coords="55,160,167,189"/><area shape="rect" id="node7" href="../../d0/dcc/global_8grmhd_8h.html" title="Wrapper and Comments on comments." alt="" coords="57,237,164,267"/><area shape="rect" id="node9" href="../../d4/dda/defs_8grmhd_8h.html" title="Wrapper." alt="" coords="5,315,104,344"/><area shape="rect" id="node11" href="../../d8/d2e/u2p__util_8c.html" title="U&#45;&gt;P inversion functions used by all utoprim files." alt="" coords="128,315,205,344"/><area shape="rect" id="node13" href="../../d1/dde/utoprim__jon_8c.html" title="Jon&#39;s U&#45;&gt;P inversion." alt="" coords="117,392,216,421"/></map>
</div>
</div>
<p><a href="../../d3/ddc/phys_8funcdeclare_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:afc93fd4a6f7a2b87a9315d5fba5a529c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#afc93fd4a6f7a2b87a9315d5fba5a529c">ucon_calc</a>&#160;&#160;&#160;<a class="el" href="../../d7/def/phys_8tools_8c.html#ad141359a7901a82a0c26241b432183c3">ucon_calc_4vel</a></td></tr>
<tr class="separator:afc93fd4a6f7a2b87a9315d5fba5a529c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a502c507b1c1c31f170c828fdb004a8a4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#a502c507b1c1c31f170c828fdb004a8a4">dudp_calc</a>&#160;&#160;&#160;dudp_calc_gen</td></tr>
<tr class="separator:a502c507b1c1c31f170c828fdb004a8a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d8f2ff21b603eabf98bf7c100c5af7d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#a9d8f2ff21b603eabf98bf7c100c5af7d">compute_1plusud0</a>&#160;&#160;&#160;<a class="el" href="../../d7/def/phys_8tools_8c.html#a2bbec7298dca0647305d2dd8e4c3b7f3">compute_1plusud0_general</a></td></tr>
<tr class="separator:a9d8f2ff21b603eabf98bf7c100c5af7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab14fcc0bc1a93e5fac623d16ba873fb5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#ab14fcc0bc1a93e5fac623d16ba873fb5">bsq_calc</a>&#160;&#160;&#160;<a class="el" href="../../d7/def/phys_8tools_8c.html#aedc30b56b48db47c3622b2d6c55161d9">bsq_calc_general</a></td></tr>
<tr class="separator:ab14fcc0bc1a93e5fac623d16ba873fb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46db46b8bc800e45c0e352c0cc01d9d3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#a46db46b8bc800e45c0e352c0cc01d9d3">bsq_calc_fromq</a>&#160;&#160;&#160;<a class="el" href="../../d7/def/phys_8tools_8c.html#a281ba6e6bcafdff7fc3e8c71e405fdee">bsq_calc_fromq_general</a></td></tr>
<tr class="separator:a46db46b8bc800e45c0e352c0cc01d9d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3059ed7bfcfb692cbe8014d55fd7c1e4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#a3059ed7bfcfb692cbe8014d55fd7c1e4">get_geometry</a>(ii, jj, kk, pp, ptrgeom)&#160;&#160;&#160;get_geometry_old(ii,jj,kk,pp,ptrgeom)</td></tr>
<tr class="separator:a3059ed7bfcfb692cbe8014d55fd7c1e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9740cb914b7803b1ba73f76a9a37ddc2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#a9740cb914b7803b1ba73f76a9a37ddc2">get_geometry_gdetmix</a>(ii, jj, kk, pp, ptrgeom)&#160;&#160;&#160;get_geometry_old(ii,jj,kk,pp,ptrgeom)</td></tr>
<tr class="separator:a9740cb914b7803b1ba73f76a9a37ddc2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29d77750db58af63e128049ca865c364"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#a29d77750db58af63e128049ca865c364">get_geometry_gdetonly</a>(ii, jj, kk, pp, ptrgeom)&#160;&#160;&#160;get_geometry_gdetonly_old(ii,jj,kk,pp,ptrgeom)</td></tr>
<tr class="separator:a29d77750db58af63e128049ca865c364"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a872dfd0c4407ee5b6ff2a6b9bea3b2f0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#a872dfd0c4407ee5b6ff2a6b9bea3b2f0">get_geometry_geomeonly</a>(ii, jj, kk, pp, ptrgeom)&#160;&#160;&#160;get_geometry_geomeonly_old(ii,jj,kk,pp,ptrgeom)</td></tr>
<tr class="separator:a872dfd0c4407ee5b6ff2a6b9bea3b2f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9d84e0517b3901a38bee832bca8133f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#ad9d84e0517b3901a38bee832bca8133f">set_igdet</a>(arg)&#160;&#160;&#160;set_igdet_old(arg)</td></tr>
<tr class="separator:ad9d84e0517b3901a38bee832bca8133f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcfebf340c9017d7989eb3bdd344da45"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#adcfebf340c9017d7989eb3bdd344da45">set_igdetsimple</a>(arg)&#160;&#160;&#160;set_igdetsimple_old(arg)</td></tr>
<tr class="separator:adcfebf340c9017d7989eb3bdd344da45"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9ffbdaa97489ef748af456f65c779e18"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#a9ffbdaa97489ef748af456f65c779e18">sourcephysics</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *pi, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *ph, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *pf, int *didreturnpf, int *eomtype, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *geom, struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *q, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *Ugeomfreei, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *Ugeomfreef, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *CUf, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *CUimp, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> dissmeasure, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *dUother, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*dUcomp)[NPR])</td></tr>
<tr class="memdesc:a9ffbdaa97489ef748af456f65c779e18"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ugeomfree and dUother are in UNOTHING form (or UEVOLVE without geometry) pf might be modified so better approximation to final update, so easier on <a class="el" href="../../d1/d3e/utoprimgen_8c.html#a7e078cc9a354495bc85554d875a705d9" title="General explicit inversion of U[MHD]-&gt;P[MHD] and also inverts scalars. Inverts radiation if(EOMRADTYP...">Utoprimgen()</a> to get inversion.  <a href="#a9ffbdaa97489ef748af456f65c779e18">More...</a><br/></td></tr>
<tr class="separator:a9ffbdaa97489ef748af456f65c779e18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a54096e4c40a15a2c1bf74266153616"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#a9a54096e4c40a15a2c1bf74266153616">primtoU</a> (int returntype, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *<a class="el" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a>, struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *q, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *geom, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *U, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *Uabs)</td></tr>
<tr class="memdesc:a9a54096e4c40a15a2c1bf74266153616"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate "conserved" quantities  <a href="#a9a54096e4c40a15a2c1bf74266153616">More...</a><br/></td></tr>
<tr class="separator:a9a54096e4c40a15a2c1bf74266153616"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc1e1232a2f457b71cfd9210f2b5240a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#afc1e1232a2f457b71cfd9210f2b5240a">ucon_calc_3vel</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *<a class="el" href="../../dc/dd2/newcodediff_8txt.html#ae7ab77d7e616dc02fba121a009b48c27">pr</a>, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *geom, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *ucon, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *others)</td></tr>
<tr class="memdesc:afc1e1232a2f457b71cfd9210f2b5240a"><td class="mdescLeft">&#160;</td><td class="mdescRight">find contravariant four-velocity int <a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#afc93fd4a6f7a2b87a9315d5fba5a529c">ucon_calc(FTYPE *pr, struct of_geom *geom, FTYPE *ucon, FTYPE *others)</a>  <a href="#afc1e1232a2f457b71cfd9210f2b5240a">More...</a><br/></td></tr>
<tr class="separator:afc1e1232a2f457b71cfd9210f2b5240a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7aadb359813194586356c2c325322a45"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#a7aadb359813194586356c2c325322a45">ucon_calc_rel4vel</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *<a class="el" href="../../dc/dd2/newcodediff_8txt.html#ae7ab77d7e616dc02fba121a009b48c27">pr</a>, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *geom, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *ucon, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *others)</td></tr>
<tr class="memdesc:a7aadb359813194586356c2c325322a45"><td class="mdescLeft">&#160;</td><td class="mdescRight">find contravariant four-velocity from the relative 4 velocity  <a href="#a7aadb359813194586356c2c325322a45">More...</a><br/></td></tr>
<tr class="separator:a7aadb359813194586356c2c325322a45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad141359a7901a82a0c26241b432183c3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#ad141359a7901a82a0c26241b432183c3">ucon_calc_4vel</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *<a class="el" href="../../dc/dd2/newcodediff_8txt.html#ae7ab77d7e616dc02fba121a009b48c27">pr</a>, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *geom, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *ucon, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *others)</td></tr>
<tr class="memdesc:ad141359a7901a82a0c26241b432183c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">find contravariant time component of four-velocity from the 4velocity (3 terms)  <a href="#ad141359a7901a82a0c26241b432183c3">More...</a><br/></td></tr>
<tr class="separator:ad141359a7901a82a0c26241b432183c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14046b9dfb71c88d01cb79d3f6dfc5ee"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#a14046b9dfb71c88d01cb79d3f6dfc5ee">ucon_calc_4vel_bothut</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *<a class="el" href="../../dc/dd2/newcodediff_8txt.html#ae7ab77d7e616dc02fba121a009b48c27">pr</a>, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *geom, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *ucon, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *ucon2, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *others)</td></tr>
<tr class="memdesc:a14046b9dfb71c88d01cb79d3f6dfc5ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">find contravariant time component of four-velocity from the 4velocity (3 terms)  <a href="#a14046b9dfb71c88d01cb79d3f6dfc5ee">More...</a><br/></td></tr>
<tr class="separator:a14046b9dfb71c88d01cb79d3f6dfc5ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20be479a3f03f3de780359d6e9290fe3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#a20be479a3f03f3de780359d6e9290fe3">ucon_calc_rel4vel_fromuconrel</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *<a class="el" href="../../d7/def/phys_8tools_8c.html#a5910aabe5e76183d341ef5b830b01bab">uconrel</a>, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *geom, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *ucon, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *others)</td></tr>
<tr class="memdesc:a20be479a3f03f3de780359d6e9290fe3"><td class="mdescLeft">&#160;</td><td class="mdescRight">find u^ from {u}^ fill full 4-vector OPTMARK: Before storing , this was the most expensive function over the entire code [determined by avoiding inlining]  <a href="#a20be479a3f03f3de780359d6e9290fe3">More...</a><br/></td></tr>
<tr class="separator:a20be479a3f03f3de780359d6e9290fe3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfae38e47b0bd05a4fc38302ff948a96"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#abfae38e47b0bd05a4fc38302ff948a96">gamma_calc_fromuconrel</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *<a class="el" href="../../d7/def/phys_8tools_8c.html#a5910aabe5e76183d341ef5b830b01bab">uconrel</a>, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *geom, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *gamma, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *qsq)</td></tr>
<tr class="memdesc:abfae38e47b0bd05a4fc38302ff948a96"><td class="mdescLeft">&#160;</td><td class="mdescRight">find gamma-factor wrt normal observer This function and qsq_calc() have about the same cache miss amount now  <a href="#abfae38e47b0bd05a4fc38302ff948a96">More...</a><br/></td></tr>
<tr class="separator:abfae38e47b0bd05a4fc38302ff948a96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5910aabe5e76183d341ef5b830b01bab"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#a5910aabe5e76183d341ef5b830b01bab">uconrel</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *ucon, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *uconrel, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *geom)</td></tr>
<tr class="memdesc:a5910aabe5e76183d341ef5b830b01bab"><td class="mdescLeft">&#160;</td><td class="mdescRight">find {u}^ from u^ only fill spatial parts so can feed in 3-vector  <a href="#a5910aabe5e76183d341ef5b830b01bab">More...</a><br/></td></tr>
<tr class="separator:a5910aabe5e76183d341ef5b830b01bab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac70ef771b9a27ba780c06be637a8625"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#aac70ef771b9a27ba780c06be637a8625">ucon_calcother</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *<a class="el" href="../../dc/dd2/newcodediff_8txt.html#ae7ab77d7e616dc02fba121a009b48c27">pr</a>, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *ucon, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *others)</td></tr>
<tr class="separator:aac70ef771b9a27ba780c06be637a8625"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad93a871fdb6a9eccf12abac6f500734b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#ad93a871fdb6a9eccf12abac6f500734b">ucon_precalc</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *ucon, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *AA, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *BB, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *CC, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *discr)</td></tr>
<tr class="separator:ad93a871fdb6a9eccf12abac6f500734b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35c4399eb86e3fa77e2221000e077572"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#a35c4399eb86e3fa77e2221000e077572">ucon_calc_whichvel</a> (int whichvel, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *<a class="el" href="../../dc/dd2/newcodediff_8txt.html#ae7ab77d7e616dc02fba121a009b48c27">pr</a>, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *geom, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *ucon, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *others)</td></tr>
<tr class="separator:a35c4399eb86e3fa77e2221000e077572"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a837cc5e285c9e98d2b74a324352b0117"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#a837cc5e285c9e98d2b74a324352b0117">bsq_calc</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *<a class="el" href="../../dc/dd2/newcodediff_8txt.html#ae7ab77d7e616dc02fba121a009b48c27">pr</a>, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *geom, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *b2)</td></tr>
<tr class="separator:a837cc5e285c9e98d2b74a324352b0117"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41b8eacac0a4a23d6b00b670fe49629c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#a41b8eacac0a4a23d6b00b670fe49629c">bsq_calc_fromq</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *<a class="el" href="../../dc/dd2/newcodediff_8txt.html#ae7ab77d7e616dc02fba121a009b48c27">pr</a>, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *geom, struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *q, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *b2)</td></tr>
<tr class="separator:a41b8eacac0a4a23d6b00b670fe49629c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6beb1b8b0f44e037d6d6d3bd440f5641"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#a6beb1b8b0f44e037d6d6d3bd440f5641">b_calc</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *<a class="el" href="../../dc/dd2/newcodediff_8txt.html#ae7ab77d7e616dc02fba121a009b48c27">pr</a>, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *ucon, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *b)</td></tr>
<tr class="separator:a6beb1b8b0f44e037d6d6d3bd440f5641"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a347e39ff656263aea41c5e584700f201"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#a347e39ff656263aea41c5e584700f201">bsq_calc_rel4vel_fromq</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *<a class="el" href="../../dc/dd2/newcodediff_8txt.html#ae7ab77d7e616dc02fba121a009b48c27">pr</a>, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *ptrgeom, struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *q, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *bsq)</td></tr>
<tr class="separator:a347e39ff656263aea41c5e584700f201"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabc0a0c6e5daa8b0e10d4115b44b5f61"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#aabc0a0c6e5daa8b0e10d4115b44b5f61">get_allgeometry</a> (int <a class="el" href="../../d0/d10/datadesc_8txt.html#ad21ff679aac3fe28202c6d592eafd3e6">i</a>, int <a class="el" href="../../d0/d10/datadesc_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>, int k, int loc, struct <a class="el" href="../../dd/d56/structof__allgeom.html">of_allgeom</a> *allgeom, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *geom)</td></tr>
<tr class="separator:aabc0a0c6e5daa8b0e10d4115b44b5f61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11e17cd8b0594d1ad52e3594aa9f477e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#a11e17cd8b0594d1ad52e3594aa9f477e">get_state</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *<a class="el" href="../../dc/dd2/newcodediff_8txt.html#ae7ab77d7e616dc02fba121a009b48c27">pr</a>, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *geom, struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *q)</td></tr>
<tr class="memdesc:a11e17cd8b0594d1ad52e3594aa9f477e"><td class="mdescLeft">&#160;</td><td class="mdescRight">find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function expect to get q-&gt;{ucon,ucov,bcon,bcov,pressure}  <a href="#a11e17cd8b0594d1ad52e3594aa9f477e">More...</a><br/></td></tr>
<tr class="separator:a11e17cd8b0594d1ad52e3594aa9f477e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c69b676adf3024cd6ae832094d91fab"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#a3c69b676adf3024cd6ae832094d91fab">get_state_norad_part1</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *<a class="el" href="../../dc/dd2/newcodediff_8txt.html#ae7ab77d7e616dc02fba121a009b48c27">pr</a>, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *geom, struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *q)</td></tr>
<tr class="memdesc:a3c69b676adf3024cd6ae832094d91fab"><td class="mdescLeft">&#160;</td><td class="mdescRight">find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function expect to get q-&gt;{ucon,ucov,bcon,bcov,pressure}  <a href="#a3c69b676adf3024cd6ae832094d91fab">More...</a><br/></td></tr>
<tr class="separator:a3c69b676adf3024cd6ae832094d91fab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae6a7d24b984236dae44b1a3e8ee37b6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#aae6a7d24b984236dae44b1a3e8ee37b6">get_state_norad_part2</a> (int needentropy, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *<a class="el" href="../../dc/dd2/newcodediff_8txt.html#ae7ab77d7e616dc02fba121a009b48c27">pr</a>, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *geom, struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *q)</td></tr>
<tr class="memdesc:aae6a7d24b984236dae44b1a3e8ee37b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function expect to get q-&gt;{ucon,ucov,bcon,bcov,pressure}  <a href="#aae6a7d24b984236dae44b1a3e8ee37b6">More...</a><br/></td></tr>
<tr class="separator:aae6a7d24b984236dae44b1a3e8ee37b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07847bede2b7ba9d0aabaea82f17f989"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#a07847bede2b7ba9d0aabaea82f17f989">get_state_radonly</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *<a class="el" href="../../dc/dd2/newcodediff_8txt.html#ae7ab77d7e616dc02fba121a009b48c27">pr</a>, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *geom, struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *q)</td></tr>
<tr class="memdesc:a07847bede2b7ba9d0aabaea82f17f989"><td class="mdescLeft">&#160;</td><td class="mdescRight">find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function expect to get q-&gt;{ucon,ucov,bcon,bcov,pressure}  <a href="#a07847bede2b7ba9d0aabaea82f17f989">More...</a><br/></td></tr>
<tr class="separator:a07847bede2b7ba9d0aabaea82f17f989"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e351d63f2ee830fed250221b06034f7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#a7e351d63f2ee830fed250221b06034f7">get_state_nofield</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *<a class="el" href="../../dc/dd2/newcodediff_8txt.html#ae7ab77d7e616dc02fba121a009b48c27">pr</a>, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *geom, struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *q)</td></tr>
<tr class="memdesc:a7e351d63f2ee830fed250221b06034f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">all <a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#a11e17cd8b0594d1ad52e3594aa9f477e" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e...">get_state()</a> things except the field quantities  <a href="#a7e351d63f2ee830fed250221b06034f7">More...</a><br/></td></tr>
<tr class="separator:a7e351d63f2ee830fed250221b06034f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a689a0d22ad988934812b24448f9f8e91"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#a689a0d22ad988934812b24448f9f8e91">get_stateforcheckinversion</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *<a class="el" href="../../dc/dd2/newcodediff_8txt.html#ae7ab77d7e616dc02fba121a009b48c27">pr</a>, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *geom, struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *q)</td></tr>
<tr class="memdesc:a689a0d22ad988934812b24448f9f8e91"><td class="mdescLeft">&#160;</td><td class="mdescRight">used to check inversion, which has consistent pressure used to get things as functions of  instead of u in case of using jon's inversion  <a href="#a689a0d22ad988934812b24448f9f8e91">More...</a><br/></td></tr>
<tr class="separator:a689a0d22ad988934812b24448f9f8e91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12a473e24b431762af4168179e82cd08"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#a12a473e24b431762af4168179e82cd08">get_state_uconucovonly</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *<a class="el" href="../../dc/dd2/newcodediff_8txt.html#ae7ab77d7e616dc02fba121a009b48c27">pr</a>, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *ptrgeom, struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *q)</td></tr>
<tr class="memdesc:a12a473e24b431762af4168179e82cd08"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get only u^ and u_ assumine b^ and b_ not used.  <a href="#a12a473e24b431762af4168179e82cd08">More...</a><br/></td></tr>
<tr class="separator:a12a473e24b431762af4168179e82cd08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a035303dc3a9c5826bd56fdc2996fb2a3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#a035303dc3a9c5826bd56fdc2996fb2a3">get_stateforsource</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *<a class="el" href="../../dc/dd2/newcodediff_8txt.html#ae7ab77d7e616dc02fba121a009b48c27">pr</a>, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *ptrgeom, struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> **q)</td></tr>
<tr class="memdesc:a035303dc3a9c5826bd56fdc2996fb2a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">wrapper for choosing to get state by computing it or from global array pointer assign (overrides the existing default assignment of the pointer address in the calling function, so assumes calling function only uses pointer form subsequently)  <a href="#a035303dc3a9c5826bd56fdc2996fb2a3">More...</a><br/></td></tr>
<tr class="separator:a035303dc3a9c5826bd56fdc2996fb2a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92cd9cc63c782c0d94699d639aa48f69"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#a92cd9cc63c782c0d94699d639aa48f69">get_stateforfluxcalc</a> (int dimen, int isleftright, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *<a class="el" href="../../dc/dd2/newcodediff_8txt.html#ae7ab77d7e616dc02fba121a009b48c27">pr</a>, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *ptrgeom, struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> **qptr)</td></tr>
<tr class="memdesc:a92cd9cc63c782c0d94699d639aa48f69"><td class="mdescLeft">&#160;</td><td class="mdescRight">wrapper for choosing to get state by computing it or from global array notice that ptrgeom-&gt;p inputted not used  <a href="#a92cd9cc63c782c0d94699d639aa48f69">More...</a><br/></td></tr>
<tr class="separator:a92cd9cc63c782c0d94699d639aa48f69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c83a4e2d3fdf30054e2462d7b3a88f0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#a7c83a4e2d3fdf30054e2462d7b3a88f0">get_stateforinterpline</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *<a class="el" href="../../dc/dd2/newcodediff_8txt.html#ae7ab77d7e616dc02fba121a009b48c27">pr</a>, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *ptrgeom, struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> **qptr)</td></tr>
<tr class="memdesc:a7c83a4e2d3fdf30054e2462d7b3a88f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">wrapper for choosing to get state by computing it or from global array pointer assign (overrides the existing default assignment of the pointer address in the calling function, so assumes calling function only uses pointer form subsequently)  <a href="#a7c83a4e2d3fdf30054e2462d7b3a88f0">More...</a><br/></td></tr>
<tr class="separator:a7c83a4e2d3fdf30054e2462d7b3a88f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af560087e095f9677ac65b1bc6b424fa9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#af560087e095f9677ac65b1bc6b424fa9">get_stateforglobalwavespeeds</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *<a class="el" href="../../dc/dd2/newcodediff_8txt.html#ae7ab77d7e616dc02fba121a009b48c27">pr</a>, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *ptrgeom, struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> **qptr)</td></tr>
<tr class="memdesc:af560087e095f9677ac65b1bc6b424fa9"><td class="mdescLeft">&#160;</td><td class="mdescRight">wrapper for choosing to get state by computing it or from global array pointer assign (overrides the existing default assignment of the pointer address in the calling function, so assumes calling function only uses pointer form subsequently)  <a href="#af560087e095f9677ac65b1bc6b424fa9">More...</a><br/></td></tr>
<tr class="separator:af560087e095f9677ac65b1bc6b424fa9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19e08c0d7e5a7c9fb9d97ff5ffab053c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#a19e08c0d7e5a7c9fb9d97ff5ffab053c">primtoflux</a> (int returntype, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *pa, struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *q, int dir, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *geom, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *fl, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *flabs)</td></tr>
<tr class="memdesc:a19e08c0d7e5a7c9fb9d97ff5ffab053c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate fluxes in direction dir and conserved variable U returntype==0 : flux with geometric factor geom-&gt;e (used by evolution code) returntype==1 : flux with physical geometry factor geom-&gt;gdet (used by diagnostics) see UtoU and <a class="el" href="../../de/d8c/phys_8c.html#a44693eac289e90fab8a6792e6e9fb02c">source_conn()</a> Note that if MAXWELL==PRIMMAXWELL then primtoflux doesn't use b^ or b_ (bcon and bcov)  <a href="#a19e08c0d7e5a7c9fb9d97ff5ffab053c">More...</a><br/></td></tr>
<tr class="separator:a19e08c0d7e5a7c9fb9d97ff5ffab053c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bb12b388b07610cf01d08c19f8fddb1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#a0bb12b388b07610cf01d08c19f8fddb1">flux_compute_general</a> (int <a class="el" href="../../d0/d10/datadesc_8txt.html#ad21ff679aac3fe28202c6d592eafd3e6">i</a>, int <a class="el" href="../../d0/d10/datadesc_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>, int k, int dir, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *geom, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> CUf, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *p_c, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *p_l, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *p_r, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *F, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *ctopall)</td></tr>
<tr class="memdesc:a0bb12b388b07610cf01d08c19f8fddb1"><td class="mdescLeft">&#160;</td><td class="mdescRight">actually compute the flux and ctop for dt calculation  <a href="#a0bb12b388b07610cf01d08c19f8fddb1">More...</a><br/></td></tr>
<tr class="separator:a0bb12b388b07610cf01d08c19f8fddb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ebf7765a6bde079a76719b89d3033b6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#a4ebf7765a6bde079a76719b89d3033b6">source</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *pi, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *pa, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *pf, int *didreturnpf, int *eomtype, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *geom, struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *q, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *Ui, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *Uf, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *CUf, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *CUimp, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> dissmeasure, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *dUriemann, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*Uacomp)[NPR], <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *Ua)</td></tr>
<tr class="memdesc:a4ebf7765a6bde079a76719b89d3033b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">add in source terms to equations of motion ui and dUriemann in UEVOLVE form assume q(pr) so consistent, but p or ui don't yet account for dUriemann!  <a href="#a4ebf7765a6bde079a76719b89d3033b6">More...</a><br/></td></tr>
<tr class="separator:a4ebf7765a6bde079a76719b89d3033b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7808b4135837eb79e632c943ba9f19b0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#a7808b4135837eb79e632c943ba9f19b0">taper_func</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> <a class="el" href="../../d8/d5b/defs_8general_8h.html#abf002e87ba3ed4d3c9dcc98216e6d9d6">R</a>, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> <a class="el" href="../../dc/d88/init_8koral_8c.html#a00f77d9a8d223672e72eba98838f5e2e">rin</a>)</td></tr>
<tr class="separator:a7808b4135837eb79e632c943ba9f19b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea709ca8b25507c5556269e051cd42b2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#aea709ca8b25507c5556269e051cd42b2">lc4</a> (int updown, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> detg, int <a class="el" href="../../d0/d10/datadesc_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>, int <a class="el" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee">nu</a>, int kappa, int lambda)</td></tr>
<tr class="memdesc:aea709ca8b25507c5556269e051cd42b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">used Mathematica's MinimumChangePermutations and Signature updown = 0 : down updown = 1 : up  <a href="#aea709ca8b25507c5556269e051cd42b2">More...</a><br/></td></tr>
<tr class="separator:aea709ca8b25507c5556269e051cd42b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2568131c22f54019d6ae406ef7326066"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#a2568131c22f54019d6ae406ef7326066">faraday_calc</a> (int which, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *b, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *u, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *geom, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*faraday)[<a class="el" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>])</td></tr>
<tr class="memdesc:a2568131c22f54019d6ae406ef7326066"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute faraday assumes b and u are inputted as bcov&amp;ucov for F^{} and bcon&amp;ucon for F_{}.  <a href="#a2568131c22f54019d6ae406ef7326066">More...</a><br/></td></tr>
<tr class="separator:a2568131c22f54019d6ae406ef7326066"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Function declarations for global use of things in <a class="el" href="../../de/d8c/phys_8c.html" title="All globally-related physics calculations THINGS IN HERE ARE NOT PER POINT OR USE GLOBAL VARIABLES or...">phys.c</a>. </p>

<p>Definition in file <a class="el" href="../../d3/ddc/phys_8funcdeclare_8h_source.html">phys.funcdeclare.h</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ab14fcc0bc1a93e5fac623d16ba873fb5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define bsq_calc&#160;&#160;&#160;<a class="el" href="../../d7/def/phys_8tools_8c.html#aedc30b56b48db47c3622b2d6c55161d9">bsq_calc_general</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d3/ddc/phys_8funcdeclare_8h_source.html#l00028">28</a> of file <a class="el" href="../../d3/ddc/phys_8funcdeclare_8h_source.html">phys.funcdeclare.h</a>.</p>

</div>
</div>
<a class="anchor" id="a46db46b8bc800e45c0e352c0cc01d9d3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define bsq_calc_fromq&#160;&#160;&#160;<a class="el" href="../../d7/def/phys_8tools_8c.html#a281ba6e6bcafdff7fc3e8c71e405fdee">bsq_calc_fromq_general</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d3/ddc/phys_8funcdeclare_8h_source.html#l00029">29</a> of file <a class="el" href="../../d3/ddc/phys_8funcdeclare_8h_source.html">phys.funcdeclare.h</a>.</p>

</div>
</div>
<a class="anchor" id="a9d8f2ff21b603eabf98bf7c100c5af7d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define compute_1plusud0&#160;&#160;&#160;<a class="el" href="../../d7/def/phys_8tools_8c.html#a2bbec7298dca0647305d2dd8e4c3b7f3">compute_1plusud0_general</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d3/ddc/phys_8funcdeclare_8h_source.html#l00027">27</a> of file <a class="el" href="../../d3/ddc/phys_8funcdeclare_8h_source.html">phys.funcdeclare.h</a>.</p>

</div>
</div>
<a class="anchor" id="a502c507b1c1c31f170c828fdb004a8a4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define dudp_calc&#160;&#160;&#160;dudp_calc_gen</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d3/ddc/phys_8funcdeclare_8h_source.html#l00026">26</a> of file <a class="el" href="../../d3/ddc/phys_8funcdeclare_8h_source.html">phys.funcdeclare.h</a>.</p>

</div>
</div>
<a class="anchor" id="a3059ed7bfcfb692cbe8014d55fd7c1e4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define get_geometry</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ii, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">jj, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">kk, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">pp, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ptrgeom&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;get_geometry_old(ii,jj,kk,pp,ptrgeom)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d3/ddc/phys_8funcdeclare_8h_source.html#l00117">117</a> of file <a class="el" href="../../d3/ddc/phys_8funcdeclare_8h_source.html">phys.funcdeclare.h</a>.</p>

</div>
</div>
<a class="anchor" id="a9740cb914b7803b1ba73f76a9a37ddc2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define get_geometry_gdetmix</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ii, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">jj, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">kk, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">pp, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ptrgeom&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;get_geometry_old(ii,jj,kk,pp,ptrgeom)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d3/ddc/phys_8funcdeclare_8h_source.html#l00118">118</a> of file <a class="el" href="../../d3/ddc/phys_8funcdeclare_8h_source.html">phys.funcdeclare.h</a>.</p>

</div>
</div>
<a class="anchor" id="a29d77750db58af63e128049ca865c364"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define get_geometry_gdetonly</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ii, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">jj, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">kk, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">pp, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ptrgeom&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;get_geometry_gdetonly_old(ii,jj,kk,pp,ptrgeom)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d3/ddc/phys_8funcdeclare_8h_source.html#l00119">119</a> of file <a class="el" href="../../d3/ddc/phys_8funcdeclare_8h_source.html">phys.funcdeclare.h</a>.</p>

</div>
</div>
<a class="anchor" id="a872dfd0c4407ee5b6ff2a6b9bea3b2f0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define get_geometry_geomeonly</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ii, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">jj, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">kk, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">pp, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ptrgeom&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;get_geometry_geomeonly_old(ii,jj,kk,pp,ptrgeom)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d3/ddc/phys_8funcdeclare_8h_source.html#l00120">120</a> of file <a class="el" href="../../d3/ddc/phys_8funcdeclare_8h_source.html">phys.funcdeclare.h</a>.</p>

</div>
</div>
<a class="anchor" id="ad9d84e0517b3901a38bee832bca8133f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define set_igdet</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">arg</td><td>)</td>
          <td>&#160;&#160;&#160;set_igdet_old(arg)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d3/ddc/phys_8funcdeclare_8h_source.html#l00121">121</a> of file <a class="el" href="../../d3/ddc/phys_8funcdeclare_8h_source.html">phys.funcdeclare.h</a>.</p>

</div>
</div>
<a class="anchor" id="adcfebf340c9017d7989eb3bdd344da45"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define set_igdetsimple</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">arg</td><td>)</td>
          <td>&#160;&#160;&#160;set_igdetsimple_old(arg)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d3/ddc/phys_8funcdeclare_8h_source.html#l00122">122</a> of file <a class="el" href="../../d3/ddc/phys_8funcdeclare_8h_source.html">phys.funcdeclare.h</a>.</p>

</div>
</div>
<a class="anchor" id="afc93fd4a6f7a2b87a9315d5fba5a529c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ucon_calc&#160;&#160;&#160;<a class="el" href="../../d7/def/phys_8tools_8c.html#ad141359a7901a82a0c26241b432183c3">ucon_calc_4vel</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d3/ddc/phys_8funcdeclare_8h_source.html#l00025">25</a> of file <a class="el" href="../../d3/ddc/phys_8funcdeclare_8h_source.html">phys.funcdeclare.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a6beb1b8b0f44e037d6d6d3bd440f5641"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void b_calc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>ucon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a837cc5e285c9e98d2b74a324352b0117"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int bsq_calc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>geom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>b2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_a837cc5e285c9e98d2b74a324352b0117_icgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_a837cc5e285c9e98d2b74a324352b0117_icgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_a837cc5e285c9e98d2b74a324352b0117_icgraph" id="d3/ddc/phys_8funcdeclare_8h_a837cc5e285c9e98d2b74a324352b0117_icgraph">
<area shape="rect" id="node3" href="../../db/dd4/global_8bounds_8h.html#a5bc91fa94289e7828d62831b8e3ff032" title="interpolate across pole to remove numerical errors there Note that this function is done over all zon..." alt="" coords="177,752,255,781"/><area shape="rect" id="node121" href="../../d8/d60/init_8c.html#a73009fd6280963c265e2cf5d1c353e8d" title="get_full_rtsolution" alt="" coords="367,867,489,896"/><area shape="rect" id="node130" href="../../d8/d60/init_8c.html#a83e7f10ffd348c4d18b3245dd4bab585" title="make_nonrt2rt_solution" alt="" coords="137,817,295,847"/><area shape="rect" id="node133" href="../../df/d15/init_8tools_8c.html#ab9289a2b656528d3cb568771217738cb" title="user1_get_maxes" alt="" coords="153,921,279,951"/><area shape="rect" id="node142" href="../../df/d15/init_8tools_8c.html#a2ad6b8c362247ede9057a807af67ba33" title="user1_normalize_densities\l_postnormalizefield" alt="" coords="128,974,304,1021"/><area shape="rect" id="node144" href="../../df/d15/init_8tools_8c.html#a7aac8098faa119fe90215c67f988c0d4" title="user1_get_sigmabsq\l_atpole" alt="" coords="145,1043,287,1090"/><area shape="rect" id="node5" href="../../db/dd4/global_8bounds_8h.html#a9ee1f775df570fbf5bcc33d98cda591b" title="X2 inner POLARAXIS with full3d, flip sign of both B2 and B3 Flip B2 because ghost cells will then be ..." alt="" coords="353,743,503,790"/><area shape="rect" id="node112" href="../../db/dd4/global_8bounds_8h.html#acaf14829924c215a4c384ab2fbcfaada" title="X2 inner POLARAXIS." alt="" coords="353,813,503,843"/><area shape="rect" id="node115" href="../../db/dd4/global_8bounds_8h.html#af1d75ea3bcf2c779b6cd71e4c5be7f9f" title="X2 outer POLARAXIS full3d." alt="" coords="353,621,503,667"/><area shape="rect" id="node118" href="../../db/dd4/global_8bounds_8h.html#ae75b409014aeacf5e69e88f29f2dfb8b" title="X2 outer POLARAXIS." alt="" coords="353,691,503,720"/><area shape="rect" id="node7" href="../../de/d51/bounds_8c.html#a34ac3f1ca7b0f3a21053c633da9931a9" title="user boundary routine" alt="" coords="552,693,723,723"/><area shape="rect" id="node9" href="../../d4/dad/bounds_8funcdeclare_8h.html#a4bc7413b2cdb89e070f38bbb689ae555" title="bound_prim_user_dir" alt="" coords="775,667,916,696"/><area shape="rect" id="node101" href="../../d4/dad/bounds_8funcdeclare_8h.html#a2fbddc9ff8fc706bafa80c39695c7262" title="assume single user function takes care of primitive locations" alt="" coords="968,741,1117,771"/><area shape="rect" id="node11" href="../../d9/de0/step__ch_8c.html#adbe0e3ba8a74f09ab928a96bd68cab6d" title="bound any prim type CALLS directly real and MPI boundary functions pstag = pstagglobal ucons = unewgl..." alt="" coords="988,385,1097,415"/><area shape="rect" id="node13" href="../../d9/de0/step__ch_8c.html#a689fddc1949b1a1d390b59d10d17d83c" title="normal full bounding during evolution NOTEMARK: Was previously also bounding pstag here..." alt="" coords="1184,59,1309,88"/><area shape="rect" id="node26" href="../../d9/de0/step__ch_8c.html#a4079244d85c301885c1363ca41502869" title="simple bounding during evolution NOTEMARK: Was previously also bounding pstag here, but not necessary since done by calling bound_pstag in fluxctstag.c" alt="" coords="1165,5,1328,35"/><area shape="rect" id="node29" href="../../d9/de0/step__ch_8c.html#addca75a18cc861326a321565a2e81aa0" title="normal bounding of non&#45;staggered primitives" alt="" coords="1203,385,1291,415"/><area shape="rect" id="node95" href="../../d9/de0/step__ch_8c.html#a460b84e1112e3aef17209c20e22e1cf1" title="bound all prims" alt="" coords="1639,697,1761,727"/><area shape="rect" id="node15" href="../../d9/de0/step__ch_8c.html#ad36a0f9f915547477e3bb2405f8166b9" title="things to do after advance()" alt="" coords="1415,5,1516,35"/><area shape="rect" id="node17" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="2823,111,2956,140"/><area shape="rect" id="node19" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="3043,249,3109,279"/><area shape="rect" id="node21" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="3348,380,3439,409"/><area shape="rect" id="node23" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="3488,449,3539,479"/><area shape="rect" id="node31" href="../../dc/dae/flux_8c.html#aef355ccd1ca2295b84ad2fe1fc011d35" title="normal interpolation of CENT quantities to FACE quantities sets global variables pl_ct and pr_ct to p..." alt="" coords="1376,283,1555,312"/><area shape="rect" id="node48" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aecb3f613a7cb3bbb42fff2dbee5d65a1" title="This vpot2field function is for staggered method to evolve quasi&#45;deaveraged fields (i..." alt="" coords="2073,543,2239,572"/><area shape="rect" id="node50" href="../../de/db2/initbase_8funcdeclare_8h.html#ae6b2ad4cd0debf5b89ba8a9e471d6977" title="assumes normal field p pleft used as temp var if FLUXB==FLUXCTSTAG assigns conserved field in UEVOLVE..." alt="" coords="2289,555,2367,584"/><area shape="rect" id="node58" href="../../df/d15/init_8tools_8c.html#a77551ab2581efdbaf170dfca073ff9ab" title="user1_init_primitives" alt="" coords="3005,635,3147,664"/><area shape="rect" id="node62" href="../../de/df8/initbase_8c.html#ac4110398e386c9888d9565630357dbbe" title="General&#45;Primary init() routine Uses globals inside init() because sets memory and sets physics..." alt="" coords="3375,517,3412,547"/><area shape="rect" id="node65" href="../../d0/dde/fluxctstag_8c.html#a4e3d76c6ad125b8199948408c262e3a1" title="wrapper for: 1) interpolate FACE 2 CORN 2) loop over dimensions setting field flux dimension&#45;by&#45;dimen..." alt="" coords="1869,188,2000,217"/><area shape="rect" id="node68" href="../../d0/dde/fluxctstag_8c.html#a2dd789bf1402bef72523cdb69e85806e" title="use global pbcorninterp and pvcorninterp at CORN1,2,3 to obtain EMFs at CORN1,2,3 NO interpolation of..." alt="" coords="1400,159,1531,206"/><area shape="rect" id="node71" href="../../d0/dde/fluxctstag_8c.html#aaec26a518629175ecceefbaf6c84225e" title="wrapper for continuous interpolation for FACE_to_CENT" alt="" coords="1379,437,1552,467"/><area shape="rect" id="node75" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aa31dd83c96936277334c62e2098dd51d" title="wrapper for taking staggered conserved field quantity and obtaining centered field quantity upoint en..." alt="" coords="1847,373,2023,403"/><area shape="rect" id="node84" href="../../d0/dde/fluxctstag_8c.html#a6cd90dff56319085b32bc57c0c8b3cfd" title="this function called in initbase.c and during advance() here ustag is point value if dimension doesn&#39;..." alt="" coords="1640,321,1760,351"/><area shape="rect" id="node87" href="../../d0/dde/fluxctstag_8c.html#ad6aa918442f7768dff3c099ba353ee64" title="slope_lim_face2corn() is provided p2interp and returns pleft/pright differs from slope_lim() by range..." alt="" coords="1395,229,1536,259"/><area shape="rect" id="node33" href="../../dc/dae/flux_8c.html#a2602a4dad9ed7adc944227d02435312e" title="standard (non&#45;field flux) calculation but setup to store results of interpolation so can be used for ..." alt="" coords="1603,268,1797,297"/><area shape="rect" id="node35" href="../../dc/dae/flux_8c.html#aaf6d832880760f80459d91477c28b519" title="wrapper for different standard 1&#45;D flux calculators 1&#45;D interpolate and get flux for that direction (..." alt="" coords="1877,268,1992,297"/><area shape="rect" id="node37" href="../../dc/dae/flux_8c.html#a8ffa7399bd5354fdcdec5f3e1adf0b13" title="wrapper for CENT_to_FACE1,2,3 used to compute flux at face" alt="" coords="2109,268,2203,297"/><area shape="rect" id="node39" href="../../d5/d2f/flux_8funcdeclare_8h.html#ab229b0f3f2caf3c0a3ef5299fba2b1c0" title="see fluxcompute.c for non&#45;computer science, real physics calculations of flux" alt="" coords="2295,268,2361,297"/><area shape="rect" id="node41" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="2439,268,2567,297"/><area shape="rect" id="node46" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="2425,347,2580,376"/><area shape="rect" id="node43" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="2671,216,2740,245"/><area shape="rect" id="node52" href="../../df/d15/init_8tools_8c.html#a3750bc790613bc6c8c805af0f1b839c8" title="user1_init_vpot2field_user" alt="" coords="2416,568,2589,597"/><area shape="rect" id="node54" href="../../de/db2/initbase_8funcdeclare_8h.html#afda44281ad5c163455c40f012d4a8954" title="init_vpot2field_user" alt="" coords="2639,596,2772,625"/><area shape="rect" id="node56" href="../../de/db2/initbase_8funcdeclare_8h.html#a90699a18ede8b7f112c0078512804ec1" title="initialize vector potential given user function assumes normal non&#45;staggered field in pr Notice that ..." alt="" coords="2855,596,2924,625"/><area shape="rect" id="node60" href="../../de/db2/initbase_8funcdeclare_8h.html#a0afa200a5f947b1c9f6e554519f28fc4" title="init_primitives" alt="" coords="3196,608,3297,637"/><area shape="rect" id="node73" href="../../d0/dde/fluxctstag_8c.html#a5e3dcbe89d6f8a9384cafb58afd7dbf4" title="interpolates field at FACE to field at CENT assuming field along itself is continuous" alt="" coords="1640,425,1760,471"/><area shape="rect" id="node79" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aaa24493002bc8c0a527b1ea2ac2dddbf" title="convert conservative U to stag point P and CENT point U and CENT point primitive" alt="" coords="2089,439,2223,468"/><area shape="rect" id="node89" href="../../d0/dde/fluxctstag_8c.html#a985ee116306b4011810334ae93900493" title="INPUTS: Nvec, pr, primface_l[dir], primface_r[dir] OUTPUTS: pbcorn[dir][side], pvcorn[dir][side][side..." alt="" coords="1611,215,1789,244"/><area shape="rect" id="node97" href="../../d9/de0/step__ch_8c.html#a91fe5c4370e3292a19e7f794797a407f" title="normal bounding of all primitives" alt="" coords="2839,543,2940,572"/><area shape="rect" id="node103" href="../../d9/de0/step__ch_8c.html#abdea68b778dc9253324da69d3c376965" title="bound any pstag type CALLS directly real and MPI boundary functions pstag is at FACE1,2,3 for fields, so user bound is different MPI bounding is the same as CENT quantities used when restarting in initbase.c to bound unewglobal for FLUXB==FLUXCTSTAG" alt="" coords="1407,751,1524,780"/><area shape="rect" id="node106" href="../../d9/de0/step__ch_8c.html#a6f4b963a50a7288964f01775f2f18bb9" title="normal bounding of staggered primitives" alt="" coords="1652,751,1748,780"/><area shape="rect" id="node109" href="../../d0/dde/fluxctstag_8c.html#aa169cb1999412f2e2460012cc5d7a804" title="pure DONOR version: upoint is input staggered updated field that needs to be converted to pstag and t..." alt="" coords="1847,747,2023,794"/><area shape="rect" id="node123" href="../../d8/d60/init_8c.html#af94364e17d67cddfbb7bb3bf39c05ee6" title="init_dsandvels_koral" alt="" coords="776,808,915,837"/><area shape="rect" id="node128" href="../../d8/d60/init_8c.html#a448cd3fd9a1d862485e7b6e67b965172" title="process_restart_toget\l_radiation" alt="" coords="564,858,711,905"/><area shape="rect" id="node125" href="../../df/d15/init_8tools_8c.html#acefd26944dbbb1c289886f520f6befac" title="init_dsandvels" alt="" coords="991,848,1095,877"/><area shape="rect" id="node135" href="../../d8/d60/init_8c.html#ad10623d5c2fc6a304322571f638ef538" title="get_maxes" alt="" coords="595,928,680,957"/><area shape="rect" id="node137" href="../../df/d15/init_8tools_8c.html#af422330f01b143bf1de8b2e2413fe28d" title="user1_normalize_field" alt="" coords="772,925,919,955"/><area shape="rect" id="node139" href="../../d8/d60/init_8c.html#a5622ff1892053efcbc8cb4f0d3b179f7" title="normalize_field" alt="" coords="2101,923,2211,952"/><area shape="rect" id="node146" href="../../df/d15/init_8tools_8c.html#a2b021bfb1a7f7c64def1a19133cc3c27" title="user1_normalize_field\l_sigma" alt="" coords="355,1043,501,1090"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a41b8eacac0a4a23d6b00b670fe49629c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int bsq_calc_fromq </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>geom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>b2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_a41b8eacac0a4a23d6b00b670fe49629c_icgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_a41b8eacac0a4a23d6b00b670fe49629c_icgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_a41b8eacac0a4a23d6b00b670fe49629c_icgraph" id="d3/ddc/phys_8funcdeclare_8h_a41b8eacac0a4a23d6b00b670fe49629c_icgraph">
<area shape="rect" id="node3" href="../../d7/def/phys_8tools_8c.html#a9684455352a66ce457839e4eb0c4c172" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="243,738,317,768"/><area shape="rect" id="node56" href="../../d2/d72/phys_8tools_8rad_8c.html#af46d2b1cf89a70a7e2ef503146c649a9" title="uu0 &#45; original cons." alt="" coords="703,308,777,337"/><area shape="rect" id="node217" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a7e078cc9a354495bc85554d875a705d9" title="General explicit inversion of U[MHD]&#45;&gt;P[MHD] and also inverts scalars. Inverts radiation if(EOMRADTYP..." alt="" coords="696,153,784,182"/><area shape="rect" id="node259" href="../../d7/def/phys_8tools_8c.html#a996b0ad97444a5dc3a7e6a90ee81facd" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="205,308,355,337"/><area shape="rect" id="node265" href="../../d7/def/phys_8tools_8c.html#ad46675c486138b240d9bfa27e5ca262a" title="used to check inversion, which has consistent pressure used to get things as functions of &#160;instead of..." alt="" coords="191,845,369,874"/><area shape="rect" id="node267" href="../../d7/def/phys_8tools_8c.html#adf1cf36a7c564b77dca08d26ce233df7" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="200,153,360,182"/><area shape="rect" id="node279" href="../../d7/def/phys_8tools_8c.html#a39e973bfdc6ccf9e82b33925e073fca3" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="2247,130,2401,160"/><area shape="rect" id="node285" href="../../d7/def/phys_8tools_8c.html#a932c3d0ede37a07f6d380cf6ce07e0b0" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="196,898,364,928"/><area shape="rect" id="node308" href="../../d7/def/phys_8tools_8c.html#a3ef47960a272ef981fd551582b610503" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="169,792,391,821"/><area shape="rect" id="node313" href="../../d7/def/phys_8tools_8c.html#a4fe81910bc63688d418cca528888089e" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="175,952,385,981"/><area shape="rect" id="node5" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="3567,773,3695,802"/><area shape="rect" id="node17" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="3553,261,3708,290"/><area shape="rect" id="node19" href="../../df/d22/advance_8c.html#a0936d88b132d9655aa9287035a4793c5" title="If density or gamma&#45;factors are different by more than fractional_difference_threshold for states pin..." alt="" coords="445,1022,587,1052"/><area shape="rect" id="node21" href="../../d5/de3/phys_8tools_8funcdeclare_8h.html#ac9512f95a18d4a189ac642d138f95051" title="2D only for now since really only useful for 2D imaging map out region around failure point OPENMPNOT..." alt="" coords="1889,1550,1967,1580"/><area shape="rect" id="node32" href="../../d6/db2/diag_8funcdeclare_8h.html#a53324e6dbf9729772e70f0a053468ae6" title="set var to be averaged in time" alt="" coords="1880,1497,1976,1526"/><area shape="rect" id="node37" href="../../dc/dae/flux_8c.html#aa26f8747446e1cd5bd214ebc345aafa2" title="compute donor&#45;based flux, bypassing normal fluxcalc()." alt="" coords="2079,308,2185,337"/><area shape="rect" id="node40" href="../../d8/d60/init_8c.html#af3b64278d50c2ff0fee80291fbd38dab" title="fieldprim" alt="" coords="928,665,997,694"/><area shape="rect" id="node54" href="../../d7/def/phys_8tools_8c.html#aedc30b56b48db47c3622b2d6c55161d9" title="returns b^2 (i.e., twice magnetic pressure)" alt="" coords="455,1076,577,1105"/><area shape="rect" id="node58" href="../../d2/d72/phys_8tools_8rad_8c.html#a17aede36203a236390363af78d3a86f0" title="compute changes to U (both T and R) using implicit method KORALTODO: If doing implicit, should also add geometry source term that can sometimes be stiff." alt="" coords="1097,260,1305,289"/><area shape="rect" id="node60" href="../../d2/d72/phys_8tools_8rad_8c.html#a675bb3f12a77c62cf2540bc42c4867f8" title="wrapper for mode method" alt="" coords="1383,412,1551,441"/><area shape="rect" id="node75" href="../../d2/d72/phys_8tools_8rad_8c.html#a2a80e3b7ea37b9536f0e49cc740425c9" title="get 4&#45;force for all pl&#39;s" alt="" coords="440,358,592,388"/><area shape="rect" id="node78" href="../../d2/d72/phys_8tools_8rad_8c.html#a3ad3833ac14b93095e76f8d915c5c9ad" title="calcfull_Trad" alt="" coords="468,1129,564,1158"/><area shape="rect" id="node80" href="../../d2/d72/phys_8tools_8rad_8c.html#ad1313c275fb108d10f866373d9bb227a" title="like prad_fforlab() but for only whichdir=LAB2FF used for dumps or diags" alt="" coords="471,764,561,793"/><area shape="rect" id="node213" href="../../d2/d72/phys_8tools_8rad_8c.html#ad6748b88a3ad397cb35b4d60c108508d" title="calcfull_tautot" alt="" coords="465,1396,567,1425"/><area shape="rect" id="node224" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a58011440113d7e9adf2b0af40e531f25" title="loop for P&#45;&gt;U" alt="" coords="471,1449,561,1478"/><area shape="rect" id="node226" href="../../d8/d20/vchar_8c.html#acad033b60e7ca6404ffcd9b0fdfd13b4" title="simplefast" alt="" coords="699,1292,781,1321"/><area shape="rect" id="node238" href="../../d2/dd4/wavespeeds_8funcdeclare_8h.html#a2afa5dfde87c74476341a69d555f91e6" title="get wave speeds for flux calculation" alt="" coords="1641,1206,1761,1236"/><area shape="rect" id="node7" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="3799,977,3868,1006"/><area shape="rect" id="node9" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="3951,1466,4084,1496"/><area shape="rect" id="node11" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="4171,1492,4237,1521"/><area shape="rect" id="node13" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="4329,1518,4420,1548"/><area shape="rect" id="node15" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="4563,1518,4613,1548"/><area shape="rect" id="node23" href="../../d6/db2/diag_8funcdeclare_8h.html#ac0efe363ff7411385b5c6ab3b1f146aa" title="main diag() call for diagnostics OPENMPNOTE: Assume diag() not called by multiple threads..." alt="" coords="2301,1549,2347,1578"/><area shape="rect" id="node26" href="../../d9/de0/step__ch_8c.html#a4c42d9adb1cef442b95fd62f99ee087a" title="things to do before taking a full timestep assume not called when dt==0.0" alt="" coords="3791,1544,3876,1573"/><area shape="rect" id="node29" href="../../d9/de0/step__ch_8c.html#ad36a0f9f915547477e3bb2405f8166b9" title="things to do after advance()" alt="" coords="2492,1493,2593,1522"/><area shape="rect" id="node34" href="../../d6/db2/diag_8funcdeclare_8h.html#a6bd89f9169256368191c508d23b0b453" title="if doavg==1, then assume this is call before dumping" alt="" coords="2083,1497,2181,1526"/><area shape="rect" id="node42" href="../../df/d15/init_8tools_8c.html#acefd26944dbbb1c289886f520f6befac" title="init_dsandvels" alt="" coords="1149,516,1253,545"/><area shape="rect" id="node51" href="../../de/db2/initbase_8funcdeclare_8h.html#a4e121b9448ac1adaa7608206369f9ea5" title="init_postvpot" alt="" coords="3583,490,3679,520"/><area shape="rect" id="node44" href="../../df/d15/init_8tools_8c.html#a77551ab2581efdbaf170dfca073ff9ab" title="user1_init_primitives" alt="" coords="4133,900,4275,929"/><area shape="rect" id="node46" href="../../de/db2/initbase_8funcdeclare_8h.html#a0afa200a5f947b1c9f6e554519f28fc4" title="init_primitives" alt="" coords="4324,950,4425,980"/><area shape="rect" id="node48" href="../../de/df8/initbase_8c.html#ac4110398e386c9888d9565630357dbbe" title="General&#45;Primary init() routine Uses globals inside init() because sets memory and sets physics..." alt="" coords="4476,990,4513,1020"/><area shape="rect" id="node70" href="../../d2/d72/phys_8tools_8rad_8c.html#afa73a2caa3209e565a64f92447058507" title="calculating approximate Jacobian: dUresid(dUrad,G(Urad))/dUrad = dy(x)/dx then compute inverse Jacobi..." alt="" coords="911,258,1015,288"/><area shape="rect" id="node62" href="../../d2/d72/phys_8tools_8rad_8c.html#aa8c5c0d5de580899948f9f22e10aff23" title="General radiation source term calculation (EXTERNALLY called) NOTE: source_explicit() takes as first ..." alt="" coords="2072,412,2192,441"/><area shape="rect" id="node64" href="../../d2/d1d/sources_8c.html#a504ce383765ca3d2ff0b1ee653aff854" title="Ugeomfree and dUother are in UNOTHING form (or UEVOLVE without geometry) pf might be modified so bett..." alt="" coords="3180,412,3287,441"/><area shape="rect" id="node66" href="../../d7/def/phys_8tools_8c.html#a12ce5092c3a1a566cb7a560a7440acc1" title="add in source terms to equations of motion ui and dUriemann in UEVOLVE form assume q(pr) so consisten..." alt="" coords="3400,412,3461,441"/><area shape="rect" id="node82" href="../../d2/d72/phys_8tools_8rad_8c.html#af50896d039d660550b738862b3390b07" title="radiative ortonormal ff primitives (E,F^i) &lt;&#45;&gt; primitives in lab frame Used only for initial conditio..." alt="" coords="695,764,785,793"/><area shape="rect" id="node84" href="../../d8/d60/init_8c.html#af94364e17d67cddfbb7bb3bf39c05ee6" title="init_dsandvels_koral" alt="" coords="893,745,1032,774"/><area shape="rect" id="node87" href="../../d8/d60/init_8c.html#a448cd3fd9a1d862485e7b6e67b965172" title="process_restart_toget\l_radiation" alt="" coords="889,882,1036,928"/><area shape="rect" id="node89" href="../../d2/d72/phys_8tools_8rad_8c.html#a64226cb28f52020ffe18ac6c6b1a2f5c" title="Input: start with pin [with fluid in whichvel velocity and whichcoordfluid coordinates (PRIMECOORDS o..." alt="" coords="897,812,1028,859"/><area shape="rect" id="node91" href="../../de/d51/bounds_8c.html#a3bc773d499b145705bdc23125b963840" title="Koral specific physical boundary conditions." alt="" coords="1367,822,1567,852"/><area shape="rect" id="node178" href="../../de/d51/bounds_8c.html#a09a080d9895db7b800a3824cb3fac9f1" title="X1 lower for beam injection to create shadow." alt="" coords="1387,876,1547,905"/><area shape="rect" id="node181" href="../../de/d51/bounds_8c.html#a3ee134cc5fb18752265c16a20dbdfb63" title="X3 lower for radiation beam injection." alt="" coords="1369,929,1564,958"/><area shape="rect" id="node184" href="../../de/d51/bounds_8c.html#a8300ddf3ae6a3866234cc0e9c12f26dc" title="X1 upper for inflow." alt="" coords="1373,982,1560,1012"/><area shape="rect" id="node187" href="../../de/d51/bounds_8c.html#a01088f65c7a4cfa2ebfed202f815b951" title="X1 lower and upper for RADATM." alt="" coords="1381,1036,1552,1065"/><area shape="rect" id="node190" href="../../de/d51/bounds_8c.html#a1382959a7b699ea5d224168612504263" title="X1 upper for inflow." alt="" coords="1393,1089,1540,1118"/><area shape="rect" id="node193" href="../../de/d51/bounds_8c.html#ac15824bc610943cb7e02112e77b94752" title="on&#45;grid bounding" alt="" coords="1417,1142,1516,1172"/><area shape="rect" id="node196" href="../../de/d51/bounds_8c.html#a42658c4ecf3c6edb958394eb65a9ac2b" title="RADNT." alt="" coords="1155,569,1248,598"/><area shape="rect" id="node199" href="../../de/d51/bounds_8c.html#a3e4008fd24427b2e91d0ae5882b9536a" title="X1 upper for RADCYLBEAM." alt="" coords="1119,622,1284,652"/><area shape="rect" id="node202" href="../../de/d51/bounds_8c.html#ac32c1a20138382904dc5f1c66778ad8b" title="X1 upper for RADCYLJET." alt="" coords="1128,676,1275,705"/><area shape="rect" id="node205" href="../../de/d51/bounds_8c.html#a635fbaba3d6d6afcf5f34bbb2c278737" title="X2 upper for radiation beam injection." alt="" coords="1087,729,1316,758"/><area shape="rect" id="node208" href="../../de/d51/bounds_8c.html#a9f1df4e461f3f776bf3cb80e36a4d6df" title="get_radcylbeamcart" alt="" coords="1133,782,1269,812"/><area shape="rect" id="node93" href="../../de/d51/bounds_8c.html#a34ac3f1ca7b0f3a21053c633da9931a9" title="user boundary routine" alt="" coords="1616,849,1787,878"/><area shape="rect" id="node95" href="../../d4/dad/bounds_8funcdeclare_8h.html#a4bc7413b2cdb89e070f38bbb689ae555" title="bound_prim_user_dir" alt="" coords="1857,957,1999,986"/><area shape="rect" id="node167" href="../../d4/dad/bounds_8funcdeclare_8h.html#a2fbddc9ff8fc706bafa80c39695c7262" title="assume single user function takes care of primitive locations" alt="" coords="1853,722,2003,752"/><area shape="rect" id="node97" href="../../d9/de0/step__ch_8c.html#adbe0e3ba8a74f09ab928a96bd68cab6d" title="bound any prim type CALLS directly real and MPI boundary functions pstag = pstagglobal ucons = unewgl..." alt="" coords="2077,1084,2187,1113"/><area shape="rect" id="node99" href="../../d9/de0/step__ch_8c.html#a689fddc1949b1a1d390b59d10d17d83c" title="normal full bounding during evolution NOTEMARK: Was previously also bounding pstag here..." alt="" coords="2261,1442,2387,1472"/><area shape="rect" id="node103" href="../../d9/de0/step__ch_8c.html#a4079244d85c301885c1363ca41502869" title="simple bounding during evolution NOTEMARK: Was previously also bounding pstag here, but not necessary since done by calling bound_pstag in fluxctstag.c" alt="" coords="2243,1496,2405,1525"/><area shape="rect" id="node106" href="../../d9/de0/step__ch_8c.html#addca75a18cc861326a321565a2e81aa0" title="normal bounding of non&#45;staggered primitives" alt="" coords="2280,1084,2368,1113"/><area shape="rect" id="node161" href="../../d9/de0/step__ch_8c.html#a460b84e1112e3aef17209c20e22e1cf1" title="bound all prims" alt="" coords="2716,828,2839,857"/><area shape="rect" id="node108" href="../../dc/dae/flux_8c.html#aef355ccd1ca2295b84ad2fe1fc011d35" title="normal interpolation of CENT quantities to FACE quantities sets global variables pl_ct and pr_ct to p..." alt="" coords="2453,825,2632,854"/><area shape="rect" id="node120" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aecb3f613a7cb3bbb42fff2dbee5d65a1" title="This vpot2field function is for staggered method to evolve quasi&#45;deaveraged fields (i..." alt="" coords="3151,1237,3316,1266"/><area shape="rect" id="node122" href="../../de/db2/initbase_8funcdeclare_8h.html#ae6b2ad4cd0debf5b89ba8a9e471d6977" title="assumes normal field p pleft used as temp var if FLUXB==FLUXCTSTAG assigns conserved field in UEVOLVE..." alt="" coords="3392,1212,3469,1241"/><area shape="rect" id="node131" href="../../d0/dde/fluxctstag_8c.html#a4e3d76c6ad125b8199948408c262e3a1" title="wrapper for: 1) interpolate FACE 2 CORN 2) loop over dimensions setting field flux dimension&#45;by&#45;dimen..." alt="" coords="2947,1069,3077,1098"/><area shape="rect" id="node134" href="../../d0/dde/fluxctstag_8c.html#a2dd789bf1402bef72523cdb69e85806e" title="use global pbcorninterp and pvcorninterp at CORN1,2,3 to obtain EMFs at CORN1,2,3 NO interpolation of..." alt="" coords="2712,1119,2843,1166"/><area shape="rect" id="node137" href="../../d0/dde/fluxctstag_8c.html#aaec26a518629175ecceefbaf6c84225e" title="wrapper for continuous interpolation for FACE_to_CENT" alt="" coords="2456,1030,2629,1060"/><area shape="rect" id="node141" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aa31dd83c96936277334c62e2098dd51d" title="wrapper for taking staggered conserved field quantity and obtaining centered field quantity upoint en..." alt="" coords="2924,949,3100,978"/><area shape="rect" id="node150" href="../../d0/dde/fluxctstag_8c.html#a6cd90dff56319085b32bc57c0c8b3cfd" title="this function called in initbase.c and during advance() here ustag is point value if dimension doesn&#39;..." alt="" coords="2483,1084,2603,1113"/><area shape="rect" id="node153" href="../../d0/dde/fluxctstag_8c.html#ad6aa918442f7768dff3c099ba353ee64" title="slope_lim_face2corn() is provided p2interp and returns pleft/pright differs from slope_lim() by range..." alt="" coords="2472,617,2613,646"/><area shape="rect" id="node110" href="../../dc/dae/flux_8c.html#a2602a4dad9ed7adc944227d02435312e" title="standard (non&#45;field flux) calculation but setup to store results of interpolation so can be used for ..." alt="" coords="2680,774,2875,804"/><area shape="rect" id="node112" href="../../dc/dae/flux_8c.html#aaf6d832880760f80459d91477c28b519" title="wrapper for different standard 1&#45;D flux calculators 1&#45;D interpolate and get flux for that direction (..." alt="" coords="2955,773,3069,802"/><area shape="rect" id="node114" href="../../dc/dae/flux_8c.html#a8ffa7399bd5354fdcdec5f3e1adf0b13" title="wrapper for CENT_to_FACE1,2,3 used to compute flux at face" alt="" coords="3187,773,3280,802"/><area shape="rect" id="node116" href="../../d5/d2f/flux_8funcdeclare_8h.html#ab229b0f3f2caf3c0a3ef5299fba2b1c0" title="see fluxcompute.c for non&#45;computer science, real physics calculations of flux" alt="" coords="3397,773,3464,802"/><area shape="rect" id="node124" href="../../df/d15/init_8tools_8c.html#a3750bc790613bc6c8c805af0f1b839c8" title="user1_init_vpot2field_user" alt="" coords="3544,1212,3717,1241"/><area shape="rect" id="node126" href="../../de/db2/initbase_8funcdeclare_8h.html#afda44281ad5c163455c40f012d4a8954" title="init_vpot2field_user" alt="" coords="3767,1212,3900,1241"/><area shape="rect" id="node128" href="../../de/db2/initbase_8funcdeclare_8h.html#a90699a18ede8b7f112c0078512804ec1" title="initialize vector potential given user function assumes normal non&#45;staggered field in pr Notice that ..." alt="" coords="3983,1081,4052,1110"/><area shape="rect" id="node139" href="../../d0/dde/fluxctstag_8c.html#a5e3dcbe89d6f8a9384cafb58afd7dbf4" title="interpolates field at FACE to field at CENT assuming field along itself is continuous" alt="" coords="2717,999,2837,1046"/><area shape="rect" id="node145" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aaa24493002bc8c0a527b1ea2ac2dddbf" title="convert conservative U to stag point P and CENT point U and CENT point primitive" alt="" coords="3167,1133,3300,1162"/><area shape="rect" id="node155" href="../../d0/dde/fluxctstag_8c.html#a985ee116306b4011810334ae93900493" title="INPUTS: Nvec, pr, primface_l[dir], primface_r[dir] OUTPUTS: pbcorn[dir][side], pvcorn[dir][side][side..." alt="" coords="2688,617,2867,646"/><area shape="rect" id="node163" href="../../d9/de0/step__ch_8c.html#a91fe5c4370e3292a19e7f794797a407f" title="normal bounding of all primitives" alt="" coords="3967,822,4068,852"/><area shape="rect" id="node169" href="../../d9/de0/step__ch_8c.html#abdea68b778dc9253324da69d3c376965" title="bound any pstag type CALLS directly real and MPI boundary functions pstag is at FACE1,2,3 for fields, so user bound is different MPI bounding is the same as CENT quantities used when restarting in initbase.c to bound unewglobal for FLUXB==FLUXCTSTAG" alt="" coords="2484,670,2601,700"/><area shape="rect" id="node172" href="../../d9/de0/step__ch_8c.html#a6f4b963a50a7288964f01775f2f18bb9" title="normal bounding of staggered primitives" alt="" coords="2729,721,2825,750"/><area shape="rect" id="node175" href="../../d0/dde/fluxctstag_8c.html#aa169cb1999412f2e2460012cc5d7a804" title="pure DONOR version: upoint is input staggered updated field that needs to be converted to pstag and t..." alt="" coords="2924,703,3100,750"/><area shape="rect" id="node210" href="../../de/d51/bounds_8c.html#a16398a5325a9df48783423f00ba65bb7" title="all boundaries for RADCYLBEAMCART" alt="" coords="1391,769,1543,798"/><area shape="rect" id="node215" href="../../d2/d72/phys_8tools_8rad_8c.html#a69289f92f5afd222ade67c4e9c60285a" title="get contravariant relative 4&#45;velocity in lab frame" alt="" coords="659,1396,821,1425"/><area shape="rect" id="node222" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a8db9dc7c7f52d6fcb405a74e519db5cf" title="there may be something wrong with this function  didn&#39;t work in TIMEORDER==4, had to do standard met..." alt="" coords="917,102,1008,132"/><area shape="rect" id="node228" href="../../d2/d72/phys_8tools_8rad_8c.html#abd01208ba3c5754ea5587bcaefcaa01b" title="get lab&#45;frame 3&#45;velocity for radiative emission in radiative frame" alt="" coords="909,1345,1016,1374"/><area shape="rect" id="node253" href="../../d2/dd4/wavespeeds_8funcdeclare_8h.html#adba6a1e320ad60ae452a4ff6f8ba6e25" title="Charles believed that near polar axis one should set vmax=vmin=0, but not right since makes flux comp..." alt="" coords="1175,1293,1228,1322"/><area shape="rect" id="node230" href="../../d2/d72/phys_8tools_8rad_8c.html#a56f468401f08e66966f0318198ca6e85" title="compute radiative characteristics as limited by opacity" alt="" coords="1163,1346,1240,1376"/><area shape="rect" id="node232" href="../../d2/dd4/wavespeeds_8funcdeclare_8h.html#abb81988bde678c59afc5d006cf76b835" title="vchar_each" alt="" coords="1423,1348,1511,1377"/><area shape="rect" id="node234" href="../../d2/dd4/wavespeeds_8funcdeclare_8h.html#a119027341f97d571212ad74c5ddc94b4" title="get wave speeds for flux calculation and for dt calculation" alt="" coords="1664,1449,1739,1478"/><area shape="rect" id="node247" href="../../d2/dd4/wavespeeds_8funcdeclare_8h.html#a75426b1b9bf1a293c60d108c63b0322d" title="store wavespeeds somewhere" alt="" coords="1621,1345,1781,1374"/><area shape="rect" id="node240" href="../../d3/ddc/phys_8funcdeclare_8h.html#a0bb12b388b07610cf01d08c19f8fddb1" title="actually compute the flux and ctop for dt calculation" alt="" coords="1853,516,2003,545"/><area shape="rect" id="node242" href="../../dc/dae/flux_8c.html#a054658527dfb1d80226b8b2d2106aeed" title="original flux calculator that gets F in &quot;dir&quot;. At end global pleft,pright,dq also set and if STOREWAV..." alt="" coords="2071,566,2193,596"/><area shape="rect" id="node249" href="../../d2/dd4/wavespeeds_8funcdeclare_8h.html#acb4a2a3be68517862cdcf097ff51af37" title="complete storage of wave speeds per dimension only called for STOREWAVESPEEDS==1" alt="" coords="1836,776,2020,805"/><area shape="rect" id="node262" href="../../d1/d3e/utoprimgen_8c.html#a0a83e9e7fdd3cc595c5b8d0df88ec684" title="just picks the algorithm to invert" alt="" coords="456,153,576,182"/><area shape="rect" id="node269" href="../../d3/ddc/phys_8funcdeclare_8h.html#a92cd9cc63c782c0d94699d639aa48f69" title="wrapper for choosing to get state by computing it or from global array notice that ptrgeom&#45;&gt;p inputte..." alt="" coords="1399,232,1535,261"/><area shape="rect" id="node271" href="../../dc/d5e/fluxcompute_8c.html#ab088a2ff1d1132363446aab47e5c9c7b" title="P&#45;&gt;sate,flux,U." alt="" coords="1651,257,1752,286"/><area shape="rect" id="node275" href="../../dc/d5e/fluxcompute_8c.html#a9fdd8e08eb928fb500db9e2688f1475b" title="p2SFUevolveall" alt="" coords="1644,516,1759,545"/><area shape="rect" id="node281" href="../../d3/ddc/phys_8funcdeclare_8h.html#a035303dc3a9c5826bd56fdc2996fb2a3" title="wrapper for choosing to get state by computing it or from global array pointer assign (overrides the ..." alt="" coords="3365,158,3496,188"/><area shape="rect" id="node287" href="../../d3/ddc/phys_8funcdeclare_8h.html#a7c83a4e2d3fdf30054e2462d7b3a88f0" title="wrapper for choosing to get state by computing it or from global array pointer assign (overrides the ..." alt="" coords="445,1670,587,1700"/><area shape="rect" id="node289" href="../../d8/d29/interpline_8c.html#a77526a5c5b89294821d25d493f21eb57" title="determine shock indicator (used for both c2e and other routines, only operates on quantities with NPR..." alt="" coords="913,1670,1012,1700"/><area shape="rect" id="node299" href="../../d8/d29/interpline_8c.html#a86547c640e11a0b2c6666f2661ac5d6d" title="returns the improved pressure jump indicators" alt="" coords="667,1726,813,1756"/><area shape="rect" id="node291" href="../../d8/d29/interpline_8c.html#ac0108e09712d4ba63a94800f9f007ea2" title="interior of main SUPERGENLOOP() inside slope_lim_linetype_c2e()" alt="" coords="1137,1723,1265,1770"/><area shape="rect" id="node295" href="../../d8/d29/interpline_8c.html#a016b471d950e6b0dad945e9a064a506b" title="inside of SUPERGENLOOP() in slope_lim_linetype()" alt="" coords="1137,1654,1265,1700"/><area shape="rect" id="node293" href="../../d8/d29/interpline_8c.html#af01fe38edb6f0dd4a67e7bcb2db70d48" title="very similar to slope_lim_linetype, but different number of quantities to handle" alt="" coords="1388,1766,1545,1796"/><area shape="rect" id="node297" href="../../d8/d29/interpline_8c.html#aabe389c926d3f8600911f2ffa6d645e4" title="linetype assumed to return pleft/pright directly since linetype&#39;s are usually higher order this funct..." alt="" coords="1403,1662,1531,1692"/><area shape="rect" id="node301" href="../../d8/d29/interpline_8c.html#a3d874481fe13ed640058992d96cf0df1" title="interior _perijk() functions:" alt="" coords="891,1729,1035,1758"/><area shape="rect" id="node303" href="../../d8/d29/interpline_8c.html#a9614310c18cd4bc4fce55ea5964382d5" title="interior of main SUPERGENLOOP() inside slope_lim_linetype_c2e()" alt="" coords="1092,1792,1311,1839"/><area shape="rect" id="node310" href="../../d3/ddc/phys_8funcdeclare_8h.html#af560087e095f9677ac65b1bc6b424fa9" title="wrapper for choosing to get state by computing it or from global array pointer assign (overrides the ..." alt="" coords="641,1604,839,1633"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a347e39ff656263aea41c5e584700f201"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void bsq_calc_rel4vel_fromq </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>ptrgeom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>bsq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a2568131c22f54019d6ae406ef7326066"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void faraday_calc </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>which</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>geom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>faraday</em>[NDIM]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute faraday assumes b and u are inputted as bcov&amp;ucov for F^{} and bcon&amp;ucon for F_{}. </p>

<p>Definition at line <a class="el" href="../../d7/def/phys_8tools_8c_source.html#l02895">2895</a> of file <a class="el" href="../../d7/def/phys_8tools_8c_source.html">phys.tools.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_a2568131c22f54019d6ae406ef7326066_cgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_a2568131c22f54019d6ae406ef7326066_cgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_a2568131c22f54019d6ae406ef7326066_cgraph" id="d3/ddc/phys_8funcdeclare_8h_a2568131c22f54019d6ae406ef7326066_cgraph">
<area shape="rect" id="node3" href="../../d3/ddc/phys_8funcdeclare_8h.html#aea709ca8b25507c5556269e051cd42b2" title="used Mathematica&#39;s MinimumChangePermutations and Signature updown = 0 : down updown = 1 : up..." alt="" coords="151,5,188,35"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_a2568131c22f54019d6ae406ef7326066_icgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_a2568131c22f54019d6ae406ef7326066_icgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_a2568131c22f54019d6ae406ef7326066_icgraph" id="d3/ddc/phys_8funcdeclare_8h_a2568131c22f54019d6ae406ef7326066_icgraph">
<area shape="rect" id="node3" href="../../d8/d60/init_8c.html#af3b64278d50c2ff0fee80291fbd38dab" title="fieldprim" alt="" coords="151,32,220,61"/><area shape="rect" id="node5" href="../../df/d15/init_8tools_8c.html#acefd26944dbbb1c289886f520f6befac" title="init_dsandvels" alt="" coords="271,5,375,35"/><area shape="rect" id="node15" href="../../de/db2/initbase_8funcdeclare_8h.html#a4e121b9448ac1adaa7608206369f9ea5" title="init_postvpot" alt="" coords="275,59,371,88"/><area shape="rect" id="node7" href="../../df/d15/init_8tools_8c.html#a77551ab2581efdbaf170dfca073ff9ab" title="user1_init_primitives" alt="" coords="424,32,565,61"/><area shape="rect" id="node9" href="../../de/db2/initbase_8funcdeclare_8h.html#a0afa200a5f947b1c9f6e554519f28fc4" title="init_primitives" alt="" coords="615,32,716,61"/><area shape="rect" id="node11" href="../../de/df8/initbase_8c.html#ac4110398e386c9888d9565630357dbbe" title="General&#45;Primary init() routine Uses globals inside init() because sets memory and sets physics..." alt="" coords="767,32,804,61"/><area shape="rect" id="node13" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="853,32,904,61"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0bb12b388b07610cf01d08c19f8fddb1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int flux_compute_general </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>ptrgeom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td>
          <td class="paramname"><em>CUf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>p_c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>p_l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>p_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>F</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>ctopallptr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>actually compute the flux and ctop for dt calculation </p>
<p>actually compute flux from given data </p>

<p>Definition at line <a class="el" href="../../dc/d5e/fluxcompute_8c_source.html#l00025">25</a> of file <a class="el" href="../../dc/d5e/fluxcompute_8c_source.html">fluxcompute.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_a0bb12b388b07610cf01d08c19f8fddb1_cgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_a0bb12b388b07610cf01d08c19f8fddb1_cgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_a0bb12b388b07610cf01d08c19f8fddb1_cgraph" id="d3/ddc/phys_8funcdeclare_8h_a0bb12b388b07610cf01d08c19f8fddb1_cgraph">
<area shape="rect" id="node3" href="../../dc/d5e/fluxcompute_8c.html#a922e55dc88348166e53d2615941564d8" title="actually compute flux from given data GODMARK: right now if splitmaem==1 assumes F is linear in FMA a..." alt="" coords="213,61,312,91"/><area shape="rect" id="node7" href="../../dc/d5e/fluxcompute_8c.html#ab088a2ff1d1132363446aab47e5c9c7b" title="P&#45;&gt;sate,flux,U." alt="" coords="212,219,313,248"/><area shape="rect" id="node62" href="../../dc/d5e/fluxcompute_8c.html#a9fdd8e08eb928fb500db9e2688f1475b" title="p2SFUevolveall" alt="" coords="205,272,320,301"/><area shape="rect" id="node66" href="../../de/db6/wavespeeds_8c.html#a269fca52bf4745f3742456843cd0c4ca" title="get wave speeds for flux calculation" alt="" coords="203,140,323,169"/><area shape="rect" id="node5" href="../../de/db6/wavespeeds_8c.html#a7fa9b1c8202eb413cf4a926eebec66dc" title="really HARM is currently using VERY local lax Friedrich." alt="" coords="385,36,492,65"/><area shape="rect" id="node9" href="../../de/d8c/phys_8c.html#a92cd9cc63c782c0d94699d639aa48f69" title="wrapper for choosing to get state by computing it or from global array notice that ptrgeom&#45;&gt;p inputte..." alt="" coords="371,244,507,273"/><area shape="rect" id="node23" href="../../d3/ddc/phys_8funcdeclare_8h.html#a19e08c0d7e5a7c9fb9d97ff5ffab053c" title="Calculate fluxes in direction dir and conserved variable U returntype==0 : flux with geometric factor..." alt="" coords="400,323,477,352"/><area shape="rect" id="node11" href="../../d7/def/phys_8tools_8c.html#adf1cf36a7c564b77dca08d26ce233df7" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="1143,244,1303,273"/><area shape="rect" id="node13" href="../../d3/ddc/phys_8funcdeclare_8h.html#a12a473e24b431762af4168179e82cd08" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="1371,137,1533,167"/><area shape="rect" id="node15" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a8a762bf6582e6f7e1199de9c43b98454" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="1353,191,1551,220"/><area shape="rect" id="node17" href="../../d3/ddc/phys_8funcdeclare_8h.html#a41b8eacac0a4a23d6b00b670fe49629c" title="bsq_calc_fromq" alt="" coords="1395,244,1509,273"/><area shape="rect" id="node19" href="../../d7/def/phys_8tools_8c.html#a8db4cb0eaaedfc1b0f3d5791d5052068" title="separate function for getting primitives" alt="" coords="1395,351,1509,380"/><area shape="rect" id="node21" href="../../d7/def/phys_8tools_8c.html#ab23ee4012c46b45e96ebffcf5766b0bb" title="separate function for getting geometry" alt="" coords="1395,297,1509,327"/><area shape="rect" id="node25" href="../../d7/def/phys_8tools_8c.html#ace478826bef11e98daed7dd2ab026c93" title="matter only terms (as if B=0)" alt="" coords="555,561,659,591"/><area shape="rect" id="node45" href="../../d7/def/phys_8tools_8c.html#a3c8277899afc2a48590156971490bb79" title="radiation terms (as if rho=u=p=0)" alt="" coords="555,401,659,431"/><area shape="rect" id="node50" href="../../d7/def/phys_8tools_8c.html#a664550c21e363870d26e73f3ab5b3d3c" title="electromagnetic terms (as if rho=u=p=0)" alt="" coords="555,323,659,352"/><area shape="rect" id="node27" href="../../d7/def/phys_8tools_8c.html#a133cabc36f68eda16f9245f749c3cc38" title="flux asociated with Ynu variable" alt="" coords="740,665,833,695"/><area shape="rect" id="node29" href="../../d7/def/phys_8tools_8c.html#a787551c0e83438fe9e63ecd3d996f61a" title="massflux_calc" alt="" coords="951,665,1057,695"/><area shape="rect" id="node31" href="../../d7/def/phys_8tools_8c.html#a2ef51d65728fe59168e5b705165af6d4" title="flux associated with Y_L variable" alt="" coords="745,719,828,748"/><area shape="rect" id="node34" href="../../d7/def/phys_8tools_8c.html#a1e1dcf1d515232206c829a33d7e1192b" title="flux associated with Y_fl variable" alt="" coords="743,455,831,484"/><area shape="rect" id="node37" href="../../d7/def/phys_8tools_8c.html#a5717fa95303172fb697892a9232f0546" title="flux of specific entropy" alt="" coords="728,561,845,591"/><area shape="rect" id="node39" href="../../d7/def/phys_8tools_8c.html#a4886704a6724ea65ccaae2277b6ded74" title="MHD stress tensor, with first index up, second index down mhd^dir_j understood that mhddiagpress only..." alt="" coords="736,508,837,537"/><area shape="rect" id="node41" href="../../d7/def/phys_8tools_8c.html#ab3fd971df8ad09cce2462e78d7735f33" title="MHD stress tensor, with first index up, second index down." alt="" coords="945,481,1063,511"/><area shape="rect" id="node43" href="../../d7/def/phys_8tools_8c.html#a44930b5d598885afcb717a270f42749f" title="MHD stress tensor, with first index up, second index down avoids catastrophic cancellation with rest&#45;..." alt="" coords="915,535,1093,564"/><area shape="rect" id="node48" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a389bf7e41d2fd117af996e3392067cdc" title="compute radiation stres&#45;energy tensor assuming M1 closure" alt="" coords="736,401,837,431"/><area shape="rect" id="node52" href="../../d7/def/phys_8tools_8c.html#a3552b97ec9f1982094fbc3e3f9af7f05" title="MHD stress tensor, with first index up, second index down mhd^dir_j." alt="" coords="736,348,837,377"/><area shape="rect" id="node58" href="../../d7/def/phys_8tools_8c.html#a12b4ca77ffbef030f608b079327b4eb7" title="spatial part of dualfaraday" alt="" coords="708,295,865,324"/><area shape="rect" id="node54" href="../../d7/def/phys_8tools_8c.html#a3f6e052b84282b8db7b05a0acc435622" title="EM part of stress&#45;energy tensor." alt="" coords="945,348,1063,377"/><area shape="rect" id="node56" href="../../d7/def/phys_8tools_8c.html#a864ca09eade159d4c4b545593c1095de" title="MHD stress tensor, with first index up, second index down avoids catastrophic cancellation with rest&#45;..." alt="" coords="925,401,1083,431"/><area shape="rect" id="node60" href="../../d7/def/phys_8tools_8c.html#abc846df49f33c007310b52240e099e3b" title="Notation for HARM paper and JCM&#39;s GRFFE paper is that: B^ = &#160;*F^{} and for lab&#45;frame we chose ={&#45;1..." alt="" coords="936,295,1072,324"/><area shape="rect" id="node69" href="../../de/db6/wavespeeds_8c.html#add5696e20b7235a8f870dd0dffb8dc7d" title="vchar_each" alt="" coords="395,140,483,169"/><area shape="rect" id="node71" href="../../d8/d20/vchar_8c.html#acdcca98ca82b041999cdb29fdf958a22" title="Charles believed that near polar axis one should set vmax=vmin=0, but not right since makes flux comp..." alt="" coords="580,87,633,116"/><area shape="rect" id="node75" href="../../d3/ddc/phys_8funcdeclare_8h.html#a11e17cd8b0594d1ad52e3594aa9f477e" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="1185,191,1260,220"/><area shape="rect" id="node80" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a2f3df15638b9795556ef2bdf1e8c8f97" title="compute radiative characteristics as limited by opacity" alt="" coords="568,140,645,169"/><area shape="rect" id="node73" href="../../d8/d20/vchar_8c.html#acad033b60e7ca6404ffcd9b0fdfd13b4" title="simplefast" alt="" coords="963,87,1045,116"/><area shape="rect" id="node82" href="../../d2/d72/phys_8tools_8rad_8c.html#a63256be4e6a63216cb736012e36a6375" title="calc_chi" alt="" coords="752,33,821,63"/><area shape="rect" id="node84" href="../../d2/d72/phys_8tools_8rad_8c.html#a795959353203e99366b456b16d0d0bab" title="calculates total opacity over dx[] for given chi or chieff" alt="" coords="724,87,849,116"/><area shape="rect" id="node86" href="../../d2/d72/phys_8tools_8rad_8c.html#abd01208ba3c5754ea5587bcaefcaa01b" title="get lab&#45;frame 3&#45;velocity for radiative emission in radiative frame" alt="" coords="733,140,840,169"/><area shape="rect" id="node89" href="../../d9/de9/coord_8c.html#a0672d8c0ee4ff07c7265d0ecbc365cdc" title="normally&#45;used dxdxp[i,j,k] = dV/dX" alt="" coords="957,140,1051,169"/><area shape="rect" id="node91" href="../../d9/de9/coord_8c.html#a64a4372100fc55abf546f02c8b779595" title="Jacobian for dx uniform per dx nonuniform (dx/dr / dx/dr&#39;) i.e." alt="" coords="1185,111,1260,140"/><area shape="rect" id="node93" href="../../d9/de9/coord_8c.html#a56c4b5c03b74a33a7d809daecfa6925e" title="numerical derivative of V w.r.t. X" alt="" coords="1392,84,1512,113"/><area shape="rect" id="node95" href="../../d9/de9/coord_8c.html#a65ad4ca9656d141cc995fd35ed31dc40" title="Returns boyer&#45;lindquist coordinte of point." alt="" coords="1601,84,1671,113"/><area shape="rect" id="node97" href="../../d8/d60/init_8c.html#a27c01fe4532cf3e10d467517403dbf70" title="blcoord_user" alt="" coords="1733,57,1829,87"/><area shape="rect" id="node99" href="../../d9/de9/coord_8c.html#af7a086e6042d598aea95c2360d07a99b" title="blcoord_singfixes" alt="" coords="1720,111,1843,140"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_a0bb12b388b07610cf01d08c19f8fddb1_icgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_a0bb12b388b07610cf01d08c19f8fddb1_icgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_a0bb12b388b07610cf01d08c19f8fddb1_icgraph" id="d3/ddc/phys_8funcdeclare_8h_a0bb12b388b07610cf01d08c19f8fddb1_icgraph">
<area shape="rect" id="node3" href="../../dc/dae/flux_8c.html#a054658527dfb1d80226b8b2d2106aeed" title="original flux calculator that gets F in &quot;dir&quot;. At end global pleft,pright,dq also set and if STOREWAV..." alt="" coords="239,5,361,35"/><area shape="rect" id="node25" href="../../dc/dae/flux_8c.html#a2602a4dad9ed7adc944227d02435312e" title="standard (non&#45;field flux) calculation but setup to store results of interpolation so can be used for ..." alt="" coords="203,59,397,88"/><area shape="rect" id="node28" href="../../dc/dae/flux_8c.html#aa26f8747446e1cd5bd214ebc345aafa2" title="compute donor&#45;based flux, bypassing normal fluxcalc()." alt="" coords="451,111,557,140"/><area shape="rect" id="node5" href="../../dc/dae/flux_8c.html#aaf6d832880760f80459d91477c28b519" title="wrapper for different standard 1&#45;D flux calculators 1&#45;D interpolate and get flux for that direction (..." alt="" coords="447,57,561,87"/><area shape="rect" id="node7" href="../../dc/dae/flux_8c.html#a8ffa7399bd5354fdcdec5f3e1adf0b13" title="wrapper for CENT_to_FACE1,2,3 used to compute flux at face" alt="" coords="612,57,705,87"/><area shape="rect" id="node9" href="../../d5/d2f/flux_8funcdeclare_8h.html#ab229b0f3f2caf3c0a3ef5299fba2b1c0" title="see fluxcompute.c for non&#45;computer science, real physics calculations of flux" alt="" coords="755,57,821,87"/><area shape="rect" id="node11" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="884,57,1012,87"/><area shape="rect" id="node23" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="871,111,1025,140"/><area shape="rect" id="node13" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="1076,57,1145,87"/><area shape="rect" id="node15" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="1196,57,1329,87"/><area shape="rect" id="node17" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="1380,57,1447,87"/><area shape="rect" id="node19" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="1497,57,1588,87"/><area shape="rect" id="node21" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="1637,57,1688,87"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="abfae38e47b0bd05a4fc38302ff948a96"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gamma_calc_fromuconrel </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>uconrel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>geom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>gamma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>qsq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>find gamma-factor wrt normal observer This function and qsq_calc() have about the same cache miss amount now </p>

<p>Definition at line <a class="el" href="../../d7/def/phys_8tools_8c_source.html#l02473">2473</a> of file <a class="el" href="../../d7/def/phys_8tools_8c_source.html">phys.tools.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_abfae38e47b0bd05a4fc38302ff948a96_icgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_abfae38e47b0bd05a4fc38302ff948a96_icgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_abfae38e47b0bd05a4fc38302ff948a96_icgraph" id="d3/ddc/phys_8funcdeclare_8h_abfae38e47b0bd05a4fc38302ff948a96_icgraph">
<area shape="rect" id="node3" href="../../d7/def/phys_8tools_8c.html#a20be479a3f03f3de780359d6e9290fe3" title="find u^ from {u}^ fill full 4&#45;vector OPTMARK: Before storing , this was the most expensive function o..." alt="" coords="225,707,425,736"/><area shape="rect" id="node181" href="../../d2/d72/phys_8tools_8rad_8c.html#aa8edd5fc0afc1713ad401c2db92c71e0" title="set velocity based upon ncon and gammamax and return in whichvel format for the ptrgeom geometry/coor..." alt="" coords="896,785,1021,815"/><area shape="rect" id="node183" href="../../d2/d72/phys_8tools_8rad_8c.html#a67b370af2fa58283bc590ff4e895fb90" title="Like u2p_rad_orig(), but uses Jon&#39;s paper draft ZAMO RAD version." alt="" coords="276,653,375,683"/><area shape="rect" id="node202" href="../../d2/d72/phys_8tools_8rad_8c.html#a4c389f16ba2ced5143cb408ea6a39459" title="interpolate between optically thick and thin limits when no u2p_rad() inversion solution" alt="" coords="256,810,395,857"/><area shape="rect" id="node206" href="../../d2/d72/phys_8tools_8rad_8c.html#a56eedd5db3838b564acfd63644b07c2a" title="get contravariant relative 4&#45;velocity in lab frame using Olek&#39;s koral choices" alt="" coords="228,880,423,909"/><area shape="rect" id="node5" href="../../d7/def/phys_8tools_8c.html#a7aadb359813194586356c2c325322a45" title="find contravariant four&#45;velocity from the relative 4 velocity" alt="" coords="495,707,620,736"/><area shape="rect" id="node7" href="../../d7/def/phys_8tools_8c.html#a35c4399eb86e3fa77e2221000e077572" title="ucon_calc_whichvel" alt="" coords="688,707,827,736"/><area shape="rect" id="node9" href="../../d8/d60/init_8c.html#ab0bfdee8d9b31f16dbadd2a5108ad29b" title="donut_analytical_solution" alt="" coords="875,732,1043,761"/><area shape="rect" id="node29" href="../../d2/d72/phys_8tools_8rad_8c.html#a2ec6ee79c76351868a725b22dac62135" title="like prad_fforlab() but for only whichdir=FF2LAB used for IC" alt="" coords="913,628,1004,657"/><area shape="rect" id="node172" href="../../d2/d72/phys_8tools_8rad_8c.html#aa25aa4dfb3559619f276abca5f4b3ca0" title="for BCs, to take E[radiation frame] and u^i as radiation primitives in whichvel/whichcoord obtains WH..." alt="" coords="1296,670,1435,717"/><area shape="rect" id="node11" href="../../d8/d60/init_8c.html#a83e7f10ffd348c4d18b3245dd4bab585" title="make_nonrt2rt_solution" alt="" coords="1091,816,1248,845"/><area shape="rect" id="node13" href="../../d8/d60/init_8c.html#a73009fd6280963c265e2cf5d1c353e8d" title="get_full_rtsolution" alt="" coords="1304,843,1427,872"/><area shape="rect" id="node15" href="../../d8/d60/init_8c.html#af94364e17d67cddfbb7bb3bf39c05ee6" title="init_dsandvels_koral" alt="" coords="1529,904,1668,933"/><area shape="rect" id="node27" href="../../d8/d60/init_8c.html#a448cd3fd9a1d862485e7b6e67b965172" title="process_restart_toget\l_radiation" alt="" coords="1525,834,1672,881"/><area shape="rect" id="node17" href="../../df/d15/init_8tools_8c.html#acefd26944dbbb1c289886f520f6befac" title="init_dsandvels" alt="" coords="4072,643,4176,672"/><area shape="rect" id="node19" href="../../df/d15/init_8tools_8c.html#a77551ab2581efdbaf170dfca073ff9ab" title="user1_init_primitives" alt="" coords="4424,679,4565,708"/><area shape="rect" id="node21" href="../../de/db2/initbase_8funcdeclare_8h.html#a0afa200a5f947b1c9f6e554519f28fc4" title="init_primitives" alt="" coords="4615,643,4716,672"/><area shape="rect" id="node23" href="../../de/df8/initbase_8c.html#ac4110398e386c9888d9565630357dbbe" title="General&#45;Primary init() routine Uses globals inside init() because sets memory and sets physics..." alt="" coords="4793,571,4831,600"/><area shape="rect" id="node25" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="4907,473,4957,503"/><area shape="rect" id="node31" href="../../d2/d72/phys_8tools_8rad_8c.html#af50896d039d660550b738862b3390b07" title="radiative ortonormal ff primitives (E,F^i) &lt;&#45;&gt; primitives in lab frame Used only for initial conditio..." alt="" coords="1124,736,1215,765"/><area shape="rect" id="node35" href="../../d2/d72/phys_8tools_8rad_8c.html#a64226cb28f52020ffe18ac6c6b1a2f5c" title="Input: start with pin [with fluid in whichvel velocity and whichcoordfluid coordinates (PRIMECOORDS o..." alt="" coords="1300,458,1431,505"/><area shape="rect" id="node37" href="../../de/d51/bounds_8c.html#a3bc773d499b145705bdc23125b963840" title="Koral specific physical boundary conditions." alt="" coords="1499,571,1699,600"/><area shape="rect" id="node137" href="../../de/d51/bounds_8c.html#a09a080d9895db7b800a3824cb3fac9f1" title="X1 lower for beam injection to create shadow." alt="" coords="1519,624,1679,653"/><area shape="rect" id="node140" href="../../de/d51/bounds_8c.html#a3ee134cc5fb18752265c16a20dbdfb63" title="X3 lower for radiation beam injection." alt="" coords="1501,677,1696,707"/><area shape="rect" id="node143" href="../../de/d51/bounds_8c.html#a8300ddf3ae6a3866234cc0e9c12f26dc" title="X1 upper for inflow." alt="" coords="1763,524,1949,553"/><area shape="rect" id="node146" href="../../de/d51/bounds_8c.html#a01088f65c7a4cfa2ebfed202f815b951" title="X1 lower and upper for RADATM." alt="" coords="1771,153,1941,183"/><area shape="rect" id="node149" href="../../de/d51/bounds_8c.html#a1382959a7b699ea5d224168612504263" title="X1 upper for inflow." alt="" coords="1783,207,1929,236"/><area shape="rect" id="node152" href="../../de/d51/bounds_8c.html#ac15824bc610943cb7e02112e77b94752" title="on&#45;grid bounding" alt="" coords="1807,260,1905,289"/><area shape="rect" id="node155" href="../../de/d51/bounds_8c.html#a42658c4ecf3c6edb958394eb65a9ac2b" title="RADNT." alt="" coords="1809,313,1903,343"/><area shape="rect" id="node158" href="../../de/d51/bounds_8c.html#a3e4008fd24427b2e91d0ae5882b9536a" title="X1 upper for RADCYLBEAM." alt="" coords="1773,367,1939,396"/><area shape="rect" id="node161" href="../../de/d51/bounds_8c.html#ac32c1a20138382904dc5f1c66778ad8b" title="X1 upper for RADCYLJET." alt="" coords="1525,413,1672,443"/><area shape="rect" id="node164" href="../../de/d51/bounds_8c.html#a635fbaba3d6d6afcf5f34bbb2c278737" title="X2 upper for radiation beam injection." alt="" coords="1484,731,1713,760"/><area shape="rect" id="node167" href="../../de/d51/bounds_8c.html#a9f1df4e461f3f776bf3cb80e36a4d6df" title="get_radcylbeamcart" alt="" coords="1531,467,1667,496"/><area shape="rect" id="node39" href="../../de/d51/bounds_8c.html#a34ac3f1ca7b0f3a21053c633da9931a9" title="user boundary routine" alt="" coords="1997,471,2168,500"/><area shape="rect" id="node41" href="../../d4/dad/bounds_8funcdeclare_8h.html#a4bc7413b2cdb89e070f38bbb689ae555" title="bound_prim_user_dir" alt="" coords="2220,451,2361,480"/><area shape="rect" id="node126" href="../../d4/dad/bounds_8funcdeclare_8h.html#a2fbddc9ff8fc706bafa80c39695c7262" title="assume single user function takes care of primitive locations" alt="" coords="2216,632,2365,661"/><area shape="rect" id="node43" href="../../d9/de0/step__ch_8c.html#adbe0e3ba8a74f09ab928a96bd68cab6d" title="bound any prim type CALLS directly real and MPI boundary functions pstag = pstagglobal ucons = unewgl..." alt="" coords="2415,441,2524,471"/><area shape="rect" id="node45" href="../../d9/de0/step__ch_8c.html#a689fddc1949b1a1d390b59d10d17d83c" title="normal full bounding during evolution NOTEMARK: Was previously also bounding pstag here..." alt="" coords="2592,59,2717,88"/><area shape="rect" id="node57" href="../../d9/de0/step__ch_8c.html#a4079244d85c301885c1363ca41502869" title="simple bounding during evolution NOTEMARK: Was previously also bounding pstag here, but not necessary since done by calling bound_pstag in fluxctstag.c" alt="" coords="2573,5,2736,35"/><area shape="rect" id="node60" href="../../d9/de0/step__ch_8c.html#addca75a18cc861326a321565a2e81aa0" title="normal bounding of non&#45;staggered primitives" alt="" coords="2611,441,2699,471"/><area shape="rect" id="node120" href="../../d9/de0/step__ch_8c.html#a460b84e1112e3aef17209c20e22e1cf1" title="bound all prims" alt="" coords="3047,859,3169,888"/><area shape="rect" id="node47" href="../../d9/de0/step__ch_8c.html#ad36a0f9f915547477e3bb2405f8166b9" title="things to do after advance()" alt="" coords="2823,8,2924,37"/><area shape="rect" id="node49" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="4241,116,4375,145"/><area shape="rect" id="node51" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="4632,356,4699,385"/><area shape="rect" id="node53" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="4767,375,4857,404"/><area shape="rect" id="node62" href="../../dc/dae/flux_8c.html#aef355ccd1ca2295b84ad2fe1fc011d35" title="normal interpolation of CENT quantities to FACE quantities sets global variables pl_ct and pr_ct to p..." alt="" coords="2784,163,2963,192"/><area shape="rect" id="node79" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aecb3f613a7cb3bbb42fff2dbee5d65a1" title="This vpot2field function is for staggered method to evolve quasi&#45;deaveraged fields (i..." alt="" coords="3481,592,3647,621"/><area shape="rect" id="node81" href="../../de/db2/initbase_8funcdeclare_8h.html#ae6b2ad4cd0debf5b89ba8a9e471d6977" title="assumes normal field p pleft used as temp var if FLUXB==FLUXCTSTAG assigns conserved field in UEVOLVE..." alt="" coords="3703,644,3780,673"/><area shape="rect" id="node90" href="../../d0/dde/fluxctstag_8c.html#a4e3d76c6ad125b8199948408c262e3a1" title="wrapper for: 1) interpolate FACE 2 CORN 2) loop over dimensions setting field flux dimension&#45;by&#45;dimen..." alt="" coords="3277,255,3408,284"/><area shape="rect" id="node93" href="../../d0/dde/fluxctstag_8c.html#a2dd789bf1402bef72523cdb69e85806e" title="use global pbcorninterp and pvcorninterp at CORN1,2,3 to obtain EMFs at CORN1,2,3 NO interpolation of..." alt="" coords="2808,319,2939,366"/><area shape="rect" id="node96" href="../../d0/dde/fluxctstag_8c.html#aaec26a518629175ecceefbaf6c84225e" title="wrapper for continuous interpolation for FACE_to_CENT" alt="" coords="2787,389,2960,419"/><area shape="rect" id="node100" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aa31dd83c96936277334c62e2098dd51d" title="wrapper for taking staggered conserved field quantity and obtaining centered field quantity upoint en..." alt="" coords="3255,439,3431,468"/><area shape="rect" id="node109" href="../../d0/dde/fluxctstag_8c.html#a6cd90dff56319085b32bc57c0c8b3cfd" title="this function called in initbase.c and during advance() here ustag is point value if dimension doesn&#39;..." alt="" coords="3048,491,3168,520"/><area shape="rect" id="node112" href="../../d0/dde/fluxctstag_8c.html#ad6aa918442f7768dff3c099ba353ee64" title="slope_lim_face2corn() is provided p2interp and returns pleft/pright differs from slope_lim() by range..." alt="" coords="2803,216,2944,245"/><area shape="rect" id="node64" href="../../dc/dae/flux_8c.html#a2602a4dad9ed7adc944227d02435312e" title="standard (non&#45;field flux) calculation but setup to store results of interpolation so can be used for ..." alt="" coords="3011,163,3205,192"/><area shape="rect" id="node66" href="../../dc/dae/flux_8c.html#aaf6d832880760f80459d91477c28b519" title="wrapper for different standard 1&#45;D flux calculators 1&#45;D interpolate and get flux for that direction (..." alt="" coords="3285,151,3400,180"/><area shape="rect" id="node68" href="../../dc/dae/flux_8c.html#a8ffa7399bd5354fdcdec5f3e1adf0b13" title="wrapper for CENT_to_FACE1,2,3 used to compute flux at face" alt="" coords="3517,125,3611,155"/><area shape="rect" id="node70" href="../../d5/d2f/flux_8funcdeclare_8h.html#ab229b0f3f2caf3c0a3ef5299fba2b1c0" title="see fluxcompute.c for non&#45;computer science, real physics calculations of flux" alt="" coords="3708,201,3775,231"/><area shape="rect" id="node72" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="3857,233,3985,263"/><area shape="rect" id="node77" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="3844,371,3999,400"/><area shape="rect" id="node74" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="4089,172,4159,201"/><area shape="rect" id="node83" href="../../df/d15/init_8tools_8c.html#a3750bc790613bc6c8c805af0f1b839c8" title="user1_init_vpot2field_user" alt="" coords="3835,644,4008,673"/><area shape="rect" id="node85" href="../../de/db2/initbase_8funcdeclare_8h.html#afda44281ad5c163455c40f012d4a8954" title="init_vpot2field_user" alt="" coords="4057,696,4191,725"/><area shape="rect" id="node87" href="../../de/db2/initbase_8funcdeclare_8h.html#a90699a18ede8b7f112c0078512804ec1" title="initialize vector potential given user function assumes normal non&#45;staggered field in pr Notice that ..." alt="" coords="4273,696,4343,725"/><area shape="rect" id="node98" href="../../d0/dde/fluxctstag_8c.html#a5e3dcbe89d6f8a9384cafb58afd7dbf4" title="interpolates field at FACE to field at CENT assuming field along itself is continuous" alt="" coords="3048,370,3168,417"/><area shape="rect" id="node104" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aaa24493002bc8c0a527b1ea2ac2dddbf" title="convert conservative U to stag point P and CENT point U and CENT point primitive" alt="" coords="3497,488,3631,517"/><area shape="rect" id="node114" href="../../d0/dde/fluxctstag_8c.html#a985ee116306b4011810334ae93900493" title="INPUTS: Nvec, pr, primface_l[dir], primface_r[dir] OUTPUTS: pbcorn[dir][side], pvcorn[dir][side][side..." alt="" coords="3019,216,3197,245"/><area shape="rect" id="node122" href="../../d9/de0/step__ch_8c.html#a91fe5c4370e3292a19e7f794797a407f" title="normal bounding of all primitives" alt="" coords="4257,864,4359,893"/><area shape="rect" id="node128" href="../../d9/de0/step__ch_8c.html#abdea68b778dc9253324da69d3c376965" title="bound any pstag type CALLS directly real and MPI boundary functions pstag is at FACE1,2,3 for fields, so user bound is different MPI bounding is the same as CENT quantities used when restarting in initbase.c to bound unewglobal for FLUXB==FLUXCTSTAG" alt="" coords="2815,857,2932,887"/><area shape="rect" id="node131" href="../../d9/de0/step__ch_8c.html#a6f4b963a50a7288964f01775f2f18bb9" title="normal bounding of staggered primitives" alt="" coords="3060,755,3156,784"/><area shape="rect" id="node134" href="../../d0/dde/fluxctstag_8c.html#aa169cb1999412f2e2460012cc5d7a804" title="pure DONOR version: upoint is input staggered updated field that needs to be converted to pstag and t..." alt="" coords="3255,746,3431,793"/><area shape="rect" id="node169" href="../../de/d51/bounds_8c.html#a16398a5325a9df48783423f00ba65bb7" title="all boundaries for RADCYLBEAMCART" alt="" coords="1780,471,1932,500"/><area shape="rect" id="node177" href="../../de/d51/bounds_8c.html#a3a96629ab9e350154c992f8a4ce92cbe" title="X1 lower and upper X2." alt="" coords="1787,781,1925,811"/><area shape="rect" id="node185" href="../../d2/d72/phys_8tools_8rad_8c.html#aca8e86da8eb620a3a3e3487b420df3e1" title="u2p_rad" alt="" coords="724,628,791,657"/><area shape="rect" id="node188" href="../../d1/d3e/utoprimgen_8c.html#a0a83e9e7fdd3cc595c5b8d0df88ec684" title="just picks the algorithm to invert" alt="" coords="1796,100,1916,129"/><area shape="rect" id="node190" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a7e078cc9a354495bc85554d875a705d9" title="General explicit inversion of U[MHD]&#45;&gt;P[MHD] and also inverts scalars. Inverts radiation if(EOMRADTYP..." alt="" coords="3697,331,3785,360"/><area shape="rect" id="node194" href="../../d8/d60/init_8c.html#af3b64278d50c2ff0fee80291fbd38dab" title="fieldprim" alt="" coords="3887,591,3956,620"/><area shape="rect" id="node200" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a8db9dc7c7f52d6fcb405a74e519db5cf" title="there may be something wrong with this function  didn&#39;t work in TIMEORDER==4, had to do standard met..." alt="" coords="3876,317,3967,347"/><area shape="rect" id="node197" href="../../de/db2/initbase_8funcdeclare_8h.html#a4e121b9448ac1adaa7608206369f9ea5" title="init_postvpot" alt="" coords="4260,591,4356,620"/><area shape="rect" id="node204" href="../../d2/d72/phys_8tools_8rad_8c.html#a69289f92f5afd222ade67c4e9c60285a" title="get contravariant relative 4&#45;velocity in lab frame" alt="" coords="476,819,639,848"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aabc0a0c6e5daa8b0e10d4115b44b5f61"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void get_allgeometry </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../dd/d56/structof__allgeom.html">of_allgeom</a> *&#160;</td>
          <td class="paramname"><em>allgeom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>geom</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/d8c/phys_8c_source.html#l00422">422</a> of file <a class="el" href="../../de/d8c/phys_8c_source.html">phys.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_aabc0a0c6e5daa8b0e10d4115b44b5f61_cgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_aabc0a0c6e5daa8b0e10d4115b44b5f61_cgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_aabc0a0c6e5daa8b0e10d4115b44b5f61_cgraph" id="d3/ddc/phys_8funcdeclare_8h_aabc0a0c6e5daa8b0e10d4115b44b5f61_cgraph">
<area shape="rect" id="node3" href="../../d9/de9/coord_8c.html#a1e1d4fd69f1234cb8751c4ea66297995" title="normally&#45;used bl_coord[i,j,k] {i,j,k} &#45;&gt; X only" alt="" coords="179,5,253,35"/><area shape="rect" id="node7" href="../../d9/de9/coord_8c.html#a96290375e27d5d0aa4d843b07e228e14" title="normally&#45;used bl_coord[i,j,k] {i,j,k} &#45;&gt; V only" alt="" coords="171,59,261,88"/><area shape="rect" id="node16" href="../../d9/de9/coord_8c.html#a0672d8c0ee4ff07c7265d0ecbc365cdc" title="normally&#45;used dxdxp[i,j,k] = dV/dX" alt="" coords="169,112,263,141"/><area shape="rect" id="node5" href="../../d9/de9/coord_8c.html#a041e7b005310415c97d90f4b8521ed1a" title="get X(i,j,k) CENT is default position in degenerate cases" alt="" coords="323,7,376,36"/><area shape="rect" id="node10" href="../../d9/de9/coord_8c.html#a65ad4ca9656d141cc995fd35ed31dc40" title="Returns boyer&#45;lindquist coordinte of point." alt="" coords="604,87,673,116"/><area shape="rect" id="node12" href="../../d8/d60/init_8c.html#a27c01fe4532cf3e10d467517403dbf70" title="blcoord_user" alt="" coords="736,60,832,89"/><area shape="rect" id="node14" href="../../d9/de9/coord_8c.html#af7a086e6042d598aea95c2360d07a99b" title="blcoord_singfixes" alt="" coords="723,113,845,143"/><area shape="rect" id="node18" href="../../d9/de9/coord_8c.html#a64a4372100fc55abf546f02c8b779595" title="Jacobian for dx uniform per dx nonuniform (dx/dr / dx/dr&#39;) i.e." alt="" coords="312,112,387,141"/><area shape="rect" id="node20" href="../../d9/de9/coord_8c.html#a56c4b5c03b74a33a7d809daecfa6925e" title="numerical derivative of V w.r.t. X" alt="" coords="435,112,555,141"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a11e17cd8b0594d1ad52e3594aa9f477e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_state </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>geom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *&#160;</td>
          <td class="paramname"><em>q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function expect to get q-&gt;{ucon,ucov,bcon,bcov,pressure} </p>

<p>Definition at line <a class="el" href="../../d7/def/phys_8tools_8c_source.html#l01861">1861</a> of file <a class="el" href="../../d7/def/phys_8tools_8c_source.html">phys.tools.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_a11e17cd8b0594d1ad52e3594aa9f477e_cgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_a11e17cd8b0594d1ad52e3594aa9f477e_cgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_a11e17cd8b0594d1ad52e3594aa9f477e_cgraph" id="d3/ddc/phys_8funcdeclare_8h_a11e17cd8b0594d1ad52e3594aa9f477e_cgraph">
<area shape="rect" id="node3" href="../../d3/ddc/phys_8funcdeclare_8h.html#a12a473e24b431762af4168179e82cd08" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="149,5,312,35"/><area shape="rect" id="node5" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a8a762bf6582e6f7e1199de9c43b98454" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="132,59,329,88"/><area shape="rect" id="node7" href="../../d3/ddc/phys_8funcdeclare_8h.html#a41b8eacac0a4a23d6b00b670fe49629c" title="bsq_calc_fromq" alt="" coords="173,112,288,141"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_a11e17cd8b0594d1ad52e3594aa9f477e_icgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_a11e17cd8b0594d1ad52e3594aa9f477e_icgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_a11e17cd8b0594d1ad52e3594aa9f477e_icgraph" id="d3/ddc/phys_8funcdeclare_8h_a11e17cd8b0594d1ad52e3594aa9f477e_icgraph">
<area shape="rect" id="node3" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="3169,1092,3297,1121"/><area shape="rect" id="node15" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="3156,987,3311,1016"/><area shape="rect" id="node17" href="../../df/d22/advance_8c.html#a0936d88b132d9655aa9287035a4793c5" title="If density or gamma&#45;factors are different by more than fractional_difference_threshold for states pin..." alt="" coords="136,1507,277,1536"/><area shape="rect" id="node19" href="../../d5/de3/phys_8tools_8funcdeclare_8h.html#ac9512f95a18d4a189ac642d138f95051" title="2D only for now since really only useful for 2D imaging map out region around failure point OPENMPNOT..." alt="" coords="2143,1360,2220,1389"/><area shape="rect" id="node30" href="../../d6/db2/diag_8funcdeclare_8h.html#a53324e6dbf9729772e70f0a053468ae6" title="set var to be averaged in time" alt="" coords="2133,1307,2229,1336"/><area shape="rect" id="node35" href="../../dc/dae/flux_8c.html#aa26f8747446e1cd5bd214ebc345aafa2" title="compute donor&#45;based flux, bypassing normal fluxcalc()." alt="" coords="2367,997,2473,1027"/><area shape="rect" id="node38" href="../../d8/d60/init_8c.html#af3b64278d50c2ff0fee80291fbd38dab" title="fieldprim" alt="" coords="3199,261,3268,291"/><area shape="rect" id="node52" href="../../d7/def/phys_8tools_8c.html#aedc30b56b48db47c3622b2d6c55161d9" title="returns b^2 (i.e., twice magnetic pressure)" alt="" coords="145,1560,268,1589"/><area shape="rect" id="node54" href="../../d2/d72/phys_8tools_8rad_8c.html#af46d2b1cf89a70a7e2ef503146c649a9" title="uu0 &#45; original cons." alt="" coords="376,1225,451,1255"/><area shape="rect" id="node56" href="../../d2/d72/phys_8tools_8rad_8c.html#a17aede36203a236390363af78d3a86f0" title="compute changes to U (both T and R) using implicit method KORALTODO: If doing implicit, should also add geometry source term that can sometimes be stiff." alt="" coords="753,1199,961,1228"/><area shape="rect" id="node58" href="../../d2/d72/phys_8tools_8rad_8c.html#a675bb3f12a77c62cf2540bc42c4867f8" title="wrapper for mode method" alt="" coords="1039,1199,1207,1228"/><area shape="rect" id="node73" href="../../d2/d72/phys_8tools_8rad_8c.html#a2a80e3b7ea37b9536f0e49cc740425c9" title="get 4&#45;force for all pl&#39;s" alt="" coords="131,1200,283,1229"/><area shape="rect" id="node76" href="../../d2/d72/phys_8tools_8rad_8c.html#a3ad3833ac14b93095e76f8d915c5c9ad" title="calcfull_Trad" alt="" coords="159,1613,255,1643"/><area shape="rect" id="node78" href="../../d2/d72/phys_8tools_8rad_8c.html#ad1313c275fb108d10f866373d9bb227a" title="like prad_fforlab() but for only whichdir=LAB2FF used for dumps or diags" alt="" coords="161,724,252,753"/><area shape="rect" id="node211" href="../../d2/d72/phys_8tools_8rad_8c.html#ad6748b88a3ad397cb35b4d60c108508d" title="calcfull_tautot" alt="" coords="156,1667,257,1696"/><area shape="rect" id="node215" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a7e078cc9a354495bc85554d875a705d9" title="General explicit inversion of U[MHD]&#45;&gt;P[MHD] and also inverts scalars. Inverts radiation if(EOMRADTYP..." alt="" coords="3009,1172,3097,1201"/><area shape="rect" id="node222" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a58011440113d7e9adf2b0af40e531f25" title="loop for P&#45;&gt;U" alt="" coords="161,1720,252,1749"/><area shape="rect" id="node224" href="../../d8/d20/vchar_8c.html#acad033b60e7ca6404ffcd9b0fdfd13b4" title="simplefast" alt="" coords="1081,1096,1164,1125"/><area shape="rect" id="node236" href="../../d2/dd4/wavespeeds_8funcdeclare_8h.html#a2afa5dfde87c74476341a69d555f91e6" title="get wave speeds for flux calculation" alt="" coords="1899,1099,2019,1128"/><area shape="rect" id="node5" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="3401,951,3471,980"/><area shape="rect" id="node7" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="3553,853,3687,883"/><area shape="rect" id="node9" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="3773,1052,3840,1081"/><area shape="rect" id="node11" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="3932,1179,4023,1208"/><area shape="rect" id="node13" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="4165,1179,4216,1208"/><area shape="rect" id="node21" href="../../d6/db2/diag_8funcdeclare_8h.html#ac0efe363ff7411385b5c6ab3b1f146aa" title="main diag() call for diagnostics OPENMPNOTE: Assume diag() not called by multiple threads..." alt="" coords="2632,1307,2677,1336"/><area shape="rect" id="node24" href="../../d9/de0/step__ch_8c.html#a4c42d9adb1cef442b95fd62f99ee087a" title="things to do before taking a full timestep assume not called when dt==0.0" alt="" coords="3764,1304,3849,1333"/><area shape="rect" id="node27" href="../../d9/de0/step__ch_8c.html#ad36a0f9f915547477e3bb2405f8166b9" title="things to do after advance()" alt="" coords="2825,860,2927,889"/><area shape="rect" id="node32" href="../../d6/db2/diag_8funcdeclare_8h.html#a6bd89f9169256368191c508d23b0b453" title="if doavg==1, then assume this is call before dumping" alt="" coords="2371,1307,2469,1336"/><area shape="rect" id="node40" href="../../df/d15/init_8tools_8c.html#acefd26944dbbb1c289886f520f6befac" title="init_dsandvels" alt="" coords="3384,211,3488,240"/><area shape="rect" id="node49" href="../../de/db2/initbase_8funcdeclare_8h.html#a4e121b9448ac1adaa7608206369f9ea5" title="init_postvpot" alt="" coords="3572,261,3668,291"/><area shape="rect" id="node42" href="../../df/d15/init_8tools_8c.html#a77551ab2581efdbaf170dfca073ff9ab" title="user1_init_primitives" alt="" coords="3736,236,3877,265"/><area shape="rect" id="node44" href="../../de/db2/initbase_8funcdeclare_8h.html#a0afa200a5f947b1c9f6e554519f28fc4" title="init_primitives" alt="" coords="3927,224,4028,253"/><area shape="rect" id="node46" href="../../de/df8/initbase_8c.html#ac4110398e386c9888d9565630357dbbe" title="General&#45;Primary init() routine Uses globals inside init() because sets memory and sets physics..." alt="" coords="4079,192,4116,221"/><area shape="rect" id="node68" href="../../d2/d72/phys_8tools_8rad_8c.html#afa73a2caa3209e565a64f92447058507" title="calculating approximate Jacobian: dUresid(dUrad,G(Urad))/dUrad = dy(x)/dx then compute inverse Jacobi..." alt="" coords="567,1251,671,1280"/><area shape="rect" id="node60" href="../../d2/d72/phys_8tools_8rad_8c.html#aa8c5c0d5de580899948f9f22e10aff23" title="General radiation source term calculation (EXTERNALLY called) NOTE: source_explicit() takes as first ..." alt="" coords="1297,1203,1417,1232"/><area shape="rect" id="node62" href="../../d2/d1d/sources_8c.html#a504ce383765ca3d2ff0b1ee653aff854" title="Ugeomfree and dUother are in UNOTHING form (or UEVOLVE without geometry) pf might be modified so bett..." alt="" coords="2823,1160,2929,1189"/><area shape="rect" id="node64" href="../../d7/def/phys_8tools_8c.html#a12ce5092c3a1a566cb7a560a7440acc1" title="add in source terms to equations of motion ui and dUriemann in UEVOLVE form assume q(pr) so consisten..." alt="" coords="3023,1119,3084,1148"/><area shape="rect" id="node80" href="../../d2/d72/phys_8tools_8rad_8c.html#af50896d039d660550b738862b3390b07" title="radiative ortonormal ff primitives (E,F^i) &lt;&#45;&gt; primitives in lab frame Used only for initial conditio..." alt="" coords="368,532,459,561"/><area shape="rect" id="node82" href="../../d8/d60/init_8c.html#af94364e17d67cddfbb7bb3bf39c05ee6" title="init_dsandvels_koral" alt="" coords="1689,107,1828,136"/><area shape="rect" id="node85" href="../../d8/d60/init_8c.html#a448cd3fd9a1d862485e7b6e67b965172" title="process_restart_toget\l_radiation" alt="" coords="545,558,692,605"/><area shape="rect" id="node87" href="../../d2/d72/phys_8tools_8rad_8c.html#a64226cb28f52020ffe18ac6c6b1a2f5c" title="Input: start with pin [with fluid in whichvel velocity and whichcoordfluid coordinates (PRIMECOORDS o..." alt="" coords="553,489,684,535"/><area shape="rect" id="node89" href="../../de/d51/bounds_8c.html#a3bc773d499b145705bdc23125b963840" title="Koral specific physical boundary conditions." alt="" coords="1023,677,1223,707"/><area shape="rect" id="node176" href="../../de/d51/bounds_8c.html#a09a080d9895db7b800a3824cb3fac9f1" title="X1 lower for beam injection to create shadow." alt="" coords="1043,731,1203,760"/><area shape="rect" id="node179" href="../../de/d51/bounds_8c.html#a3ee134cc5fb18752265c16a20dbdfb63" title="X3 lower for radiation beam injection." alt="" coords="1025,784,1220,813"/><area shape="rect" id="node182" href="../../de/d51/bounds_8c.html#a8300ddf3ae6a3866234cc0e9c12f26dc" title="X1 upper for inflow." alt="" coords="1029,208,1216,237"/><area shape="rect" id="node185" href="../../de/d51/bounds_8c.html#a01088f65c7a4cfa2ebfed202f815b951" title="X1 lower and upper for RADATM." alt="" coords="1037,261,1208,291"/><area shape="rect" id="node188" href="../../de/d51/bounds_8c.html#a1382959a7b699ea5d224168612504263" title="X1 upper for inflow." alt="" coords="784,311,931,340"/><area shape="rect" id="node191" href="../../de/d51/bounds_8c.html#ac15824bc610943cb7e02112e77b94752" title="on&#45;grid bounding" alt="" coords="808,364,907,393"/><area shape="rect" id="node194" href="../../de/d51/bounds_8c.html#a42658c4ecf3c6edb958394eb65a9ac2b" title="RADNT." alt="" coords="811,417,904,447"/><area shape="rect" id="node197" href="../../de/d51/bounds_8c.html#a3e4008fd24427b2e91d0ae5882b9536a" title="X1 upper for RADCYLBEAM." alt="" coords="775,471,940,500"/><area shape="rect" id="node200" href="../../de/d51/bounds_8c.html#ac32c1a20138382904dc5f1c66778ad8b" title="X1 upper for RADCYLJET." alt="" coords="784,524,931,553"/><area shape="rect" id="node203" href="../../de/d51/bounds_8c.html#a635fbaba3d6d6afcf5f34bbb2c278737" title="X2 upper for radiation beam injection." alt="" coords="743,577,972,607"/><area shape="rect" id="node206" href="../../de/d51/bounds_8c.html#a9f1df4e461f3f776bf3cb80e36a4d6df" title="get_radcylbeamcart" alt="" coords="789,631,925,660"/><area shape="rect" id="node91" href="../../de/d51/bounds_8c.html#a34ac3f1ca7b0f3a21053c633da9931a9" title="user boundary routine" alt="" coords="1272,495,1443,524"/><area shape="rect" id="node93" href="../../d4/dad/bounds_8funcdeclare_8h.html#a4bc7413b2cdb89e070f38bbb689ae555" title="bound_prim_user_dir" alt="" coords="1495,507,1636,536"/><area shape="rect" id="node165" href="../../d4/dad/bounds_8funcdeclare_8h.html#a2fbddc9ff8fc706bafa80c39695c7262" title="assume single user function takes care of primitive locations" alt="" coords="1491,208,1640,237"/><area shape="rect" id="node95" href="../../d9/de0/step__ch_8c.html#adbe0e3ba8a74f09ab928a96bd68cab6d" title="bound any prim type CALLS directly real and MPI boundary functions pstag = pstagglobal ucons = unewgl..." alt="" coords="1704,519,1813,548"/><area shape="rect" id="node97" href="../../d9/de0/step__ch_8c.html#a689fddc1949b1a1d390b59d10d17d83c" title="normal full bounding during evolution NOTEMARK: Was previously also bounding pstag here..." alt="" coords="2592,808,2717,837"/><area shape="rect" id="node101" href="../../d9/de0/step__ch_8c.html#a4079244d85c301885c1363ca41502869" title="simple bounding during evolution NOTEMARK: Was previously also bounding pstag here, but not necessary since done by calling bound_pstag in fluxctstag.c" alt="" coords="1877,840,2040,869"/><area shape="rect" id="node104" href="../../d9/de0/step__ch_8c.html#addca75a18cc861326a321565a2e81aa0" title="normal bounding of non&#45;staggered primitives" alt="" coords="1915,519,2003,548"/><area shape="rect" id="node159" href="../../d9/de0/step__ch_8c.html#a460b84e1112e3aef17209c20e22e1cf1" title="bound all prims" alt="" coords="2359,211,2481,240"/><area shape="rect" id="node106" href="../../dc/dae/flux_8c.html#aef355ccd1ca2295b84ad2fe1fc011d35" title="normal interpolation of CENT quantities to FACE quantities sets global variables pl_ct and pr_ct to p..." alt="" coords="2092,995,2271,1024"/><area shape="rect" id="node118" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aecb3f613a7cb3bbb42fff2dbee5d65a1" title="This vpot2field function is for staggered method to evolve quasi&#45;deaveraged fields (i..." alt="" coords="2793,365,2959,395"/><area shape="rect" id="node120" href="../../de/db2/initbase_8funcdeclare_8h.html#ae6b2ad4cd0debf5b89ba8a9e471d6977" title="assumes normal field p pleft used as temp var if FLUXB==FLUXCTSTAG assigns conserved field in UEVOLVE..." alt="" coords="3015,404,3092,433"/><area shape="rect" id="node129" href="../../d0/dde/fluxctstag_8c.html#a4e3d76c6ad125b8199948408c262e3a1" title="wrapper for: 1) interpolate FACE 2 CORN 2) loop over dimensions setting field flux dimension&#45;by&#45;dimen..." alt="" coords="2589,725,2720,755"/><area shape="rect" id="node132" href="../../d0/dde/fluxctstag_8c.html#a2dd789bf1402bef72523cdb69e85806e" title="use global pbcorninterp and pvcorninterp at CORN1,2,3 to obtain EMFs at CORN1,2,3 NO interpolation of..." alt="" coords="2355,687,2485,734"/><area shape="rect" id="node135" href="../../d0/dde/fluxctstag_8c.html#aaec26a518629175ecceefbaf6c84225e" title="wrapper for continuous interpolation for FACE_to_CENT" alt="" coords="2095,573,2268,603"/><area shape="rect" id="node139" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aa31dd83c96936277334c62e2098dd51d" title="wrapper for taking staggered conserved field quantity and obtaining centered field quantity upoint en..." alt="" coords="2567,516,2743,545"/><area shape="rect" id="node148" href="../../d0/dde/fluxctstag_8c.html#a6cd90dff56319085b32bc57c0c8b3cfd" title="this function called in initbase.c and during advance() here ustag is point value if dimension doesn&#39;..." alt="" coords="2121,467,2241,496"/><area shape="rect" id="node151" href="../../d0/dde/fluxctstag_8c.html#ad6aa918442f7768dff3c099ba353ee64" title="slope_lim_face2corn() is provided p2interp and returns pleft/pright differs from slope_lim() by range..." alt="" coords="2111,739,2252,768"/><area shape="rect" id="node108" href="../../dc/dae/flux_8c.html#a2602a4dad9ed7adc944227d02435312e" title="standard (non&#45;field flux) calculation but setup to store results of interpolation so can be used for ..." alt="" coords="2323,1083,2517,1112"/><area shape="rect" id="node110" href="../../dc/dae/flux_8c.html#aaf6d832880760f80459d91477c28b519" title="wrapper for different standard 1&#45;D flux calculators 1&#45;D interpolate and get flux for that direction (..." alt="" coords="2597,1083,2712,1112"/><area shape="rect" id="node112" href="../../dc/dae/flux_8c.html#a8ffa7399bd5354fdcdec5f3e1adf0b13" title="wrapper for CENT_to_FACE1,2,3 used to compute flux at face" alt="" coords="2829,1073,2923,1103"/><area shape="rect" id="node114" href="../../d5/d2f/flux_8funcdeclare_8h.html#ab229b0f3f2caf3c0a3ef5299fba2b1c0" title="see fluxcompute.c for non&#45;computer science, real physics calculations of flux" alt="" coords="3020,1065,3087,1095"/><area shape="rect" id="node122" href="../../df/d15/init_8tools_8c.html#a3750bc790613bc6c8c805af0f1b839c8" title="user1_init_vpot2field_user" alt="" coords="3147,391,3320,420"/><area shape="rect" id="node124" href="../../de/db2/initbase_8funcdeclare_8h.html#afda44281ad5c163455c40f012d4a8954" title="init_vpot2field_user" alt="" coords="3369,379,3503,408"/><area shape="rect" id="node126" href="../../de/db2/initbase_8funcdeclare_8h.html#a90699a18ede8b7f112c0078512804ec1" title="initialize vector potential given user function assumes normal non&#45;staggered field in pr Notice that ..." alt="" coords="3585,372,3655,401"/><area shape="rect" id="node137" href="../../d0/dde/fluxctstag_8c.html#a5e3dcbe89d6f8a9384cafb58afd7dbf4" title="interpolates field at FACE to field at CENT assuming field along itself is continuous" alt="" coords="2360,567,2480,614"/><area shape="rect" id="node143" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aaa24493002bc8c0a527b1ea2ac2dddbf" title="convert conservative U to stag point P and CENT point U and CENT point primitive" alt="" coords="2809,469,2943,499"/><area shape="rect" id="node153" href="../../d0/dde/fluxctstag_8c.html#a985ee116306b4011810334ae93900493" title="INPUTS: Nvec, pr, primface_l[dir], primface_r[dir] OUTPUTS: pbcorn[dir][side], pvcorn[dir][side][side..." alt="" coords="2331,757,2509,787"/><area shape="rect" id="node161" href="../../d9/de0/step__ch_8c.html#a91fe5c4370e3292a19e7f794797a407f" title="normal bounding of all primitives" alt="" coords="3569,107,3671,136"/><area shape="rect" id="node167" href="../../d9/de0/step__ch_8c.html#abdea68b778dc9253324da69d3c376965" title="bound any pstag type CALLS directly real and MPI boundary functions pstag is at FACE1,2,3 for fields, so user bound is different MPI bounding is the same as CENT quantities used when restarting in initbase.c to bound unewglobal for FLUXB==FLUXCTSTAG" alt="" coords="2123,157,2240,187"/><area shape="rect" id="node170" href="../../d9/de0/step__ch_8c.html#a6f4b963a50a7288964f01775f2f18bb9" title="normal bounding of staggered primitives" alt="" coords="2372,157,2468,187"/><area shape="rect" id="node173" href="../../d0/dde/fluxctstag_8c.html#aa169cb1999412f2e2460012cc5d7a804" title="pure DONOR version: upoint is input staggered updated field that needs to be converted to pstag and t..." alt="" coords="2567,143,2743,190"/><area shape="rect" id="node208" href="../../de/d51/bounds_8c.html#a16398a5325a9df48783423f00ba65bb7" title="all boundaries for RADCYLBEAMCART" alt="" coords="1047,624,1199,653"/><area shape="rect" id="node213" href="../../d2/d72/phys_8tools_8rad_8c.html#a69289f92f5afd222ade67c4e9c60285a" title="get contravariant relative 4&#45;velocity in lab frame" alt="" coords="332,1667,495,1696"/><area shape="rect" id="node220" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a8db9dc7c7f52d6fcb405a74e519db5cf" title="there may be something wrong with this function  didn&#39;t work in TIMEORDER==4, had to do standard met..." alt="" coords="3188,1172,3279,1201"/><area shape="rect" id="node226" href="../../d2/d72/phys_8tools_8rad_8c.html#abd01208ba3c5754ea5587bcaefcaa01b" title="get lab&#45;frame 3&#45;velocity for radiative emission in radiative frame" alt="" coords="1304,1148,1411,1177"/><area shape="rect" id="node251" href="../../d2/dd4/wavespeeds_8funcdeclare_8h.html#adba6a1e320ad60ae452a4ff6f8ba6e25" title="Charles believed that near polar axis one should set vmax=vmin=0, but not right since makes flux comp..." alt="" coords="1539,1096,1592,1125"/><area shape="rect" id="node228" href="../../d2/d72/phys_8tools_8rad_8c.html#a56f468401f08e66966f0318198ca6e85" title="compute radiative characteristics as limited by opacity" alt="" coords="1527,1149,1604,1179"/><area shape="rect" id="node230" href="../../d2/dd4/wavespeeds_8funcdeclare_8h.html#abb81988bde678c59afc5d006cf76b835" title="vchar_each" alt="" coords="1715,1149,1803,1179"/><area shape="rect" id="node232" href="../../d2/dd4/wavespeeds_8funcdeclare_8h.html#a119027341f97d571212ad74c5ddc94b4" title="get wave speeds for flux calculation and for dt calculation" alt="" coords="1921,1307,1996,1336"/><area shape="rect" id="node245" href="../../d2/dd4/wavespeeds_8funcdeclare_8h.html#a75426b1b9bf1a293c60d108c63b0322d" title="store wavespeeds somewhere" alt="" coords="1879,1152,2039,1181"/><area shape="rect" id="node238" href="../../d3/ddc/phys_8funcdeclare_8h.html#a0bb12b388b07610cf01d08c19f8fddb1" title="actually compute the flux and ctop for dt calculation" alt="" coords="2107,1099,2256,1128"/><area shape="rect" id="node240" href="../../dc/dae/flux_8c.html#a054658527dfb1d80226b8b2d2106aeed" title="original flux calculator that gets F in &quot;dir&quot;. At end global pleft,pright,dq also set and if STOREWAV..." alt="" coords="2359,1136,2481,1165"/><area shape="rect" id="node247" href="../../d2/dd4/wavespeeds_8funcdeclare_8h.html#acb4a2a3be68517862cdcf097ff51af37" title="complete storage of wave speeds per dimension only called for STOREWAVESPEEDS==1" alt="" coords="2089,1152,2273,1181"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7e351d63f2ee830fed250221b06034f7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_state_nofield </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>geom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *&#160;</td>
          <td class="paramname"><em>q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>all <a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#a11e17cd8b0594d1ad52e3594aa9f477e" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e...">get_state()</a> things except the field quantities </p>

<p>Definition at line <a class="el" href="../../d7/def/phys_8tools_8c_source.html#l01932">1932</a> of file <a class="el" href="../../d7/def/phys_8tools_8c_source.html">phys.tools.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_a7e351d63f2ee830fed250221b06034f7_cgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_a7e351d63f2ee830fed250221b06034f7_cgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_a7e351d63f2ee830fed250221b06034f7_cgraph" id="d3/ddc/phys_8funcdeclare_8h_a7e351d63f2ee830fed250221b06034f7_cgraph">
<area shape="rect" id="node3" href="../../d3/ddc/phys_8funcdeclare_8h.html#a12a473e24b431762af4168179e82cd08" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="195,5,357,35"/><area shape="rect" id="node5" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a8a762bf6582e6f7e1199de9c43b98454" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="177,59,375,88"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3c69b676adf3024cd6ae832094d91fab"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_state_norad_part1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>geom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *&#160;</td>
          <td class="paramname"><em>q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function expect to get q-&gt;{ucon,ucov,bcon,bcov,pressure} </p>

<p>Definition at line <a class="el" href="../../d7/def/phys_8tools_8c_source.html#l01901">1901</a> of file <a class="el" href="../../d7/def/phys_8tools_8c_source.html">phys.tools.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_a3c69b676adf3024cd6ae832094d91fab_cgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_a3c69b676adf3024cd6ae832094d91fab_cgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_a3c69b676adf3024cd6ae832094d91fab_cgraph" id="d3/ddc/phys_8funcdeclare_8h_a3c69b676adf3024cd6ae832094d91fab_cgraph">
<area shape="rect" id="node3" href="../../d3/ddc/phys_8funcdeclare_8h.html#a12a473e24b431762af4168179e82cd08" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="205,5,368,35"/><area shape="rect" id="node5" href="../../d3/ddc/phys_8funcdeclare_8h.html#a41b8eacac0a4a23d6b00b670fe49629c" title="bsq_calc_fromq" alt="" coords="229,59,344,88"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_a3c69b676adf3024cd6ae832094d91fab_icgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_a3c69b676adf3024cd6ae832094d91fab_icgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_a3c69b676adf3024cd6ae832094d91fab_icgraph" id="d3/ddc/phys_8funcdeclare_8h_a3c69b676adf3024cd6ae832094d91fab_icgraph">
<area shape="rect" id="node3" href="../../d2/d72/phys_8tools_8rad_8c.html#af46d2b1cf89a70a7e2ef503146c649a9" title="uu0 &#45; original cons." alt="" coords="228,32,303,61"/><area shape="rect" id="node32" href="../../d1/d3e/utoprimgen_8c.html#a0a83e9e7fdd3cc595c5b8d0df88ec684" title="just picks the algorithm to invert" alt="" coords="205,85,325,115"/><area shape="rect" id="node5" href="../../d2/d72/phys_8tools_8rad_8c.html#a17aede36203a236390363af78d3a86f0" title="compute changes to U (both T and R) using implicit method KORALTODO: If doing implicit, should also add geometry source term that can sometimes be stiff." alt="" coords="528,32,736,61"/><area shape="rect" id="node29" href="../../d2/d72/phys_8tools_8rad_8c.html#afa73a2caa3209e565a64f92447058507" title="calculating approximate Jacobian: dUresid(dUrad,G(Urad))/dUrad = dy(x)/dx then compute inverse Jacobi..." alt="" coords="375,33,479,63"/><area shape="rect" id="node7" href="../../d2/d72/phys_8tools_8rad_8c.html#a675bb3f12a77c62cf2540bc42c4867f8" title="wrapper for mode method" alt="" coords="785,32,953,61"/><area shape="rect" id="node9" href="../../d2/d72/phys_8tools_8rad_8c.html#aa8c5c0d5de580899948f9f22e10aff23" title="General radiation source term calculation (EXTERNALLY called) NOTE: source_explicit() takes as first ..." alt="" coords="1004,32,1124,61"/><area shape="rect" id="node11" href="../../d2/d1d/sources_8c.html#a504ce383765ca3d2ff0b1ee653aff854" title="Ugeomfree and dUother are in UNOTHING form (or UEVOLVE without geometry) pf might be modified so bett..." alt="" coords="1173,32,1280,61"/><area shape="rect" id="node13" href="../../d7/def/phys_8tools_8c.html#a12ce5092c3a1a566cb7a560a7440acc1" title="add in source terms to equations of motion ui and dUriemann in UEVOLVE form assume q(pr) so consisten..." alt="" coords="1343,32,1404,61"/><area shape="rect" id="node15" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="1481,5,1609,35"/><area shape="rect" id="node27" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="1468,59,1623,88"/><area shape="rect" id="node17" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="1691,5,1760,35"/><area shape="rect" id="node19" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="1831,5,1964,35"/><area shape="rect" id="node21" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="2035,5,2101,35"/><area shape="rect" id="node23" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="2169,5,2260,35"/><area shape="rect" id="node25" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="2309,32,2360,61"/><area shape="rect" id="node34" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a7e078cc9a354495bc85554d875a705d9" title="General explicit inversion of U[MHD]&#45;&gt;P[MHD] and also inverts scalars. Inverts radiation if(EOMRADTYP..." alt="" coords="1329,85,1417,115"/><area shape="rect" id="node38" href="../../d8/d60/init_8c.html#af3b64278d50c2ff0fee80291fbd38dab" title="fieldprim" alt="" coords="1511,112,1580,141"/><area shape="rect" id="node52" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a8db9dc7c7f52d6fcb405a74e519db5cf" title="there may be something wrong with this function  didn&#39;t work in TIMEORDER==4, had to do standard met..." alt="" coords="1500,165,1591,195"/><area shape="rect" id="node40" href="../../df/d15/init_8tools_8c.html#acefd26944dbbb1c289886f520f6befac" title="init_dsandvels" alt="" coords="1673,59,1777,88"/><area shape="rect" id="node49" href="../../de/db2/initbase_8funcdeclare_8h.html#a4e121b9448ac1adaa7608206369f9ea5" title="init_postvpot" alt="" coords="1677,112,1773,141"/><area shape="rect" id="node42" href="../../df/d15/init_8tools_8c.html#a77551ab2581efdbaf170dfca073ff9ab" title="user1_init_primitives" alt="" coords="1827,59,1968,88"/><area shape="rect" id="node44" href="../../de/db2/initbase_8funcdeclare_8h.html#a0afa200a5f947b1c9f6e554519f28fc4" title="init_primitives" alt="" coords="2017,59,2119,88"/><area shape="rect" id="node46" href="../../de/df8/initbase_8c.html#ac4110398e386c9888d9565630357dbbe" title="General&#45;Primary init() routine Uses globals inside init() because sets memory and sets physics..." alt="" coords="2196,59,2233,88"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aae6a7d24b984236dae44b1a3e8ee37b6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_state_norad_part2 </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>needentropy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>geom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *&#160;</td>
          <td class="paramname"><em>q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function expect to get q-&gt;{ucon,ucov,bcon,bcov,pressure} </p>

<p>Definition at line <a class="el" href="../../d7/def/phys_8tools_8c_source.html#l01919">1919</a> of file <a class="el" href="../../d7/def/phys_8tools_8c_source.html">phys.tools.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_aae6a7d24b984236dae44b1a3e8ee37b6_icgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_aae6a7d24b984236dae44b1a3e8ee37b6_icgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_aae6a7d24b984236dae44b1a3e8ee37b6_icgraph" id="d3/ddc/phys_8funcdeclare_8h_aae6a7d24b984236dae44b1a3e8ee37b6_icgraph">
<area shape="rect" id="node3" href="../../d2/d72/phys_8tools_8rad_8c.html#af46d2b1cf89a70a7e2ef503146c649a9" title="uu0 &#45; original cons." alt="" coords="228,20,303,50"/><area shape="rect" id="node5" href="../../d2/d72/phys_8tools_8rad_8c.html#a17aede36203a236390363af78d3a86f0" title="compute changes to U (both T and R) using implicit method KORALTODO: If doing implicit, should also add geometry source term that can sometimes be stiff." alt="" coords="528,20,736,50"/><area shape="rect" id="node33" href="../../d1/d3e/utoprimgen_8c.html#a0a83e9e7fdd3cc595c5b8d0df88ec684" title="just picks the algorithm to invert" alt="" coords="205,124,325,154"/><area shape="rect" id="node29" href="../../d2/d72/phys_8tools_8rad_8c.html#afa73a2caa3209e565a64f92447058507" title="calculating approximate Jacobian: dUresid(dUrad,G(Urad))/dUrad = dy(x)/dx then compute inverse Jacobi..." alt="" coords="375,20,479,50"/><area shape="rect" id="node7" href="../../d2/d72/phys_8tools_8rad_8c.html#a675bb3f12a77c62cf2540bc42c4867f8" title="wrapper for mode method" alt="" coords="785,20,953,50"/><area shape="rect" id="node9" href="../../d2/d72/phys_8tools_8rad_8c.html#aa8c5c0d5de580899948f9f22e10aff23" title="General radiation source term calculation (EXTERNALLY called) NOTE: source_explicit() takes as first ..." alt="" coords="1004,20,1124,50"/><area shape="rect" id="node11" href="../../d2/d1d/sources_8c.html#a504ce383765ca3d2ff0b1ee653aff854" title="Ugeomfree and dUother are in UNOTHING form (or UEVOLVE without geometry) pf might be modified so bett..." alt="" coords="1173,20,1280,50"/><area shape="rect" id="node13" href="../../d7/def/phys_8tools_8c.html#a12ce5092c3a1a566cb7a560a7440acc1" title="add in source terms to equations of motion ui and dUriemann in UEVOLVE form assume q(pr) so consisten..." alt="" coords="1343,20,1404,50"/><area shape="rect" id="node15" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="1481,19,1609,48"/><area shape="rect" id="node27" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="1468,72,1623,102"/><area shape="rect" id="node17" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="1691,19,1760,48"/><area shape="rect" id="node19" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="1831,19,1964,48"/><area shape="rect" id="node21" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="2035,19,2101,48"/><area shape="rect" id="node23" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="2169,19,2260,48"/><area shape="rect" id="node25" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="2309,46,2360,75"/><area shape="rect" id="node35" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a7e078cc9a354495bc85554d875a705d9" title="General explicit inversion of U[MHD]&#45;&gt;P[MHD] and also inverts scalars. Inverts radiation if(EOMRADTYP..." alt="" coords="1329,124,1417,154"/><area shape="rect" id="node39" href="../../d8/d60/init_8c.html#af3b64278d50c2ff0fee80291fbd38dab" title="fieldprim" alt="" coords="1511,126,1580,155"/><area shape="rect" id="node53" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a8db9dc7c7f52d6fcb405a74e519db5cf" title="there may be something wrong with this function  didn&#39;t work in TIMEORDER==4, had to do standard met..." alt="" coords="1500,179,1591,208"/><area shape="rect" id="node41" href="../../df/d15/init_8tools_8c.html#acefd26944dbbb1c289886f520f6befac" title="init_dsandvels" alt="" coords="1673,72,1777,102"/><area shape="rect" id="node50" href="../../de/db2/initbase_8funcdeclare_8h.html#a4e121b9448ac1adaa7608206369f9ea5" title="init_postvpot" alt="" coords="1677,126,1773,155"/><area shape="rect" id="node43" href="../../df/d15/init_8tools_8c.html#a77551ab2581efdbaf170dfca073ff9ab" title="user1_init_primitives" alt="" coords="1827,72,1968,102"/><area shape="rect" id="node45" href="../../de/db2/initbase_8funcdeclare_8h.html#a0afa200a5f947b1c9f6e554519f28fc4" title="init_primitives" alt="" coords="2017,72,2119,102"/><area shape="rect" id="node47" href="../../de/df8/initbase_8c.html#ac4110398e386c9888d9565630357dbbe" title="General&#45;Primary init() routine Uses globals inside init() because sets memory and sets physics..." alt="" coords="2196,72,2233,102"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a07847bede2b7ba9d0aabaea82f17f989"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_state_radonly </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>geom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *&#160;</td>
          <td class="paramname"><em>q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function expect to get q-&gt;{ucon,ucov,bcon,bcov,pressure} </p>

<p>Definition at line <a class="el" href="../../d7/def/phys_8tools_8c_source.html#l01888">1888</a> of file <a class="el" href="../../d7/def/phys_8tools_8c_source.html">phys.tools.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_a07847bede2b7ba9d0aabaea82f17f989_cgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_a07847bede2b7ba9d0aabaea82f17f989_cgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_a07847bede2b7ba9d0aabaea82f17f989_cgraph" id="d3/ddc/phys_8funcdeclare_8h_a07847bede2b7ba9d0aabaea82f17f989_cgraph">
<area shape="rect" id="node3" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a8a762bf6582e6f7e1199de9c43b98454" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="180,5,377,35"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_a07847bede2b7ba9d0aabaea82f17f989_icgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_a07847bede2b7ba9d0aabaea82f17f989_icgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_a07847bede2b7ba9d0aabaea82f17f989_icgraph" id="d3/ddc/phys_8funcdeclare_8h_a07847bede2b7ba9d0aabaea82f17f989_icgraph">
<area shape="rect" id="node3" href="../../d2/d72/phys_8tools_8rad_8c.html#af46d2b1cf89a70a7e2ef503146c649a9" title="uu0 &#45; original cons." alt="" coords="201,32,276,61"/><area shape="rect" id="node32" href="../../d1/d3e/utoprimgen_8c.html#a0a83e9e7fdd3cc595c5b8d0df88ec684" title="just picks the algorithm to invert" alt="" coords="179,85,299,115"/><area shape="rect" id="node5" href="../../d2/d72/phys_8tools_8rad_8c.html#a17aede36203a236390363af78d3a86f0" title="compute changes to U (both T and R) using implicit method KORALTODO: If doing implicit, should also add geometry source term that can sometimes be stiff." alt="" coords="501,32,709,61"/><area shape="rect" id="node29" href="../../d2/d72/phys_8tools_8rad_8c.html#afa73a2caa3209e565a64f92447058507" title="calculating approximate Jacobian: dUresid(dUrad,G(Urad))/dUrad = dy(x)/dx then compute inverse Jacobi..." alt="" coords="348,33,452,63"/><area shape="rect" id="node7" href="../../d2/d72/phys_8tools_8rad_8c.html#a675bb3f12a77c62cf2540bc42c4867f8" title="wrapper for mode method" alt="" coords="759,32,927,61"/><area shape="rect" id="node9" href="../../d2/d72/phys_8tools_8rad_8c.html#aa8c5c0d5de580899948f9f22e10aff23" title="General radiation source term calculation (EXTERNALLY called) NOTE: source_explicit() takes as first ..." alt="" coords="977,32,1097,61"/><area shape="rect" id="node11" href="../../d2/d1d/sources_8c.html#a504ce383765ca3d2ff0b1ee653aff854" title="Ugeomfree and dUother are in UNOTHING form (or UEVOLVE without geometry) pf might be modified so bett..." alt="" coords="1147,32,1253,61"/><area shape="rect" id="node13" href="../../d7/def/phys_8tools_8c.html#a12ce5092c3a1a566cb7a560a7440acc1" title="add in source terms to equations of motion ui and dUriemann in UEVOLVE form assume q(pr) so consisten..." alt="" coords="1316,32,1377,61"/><area shape="rect" id="node15" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="1455,5,1583,35"/><area shape="rect" id="node27" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="1441,59,1596,88"/><area shape="rect" id="node17" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="1664,5,1733,35"/><area shape="rect" id="node19" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="1804,5,1937,35"/><area shape="rect" id="node21" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="2008,5,2075,35"/><area shape="rect" id="node23" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="2143,5,2233,35"/><area shape="rect" id="node25" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="2283,32,2333,61"/><area shape="rect" id="node34" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a7e078cc9a354495bc85554d875a705d9" title="General explicit inversion of U[MHD]&#45;&gt;P[MHD] and also inverts scalars. Inverts radiation if(EOMRADTYP..." alt="" coords="1303,85,1391,115"/><area shape="rect" id="node38" href="../../d8/d60/init_8c.html#af3b64278d50c2ff0fee80291fbd38dab" title="fieldprim" alt="" coords="1484,112,1553,141"/><area shape="rect" id="node52" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a8db9dc7c7f52d6fcb405a74e519db5cf" title="there may be something wrong with this function  didn&#39;t work in TIMEORDER==4, had to do standard met..." alt="" coords="1473,165,1564,195"/><area shape="rect" id="node40" href="../../df/d15/init_8tools_8c.html#acefd26944dbbb1c289886f520f6befac" title="init_dsandvels" alt="" coords="1647,59,1751,88"/><area shape="rect" id="node49" href="../../de/db2/initbase_8funcdeclare_8h.html#a4e121b9448ac1adaa7608206369f9ea5" title="init_postvpot" alt="" coords="1651,112,1747,141"/><area shape="rect" id="node42" href="../../df/d15/init_8tools_8c.html#a77551ab2581efdbaf170dfca073ff9ab" title="user1_init_primitives" alt="" coords="1800,59,1941,88"/><area shape="rect" id="node44" href="../../de/db2/initbase_8funcdeclare_8h.html#a0afa200a5f947b1c9f6e554519f28fc4" title="init_primitives" alt="" coords="1991,59,2092,88"/><area shape="rect" id="node46" href="../../de/df8/initbase_8c.html#ac4110398e386c9888d9565630357dbbe" title="General&#45;Primary init() routine Uses globals inside init() because sets memory and sets physics..." alt="" coords="2169,59,2207,88"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a12a473e24b431762af4168179e82cd08"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_state_uconucovonly </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>ptrgeom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *&#160;</td>
          <td class="paramname"><em>q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get only u^ and u_ assumine b^ and b_ not used. </p>

<p>Definition at line <a class="el" href="../../d7/def/phys_8tools_8c_source.html#l02205">2205</a> of file <a class="el" href="../../d7/def/phys_8tools_8c_source.html">phys.tools.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_a12a473e24b431762af4168179e82cd08_icgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_a12a473e24b431762af4168179e82cd08_icgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_a12a473e24b431762af4168179e82cd08_icgraph" id="d3/ddc/phys_8funcdeclare_8h_a12a473e24b431762af4168179e82cd08_icgraph">
<area shape="rect" id="node3" href="../../d7/def/phys_8tools_8c.html#a093ebf0a3b694b149f25f0483a885c17" title="returns b^2 (i.e., twice magnetic pressure)" alt="" coords="269,5,387,35"/><area shape="rect" id="node5" href="../../d7/def/phys_8tools_8c.html#a9684455352a66ce457839e4eb0c4c172" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="291,679,365,708"/><area shape="rect" id="node261" href="../../d7/def/phys_8tools_8c.html#a996b0ad97444a5dc3a7e6a90ee81facd" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="489,472,639,501"/><area shape="rect" id="node267" href="../../d7/def/phys_8tools_8c.html#a83946d263e4786959397e89cf6bf1431" title="all get_state() things except the field quantities" alt="" coords="268,732,388,761"/><area shape="rect" id="node269" href="../../d7/def/phys_8tools_8c.html#ad46675c486138b240d9bfa27e5ca262a" title="used to check inversion, which has consistent pressure used to get things as functions of &#160;instead of..." alt="" coords="239,785,417,815"/><area shape="rect" id="node271" href="../../d7/def/phys_8tools_8c.html#adf1cf36a7c564b77dca08d26ce233df7" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="708,109,868,139"/><area shape="rect" id="node283" href="../../d7/def/phys_8tools_8c.html#a39e973bfdc6ccf9e82b33925e073fca3" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="2295,192,2449,221"/><area shape="rect" id="node289" href="../../d7/def/phys_8tools_8c.html#a932c3d0ede37a07f6d380cf6ce07e0b0" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="244,839,412,868"/><area shape="rect" id="node312" href="../../d7/def/phys_8tools_8c.html#a3ef47960a272ef981fd551582b610503" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="217,433,439,463"/><area shape="rect" id="node317" href="../../d7/def/phys_8tools_8c.html#a4fe81910bc63688d418cca528888089e" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="223,892,433,921"/><area shape="rect" id="node7" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="3615,839,3743,868"/><area shape="rect" id="node19" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="3601,377,3756,407"/><area shape="rect" id="node21" href="../../df/d22/advance_8c.html#a0936d88b132d9655aa9287035a4793c5" title="If density or gamma&#45;factors are different by more than fractional_difference_threshold for states pin..." alt="" coords="493,832,635,861"/><area shape="rect" id="node23" href="../../d5/de3/phys_8tools_8funcdeclare_8h.html#ac9512f95a18d4a189ac642d138f95051" title="2D only for now since really only useful for 2D imaging map out region around failure point OPENMPNOT..." alt="" coords="1937,645,2015,675"/><area shape="rect" id="node34" href="../../d6/db2/diag_8funcdeclare_8h.html#a53324e6dbf9729772e70f0a053468ae6" title="set var to be averaged in time" alt="" coords="1928,699,2024,728"/><area shape="rect" id="node39" href="../../dc/dae/flux_8c.html#aa26f8747446e1cd5bd214ebc345aafa2" title="compute donor&#45;based flux, bypassing normal fluxcalc()." alt="" coords="2127,261,2233,291"/><area shape="rect" id="node42" href="../../d8/d60/init_8c.html#af3b64278d50c2ff0fee80291fbd38dab" title="fieldprim" alt="" coords="1215,1039,1284,1068"/><area shape="rect" id="node56" href="../../d7/def/phys_8tools_8c.html#aedc30b56b48db47c3622b2d6c55161d9" title="returns b^2 (i.e., twice magnetic pressure)" alt="" coords="503,987,625,1016"/><area shape="rect" id="node58" href="../../d2/d72/phys_8tools_8rad_8c.html#af46d2b1cf89a70a7e2ef503146c649a9" title="uu0 &#45; original cons." alt="" coords="751,576,825,605"/><area shape="rect" id="node60" href="../../d2/d72/phys_8tools_8rad_8c.html#a17aede36203a236390363af78d3a86f0" title="compute changes to U (both T and R) using implicit method KORALTODO: If doing implicit, should also add geometry source term that can sometimes be stiff." alt="" coords="1145,677,1353,707"/><area shape="rect" id="node62" href="../../d2/d72/phys_8tools_8rad_8c.html#a675bb3f12a77c62cf2540bc42c4867f8" title="wrapper for mode method" alt="" coords="1431,677,1599,707"/><area shape="rect" id="node77" href="../../d2/d72/phys_8tools_8rad_8c.html#a2a80e3b7ea37b9536f0e49cc740425c9" title="get 4&#45;force for all pl&#39;s" alt="" coords="488,627,640,656"/><area shape="rect" id="node80" href="../../d2/d72/phys_8tools_8rad_8c.html#a3ad3833ac14b93095e76f8d915c5c9ad" title="calcfull_Trad" alt="" coords="516,1091,612,1120"/><area shape="rect" id="node82" href="../../d2/d72/phys_8tools_8rad_8c.html#ad1313c275fb108d10f866373d9bb227a" title="like prad_fforlab() but for only whichdir=LAB2FF used for dumps or diags" alt="" coords="519,1197,609,1227"/><area shape="rect" id="node215" href="../../d2/d72/phys_8tools_8rad_8c.html#ad6748b88a3ad397cb35b4d60c108508d" title="calcfull_tautot" alt="" coords="513,1144,615,1173"/><area shape="rect" id="node219" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a7e078cc9a354495bc85554d875a705d9" title="General explicit inversion of U[MHD]&#45;&gt;P[MHD] and also inverts scalars. Inverts radiation if(EOMRADTYP..." alt="" coords="967,523,1055,552"/><area shape="rect" id="node226" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a58011440113d7e9adf2b0af40e531f25" title="loop for P&#45;&gt;U" alt="" coords="519,1251,609,1280"/><area shape="rect" id="node228" href="../../d8/d20/vchar_8c.html#acad033b60e7ca6404ffcd9b0fdfd13b4" title="simplefast" alt="" coords="747,419,829,448"/><area shape="rect" id="node240" href="../../d2/dd4/wavespeeds_8funcdeclare_8h.html#a2afa5dfde87c74476341a69d555f91e6" title="get wave speeds for flux calculation" alt="" coords="1689,419,1809,448"/><area shape="rect" id="node9" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="3847,1037,3916,1067"/><area shape="rect" id="node11" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="3999,1113,4132,1143"/><area shape="rect" id="node13" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="4219,1069,4285,1099"/><area shape="rect" id="node15" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="4377,1021,4468,1051"/><area shape="rect" id="node17" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="4611,1021,4661,1051"/><area shape="rect" id="node25" href="../../d6/db2/diag_8funcdeclare_8h.html#ac0efe363ff7411385b5c6ab3b1f146aa" title="main diag() call for diagnostics OPENMPNOTE: Assume diag() not called by multiple threads..." alt="" coords="2349,684,2395,713"/><area shape="rect" id="node28" href="../../d9/de0/step__ch_8c.html#a4c42d9adb1cef442b95fd62f99ee087a" title="things to do before taking a full timestep assume not called when dt==0.0" alt="" coords="3839,884,3924,913"/><area shape="rect" id="node31" href="../../d9/de0/step__ch_8c.html#ad36a0f9f915547477e3bb2405f8166b9" title="things to do after advance()" alt="" coords="2540,1397,2641,1427"/><area shape="rect" id="node36" href="../../d6/db2/diag_8funcdeclare_8h.html#a6bd89f9169256368191c508d23b0b453" title="if doavg==1, then assume this is call before dumping" alt="" coords="2131,699,2229,728"/><area shape="rect" id="node44" href="../../df/d15/init_8tools_8c.html#acefd26944dbbb1c289886f520f6befac" title="init_dsandvels" alt="" coords="1463,1717,1567,1747"/><area shape="rect" id="node53" href="../../de/db2/initbase_8funcdeclare_8h.html#a4e121b9448ac1adaa7608206369f9ea5" title="init_postvpot" alt="" coords="3631,1485,3727,1515"/><area shape="rect" id="node46" href="../../df/d15/init_8tools_8c.html#a77551ab2581efdbaf170dfca073ff9ab" title="user1_init_primitives" alt="" coords="4181,1524,4323,1553"/><area shape="rect" id="node48" href="../../de/db2/initbase_8funcdeclare_8h.html#a0afa200a5f947b1c9f6e554519f28fc4" title="init_primitives" alt="" coords="4372,1473,4473,1503"/><area shape="rect" id="node50" href="../../de/df8/initbase_8c.html#ac4110398e386c9888d9565630357dbbe" title="General&#45;Primary init() routine Uses globals inside init() because sets memory and sets physics..." alt="" coords="4524,1447,4561,1476"/><area shape="rect" id="node72" href="../../d2/d72/phys_8tools_8rad_8c.html#afa73a2caa3209e565a64f92447058507" title="calculating approximate Jacobian: dUresid(dUrad,G(Urad))/dUrad = dy(x)/dx then compute inverse Jacobi..." alt="" coords="959,627,1063,656"/><area shape="rect" id="node64" href="../../d2/d72/phys_8tools_8rad_8c.html#aa8c5c0d5de580899948f9f22e10aff23" title="General radiation source term calculation (EXTERNALLY called) NOTE: source_explicit() takes as first ..." alt="" coords="2120,593,2240,623"/><area shape="rect" id="node66" href="../../d2/d1d/sources_8c.html#a504ce383765ca3d2ff0b1ee653aff854" title="Ugeomfree and dUother are in UNOTHING form (or UEVOLVE without geometry) pf might be modified so bett..." alt="" coords="3228,632,3335,661"/><area shape="rect" id="node68" href="../../d7/def/phys_8tools_8c.html#a12ce5092c3a1a566cb7a560a7440acc1" title="add in source terms to equations of motion ui and dUriemann in UEVOLVE form assume q(pr) so consisten..." alt="" coords="3448,632,3509,661"/><area shape="rect" id="node84" href="../../d2/d72/phys_8tools_8rad_8c.html#af50896d039d660550b738862b3390b07" title="radiative ortonormal ff primitives (E,F^i) &lt;&#45;&gt; primitives in lab frame Used only for initial conditio..." alt="" coords="743,1343,833,1372"/><area shape="rect" id="node86" href="../../d8/d60/init_8c.html#af94364e17d67cddfbb7bb3bf39c05ee6" title="init_dsandvels_koral" alt="" coords="941,1565,1080,1595"/><area shape="rect" id="node89" href="../../d8/d60/init_8c.html#a448cd3fd9a1d862485e7b6e67b965172" title="process_restart_toget\l_radiation" alt="" coords="937,1299,1084,1346"/><area shape="rect" id="node91" href="../../d2/d72/phys_8tools_8rad_8c.html#a64226cb28f52020ffe18ac6c6b1a2f5c" title="Input: start with pin [with fluid in whichvel velocity and whichcoordfluid coordinates (PRIMECOORDS o..." alt="" coords="945,1369,1076,1415"/><area shape="rect" id="node93" href="../../de/d51/bounds_8c.html#a3bc773d499b145705bdc23125b963840" title="Koral specific physical boundary conditions." alt="" coords="1415,1195,1615,1224"/><area shape="rect" id="node180" href="../../de/d51/bounds_8c.html#a09a080d9895db7b800a3824cb3fac9f1" title="X1 lower for beam injection to create shadow." alt="" coords="1435,1248,1595,1277"/><area shape="rect" id="node183" href="../../de/d51/bounds_8c.html#a3ee134cc5fb18752265c16a20dbdfb63" title="X3 lower for radiation beam injection." alt="" coords="1417,1301,1612,1331"/><area shape="rect" id="node186" href="../../de/d51/bounds_8c.html#a8300ddf3ae6a3866234cc0e9c12f26dc" title="X1 upper for inflow." alt="" coords="1421,1355,1608,1384"/><area shape="rect" id="node189" href="../../de/d51/bounds_8c.html#a01088f65c7a4cfa2ebfed202f815b951" title="X1 lower and upper for RADATM." alt="" coords="1429,1408,1600,1437"/><area shape="rect" id="node192" href="../../de/d51/bounds_8c.html#a1382959a7b699ea5d224168612504263" title="X1 upper for inflow." alt="" coords="1441,1461,1588,1491"/><area shape="rect" id="node195" href="../../de/d51/bounds_8c.html#ac15824bc610943cb7e02112e77b94752" title="on&#45;grid bounding" alt="" coords="1200,1505,1299,1535"/><area shape="rect" id="node198" href="../../de/d51/bounds_8c.html#a42658c4ecf3c6edb958394eb65a9ac2b" title="RADNT." alt="" coords="1203,1559,1296,1588"/><area shape="rect" id="node201" href="../../de/d51/bounds_8c.html#a3e4008fd24427b2e91d0ae5882b9536a" title="X1 upper for RADCYLBEAM." alt="" coords="1167,1612,1332,1641"/><area shape="rect" id="node204" href="../../de/d51/bounds_8c.html#ac32c1a20138382904dc5f1c66778ad8b" title="X1 upper for RADCYLJET." alt="" coords="1176,1665,1323,1695"/><area shape="rect" id="node207" href="../../de/d51/bounds_8c.html#a635fbaba3d6d6afcf5f34bbb2c278737" title="X2 upper for radiation beam injection." alt="" coords="1135,1092,1364,1121"/><area shape="rect" id="node210" href="../../de/d51/bounds_8c.html#a9f1df4e461f3f776bf3cb80e36a4d6df" title="get_radcylbeamcart" alt="" coords="1181,1145,1317,1175"/><area shape="rect" id="node95" href="../../de/d51/bounds_8c.html#a34ac3f1ca7b0f3a21053c633da9931a9" title="user boundary routine" alt="" coords="1664,1384,1835,1413"/><area shape="rect" id="node97" href="../../d4/dad/bounds_8funcdeclare_8h.html#a4bc7413b2cdb89e070f38bbb689ae555" title="bound_prim_user_dir" alt="" coords="1905,1359,2047,1388"/><area shape="rect" id="node169" href="../../d4/dad/bounds_8funcdeclare_8h.html#a2fbddc9ff8fc706bafa80c39695c7262" title="assume single user function takes care of primitive locations" alt="" coords="1901,1585,2051,1615"/><area shape="rect" id="node99" href="../../d9/de0/step__ch_8c.html#adbe0e3ba8a74f09ab928a96bd68cab6d" title="bound any prim type CALLS directly real and MPI boundary functions pstag = pstagglobal ucons = unewgl..." alt="" coords="2125,1347,2235,1376"/><area shape="rect" id="node101" href="../../d9/de0/step__ch_8c.html#a689fddc1949b1a1d390b59d10d17d83c" title="normal full bounding during evolution NOTEMARK: Was previously also bounding pstag here..." alt="" coords="2309,1293,2435,1323"/><area shape="rect" id="node105" href="../../d9/de0/step__ch_8c.html#a4079244d85c301885c1363ca41502869" title="simple bounding during evolution NOTEMARK: Was previously also bounding pstag here, but not necessary since done by calling bound_pstag in fluxctstag.c" alt="" coords="2291,1347,2453,1376"/><area shape="rect" id="node108" href="../../d9/de0/step__ch_8c.html#addca75a18cc861326a321565a2e81aa0" title="normal bounding of non&#45;staggered primitives" alt="" coords="2328,1168,2416,1197"/><area shape="rect" id="node163" href="../../d9/de0/step__ch_8c.html#a460b84e1112e3aef17209c20e22e1cf1" title="bound all prims" alt="" coords="2764,1711,2887,1740"/><area shape="rect" id="node110" href="../../dc/dae/flux_8c.html#aef355ccd1ca2295b84ad2fe1fc011d35" title="normal interpolation of CENT quantities to FACE quantities sets global variables pl_ct and pr_ct to p..." alt="" coords="2501,741,2680,771"/><area shape="rect" id="node122" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aecb3f613a7cb3bbb42fff2dbee5d65a1" title="This vpot2field function is for staggered method to evolve quasi&#45;deaveraged fields (i..." alt="" coords="3199,1396,3364,1425"/><area shape="rect" id="node124" href="../../de/db2/initbase_8funcdeclare_8h.html#ae6b2ad4cd0debf5b89ba8a9e471d6977" title="assumes normal field p pleft used as temp var if FLUXB==FLUXCTSTAG assigns conserved field in UEVOLVE..." alt="" coords="3440,1396,3517,1425"/><area shape="rect" id="node133" href="../../d0/dde/fluxctstag_8c.html#a4e3d76c6ad125b8199948408c262e3a1" title="wrapper for: 1) interpolate FACE 2 CORN 2) loop over dimensions setting field flux dimension&#45;by&#45;dimen..." alt="" coords="2995,928,3125,957"/><area shape="rect" id="node136" href="../../d0/dde/fluxctstag_8c.html#a2dd789bf1402bef72523cdb69e85806e" title="use global pbcorninterp and pvcorninterp at CORN1,2,3 to obtain EMFs at CORN1,2,3 NO interpolation of..." alt="" coords="2760,1005,2891,1051"/><area shape="rect" id="node139" href="../../d0/dde/fluxctstag_8c.html#aaec26a518629175ecceefbaf6c84225e" title="wrapper for continuous interpolation for FACE_to_CENT" alt="" coords="2504,1085,2677,1115"/><area shape="rect" id="node143" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aa31dd83c96936277334c62e2098dd51d" title="wrapper for taking staggered conserved field quantity and obtaining centered field quantity upoint en..." alt="" coords="2972,1143,3148,1172"/><area shape="rect" id="node152" href="../../d0/dde/fluxctstag_8c.html#a6cd90dff56319085b32bc57c0c8b3cfd" title="this function called in initbase.c and during advance() here ustag is point value if dimension doesn&#39;..." alt="" coords="2531,1141,2651,1171"/><area shape="rect" id="node155" href="../../d0/dde/fluxctstag_8c.html#ad6aa918442f7768dff3c099ba353ee64" title="slope_lim_face2corn() is provided p2interp and returns pleft/pright differs from slope_lim() by range..." alt="" coords="2520,901,2661,931"/><area shape="rect" id="node112" href="../../dc/dae/flux_8c.html#a2602a4dad9ed7adc944227d02435312e" title="standard (non&#45;field flux) calculation but setup to store results of interpolation so can be used for ..." alt="" coords="2728,481,2923,511"/><area shape="rect" id="node114" href="../../dc/dae/flux_8c.html#aaf6d832880760f80459d91477c28b519" title="wrapper for different standard 1&#45;D flux calculators 1&#45;D interpolate and get flux for that direction (..." alt="" coords="3003,481,3117,511"/><area shape="rect" id="node116" href="../../dc/dae/flux_8c.html#a8ffa7399bd5354fdcdec5f3e1adf0b13" title="wrapper for CENT_to_FACE1,2,3 used to compute flux at face" alt="" coords="3235,505,3328,535"/><area shape="rect" id="node118" href="../../d5/d2f/flux_8funcdeclare_8h.html#ab229b0f3f2caf3c0a3ef5299fba2b1c0" title="see fluxcompute.c for non&#45;computer science, real physics calculations of flux" alt="" coords="3445,736,3512,765"/><area shape="rect" id="node126" href="../../df/d15/init_8tools_8c.html#a3750bc790613bc6c8c805af0f1b839c8" title="user1_init_vpot2field_user" alt="" coords="3592,1408,3765,1437"/><area shape="rect" id="node128" href="../../de/db2/initbase_8funcdeclare_8h.html#afda44281ad5c163455c40f012d4a8954" title="init_vpot2field_user" alt="" coords="3815,1421,3948,1451"/><area shape="rect" id="node130" href="../../de/db2/initbase_8funcdeclare_8h.html#a90699a18ede8b7f112c0078512804ec1" title="initialize vector potential given user function assumes normal non&#45;staggered field in pr Notice that ..." alt="" coords="4031,1431,4100,1460"/><area shape="rect" id="node141" href="../../d0/dde/fluxctstag_8c.html#a5e3dcbe89d6f8a9384cafb58afd7dbf4" title="interpolates field at FACE to field at CENT assuming field along itself is continuous" alt="" coords="2765,1074,2885,1121"/><area shape="rect" id="node147" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aaa24493002bc8c0a527b1ea2ac2dddbf" title="convert conservative U to stag point P and CENT point U and CENT point primitive" alt="" coords="3215,1292,3348,1321"/><area shape="rect" id="node157" href="../../d0/dde/fluxctstag_8c.html#a985ee116306b4011810334ae93900493" title="INPUTS: Nvec, pr, primface_l[dir], primface_r[dir] OUTPUTS: pbcorn[dir][side], pvcorn[dir][side][side..." alt="" coords="2736,901,2915,931"/><area shape="rect" id="node165" href="../../d9/de0/step__ch_8c.html#a91fe5c4370e3292a19e7f794797a407f" title="normal bounding of all primitives" alt="" coords="4015,1717,4116,1747"/><area shape="rect" id="node171" href="../../d9/de0/step__ch_8c.html#abdea68b778dc9253324da69d3c376965" title="bound any pstag type CALLS directly real and MPI boundary functions pstag is at FACE1,2,3 for fields, so user bound is different MPI bounding is the same as CENT quantities used when restarting in initbase.c to bound unewglobal for FLUXB==FLUXCTSTAG" alt="" coords="2532,1705,2649,1735"/><area shape="rect" id="node174" href="../../d9/de0/step__ch_8c.html#a6f4b963a50a7288964f01775f2f18bb9" title="normal bounding of staggered primitives" alt="" coords="2777,1556,2873,1585"/><area shape="rect" id="node177" href="../../d0/dde/fluxctstag_8c.html#aa169cb1999412f2e2460012cc5d7a804" title="pure DONOR version: upoint is input staggered updated field that needs to be converted to pstag and t..." alt="" coords="2972,1549,3148,1595"/><area shape="rect" id="node212" href="../../de/d51/bounds_8c.html#a16398a5325a9df48783423f00ba65bb7" title="all boundaries for RADCYLBEAMCART" alt="" coords="1439,1141,1591,1171"/><area shape="rect" id="node217" href="../../d2/d72/phys_8tools_8rad_8c.html#a69289f92f5afd222ade67c4e9c60285a" title="get contravariant relative 4&#45;velocity in lab frame" alt="" coords="707,1144,869,1173"/><area shape="rect" id="node224" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a8db9dc7c7f52d6fcb405a74e519db5cf" title="there may be something wrong with this function  didn&#39;t work in TIMEORDER==4, had to do standard met..." alt="" coords="1204,573,1295,603"/><area shape="rect" id="node230" href="../../d2/d72/phys_8tools_8rad_8c.html#abd01208ba3c5754ea5587bcaefcaa01b" title="get lab&#45;frame 3&#45;velocity for radiative emission in radiative frame" alt="" coords="957,469,1064,499"/><area shape="rect" id="node255" href="../../d2/dd4/wavespeeds_8funcdeclare_8h.html#adba6a1e320ad60ae452a4ff6f8ba6e25" title="Charles believed that near polar axis one should set vmax=vmin=0, but not right since makes flux comp..." alt="" coords="1223,365,1276,395"/><area shape="rect" id="node232" href="../../d2/d72/phys_8tools_8rad_8c.html#a56f468401f08e66966f0318198ca6e85" title="compute radiative characteristics as limited by opacity" alt="" coords="1211,419,1288,448"/><area shape="rect" id="node234" href="../../d2/dd4/wavespeeds_8funcdeclare_8h.html#abb81988bde678c59afc5d006cf76b835" title="vchar_each" alt="" coords="1471,419,1559,448"/><area shape="rect" id="node236" href="../../d2/dd4/wavespeeds_8funcdeclare_8h.html#a119027341f97d571212ad74c5ddc94b4" title="get wave speeds for flux calculation and for dt calculation" alt="" coords="1712,696,1787,725"/><area shape="rect" id="node249" href="../../d2/dd4/wavespeeds_8funcdeclare_8h.html#a75426b1b9bf1a293c60d108c63b0322d" title="store wavespeeds somewhere" alt="" coords="1669,472,1829,501"/><area shape="rect" id="node242" href="../../d3/ddc/phys_8funcdeclare_8h.html#a0bb12b388b07610cf01d08c19f8fddb1" title="actually compute the flux and ctop for dt calculation" alt="" coords="1901,320,2051,349"/><area shape="rect" id="node244" href="../../dc/dae/flux_8c.html#a054658527dfb1d80226b8b2d2106aeed" title="original flux calculator that gets F in &quot;dir&quot;. At end global pleft,pright,dq also set and if STOREWAV..." alt="" coords="2119,429,2241,459"/><area shape="rect" id="node251" href="../../d2/dd4/wavespeeds_8funcdeclare_8h.html#acb4a2a3be68517862cdcf097ff51af37" title="complete storage of wave speeds per dimension only called for STOREWAVESPEEDS==1" alt="" coords="1884,472,2068,501"/><area shape="rect" id="node264" href="../../d1/d3e/utoprimgen_8c.html#a0a83e9e7fdd3cc595c5b8d0df88ec684" title="just picks the algorithm to invert" alt="" coords="728,472,848,501"/><area shape="rect" id="node273" href="../../d3/ddc/phys_8funcdeclare_8h.html#a92cd9cc63c782c0d94699d639aa48f69" title="wrapper for choosing to get state by computing it or from global array notice that ptrgeom&#45;&gt;p inputte..." alt="" coords="1447,261,1583,291"/><area shape="rect" id="node275" href="../../dc/d5e/fluxcompute_8c.html#ab088a2ff1d1132363446aab47e5c9c7b" title="P&#45;&gt;sate,flux,U." alt="" coords="1699,261,1800,291"/><area shape="rect" id="node279" href="../../dc/d5e/fluxcompute_8c.html#a9fdd8e08eb928fb500db9e2688f1475b" title="p2SFUevolveall" alt="" coords="1692,315,1807,344"/><area shape="rect" id="node285" href="../../d3/ddc/phys_8funcdeclare_8h.html#a035303dc3a9c5826bd56fdc2996fb2a3" title="wrapper for choosing to get state by computing it or from global array pointer assign (overrides the ..." alt="" coords="3413,224,3544,253"/><area shape="rect" id="node291" href="../../d3/ddc/phys_8funcdeclare_8h.html#a7c83a4e2d3fdf30054e2462d7b3a88f0" title="wrapper for choosing to get state by computing it or from global array pointer assign (overrides the ..." alt="" coords="493,1820,635,1849"/><area shape="rect" id="node293" href="../../d8/d29/interpline_8c.html#a77526a5c5b89294821d25d493f21eb57" title="determine shock indicator (used for both c2e and other routines, only operates on quantities with NPR..." alt="" coords="961,1873,1060,1903"/><area shape="rect" id="node303" href="../../d8/d29/interpline_8c.html#a86547c640e11a0b2c6666f2661ac5d6d" title="returns the improved pressure jump indicators" alt="" coords="715,1820,861,1849"/><area shape="rect" id="node295" href="../../d8/d29/interpline_8c.html#ac0108e09712d4ba63a94800f9f007ea2" title="interior of main SUPERGENLOOP() inside slope_lim_linetype_c2e()" alt="" coords="1185,1838,1313,1885"/><area shape="rect" id="node299" href="../../d8/d29/interpline_8c.html#a016b471d950e6b0dad945e9a064a506b" title="inside of SUPERGENLOOP() in slope_lim_linetype()" alt="" coords="1185,1907,1313,1954"/><area shape="rect" id="node297" href="../../d8/d29/interpline_8c.html#af01fe38edb6f0dd4a67e7bcb2db70d48" title="very similar to slope_lim_linetype, but different number of quantities to handle" alt="" coords="1436,1812,1593,1841"/><area shape="rect" id="node301" href="../../d8/d29/interpline_8c.html#aabe389c926d3f8600911f2ffa6d645e4" title="linetype assumed to return pleft/pright directly since linetype&#39;s are usually higher order this funct..." alt="" coords="1451,1916,1579,1945"/><area shape="rect" id="node305" href="../../d8/d29/interpline_8c.html#a3d874481fe13ed640058992d96cf0df1" title="interior _perijk() functions:" alt="" coords="939,1820,1083,1849"/><area shape="rect" id="node307" href="../../d8/d29/interpline_8c.html#a9614310c18cd4bc4fce55ea5964382d5" title="interior of main SUPERGENLOOP() inside slope_lim_linetype_c2e()" alt="" coords="1140,1769,1359,1815"/><area shape="rect" id="node314" href="../../d3/ddc/phys_8funcdeclare_8h.html#af560087e095f9677ac65b1bc6b424fa9" title="wrapper for choosing to get state by computing it or from global array pointer assign (overrides the ..." alt="" coords="689,365,887,395"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a689a0d22ad988934812b24448f9f8e91"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_stateforcheckinversion </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>geom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *&#160;</td>
          <td class="paramname"><em>q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>used to check inversion, which has consistent pressure used to get things as functions of  instead of u in case of using jon's inversion </p>

<p>Definition at line <a class="el" href="../../d7/def/phys_8tools_8c_source.html#l01952">1952</a> of file <a class="el" href="../../d7/def/phys_8tools_8c_source.html">phys.tools.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_a689a0d22ad988934812b24448f9f8e91_cgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_a689a0d22ad988934812b24448f9f8e91_cgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_a689a0d22ad988934812b24448f9f8e91_cgraph" id="d3/ddc/phys_8funcdeclare_8h_a689a0d22ad988934812b24448f9f8e91_cgraph">
<area shape="rect" id="node3" href="../../d3/ddc/phys_8funcdeclare_8h.html#a12a473e24b431762af4168179e82cd08" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="251,5,413,35"/><area shape="rect" id="node5" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a8a762bf6582e6f7e1199de9c43b98454" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="233,59,431,88"/><area shape="rect" id="node7" href="../../d7/def/phys_8tools_8c.html#a9ef494ab2cecf6ba0072977dd46a3d25" title="separate function for getting thermodynamical quantities" alt="" coords="243,111,421,158"/><area shape="rect" id="node19" href="../../d3/ddc/phys_8funcdeclare_8h.html#a41b8eacac0a4a23d6b00b670fe49629c" title="bsq_calc_fromq" alt="" coords="275,181,389,211"/><area shape="rect" id="node9" href="../../d2/d0e/eos_8funcdeclare_8h.html#a1a12a4567087d4cb4b4f7279027b8827" title="wrapper [assumed not called by utoprim_jon.c that could change EOS type] used for inversion check..." alt="" coords="501,81,664,127"/><area shape="rect" id="node13" href="../../d2/d0e/eos_8funcdeclare_8h.html#ac6eb963661a1399f6a71f33e3a920a5b" title="entropy wrapper this function should NOT be called by utoprim_jon.c inversion" alt="" coords="480,151,685,180"/><area shape="rect" id="node11" href="../../d8/d67/eos_8c.html#a62fa304d208e1263d8d681524057a723" title="p(rho0, u) (needed to get initial guess for W)" alt="" coords="759,89,876,119"/><area shape="rect" id="node15" href="../../d2/d0e/eos_8funcdeclare_8h.html#a6e43546483f8fc91354442cacd5071e0" title="wrapper this function should NOT be called by utoprim_jon.c inversion" alt="" coords="735,142,900,189"/><area shape="rect" id="node17" href="../../d8/d67/eos_8c.html#aef4f2a239ab2ba6c9471a5e9b45f55dd" title="specific entropy as function of rho0 and internal energy (wmrho0) specificS(rho0,wmrho0)" alt="" coords="951,142,1116,189"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a92cd9cc63c782c0d94699d639aa48f69"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_stateforfluxcalc </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dimen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>isleftright</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>ptrgeom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> **&#160;</td>
          <td class="paramname"><em>qptr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>wrapper for choosing to get state by computing it or from global array notice that ptrgeom-&gt;p inputted not used </p>

<p>Definition at line <a class="el" href="../../de/d8c/phys_8c_source.html#l00027">27</a> of file <a class="el" href="../../de/d8c/phys_8c_source.html">phys.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_a92cd9cc63c782c0d94699d639aa48f69_cgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_a92cd9cc63c782c0d94699d639aa48f69_cgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_a92cd9cc63c782c0d94699d639aa48f69_cgraph" id="d3/ddc/phys_8funcdeclare_8h_a92cd9cc63c782c0d94699d639aa48f69_cgraph">
<area shape="rect" id="node3" href="../../d7/def/phys_8tools_8c.html#adf1cf36a7c564b77dca08d26ce233df7" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="191,112,351,141"/><area shape="rect" id="node5" href="../../d3/ddc/phys_8funcdeclare_8h.html#a12a473e24b431762af4168179e82cd08" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="419,5,581,35"/><area shape="rect" id="node7" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a8a762bf6582e6f7e1199de9c43b98454" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="401,59,599,88"/><area shape="rect" id="node9" href="../../d3/ddc/phys_8funcdeclare_8h.html#a41b8eacac0a4a23d6b00b670fe49629c" title="bsq_calc_fromq" alt="" coords="443,112,557,141"/><area shape="rect" id="node11" href="../../d7/def/phys_8tools_8c.html#a8db4cb0eaaedfc1b0f3d5791d5052068" title="separate function for getting primitives" alt="" coords="443,165,557,195"/><area shape="rect" id="node13" href="../../d7/def/phys_8tools_8c.html#ab23ee4012c46b45e96ebffcf5766b0bb" title="separate function for getting geometry" alt="" coords="443,219,557,248"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_a92cd9cc63c782c0d94699d639aa48f69_icgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_a92cd9cc63c782c0d94699d639aa48f69_icgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_a92cd9cc63c782c0d94699d639aa48f69_icgraph" id="d3/ddc/phys_8funcdeclare_8h_a92cd9cc63c782c0d94699d639aa48f69_icgraph">
<area shape="rect" id="node3" href="../../dc/d5e/fluxcompute_8c.html#ab088a2ff1d1132363446aab47e5c9c7b" title="P&#45;&gt;sate,flux,U." alt="" coords="196,20,297,49"/><area shape="rect" id="node36" href="../../dc/d5e/fluxcompute_8c.html#a9fdd8e08eb928fb500db9e2688f1475b" title="p2SFUevolveall" alt="" coords="189,73,304,103"/><area shape="rect" id="node39" href="../../d0/dde/fluxctstag_8c.html#a985ee116306b4011810334ae93900493" title="INPUTS: Nvec, pr, primface_l[dir], primface_r[dir] OUTPUTS: pbcorn[dir][side], pvcorn[dir][side][side..." alt="" coords="352,157,531,187"/><area shape="rect" id="node5" href="../../dc/dae/flux_8c.html#aa26f8747446e1cd5bd214ebc345aafa2" title="compute donor&#45;based flux, bypassing normal fluxcalc()." alt="" coords="623,5,729,35"/><area shape="rect" id="node9" href="../../d3/ddc/phys_8funcdeclare_8h.html#a0bb12b388b07610cf01d08c19f8fddb1" title="actually compute the flux and ctop for dt calculation" alt="" coords="367,59,516,88"/><area shape="rect" id="node7" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="1260,16,1415,45"/><area shape="rect" id="node11" href="../../dc/dae/flux_8c.html#a054658527dfb1d80226b8b2d2106aeed" title="original flux calculator that gets F in &quot;dir&quot;. At end global pleft,pright,dq also set and if STOREWAV..." alt="" coords="615,59,737,88"/><area shape="rect" id="node32" href="../../dc/dae/flux_8c.html#a2602a4dad9ed7adc944227d02435312e" title="standard (non&#45;field flux) calculation but setup to store results of interpolation so can be used for ..." alt="" coords="579,112,773,141"/><area shape="rect" id="node13" href="../../dc/dae/flux_8c.html#aaf6d832880760f80459d91477c28b519" title="wrapper for different standard 1&#45;D flux calculators 1&#45;D interpolate and get flux for that direction (..." alt="" coords="829,72,944,101"/><area shape="rect" id="node15" href="../../dc/dae/flux_8c.html#a8ffa7399bd5354fdcdec5f3e1adf0b13" title="wrapper for CENT_to_FACE1,2,3 used to compute flux at face" alt="" coords="1001,72,1095,101"/><area shape="rect" id="node17" href="../../d5/d2f/flux_8funcdeclare_8h.html#ab229b0f3f2caf3c0a3ef5299fba2b1c0" title="see fluxcompute.c for non&#45;computer science, real physics calculations of flux" alt="" coords="1144,72,1211,101"/><area shape="rect" id="node19" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="1273,72,1401,101"/><area shape="rect" id="node21" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="1465,72,1535,101"/><area shape="rect" id="node23" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="1585,72,1719,101"/><area shape="rect" id="node25" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="1769,72,1836,101"/><area shape="rect" id="node27" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="1887,72,1977,101"/><area shape="rect" id="node29" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="2027,72,2077,101"/><area shape="rect" id="node41" href="../../d0/dde/fluxctstag_8c.html#a4e3d76c6ad125b8199948408c262e3a1" title="wrapper for: 1) interpolate FACE 2 CORN 2) loop over dimensions setting field flux dimension&#45;by&#45;dimen..." alt="" coords="821,139,952,168"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af560087e095f9677ac65b1bc6b424fa9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_stateforglobalwavespeeds </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>ptrgeom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> **&#160;</td>
          <td class="paramname"><em>qptr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>wrapper for choosing to get state by computing it or from global array pointer assign (overrides the existing default assignment of the pointer address in the calling function, so assumes calling function only uses pointer form subsequently) </p>

<p>Definition at line <a class="el" href="../../de/d8c/phys_8c_source.html#l00110">110</a> of file <a class="el" href="../../de/d8c/phys_8c_source.html">phys.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_af560087e095f9677ac65b1bc6b424fa9_cgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_af560087e095f9677ac65b1bc6b424fa9_cgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_af560087e095f9677ac65b1bc6b424fa9_cgraph" id="d3/ddc/phys_8funcdeclare_8h_af560087e095f9677ac65b1bc6b424fa9_cgraph">
<area shape="rect" id="node3" href="../../d7/def/phys_8tools_8c.html#a3ef47960a272ef981fd551582b610503" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="255,59,476,88"/><area shape="rect" id="node5" href="../../d3/ddc/phys_8funcdeclare_8h.html#a12a473e24b431762af4168179e82cd08" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="544,5,707,35"/><area shape="rect" id="node7" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a8a762bf6582e6f7e1199de9c43b98454" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="527,59,724,88"/><area shape="rect" id="node9" href="../../d3/ddc/phys_8funcdeclare_8h.html#a41b8eacac0a4a23d6b00b670fe49629c" title="bsq_calc_fromq" alt="" coords="568,112,683,141"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_af560087e095f9677ac65b1bc6b424fa9_icgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_af560087e095f9677ac65b1bc6b424fa9_icgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_af560087e095f9677ac65b1bc6b424fa9_icgraph" id="d3/ddc/phys_8funcdeclare_8h_af560087e095f9677ac65b1bc6b424fa9_icgraph">
<area shape="rect" id="node3" href="../../d2/dd4/wavespeeds_8funcdeclare_8h.html#a75426b1b9bf1a293c60d108c63b0322d" title="store wavespeeds somewhere" alt="" coords="255,32,415,61"/><area shape="rect" id="node5" href="../../d2/dd4/wavespeeds_8funcdeclare_8h.html#acb4a2a3be68517862cdcf097ff51af37" title="complete storage of wave speeds per dimension only called for STOREWAVESPEEDS==1" alt="" coords="465,32,649,61"/><area shape="rect" id="node7" href="../../dc/dae/flux_8c.html#a054658527dfb1d80226b8b2d2106aeed" title="original flux calculator that gets F in &quot;dir&quot;. At end global pleft,pright,dq also set and if STOREWAV..." alt="" coords="735,5,857,35"/><area shape="rect" id="node29" href="../../dc/dae/flux_8c.html#a2602a4dad9ed7adc944227d02435312e" title="standard (non&#45;field flux) calculation but setup to store results of interpolation so can be used for ..." alt="" coords="699,59,893,88"/><area shape="rect" id="node9" href="../../dc/dae/flux_8c.html#aaf6d832880760f80459d91477c28b519" title="wrapper for different standard 1&#45;D flux calculators 1&#45;D interpolate and get flux for that direction (..." alt="" coords="943,32,1057,61"/><area shape="rect" id="node11" href="../../dc/dae/flux_8c.html#a8ffa7399bd5354fdcdec5f3e1adf0b13" title="wrapper for CENT_to_FACE1,2,3 used to compute flux at face" alt="" coords="1108,32,1201,61"/><area shape="rect" id="node13" href="../../d5/d2f/flux_8funcdeclare_8h.html#ab229b0f3f2caf3c0a3ef5299fba2b1c0" title="see fluxcompute.c for non&#45;computer science, real physics calculations of flux" alt="" coords="1251,32,1317,61"/><area shape="rect" id="node15" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="1380,5,1508,35"/><area shape="rect" id="node27" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="1367,59,1521,88"/><area shape="rect" id="node17" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="1572,5,1641,35"/><area shape="rect" id="node19" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="1692,5,1825,35"/><area shape="rect" id="node21" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="1876,5,1943,35"/><area shape="rect" id="node23" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="1993,5,2084,35"/><area shape="rect" id="node25" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="2133,5,2184,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7c83a4e2d3fdf30054e2462d7b3a88f0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_stateforinterpline </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>ptrgeom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> **&#160;</td>
          <td class="paramname"><em>qptr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>wrapper for choosing to get state by computing it or from global array pointer assign (overrides the existing default assignment of the pointer address in the calling function, so assumes calling function only uses pointer form subsequently) </p>

<p>Definition at line <a class="el" href="../../de/d8c/phys_8c_source.html#l00082">82</a> of file <a class="el" href="../../de/d8c/phys_8c_source.html">phys.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_a7c83a4e2d3fdf30054e2462d7b3a88f0_cgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_a7c83a4e2d3fdf30054e2462d7b3a88f0_cgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_a7c83a4e2d3fdf30054e2462d7b3a88f0_cgraph" id="d3/ddc/phys_8funcdeclare_8h_a7c83a4e2d3fdf30054e2462d7b3a88f0_cgraph">
<area shape="rect" id="node3" href="../../d7/def/phys_8tools_8c.html#a932c3d0ede37a07f6d380cf6ce07e0b0" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="197,59,365,88"/><area shape="rect" id="node5" href="../../d3/ddc/phys_8funcdeclare_8h.html#a12a473e24b431762af4168179e82cd08" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="432,5,595,35"/><area shape="rect" id="node7" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a8a762bf6582e6f7e1199de9c43b98454" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="415,59,612,88"/><area shape="rect" id="node9" href="../../d3/ddc/phys_8funcdeclare_8h.html#a41b8eacac0a4a23d6b00b670fe49629c" title="bsq_calc_fromq" alt="" coords="456,112,571,141"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_a7c83a4e2d3fdf30054e2462d7b3a88f0_icgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_a7c83a4e2d3fdf30054e2462d7b3a88f0_icgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_a7c83a4e2d3fdf30054e2462d7b3a88f0_icgraph" id="d3/ddc/phys_8funcdeclare_8h_a7c83a4e2d3fdf30054e2462d7b3a88f0_icgraph">
<area shape="rect" id="node3" href="../../d8/d29/interpline_8c.html#a77526a5c5b89294821d25d493f21eb57" title="determine shock indicator (used for both c2e and other routines, only operates on quantities with NPR..." alt="" coords="417,29,516,59"/><area shape="rect" id="node13" href="../../d8/d29/interpline_8c.html#a86547c640e11a0b2c6666f2661ac5d6d" title="returns the improved pressure jump indicators" alt="" coords="199,83,345,112"/><area shape="rect" id="node5" href="../../d8/d29/interpline_8c.html#ac0108e09712d4ba63a94800f9f007ea2" title="interior of main SUPERGENLOOP() inside slope_lim_linetype_c2e()" alt="" coords="632,74,760,121"/><area shape="rect" id="node9" href="../../d8/d29/interpline_8c.html#a016b471d950e6b0dad945e9a064a506b" title="inside of SUPERGENLOOP() in slope_lim_linetype()" alt="" coords="632,5,760,51"/><area shape="rect" id="node7" href="../../d8/d29/interpline_8c.html#af01fe38edb6f0dd4a67e7bcb2db70d48" title="very similar to slope_lim_linetype, but different number of quantities to handle" alt="" coords="853,117,1011,147"/><area shape="rect" id="node11" href="../../d8/d29/interpline_8c.html#aabe389c926d3f8600911f2ffa6d645e4" title="linetype assumed to return pleft/pright directly since linetype&#39;s are usually higher order this funct..." alt="" coords="868,13,996,43"/><area shape="rect" id="node15" href="../../d8/d29/interpline_8c.html#a3d874481fe13ed640058992d96cf0df1" title="interior _perijk() functions:" alt="" coords="395,83,539,112"/><area shape="rect" id="node17" href="../../d8/d29/interpline_8c.html#a9614310c18cd4bc4fce55ea5964382d5" title="interior of main SUPERGENLOOP() inside slope_lim_linetype_c2e()" alt="" coords="587,143,805,190"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a035303dc3a9c5826bd56fdc2996fb2a3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_stateforsource </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>ptrgeom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> **&#160;</td>
          <td class="paramname"><em>q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>wrapper for choosing to get state by computing it or from global array pointer assign (overrides the existing default assignment of the pointer address in the calling function, so assumes calling function only uses pointer form subsequently) </p>

<p>Definition at line <a class="el" href="../../de/d8c/phys_8c_source.html#l00057">57</a> of file <a class="el" href="../../de/d8c/phys_8c_source.html">phys.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_a035303dc3a9c5826bd56fdc2996fb2a3_cgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_a035303dc3a9c5826bd56fdc2996fb2a3_cgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_a035303dc3a9c5826bd56fdc2996fb2a3_cgraph" id="d3/ddc/phys_8funcdeclare_8h_a035303dc3a9c5826bd56fdc2996fb2a3_cgraph">
<area shape="rect" id="node3" href="../../d7/def/phys_8tools_8c.html#a39e973bfdc6ccf9e82b33925e073fca3" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="184,59,339,88"/><area shape="rect" id="node5" href="../../d3/ddc/phys_8funcdeclare_8h.html#a12a473e24b431762af4168179e82cd08" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="405,5,568,35"/><area shape="rect" id="node7" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a8a762bf6582e6f7e1199de9c43b98454" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="388,59,585,88"/><area shape="rect" id="node9" href="../../d3/ddc/phys_8funcdeclare_8h.html#a41b8eacac0a4a23d6b00b670fe49629c" title="bsq_calc_fromq" alt="" coords="429,112,544,141"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_a035303dc3a9c5826bd56fdc2996fb2a3_icgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_a035303dc3a9c5826bd56fdc2996fb2a3_icgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_a035303dc3a9c5826bd56fdc2996fb2a3_icgraph" id="d3/ddc/phys_8funcdeclare_8h_a035303dc3a9c5826bd56fdc2996fb2a3_icgraph">
<area shape="rect" id="node3" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="199,5,327,35"/><area shape="rect" id="node15" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="185,59,340,88"/><area shape="rect" id="node5" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="391,5,460,35"/><area shape="rect" id="node7" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="511,5,644,35"/><area shape="rect" id="node9" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="695,5,761,35"/><area shape="rect" id="node11" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="812,5,903,35"/><area shape="rect" id="node13" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="952,5,1003,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aea709ca8b25507c5556269e051cd42b2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> lc4 </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>updown</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td>
          <td class="paramname"><em>detg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>kappa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lambda</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>used Mathematica's MinimumChangePermutations and Signature updown = 0 : down updown = 1 : up </p>

<p>Definition at line <a class="el" href="../../d7/def/phys_8tools_8c_source.html#l02873">2873</a> of file <a class="el" href="../../d7/def/phys_8tools_8c_source.html">phys.tools.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_aea709ca8b25507c5556269e051cd42b2_icgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_aea709ca8b25507c5556269e051cd42b2_icgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_aea709ca8b25507c5556269e051cd42b2_icgraph" id="d3/ddc/phys_8funcdeclare_8h_aea709ca8b25507c5556269e051cd42b2_icgraph">
<area shape="rect" id="node3" href="../../d7/def/phys_8tools_8c.html#a2568131c22f54019d6ae406ef7326066" title="Compute faraday assumes b and u are inputted as bcov&amp;ucov for F^{} and bcon&amp;ucon for F_{}..." alt="" coords="93,5,189,35"/><area shape="rect" id="node20" href="../../d7/def/phys_8tools_8c.html#a28755339b39b6648471eb4324cc877d8" title="Maxwell to Faraday which=0 : Mcon &#45;&gt; Fcov (for clean Mcon, Fcov has ) which=1 : Mcov &#45;&gt; Fcon (for cle..." alt="" coords="116,59,167,88"/><area shape="rect" id="node5" href="../../d8/d60/init_8c.html#af3b64278d50c2ff0fee80291fbd38dab" title="fieldprim" alt="" coords="239,32,308,61"/><area shape="rect" id="node7" href="../../df/d15/init_8tools_8c.html#acefd26944dbbb1c289886f520f6befac" title="init_dsandvels" alt="" coords="359,5,463,35"/><area shape="rect" id="node17" href="../../de/db2/initbase_8funcdeclare_8h.html#a4e121b9448ac1adaa7608206369f9ea5" title="init_postvpot" alt="" coords="363,59,459,88"/><area shape="rect" id="node9" href="../../df/d15/init_8tools_8c.html#a77551ab2581efdbaf170dfca073ff9ab" title="user1_init_primitives" alt="" coords="512,32,653,61"/><area shape="rect" id="node11" href="../../de/db2/initbase_8funcdeclare_8h.html#a0afa200a5f947b1c9f6e554519f28fc4" title="init_primitives" alt="" coords="703,32,804,61"/><area shape="rect" id="node13" href="../../de/df8/initbase_8c.html#ac4110398e386c9888d9565630357dbbe" title="General&#45;Primary init() routine Uses globals inside init() because sets memory and sets physics..." alt="" coords="855,32,892,61"/><area shape="rect" id="node15" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="941,32,992,61"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a19e08c0d7e5a7c9fb9d97ff5ffab053c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int primtoflux </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>returntype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>geom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>fl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>flabs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate fluxes in direction dir and conserved variable U returntype==0 : flux with geometric factor geom-&gt;e (used by evolution code) returntype==1 : flux with physical geometry factor geom-&gt;gdet (used by diagnostics) see UtoU and <a class="el" href="../../de/d8c/phys_8c.html#a44693eac289e90fab8a6792e6e9fb02c">source_conn()</a> Note that if MAXWELL==PRIMMAXWELL then primtoflux doesn't use b^ or b_ (bcon and bcov) </p>

<p>Definition at line <a class="el" href="../../d7/def/phys_8tools_8c_source.html#l00033">33</a> of file <a class="el" href="../../d7/def/phys_8tools_8c_source.html">phys.tools.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_a19e08c0d7e5a7c9fb9d97ff5ffab053c_cgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_a19e08c0d7e5a7c9fb9d97ff5ffab053c_cgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_a19e08c0d7e5a7c9fb9d97ff5ffab053c_cgraph" id="d3/ddc/phys_8funcdeclare_8h_a19e08c0d7e5a7c9fb9d97ff5ffab053c_cgraph">
<area shape="rect" id="node3" href="../../d7/def/phys_8tools_8c.html#ace478826bef11e98daed7dd2ab026c93" title="matter only terms (as if B=0)" alt="" coords="133,163,237,192"/><area shape="rect" id="node23" href="../../d7/def/phys_8tools_8c.html#a3c8277899afc2a48590156971490bb79" title="radiation terms (as if rho=u=p=0)" alt="" coords="133,296,237,325"/><area shape="rect" id="node28" href="../../d7/def/phys_8tools_8c.html#a664550c21e363870d26e73f3ab5b3d3c" title="electromagnetic terms (as if rho=u=p=0)" alt="" coords="133,376,237,405"/><area shape="rect" id="node5" href="../../d7/def/phys_8tools_8c.html#a133cabc36f68eda16f9245f749c3cc38" title="flux asociated with Ynu variable" alt="" coords="319,5,412,35"/><area shape="rect" id="node7" href="../../d7/def/phys_8tools_8c.html#a787551c0e83438fe9e63ecd3d996f61a" title="massflux_calc" alt="" coords="529,57,636,87"/><area shape="rect" id="node9" href="../../d7/def/phys_8tools_8c.html#a2ef51d65728fe59168e5b705165af6d4" title="flux associated with Y_L variable" alt="" coords="324,109,407,139"/><area shape="rect" id="node12" href="../../d7/def/phys_8tools_8c.html#a1e1dcf1d515232206c829a33d7e1192b" title="flux associated with Y_fl variable" alt="" coords="321,269,409,299"/><area shape="rect" id="node15" href="../../d7/def/phys_8tools_8c.html#a5717fa95303172fb697892a9232f0546" title="flux of specific entropy" alt="" coords="307,163,424,192"/><area shape="rect" id="node17" href="../../d7/def/phys_8tools_8c.html#a4886704a6724ea65ccaae2277b6ded74" title="MHD stress tensor, with first index up, second index down mhd^dir_j understood that mhddiagpress only..." alt="" coords="315,216,416,245"/><area shape="rect" id="node19" href="../../d7/def/phys_8tools_8c.html#ab3fd971df8ad09cce2462e78d7735f33" title="MHD stress tensor, with first index up, second index down." alt="" coords="524,189,641,219"/><area shape="rect" id="node21" href="../../d7/def/phys_8tools_8c.html#a44930b5d598885afcb717a270f42749f" title="MHD stress tensor, with first index up, second index down avoids catastrophic cancellation with rest&#45;..." alt="" coords="493,243,672,272"/><area shape="rect" id="node26" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a389bf7e41d2fd117af996e3392067cdc" title="compute radiation stres&#45;energy tensor assuming M1 closure" alt="" coords="315,323,416,352"/><area shape="rect" id="node30" href="../../d7/def/phys_8tools_8c.html#a3552b97ec9f1982094fbc3e3f9af7f05" title="MHD stress tensor, with first index up, second index down mhd^dir_j." alt="" coords="315,376,416,405"/><area shape="rect" id="node36" href="../../d7/def/phys_8tools_8c.html#a12b4ca77ffbef030f608b079327b4eb7" title="spatial part of dualfaraday" alt="" coords="287,429,444,459"/><area shape="rect" id="node32" href="../../d7/def/phys_8tools_8c.html#a3f6e052b84282b8db7b05a0acc435622" title="EM part of stress&#45;energy tensor." alt="" coords="524,323,641,352"/><area shape="rect" id="node34" href="../../d7/def/phys_8tools_8c.html#a864ca09eade159d4c4b545593c1095de" title="MHD stress tensor, with first index up, second index down avoids catastrophic cancellation with rest&#45;..." alt="" coords="504,376,661,405"/><area shape="rect" id="node38" href="../../d7/def/phys_8tools_8c.html#abc846df49f33c007310b52240e099e3b" title="Notation for HARM paper and JCM&#39;s GRFFE paper is that: B^ = &#160;*F^{} and for lab&#45;frame we chose ={&#45;1..." alt="" coords="515,429,651,459"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_a19e08c0d7e5a7c9fb9d97ff5ffab053c_icgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_a19e08c0d7e5a7c9fb9d97ff5ffab053c_icgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_a19e08c0d7e5a7c9fb9d97ff5ffab053c_icgraph" id="d3/ddc/phys_8funcdeclare_8h_a19e08c0d7e5a7c9fb9d97ff5ffab053c_icgraph">
<area shape="rect" id="node3" href="../../dc/d5e/fluxcompute_8c.html#ab088a2ff1d1132363446aab47e5c9c7b" title="P&#45;&gt;sate,flux,U." alt="" coords="440,19,541,48"/><area shape="rect" id="node36" href="../../dc/d5e/fluxcompute_8c.html#a9fdd8e08eb928fb500db9e2688f1475b" title="p2SFUevolveall" alt="" coords="133,148,248,177"/><area shape="rect" id="node39" href="../../d8/d60/init_8c.html#af3b64278d50c2ff0fee80291fbd38dab" title="fieldprim" alt="" coords="1599,485,1668,515"/><area shape="rect" id="node53" href="../../d7/def/phys_8tools_8c.html#a12238eba5936209a397a23dd34724ec9" title="returns entire space&#45;time(NDIM in size) / EOM(NPR in size) matrix" alt="" coords="143,405,239,435"/><area shape="rect" id="node61" href="../../d7/def/phys_8tools_8c.html#a06fa54aa3b2f9f3f125f6c53e5ee29e9" title="calculate &quot;conserved&quot; quantities" alt="" coords="157,276,224,305"/><area shape="rect" id="node5" href="../../dc/dae/flux_8c.html#aa26f8747446e1cd5bd214ebc345aafa2" title="compute donor&#45;based flux, bypassing normal fluxcalc()." alt="" coords="892,5,999,35"/><area shape="rect" id="node9" href="../../d3/ddc/phys_8funcdeclare_8h.html#a0bb12b388b07610cf01d08c19f8fddb1" title="actually compute the flux and ctop for dt calculation" alt="" coords="621,59,771,88"/><area shape="rect" id="node7" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="1556,252,1711,281"/><area shape="rect" id="node11" href="../../dc/dae/flux_8c.html#a054658527dfb1d80226b8b2d2106aeed" title="original flux calculator that gets F in &quot;dir&quot;. At end global pleft,pright,dq also set and if STOREWAV..." alt="" coords="884,112,1007,141"/><area shape="rect" id="node32" href="../../dc/dae/flux_8c.html#a2602a4dad9ed7adc944227d02435312e" title="standard (non&#45;field flux) calculation but setup to store results of interpolation so can be used for ..." alt="" coords="848,59,1043,88"/><area shape="rect" id="node13" href="../../dc/dae/flux_8c.html#aaf6d832880760f80459d91477c28b519" title="wrapper for different standard 1&#45;D flux calculators 1&#45;D interpolate and get flux for that direction (..." alt="" coords="1095,112,1209,141"/><area shape="rect" id="node15" href="../../dc/dae/flux_8c.html#a8ffa7399bd5354fdcdec5f3e1adf0b13" title="wrapper for CENT_to_FACE1,2,3 used to compute flux at face" alt="" coords="1268,112,1361,141"/><area shape="rect" id="node17" href="../../d5/d2f/flux_8funcdeclare_8h.html#ab229b0f3f2caf3c0a3ef5299fba2b1c0" title="see fluxcompute.c for non&#45;computer science, real physics calculations of flux" alt="" coords="1428,252,1495,281"/><area shape="rect" id="node19" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="1569,379,1697,408"/><area shape="rect" id="node21" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="1779,379,1848,408"/><area shape="rect" id="node23" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="1919,379,2052,408"/><area shape="rect" id="node25" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="2123,379,2189,408"/><area shape="rect" id="node27" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="2257,379,2348,408"/><area shape="rect" id="node29" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="2397,405,2448,435"/><area shape="rect" id="node41" href="../../df/d15/init_8tools_8c.html#acefd26944dbbb1c289886f520f6befac" title="init_dsandvels" alt="" coords="1761,432,1865,461"/><area shape="rect" id="node50" href="../../de/db2/initbase_8funcdeclare_8h.html#a4e121b9448ac1adaa7608206369f9ea5" title="init_postvpot" alt="" coords="1765,485,1861,515"/><area shape="rect" id="node43" href="../../df/d15/init_8tools_8c.html#a77551ab2581efdbaf170dfca073ff9ab" title="user1_init_primitives" alt="" coords="1915,432,2056,461"/><area shape="rect" id="node45" href="../../de/db2/initbase_8funcdeclare_8h.html#a0afa200a5f947b1c9f6e554519f28fc4" title="init_primitives" alt="" coords="2105,432,2207,461"/><area shape="rect" id="node47" href="../../de/df8/initbase_8c.html#ac4110398e386c9888d9565630357dbbe" title="General&#45;Primary init() routine Uses globals inside init() because sets memory and sets physics..." alt="" coords="2284,432,2321,461"/><area shape="rect" id="node55" href="../../de/d8c/phys_8c.html#a44693eac289e90fab8a6792e6e9fb02c" title="source_conn" alt="" coords="648,483,744,512"/><area shape="rect" id="node57" href="../../d7/def/phys_8tools_8c.html#a12ce5092c3a1a566cb7a560a7440acc1" title="add in source terms to equations of motion ui and dUriemann in UEVOLVE form assume q(pr) so consisten..." alt="" coords="1431,328,1492,357"/><area shape="rect" id="node65" href="../../d2/d72/phys_8tools_8rad_8c.html#af46d2b1cf89a70a7e2ef503146c649a9" title="uu0 &#45; original cons." alt="" coords="305,224,380,253"/><area shape="rect" id="node67" href="../../d2/d72/phys_8tools_8rad_8c.html#a17aede36203a236390363af78d3a86f0" title="compute changes to U (both T and R) using implicit method KORALTODO: If doing implicit, should also add geometry source term that can sometimes be stiff." alt="" coords="592,249,800,279"/><area shape="rect" id="node69" href="../../d2/d72/phys_8tools_8rad_8c.html#a675bb3f12a77c62cf2540bc42c4867f8" title="wrapper for mode method" alt="" coords="861,327,1029,356"/><area shape="rect" id="node81" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a7e078cc9a354495bc85554d875a705d9" title="General explicit inversion of U[MHD]&#45;&gt;P[MHD] and also inverts scalars. Inverts radiation if(EOMRADTYP..." alt="" coords="1417,432,1505,461"/><area shape="rect" id="node88" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a58011440113d7e9adf2b0af40e531f25" title="loop for P&#45;&gt;U" alt="" coords="297,328,388,357"/><area shape="rect" id="node76" href="../../d2/d72/phys_8tools_8rad_8c.html#afa73a2caa3209e565a64f92447058507" title="calculating approximate Jacobian: dUresid(dUrad,G(Urad))/dUrad = dy(x)/dx then compute inverse Jacobi..." alt="" coords="439,224,543,253"/><area shape="rect" id="node71" href="../../d2/d72/phys_8tools_8rad_8c.html#aa8c5c0d5de580899948f9f22e10aff23" title="General radiation source term calculation (EXTERNALLY called) NOTE: source_explicit() takes as first ..." alt="" coords="1092,328,1212,357"/><area shape="rect" id="node73" href="../../d2/d1d/sources_8c.html#a504ce383765ca3d2ff0b1ee653aff854" title="Ugeomfree and dUother are in UNOTHING form (or UEVOLVE without geometry) pf might be modified so bett..." alt="" coords="1261,328,1368,357"/><area shape="rect" id="node86" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a8db9dc7c7f52d6fcb405a74e519db5cf" title="there may be something wrong with this function  didn&#39;t work in TIMEORDER==4, had to do standard met..." alt="" coords="1588,432,1679,461"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9a54096e4c40a15a2c1bf74266153616"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int primtoU </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>returntype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>geom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>U</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>Uabs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculate "conserved" quantities </p>

<p>Definition at line <a class="el" href="../../d7/def/phys_8tools_8c_source.html#l00728">728</a> of file <a class="el" href="../../d7/def/phys_8tools_8c_source.html">phys.tools.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_a9a54096e4c40a15a2c1bf74266153616_cgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_a9a54096e4c40a15a2c1bf74266153616_cgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_a9a54096e4c40a15a2c1bf74266153616_cgraph" id="d3/ddc/phys_8funcdeclare_8h_a9a54096e4c40a15a2c1bf74266153616_cgraph">
<area shape="rect" id="node3" href="../../d3/ddc/phys_8funcdeclare_8h.html#a19e08c0d7e5a7c9fb9d97ff5ffab053c" title="Calculate fluxes in direction dir and conserved variable U returntype==0 : flux with geometric factor..." alt="" coords="124,296,201,325"/><area shape="rect" id="node5" href="../../d7/def/phys_8tools_8c.html#ace478826bef11e98daed7dd2ab026c93" title="matter only terms (as if B=0)" alt="" coords="251,163,355,192"/><area shape="rect" id="node25" href="../../d7/def/phys_8tools_8c.html#a3c8277899afc2a48590156971490bb79" title="radiation terms (as if rho=u=p=0)" alt="" coords="251,296,355,325"/><area shape="rect" id="node30" href="../../d7/def/phys_8tools_8c.html#a664550c21e363870d26e73f3ab5b3d3c" title="electromagnetic terms (as if rho=u=p=0)" alt="" coords="251,376,355,405"/><area shape="rect" id="node7" href="../../d7/def/phys_8tools_8c.html#a133cabc36f68eda16f9245f749c3cc38" title="flux asociated with Ynu variable" alt="" coords="436,5,529,35"/><area shape="rect" id="node9" href="../../d7/def/phys_8tools_8c.html#a787551c0e83438fe9e63ecd3d996f61a" title="massflux_calc" alt="" coords="647,57,753,87"/><area shape="rect" id="node11" href="../../d7/def/phys_8tools_8c.html#a2ef51d65728fe59168e5b705165af6d4" title="flux associated with Y_L variable" alt="" coords="441,109,524,139"/><area shape="rect" id="node14" href="../../d7/def/phys_8tools_8c.html#a1e1dcf1d515232206c829a33d7e1192b" title="flux associated with Y_fl variable" alt="" coords="439,269,527,299"/><area shape="rect" id="node17" href="../../d7/def/phys_8tools_8c.html#a5717fa95303172fb697892a9232f0546" title="flux of specific entropy" alt="" coords="424,163,541,192"/><area shape="rect" id="node19" href="../../d7/def/phys_8tools_8c.html#a4886704a6724ea65ccaae2277b6ded74" title="MHD stress tensor, with first index up, second index down mhd^dir_j understood that mhddiagpress only..." alt="" coords="432,216,533,245"/><area shape="rect" id="node21" href="../../d7/def/phys_8tools_8c.html#ab3fd971df8ad09cce2462e78d7735f33" title="MHD stress tensor, with first index up, second index down." alt="" coords="641,189,759,219"/><area shape="rect" id="node23" href="../../d7/def/phys_8tools_8c.html#a44930b5d598885afcb717a270f42749f" title="MHD stress tensor, with first index up, second index down avoids catastrophic cancellation with rest&#45;..." alt="" coords="611,243,789,272"/><area shape="rect" id="node28" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a389bf7e41d2fd117af996e3392067cdc" title="compute radiation stres&#45;energy tensor assuming M1 closure" alt="" coords="432,323,533,352"/><area shape="rect" id="node32" href="../../d7/def/phys_8tools_8c.html#a3552b97ec9f1982094fbc3e3f9af7f05" title="MHD stress tensor, with first index up, second index down mhd^dir_j." alt="" coords="432,376,533,405"/><area shape="rect" id="node38" href="../../d7/def/phys_8tools_8c.html#a12b4ca77ffbef030f608b079327b4eb7" title="spatial part of dualfaraday" alt="" coords="404,429,561,459"/><area shape="rect" id="node34" href="../../d7/def/phys_8tools_8c.html#a3f6e052b84282b8db7b05a0acc435622" title="EM part of stress&#45;energy tensor." alt="" coords="641,323,759,352"/><area shape="rect" id="node36" href="../../d7/def/phys_8tools_8c.html#a864ca09eade159d4c4b545593c1095de" title="MHD stress tensor, with first index up, second index down avoids catastrophic cancellation with rest&#45;..." alt="" coords="621,376,779,405"/><area shape="rect" id="node40" href="../../d7/def/phys_8tools_8c.html#abc846df49f33c007310b52240e099e3b" title="Notation for HARM paper and JCM&#39;s GRFFE paper is that: B^ = &#160;*F^{} and for lab&#45;frame we chose ={&#45;1..." alt="" coords="632,429,768,459"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_a9a54096e4c40a15a2c1bf74266153616_icgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_a9a54096e4c40a15a2c1bf74266153616_icgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_a9a54096e4c40a15a2c1bf74266153616_icgraph" id="d3/ddc/phys_8funcdeclare_8h_a9a54096e4c40a15a2c1bf74266153616_icgraph">
<area shape="rect" id="node3" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="1372,192,1500,221"/><area shape="rect" id="node15" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="1359,245,1513,275"/><area shape="rect" id="node17" href="../../d2/d72/phys_8tools_8rad_8c.html#af46d2b1cf89a70a7e2ef503146c649a9" title="uu0 &#45; original cons." alt="" coords="132,144,207,173"/><area shape="rect" id="node19" href="../../d2/d72/phys_8tools_8rad_8c.html#a17aede36203a236390363af78d3a86f0" title="compute changes to U (both T and R) using implicit method KORALTODO: If doing implicit, should also add geometry source term that can sometimes be stiff." alt="" coords="419,119,627,148"/><area shape="rect" id="node21" href="../../d2/d72/phys_8tools_8rad_8c.html#a675bb3f12a77c62cf2540bc42c4867f8" title="wrapper for mode method" alt="" coords="676,193,844,223"/><area shape="rect" id="node36" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a7e078cc9a354495bc85554d875a705d9" title="General explicit inversion of U[MHD]&#45;&gt;P[MHD] and also inverts scalars. Inverts radiation if(EOMRADTYP..." alt="" coords="1220,299,1308,328"/><area shape="rect" id="node56" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a58011440113d7e9adf2b0af40e531f25" title="loop for P&#45;&gt;U" alt="" coords="124,349,215,379"/><area shape="rect" id="node5" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="1581,219,1651,248"/><area shape="rect" id="node7" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="1721,223,1855,252"/><area shape="rect" id="node9" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="1925,236,1992,265"/><area shape="rect" id="node11" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="2060,239,2151,268"/><area shape="rect" id="node13" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="2200,267,2251,296"/><area shape="rect" id="node31" href="../../d2/d72/phys_8tools_8rad_8c.html#afa73a2caa3209e565a64f92447058507" title="calculating approximate Jacobian: dUresid(dUrad,G(Urad))/dUrad = dy(x)/dx then compute inverse Jacobi..." alt="" coords="265,144,369,173"/><area shape="rect" id="node23" href="../../d2/d72/phys_8tools_8rad_8c.html#aa8c5c0d5de580899948f9f22e10aff23" title="General radiation source term calculation (EXTERNALLY called) NOTE: source_explicit() takes as first ..." alt="" coords="895,193,1015,223"/><area shape="rect" id="node25" href="../../d2/d1d/sources_8c.html#a504ce383765ca3d2ff0b1ee653aff854" title="Ugeomfree and dUother are in UNOTHING form (or UEVOLVE without geometry) pf might be modified so bett..." alt="" coords="1064,193,1171,223"/><area shape="rect" id="node27" href="../../d7/def/phys_8tools_8c.html#a12ce5092c3a1a566cb7a560a7440acc1" title="add in source terms to equations of motion ui and dUriemann in UEVOLVE form assume q(pr) so consisten..." alt="" coords="1233,193,1295,223"/><area shape="rect" id="node40" href="../../d8/d60/init_8c.html#af3b64278d50c2ff0fee80291fbd38dab" title="fieldprim" alt="" coords="1401,352,1471,381"/><area shape="rect" id="node54" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a8db9dc7c7f52d6fcb405a74e519db5cf" title="there may be something wrong with this function  didn&#39;t work in TIMEORDER==4, had to do standard met..." alt="" coords="1391,299,1481,328"/><area shape="rect" id="node42" href="../../df/d15/init_8tools_8c.html#acefd26944dbbb1c289886f520f6befac" title="init_dsandvels" alt="" coords="1564,299,1668,328"/><area shape="rect" id="node51" href="../../de/db2/initbase_8funcdeclare_8h.html#a4e121b9448ac1adaa7608206369f9ea5" title="init_postvpot" alt="" coords="1568,352,1664,381"/><area shape="rect" id="node44" href="../../df/d15/init_8tools_8c.html#a77551ab2581efdbaf170dfca073ff9ab" title="user1_init_primitives" alt="" coords="1717,299,1859,328"/><area shape="rect" id="node46" href="../../de/db2/initbase_8funcdeclare_8h.html#a0afa200a5f947b1c9f6e554519f28fc4" title="init_primitives" alt="" coords="1908,296,2009,325"/><area shape="rect" id="node48" href="../../de/df8/initbase_8c.html#ac4110398e386c9888d9565630357dbbe" title="General&#45;Primary init() routine Uses globals inside init() because sets memory and sets physics..." alt="" coords="2087,293,2124,323"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4ebf7765a6bde079a76719b89d3033b6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int source </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>didreturnpf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>eomtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>geom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>Ui</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>Uf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>CUf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>CUimp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td>
          <td class="paramname"><em>dissmeasure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>dUriemann</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>Uacomp</em>[NPR], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>Ua</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>add in source terms to equations of motion ui and dUriemann in UEVOLVE form assume q(pr) so consistent, but p or ui don't yet account for dUriemann! </p>

<p>Definition at line <a class="el" href="../../d7/def/phys_8tools_8c_source.html#l01619">1619</a> of file <a class="el" href="../../d7/def/phys_8tools_8c_source.html">phys.tools.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_a4ebf7765a6bde079a76719b89d3033b6_cgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_a4ebf7765a6bde079a76719b89d3033b6_cgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_a4ebf7765a6bde079a76719b89d3033b6_cgraph" id="d3/ddc/phys_8funcdeclare_8h_a4ebf7765a6bde079a76719b89d3033b6_cgraph">
<area shape="rect" id="node3" href="../../de/d8c/phys_8c.html#a44693eac289e90fab8a6792e6e9fb02c" title="source_conn" alt="" coords="1069,293,1165,323"/><area shape="rect" id="node53" href="../../d3/ddc/phys_8funcdeclare_8h.html#a9ffbdaa97489ef748af456f65c779e18" title="Ugeomfree and dUother are in UNOTHING form (or UEVOLVE without geometry) pf might be modified so bett..." alt="" coords="115,411,221,440"/><area shape="rect" id="node5" href="../../d7/def/phys_8tools_8c.html#a12238eba5936209a397a23dd34724ec9" title="returns entire space&#45;time(NDIM in size) / EOM(NPR in size) matrix" alt="" coords="1253,344,1349,373"/><area shape="rect" id="node32" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a389bf7e41d2fd117af996e3392067cdc" title="compute radiation stres&#45;energy tensor assuming M1 closure" alt="" coords="2180,583,2281,612"/><area shape="rect" id="node46" href="../../d7/def/phys_8tools_8c.html#acee98fab974682bc6838e2040bed0d45" title="MHD stress tensor, with first index up, second index down mhd^dir_j." alt="" coords="1475,203,1552,232"/><area shape="rect" id="node7" href="../../d3/ddc/phys_8funcdeclare_8h.html#a19e08c0d7e5a7c9fb9d97ff5ffab053c" title="Calculate fluxes in direction dir and conserved variable U returntype==0 : flux with geometric factor..." alt="" coords="1475,344,1552,373"/><area shape="rect" id="node9" href="../../d7/def/phys_8tools_8c.html#ace478826bef11e98daed7dd2ab026c93" title="matter only terms (as if B=0)" alt="" coords="1685,397,1789,427"/><area shape="rect" id="node29" href="../../d7/def/phys_8tools_8c.html#a3c8277899afc2a48590156971490bb79" title="radiation terms (as if rho=u=p=0)" alt="" coords="1685,557,1789,587"/><area shape="rect" id="node34" href="../../d7/def/phys_8tools_8c.html#a664550c21e363870d26e73f3ab5b3d3c" title="electromagnetic terms (as if rho=u=p=0)" alt="" coords="1685,344,1789,373"/><area shape="rect" id="node11" href="../../d7/def/phys_8tools_8c.html#a133cabc36f68eda16f9245f749c3cc38" title="flux asociated with Ynu variable" alt="" coords="1937,269,2031,299"/><area shape="rect" id="node13" href="../../d7/def/phys_8tools_8c.html#a787551c0e83438fe9e63ecd3d996f61a" title="massflux_calc" alt="" coords="2177,372,2284,401"/><area shape="rect" id="node15" href="../../d7/def/phys_8tools_8c.html#a2ef51d65728fe59168e5b705165af6d4" title="flux associated with Y_L variable" alt="" coords="1943,424,2025,453"/><area shape="rect" id="node18" href="../../d7/def/phys_8tools_8c.html#a1e1dcf1d515232206c829a33d7e1192b" title="flux associated with Y_fl variable" alt="" coords="1940,531,2028,560"/><area shape="rect" id="node21" href="../../d7/def/phys_8tools_8c.html#a5717fa95303172fb697892a9232f0546" title="flux of specific entropy" alt="" coords="1925,477,2043,507"/><area shape="rect" id="node23" href="../../d7/def/phys_8tools_8c.html#a4886704a6724ea65ccaae2277b6ded74" title="MHD stress tensor, with first index up, second index down mhd^dir_j understood that mhddiagpress only..." alt="" coords="1933,216,2035,245"/><area shape="rect" id="node25" href="../../d7/def/phys_8tools_8c.html#ab3fd971df8ad09cce2462e78d7735f33" title="MHD stress tensor, with first index up, second index down." alt="" coords="2172,219,2289,248"/><area shape="rect" id="node27" href="../../d7/def/phys_8tools_8c.html#a44930b5d598885afcb717a270f42749f" title="MHD stress tensor, with first index up, second index down avoids catastrophic cancellation with rest&#45;..." alt="" coords="2141,165,2320,195"/><area shape="rect" id="node36" href="../../d7/def/phys_8tools_8c.html#a3552b97ec9f1982094fbc3e3f9af7f05" title="MHD stress tensor, with first index up, second index down mhd^dir_j." alt="" coords="1933,59,2035,88"/><area shape="rect" id="node42" href="../../d7/def/phys_8tools_8c.html#a12b4ca77ffbef030f608b079327b4eb7" title="spatial part of dualfaraday" alt="" coords="1905,112,2063,141"/><area shape="rect" id="node38" href="../../d7/def/phys_8tools_8c.html#a3f6e052b84282b8db7b05a0acc435622" title="EM part of stress&#45;energy tensor." alt="" coords="2172,5,2289,35"/><area shape="rect" id="node40" href="../../d7/def/phys_8tools_8c.html#a864ca09eade159d4c4b545593c1095de" title="MHD stress tensor, with first index up, second index down avoids catastrophic cancellation with rest&#45;..." alt="" coords="2152,59,2309,88"/><area shape="rect" id="node44" href="../../d7/def/phys_8tools_8c.html#abc846df49f33c007310b52240e099e3b" title="Notation for HARM paper and JCM&#39;s GRFFE paper is that: B^ = &#160;*F^{} and for lab&#45;frame we chose ={&#45;1..." alt="" coords="2163,112,2299,141"/><area shape="rect" id="node48" href="../../d7/def/phys_8tools_8c.html#adeb9f0f94ef0d4f02ddd49a3de4de7e3" title="MHD stress tensor, with first index up, second index down avoids catastrophic cancellation with rest&#45;..." alt="" coords="1661,164,1813,193"/><area shape="rect" id="node55" href="../../d2/d72/phys_8tools_8rad_8c.html#aa8c5c0d5de580899948f9f22e10aff23" title="General radiation source term calculation (EXTERNALLY called) NOTE: source_explicit() takes as first ..." alt="" coords="271,591,391,620"/><area shape="rect" id="node160" href="../../d5/de1/global_8inits_8h.html#aeb307be7cd4b2a4520d60cdb2510c1ce" title="coolfunc_user" alt="" coords="280,411,381,440"/><area shape="rect" id="node57" href="../../d2/d72/phys_8tools_8rad_8c.html#a675bb3f12a77c62cf2540bc42c4867f8" title="wrapper for mode method" alt="" coords="441,655,609,684"/><area shape="rect" id="node59" href="../../d9/de9/coord_8c.html#a96290375e27d5d0aa4d843b07e228e14" title="normally&#45;used bl_coord[i,j,k] {i,j,k} &#45;&gt; V only" alt="" coords="2185,1180,2276,1209"/><area shape="rect" id="node69" href="../../d2/d72/phys_8tools_8rad_8c.html#a17aede36203a236390363af78d3a86f0" title="compute changes to U (both T and R) using implicit method KORALTODO: If doing implicit, should also add geometry source term that can sometimes be stiff." alt="" coords="659,655,867,684"/><area shape="rect" id="node79" href="../../d3/ddc/phys_8funcdeclare_8h.html#a11e17cd8b0594d1ad52e3594aa9f477e" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="1476,1077,1551,1107"/><area shape="rect" id="node118" href="../../d3/ddc/phys_8funcdeclare_8h.html#a9a54096e4c40a15a2c1bf74266153616" title="calculate &quot;conserved&quot; quantities" alt="" coords="1268,448,1335,477"/><area shape="rect" id="node154" href="../../d1/d3e/utoprimgen_8c.html#a7d31362f91cd4ec3b92e15dd6bcb3908" title="includerad=1: account for fact that not only assume MHD flow is cold itself, but energy&#45;force balance..." alt="" coords="723,1331,803,1360"/><area shape="rect" id="node158" href="../../de/d95/fixup_8c.html#a43fb15d762b67f635ac6c63a158bf558" title="record who called the diag_fixup routine" alt="" coords="704,601,821,631"/><area shape="rect" id="node61" href="../../d9/de9/coord_8c.html#a041e7b005310415c97d90f4b8521ed1a" title="get X(i,j,k) CENT is default position in degenerate cases" alt="" coords="2417,1180,2471,1209"/><area shape="rect" id="node63" href="../../d9/de9/coord_8c.html#a65ad4ca9656d141cc995fd35ed31dc40" title="Returns boyer&#45;lindquist coordinte of point." alt="" coords="2409,1127,2479,1156"/><area shape="rect" id="node65" href="../../d8/d60/init_8c.html#a27c01fe4532cf3e10d467517403dbf70" title="blcoord_user" alt="" coords="2573,1100,2669,1129"/><area shape="rect" id="node67" href="../../d9/de9/coord_8c.html#af7a086e6042d598aea95c2360d07a99b" title="blcoord_singfixes" alt="" coords="2560,1153,2683,1183"/><area shape="rect" id="node71" href="../../d2/d72/phys_8tools_8rad_8c.html#a5dcc789108ddf06ec44fb22770f18e90" title="compute dt for this sub&#45;step" alt="" coords="923,603,1013,632"/><area shape="rect" id="node73" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a5943065ab3d5b4e9f4f691db499b588f" title="calculates total opacity over dx[]" alt="" coords="1075,707,1160,736"/><area shape="rect" id="node77" href="../../d2/d72/phys_8tools_8rad_8c.html#af46d2b1cf89a70a7e2ef503146c649a9" title="uu0 &#45; original cons." alt="" coords="1080,787,1155,816"/><area shape="rect" id="node126" href="../../d1/d3e/utoprimgen_8c.html#abfc42de6975dd4ff02f2748404e10911" title="perform U&#45;&gt;p inversion on advected scalars" alt="" coords="1247,501,1356,531"/><area shape="rect" id="node128" href="../../d3/ddc/phys_8funcdeclare_8h.html#aae6a7d24b984236dae44b1a3e8ee37b6" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="1227,555,1376,584"/><area shape="rect" id="node130" href="../../d7/def/phys_8tools_8c.html#ad54ad99ee062beaf43518d6e9afae0a7" title="primtoflux_nonradonly" alt="" coords="1439,397,1588,427"/><area shape="rect" id="node140" href="../../d1/d3e/utoprimgen_8c.html#a1118806d01e553c38ae5cf5f036f9f2e" title="perform U&#45;&gt;p inversion on advected scalars" alt="" coords="1247,608,1356,637"/><area shape="rect" id="node145" href="../../d2/d72/phys_8tools_8rad_8c.html#afa73a2caa3209e565a64f92447058507" title="calculating approximate Jacobian: dUresid(dUrad,G(Urad))/dUrad = dy(x)/dx then compute inverse Jacobi..." alt="" coords="916,808,1020,837"/><area shape="rect" id="node75" href="../../d2/d72/phys_8tools_8rad_8c.html#a795959353203e99366b456b16d0d0bab" title="calculates total opacity over dx[] for given chi or chieff" alt="" coords="1239,661,1364,691"/><area shape="rect" id="node85" href="../../d3/ddc/phys_8funcdeclare_8h.html#a41b8eacac0a4a23d6b00b670fe49629c" title="bsq_calc_fromq" alt="" coords="1680,1027,1795,1056"/><area shape="rect" id="node87" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a0a9afe086334630c217cca3b3dbf7f7d" title="get 4&#45;force for all pl&#39;s" alt="" coords="1225,920,1377,949"/><area shape="rect" id="node116" href="../../d2/d72/phys_8tools_8rad_8c.html#a0a4c88ebd712c11eee70dda4d75288cf" title="setgasinversionstuff" alt="" coords="1232,765,1371,795"/><area shape="rect" id="node121" href="../../d3/ddc/phys_8funcdeclare_8h.html#a3c69b676adf3024cd6ae832094d91fab" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="1439,973,1588,1003"/><area shape="rect" id="node134" href="../../d3/ddc/phys_8funcdeclare_8h.html#a07847bede2b7ba9d0aabaea82f17f989" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="1451,1131,1576,1160"/><area shape="rect" id="node137" href="../../d7/def/phys_8tools_8c.html#a764e6f682011d16faec0f9b71eb360d2" title="primtoflux_radonly" alt="" coords="1449,688,1577,717"/><area shape="rect" id="node143" href="../../d2/d72/phys_8tools_8rad_8c.html#ae83fc4364d7c6bc0b717418cd5345297" title="calc_approx_ratchangeRtt" alt="" coords="1215,973,1388,1003"/><area shape="rect" id="node81" href="../../d3/ddc/phys_8funcdeclare_8h.html#a12a473e24b431762af4168179e82cd08" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="1656,973,1819,1003"/><area shape="rect" id="node83" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a8a762bf6582e6f7e1199de9c43b98454" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="1639,1105,1836,1135"/><area shape="rect" id="node90" href="../../d2/d72/phys_8tools_8rad_8c.html#aaa32f967773a287ecb6647732157606f" title="get G_" alt="" coords="1479,920,1548,949"/><area shape="rect" id="node92" href="../../d2/d72/phys_8tools_8rad_8c.html#ab62b07a8cbcc04f20c05a468ad6de636" title="compute G^ 4&#45;force" alt="" coords="1703,920,1772,949"/><area shape="rect" id="node94" href="../../df/d21/global_8funcdeclare_8rad_8h.html#aba8efc1e2ea7a31f67bb6c06ce3c164a" title="mhdfull_calc_rad" alt="" coords="1924,737,2044,767"/><area shape="rect" id="node97" href="../../df/d21/global_8funcdeclare_8rad_8h.html#af8e0b77aba8b494909392ceca6f551a0" title="get {abs} and {es} in /mass * rho = 1/cm form." alt="" coords="1885,1048,2083,1077"/><area shape="rect" id="node114" href="../../d8/d60/init_8c.html#a9118b79d84fe3dccfed3b28ee0fd84b5" title="Gcompt" alt="" coords="1951,920,2017,949"/><area shape="rect" id="node99" href="../../d2/d72/phys_8tools_8rad_8c.html#a864793af319e70c0d099679fa81dd398" title="compute Trad (also computed directly in calc_Gu() above) using only primitives (not using conserved q..." alt="" coords="2131,969,2331,999"/><area shape="rect" id="node106" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a7dc2e853cec9b6f9a5e83ce23c468d03" title="nrad(T) = nrad=arad T^3/2.70118 (this is LTE only if put in T was gas T)" alt="" coords="2557,1021,2685,1051"/><area shape="rect" id="node109" href="../../df/d21/global_8funcdeclare_8rad_8h.html#ab4537b80f4788d1a81759b595c8441a9" title="kappa_func_fits_all" alt="" coords="2164,1073,2297,1103"/><area shape="rect" id="node111" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a0fb687f68b97453843fc3c085f05f1b4" title="E=urad=arad T^4 (this is LTE only if put in T was gas T)" alt="" coords="2168,1127,2293,1156"/><area shape="rect" id="node101" href="../../df/d21/global_8funcdeclare_8rad_8h.html#af07558357c906b4dfa61cd34656d9f02" title="E=urad=arad T^4 and just solve for T (this is LTE only if assume resulting T is gas T)..." alt="" coords="2559,943,2684,972"/><area shape="rect" id="node103" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a3e47afcfc5c42719999d851395fd032d" title="nrad(E)" alt="" coords="2380,969,2508,999"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_a4ebf7765a6bde079a76719b89d3033b6_icgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_a4ebf7765a6bde079a76719b89d3033b6_icgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_a4ebf7765a6bde079a76719b89d3033b6_icgraph" id="d3/ddc/phys_8funcdeclare_8h_a4ebf7765a6bde079a76719b89d3033b6_icgraph">
<area shape="rect" id="node3" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="129,5,257,35"/><area shape="rect" id="node15" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="116,59,271,88"/><area shape="rect" id="node5" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="321,5,391,35"/><area shape="rect" id="node7" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="441,5,575,35"/><area shape="rect" id="node9" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="625,5,692,35"/><area shape="rect" id="node11" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="743,5,833,35"/><area shape="rect" id="node13" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="883,5,933,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9ffbdaa97489ef748af456f65c779e18"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sourcephysics </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>didreturnpf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>eomtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>ptrgeom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>Ugeomfreei</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>Ugeomfreef</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>CUf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>CUimp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td>
          <td class="paramname"><em>dissmeasure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>dUother</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>dUcomp</em>[NPR]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Ugeomfree and dUother are in UNOTHING form (or UEVOLVE without geometry) pf might be modified so better approximation to final update, so easier on <a class="el" href="../../d1/d3e/utoprimgen_8c.html#a7e078cc9a354495bc85554d875a705d9" title="General explicit inversion of U[MHD]-&gt;P[MHD] and also inverts scalars. Inverts radiation if(EOMRADTYP...">Utoprimgen()</a> to get inversion. </p>

<p>Definition at line <a class="el" href="../../d2/d1d/sources_8c_source.html#l00014">14</a> of file <a class="el" href="../../d2/d1d/sources_8c_source.html">sources.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_a9ffbdaa97489ef748af456f65c779e18_cgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_a9ffbdaa97489ef748af456f65c779e18_cgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_a9ffbdaa97489ef748af456f65c779e18_cgraph" id="d3/ddc/phys_8funcdeclare_8h_a9ffbdaa97489ef748af456f65c779e18_cgraph">
<area shape="rect" id="node3" href="../../d2/d72/phys_8tools_8rad_8c.html#aa8c5c0d5de580899948f9f22e10aff23" title="General radiation source term calculation (EXTERNALLY called) NOTE: source_explicit() takes as first ..." alt="" coords="161,973,281,1003"/><area shape="rect" id="node146" href="../../d5/de1/global_8inits_8h.html#aeb307be7cd4b2a4520d60cdb2510c1ce" title="coolfunc_user" alt="" coords="171,1027,272,1056"/><area shape="rect" id="node5" href="../../d2/d72/phys_8tools_8rad_8c.html#a675bb3f12a77c62cf2540bc42c4867f8" title="wrapper for mode method" alt="" coords="332,973,500,1003"/><area shape="rect" id="node7" href="../../d9/de9/coord_8c.html#a96290375e27d5d0aa4d843b07e228e14" title="normally&#45;used bl_coord[i,j,k] {i,j,k} &#45;&gt; V only" alt="" coords="2068,920,2159,949"/><area shape="rect" id="node17" href="../../d2/d72/phys_8tools_8rad_8c.html#a17aede36203a236390363af78d3a86f0" title="compute changes to U (both T and R) using implicit method KORALTODO: If doing implicit, should also add geometry source term that can sometimes be stiff." alt="" coords="549,428,757,457"/><area shape="rect" id="node27" href="../../d3/ddc/phys_8funcdeclare_8h.html#a11e17cd8b0594d1ad52e3594aa9f477e" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="1359,688,1433,717"/><area shape="rect" id="node67" href="../../d3/ddc/phys_8funcdeclare_8h.html#a9a54096e4c40a15a2c1bf74266153616" title="calculate &quot;conserved&quot; quantities" alt="" coords="1151,168,1217,197"/><area shape="rect" id="node140" href="../../d1/d3e/utoprimgen_8c.html#a7d31362f91cd4ec3b92e15dd6bcb3908" title="includerad=1: account for fact that not only assume MHD flow is cold itself, but energy&#45;force balance..." alt="" coords="613,1051,693,1080"/><area shape="rect" id="node144" href="../../de/d95/fixup_8c.html#a43fb15d762b67f635ac6c63a158bf558" title="record who called the diag_fixup routine" alt="" coords="595,1104,712,1133"/><area shape="rect" id="node9" href="../../d9/de9/coord_8c.html#a041e7b005310415c97d90f4b8521ed1a" title="get X(i,j,k) CENT is default position in degenerate cases" alt="" coords="2300,920,2353,949"/><area shape="rect" id="node11" href="../../d9/de9/coord_8c.html#a65ad4ca9656d141cc995fd35ed31dc40" title="Returns boyer&#45;lindquist coordinte of point." alt="" coords="2292,867,2361,896"/><area shape="rect" id="node13" href="../../d8/d60/init_8c.html#a27c01fe4532cf3e10d467517403dbf70" title="blcoord_user" alt="" coords="2456,843,2552,872"/><area shape="rect" id="node15" href="../../d9/de9/coord_8c.html#af7a086e6042d598aea95c2360d07a99b" title="blcoord_singfixes" alt="" coords="2443,896,2565,925"/><area shape="rect" id="node19" href="../../d2/d72/phys_8tools_8rad_8c.html#a5dcc789108ddf06ec44fb22770f18e90" title="compute dt for this sub&#45;step" alt="" coords="813,532,904,561"/><area shape="rect" id="node21" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a5943065ab3d5b4e9f4f691db499b588f" title="calculates total opacity over dx[]" alt="" coords="961,715,1047,744"/><area shape="rect" id="node25" href="../../d2/d72/phys_8tools_8rad_8c.html#af46d2b1cf89a70a7e2ef503146c649a9" title="uu0 &#45; original cons." alt="" coords="967,481,1041,511"/><area shape="rect" id="node112" href="../../d1/d3e/utoprimgen_8c.html#abfc42de6975dd4ff02f2748404e10911" title="perform U&#45;&gt;p inversion on advected scalars" alt="" coords="1129,221,1239,251"/><area shape="rect" id="node114" href="../../d3/ddc/phys_8funcdeclare_8h.html#aae6a7d24b984236dae44b1a3e8ee37b6" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="1109,275,1259,304"/><area shape="rect" id="node116" href="../../d7/def/phys_8tools_8c.html#ad54ad99ee062beaf43518d6e9afae0a7" title="primtoflux_nonradonly" alt="" coords="1321,167,1471,196"/><area shape="rect" id="node126" href="../../d1/d3e/utoprimgen_8c.html#a1118806d01e553c38ae5cf5f036f9f2e" title="perform U&#45;&gt;p inversion on advected scalars" alt="" coords="1129,328,1239,357"/><area shape="rect" id="node131" href="../../d2/d72/phys_8tools_8rad_8c.html#afa73a2caa3209e565a64f92447058507" title="calculating approximate Jacobian: dUresid(dUrad,G(Urad))/dUrad = dy(x)/dx then compute inverse Jacobi..." alt="" coords="807,428,911,457"/><area shape="rect" id="node23" href="../../d2/d72/phys_8tools_8rad_8c.html#a795959353203e99366b456b16d0d0bab" title="calculates total opacity over dx[] for given chi or chieff" alt="" coords="1121,845,1247,875"/><area shape="rect" id="node33" href="../../d3/ddc/phys_8funcdeclare_8h.html#a41b8eacac0a4a23d6b00b670fe49629c" title="bsq_calc_fromq" alt="" coords="1563,557,1677,587"/><area shape="rect" id="node35" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a0a9afe086334630c217cca3b3dbf7f7d" title="get 4&#45;force for all pl&#39;s" alt="" coords="1108,741,1260,771"/><area shape="rect" id="node65" href="../../d2/d72/phys_8tools_8rad_8c.html#a0a4c88ebd712c11eee70dda4d75288cf" title="setgasinversionstuff" alt="" coords="1115,584,1253,613"/><area shape="rect" id="node107" href="../../d3/ddc/phys_8funcdeclare_8h.html#a3c69b676adf3024cd6ae832094d91fab" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="1321,557,1471,587"/><area shape="rect" id="node120" href="../../d3/ddc/phys_8funcdeclare_8h.html#a07847bede2b7ba9d0aabaea82f17f989" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="1333,795,1459,824"/><area shape="rect" id="node123" href="../../d7/def/phys_8tools_8c.html#a764e6f682011d16faec0f9b71eb360d2" title="primtoflux_radonly" alt="" coords="1332,429,1460,459"/><area shape="rect" id="node129" href="../../d2/d72/phys_8tools_8rad_8c.html#ae83fc4364d7c6bc0b717418cd5345297" title="calc_approx_ratchangeRtt" alt="" coords="1097,688,1271,717"/><area shape="rect" id="node29" href="../../d3/ddc/phys_8funcdeclare_8h.html#a12a473e24b431762af4168179e82cd08" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="1539,623,1701,652"/><area shape="rect" id="node31" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a8a762bf6582e6f7e1199de9c43b98454" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="1521,688,1719,717"/><area shape="rect" id="node38" href="../../d2/d72/phys_8tools_8rad_8c.html#aaa32f967773a287ecb6647732157606f" title="get G_" alt="" coords="1361,741,1431,771"/><area shape="rect" id="node40" href="../../d2/d72/phys_8tools_8rad_8c.html#ab62b07a8cbcc04f20c05a468ad6de636" title="compute G^ 4&#45;force" alt="" coords="1585,741,1655,771"/><area shape="rect" id="node42" href="../../df/d21/global_8funcdeclare_8rad_8h.html#aba8efc1e2ea7a31f67bb6c06ce3c164a" title="mhdfull_calc_rad" alt="" coords="1807,643,1927,672"/><area shape="rect" id="node46" href="../../df/d21/global_8funcdeclare_8rad_8h.html#af8e0b77aba8b494909392ceca6f551a0" title="get {abs} and {es} in /mass * rho = 1/cm form." alt="" coords="1768,808,1965,837"/><area shape="rect" id="node63" href="../../d8/d60/init_8c.html#a9118b79d84fe3dccfed3b28ee0fd84b5" title="Gcompt" alt="" coords="1833,741,1900,771"/><area shape="rect" id="node44" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a389bf7e41d2fd117af996e3392067cdc" title="compute radiation stres&#45;energy tensor assuming M1 closure" alt="" coords="2063,617,2164,647"/><area shape="rect" id="node48" href="../../d2/d72/phys_8tools_8rad_8c.html#a864793af319e70c0d099679fa81dd398" title="compute Trad (also computed directly in calc_Gu() above) using only primitives (not using conserved q..." alt="" coords="2013,763,2213,792"/><area shape="rect" id="node55" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a7dc2e853cec9b6f9a5e83ce23c468d03" title="nrad(T) = nrad=arad T^3/2.70118 (this is LTE only if put in T was gas T)" alt="" coords="2440,777,2568,807"/><area shape="rect" id="node58" href="../../df/d21/global_8funcdeclare_8rad_8h.html#ab4537b80f4788d1a81759b595c8441a9" title="kappa_func_fits_all" alt="" coords="2047,867,2180,896"/><area shape="rect" id="node60" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a0fb687f68b97453843fc3c085f05f1b4" title="E=urad=arad T^4 (this is LTE only if put in T was gas T)" alt="" coords="2051,709,2176,739"/><area shape="rect" id="node50" href="../../df/d21/global_8funcdeclare_8rad_8h.html#af07558357c906b4dfa61cd34656d9f02" title="E=urad=arad T^4 and just solve for T (this is LTE only if assume resulting T is gas T)..." alt="" coords="2441,717,2567,747"/><area shape="rect" id="node52" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a3e47afcfc5c42719999d851395fd032d" title="nrad(E)" alt="" coords="2263,763,2391,792"/><area shape="rect" id="node69" href="../../d3/ddc/phys_8funcdeclare_8h.html#a19e08c0d7e5a7c9fb9d97ff5ffab053c" title="Calculate fluxes in direction dir and conserved variable U returntype==0 : flux with geometric factor..." alt="" coords="1357,220,1435,249"/><area shape="rect" id="node71" href="../../d7/def/phys_8tools_8c.html#ace478826bef11e98daed7dd2ab026c93" title="matter only terms (as if B=0)" alt="" coords="1568,245,1672,275"/><area shape="rect" id="node91" href="../../d7/def/phys_8tools_8c.html#a3c8277899afc2a48590156971490bb79" title="radiation terms (as if rho=u=p=0)" alt="" coords="1568,429,1672,459"/><area shape="rect" id="node95" href="../../d7/def/phys_8tools_8c.html#a664550c21e363870d26e73f3ab5b3d3c" title="electromagnetic terms (as if rho=u=p=0)" alt="" coords="1568,141,1672,171"/><area shape="rect" id="node73" href="../../d7/def/phys_8tools_8c.html#a133cabc36f68eda16f9245f749c3cc38" title="flux asociated with Ynu variable" alt="" coords="1820,323,1913,352"/><area shape="rect" id="node75" href="../../d7/def/phys_8tools_8c.html#a787551c0e83438fe9e63ecd3d996f61a" title="massflux_calc" alt="" coords="2060,272,2167,301"/><area shape="rect" id="node77" href="../../d7/def/phys_8tools_8c.html#a2ef51d65728fe59168e5b705165af6d4" title="flux associated with Y_L variable" alt="" coords="1825,219,1908,248"/><area shape="rect" id="node80" href="../../d7/def/phys_8tools_8c.html#a1e1dcf1d515232206c829a33d7e1192b" title="flux associated with Y_fl variable" alt="" coords="1823,429,1911,459"/><area shape="rect" id="node83" href="../../d7/def/phys_8tools_8c.html#a5717fa95303172fb697892a9232f0546" title="flux of specific entropy" alt="" coords="1808,376,1925,405"/><area shape="rect" id="node85" href="../../d7/def/phys_8tools_8c.html#a4886704a6724ea65ccaae2277b6ded74" title="MHD stress tensor, with first index up, second index down mhd^dir_j understood that mhddiagpress only..." alt="" coords="1816,165,1917,195"/><area shape="rect" id="node87" href="../../d7/def/phys_8tools_8c.html#ab3fd971df8ad09cce2462e78d7735f33" title="MHD stress tensor, with first index up, second index down." alt="" coords="2055,219,2172,248"/><area shape="rect" id="node89" href="../../d7/def/phys_8tools_8c.html#a44930b5d598885afcb717a270f42749f" title="MHD stress tensor, with first index up, second index down avoids catastrophic cancellation with rest&#45;..." alt="" coords="2024,165,2203,195"/><area shape="rect" id="node97" href="../../d7/def/phys_8tools_8c.html#a3552b97ec9f1982094fbc3e3f9af7f05" title="MHD stress tensor, with first index up, second index down mhd^dir_j." alt="" coords="1816,112,1917,141"/><area shape="rect" id="node103" href="../../d7/def/phys_8tools_8c.html#a12b4ca77ffbef030f608b079327b4eb7" title="spatial part of dualfaraday" alt="" coords="1788,32,1945,61"/><area shape="rect" id="node99" href="../../d7/def/phys_8tools_8c.html#a3f6e052b84282b8db7b05a0acc435622" title="EM part of stress&#45;energy tensor." alt="" coords="2055,112,2172,141"/><area shape="rect" id="node101" href="../../d7/def/phys_8tools_8c.html#a864ca09eade159d4c4b545593c1095de" title="MHD stress tensor, with first index up, second index down avoids catastrophic cancellation with rest&#45;..." alt="" coords="2035,59,2192,88"/><area shape="rect" id="node105" href="../../d7/def/phys_8tools_8c.html#abc846df49f33c007310b52240e099e3b" title="Notation for HARM paper and JCM&#39;s GRFFE paper is that: B^ = &#160;*F^{} and for lab&#45;frame we chose ={&#45;1..." alt="" coords="2045,5,2181,35"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_a9ffbdaa97489ef748af456f65c779e18_icgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_a9ffbdaa97489ef748af456f65c779e18_icgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_a9ffbdaa97489ef748af456f65c779e18_icgraph" id="d3/ddc/phys_8funcdeclare_8h_a9ffbdaa97489ef748af456f65c779e18_icgraph">
<area shape="rect" id="node3" href="../../d7/def/phys_8tools_8c.html#a12ce5092c3a1a566cb7a560a7440acc1" title="add in source terms to equations of motion ui and dUriemann in UEVOLVE form assume q(pr) so consisten..." alt="" coords="160,32,221,61"/><area shape="rect" id="node5" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="284,5,412,35"/><area shape="rect" id="node17" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="271,59,425,88"/><area shape="rect" id="node7" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="476,5,545,35"/><area shape="rect" id="node9" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="596,5,729,35"/><area shape="rect" id="node11" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="780,5,847,35"/><area shape="rect" id="node13" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="897,5,988,35"/><area shape="rect" id="node15" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="1037,5,1088,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7808b4135837eb79e632c943ba9f19b0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> taper_func </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td>
          <td class="paramname"><em>R</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td>
          <td class="paramname"><em>rin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/def/phys_8tools_8c_source.html#l02856">2856</a> of file <a class="el" href="../../d7/def/phys_8tools_8c_source.html">phys.tools.c</a>.</p>

</div>
</div>
<a class="anchor" id="afc1e1232a2f457b71cfd9210f2b5240a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ucon_calc_3vel </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>geom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>ucon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>others</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>find contravariant four-velocity int <a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#afc93fd4a6f7a2b87a9315d5fba5a529c">ucon_calc(FTYPE *pr, struct of_geom *geom, FTYPE *ucon, FTYPE *others)</a> </p>

<p>Definition at line <a class="el" href="../../d7/def/phys_8tools_8c_source.html#l02544">2544</a> of file <a class="el" href="../../d7/def/phys_8tools_8c_source.html">phys.tools.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_afc1e1232a2f457b71cfd9210f2b5240a_icgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_afc1e1232a2f457b71cfd9210f2b5240a_icgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_afc1e1232a2f457b71cfd9210f2b5240a_icgraph" id="d3/ddc/phys_8funcdeclare_8h_afc1e1232a2f457b71cfd9210f2b5240a_icgraph">
<area shape="rect" id="node3" href="../../d7/def/phys_8tools_8c.html#a36b8e5a9298b2fb8db7b94a7c7bd4b61" title="convert (e^=0 case) b^ and (3&#45;velocity in coordinate lab frame) v^ to pr" alt="" coords="617,95,676,124"/><area shape="rect" id="node17" href="../../d7/def/phys_8tools_8c.html#a35c4399eb86e3fa77e2221000e077572" title="ucon_calc_whichvel" alt="" coords="165,252,304,281"/><area shape="rect" id="node182" href="../../dd/d91/transforms_8funcdeclare_8h.html#a961108634943062c0aac6fd506c744fd" title="convert 3&#45;velocity to whichvel velocity" alt="" coords="201,463,268,492"/><area shape="rect" id="node5" href="../../d8/d60/init_8c.html#af94364e17d67cddfbb7bb3bf39c05ee6" title="init_dsandvels_koral" alt="" coords="1007,111,1145,140"/><area shape="rect" id="node7" href="../../df/d15/init_8tools_8c.html#acefd26944dbbb1c289886f520f6befac" title="init_dsandvels" alt="" coords="1508,111,1612,140"/><area shape="rect" id="node9" href="../../df/d15/init_8tools_8c.html#a77551ab2581efdbaf170dfca073ff9ab" title="user1_init_primitives" alt="" coords="3891,643,4032,672"/><area shape="rect" id="node11" href="../../de/db2/initbase_8funcdeclare_8h.html#a0afa200a5f947b1c9f6e554519f28fc4" title="init_primitives" alt="" coords="4081,643,4183,672"/><area shape="rect" id="node13" href="../../de/df8/initbase_8c.html#ac4110398e386c9888d9565630357dbbe" title="General&#45;Primary init() routine Uses globals inside init() because sets memory and sets physics..." alt="" coords="4260,669,4297,699"/><area shape="rect" id="node15" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="4373,569,4424,599"/><area shape="rect" id="node19" href="../../d8/d60/init_8c.html#ab0bfdee8d9b31f16dbadd2a5108ad29b" title="donut_analytical_solution" alt="" coords="352,172,520,201"/><area shape="rect" id="node28" href="../../d2/d72/phys_8tools_8rad_8c.html#a2ec6ee79c76351868a725b22dac62135" title="like prad_fforlab() but for only whichdir=FF2LAB used for IC" alt="" coords="391,279,481,308"/><area shape="rect" id="node171" href="../../d2/d72/phys_8tools_8rad_8c.html#aa25aa4dfb3559619f276abca5f4b3ca0" title="for BCs, to take E[radiation frame] and u^i as radiation primitives in whichvel/whichcoord obtains WH..." alt="" coords="773,715,912,762"/><area shape="rect" id="node180" href="../../d2/d72/phys_8tools_8rad_8c.html#aa8edd5fc0afc1713ad401c2db92c71e0" title="set velocity based upon ncon and gammamax and return in whichvel format for the ptrgeom geometry/coor..." alt="" coords="373,225,499,255"/><area shape="rect" id="node21" href="../../d8/d60/init_8c.html#a83e7f10ffd348c4d18b3245dd4bab585" title="make_nonrt2rt_solution" alt="" coords="568,172,725,201"/><area shape="rect" id="node23" href="../../d8/d60/init_8c.html#a73009fd6280963c265e2cf5d1c353e8d" title="get_full_rtsolution" alt="" coords="781,172,904,201"/><area shape="rect" id="node26" href="../../d8/d60/init_8c.html#a448cd3fd9a1d862485e7b6e67b965172" title="process_restart_toget\l_radiation" alt="" coords="1003,163,1149,210"/><area shape="rect" id="node30" href="../../d2/d72/phys_8tools_8rad_8c.html#af50896d039d660550b738862b3390b07" title="radiative ortonormal ff primitives (E,F^i) &lt;&#45;&gt; primitives in lab frame Used only for initial conditio..." alt="" coords="601,252,692,281"/><area shape="rect" id="node34" href="../../d2/d72/phys_8tools_8rad_8c.html#a64226cb28f52020ffe18ac6c6b1a2f5c" title="Input: start with pin [with fluid in whichvel velocity and whichcoordfluid coordinates (PRIMECOORDS o..." alt="" coords="777,482,908,529"/><area shape="rect" id="node36" href="../../de/d51/bounds_8c.html#a3bc773d499b145705bdc23125b963840" title="Koral specific physical boundary conditions." alt="" coords="976,697,1176,727"/><area shape="rect" id="node136" href="../../de/d51/bounds_8c.html#a09a080d9895db7b800a3824cb3fac9f1" title="X1 lower for beam injection to create shadow." alt="" coords="996,751,1156,780"/><area shape="rect" id="node139" href="../../de/d51/bounds_8c.html#a3ee134cc5fb18752265c16a20dbdfb63" title="X3 lower for radiation beam injection." alt="" coords="979,804,1173,833"/><area shape="rect" id="node142" href="../../de/d51/bounds_8c.html#a8300ddf3ae6a3866234cc0e9c12f26dc" title="X1 upper for inflow." alt="" coords="1240,387,1427,416"/><area shape="rect" id="node145" href="../../de/d51/bounds_8c.html#a01088f65c7a4cfa2ebfed202f815b951" title="X1 lower and upper for RADATM." alt="" coords="1248,440,1419,469"/><area shape="rect" id="node148" href="../../de/d51/bounds_8c.html#a1382959a7b699ea5d224168612504263" title="X1 upper for inflow." alt="" coords="1260,493,1407,523"/><area shape="rect" id="node151" href="../../de/d51/bounds_8c.html#ac15824bc610943cb7e02112e77b94752" title="on&#45;grid bounding" alt="" coords="1284,547,1383,576"/><area shape="rect" id="node154" href="../../de/d51/bounds_8c.html#a42658c4ecf3c6edb958394eb65a9ac2b" title="RADNT." alt="" coords="1287,600,1380,629"/><area shape="rect" id="node157" href="../../de/d51/bounds_8c.html#a3e4008fd24427b2e91d0ae5882b9536a" title="X1 upper for RADCYLBEAM." alt="" coords="1251,229,1416,259"/><area shape="rect" id="node160" href="../../de/d51/bounds_8c.html#ac32c1a20138382904dc5f1c66778ad8b" title="X1 upper for RADCYLJET." alt="" coords="1003,284,1149,313"/><area shape="rect" id="node163" href="../../de/d51/bounds_8c.html#a635fbaba3d6d6afcf5f34bbb2c278737" title="X2 upper for radiation beam injection." alt="" coords="961,644,1191,673"/><area shape="rect" id="node166" href="../../de/d51/bounds_8c.html#a9f1df4e461f3f776bf3cb80e36a4d6df" title="get_radcylbeamcart" alt="" coords="1008,337,1144,367"/><area shape="rect" id="node38" href="../../de/d51/bounds_8c.html#a34ac3f1ca7b0f3a21053c633da9931a9" title="user boundary routine" alt="" coords="1475,547,1645,576"/><area shape="rect" id="node40" href="../../d4/dad/bounds_8funcdeclare_8h.html#a4bc7413b2cdb89e070f38bbb689ae555" title="bound_prim_user_dir" alt="" coords="1697,493,1839,523"/><area shape="rect" id="node125" href="../../d4/dad/bounds_8funcdeclare_8h.html#a2fbddc9ff8fc706bafa80c39695c7262" title="assume single user function takes care of primitive locations" alt="" coords="1693,671,1843,700"/><area shape="rect" id="node42" href="../../d9/de0/step__ch_8c.html#adbe0e3ba8a74f09ab928a96bd68cab6d" title="bound any prim type CALLS directly real and MPI boundary functions pstag = pstagglobal ucons = unewgl..." alt="" coords="1892,440,2001,469"/><area shape="rect" id="node44" href="../../d9/de0/step__ch_8c.html#a689fddc1949b1a1d390b59d10d17d83c" title="normal full bounding during evolution NOTEMARK: Was previously also bounding pstag here..." alt="" coords="2069,5,2195,35"/><area shape="rect" id="node56" href="../../d9/de0/step__ch_8c.html#a4079244d85c301885c1363ca41502869" title="simple bounding during evolution NOTEMARK: Was previously also bounding pstag here, but not necessary since done by calling bound_pstag in fluxctstag.c" alt="" coords="2051,59,2213,88"/><area shape="rect" id="node59" href="../../d9/de0/step__ch_8c.html#addca75a18cc861326a321565a2e81aa0" title="normal bounding of non&#45;staggered primitives" alt="" coords="2088,440,2176,469"/><area shape="rect" id="node119" href="../../d9/de0/step__ch_8c.html#a460b84e1112e3aef17209c20e22e1cf1" title="bound all prims" alt="" coords="2524,747,2647,776"/><area shape="rect" id="node46" href="../../d9/de0/step__ch_8c.html#ad36a0f9f915547477e3bb2405f8166b9" title="things to do after advance()" alt="" coords="2300,59,2401,88"/><area shape="rect" id="node48" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="3708,59,3841,88"/><area shape="rect" id="node50" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="4099,345,4165,375"/><area shape="rect" id="node52" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="4233,468,4324,497"/><area shape="rect" id="node61" href="../../dc/dae/flux_8c.html#aef355ccd1ca2295b84ad2fe1fc011d35" title="normal interpolation of CENT quantities to FACE quantities sets global variables pl_ct and pr_ct to p..." alt="" coords="2261,163,2440,192"/><area shape="rect" id="node78" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aecb3f613a7cb3bbb42fff2dbee5d65a1" title="This vpot2field function is for staggered method to evolve quasi&#45;deaveraged fields (i..." alt="" coords="2959,541,3124,571"/><area shape="rect" id="node80" href="../../de/db2/initbase_8funcdeclare_8h.html#ae6b2ad4cd0debf5b89ba8a9e471d6977" title="assumes normal field p pleft used as temp var if FLUXB==FLUXCTSTAG assigns conserved field in UEVOLVE..." alt="" coords="3175,569,3252,599"/><area shape="rect" id="node89" href="../../d0/dde/fluxctstag_8c.html#a4e3d76c6ad125b8199948408c262e3a1" title="wrapper for: 1) interpolate FACE 2 CORN 2) loop over dimensions setting field flux dimension&#45;by&#45;dimen..." alt="" coords="2755,268,2885,297"/><area shape="rect" id="node92" href="../../d0/dde/fluxctstag_8c.html#a2dd789bf1402bef72523cdb69e85806e" title="use global pbcorninterp and pvcorninterp at CORN1,2,3 to obtain EMFs at CORN1,2,3 NO interpolation of..." alt="" coords="2285,319,2416,366"/><area shape="rect" id="node95" href="../../d0/dde/fluxctstag_8c.html#aaec26a518629175ecceefbaf6c84225e" title="wrapper for continuous interpolation for FACE_to_CENT" alt="" coords="2264,440,2437,469"/><area shape="rect" id="node99" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aa31dd83c96936277334c62e2098dd51d" title="wrapper for taking staggered conserved field quantity and obtaining centered field quantity upoint en..." alt="" coords="2732,429,2908,459"/><area shape="rect" id="node108" href="../../d0/dde/fluxctstag_8c.html#a6cd90dff56319085b32bc57c0c8b3cfd" title="this function called in initbase.c and during advance() here ustag is point value if dimension doesn&#39;..." alt="" coords="2525,491,2645,520"/><area shape="rect" id="node111" href="../../d0/dde/fluxctstag_8c.html#ad6aa918442f7768dff3c099ba353ee64" title="slope_lim_face2corn() is provided p2interp and returns pleft/pright differs from slope_lim() by range..." alt="" coords="2280,216,2421,245"/><area shape="rect" id="node63" href="../../dc/dae/flux_8c.html#a2602a4dad9ed7adc944227d02435312e" title="standard (non&#45;field flux) calculation but setup to store results of interpolation so can be used for ..." alt="" coords="2488,163,2683,192"/><area shape="rect" id="node65" href="../../dc/dae/flux_8c.html#aaf6d832880760f80459d91477c28b519" title="wrapper for different standard 1&#45;D flux calculators 1&#45;D interpolate and get flux for that direction (..." alt="" coords="2763,163,2877,192"/><area shape="rect" id="node67" href="../../dc/dae/flux_8c.html#a8ffa7399bd5354fdcdec5f3e1adf0b13" title="wrapper for CENT_to_FACE1,2,3 used to compute flux at face" alt="" coords="2995,189,3088,219"/><area shape="rect" id="node69" href="../../d5/d2f/flux_8funcdeclare_8h.html#ab229b0f3f2caf3c0a3ef5299fba2b1c0" title="see fluxcompute.c for non&#45;computer science, real physics calculations of flux" alt="" coords="3180,268,3247,297"/><area shape="rect" id="node71" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="3324,268,3452,297"/><area shape="rect" id="node76" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="3311,360,3465,389"/><area shape="rect" id="node73" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="3556,215,3625,244"/><area shape="rect" id="node82" href="../../df/d15/init_8tools_8c.html#a3750bc790613bc6c8c805af0f1b839c8" title="user1_init_vpot2field_user" alt="" coords="3301,583,3475,612"/><area shape="rect" id="node84" href="../../de/db2/initbase_8funcdeclare_8h.html#afda44281ad5c163455c40f012d4a8954" title="init_vpot2field_user" alt="" coords="3524,589,3657,619"/><area shape="rect" id="node86" href="../../de/db2/initbase_8funcdeclare_8h.html#a90699a18ede8b7f112c0078512804ec1" title="initialize vector potential given user function assumes normal non&#45;staggered field in pr Notice that ..." alt="" coords="3740,591,3809,620"/><area shape="rect" id="node97" href="../../d0/dde/fluxctstag_8c.html#a5e3dcbe89d6f8a9384cafb58afd7dbf4" title="interpolates field at FACE to field at CENT assuming field along itself is continuous" alt="" coords="2525,421,2645,467"/><area shape="rect" id="node103" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aaa24493002bc8c0a527b1ea2ac2dddbf" title="convert conservative U to stag point P and CENT point U and CENT point primitive" alt="" coords="2975,488,3108,517"/><area shape="rect" id="node113" href="../../d0/dde/fluxctstag_8c.html#a985ee116306b4011810334ae93900493" title="INPUTS: Nvec, pr, primface_l[dir], primface_r[dir] OUTPUTS: pbcorn[dir][side], pvcorn[dir][side][side..." alt="" coords="2496,216,2675,245"/><area shape="rect" id="node121" href="../../d9/de0/step__ch_8c.html#a91fe5c4370e3292a19e7f794797a407f" title="normal bounding of all primitives" alt="" coords="3724,747,3825,776"/><area shape="rect" id="node127" href="../../d9/de0/step__ch_8c.html#abdea68b778dc9253324da69d3c376965" title="bound any pstag type CALLS directly real and MPI boundary functions pstag is at FACE1,2,3 for fields, so user bound is different MPI bounding is the same as CENT quantities used when restarting in initbase.c to bound unewglobal for FLUXB==FLUXCTSTAG" alt="" coords="2292,799,2409,828"/><area shape="rect" id="node130" href="../../d9/de0/step__ch_8c.html#a6f4b963a50a7288964f01775f2f18bb9" title="normal bounding of staggered primitives" alt="" coords="2537,800,2633,829"/><area shape="rect" id="node133" href="../../d0/dde/fluxctstag_8c.html#aa169cb1999412f2e2460012cc5d7a804" title="pure DONOR version: upoint is input staggered updated field that needs to be converted to pstag and t..." alt="" coords="2732,797,2908,843"/><area shape="rect" id="node168" href="../../de/d51/bounds_8c.html#a16398a5325a9df48783423f00ba65bb7" title="all boundaries for RADCYLBEAMCART" alt="" coords="1257,333,1409,363"/><area shape="rect" id="node176" href="../../de/d51/bounds_8c.html#a3a96629ab9e350154c992f8a4ce92cbe" title="X1 lower and upper X2." alt="" coords="1264,856,1403,885"/><area shape="rect" id="node184" href="../../d7/def/phys_8tools_8c.html#aa2c7afa7fa986a32084842b885b92140" title="input &#160;and B^i (code&#39;s version) and get back primitive assuming stationary/axisymmetric flow..." alt="" coords="380,383,492,412"/><area shape="rect" id="node186" href="../../d7/def/phys_8tools_8c.html#acb8dd4611f09f3dfb91362b078bc1feb" title="input , 3&#45;vel along field (scalar quantity really), and B^i (code&#39;s version) and get back primitive a..." alt="" coords="377,436,495,465"/><area shape="rect" id="node188" href="../../d7/def/phys_8tools_8c.html#a4701456fc875dfc1fd57bea8cb23e12d" title="input , extra 3&#45;vel along field (scalar quantity really), and B^i (code&#39;s version) and get back primi..." alt="" coords="377,489,495,519"/><area shape="rect" id="node190" href="../../d7/def/phys_8tools_8c.html#a9f04f944ce09544837b829c2a38196bb" title="input , extra 3&#45;vel along the poloidal field (scalar quantity really), and B^i (code&#39;s version) and g..." alt="" coords="373,543,499,572"/><area shape="rect" id="node192" href="../../d7/def/phys_8tools_8c.html#ab744b60b1b2261c77770f921f58e49c2" title="input , extra 3&#45;vel along the normal field (scalar quantity really), and B^i (code&#39;s version) and get..." alt="" coords="373,596,499,625"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad141359a7901a82a0c26241b432183c3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ucon_calc_4vel </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>geom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>ucon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>others</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>find contravariant time component of four-velocity from the 4velocity (3 terms) </p>

<p>Definition at line <a class="el" href="../../d7/def/phys_8tools_8c_source.html#l02772">2772</a> of file <a class="el" href="../../d7/def/phys_8tools_8c_source.html">phys.tools.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_ad141359a7901a82a0c26241b432183c3_cgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_ad141359a7901a82a0c26241b432183c3_cgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_ad141359a7901a82a0c26241b432183c3_cgraph" id="d3/ddc/phys_8funcdeclare_8h_ad141359a7901a82a0c26241b432183c3_cgraph">
<area shape="rect" id="node3" href="../../d9/de9/coord_8c.html#a041e7b005310415c97d90f4b8521ed1a" title="get X(i,j,k) CENT is default position in degenerate cases" alt="" coords="167,5,220,35"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_ad141359a7901a82a0c26241b432183c3_icgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_ad141359a7901a82a0c26241b432183c3_icgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_ad141359a7901a82a0c26241b432183c3_icgraph" id="d3/ddc/phys_8funcdeclare_8h_ad141359a7901a82a0c26241b432183c3_icgraph">
<area shape="rect" id="node3" href="../../d7/def/phys_8tools_8c.html#a35c4399eb86e3fa77e2221000e077572" title="ucon_calc_whichvel" alt="" coords="165,144,304,173"/><area shape="rect" id="node5" href="../../d8/d60/init_8c.html#ab0bfdee8d9b31f16dbadd2a5108ad29b" title="donut_analytical_solution" alt="" coords="352,64,520,93"/><area shape="rect" id="node25" href="../../d2/d72/phys_8tools_8rad_8c.html#a2ec6ee79c76351868a725b22dac62135" title="like prad_fforlab() but for only whichdir=FF2LAB used for IC" alt="" coords="391,117,481,147"/><area shape="rect" id="node168" href="../../d2/d72/phys_8tools_8rad_8c.html#aa25aa4dfb3559619f276abca5f4b3ca0" title="for BCs, to take E[radiation frame] and u^i as radiation primitives in whichvel/whichcoord obtains WH..." alt="" coords="773,610,912,657"/><area shape="rect" id="node177" href="../../d2/d72/phys_8tools_8rad_8c.html#aa8edd5fc0afc1713ad401c2db92c71e0" title="set velocity based upon ncon and gammamax and return in whichvel format for the ptrgeom geometry/coor..." alt="" coords="373,221,499,251"/><area shape="rect" id="node7" href="../../d8/d60/init_8c.html#a83e7f10ffd348c4d18b3245dd4bab585" title="make_nonrt2rt_solution" alt="" coords="568,64,725,93"/><area shape="rect" id="node9" href="../../d8/d60/init_8c.html#a73009fd6280963c265e2cf5d1c353e8d" title="get_full_rtsolution" alt="" coords="781,64,904,93"/><area shape="rect" id="node11" href="../../d8/d60/init_8c.html#af94364e17d67cddfbb7bb3bf39c05ee6" title="init_dsandvels_koral" alt="" coords="1007,5,1145,35"/><area shape="rect" id="node23" href="../../d8/d60/init_8c.html#a448cd3fd9a1d862485e7b6e67b965172" title="process_restart_toget\l_radiation" alt="" coords="1003,58,1149,105"/><area shape="rect" id="node13" href="../../df/d15/init_8tools_8c.html#acefd26944dbbb1c289886f520f6befac" title="init_dsandvels" alt="" coords="1508,5,1612,35"/><area shape="rect" id="node15" href="../../df/d15/init_8tools_8c.html#a77551ab2581efdbaf170dfca073ff9ab" title="user1_init_primitives" alt="" coords="3891,276,4032,305"/><area shape="rect" id="node17" href="../../de/db2/initbase_8funcdeclare_8h.html#a0afa200a5f947b1c9f6e554519f28fc4" title="init_primitives" alt="" coords="4081,301,4183,331"/><area shape="rect" id="node19" href="../../de/df8/initbase_8c.html#ac4110398e386c9888d9565630357dbbe" title="General&#45;Primary init() routine Uses globals inside init() because sets memory and sets physics..." alt="" coords="4260,328,4297,357"/><area shape="rect" id="node21" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="4373,408,4424,437"/><area shape="rect" id="node27" href="../../d2/d72/phys_8tools_8rad_8c.html#af50896d039d660550b738862b3390b07" title="radiative ortonormal ff primitives (E,F^i) &lt;&#45;&gt; primitives in lab frame Used only for initial conditio..." alt="" coords="601,117,692,147"/><area shape="rect" id="node31" href="../../d2/d72/phys_8tools_8rad_8c.html#a64226cb28f52020ffe18ac6c6b1a2f5c" title="Input: start with pin [with fluid in whichvel velocity and whichcoordfluid coordinates (PRIMECOORDS o..." alt="" coords="777,377,908,423"/><area shape="rect" id="node33" href="../../de/d51/bounds_8c.html#a3bc773d499b145705bdc23125b963840" title="Koral specific physical boundary conditions." alt="" coords="976,592,1176,621"/><area shape="rect" id="node133" href="../../de/d51/bounds_8c.html#a09a080d9895db7b800a3824cb3fac9f1" title="X1 lower for beam injection to create shadow." alt="" coords="996,645,1156,675"/><area shape="rect" id="node136" href="../../de/d51/bounds_8c.html#a3ee134cc5fb18752265c16a20dbdfb63" title="X3 lower for radiation beam injection." alt="" coords="979,699,1173,728"/><area shape="rect" id="node139" href="../../de/d51/bounds_8c.html#a8300ddf3ae6a3866234cc0e9c12f26dc" title="X1 upper for inflow." alt="" coords="1240,335,1427,364"/><area shape="rect" id="node142" href="../../de/d51/bounds_8c.html#a01088f65c7a4cfa2ebfed202f815b951" title="X1 lower and upper for RADATM." alt="" coords="1248,388,1419,417"/><area shape="rect" id="node145" href="../../de/d51/bounds_8c.html#a1382959a7b699ea5d224168612504263" title="X1 upper for inflow." alt="" coords="1260,441,1407,471"/><area shape="rect" id="node148" href="../../de/d51/bounds_8c.html#ac15824bc610943cb7e02112e77b94752" title="on&#45;grid bounding" alt="" coords="1284,495,1383,524"/><area shape="rect" id="node151" href="../../de/d51/bounds_8c.html#a42658c4ecf3c6edb958394eb65a9ac2b" title="RADNT." alt="" coords="1287,124,1380,153"/><area shape="rect" id="node154" href="../../de/d51/bounds_8c.html#a3e4008fd24427b2e91d0ae5882b9536a" title="X1 upper for RADCYLBEAM." alt="" coords="1251,177,1416,207"/><area shape="rect" id="node157" href="../../de/d51/bounds_8c.html#ac32c1a20138382904dc5f1c66778ad8b" title="X1 upper for RADCYLJET." alt="" coords="1003,229,1149,259"/><area shape="rect" id="node160" href="../../de/d51/bounds_8c.html#a635fbaba3d6d6afcf5f34bbb2c278737" title="X2 upper for radiation beam injection." alt="" coords="961,539,1191,568"/><area shape="rect" id="node163" href="../../de/d51/bounds_8c.html#a9f1df4e461f3f776bf3cb80e36a4d6df" title="get_radcylbeamcart" alt="" coords="1008,283,1144,312"/><area shape="rect" id="node35" href="../../de/d51/bounds_8c.html#a34ac3f1ca7b0f3a21053c633da9931a9" title="user boundary routine" alt="" coords="1475,441,1645,471"/><area shape="rect" id="node37" href="../../d4/dad/bounds_8funcdeclare_8h.html#a4bc7413b2cdb89e070f38bbb689ae555" title="bound_prim_user_dir" alt="" coords="1697,461,1839,491"/><area shape="rect" id="node122" href="../../d4/dad/bounds_8funcdeclare_8h.html#a2fbddc9ff8fc706bafa80c39695c7262" title="assume single user function takes care of primitive locations" alt="" coords="1693,256,1843,285"/><area shape="rect" id="node39" href="../../d9/de0/step__ch_8c.html#adbe0e3ba8a74f09ab928a96bd68cab6d" title="bound any prim type CALLS directly real and MPI boundary functions pstag = pstagglobal ucons = unewgl..." alt="" coords="1892,483,2001,512"/><area shape="rect" id="node41" href="../../d9/de0/step__ch_8c.html#a689fddc1949b1a1d390b59d10d17d83c" title="normal full bounding during evolution NOTEMARK: Was previously also bounding pstag here..." alt="" coords="2069,809,2195,839"/><area shape="rect" id="node53" href="../../d9/de0/step__ch_8c.html#a4079244d85c301885c1363ca41502869" title="simple bounding during evolution NOTEMARK: Was previously also bounding pstag here, but not necessary since done by calling bound_pstag in fluxctstag.c" alt="" coords="2051,863,2213,892"/><area shape="rect" id="node56" href="../../d9/de0/step__ch_8c.html#addca75a18cc861326a321565a2e81aa0" title="normal bounding of non&#45;staggered primitives" alt="" coords="2088,483,2176,512"/><area shape="rect" id="node116" href="../../d9/de0/step__ch_8c.html#a460b84e1112e3aef17209c20e22e1cf1" title="bound all prims" alt="" coords="2524,115,2647,144"/><area shape="rect" id="node43" href="../../d9/de0/step__ch_8c.html#ad36a0f9f915547477e3bb2405f8166b9" title="things to do after advance()" alt="" coords="2300,863,2401,892"/><area shape="rect" id="node45" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="3708,769,3841,799"/><area shape="rect" id="node47" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="4099,645,4165,675"/><area shape="rect" id="node49" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="4233,488,4324,517"/><area shape="rect" id="node58" href="../../dc/dae/flux_8c.html#aef355ccd1ca2295b84ad2fe1fc011d35" title="normal interpolation of CENT quantities to FACE quantities sets global variables pl_ct and pr_ct to p..." alt="" coords="2261,585,2440,615"/><area shape="rect" id="node75" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aecb3f613a7cb3bbb42fff2dbee5d65a1" title="This vpot2field function is for staggered method to evolve quasi&#45;deaveraged fields (i..." alt="" coords="2959,225,3124,255"/><area shape="rect" id="node77" href="../../de/db2/initbase_8funcdeclare_8h.html#ae6b2ad4cd0debf5b89ba8a9e471d6977" title="assumes normal field p pleft used as temp var if FLUXB==FLUXCTSTAG assigns conserved field in UEVOLVE..." alt="" coords="3175,276,3252,305"/><area shape="rect" id="node86" href="../../d0/dde/fluxctstag_8c.html#a4e3d76c6ad125b8199948408c262e3a1" title="wrapper for: 1) interpolate FACE 2 CORN 2) loop over dimensions setting field flux dimension&#45;by&#45;dimen..." alt="" coords="2755,683,2885,712"/><area shape="rect" id="node89" href="../../d0/dde/fluxctstag_8c.html#a2dd789bf1402bef72523cdb69e85806e" title="use global pbcorninterp and pvcorninterp at CORN1,2,3 to obtain EMFs at CORN1,2,3 NO interpolation of..." alt="" coords="2285,638,2416,685"/><area shape="rect" id="node92" href="../../d0/dde/fluxctstag_8c.html#aaec26a518629175ecceefbaf6c84225e" title="wrapper for continuous interpolation for FACE_to_CENT" alt="" coords="2264,431,2437,460"/><area shape="rect" id="node96" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aa31dd83c96936277334c62e2098dd51d" title="wrapper for taking staggered conserved field quantity and obtaining centered field quantity upoint en..." alt="" coords="2732,500,2908,529"/><area shape="rect" id="node105" href="../../d0/dde/fluxctstag_8c.html#a6cd90dff56319085b32bc57c0c8b3cfd" title="this function called in initbase.c and during advance() here ustag is point value if dimension doesn&#39;..." alt="" coords="2525,500,2645,529"/><area shape="rect" id="node108" href="../../d0/dde/fluxctstag_8c.html#ad6aa918442f7768dff3c099ba353ee64" title="slope_lim_face2corn() is provided p2interp and returns pleft/pright differs from slope_lim() by range..." alt="" coords="2280,708,2421,737"/><area shape="rect" id="node60" href="../../dc/dae/flux_8c.html#a2602a4dad9ed7adc944227d02435312e" title="standard (non&#45;field flux) calculation but setup to store results of interpolation so can be used for ..." alt="" coords="2488,604,2683,633"/><area shape="rect" id="node62" href="../../dc/dae/flux_8c.html#aaf6d832880760f80459d91477c28b519" title="wrapper for different standard 1&#45;D flux calculators 1&#45;D interpolate and get flux for that direction (..." alt="" coords="2763,604,2877,633"/><area shape="rect" id="node64" href="../../dc/dae/flux_8c.html#a8ffa7399bd5354fdcdec5f3e1adf0b13" title="wrapper for CENT_to_FACE1,2,3 used to compute flux at face" alt="" coords="2995,604,3088,633"/><area shape="rect" id="node66" href="../../d5/d2f/flux_8funcdeclare_8h.html#ab229b0f3f2caf3c0a3ef5299fba2b1c0" title="see fluxcompute.c for non&#45;computer science, real physics calculations of flux" alt="" coords="3180,604,3247,633"/><area shape="rect" id="node68" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="3324,604,3452,633"/><area shape="rect" id="node73" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="3311,525,3465,555"/><area shape="rect" id="node70" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="3556,681,3625,711"/><area shape="rect" id="node79" href="../../df/d15/init_8tools_8c.html#a3750bc790613bc6c8c805af0f1b839c8" title="user1_init_vpot2field_user" alt="" coords="3301,276,3475,305"/><area shape="rect" id="node81" href="../../de/db2/initbase_8funcdeclare_8h.html#afda44281ad5c163455c40f012d4a8954" title="init_vpot2field_user" alt="" coords="3524,276,3657,305"/><area shape="rect" id="node83" href="../../de/db2/initbase_8funcdeclare_8h.html#a90699a18ede8b7f112c0078512804ec1" title="initialize vector potential given user function assumes normal non&#45;staggered field in pr Notice that ..." alt="" coords="3740,276,3809,305"/><area shape="rect" id="node94" href="../../d0/dde/fluxctstag_8c.html#a5e3dcbe89d6f8a9384cafb58afd7dbf4" title="interpolates field at FACE to field at CENT assuming field along itself is continuous" alt="" coords="2525,430,2645,477"/><area shape="rect" id="node100" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aaa24493002bc8c0a527b1ea2ac2dddbf" title="convert conservative U to stag point P and CENT point U and CENT point primitive" alt="" coords="2975,431,3108,460"/><area shape="rect" id="node110" href="../../d0/dde/fluxctstag_8c.html#a985ee116306b4011810334ae93900493" title="INPUTS: Nvec, pr, primface_l[dir], primface_r[dir] OUTPUTS: pbcorn[dir][side], pvcorn[dir][side][side..." alt="" coords="2496,708,2675,737"/><area shape="rect" id="node118" href="../../d9/de0/step__ch_8c.html#a91fe5c4370e3292a19e7f794797a407f" title="normal bounding of all primitives" alt="" coords="3724,223,3825,252"/><area shape="rect" id="node124" href="../../d9/de0/step__ch_8c.html#abdea68b778dc9253324da69d3c376965" title="bound any pstag type CALLS directly real and MPI boundary functions pstag is at FACE1,2,3 for fields, so user bound is different MPI bounding is the same as CENT quantities used when restarting in initbase.c to bound unewglobal for FLUXB==FLUXCTSTAG" alt="" coords="2292,120,2409,149"/><area shape="rect" id="node127" href="../../d9/de0/step__ch_8c.html#a6f4b963a50a7288964f01775f2f18bb9" title="normal bounding of staggered primitives" alt="" coords="2537,168,2633,197"/><area shape="rect" id="node130" href="../../d0/dde/fluxctstag_8c.html#aa169cb1999412f2e2460012cc5d7a804" title="pure DONOR version: upoint is input staggered updated field that needs to be converted to pstag and t..." alt="" coords="2732,158,2908,205"/><area shape="rect" id="node165" href="../../de/d51/bounds_8c.html#a16398a5325a9df48783423f00ba65bb7" title="all boundaries for RADCYLBEAMCART" alt="" coords="1257,281,1409,311"/><area shape="rect" id="node173" href="../../de/d51/bounds_8c.html#a3a96629ab9e350154c992f8a4ce92cbe" title="X1 lower and upper X2." alt="" coords="1264,751,1403,780"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a14046b9dfb71c88d01cb79d3f6dfc5ee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ucon_calc_4vel_bothut </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>geom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>ucon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>ucon2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>others</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>find contravariant time component of four-velocity from the 4velocity (3 terms) </p>

<p>Definition at line <a class="el" href="../../d7/def/phys_8tools_8c_source.html#l02724">2724</a> of file <a class="el" href="../../d7/def/phys_8tools_8c_source.html">phys.tools.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_a14046b9dfb71c88d01cb79d3f6dfc5ee_cgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_a14046b9dfb71c88d01cb79d3f6dfc5ee_cgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_a14046b9dfb71c88d01cb79d3f6dfc5ee_cgraph" id="d3/ddc/phys_8funcdeclare_8h_a14046b9dfb71c88d01cb79d3f6dfc5ee_cgraph">
<area shape="rect" id="node3" href="../../d9/de9/coord_8c.html#a041e7b005310415c97d90f4b8521ed1a" title="get X(i,j,k) CENT is default position in degenerate cases" alt="" coords="209,5,263,35"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_a14046b9dfb71c88d01cb79d3f6dfc5ee_icgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_a14046b9dfb71c88d01cb79d3f6dfc5ee_icgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_a14046b9dfb71c88d01cb79d3f6dfc5ee_icgraph" id="d3/ddc/phys_8funcdeclare_8h_a14046b9dfb71c88d01cb79d3f6dfc5ee_icgraph">
<area shape="rect" id="node3" href="../../db/dd4/global_8bounds_8h.html#a9a5016022af4117fe708ebab673a91d4" title="OPTMARK: all get_geometries, etc." alt="" coords="208,472,291,501"/><area shape="rect" id="node5" href="../../db/dd4/global_8bounds_8h.html#a000f433841bad95b82599a74f25a4373" title="X1 inner OUTFLOW/FIXEDOUTFLOW." alt="" coords="339,445,480,475"/><area shape="rect" id="node112" href="../../db/dd4/global_8bounds_8h.html#aa83afbdba4cf034f24b65a58fe834929" title="X1 outer OUTFLOW/FIXEDOUTFLOW." alt="" coords="339,499,480,528"/><area shape="rect" id="node7" href="../../de/d51/bounds_8c.html#a34ac3f1ca7b0f3a21053c633da9931a9" title="user boundary routine" alt="" coords="528,472,699,501"/><area shape="rect" id="node9" href="../../d4/dad/bounds_8funcdeclare_8h.html#a4bc7413b2cdb89e070f38bbb689ae555" title="bound_prim_user_dir" alt="" coords="751,419,892,448"/><area shape="rect" id="node101" href="../../d4/dad/bounds_8funcdeclare_8h.html#a2fbddc9ff8fc706bafa80c39695c7262" title="assume single user function takes care of primitive locations" alt="" coords="747,659,896,688"/><area shape="rect" id="node11" href="../../d9/de0/step__ch_8c.html#adbe0e3ba8a74f09ab928a96bd68cab6d" title="bound any prim type CALLS directly real and MPI boundary functions pstag = pstagglobal ucons = unewgl..." alt="" coords="945,372,1055,401"/><area shape="rect" id="node13" href="../../d9/de0/step__ch_8c.html#a689fddc1949b1a1d390b59d10d17d83c" title="normal full bounding during evolution NOTEMARK: Was previously also bounding pstag here..." alt="" coords="1123,43,1248,72"/><area shape="rect" id="node26" href="../../d9/de0/step__ch_8c.html#a4079244d85c301885c1363ca41502869" title="simple bounding during evolution NOTEMARK: Was previously also bounding pstag here, but not necessary since done by calling bound_pstag in fluxctstag.c" alt="" coords="1104,207,1267,236"/><area shape="rect" id="node29" href="../../d9/de0/step__ch_8c.html#addca75a18cc861326a321565a2e81aa0" title="normal bounding of non&#45;staggered primitives" alt="" coords="1141,372,1229,401"/><area shape="rect" id="node95" href="../../d9/de0/step__ch_8c.html#a460b84e1112e3aef17209c20e22e1cf1" title="bound all prims" alt="" coords="1577,757,1700,787"/><area shape="rect" id="node15" href="../../d9/de0/step__ch_8c.html#ad36a0f9f915547477e3bb2405f8166b9" title="things to do after advance()" alt="" coords="1353,43,1455,72"/><area shape="rect" id="node17" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="2761,119,2895,148"/><area shape="rect" id="node19" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="2981,169,3048,199"/><area shape="rect" id="node21" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="3287,325,3377,355"/><area shape="rect" id="node23" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="3427,416,3477,445"/><area shape="rect" id="node31" href="../../dc/dae/flux_8c.html#aef355ccd1ca2295b84ad2fe1fc011d35" title="normal interpolation of CENT quantities to FACE quantities sets global variables pl_ct and pr_ct to p..." alt="" coords="1315,269,1493,299"/><area shape="rect" id="node48" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aecb3f613a7cb3bbb42fff2dbee5d65a1" title="This vpot2field function is for staggered method to evolve quasi&#45;deaveraged fields (i..." alt="" coords="2012,647,2177,676"/><area shape="rect" id="node50" href="../../de/db2/initbase_8funcdeclare_8h.html#ae6b2ad4cd0debf5b89ba8a9e471d6977" title="assumes normal field p pleft used as temp var if FLUXB==FLUXCTSTAG assigns conserved field in UEVOLVE..." alt="" coords="2228,596,2305,625"/><area shape="rect" id="node58" href="../../df/d15/init_8tools_8c.html#a77551ab2581efdbaf170dfca073ff9ab" title="user1_init_primitives" alt="" coords="2944,583,3085,612"/><area shape="rect" id="node62" href="../../de/df8/initbase_8c.html#ac4110398e386c9888d9565630357dbbe" title="General&#45;Primary init() routine Uses globals inside init() because sets memory and sets physics..." alt="" coords="3313,505,3351,535"/><area shape="rect" id="node65" href="../../d0/dde/fluxctstag_8c.html#a4e3d76c6ad125b8199948408c262e3a1" title="wrapper for: 1) interpolate FACE 2 CORN 2) loop over dimensions setting field flux dimension&#45;by&#45;dimen..." alt="" coords="1808,189,1939,219"/><area shape="rect" id="node68" href="../../d0/dde/fluxctstag_8c.html#a2dd789bf1402bef72523cdb69e85806e" title="use global pbcorninterp and pvcorninterp at CORN1,2,3 to obtain EMFs at CORN1,2,3 NO interpolation of..." alt="" coords="1339,95,1469,142"/><area shape="rect" id="node71" href="../../d0/dde/fluxctstag_8c.html#aaec26a518629175ecceefbaf6c84225e" title="wrapper for continuous interpolation for FACE_to_CENT" alt="" coords="1317,428,1491,457"/><area shape="rect" id="node75" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aa31dd83c96936277334c62e2098dd51d" title="wrapper for taking staggered conserved field quantity and obtaining centered field quantity upoint en..." alt="" coords="1785,372,1961,401"/><area shape="rect" id="node84" href="../../d0/dde/fluxctstag_8c.html#a6cd90dff56319085b32bc57c0c8b3cfd" title="this function called in initbase.c and during advance() here ustag is point value if dimension doesn&#39;..." alt="" coords="1579,372,1699,401"/><area shape="rect" id="node87" href="../../d0/dde/fluxctstag_8c.html#ad6aa918442f7768dff3c099ba353ee64" title="slope_lim_face2corn() is provided p2interp and returns pleft/pright differs from slope_lim() by range..." alt="" coords="1333,165,1475,195"/><area shape="rect" id="node33" href="../../dc/dae/flux_8c.html#a2602a4dad9ed7adc944227d02435312e" title="standard (non&#45;field flux) calculation but setup to store results of interpolation so can be used for ..." alt="" coords="1541,268,1736,297"/><area shape="rect" id="node35" href="../../dc/dae/flux_8c.html#aaf6d832880760f80459d91477c28b519" title="wrapper for different standard 1&#45;D flux calculators 1&#45;D interpolate and get flux for that direction (..." alt="" coords="1816,268,1931,297"/><area shape="rect" id="node37" href="../../dc/dae/flux_8c.html#a8ffa7399bd5354fdcdec5f3e1adf0b13" title="wrapper for CENT_to_FACE1,2,3 used to compute flux at face" alt="" coords="2048,268,2141,297"/><area shape="rect" id="node39" href="../../d5/d2f/flux_8funcdeclare_8h.html#ab229b0f3f2caf3c0a3ef5299fba2b1c0" title="see fluxcompute.c for non&#45;computer science, real physics calculations of flux" alt="" coords="2233,268,2300,297"/><area shape="rect" id="node41" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="2377,268,2505,297"/><area shape="rect" id="node46" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="2364,347,2519,376"/><area shape="rect" id="node43" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="2609,185,2679,215"/><area shape="rect" id="node52" href="../../df/d15/init_8tools_8c.html#a3750bc790613bc6c8c805af0f1b839c8" title="user1_init_vpot2field_user" alt="" coords="2355,596,2528,625"/><area shape="rect" id="node54" href="../../de/db2/initbase_8funcdeclare_8h.html#afda44281ad5c163455c40f012d4a8954" title="init_vpot2field_user" alt="" coords="2577,596,2711,625"/><area shape="rect" id="node56" href="../../de/db2/initbase_8funcdeclare_8h.html#a90699a18ede8b7f112c0078512804ec1" title="initialize vector potential given user function assumes normal non&#45;staggered field in pr Notice that ..." alt="" coords="2793,596,2863,625"/><area shape="rect" id="node60" href="../../de/db2/initbase_8funcdeclare_8h.html#a0afa200a5f947b1c9f6e554519f28fc4" title="init_primitives" alt="" coords="3135,557,3236,587"/><area shape="rect" id="node73" href="../../d0/dde/fluxctstag_8c.html#a5e3dcbe89d6f8a9384cafb58afd7dbf4" title="interpolates field at FACE to field at CENT assuming field along itself is continuous" alt="" coords="1579,425,1699,471"/><area shape="rect" id="node79" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aaa24493002bc8c0a527b1ea2ac2dddbf" title="convert conservative U to stag point P and CENT point U and CENT point primitive" alt="" coords="2028,492,2161,521"/><area shape="rect" id="node89" href="../../d0/dde/fluxctstag_8c.html#a985ee116306b4011810334ae93900493" title="INPUTS: Nvec, pr, primface_l[dir], primface_r[dir] OUTPUTS: pbcorn[dir][side], pvcorn[dir][side][side..." alt="" coords="1549,164,1728,193"/><area shape="rect" id="node97" href="../../d9/de0/step__ch_8c.html#a91fe5c4370e3292a19e7f794797a407f" title="normal bounding of all primitives" alt="" coords="2777,649,2879,679"/><area shape="rect" id="node103" href="../../d9/de0/step__ch_8c.html#abdea68b778dc9253324da69d3c376965" title="bound any pstag type CALLS directly real and MPI boundary functions pstag is at FACE1,2,3 for fields, so user bound is different MPI bounding is the same as CENT quantities used when restarting in initbase.c to bound unewglobal for FLUXB==FLUXCTSTAG" alt="" coords="1345,756,1463,785"/><area shape="rect" id="node106" href="../../d9/de0/step__ch_8c.html#a6f4b963a50a7288964f01775f2f18bb9" title="normal bounding of staggered primitives" alt="" coords="1591,704,1687,733"/><area shape="rect" id="node109" href="../../d0/dde/fluxctstag_8c.html#aa169cb1999412f2e2460012cc5d7a804" title="pure DONOR version: upoint is input staggered updated field that needs to be converted to pstag and t..." alt="" coords="1785,697,1961,743"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7aadb359813194586356c2c325322a45"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ucon_calc_rel4vel </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>geom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>ucon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>others</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>find contravariant four-velocity from the relative 4 velocity </p>

<p>Definition at line <a class="el" href="../../d7/def/phys_8tools_8c_source.html#l02401">2401</a> of file <a class="el" href="../../d7/def/phys_8tools_8c_source.html">phys.tools.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_a7aadb359813194586356c2c325322a45_cgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_a7aadb359813194586356c2c325322a45_cgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_a7aadb359813194586356c2c325322a45_cgraph" id="d3/ddc/phys_8funcdeclare_8h_a7aadb359813194586356c2c325322a45_cgraph">
<area shape="rect" id="node3" href="../../d3/ddc/phys_8funcdeclare_8h.html#a5910aabe5e76183d341ef5b830b01bab" title="find {u}^ from u^ only fill spatial parts so can feed in 3&#45;vector" alt="" coords="251,5,315,35"/><area shape="rect" id="node5" href="../../d3/ddc/phys_8funcdeclare_8h.html#a20be479a3f03f3de780359d6e9290fe3" title="find u^ from {u}^ fill full 4&#45;vector OPTMARK: Before storing , this was the most expensive function o..." alt="" coords="183,59,383,88"/><area shape="rect" id="node7" href="../../d3/ddc/phys_8funcdeclare_8h.html#abfae38e47b0bd05a4fc38302ff948a96" title="find gamma&#45;factor wrt normal observer This function and qsq_calc() have about the same cache miss amo..." alt="" coords="432,59,603,88"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_a7aadb359813194586356c2c325322a45_icgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_a7aadb359813194586356c2c325322a45_icgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_a7aadb359813194586356c2c325322a45_icgraph" id="d3/ddc/phys_8funcdeclare_8h_a7aadb359813194586356c2c325322a45_icgraph">
<area shape="rect" id="node3" href="../../d7/def/phys_8tools_8c.html#a35c4399eb86e3fa77e2221000e077572" title="ucon_calc_whichvel" alt="" coords="181,144,320,173"/><area shape="rect" id="node5" href="../../d8/d60/init_8c.html#ab0bfdee8d9b31f16dbadd2a5108ad29b" title="donut_analytical_solution" alt="" coords="368,64,536,93"/><area shape="rect" id="node25" href="../../d2/d72/phys_8tools_8rad_8c.html#a2ec6ee79c76351868a725b22dac62135" title="like prad_fforlab() but for only whichdir=FF2LAB used for IC" alt="" coords="407,117,497,147"/><area shape="rect" id="node168" href="../../d2/d72/phys_8tools_8rad_8c.html#aa25aa4dfb3559619f276abca5f4b3ca0" title="for BCs, to take E[radiation frame] and u^i as radiation primitives in whichvel/whichcoord obtains WH..." alt="" coords="789,610,928,657"/><area shape="rect" id="node177" href="../../d2/d72/phys_8tools_8rad_8c.html#aa8edd5fc0afc1713ad401c2db92c71e0" title="set velocity based upon ncon and gammamax and return in whichvel format for the ptrgeom geometry/coor..." alt="" coords="389,221,515,251"/><area shape="rect" id="node7" href="../../d8/d60/init_8c.html#a83e7f10ffd348c4d18b3245dd4bab585" title="make_nonrt2rt_solution" alt="" coords="584,64,741,93"/><area shape="rect" id="node9" href="../../d8/d60/init_8c.html#a73009fd6280963c265e2cf5d1c353e8d" title="get_full_rtsolution" alt="" coords="797,64,920,93"/><area shape="rect" id="node11" href="../../d8/d60/init_8c.html#af94364e17d67cddfbb7bb3bf39c05ee6" title="init_dsandvels_koral" alt="" coords="1023,5,1161,35"/><area shape="rect" id="node23" href="../../d8/d60/init_8c.html#a448cd3fd9a1d862485e7b6e67b965172" title="process_restart_toget\l_radiation" alt="" coords="1019,58,1165,105"/><area shape="rect" id="node13" href="../../df/d15/init_8tools_8c.html#acefd26944dbbb1c289886f520f6befac" title="init_dsandvels" alt="" coords="1524,5,1628,35"/><area shape="rect" id="node15" href="../../df/d15/init_8tools_8c.html#a77551ab2581efdbaf170dfca073ff9ab" title="user1_init_primitives" alt="" coords="3907,276,4048,305"/><area shape="rect" id="node17" href="../../de/db2/initbase_8funcdeclare_8h.html#a0afa200a5f947b1c9f6e554519f28fc4" title="init_primitives" alt="" coords="4097,301,4199,331"/><area shape="rect" id="node19" href="../../de/df8/initbase_8c.html#ac4110398e386c9888d9565630357dbbe" title="General&#45;Primary init() routine Uses globals inside init() because sets memory and sets physics..." alt="" coords="4276,328,4313,357"/><area shape="rect" id="node21" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="4389,408,4440,437"/><area shape="rect" id="node27" href="../../d2/d72/phys_8tools_8rad_8c.html#af50896d039d660550b738862b3390b07" title="radiative ortonormal ff primitives (E,F^i) &lt;&#45;&gt; primitives in lab frame Used only for initial conditio..." alt="" coords="617,117,708,147"/><area shape="rect" id="node31" href="../../d2/d72/phys_8tools_8rad_8c.html#a64226cb28f52020ffe18ac6c6b1a2f5c" title="Input: start with pin [with fluid in whichvel velocity and whichcoordfluid coordinates (PRIMECOORDS o..." alt="" coords="793,377,924,423"/><area shape="rect" id="node33" href="../../de/d51/bounds_8c.html#a3bc773d499b145705bdc23125b963840" title="Koral specific physical boundary conditions." alt="" coords="992,592,1192,621"/><area shape="rect" id="node133" href="../../de/d51/bounds_8c.html#a09a080d9895db7b800a3824cb3fac9f1" title="X1 lower for beam injection to create shadow." alt="" coords="1012,645,1172,675"/><area shape="rect" id="node136" href="../../de/d51/bounds_8c.html#a3ee134cc5fb18752265c16a20dbdfb63" title="X3 lower for radiation beam injection." alt="" coords="995,699,1189,728"/><area shape="rect" id="node139" href="../../de/d51/bounds_8c.html#a8300ddf3ae6a3866234cc0e9c12f26dc" title="X1 upper for inflow." alt="" coords="1256,335,1443,364"/><area shape="rect" id="node142" href="../../de/d51/bounds_8c.html#a01088f65c7a4cfa2ebfed202f815b951" title="X1 lower and upper for RADATM." alt="" coords="1264,388,1435,417"/><area shape="rect" id="node145" href="../../de/d51/bounds_8c.html#a1382959a7b699ea5d224168612504263" title="X1 upper for inflow." alt="" coords="1276,441,1423,471"/><area shape="rect" id="node148" href="../../de/d51/bounds_8c.html#ac15824bc610943cb7e02112e77b94752" title="on&#45;grid bounding" alt="" coords="1300,495,1399,524"/><area shape="rect" id="node151" href="../../de/d51/bounds_8c.html#a42658c4ecf3c6edb958394eb65a9ac2b" title="RADNT." alt="" coords="1303,124,1396,153"/><area shape="rect" id="node154" href="../../de/d51/bounds_8c.html#a3e4008fd24427b2e91d0ae5882b9536a" title="X1 upper for RADCYLBEAM." alt="" coords="1267,177,1432,207"/><area shape="rect" id="node157" href="../../de/d51/bounds_8c.html#ac32c1a20138382904dc5f1c66778ad8b" title="X1 upper for RADCYLJET." alt="" coords="1019,229,1165,259"/><area shape="rect" id="node160" href="../../de/d51/bounds_8c.html#a635fbaba3d6d6afcf5f34bbb2c278737" title="X2 upper for radiation beam injection." alt="" coords="977,539,1207,568"/><area shape="rect" id="node163" href="../../de/d51/bounds_8c.html#a9f1df4e461f3f776bf3cb80e36a4d6df" title="get_radcylbeamcart" alt="" coords="1024,283,1160,312"/><area shape="rect" id="node35" href="../../de/d51/bounds_8c.html#a34ac3f1ca7b0f3a21053c633da9931a9" title="user boundary routine" alt="" coords="1491,441,1661,471"/><area shape="rect" id="node37" href="../../d4/dad/bounds_8funcdeclare_8h.html#a4bc7413b2cdb89e070f38bbb689ae555" title="bound_prim_user_dir" alt="" coords="1713,461,1855,491"/><area shape="rect" id="node122" href="../../d4/dad/bounds_8funcdeclare_8h.html#a2fbddc9ff8fc706bafa80c39695c7262" title="assume single user function takes care of primitive locations" alt="" coords="1709,256,1859,285"/><area shape="rect" id="node39" href="../../d9/de0/step__ch_8c.html#adbe0e3ba8a74f09ab928a96bd68cab6d" title="bound any prim type CALLS directly real and MPI boundary functions pstag = pstagglobal ucons = unewgl..." alt="" coords="1908,483,2017,512"/><area shape="rect" id="node41" href="../../d9/de0/step__ch_8c.html#a689fddc1949b1a1d390b59d10d17d83c" title="normal full bounding during evolution NOTEMARK: Was previously also bounding pstag here..." alt="" coords="2085,809,2211,839"/><area shape="rect" id="node53" href="../../d9/de0/step__ch_8c.html#a4079244d85c301885c1363ca41502869" title="simple bounding during evolution NOTEMARK: Was previously also bounding pstag here, but not necessary since done by calling bound_pstag in fluxctstag.c" alt="" coords="2067,863,2229,892"/><area shape="rect" id="node56" href="../../d9/de0/step__ch_8c.html#addca75a18cc861326a321565a2e81aa0" title="normal bounding of non&#45;staggered primitives" alt="" coords="2104,483,2192,512"/><area shape="rect" id="node116" href="../../d9/de0/step__ch_8c.html#a460b84e1112e3aef17209c20e22e1cf1" title="bound all prims" alt="" coords="2540,115,2663,144"/><area shape="rect" id="node43" href="../../d9/de0/step__ch_8c.html#ad36a0f9f915547477e3bb2405f8166b9" title="things to do after advance()" alt="" coords="2316,863,2417,892"/><area shape="rect" id="node45" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="3724,769,3857,799"/><area shape="rect" id="node47" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="4115,645,4181,675"/><area shape="rect" id="node49" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="4249,488,4340,517"/><area shape="rect" id="node58" href="../../dc/dae/flux_8c.html#aef355ccd1ca2295b84ad2fe1fc011d35" title="normal interpolation of CENT quantities to FACE quantities sets global variables pl_ct and pr_ct to p..." alt="" coords="2277,585,2456,615"/><area shape="rect" id="node75" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aecb3f613a7cb3bbb42fff2dbee5d65a1" title="This vpot2field function is for staggered method to evolve quasi&#45;deaveraged fields (i..." alt="" coords="2975,225,3140,255"/><area shape="rect" id="node77" href="../../de/db2/initbase_8funcdeclare_8h.html#ae6b2ad4cd0debf5b89ba8a9e471d6977" title="assumes normal field p pleft used as temp var if FLUXB==FLUXCTSTAG assigns conserved field in UEVOLVE..." alt="" coords="3191,276,3268,305"/><area shape="rect" id="node86" href="../../d0/dde/fluxctstag_8c.html#a4e3d76c6ad125b8199948408c262e3a1" title="wrapper for: 1) interpolate FACE 2 CORN 2) loop over dimensions setting field flux dimension&#45;by&#45;dimen..." alt="" coords="2771,683,2901,712"/><area shape="rect" id="node89" href="../../d0/dde/fluxctstag_8c.html#a2dd789bf1402bef72523cdb69e85806e" title="use global pbcorninterp and pvcorninterp at CORN1,2,3 to obtain EMFs at CORN1,2,3 NO interpolation of..." alt="" coords="2301,638,2432,685"/><area shape="rect" id="node92" href="../../d0/dde/fluxctstag_8c.html#aaec26a518629175ecceefbaf6c84225e" title="wrapper for continuous interpolation for FACE_to_CENT" alt="" coords="2280,431,2453,460"/><area shape="rect" id="node96" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aa31dd83c96936277334c62e2098dd51d" title="wrapper for taking staggered conserved field quantity and obtaining centered field quantity upoint en..." alt="" coords="2748,500,2924,529"/><area shape="rect" id="node105" href="../../d0/dde/fluxctstag_8c.html#a6cd90dff56319085b32bc57c0c8b3cfd" title="this function called in initbase.c and during advance() here ustag is point value if dimension doesn&#39;..." alt="" coords="2541,500,2661,529"/><area shape="rect" id="node108" href="../../d0/dde/fluxctstag_8c.html#ad6aa918442f7768dff3c099ba353ee64" title="slope_lim_face2corn() is provided p2interp and returns pleft/pright differs from slope_lim() by range..." alt="" coords="2296,708,2437,737"/><area shape="rect" id="node60" href="../../dc/dae/flux_8c.html#a2602a4dad9ed7adc944227d02435312e" title="standard (non&#45;field flux) calculation but setup to store results of interpolation so can be used for ..." alt="" coords="2504,604,2699,633"/><area shape="rect" id="node62" href="../../dc/dae/flux_8c.html#aaf6d832880760f80459d91477c28b519" title="wrapper for different standard 1&#45;D flux calculators 1&#45;D interpolate and get flux for that direction (..." alt="" coords="2779,604,2893,633"/><area shape="rect" id="node64" href="../../dc/dae/flux_8c.html#a8ffa7399bd5354fdcdec5f3e1adf0b13" title="wrapper for CENT_to_FACE1,2,3 used to compute flux at face" alt="" coords="3011,604,3104,633"/><area shape="rect" id="node66" href="../../d5/d2f/flux_8funcdeclare_8h.html#ab229b0f3f2caf3c0a3ef5299fba2b1c0" title="see fluxcompute.c for non&#45;computer science, real physics calculations of flux" alt="" coords="3196,604,3263,633"/><area shape="rect" id="node68" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="3340,604,3468,633"/><area shape="rect" id="node73" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="3327,525,3481,555"/><area shape="rect" id="node70" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="3572,681,3641,711"/><area shape="rect" id="node79" href="../../df/d15/init_8tools_8c.html#a3750bc790613bc6c8c805af0f1b839c8" title="user1_init_vpot2field_user" alt="" coords="3317,276,3491,305"/><area shape="rect" id="node81" href="../../de/db2/initbase_8funcdeclare_8h.html#afda44281ad5c163455c40f012d4a8954" title="init_vpot2field_user" alt="" coords="3540,276,3673,305"/><area shape="rect" id="node83" href="../../de/db2/initbase_8funcdeclare_8h.html#a90699a18ede8b7f112c0078512804ec1" title="initialize vector potential given user function assumes normal non&#45;staggered field in pr Notice that ..." alt="" coords="3756,276,3825,305"/><area shape="rect" id="node94" href="../../d0/dde/fluxctstag_8c.html#a5e3dcbe89d6f8a9384cafb58afd7dbf4" title="interpolates field at FACE to field at CENT assuming field along itself is continuous" alt="" coords="2541,430,2661,477"/><area shape="rect" id="node100" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aaa24493002bc8c0a527b1ea2ac2dddbf" title="convert conservative U to stag point P and CENT point U and CENT point primitive" alt="" coords="2991,431,3124,460"/><area shape="rect" id="node110" href="../../d0/dde/fluxctstag_8c.html#a985ee116306b4011810334ae93900493" title="INPUTS: Nvec, pr, primface_l[dir], primface_r[dir] OUTPUTS: pbcorn[dir][side], pvcorn[dir][side][side..." alt="" coords="2512,708,2691,737"/><area shape="rect" id="node118" href="../../d9/de0/step__ch_8c.html#a91fe5c4370e3292a19e7f794797a407f" title="normal bounding of all primitives" alt="" coords="3740,223,3841,252"/><area shape="rect" id="node124" href="../../d9/de0/step__ch_8c.html#abdea68b778dc9253324da69d3c376965" title="bound any pstag type CALLS directly real and MPI boundary functions pstag is at FACE1,2,3 for fields, so user bound is different MPI bounding is the same as CENT quantities used when restarting in initbase.c to bound unewglobal for FLUXB==FLUXCTSTAG" alt="" coords="2308,120,2425,149"/><area shape="rect" id="node127" href="../../d9/de0/step__ch_8c.html#a6f4b963a50a7288964f01775f2f18bb9" title="normal bounding of staggered primitives" alt="" coords="2553,168,2649,197"/><area shape="rect" id="node130" href="../../d0/dde/fluxctstag_8c.html#aa169cb1999412f2e2460012cc5d7a804" title="pure DONOR version: upoint is input staggered updated field that needs to be converted to pstag and t..." alt="" coords="2748,158,2924,205"/><area shape="rect" id="node165" href="../../de/d51/bounds_8c.html#a16398a5325a9df48783423f00ba65bb7" title="all boundaries for RADCYLBEAMCART" alt="" coords="1273,281,1425,311"/><area shape="rect" id="node173" href="../../de/d51/bounds_8c.html#a3a96629ab9e350154c992f8a4ce92cbe" title="X1 lower and upper X2." alt="" coords="1280,751,1419,780"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a20be479a3f03f3de780359d6e9290fe3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ucon_calc_rel4vel_fromuconrel </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>uconrel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>geom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>ucon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>others</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>find u^ from {u}^ fill full 4-vector OPTMARK: Before storing , this was the most expensive function over the entire code [determined by avoiding inlining] </p>

<p>Definition at line <a class="el" href="../../d7/def/phys_8tools_8c_source.html#l02360">2360</a> of file <a class="el" href="../../d7/def/phys_8tools_8c_source.html">phys.tools.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_a20be479a3f03f3de780359d6e9290fe3_cgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_a20be479a3f03f3de780359d6e9290fe3_cgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_a20be479a3f03f3de780359d6e9290fe3_cgraph" id="d3/ddc/phys_8funcdeclare_8h_a20be479a3f03f3de780359d6e9290fe3_cgraph">
<area shape="rect" id="node3" href="../../d3/ddc/phys_8funcdeclare_8h.html#abfae38e47b0bd05a4fc38302ff948a96" title="find gamma&#45;factor wrt normal observer This function and qsq_calc() have about the same cache miss amo..." alt="" coords="256,5,427,35"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_a20be479a3f03f3de780359d6e9290fe3_icgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_a20be479a3f03f3de780359d6e9290fe3_icgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_a20be479a3f03f3de780359d6e9290fe3_icgraph" id="d3/ddc/phys_8funcdeclare_8h_a20be479a3f03f3de780359d6e9290fe3_icgraph">
<area shape="rect" id="node3" href="../../d7/def/phys_8tools_8c.html#a7aadb359813194586356c2c325322a45" title="find contravariant four&#45;velocity from the relative 4 velocity" alt="" coords="257,144,383,173"/><area shape="rect" id="node5" href="../../d7/def/phys_8tools_8c.html#a35c4399eb86e3fa77e2221000e077572" title="ucon_calc_whichvel" alt="" coords="432,144,571,173"/><area shape="rect" id="node7" href="../../d8/d60/init_8c.html#ab0bfdee8d9b31f16dbadd2a5108ad29b" title="donut_analytical_solution" alt="" coords="619,64,787,93"/><area shape="rect" id="node27" href="../../d2/d72/phys_8tools_8rad_8c.html#a2ec6ee79c76351868a725b22dac62135" title="like prad_fforlab() but for only whichdir=FF2LAB used for IC" alt="" coords="657,117,748,147"/><area shape="rect" id="node170" href="../../d2/d72/phys_8tools_8rad_8c.html#aa25aa4dfb3559619f276abca5f4b3ca0" title="for BCs, to take E[radiation frame] and u^i as radiation primitives in whichvel/whichcoord obtains WH..." alt="" coords="1040,610,1179,657"/><area shape="rect" id="node179" href="../../d2/d72/phys_8tools_8rad_8c.html#aa8edd5fc0afc1713ad401c2db92c71e0" title="set velocity based upon ncon and gammamax and return in whichvel format for the ptrgeom geometry/coor..." alt="" coords="640,221,765,251"/><area shape="rect" id="node9" href="../../d8/d60/init_8c.html#a83e7f10ffd348c4d18b3245dd4bab585" title="make_nonrt2rt_solution" alt="" coords="835,64,992,93"/><area shape="rect" id="node11" href="../../d8/d60/init_8c.html#a73009fd6280963c265e2cf5d1c353e8d" title="get_full_rtsolution" alt="" coords="1048,64,1171,93"/><area shape="rect" id="node13" href="../../d8/d60/init_8c.html#af94364e17d67cddfbb7bb3bf39c05ee6" title="init_dsandvels_koral" alt="" coords="1273,5,1412,35"/><area shape="rect" id="node25" href="../../d8/d60/init_8c.html#a448cd3fd9a1d862485e7b6e67b965172" title="process_restart_toget\l_radiation" alt="" coords="1269,58,1416,105"/><area shape="rect" id="node15" href="../../df/d15/init_8tools_8c.html#acefd26944dbbb1c289886f520f6befac" title="init_dsandvels" alt="" coords="1775,5,1879,35"/><area shape="rect" id="node17" href="../../df/d15/init_8tools_8c.html#a77551ab2581efdbaf170dfca073ff9ab" title="user1_init_primitives" alt="" coords="4157,276,4299,305"/><area shape="rect" id="node19" href="../../de/db2/initbase_8funcdeclare_8h.html#a0afa200a5f947b1c9f6e554519f28fc4" title="init_primitives" alt="" coords="4348,301,4449,331"/><area shape="rect" id="node21" href="../../de/df8/initbase_8c.html#ac4110398e386c9888d9565630357dbbe" title="General&#45;Primary init() routine Uses globals inside init() because sets memory and sets physics..." alt="" coords="4527,328,4564,357"/><area shape="rect" id="node23" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="4640,408,4691,437"/><area shape="rect" id="node29" href="../../d2/d72/phys_8tools_8rad_8c.html#af50896d039d660550b738862b3390b07" title="radiative ortonormal ff primitives (E,F^i) &lt;&#45;&gt; primitives in lab frame Used only for initial conditio..." alt="" coords="868,117,959,147"/><area shape="rect" id="node33" href="../../d2/d72/phys_8tools_8rad_8c.html#a64226cb28f52020ffe18ac6c6b1a2f5c" title="Input: start with pin [with fluid in whichvel velocity and whichcoordfluid coordinates (PRIMECOORDS o..." alt="" coords="1044,377,1175,423"/><area shape="rect" id="node35" href="../../de/d51/bounds_8c.html#a3bc773d499b145705bdc23125b963840" title="Koral specific physical boundary conditions." alt="" coords="1243,592,1443,621"/><area shape="rect" id="node135" href="../../de/d51/bounds_8c.html#a09a080d9895db7b800a3824cb3fac9f1" title="X1 lower for beam injection to create shadow." alt="" coords="1263,645,1423,675"/><area shape="rect" id="node138" href="../../de/d51/bounds_8c.html#a3ee134cc5fb18752265c16a20dbdfb63" title="X3 lower for radiation beam injection." alt="" coords="1245,699,1440,728"/><area shape="rect" id="node141" href="../../de/d51/bounds_8c.html#a8300ddf3ae6a3866234cc0e9c12f26dc" title="X1 upper for inflow." alt="" coords="1507,335,1693,364"/><area shape="rect" id="node144" href="../../de/d51/bounds_8c.html#a01088f65c7a4cfa2ebfed202f815b951" title="X1 lower and upper for RADATM." alt="" coords="1515,388,1685,417"/><area shape="rect" id="node147" href="../../de/d51/bounds_8c.html#a1382959a7b699ea5d224168612504263" title="X1 upper for inflow." alt="" coords="1527,441,1673,471"/><area shape="rect" id="node150" href="../../de/d51/bounds_8c.html#ac15824bc610943cb7e02112e77b94752" title="on&#45;grid bounding" alt="" coords="1551,495,1649,524"/><area shape="rect" id="node153" href="../../de/d51/bounds_8c.html#a42658c4ecf3c6edb958394eb65a9ac2b" title="RADNT." alt="" coords="1553,124,1647,153"/><area shape="rect" id="node156" href="../../de/d51/bounds_8c.html#a3e4008fd24427b2e91d0ae5882b9536a" title="X1 upper for RADCYLBEAM." alt="" coords="1517,177,1683,207"/><area shape="rect" id="node159" href="../../de/d51/bounds_8c.html#ac32c1a20138382904dc5f1c66778ad8b" title="X1 upper for RADCYLJET." alt="" coords="1269,229,1416,259"/><area shape="rect" id="node162" href="../../de/d51/bounds_8c.html#a635fbaba3d6d6afcf5f34bbb2c278737" title="X2 upper for radiation beam injection." alt="" coords="1228,539,1457,568"/><area shape="rect" id="node165" href="../../de/d51/bounds_8c.html#a9f1df4e461f3f776bf3cb80e36a4d6df" title="get_radcylbeamcart" alt="" coords="1275,283,1411,312"/><area shape="rect" id="node37" href="../../de/d51/bounds_8c.html#a34ac3f1ca7b0f3a21053c633da9931a9" title="user boundary routine" alt="" coords="1741,441,1912,471"/><area shape="rect" id="node39" href="../../d4/dad/bounds_8funcdeclare_8h.html#a4bc7413b2cdb89e070f38bbb689ae555" title="bound_prim_user_dir" alt="" coords="1964,461,2105,491"/><area shape="rect" id="node124" href="../../d4/dad/bounds_8funcdeclare_8h.html#a2fbddc9ff8fc706bafa80c39695c7262" title="assume single user function takes care of primitive locations" alt="" coords="1960,256,2109,285"/><area shape="rect" id="node41" href="../../d9/de0/step__ch_8c.html#adbe0e3ba8a74f09ab928a96bd68cab6d" title="bound any prim type CALLS directly real and MPI boundary functions pstag = pstagglobal ucons = unewgl..." alt="" coords="2159,483,2268,512"/><area shape="rect" id="node43" href="../../d9/de0/step__ch_8c.html#a689fddc1949b1a1d390b59d10d17d83c" title="normal full bounding during evolution NOTEMARK: Was previously also bounding pstag here..." alt="" coords="2336,809,2461,839"/><area shape="rect" id="node55" href="../../d9/de0/step__ch_8c.html#a4079244d85c301885c1363ca41502869" title="simple bounding during evolution NOTEMARK: Was previously also bounding pstag here, but not necessary since done by calling bound_pstag in fluxctstag.c" alt="" coords="2317,863,2480,892"/><area shape="rect" id="node58" href="../../d9/de0/step__ch_8c.html#addca75a18cc861326a321565a2e81aa0" title="normal bounding of non&#45;staggered primitives" alt="" coords="2355,483,2443,512"/><area shape="rect" id="node118" href="../../d9/de0/step__ch_8c.html#a460b84e1112e3aef17209c20e22e1cf1" title="bound all prims" alt="" coords="2791,115,2913,144"/><area shape="rect" id="node45" href="../../d9/de0/step__ch_8c.html#ad36a0f9f915547477e3bb2405f8166b9" title="things to do after advance()" alt="" coords="2567,863,2668,892"/><area shape="rect" id="node47" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="3975,769,4108,799"/><area shape="rect" id="node49" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="4365,645,4432,675"/><area shape="rect" id="node51" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="4500,488,4591,517"/><area shape="rect" id="node60" href="../../dc/dae/flux_8c.html#aef355ccd1ca2295b84ad2fe1fc011d35" title="normal interpolation of CENT quantities to FACE quantities sets global variables pl_ct and pr_ct to p..." alt="" coords="2528,585,2707,615"/><area shape="rect" id="node77" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aecb3f613a7cb3bbb42fff2dbee5d65a1" title="This vpot2field function is for staggered method to evolve quasi&#45;deaveraged fields (i..." alt="" coords="3225,225,3391,255"/><area shape="rect" id="node79" href="../../de/db2/initbase_8funcdeclare_8h.html#ae6b2ad4cd0debf5b89ba8a9e471d6977" title="assumes normal field p pleft used as temp var if FLUXB==FLUXCTSTAG assigns conserved field in UEVOLVE..." alt="" coords="3441,276,3519,305"/><area shape="rect" id="node88" href="../../d0/dde/fluxctstag_8c.html#a4e3d76c6ad125b8199948408c262e3a1" title="wrapper for: 1) interpolate FACE 2 CORN 2) loop over dimensions setting field flux dimension&#45;by&#45;dimen..." alt="" coords="3021,683,3152,712"/><area shape="rect" id="node91" href="../../d0/dde/fluxctstag_8c.html#a2dd789bf1402bef72523cdb69e85806e" title="use global pbcorninterp and pvcorninterp at CORN1,2,3 to obtain EMFs at CORN1,2,3 NO interpolation of..." alt="" coords="2552,638,2683,685"/><area shape="rect" id="node94" href="../../d0/dde/fluxctstag_8c.html#aaec26a518629175ecceefbaf6c84225e" title="wrapper for continuous interpolation for FACE_to_CENT" alt="" coords="2531,431,2704,460"/><area shape="rect" id="node98" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aa31dd83c96936277334c62e2098dd51d" title="wrapper for taking staggered conserved field quantity and obtaining centered field quantity upoint en..." alt="" coords="2999,500,3175,529"/><area shape="rect" id="node107" href="../../d0/dde/fluxctstag_8c.html#a6cd90dff56319085b32bc57c0c8b3cfd" title="this function called in initbase.c and during advance() here ustag is point value if dimension doesn&#39;..." alt="" coords="2792,500,2912,529"/><area shape="rect" id="node110" href="../../d0/dde/fluxctstag_8c.html#ad6aa918442f7768dff3c099ba353ee64" title="slope_lim_face2corn() is provided p2interp and returns pleft/pright differs from slope_lim() by range..." alt="" coords="2547,708,2688,737"/><area shape="rect" id="node62" href="../../dc/dae/flux_8c.html#a2602a4dad9ed7adc944227d02435312e" title="standard (non&#45;field flux) calculation but setup to store results of interpolation so can be used for ..." alt="" coords="2755,604,2949,633"/><area shape="rect" id="node64" href="../../dc/dae/flux_8c.html#aaf6d832880760f80459d91477c28b519" title="wrapper for different standard 1&#45;D flux calculators 1&#45;D interpolate and get flux for that direction (..." alt="" coords="3029,604,3144,633"/><area shape="rect" id="node66" href="../../dc/dae/flux_8c.html#a8ffa7399bd5354fdcdec5f3e1adf0b13" title="wrapper for CENT_to_FACE1,2,3 used to compute flux at face" alt="" coords="3261,604,3355,633"/><area shape="rect" id="node68" href="../../d5/d2f/flux_8funcdeclare_8h.html#ab229b0f3f2caf3c0a3ef5299fba2b1c0" title="see fluxcompute.c for non&#45;computer science, real physics calculations of flux" alt="" coords="3447,604,3513,633"/><area shape="rect" id="node70" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="3591,604,3719,633"/><area shape="rect" id="node75" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="3577,525,3732,555"/><area shape="rect" id="node72" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="3823,681,3892,711"/><area shape="rect" id="node81" href="../../df/d15/init_8tools_8c.html#a3750bc790613bc6c8c805af0f1b839c8" title="user1_init_vpot2field_user" alt="" coords="3568,276,3741,305"/><area shape="rect" id="node83" href="../../de/db2/initbase_8funcdeclare_8h.html#afda44281ad5c163455c40f012d4a8954" title="init_vpot2field_user" alt="" coords="3791,276,3924,305"/><area shape="rect" id="node85" href="../../de/db2/initbase_8funcdeclare_8h.html#a90699a18ede8b7f112c0078512804ec1" title="initialize vector potential given user function assumes normal non&#45;staggered field in pr Notice that ..." alt="" coords="4007,276,4076,305"/><area shape="rect" id="node96" href="../../d0/dde/fluxctstag_8c.html#a5e3dcbe89d6f8a9384cafb58afd7dbf4" title="interpolates field at FACE to field at CENT assuming field along itself is continuous" alt="" coords="2792,430,2912,477"/><area shape="rect" id="node102" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aaa24493002bc8c0a527b1ea2ac2dddbf" title="convert conservative U to stag point P and CENT point U and CENT point primitive" alt="" coords="3241,431,3375,460"/><area shape="rect" id="node112" href="../../d0/dde/fluxctstag_8c.html#a985ee116306b4011810334ae93900493" title="INPUTS: Nvec, pr, primface_l[dir], primface_r[dir] OUTPUTS: pbcorn[dir][side], pvcorn[dir][side][side..." alt="" coords="2763,708,2941,737"/><area shape="rect" id="node120" href="../../d9/de0/step__ch_8c.html#a91fe5c4370e3292a19e7f794797a407f" title="normal bounding of all primitives" alt="" coords="3991,223,4092,252"/><area shape="rect" id="node126" href="../../d9/de0/step__ch_8c.html#abdea68b778dc9253324da69d3c376965" title="bound any pstag type CALLS directly real and MPI boundary functions pstag is at FACE1,2,3 for fields, so user bound is different MPI bounding is the same as CENT quantities used when restarting in initbase.c to bound unewglobal for FLUXB==FLUXCTSTAG" alt="" coords="2559,120,2676,149"/><area shape="rect" id="node129" href="../../d9/de0/step__ch_8c.html#a6f4b963a50a7288964f01775f2f18bb9" title="normal bounding of staggered primitives" alt="" coords="2804,168,2900,197"/><area shape="rect" id="node132" href="../../d0/dde/fluxctstag_8c.html#aa169cb1999412f2e2460012cc5d7a804" title="pure DONOR version: upoint is input staggered updated field that needs to be converted to pstag and t..." alt="" coords="2999,158,3175,205"/><area shape="rect" id="node167" href="../../de/d51/bounds_8c.html#a16398a5325a9df48783423f00ba65bb7" title="all boundaries for RADCYLBEAMCART" alt="" coords="1524,281,1676,311"/><area shape="rect" id="node175" href="../../de/d51/bounds_8c.html#a3a96629ab9e350154c992f8a4ce92cbe" title="X1 lower and upper X2." alt="" coords="1531,751,1669,780"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a35c4399eb86e3fa77e2221000e077572"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ucon_calc_whichvel </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>whichvel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>geom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>ucon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>others</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/def/phys_8tools_8c_source.html#l02422">2422</a> of file <a class="el" href="../../d7/def/phys_8tools_8c_source.html">phys.tools.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_a35c4399eb86e3fa77e2221000e077572_cgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_a35c4399eb86e3fa77e2221000e077572_cgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_a35c4399eb86e3fa77e2221000e077572_cgraph" id="d3/ddc/phys_8funcdeclare_8h_a35c4399eb86e3fa77e2221000e077572_cgraph">
<area shape="rect" id="node3" href="../../d3/ddc/phys_8funcdeclare_8h.html#ad141359a7901a82a0c26241b432183c3" title="find contravariant time component of four&#45;velocity from the 4velocity (3 terms)" alt="" coords="200,5,312,35"/><area shape="rect" id="node7" href="../../d3/ddc/phys_8funcdeclare_8h.html#afc1e1232a2f457b71cfd9210f2b5240a" title="find contravariant four&#45;velocity int ucon_calc(FTYPE *pr, struct of_geom *geom, FTYPE *ucon..." alt="" coords="200,59,312,88"/><area shape="rect" id="node9" href="../../d3/ddc/phys_8funcdeclare_8h.html#a7aadb359813194586356c2c325322a45" title="find contravariant four&#45;velocity from the relative 4 velocity" alt="" coords="193,112,319,141"/><area shape="rect" id="node5" href="../../d9/de9/coord_8c.html#a041e7b005310415c97d90f4b8521ed1a" title="get X(i,j,k) CENT is default position in degenerate cases" alt="" coords="443,5,496,35"/><area shape="rect" id="node11" href="../../d3/ddc/phys_8funcdeclare_8h.html#a5910aabe5e76183d341ef5b830b01bab" title="find {u}^ from u^ only fill spatial parts so can feed in 3&#45;vector" alt="" coords="437,85,501,115"/><area shape="rect" id="node13" href="../../d3/ddc/phys_8funcdeclare_8h.html#a20be479a3f03f3de780359d6e9290fe3" title="find u^ from {u}^ fill full 4&#45;vector OPTMARK: Before storing , this was the most expensive function o..." alt="" coords="369,139,569,168"/><area shape="rect" id="node15" href="../../d3/ddc/phys_8funcdeclare_8h.html#abfae38e47b0bd05a4fc38302ff948a96" title="find gamma&#45;factor wrt normal observer This function and qsq_calc() have about the same cache miss amo..." alt="" coords="619,139,789,168"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_a35c4399eb86e3fa77e2221000e077572_icgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_a35c4399eb86e3fa77e2221000e077572_icgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_a35c4399eb86e3fa77e2221000e077572_icgraph" id="d3/ddc/phys_8funcdeclare_8h_a35c4399eb86e3fa77e2221000e077572_icgraph">
<area shape="rect" id="node3" href="../../d8/d60/init_8c.html#ab0bfdee8d9b31f16dbadd2a5108ad29b" title="donut_analytical_solution" alt="" coords="192,64,360,93"/><area shape="rect" id="node23" href="../../d2/d72/phys_8tools_8rad_8c.html#a2ec6ee79c76351868a725b22dac62135" title="like prad_fforlab() but for only whichdir=FF2LAB used for IC" alt="" coords="231,117,321,147"/><area shape="rect" id="node166" href="../../d2/d72/phys_8tools_8rad_8c.html#aa25aa4dfb3559619f276abca5f4b3ca0" title="for BCs, to take E[radiation frame] and u^i as radiation primitives in whichvel/whichcoord obtains WH..." alt="" coords="613,610,752,657"/><area shape="rect" id="node175" href="../../d2/d72/phys_8tools_8rad_8c.html#aa8edd5fc0afc1713ad401c2db92c71e0" title="set velocity based upon ncon and gammamax and return in whichvel format for the ptrgeom geometry/coor..." alt="" coords="213,221,339,251"/><area shape="rect" id="node5" href="../../d8/d60/init_8c.html#a83e7f10ffd348c4d18b3245dd4bab585" title="make_nonrt2rt_solution" alt="" coords="408,64,565,93"/><area shape="rect" id="node7" href="../../d8/d60/init_8c.html#a73009fd6280963c265e2cf5d1c353e8d" title="get_full_rtsolution" alt="" coords="621,64,744,93"/><area shape="rect" id="node9" href="../../d8/d60/init_8c.html#af94364e17d67cddfbb7bb3bf39c05ee6" title="init_dsandvels_koral" alt="" coords="847,5,985,35"/><area shape="rect" id="node21" href="../../d8/d60/init_8c.html#a448cd3fd9a1d862485e7b6e67b965172" title="process_restart_toget\l_radiation" alt="" coords="843,58,989,105"/><area shape="rect" id="node11" href="../../df/d15/init_8tools_8c.html#acefd26944dbbb1c289886f520f6befac" title="init_dsandvels" alt="" coords="1348,5,1452,35"/><area shape="rect" id="node13" href="../../df/d15/init_8tools_8c.html#a77551ab2581efdbaf170dfca073ff9ab" title="user1_init_primitives" alt="" coords="3731,276,3872,305"/><area shape="rect" id="node15" href="../../de/db2/initbase_8funcdeclare_8h.html#a0afa200a5f947b1c9f6e554519f28fc4" title="init_primitives" alt="" coords="3921,301,4023,331"/><area shape="rect" id="node17" href="../../de/df8/initbase_8c.html#ac4110398e386c9888d9565630357dbbe" title="General&#45;Primary init() routine Uses globals inside init() because sets memory and sets physics..." alt="" coords="4100,328,4137,357"/><area shape="rect" id="node19" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="4213,408,4264,437"/><area shape="rect" id="node25" href="../../d2/d72/phys_8tools_8rad_8c.html#af50896d039d660550b738862b3390b07" title="radiative ortonormal ff primitives (E,F^i) &lt;&#45;&gt; primitives in lab frame Used only for initial conditio..." alt="" coords="441,117,532,147"/><area shape="rect" id="node29" href="../../d2/d72/phys_8tools_8rad_8c.html#a64226cb28f52020ffe18ac6c6b1a2f5c" title="Input: start with pin [with fluid in whichvel velocity and whichcoordfluid coordinates (PRIMECOORDS o..." alt="" coords="617,377,748,423"/><area shape="rect" id="node31" href="../../de/d51/bounds_8c.html#a3bc773d499b145705bdc23125b963840" title="Koral specific physical boundary conditions." alt="" coords="816,592,1016,621"/><area shape="rect" id="node131" href="../../de/d51/bounds_8c.html#a09a080d9895db7b800a3824cb3fac9f1" title="X1 lower for beam injection to create shadow." alt="" coords="836,645,996,675"/><area shape="rect" id="node134" href="../../de/d51/bounds_8c.html#a3ee134cc5fb18752265c16a20dbdfb63" title="X3 lower for radiation beam injection." alt="" coords="819,699,1013,728"/><area shape="rect" id="node137" href="../../de/d51/bounds_8c.html#a8300ddf3ae6a3866234cc0e9c12f26dc" title="X1 upper for inflow." alt="" coords="1080,335,1267,364"/><area shape="rect" id="node140" href="../../de/d51/bounds_8c.html#a01088f65c7a4cfa2ebfed202f815b951" title="X1 lower and upper for RADATM." alt="" coords="1088,388,1259,417"/><area shape="rect" id="node143" href="../../de/d51/bounds_8c.html#a1382959a7b699ea5d224168612504263" title="X1 upper for inflow." alt="" coords="1100,441,1247,471"/><area shape="rect" id="node146" href="../../de/d51/bounds_8c.html#ac15824bc610943cb7e02112e77b94752" title="on&#45;grid bounding" alt="" coords="1124,495,1223,524"/><area shape="rect" id="node149" href="../../de/d51/bounds_8c.html#a42658c4ecf3c6edb958394eb65a9ac2b" title="RADNT." alt="" coords="1127,124,1220,153"/><area shape="rect" id="node152" href="../../de/d51/bounds_8c.html#a3e4008fd24427b2e91d0ae5882b9536a" title="X1 upper for RADCYLBEAM." alt="" coords="1091,177,1256,207"/><area shape="rect" id="node155" href="../../de/d51/bounds_8c.html#ac32c1a20138382904dc5f1c66778ad8b" title="X1 upper for RADCYLJET." alt="" coords="843,229,989,259"/><area shape="rect" id="node158" href="../../de/d51/bounds_8c.html#a635fbaba3d6d6afcf5f34bbb2c278737" title="X2 upper for radiation beam injection." alt="" coords="801,539,1031,568"/><area shape="rect" id="node161" href="../../de/d51/bounds_8c.html#a9f1df4e461f3f776bf3cb80e36a4d6df" title="get_radcylbeamcart" alt="" coords="848,283,984,312"/><area shape="rect" id="node33" href="../../de/d51/bounds_8c.html#a34ac3f1ca7b0f3a21053c633da9931a9" title="user boundary routine" alt="" coords="1315,441,1485,471"/><area shape="rect" id="node35" href="../../d4/dad/bounds_8funcdeclare_8h.html#a4bc7413b2cdb89e070f38bbb689ae555" title="bound_prim_user_dir" alt="" coords="1537,461,1679,491"/><area shape="rect" id="node120" href="../../d4/dad/bounds_8funcdeclare_8h.html#a2fbddc9ff8fc706bafa80c39695c7262" title="assume single user function takes care of primitive locations" alt="" coords="1533,256,1683,285"/><area shape="rect" id="node37" href="../../d9/de0/step__ch_8c.html#adbe0e3ba8a74f09ab928a96bd68cab6d" title="bound any prim type CALLS directly real and MPI boundary functions pstag = pstagglobal ucons = unewgl..." alt="" coords="1732,483,1841,512"/><area shape="rect" id="node39" href="../../d9/de0/step__ch_8c.html#a689fddc1949b1a1d390b59d10d17d83c" title="normal full bounding during evolution NOTEMARK: Was previously also bounding pstag here..." alt="" coords="1909,809,2035,839"/><area shape="rect" id="node51" href="../../d9/de0/step__ch_8c.html#a4079244d85c301885c1363ca41502869" title="simple bounding during evolution NOTEMARK: Was previously also bounding pstag here, but not necessary since done by calling bound_pstag in fluxctstag.c" alt="" coords="1891,863,2053,892"/><area shape="rect" id="node54" href="../../d9/de0/step__ch_8c.html#addca75a18cc861326a321565a2e81aa0" title="normal bounding of non&#45;staggered primitives" alt="" coords="1928,483,2016,512"/><area shape="rect" id="node114" href="../../d9/de0/step__ch_8c.html#a460b84e1112e3aef17209c20e22e1cf1" title="bound all prims" alt="" coords="2364,115,2487,144"/><area shape="rect" id="node41" href="../../d9/de0/step__ch_8c.html#ad36a0f9f915547477e3bb2405f8166b9" title="things to do after advance()" alt="" coords="2140,863,2241,892"/><area shape="rect" id="node43" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="3548,769,3681,799"/><area shape="rect" id="node45" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="3939,645,4005,675"/><area shape="rect" id="node47" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="4073,488,4164,517"/><area shape="rect" id="node56" href="../../dc/dae/flux_8c.html#aef355ccd1ca2295b84ad2fe1fc011d35" title="normal interpolation of CENT quantities to FACE quantities sets global variables pl_ct and pr_ct to p..." alt="" coords="2101,585,2280,615"/><area shape="rect" id="node73" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aecb3f613a7cb3bbb42fff2dbee5d65a1" title="This vpot2field function is for staggered method to evolve quasi&#45;deaveraged fields (i..." alt="" coords="2799,225,2964,255"/><area shape="rect" id="node75" href="../../de/db2/initbase_8funcdeclare_8h.html#ae6b2ad4cd0debf5b89ba8a9e471d6977" title="assumes normal field p pleft used as temp var if FLUXB==FLUXCTSTAG assigns conserved field in UEVOLVE..." alt="" coords="3015,276,3092,305"/><area shape="rect" id="node84" href="../../d0/dde/fluxctstag_8c.html#a4e3d76c6ad125b8199948408c262e3a1" title="wrapper for: 1) interpolate FACE 2 CORN 2) loop over dimensions setting field flux dimension&#45;by&#45;dimen..." alt="" coords="2595,683,2725,712"/><area shape="rect" id="node87" href="../../d0/dde/fluxctstag_8c.html#a2dd789bf1402bef72523cdb69e85806e" title="use global pbcorninterp and pvcorninterp at CORN1,2,3 to obtain EMFs at CORN1,2,3 NO interpolation of..." alt="" coords="2125,638,2256,685"/><area shape="rect" id="node90" href="../../d0/dde/fluxctstag_8c.html#aaec26a518629175ecceefbaf6c84225e" title="wrapper for continuous interpolation for FACE_to_CENT" alt="" coords="2104,431,2277,460"/><area shape="rect" id="node94" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aa31dd83c96936277334c62e2098dd51d" title="wrapper for taking staggered conserved field quantity and obtaining centered field quantity upoint en..." alt="" coords="2572,500,2748,529"/><area shape="rect" id="node103" href="../../d0/dde/fluxctstag_8c.html#a6cd90dff56319085b32bc57c0c8b3cfd" title="this function called in initbase.c and during advance() here ustag is point value if dimension doesn&#39;..." alt="" coords="2365,500,2485,529"/><area shape="rect" id="node106" href="../../d0/dde/fluxctstag_8c.html#ad6aa918442f7768dff3c099ba353ee64" title="slope_lim_face2corn() is provided p2interp and returns pleft/pright differs from slope_lim() by range..." alt="" coords="2120,708,2261,737"/><area shape="rect" id="node58" href="../../dc/dae/flux_8c.html#a2602a4dad9ed7adc944227d02435312e" title="standard (non&#45;field flux) calculation but setup to store results of interpolation so can be used for ..." alt="" coords="2328,604,2523,633"/><area shape="rect" id="node60" href="../../dc/dae/flux_8c.html#aaf6d832880760f80459d91477c28b519" title="wrapper for different standard 1&#45;D flux calculators 1&#45;D interpolate and get flux for that direction (..." alt="" coords="2603,604,2717,633"/><area shape="rect" id="node62" href="../../dc/dae/flux_8c.html#a8ffa7399bd5354fdcdec5f3e1adf0b13" title="wrapper for CENT_to_FACE1,2,3 used to compute flux at face" alt="" coords="2835,604,2928,633"/><area shape="rect" id="node64" href="../../d5/d2f/flux_8funcdeclare_8h.html#ab229b0f3f2caf3c0a3ef5299fba2b1c0" title="see fluxcompute.c for non&#45;computer science, real physics calculations of flux" alt="" coords="3020,604,3087,633"/><area shape="rect" id="node66" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="3164,604,3292,633"/><area shape="rect" id="node71" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="3151,525,3305,555"/><area shape="rect" id="node68" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="3396,681,3465,711"/><area shape="rect" id="node77" href="../../df/d15/init_8tools_8c.html#a3750bc790613bc6c8c805af0f1b839c8" title="user1_init_vpot2field_user" alt="" coords="3141,276,3315,305"/><area shape="rect" id="node79" href="../../de/db2/initbase_8funcdeclare_8h.html#afda44281ad5c163455c40f012d4a8954" title="init_vpot2field_user" alt="" coords="3364,276,3497,305"/><area shape="rect" id="node81" href="../../de/db2/initbase_8funcdeclare_8h.html#a90699a18ede8b7f112c0078512804ec1" title="initialize vector potential given user function assumes normal non&#45;staggered field in pr Notice that ..." alt="" coords="3580,276,3649,305"/><area shape="rect" id="node92" href="../../d0/dde/fluxctstag_8c.html#a5e3dcbe89d6f8a9384cafb58afd7dbf4" title="interpolates field at FACE to field at CENT assuming field along itself is continuous" alt="" coords="2365,430,2485,477"/><area shape="rect" id="node98" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aaa24493002bc8c0a527b1ea2ac2dddbf" title="convert conservative U to stag point P and CENT point U and CENT point primitive" alt="" coords="2815,431,2948,460"/><area shape="rect" id="node108" href="../../d0/dde/fluxctstag_8c.html#a985ee116306b4011810334ae93900493" title="INPUTS: Nvec, pr, primface_l[dir], primface_r[dir] OUTPUTS: pbcorn[dir][side], pvcorn[dir][side][side..." alt="" coords="2336,708,2515,737"/><area shape="rect" id="node116" href="../../d9/de0/step__ch_8c.html#a91fe5c4370e3292a19e7f794797a407f" title="normal bounding of all primitives" alt="" coords="3564,223,3665,252"/><area shape="rect" id="node122" href="../../d9/de0/step__ch_8c.html#abdea68b778dc9253324da69d3c376965" title="bound any pstag type CALLS directly real and MPI boundary functions pstag is at FACE1,2,3 for fields, so user bound is different MPI bounding is the same as CENT quantities used when restarting in initbase.c to bound unewglobal for FLUXB==FLUXCTSTAG" alt="" coords="2132,120,2249,149"/><area shape="rect" id="node125" href="../../d9/de0/step__ch_8c.html#a6f4b963a50a7288964f01775f2f18bb9" title="normal bounding of staggered primitives" alt="" coords="2377,168,2473,197"/><area shape="rect" id="node128" href="../../d0/dde/fluxctstag_8c.html#aa169cb1999412f2e2460012cc5d7a804" title="pure DONOR version: upoint is input staggered updated field that needs to be converted to pstag and t..." alt="" coords="2572,158,2748,205"/><area shape="rect" id="node163" href="../../de/d51/bounds_8c.html#a16398a5325a9df48783423f00ba65bb7" title="all boundaries for RADCYLBEAMCART" alt="" coords="1097,281,1249,311"/><area shape="rect" id="node171" href="../../de/d51/bounds_8c.html#a3a96629ab9e350154c992f8a4ce92cbe" title="X1 lower and upper X2." alt="" coords="1104,751,1243,780"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aac70ef771b9a27ba780c06be637a8625"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ucon_calcother </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>ucon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>others</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ad93a871fdb6a9eccf12abac6f500734b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ucon_precalc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>ucon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>AA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>BB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>CC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>discr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a5910aabe5e76183d341ef5b830b01bab"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int uconrel </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>ucon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>uconrel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>geom</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>find {u}^ from u^ only fill spatial parts so can feed in 3-vector </p>

<p>Definition at line <a class="el" href="../../d7/def/phys_8tools_8c_source.html#l02387">2387</a> of file <a class="el" href="../../d7/def/phys_8tools_8c_source.html">phys.tools.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/ddc/phys_8funcdeclare_8h_a5910aabe5e76183d341ef5b830b01bab_icgraph.png" border="0" usemap="#d3/ddc/phys_8funcdeclare_8h_a5910aabe5e76183d341ef5b830b01bab_icgraph" alt=""/></div>
<map name="d3/ddc/phys_8funcdeclare_8h_a5910aabe5e76183d341ef5b830b01bab_icgraph" id="d3/ddc/phys_8funcdeclare_8h_a5910aabe5e76183d341ef5b830b01bab_icgraph">
<area shape="rect" id="node3" href="../../d7/def/phys_8tools_8c.html#a7aadb359813194586356c2c325322a45" title="find contravariant four&#45;velocity from the relative 4 velocity" alt="" coords="119,144,244,173"/><area shape="rect" id="node5" href="../../d7/def/phys_8tools_8c.html#a35c4399eb86e3fa77e2221000e077572" title="ucon_calc_whichvel" alt="" coords="293,144,432,173"/><area shape="rect" id="node7" href="../../d8/d60/init_8c.html#ab0bfdee8d9b31f16dbadd2a5108ad29b" title="donut_analytical_solution" alt="" coords="480,64,648,93"/><area shape="rect" id="node27" href="../../d2/d72/phys_8tools_8rad_8c.html#a2ec6ee79c76351868a725b22dac62135" title="like prad_fforlab() but for only whichdir=FF2LAB used for IC" alt="" coords="519,117,609,147"/><area shape="rect" id="node170" href="../../d2/d72/phys_8tools_8rad_8c.html#aa25aa4dfb3559619f276abca5f4b3ca0" title="for BCs, to take E[radiation frame] and u^i as radiation primitives in whichvel/whichcoord obtains WH..." alt="" coords="901,610,1040,657"/><area shape="rect" id="node179" href="../../d2/d72/phys_8tools_8rad_8c.html#aa8edd5fc0afc1713ad401c2db92c71e0" title="set velocity based upon ncon and gammamax and return in whichvel format for the ptrgeom geometry/coor..." alt="" coords="501,221,627,251"/><area shape="rect" id="node9" href="../../d8/d60/init_8c.html#a83e7f10ffd348c4d18b3245dd4bab585" title="make_nonrt2rt_solution" alt="" coords="696,64,853,93"/><area shape="rect" id="node11" href="../../d8/d60/init_8c.html#a73009fd6280963c265e2cf5d1c353e8d" title="get_full_rtsolution" alt="" coords="909,64,1032,93"/><area shape="rect" id="node13" href="../../d8/d60/init_8c.html#af94364e17d67cddfbb7bb3bf39c05ee6" title="init_dsandvels_koral" alt="" coords="1135,5,1273,35"/><area shape="rect" id="node25" href="../../d8/d60/init_8c.html#a448cd3fd9a1d862485e7b6e67b965172" title="process_restart_toget\l_radiation" alt="" coords="1131,58,1277,105"/><area shape="rect" id="node15" href="../../df/d15/init_8tools_8c.html#acefd26944dbbb1c289886f520f6befac" title="init_dsandvels" alt="" coords="1636,5,1740,35"/><area shape="rect" id="node17" href="../../df/d15/init_8tools_8c.html#a77551ab2581efdbaf170dfca073ff9ab" title="user1_init_primitives" alt="" coords="4019,276,4160,305"/><area shape="rect" id="node19" href="../../de/db2/initbase_8funcdeclare_8h.html#a0afa200a5f947b1c9f6e554519f28fc4" title="init_primitives" alt="" coords="4209,301,4311,331"/><area shape="rect" id="node21" href="../../de/df8/initbase_8c.html#ac4110398e386c9888d9565630357dbbe" title="General&#45;Primary init() routine Uses globals inside init() because sets memory and sets physics..." alt="" coords="4388,328,4425,357"/><area shape="rect" id="node23" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="4501,408,4552,437"/><area shape="rect" id="node29" href="../../d2/d72/phys_8tools_8rad_8c.html#af50896d039d660550b738862b3390b07" title="radiative ortonormal ff primitives (E,F^i) &lt;&#45;&gt; primitives in lab frame Used only for initial conditio..." alt="" coords="729,117,820,147"/><area shape="rect" id="node33" href="../../d2/d72/phys_8tools_8rad_8c.html#a64226cb28f52020ffe18ac6c6b1a2f5c" title="Input: start with pin [with fluid in whichvel velocity and whichcoordfluid coordinates (PRIMECOORDS o..." alt="" coords="905,377,1036,423"/><area shape="rect" id="node35" href="../../de/d51/bounds_8c.html#a3bc773d499b145705bdc23125b963840" title="Koral specific physical boundary conditions." alt="" coords="1104,592,1304,621"/><area shape="rect" id="node135" href="../../de/d51/bounds_8c.html#a09a080d9895db7b800a3824cb3fac9f1" title="X1 lower for beam injection to create shadow." alt="" coords="1124,645,1284,675"/><area shape="rect" id="node138" href="../../de/d51/bounds_8c.html#a3ee134cc5fb18752265c16a20dbdfb63" title="X3 lower for radiation beam injection." alt="" coords="1107,699,1301,728"/><area shape="rect" id="node141" href="../../de/d51/bounds_8c.html#a8300ddf3ae6a3866234cc0e9c12f26dc" title="X1 upper for inflow." alt="" coords="1368,335,1555,364"/><area shape="rect" id="node144" href="../../de/d51/bounds_8c.html#a01088f65c7a4cfa2ebfed202f815b951" title="X1 lower and upper for RADATM." alt="" coords="1376,388,1547,417"/><area shape="rect" id="node147" href="../../de/d51/bounds_8c.html#a1382959a7b699ea5d224168612504263" title="X1 upper for inflow." alt="" coords="1388,441,1535,471"/><area shape="rect" id="node150" href="../../de/d51/bounds_8c.html#ac15824bc610943cb7e02112e77b94752" title="on&#45;grid bounding" alt="" coords="1412,495,1511,524"/><area shape="rect" id="node153" href="../../de/d51/bounds_8c.html#a42658c4ecf3c6edb958394eb65a9ac2b" title="RADNT." alt="" coords="1415,124,1508,153"/><area shape="rect" id="node156" href="../../de/d51/bounds_8c.html#a3e4008fd24427b2e91d0ae5882b9536a" title="X1 upper for RADCYLBEAM." alt="" coords="1379,177,1544,207"/><area shape="rect" id="node159" href="../../de/d51/bounds_8c.html#ac32c1a20138382904dc5f1c66778ad8b" title="X1 upper for RADCYLJET." alt="" coords="1131,229,1277,259"/><area shape="rect" id="node162" href="../../de/d51/bounds_8c.html#a635fbaba3d6d6afcf5f34bbb2c278737" title="X2 upper for radiation beam injection." alt="" coords="1089,539,1319,568"/><area shape="rect" id="node165" href="../../de/d51/bounds_8c.html#a9f1df4e461f3f776bf3cb80e36a4d6df" title="get_radcylbeamcart" alt="" coords="1136,283,1272,312"/><area shape="rect" id="node37" href="../../de/d51/bounds_8c.html#a34ac3f1ca7b0f3a21053c633da9931a9" title="user boundary routine" alt="" coords="1603,441,1773,471"/><area shape="rect" id="node39" href="../../d4/dad/bounds_8funcdeclare_8h.html#a4bc7413b2cdb89e070f38bbb689ae555" title="bound_prim_user_dir" alt="" coords="1825,461,1967,491"/><area shape="rect" id="node124" href="../../d4/dad/bounds_8funcdeclare_8h.html#a2fbddc9ff8fc706bafa80c39695c7262" title="assume single user function takes care of primitive locations" alt="" coords="1821,256,1971,285"/><area shape="rect" id="node41" href="../../d9/de0/step__ch_8c.html#adbe0e3ba8a74f09ab928a96bd68cab6d" title="bound any prim type CALLS directly real and MPI boundary functions pstag = pstagglobal ucons = unewgl..." alt="" coords="2020,483,2129,512"/><area shape="rect" id="node43" href="../../d9/de0/step__ch_8c.html#a689fddc1949b1a1d390b59d10d17d83c" title="normal full bounding during evolution NOTEMARK: Was previously also bounding pstag here..." alt="" coords="2197,809,2323,839"/><area shape="rect" id="node55" href="../../d9/de0/step__ch_8c.html#a4079244d85c301885c1363ca41502869" title="simple bounding during evolution NOTEMARK: Was previously also bounding pstag here, but not necessary since done by calling bound_pstag in fluxctstag.c" alt="" coords="2179,863,2341,892"/><area shape="rect" id="node58" href="../../d9/de0/step__ch_8c.html#addca75a18cc861326a321565a2e81aa0" title="normal bounding of non&#45;staggered primitives" alt="" coords="2216,483,2304,512"/><area shape="rect" id="node118" href="../../d9/de0/step__ch_8c.html#a460b84e1112e3aef17209c20e22e1cf1" title="bound all prims" alt="" coords="2652,115,2775,144"/><area shape="rect" id="node45" href="../../d9/de0/step__ch_8c.html#ad36a0f9f915547477e3bb2405f8166b9" title="things to do after advance()" alt="" coords="2428,863,2529,892"/><area shape="rect" id="node47" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="3836,769,3969,799"/><area shape="rect" id="node49" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="4227,645,4293,675"/><area shape="rect" id="node51" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="4361,488,4452,517"/><area shape="rect" id="node60" href="../../dc/dae/flux_8c.html#aef355ccd1ca2295b84ad2fe1fc011d35" title="normal interpolation of CENT quantities to FACE quantities sets global variables pl_ct and pr_ct to p..." alt="" coords="2389,585,2568,615"/><area shape="rect" id="node77" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aecb3f613a7cb3bbb42fff2dbee5d65a1" title="This vpot2field function is for staggered method to evolve quasi&#45;deaveraged fields (i..." alt="" coords="3087,225,3252,255"/><area shape="rect" id="node79" href="../../de/db2/initbase_8funcdeclare_8h.html#ae6b2ad4cd0debf5b89ba8a9e471d6977" title="assumes normal field p pleft used as temp var if FLUXB==FLUXCTSTAG assigns conserved field in UEVOLVE..." alt="" coords="3303,276,3380,305"/><area shape="rect" id="node88" href="../../d0/dde/fluxctstag_8c.html#a4e3d76c6ad125b8199948408c262e3a1" title="wrapper for: 1) interpolate FACE 2 CORN 2) loop over dimensions setting field flux dimension&#45;by&#45;dimen..." alt="" coords="2883,683,3013,712"/><area shape="rect" id="node91" href="../../d0/dde/fluxctstag_8c.html#a2dd789bf1402bef72523cdb69e85806e" title="use global pbcorninterp and pvcorninterp at CORN1,2,3 to obtain EMFs at CORN1,2,3 NO interpolation of..." alt="" coords="2413,638,2544,685"/><area shape="rect" id="node94" href="../../d0/dde/fluxctstag_8c.html#aaec26a518629175ecceefbaf6c84225e" title="wrapper for continuous interpolation for FACE_to_CENT" alt="" coords="2392,431,2565,460"/><area shape="rect" id="node98" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aa31dd83c96936277334c62e2098dd51d" title="wrapper for taking staggered conserved field quantity and obtaining centered field quantity upoint en..." alt="" coords="2860,500,3036,529"/><area shape="rect" id="node107" href="../../d0/dde/fluxctstag_8c.html#a6cd90dff56319085b32bc57c0c8b3cfd" title="this function called in initbase.c and during advance() here ustag is point value if dimension doesn&#39;..." alt="" coords="2653,500,2773,529"/><area shape="rect" id="node110" href="../../d0/dde/fluxctstag_8c.html#ad6aa918442f7768dff3c099ba353ee64" title="slope_lim_face2corn() is provided p2interp and returns pleft/pright differs from slope_lim() by range..." alt="" coords="2408,708,2549,737"/><area shape="rect" id="node62" href="../../dc/dae/flux_8c.html#a2602a4dad9ed7adc944227d02435312e" title="standard (non&#45;field flux) calculation but setup to store results of interpolation so can be used for ..." alt="" coords="2616,604,2811,633"/><area shape="rect" id="node64" href="../../dc/dae/flux_8c.html#aaf6d832880760f80459d91477c28b519" title="wrapper for different standard 1&#45;D flux calculators 1&#45;D interpolate and get flux for that direction (..." alt="" coords="2891,604,3005,633"/><area shape="rect" id="node66" href="../../dc/dae/flux_8c.html#a8ffa7399bd5354fdcdec5f3e1adf0b13" title="wrapper for CENT_to_FACE1,2,3 used to compute flux at face" alt="" coords="3123,604,3216,633"/><area shape="rect" id="node68" href="../../d5/d2f/flux_8funcdeclare_8h.html#ab229b0f3f2caf3c0a3ef5299fba2b1c0" title="see fluxcompute.c for non&#45;computer science, real physics calculations of flux" alt="" coords="3308,604,3375,633"/><area shape="rect" id="node70" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="3452,604,3580,633"/><area shape="rect" id="node75" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="3439,525,3593,555"/><area shape="rect" id="node72" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="3684,681,3753,711"/><area shape="rect" id="node81" href="../../df/d15/init_8tools_8c.html#a3750bc790613bc6c8c805af0f1b839c8" title="user1_init_vpot2field_user" alt="" coords="3429,276,3603,305"/><area shape="rect" id="node83" href="../../de/db2/initbase_8funcdeclare_8h.html#afda44281ad5c163455c40f012d4a8954" title="init_vpot2field_user" alt="" coords="3652,276,3785,305"/><area shape="rect" id="node85" href="../../de/db2/initbase_8funcdeclare_8h.html#a90699a18ede8b7f112c0078512804ec1" title="initialize vector potential given user function assumes normal non&#45;staggered field in pr Notice that ..." alt="" coords="3868,276,3937,305"/><area shape="rect" id="node96" href="../../d0/dde/fluxctstag_8c.html#a5e3dcbe89d6f8a9384cafb58afd7dbf4" title="interpolates field at FACE to field at CENT assuming field along itself is continuous" alt="" coords="2653,430,2773,477"/><area shape="rect" id="node102" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aaa24493002bc8c0a527b1ea2ac2dddbf" title="convert conservative U to stag point P and CENT point U and CENT point primitive" alt="" coords="3103,431,3236,460"/><area shape="rect" id="node112" href="../../d0/dde/fluxctstag_8c.html#a985ee116306b4011810334ae93900493" title="INPUTS: Nvec, pr, primface_l[dir], primface_r[dir] OUTPUTS: pbcorn[dir][side], pvcorn[dir][side][side..." alt="" coords="2624,708,2803,737"/><area shape="rect" id="node120" href="../../d9/de0/step__ch_8c.html#a91fe5c4370e3292a19e7f794797a407f" title="normal bounding of all primitives" alt="" coords="3852,223,3953,252"/><area shape="rect" id="node126" href="../../d9/de0/step__ch_8c.html#abdea68b778dc9253324da69d3c376965" title="bound any pstag type CALLS directly real and MPI boundary functions pstag is at FACE1,2,3 for fields, so user bound is different MPI bounding is the same as CENT quantities used when restarting in initbase.c to bound unewglobal for FLUXB==FLUXCTSTAG" alt="" coords="2420,120,2537,149"/><area shape="rect" id="node129" href="../../d9/de0/step__ch_8c.html#a6f4b963a50a7288964f01775f2f18bb9" title="normal bounding of staggered primitives" alt="" coords="2665,168,2761,197"/><area shape="rect" id="node132" href="../../d0/dde/fluxctstag_8c.html#aa169cb1999412f2e2460012cc5d7a804" title="pure DONOR version: upoint is input staggered updated field that needs to be converted to pstag and t..." alt="" coords="2860,158,3036,205"/><area shape="rect" id="node167" href="../../de/d51/bounds_8c.html#a16398a5325a9df48783423f00ba65bb7" title="all boundaries for RADCYLBEAMCART" alt="" coords="1385,281,1537,311"/><area shape="rect" id="node175" href="../../de/d51/bounds_8c.html#a3a96629ab9e350154c992f8a4ce92cbe" title="X1 lower and upper X2." alt="" coords="1392,751,1531,780"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri May 20 2016 15:52:37 for HARM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.3.1
</small></address>
</body>
</html>
