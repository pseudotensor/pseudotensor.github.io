<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>HARM: tetrad.c Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">HARM
   </div>
   <div id="projectbrief">harm and utilities</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">tetrad.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d5/d0a/tetrad_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &quot;decs.h&quot;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div>
<div class="line"><a name="l00008"></a><span class="lineno"><a class="code" href="../../d5/d0a/tetrad_8c.html#aea47a16081c419ff3fe265f860b65309">    8</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d5/d0a/tetrad_8c.html#a0b6918a005f8391e9209af8cc2582546">globalii</a>,<a class="code" href="../../d5/d0a/tetrad_8c.html#a3087b623b8671fbc6d9b803311343bd5">globaljj</a>,<a class="code" href="../../d5/d0a/tetrad_8c.html#aea47a16081c419ff3fe265f860b65309">globalkk</a>;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// declarations</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d0a/tetrad_8c.html#acc8b9e9ae9e03624e53b0a45e881a367" title="compute orthonormal tetrad [ortho]^[lab] for converting u_[lab] or u^[ortho] Notes: For full rotating...">compute_tetrcon_frommetric_mathematica</a>(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*generalmatrix)[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*tetrcon)[NDIM], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> eigenvalues[]);</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d0a/tetrad_8c.html#a2ed15e40ab71ecd986b28510b0d8b8d4">compute_tetrcon_frommetric</a>(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*generalmatrix)[NDIM], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*tetrcon)[NDIM], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> eigenvalues[]);</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d0a/tetrad_8c.html#a7daace7a466d45cd01436b89193102c0" title="pre-setup tetrad use of lapack function">tetlapack_func_prec</a>(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*metr)[NDIM], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*tetr)[NDIM], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> eigenvalues[]);</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div>
<div class="line"><a name="l00018"></a><span class="lineno"><a class="code" href="../../d3/dfc/tetrad_8funcdeclare_8h.html#ad5d2935e2a3bac988149aa7b02c8feca">   18</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d5/d0a/tetrad_8c.html#ad5d2935e2a3bac988149aa7b02c8feca" title="find suitable orthonormal tetrad wrapper for tetr_func().">tetr_func_frommetric</a>(<span class="keywordtype">int</span> primcoord, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*<a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>)[NDIM], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *<a class="code" href="../../dc/dd2/newcodediff_8txt.html#a93300df7bd864b90cc8ed9f3d96515ad">gcov</a>, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*tetrcov)[NDIM],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*tetrcon)[NDIM], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> eigenvalues[])</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;{</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  <span class="keywordtype">int</span> jj,kk;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <span class="keywordtype">int</span> ll,pp;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> idxdxp[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../dc/dd2/newcodediff_8txt.html#a62cb0072605f5dd1d817dca192507a4d">newgcov</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ae689bafc5544c4d42f9a05a631bccce1">SYMMATRIXNDIM</a>];</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <span class="keywordtype">int</span> info;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="keywordflow">if</span>(primcoord){</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="comment">// get MCOORD metric from PRIMECOORD metric</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a8a51ec95e21441bc2c561af70a1037de" title="Get (dV/dX)^{-1}.">idxdxprim</a>(<a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>, idxdxp);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(jj,kk){</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;      newgcov[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a28b8da8b36c3a7b2f04da8809cd50b34">GIND</a>(jj,kk)]=0.0;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;      <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(ll,pp) {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        newgcov[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a28b8da8b36c3a7b2f04da8809cd50b34">GIND</a>(jj,kk)] += <a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a5a9cafebe4358571ae4a05b8af833f17" title="must multiply assignments by the below so don&#39;t duplicate sums">GINDASSIGNFACTOR</a>(jj,kk)*gcov[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a28b8da8b36c3a7b2f04da8809cd50b34">GIND</a>(ll,pp)]*idxdxp[ll][jj]*idxdxp[pp][kk];</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;      }</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    }</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  }</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="comment">// then just copy</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(jj,kk) newgcov[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a28b8da8b36c3a7b2f04da8809cd50b34">GIND</a>(jj,kk)]=gcov[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a28b8da8b36c3a7b2f04da8809cd50b34">GIND</a>(jj,kk)];</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  }</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="comment">// DEBUG</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="comment">//  if(tiglobal[1]==200 &amp;&amp; tiglobal[2]==10 &amp;&amp; tiglobal[3]==0){</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="comment">//    DLOOP(jj,kk) dualfprintf(fail_file,&quot;jj=%d kk=%d newgcov=%21.15g\n&quot;,jj,kk,newgcov[GIND(jj,kk)]);</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="comment">//  }</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="comment">// get tetrad (feed newgcov rather than gcov since with metric assume best comparison of vectors when have non-twisted metric and likely untwisted when using dxdxp)</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  info=<a class="code" href="../../d5/d0a/tetrad_8c.html#a0ca3db13e43c41bb7271db7bac10dc2a" title="input gcov and get out orthonormal tetrad in covariant and contravariant forms if metrictype...">tetr_func</a>(<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ad19896a59608c6a7807b40e60620eb40" title="tetrad.c stuff:">METRICTETRAD</a>, newgcov, tetrcov, tetrcon, eigenvalues);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keywordflow">return</span>(info);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;}</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div>
<div class="line"><a name="l00056"></a><span class="lineno"><a class="code" href="../../d5/d0a/tetrad_8c.html#a7daace7a466d45cd01436b89193102c0">   56</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d0a/tetrad_8c.html#a7daace7a466d45cd01436b89193102c0" title="pre-setup tetrad use of lapack function">tetlapack_func_prec</a>(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*metr)[NDIM], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*tetr)[NDIM], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> eigenvalues[])</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;{</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="keywordtype">int</span> info;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/dfc/tetlapack__func__doubleonly_8c.html#a6493f604b00b9a2337263d17b6230a02" title="native doubles for inside variables find tetrad">tetlapack_func</a>(<span class="keywordtype">double</span> (*metrin)[NDIM], <span class="keywordtype">double</span> (*tetrout)[NDIM], <span class="keywordtype">double</span> eigenvaluesout[]);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#if(SUPERLONGDOUBLE==0)</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor"></span>    info=<a class="code" href="../../d4/dfc/tetlapack__func__doubleonly_8c.html#a6493f604b00b9a2337263d17b6230a02" title="native doubles for inside variables find tetrad">tetlapack_func</a>(metr,tetr,eigenvalues);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor"></span>    <span class="comment">// external call to function in tetlapack_func_doubleonly.c</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordtype">double</span> metrin[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>],tetrout[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>],eigenvaluesout[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordtype">int</span> jj,kk;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(jj,kk) metrin[jj][kk] = (double)metr[jj][kk];</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    info=<a class="code" href="../../d4/dfc/tetlapack__func__doubleonly_8c.html#a6493f604b00b9a2337263d17b6230a02" title="native doubles for inside variables find tetrad">tetlapack_func</a>(metrin,tetrout,eigenvaluesout);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(jj,kk) tetr[jj][kk] = (<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>)tetrout[jj][kk];</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(jj) eigenvalues[jj] = (<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a>)eigenvaluesout[jj];</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keywordflow">return</span>(info);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;}</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="code" href="../../d3/dfc/tetrad_8funcdeclare_8h.html#a0ca3db13e43c41bb7271db7bac10dc2a">   80</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d5/d0a/tetrad_8c.html#a0ca3db13e43c41bb7271db7bac10dc2a" title="input gcov and get out orthonormal tetrad in covariant and contravariant forms if metrictype...">tetr_func</a>(<span class="keywordtype">int</span> inputtype, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *gcov, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*tetr_cov)[NDIM],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*tetr_con)[NDIM], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> eigenvalues[]) </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;{</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> generalmatrixlower[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> tmpgeneralmatrix[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>] ;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> tmpgeneralvec[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>] ;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>,k,l ;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="keywordtype">int</span> info;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="keywordtype">int</span> jj,kk;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="comment">// copy to 2D space</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(jj,kk) generalmatrixlower[jj][kk] = gcov[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a28b8da8b36c3a7b2f04da8809cd50b34">GIND</a>(jj,kk)];</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keywordflow">if</span>(inputtype==<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#ad19896a59608c6a7807b40e60620eb40" title="tetrad.c stuff:">METRICTETRAD</a>){</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    info=<a class="code" href="../../d5/d0a/tetrad_8c.html#a2ed15e40ab71ecd986b28510b0d8b8d4">compute_tetrcon_frommetric</a>(generalmatrixlower,tetr_con,eigenvalues);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  }</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    info=<a class="code" href="../../d5/d0a/tetrad_8c.html#a7daace7a466d45cd01436b89193102c0" title="pre-setup tetrad use of lapack function">tetlapack_func_prec</a>(generalmatrixlower,tetr_con,eigenvalues);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  }</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="comment">// force tetr_con to have correct signature so when applied it gives back vector as if nothing done (i.e. Kronecker Delta) (e.g. Minkowski to Minkowski)</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="comment">// Tcon_j^l = Tconorig^{al} \eta_{ja}</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="comment">// So first index is orthonormal and second index is old coordinate basis</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(j,k) tmpgeneralmatrix[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>][k] = tetr_con[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>][k];</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(j,k) tetr_con[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>][k] = 0. ;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(j,k) <span class="keywordflow">for</span>(l=0;l&lt;<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>;l++) tetr_con[j][k] += <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a84090a6666715240b33bc16623f3548a">mink</a>(j,l)*tmpgeneralmatrix[l][k] ;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="comment">// also fix eigenvalues to be consistent</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(j) tmpgeneralvec[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>] = eigenvalues[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>];</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(j) eigenvalues[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>]=0;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(j) <span class="keywordflow">for</span>(l=0;l&lt;<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>;l++) eigenvalues[j] += <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a84090a6666715240b33bc16623f3548a">mink</a>(j,l)*tmpgeneralvec[l] ;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="comment">// construct tetr_cov</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="comment">// Tcov^a_b = Tcon_j^l g_{lb} \eta^{aj}</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="comment">// So first index is orthonormal and second index is old coordinate basis.</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="comment">// So Tcon and Tcov are inverses but not transposes of each other as would occur if matrix_inverse() operated.</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(j,k) tmpgeneralmatrix[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>][k] = 0. ;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(j,k) <span class="keywordflow">for</span>(l=0;l&lt;<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>;l++) tmpgeneralmatrix[j][k] += tetr_con[j][l]*gcov[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a28b8da8b36c3a7b2f04da8809cd50b34">GIND</a>(l,k)] ;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(j,k) tetr_cov[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>][k] = 0. ;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(j,k) <span class="keywordflow">for</span>(l=0;l&lt;<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>;l++) tetr_cov[j][k] += <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#a84090a6666715240b33bc16623f3548a">mink</a>(j,l)*tmpgeneralmatrix[l][k] ;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="preprocessor"></span>  <span class="comment">/* tetr_ cov &amp; con are inverse transposes of each other */</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(j,k) tmpgeneralmatrix[j+1][k+1] = tetr_cov[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>][k] ;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  gaussj(tmpgeneralmatrix,NDIM,NULL,0) ;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(j,k) tetr_con[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>][k] = tmpgeneralmatrix[k+1][j+1] ;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="keywordflow">return</span>(info);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;}</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div>
<div class="line"><a name="l00147"></a><span class="lineno"><a class="code" href="../../d5/d0a/tetrad_8c.html#ae75d686939444826f58268fe3d1ccfe6">  147</a></span>&#160;<span class="preprocessor">#define DEBUGLAPACK 1</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00149"></a><span class="lineno"><a class="code" href="../../d5/d0a/tetrad_8c.html#a2ed15e40ab71ecd986b28510b0d8b8d4">  149</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d0a/tetrad_8c.html#a2ed15e40ab71ecd986b28510b0d8b8d4">compute_tetrcon_frommetric</a>(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*generalmatrix)[NDIM], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*tetrcon)[NDIM], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> eigenvalues[])</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;{</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> tetrconother[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="keywordtype">int</span> jj,kk;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="keywordtype">int</span> ll,pp;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="keywordtype">int</span> info;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> eigenvaluesother[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>],tempeigenvalues[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> errorold,errornew,temptetrcon[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> errorlist[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> error1,error2;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="keywordtype">int</span> newlist[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> signlistmat[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> signlist[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="preprocessor">#if(DEBUGLAPACK &amp;&amp; (USINGLAPACK))</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="comment">// in case feed in BL coord metric inside horizon, just fix so no minimum error reached</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; <span class="keywordflow">if</span>(generalmatrix[1][1]&lt;=0.0) generalmatrix[1][1]=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a8913cb5d64cfec23ae1a3052930ec468">NUMEPSILON</a>+fabs(generalmatrix[1][1]);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="comment">// get general tetrad and eigenvalues</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  info=<a class="code" href="../../d5/d0a/tetrad_8c.html#a7daace7a466d45cd01436b89193102c0" title="pre-setup tetrad use of lapack function">tetlapack_func_prec</a>(generalmatrix,tetrcon,eigenvalues);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="comment">// get tetrad and eigenvalues for not-so-general metric</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="comment">// (ignore this other info)</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <a class="code" href="../../d5/d0a/tetrad_8c.html#acc8b9e9ae9e03624e53b0a45e881a367" title="compute orthonormal tetrad [ortho]^[lab] for converting u_[lab] or u^[ortho] Notes: For full rotating...">compute_tetrcon_frommetric_mathematica</a>(generalmatrix, tetrconother, eigenvaluesother);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="comment">// try to reorder spatial parts, assuming time part is always negative eigenvalue that will come as first eigenvector always</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="comment">// tetrconother[jj][jj] is correct t,r,\theta,\phi order for diagonal part</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="comment">// tetrcon[jj][kk] is not correct order in general, with jj (rows) being out of order</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="comment">// error for every row compared to every row</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(jj,kk){<span class="comment">// double over rows</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    errorlist[jj][kk]=0.0;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    error1=0.0;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    error2=0.0;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(ll){ <span class="comment">// over columns</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      error1+=fabs(tetrcon[jj][ll]-tetrconother[kk][ll]);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="comment">// compensate for potential sign flip for eigenvector</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(ll){ <span class="comment">// over columns</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      error2+=fabs(tetrcon[jj][ll]+tetrconother[kk][ll]);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    }</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordflow">if</span>(error1&gt;error2){</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      errorlist[jj][kk]=error2;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <span class="comment">// use sign to indicate need to flip sign</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      signlistmat[jj][kk]=-1.0;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    }</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      errorlist[jj][kk]=error1; <span class="comment">// same sign</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      signlistmat[jj][kk]=1.0;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    }</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  }</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="comment">// now have error matrix.</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="comment">// start with minimum error pair and increase in error until obtain all unique matches</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(kk) newlist[kk]=-1;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="keywordtype">int</span> notfoundall=1;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> signerror=0;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="keywordflow">while</span>(notfoundall){</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordtype">int</span> minkk=-1;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordtype">int</span> minjj=-1;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> minerror=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a38eb76aa0a9a1bb1dac30c75be4a05b6">BIG</a>;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(jj,kk){</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      <span class="keywordtype">int</span> uniquecheck=0; <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(pp) <span class="keywordflow">if</span>(pp!=kk) uniquecheck += (newlist[pp]==jj);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      <span class="keywordflow">if</span>(fabs(errorlist[jj][kk])&lt;minerror &amp;&amp; newlist[kk]==-1 &amp;&amp; uniquecheck==0){ <span class="comment">// only use minimum if minimum AND not already on list (forces result to be unique)</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        minerror=fabs(errorlist[jj][kk]);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        minjj=jj;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        minkk=kk;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <span class="comment">//        if(globalii==0 &amp;&amp; globaljj==N2/2) dualfprintf(fail_file,&quot;minkk=%d&quot;,minkk);</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        signerror=<a class="code" href="../../d8/df4/global_8funcdeclare_8h.html#a1e471b644e7fd684cd5dbb144e00ee81">sign</a>(signlistmat[jj][kk]);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    }</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordflow">if</span>(minjj==-1 || minkk==-1){</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Problem in finding minimum error between eigenvectors\n&quot;</span>);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      myexit(34643634);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    }</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      newlist[minkk]=minjj; <span class="comment">// point {t,x,y,z}=minkk to lapack (minjj)</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      signlist[minkk]=signerror; <span class="comment">// set sign to flip for this given {t,x,y,z}=minkk</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <span class="keywordtype">int</span> uniquecheck=0; <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(kk) <span class="keywordflow">if</span>(kk!=minkk) uniquecheck += (newlist[kk]==minjj);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      <span class="keywordflow">if</span>(uniquecheck==1){</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Tried to double set: %d %d %d\n&quot;</span>,minkk,minjj);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(jj) dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;jj=%d newlist=%d\n&quot;</span>,jj,newlist[jj]);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    }</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    notfoundall=0; <span class="comment">// end?</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(kk) <span class="keywordflow">if</span>(newlist[kk]==-1) notfoundall=1; <span class="comment">// nope, not end</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  }</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <span class="comment">// store original result</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(jj,kk) temptetrcon[jj][kk]=tetrcon[jj][kk];</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(jj) tempeigenvalues[jj]=eigenvalues[jj];</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="comment">// reorder</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment"></span>  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(jj){<span class="comment">// over rows</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    eigenvalues[jj]=tempeigenvalues[newlist[jj]];</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  }</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(jj){<span class="comment">// over rows</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(kk){</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      tetrcon[jj][kk]=temptetrcon[newlist[jj]][kk]*signlist[jj]; <span class="comment">// signlist[jj] since jj is t,x,y,z in order</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    }</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  }</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="preprocessor">#if(DEBUGLAPACK==2)</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="preprocessor"></span>  <span class="comment">// real debug</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d5/d0a/tetrad_8c.html#a0b6918a005f8391e9209af8cc2582546">globalii</a>==0 &amp;&amp; <a class="code" href="../../d5/d0a/tetrad_8c.html#a3087b623b8671fbc6d9b803311343bd5">globaljj</a>==<a class="code" href="../../da/d3e/definit_8h.html#acd864640121c7df2c19f61f7baa507e4">N2</a>/2){</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="comment">//  if(tiglobal[1]==200 &amp;&amp; tiglobal[2]==10 &amp;&amp; tiglobal[3]==0){</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;\ninfo=%d\n&quot;</span>,info);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(jj) dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;jj=%d newlist=%d\n&quot;</span>,jj,newlist[jj]);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(jj){</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;jj=%d eigenorig=%21.15g eigen=%21.15g old=%21.15g\n&quot;</span>,jj,tempeigenvalues[jj],eigenvalues[jj],eigenvaluesother[jj]);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    }</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(jj,kk){</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;jj=%d kk=%d lapack=%21.15g old=%21.15g\n&quot;</span>,jj,kk,tetrcon[jj][kk],tetrconother[jj][kk]);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    }</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    fflush(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    myexit(0);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  }</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="preprocessor">#else // else if not debugging</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="preprocessor">#if(USINGLAPACK)</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="preprocessor"></span>  <span class="comment">// input general metric</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="comment">// don&#39;t need to convert using idxdxp since result is tetrad used to convert from whatever input metric one started with</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  info=<a class="code" href="../../d5/d0a/tetrad_8c.html#a7daace7a466d45cd01436b89193102c0" title="pre-setup tetrad use of lapack function">tetlapack_func_prec</a>(generalmatrix,tetrcon,eigenvalues);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <span class="comment">// generate orthonormal basis and dxdxp transformation (user-based function that doesn&#39;t take general metric)</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  info=<a class="code" href="../../d5/d0a/tetrad_8c.html#acc8b9e9ae9e03624e53b0a45e881a367" title="compute orthonormal tetrad [ortho]^[lab] for converting u_[lab] or u^[ortho] Notes: For full rotating...">compute_tetrcon_frommetric_mathematica</a>(generalmatrix, tetrcon, eigenvalues);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="preprocessor">#endif // end over debug/not debug</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="keywordflow">return</span>(info);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;}</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div>
<div class="line"><a name="l00315"></a><span class="lineno"><a class="code" href="../../d5/d0a/tetrad_8c.html#acc8b9e9ae9e03624e53b0a45e881a367">  315</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/d0a/tetrad_8c.html#acc8b9e9ae9e03624e53b0a45e881a367" title="compute orthonormal tetrad [ortho]^[lab] for converting u_[lab] or u^[ortho] Notes: For full rotating...">compute_tetrcon_frommetric_mathematica</a>(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*generalmatrix)[NDIM], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*tetrcon)[NDIM], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> eigenvalues[])</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;{</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> gtt,grr,grt,ghh,gpp;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> blob1,blob1sq;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="comment">// now assume no mixing in r-\theta</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <span class="comment">// Right now, only works for a=0 KS or BL</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="comment">// But, even for a\neq 0, the order is found correctly since spherical polar and KS gtr terms dominate</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d8/d5b/defs_8general_8h.html#af850e395071231822a385de91849efd3">THETAROT</a>!=0.0){</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="comment">//    dualfprintf(fail_file,&quot;compute_tetrcon_frommetric_mathematica() needs to have rotation added (see jon_interp stuff) so can handle tilts that mix theta and phi.  Then can trust picking up dominate terms: THETAROT=%g\n&quot;,THETAROT);</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="comment">//myexit(546292153); // GODMARK</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  }</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  gtt=generalmatrix[0][0];</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  grr=generalmatrix[1][1];</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  grt=generalmatrix[1][0];</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  ghh=generalmatrix[2][2];</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  gpp=generalmatrix[3][3];</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  blob1=grr - sqrt(4.0*((grt)*(grt)) + ((grr - gtt)*(grr - gtt))) + gtt;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  blob1sq=blob1*blob1;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <span class="comment">//regexp: pow(\([a-zA-Z0-9-+*/ ]+\),2) -&gt; ((\1)*(\1))</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <span class="comment">// get orthonormal basis transformation</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  tetrcon[0][0]=-(sqrt(grr + sqrt(4.0*((grt)*(grt)) + ((grr - gtt)*(grr - gtt))) - gtt)/</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                  pow((4.0*((grt)*(grt)) + ((grr - gtt)*(grr - gtt)))*blob1sq,0.25));</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  tetrcon[0][1] =  (2.0*grt)/(sqrt(4.0*((grt)*(grt)) + (grr - gtt)*(grr + sqrt(4.0*((grt)*(grt)) + ((grr - gtt)*(grr - gtt))) - gtt))*</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                              sqrt(fabs(grr - sqrt(4.0*((grt)*(grt)) + ((grr - gtt)*(grr - gtt))) + gtt)));</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  tetrcon[0][2] = 0.0;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  tetrcon[0][3] = 0.0;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  tetrcon[1][0] = (2.0*grt)/sqrt((4.0*((grt)*(grt)) + (grr - gtt)*(grr + sqrt(4.0*((grt)*(grt)) + ((grr - gtt)*(grr - gtt))) - gtt))*</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                                 (grr + sqrt(4.0*((grt)*(grt)) + ((grr - gtt)*(grr - gtt))) + gtt));</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  tetrcon[1][1] = sqrt((grr + sqrt(4.0*((grt)*(grt)) + ((grr - gtt)*(grr - gtt))) - gtt)/</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                       (sqrt(4.0*((grt)*(grt)) + ((grr - gtt)*(grr - gtt)))*(grr + sqrt(4.0*((grt)*(grt)) + ((grr - gtt)*(grr - gtt))) + gtt)));</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  tetrcon[1][2] = 0.0;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  tetrcon[1][3] = 0.0;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  tetrcon[2][0] = 0.0;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  tetrcon[2][1] = 0.0;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  tetrcon[2][2] = 1.0/fabs(sqrt(ghh));</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  tetrcon[2][3] = 0.0;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  tetrcon[3][0] = 0.0;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  tetrcon[3][1] = 0.0;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  tetrcon[3][2] = 0.0;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  tetrcon[3][3] = 1.0/fabs(sqrt(gpp));</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  eigenvalues[0]=0.5*(grr - 1.*sqrt(4.*pow(grt,2) + pow(grr - 1.*gtt,2)) + gtt);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  eigenvalues[1]=0.5*(grr + sqrt(4.*pow(grt,2) + pow(grr - 1.*gtt,2)) + gtt);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  eigenvalues[2]=ghh;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  eigenvalues[3]=gpp;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;}</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div>
<div class="line"><a name="l00390"></a><span class="lineno"><a class="code" href="../../d3/dfc/tetrad_8funcdeclare_8h.html#a1a0f6fda274fc7e16bdd8fcdfb4450ed">  390</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d5/d0a/tetrad_8c.html#a1a0f6fda274fc7e16bdd8fcdfb4450ed" title="Notes:">calc_ORTHOes</a>(<span class="keywordtype">int</span> primcoord, <span class="keyword">struct</span> <a class="code" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae" title="typedef struct of_geom struct of_compgeom; force to be the same">of_geom</a> *ptrgeom, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> tmuup[][NDIM], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> tmudn[][NDIM])</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;{</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../dc/dd2/newcodediff_8txt.html#a9a663b46497bd8f1608c548396d23320">dxdxp</a>[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> idxdxp[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> tetrcovV[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> tetrconV[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> eigenvaluesV[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> tetrcovX[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> tetrconX[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <span class="keywordtype">int</span> jj,kk,ll;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <a class="code" href="../../d5/d0a/tetrad_8c.html#a0b6918a005f8391e9209af8cc2582546">globalii</a>=ptrgeom-&gt;i;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <a class="code" href="../../d5/d0a/tetrad_8c.html#a3087b623b8671fbc6d9b803311343bd5">globaljj</a>=ptrgeom-&gt;j;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <a class="code" href="../../d5/d0a/tetrad_8c.html#aea47a16081c419ff3fe265f860b65309">globalkk</a>=ptrgeom-&gt;k;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="keywordflow">if</span>(primcoord){</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="comment">// get dxdxp</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a0672d8c0ee4ff07c7265d0ecbc365cdc" title="normally-used dxdxp[i,j,k] = dV/dX">dxdxprim_ijk</a>(ptrgeom-&gt;i,ptrgeom-&gt;j,ptrgeom-&gt;k,ptrgeom-&gt;p,dxdxp);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <a class="code" href="../../d9/de9/coord_8c.html#a8a51ec95e21441bc2c561af70a1037de" title="Get (dV/dX)^{-1}.">idxdxprim</a>(dxdxp, idxdxp);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  }</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="comment">// then won&#39;t use dxdxp, so can just leave unset, but set it to diag(1,1,1,1) for santiy in case used.</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(jj,kk) dxdxp[jj][kk]=idxdxp[jj][kk]=0.0;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(jj)  dxdxp[jj][jj]=idxdxp[jj][jj]=1.0;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  }</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="comment">// get tetrad (uses dxdxp so that tetrcon and tetrcon and eigenvalues are using V metric not X metric</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <a class="code" href="../../d5/d0a/tetrad_8c.html#ad5d2935e2a3bac988149aa7b02c8feca" title="find suitable orthonormal tetrad wrapper for tetr_func().">tetr_func_frommetric</a>(primcoord, dxdxp, ptrgeom-&gt;gcov, tetrcovV, tetrconV, eigenvaluesV); <span class="comment">// doesn&#39;t account for ordering issue.</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="comment">//  tetr_func(METRICTETRAD,ptrgeom-&gt;gcov, tetrcovV, tetrconV, eigenvaluesV);</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <span class="keywordflow">if</span>(primcoord){</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="comment">// now convert back to X metric for general internal code use</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="comment">// TBup_\mu[ff ortho]^\nu[lab coordbasis] = ilambda^aa[lab ortho]_\mu[ff ortho] Tetrcon_aa[lab ortho]^\nu[lab coordbasis]</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="comment">// TBlo^\mu[ff ortho]_\nu[lab coordbasis] =  lambda^\mu[ff ortho]_aa[lab ortho] Tetrcov^aa[lab ortho]_\nu[lab coordbasis]</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="comment">// \LambdaXcov^jj[ortho]_kk[labX] = \LambdaVcov^jj[ortho]_ll[labV] dxdxp^ll[labV]_kk[labX]</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(jj,kk){</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      tetrcovX[jj][kk]=0.0;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;      <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(ll) {</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        tetrcovX[jj][kk] += tetrcovV[jj][ll]*dxdxp[ll][kk];</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      }</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    }</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="comment">// \LambdaXcon_jj[ortho]^kk[labX] = \LambdaVcon_jj[ortho]^ll[labV] idxdxp^kk[labX]_ll[labV]</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(jj,kk){</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      tetrconX[jj][kk]=0.0;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(ll) {</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        tetrconX[jj][kk] += tetrconV[jj][ll]*idxdxp[kk][ll];</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      }</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    }</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="comment">// map to tmuup and tmudn</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(jj,kk) tmuup[jj][kk]=tetrcovX[jj][kk]; <span class="comment">// \Lambda^jj[ortho]_kk[labX] = tmuup = &quot;LAB2ORTHO&quot; = tetrcovX</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(jj,kk) tmudn[jj][kk]=tetrconX[jj][kk]; <span class="comment">// \Lambda_jj[ortho]^kk[labX] = tmudn = &quot;ORTHO2LAB&quot; = tetrconX</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  }</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="comment">// map to tmuup and tmudn</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(jj,kk) tmuup[jj][kk]=tetrcovV[jj][kk]; <span class="comment">// \Lambda^jj[ortho]_kk[labV] = tmuup = &quot;LAB2ORTHO&quot; = tetrcovV</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(jj,kk) tmudn[jj][kk]=tetrconV[jj][kk]; <span class="comment">// \Lambda_jj[ortho]^kk[labV] = tmudn = &quot;ORTHO2LAB&quot; = tetrconV</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  }</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;}</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div>
<div class="line"><a name="l00462"></a><span class="lineno"><a class="code" href="../../d5/d0a/tetrad_8c.html#a529e9fcba9169e956453fa28b0ec5b29">  462</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d5/d0a/tetrad_8c.html#a529e9fcba9169e956453fa28b0ec5b29" title="get stored or compute tetrcov and tetrcon primcoord: whether PRIMCOORDS type, so will use dxdxp to si...">get_tetrcovcon</a>(<span class="keywordtype">int</span> primcoord, <span class="keyword">struct</span> <a class="code" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae" title="typedef struct of_geom struct of_compgeom; force to be the same">of_geom</a> *ptrgeom, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (**tetrcov)[NDIM],<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (**tetrcon)[NDIM])</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;{</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  <span class="comment">// for tetrads</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment"></span>  <span class="keywordtype">int</span> ii,jj,kk,pp;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  ii=ptrgeom-&gt;i;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  jj=ptrgeom-&gt;j;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  kk=ptrgeom-&gt;k;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  pp=ptrgeom-&gt;p;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <span class="comment">// get tetrads</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <span class="comment">// tmuup ~ tlab2ortho[LAB2ORTHO] ~ tetrcon [which operates on covariant things when in form: ufl_\nu = Tetrcon_\nu^\mu ucovlab_\mu]</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <span class="comment">// tmudn ~ tlab2ortho[ORTHO2LAB] ~ tetrcov [which operates on contravariant things when in form: ufl^\nu = Tetrcov^\nu_\mu uconlab^\mu</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="comment">// i.e. first and second index each always refer to the same basis without transposition.  So always contract with second index to get thing into form of first index.</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  <span class="comment">// note that ORTHO2LAB is stored as tetrcon=tmudn</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  <span class="comment">// note that LAB2ORTHO is stored as tetrcov=tmuup</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../da/d3e/definit_8h.html#aa6d3ce33f957c5eea42dcf6674d7621d" title="whether to store X,V,dxdxp in case are expensive to compute">STORETLAB2ORTHO</a>==1){ <span class="comment">// global parameter</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="comment">// then just get stored version instead of computing on fly</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    *tetrcov=<a class="code" href="../../df/d1c/global_8storage_8h.html#a57a6d56d5f94ea64c53db8875565341d">GLOBALMETMACP2A0</a>(tlab2ortho,pp,<a class="code" href="../../d4/d96/global_8nondepmnemonics_8rad_8h.html#ad7600d664cf76243bee805309f710011">LAB2ORTHO</a>,ii,jj,kk);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    *tetrcon=<a class="code" href="../../df/d1c/global_8storage_8h.html#a57a6d56d5f94ea64c53db8875565341d">GLOBALMETMACP2A0</a>(tlab2ortho,pp,<a class="code" href="../../d4/d96/global_8nondepmnemonics_8rad_8h.html#a4284f589a0c1f125916ebcb09f5c42dc">ORTHO2LAB</a>,ii,jj,kk);</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  }</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <span class="keywordflow">else</span>{<span class="comment">// compute on fly here</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="comment">// compute (expensive in general!)</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="comment">// NOTE ORDER!</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <a class="code" href="../../d5/d0a/tetrad_8c.html#a1a0f6fda274fc7e16bdd8fcdfb4450ed" title="Notes:">calc_ORTHOes</a>(primcoord, ptrgeom, *tetrcov, *tetrcon);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  }</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;}</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="keywordtype">int</span> calc_ZAMOes_old(<span class="keyword">struct</span> <a class="code" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae" title="typedef struct of_geom struct of_compgeom; force to be the same">of_geom</a> *ptrgeom, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> emuup[][NDIM], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> emudn[][NDIM])</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;{</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> e2nu,e2psi,e2mu1,e2mu2,omega;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> gtt,gtph,gphph,grr,gthth;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#ad21ff679aac3fe28202c6d592eafd3e6">i</a>,<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  <span class="comment">// recast as [NDIM][NDIM] matrix</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  <span class="comment">//  FTYPE emuup[][NDIM]=(FTYPE (*)[NDIM])(&amp;ptremuup[0]);</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  <span class="comment">//FTYPE emudn[][NDIM]=(FTYPE (*)[NDIM])(&amp;ptremudn[0]);</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  gtt=ptrgeom-&gt;gcov[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a28b8da8b36c3a7b2f04da8809cd50b34">GIND</a>(0,0)];</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  gtph=ptrgeom-&gt;gcov[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a28b8da8b36c3a7b2f04da8809cd50b34">GIND</a>(0,3)];</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  gphph=ptrgeom-&gt;gcov[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a28b8da8b36c3a7b2f04da8809cd50b34">GIND</a>(3,3)];</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  grr=ptrgeom-&gt;gcov[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a28b8da8b36c3a7b2f04da8809cd50b34">GIND</a>(1,1)];</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  gthth=ptrgeom-&gt;gcov[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a28b8da8b36c3a7b2f04da8809cd50b34">GIND</a>(2,2)];</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  <span class="comment">//Bardeen&#39;s 72 coefficients:</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  e2nu=-gtt+gtph*gtph/gphph;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  e2psi=gphph;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  e2mu1=grr;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  e2mu2=gthth;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  omega=-gtph/gphph;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="keywordflow">for</span>(i=0;i&lt;4;i++)</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="keywordflow">for</span>(j=0;j&lt;4;j++)</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      {</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        emuup[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#ad21ff679aac3fe28202c6d592eafd3e6">i</a>][<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>]=0.;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        emudn[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#ad21ff679aac3fe28202c6d592eafd3e6">i</a>][<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>]=0.;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      }</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  emuup[0][0]=sqrt(e2nu);</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  emuup[1][1]=sqrt(e2mu1);</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  emuup[2][2]=sqrt(e2mu2);</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  emuup[0][3]=-omega*sqrt(e2psi);</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  emuup[3][3]=sqrt(e2psi);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  emudn[3][0]=omega*1./sqrt(e2nu);</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  emudn[0][0]=1./sqrt(e2nu);</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  emudn[1][1]=1./sqrt(e2mu1);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  emudn[2][2]=1./sqrt(e2mu2);</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  emudn[3][3]=1./sqrt(e2psi);</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  <span class="comment">// need to return Kerr-Schild prime transformations</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;}</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;</div>
<div class="line"><a name="l00565"></a><span class="lineno"><a class="code" href="../../d3/dfc/tetrad_8funcdeclare_8h.html#ac8c22d5bd0a099b8268db0925d722d5d">  565</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d5/d0a/tetrad_8c.html#ac8c22d5bd0a099b8268db0925d722d5d" title="Compute general Lorentz boost for an arbitrary metric and arbitrary 4-velocities see docs/lorentz...">calc_generalized_boost_uu</a>(<span class="keyword">struct</span> <a class="code" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae" title="typedef struct of_geom struct of_compgeom; force to be the same">of_geom</a> *ptrgeom, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *wcon, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *ucon, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*lambda)[NDIM])</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;{</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> wcov[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>],ucov[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="comment">// wcov</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(mu) wcov[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>] = 0.0;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(mu,nu) wcov[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>] += wcon[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>]*(ptrgeom-&gt;gcov[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a28b8da8b36c3a7b2f04da8809cd50b34">GIND</a>(mu,nu)]);</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  <span class="comment">// ucov</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(mu) ucov[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>] = 0.0;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(mu,nu) ucov[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>] += ucon[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>]*(ptrgeom-&gt;gcov[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a28b8da8b36c3a7b2f04da8809cd50b34">GIND</a>(mu,nu)]);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  <span class="comment">// gamma</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> gamma=0.0;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(mu) gamma += -wcon[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>]*ucov[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>];</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  <span class="comment">// lambda^\mu_\nu</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(mu,nu) lambda[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>][<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>]= </div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    + <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#aa5ebb2763dd5546bc40222826cea731f">delta</a>(mu,nu) </div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    + (1.0/(1.0+gamma)) * (wcon[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>]*wcov[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>] + ucon[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>]*ucov[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>] - gamma *(ucon[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>]*wcov[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>] + wcon[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>]*ucov[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>]))</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    + (ucon[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>]*wcov[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>] - wcon[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>]*ucov[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>]);</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;}</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;</div>
<div class="line"><a name="l00594"></a><span class="lineno"><a class="code" href="../../d3/dfc/tetrad_8funcdeclare_8h.html#aecffb2ef6ac562816636daf704607915">  594</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d5/d0a/tetrad_8c.html#aecffb2ef6ac562816636daf704607915" title="calculate boost assuming in orthonormal basis where g_{}={} = diag(-1,0,0,0) NOTEMARK: Orthonormal do...">calc_ortho_boost_uu</a>(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *wcon, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *ucon, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*lambda)[NDIM])</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;{</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> wcov[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>],ucov[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  <span class="comment">// wcov</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(mu) wcov[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>] = wcon[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>];</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  wcov[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a08ca909b46b12e894320afaabce3056e" title="time period between dumps for various types of dumps NO, use &quot;DUMPTYPE&quot; names now">TT</a>]*=-1.0;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <span class="comment">// ucov</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(mu) ucov[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>] = ucon[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>];</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  ucov[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a08ca909b46b12e894320afaabce3056e" title="time period between dumps for various types of dumps NO, use &quot;DUMPTYPE&quot; names now">TT</a>]*=-1.0;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  <span class="comment">// gamma</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> gamma=0.0;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(mu) gamma += -wcon[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>]*ucov[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>];</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  <span class="comment">//  dualfprintf(fail_file,&quot;gamma=%g\n&quot;,gamma);</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  <span class="comment">// lambda</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(mu,nu) lambda[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>][<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>]= </div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    + <a class="code" href="../../d9/d43/global_8variousmacros_8h.html#aa5ebb2763dd5546bc40222826cea731f">delta</a>(mu,nu) </div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    + (1.0/(1.0+gamma)) * (wcon[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>]*wcov[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>] + ucon[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>]*ucov[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>] - gamma *(ucon[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>]*wcov[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>] + wcon[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>]*ucov[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>]))</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    + (ucon[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>]*wcov[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>] - wcon[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>]*ucov[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>]);</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;}</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;</div>
<div class="line"><a name="l00626"></a><span class="lineno"><a class="code" href="../../d3/dfc/tetrad_8funcdeclare_8h.html#a69bb4f4bdcfeeddc2f94c291e3c4a887">  626</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d5/d0a/tetrad_8c.html#a69bb4f4bdcfeeddc2f94c291e3c4a887" title="use lab frame contravariant 4-velocity (uconlab) and get transformation matrix for going to orthonorm...">transboost_lab2fluid</a>(<span class="keywordtype">int</span> lab2orthofluid, <span class="keywordtype">int</span> primcoord, <span class="keyword">struct</span> <a class="code" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae" title="typedef struct of_geom struct of_compgeom; force to be the same">of_geom</a> *ptrgeom, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *uconlab, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*transboostup)[NDIM], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*transboostlo)[NDIM])</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;{</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  <span class="comment">// get tetrcov and tetrcon</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment"></span>  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> tetrconmem[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>],tetrcovmem[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*tetrcon)[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>]=tetrconmem;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*tetrcov)[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>]=tetrcovmem;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  <a class="code" href="../../d5/d0a/tetrad_8c.html#a529e9fcba9169e956453fa28b0ec5b29" title="get stored or compute tetrcov and tetrcon primcoord: whether PRIMCOORDS type, so will use dxdxp to si...">get_tetrcovcon</a>(primcoord, ptrgeom, &amp;tetrcov,&amp;tetrcon); <span class="comment">// pass address of pointer since want to give new pointer address if stored</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  </div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  <span class="comment">//  DLOOP(mu,nu) dualfprintf(fail_file,&quot;mu=%d nu=%d tetrcov=%g tetrcon=%g\n&quot;,mu,nu,tetrcov[mu][nu],tetrcon[mu][nu]);</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  <span class="comment">// get ucovlab</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> ucovlab[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  lower_vec(uconlab,ptrgeom,ucovlab);</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  <span class="comment">// set wconlab to LAB frame, which happens to be ZAMO for the equations HARM solves</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> wcovlab[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> wconlab[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(mu) wconlab[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>] = 0.0;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  <span class="keywordflow">if</span>(lab2orthofluid==<a class="code" href="../../d4/d96/global_8nondepmnemonics_8rad_8h.html#a88a1143fe44212183756a9ca513c160c">LAB2FF</a> || lab2orthofluid==<a class="code" href="../../d4/d96/global_8nondepmnemonics_8rad_8h.html#a0f3447461a389d1bef312bd4a6e84dd9">FF2LAB</a>){</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="preprocessor">#if(0) // STAY AS ZERO</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="preprocessor"></span>    <span class="comment">// ZAMO frame: \eta_\mu = (-\alpha,0,0,0)</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    wcovlab[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a08ca909b46b12e894320afaabce3056e" title="time period between dumps for various types of dumps NO, use &quot;DUMPTYPE&quot; names now">TT</a>]=-ptrgeom-&gt;alphalapse;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#aa97638a87093a4efe2bece0de87093cc" title="loop over all Space dimensions; first rank loop">SLOOPA</a>(mu) wcovlab[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>]=0.0;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <span class="comment">// raise to get wconlab = \eta^\mu</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(mu) wconlab[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>] = 0.0;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(mu,nu) wconlab[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>] += wcovlab[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>]*(ptrgeom-&gt;gcon[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a28b8da8b36c3a7b2f04da8809cd50b34">GIND</a>(mu,nu)]);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="preprocessor"></span>    <span class="comment">// actually construct implied frame of coordinates directly</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> wconff[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>]={1,0,0,0};</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="comment">// i.e. ucon^\nu[lab coordbasis] = ucon^\mu[ff ortho]  TBup_\mu[ff ortho]^\nu[lab coordbasis]</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(mu,nu) wconlab[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>] += wconff[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>]*tetrcon[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>][<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>];</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <span class="comment">// get w_\nu</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(mu) wcovlab[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>] = 0.0;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(mu,nu) wcovlab[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>] += wconlab[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>]*(ptrgeom-&gt;gcov[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a28b8da8b36c3a7b2f04da8809cd50b34">GIND</a>(mu,nu)]);</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="preprocessor"></span>  }</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <span class="comment">//  HARM fake frame: \eta_\mu = (1,0,0,0)</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    wcovlab[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a08ca909b46b12e894320afaabce3056e" title="time period between dumps for various types of dumps NO, use &quot;DUMPTYPE&quot; names now">TT</a>]=1.0;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#aa97638a87093a4efe2bece0de87093cc" title="loop over all Space dimensions; first rank loop">SLOOPA</a>(mu) wcovlab[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>]=0.0;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="comment">// raise to get wconlab = \eta^\mu</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(mu) wconlab[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>] = 0.0;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(mu,nu) wconlab[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>] += wcovlab[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>]*(ptrgeom-&gt;gcon[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a28b8da8b36c3a7b2f04da8809cd50b34">GIND</a>(mu,nu)]);</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  }</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  <span class="comment">//  DLOOPA(mu) dualfprintf(fail_file,&quot;mu=%d ucovlab=%g wcovlab=%g wconlab=%g\n&quot;,mu,ucovlab[mu],wcovlab[mu],wconlab[mu]);</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  </div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  <span class="comment">// get orthonormal boost to fluid frame</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;  <span class="comment">// Convert ucon^i[lab] to orthonormal basis, so then just use simple Lorentz boost from special relativity to operate on the tetrad to have something that converts lastly to the fluid frame.</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> wconlabortho[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>],uconlabortho[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(mu) wconlabortho[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>]=uconlabortho[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>]=0.0;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  <span class="comment">// Tetrcov^mu[lab ortho]_\nu[lab coordbasis] uconlab^\nu[lab coordbasis]</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(mu,nu) wconlabortho[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>] += tetrcov[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>][<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>]*wconlab[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>];</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(mu,nu) uconlabortho[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>] += tetrcov[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>][<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>]*uconlab[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>];</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  <span class="comment">//  DLOOPA(mu) dualfprintf(fail_file,&quot;mu=%d uconlabortho=%g wconlabortho=%g\n&quot;,mu,uconlabortho[mu],wconlabortho[mu]);</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> lambda[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  <a class="code" href="../../d5/d0a/tetrad_8c.html#aecffb2ef6ac562816636daf704607915" title="calculate boost assuming in orthonormal basis where g_{}={} = diag(-1,0,0,0) NOTEMARK: Orthonormal do...">calc_ortho_boost_uu</a>(wconlabortho, uconlabortho, lambda);</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;  <span class="comment">// get inverse lambda</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> ilambda[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  <span class="comment">// comments for matrix_inverse() say takes lambda^j_k and pops out (ilambda)^k_j such that (lambda)^j_k (ilambda)^k_l = \delta^j_l</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  <span class="comment">// So need to apply ilambda correctly assuming does transpose</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  <a class="code" href="../../d6/d1b/metric_8tools_8c.html#af5438dd54272eb585ff5acb06d7195d4">matrix_inverse</a>(<a class="code" href="../../d2/dbf/metric_8h.html#a401668353c0216165cf6f1c7b2d34e94">PRIMECOORDS</a>,lambda,ilambda);</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;  <span class="comment">//  DLOOP(mu,nu) dualfprintf(fail_file,&quot;mu=%d nu=%d lambda=%g ilambda=%g\n&quot;,mu,nu,lambda[mu][nu],ilambda[mu][nu]);</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  <span class="comment">// From earlier in other functions:</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  <span class="comment">// Tetrcon_k^j [first index ortho, second index lab]</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  <span class="comment">// Tetrcov^k_j [first index ortho, second index lab (i.e. not transposed!)]</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  <span class="comment">//    Lambda^\mu[w]_\nu[u] u^\nu = w^\mu  [Corresponding to boost *into* fluid frame]</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  <span class="comment">//    Lambda^\mu[w]_\nu[u] w_\mu = u_\nu  [Corresponding to boost *from* fluid frame]</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  <span class="comment">// (iLambda)^\mu[u]_\nu[w] u_\mu = w_\nu  [Corresponding to boost *into* fluid frame]</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  <span class="comment">// (iLambda)^\mu[u]_\nu[w] w^\nu = u^\mu  [Corresponding to boost *from* fluid frame]</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  <span class="comment">// So if going from w-&gt;u (i.e. FF2LAB) frame for  vecff^\mu  , then apply (iLambda)^\mu_\nu vecff^nu  = veclab^\mu</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  <span class="comment">// So if going from u-&gt;w (i.e. LAB2FF) frame for veclab^\mu  , then apply   Lambda ^\mu_\nu veclab^nu = vecff^\mu</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  <span class="comment">// form transboost</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  <span class="keywordtype">int</span> aa;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  <span class="comment">// apply Lorentz boost on transformation from lab-frame to orthonormal basis</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  <span class="comment">// TBup_\mu[ff ortho]^\nu[lab coordbasis] = ilambda^aa[lab ortho]_\mu[ff ortho] Tetrcon_aa[lab ortho]^\nu[lab coordbasis]</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(mu,nu) transboostup[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>][<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>]=0.0;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(mu,nu) <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(aa) transboostup[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>][<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>] += ilambda[aa][<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>]*tetrcon[aa][<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>]; <span class="comment">// as if operated boost on u_aa</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  <span class="comment">// TBlo^\mu[ff ortho]_\nu[lab coordbasis] =  lambda^\mu[ff ortho]_aa[lab ortho] Tetrcov^aa[lab ortho]_\nu[lab coordbasis]</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(mu,nu) transboostlo[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>][<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>]=0.0;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(mu,nu) <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(aa) transboostlo[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>][<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>] += lambda[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>][aa]*tetrcov[aa][<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>]; <span class="comment">// as if operated boost on u^aa</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;  <span class="comment">// for starting in lab frame coordinate basis, use as follows:</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;  <span class="comment">// i.e. ucon^\mu[ff ortho] =  TBlo^\mu[ff ortho]_\nu[lab coordbasis] ucon^\nu[lab coordbasis]</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  <span class="comment">// i.e. ucov_\mu[ff ortho] =  TBup_\mu[ff ortho]^\nu[lab coordbasis] ucov_\nu[lab coordbasis]</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  <span class="comment">// if starting with fluid frame orthonormal basis, then use same things but indices are contracted reversely.</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  <span class="comment">// i.e. ucon^\nu[lab coordbasis] = ucon^\mu[ff ortho]  TBup_\mu[ff ortho]^\nu[lab coordbasis]</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  <span class="comment">// i.e. ucov_\nu[lab coordbasis] = ucov_\mu[ff ortho]  TBlo^\mu[ff ortho]_\nu[lab coordbasis]</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;  <span class="comment">// that is, as constructed, the TBlo and TBhi have indices always in the same consistent order as far as the meaning of the first and second index with respect to the frame and coordinates.  Unlike those things that use matrix_inverse like idxdxp and ilambda</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;}</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;</div>
<div class="line"><a name="l00764"></a><span class="lineno"><a class="code" href="../../d3/dfc/tetrad_8funcdeclare_8h.html#ae8d70957690f267632e5db4f4b06a490">  764</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d5/d0a/tetrad_8c.html#ae8d70957690f267632e5db4f4b06a490" title="Wrapper for vector_lab2orthofluidorback()">vector_harm2orthofluidorback</a>(<span class="keywordtype">int</span> whichvector, <span class="keywordtype">int</span> harm2orthofluid, <span class="keyword">struct</span> <a class="code" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae" title="typedef struct of_geom struct of_compgeom; force to be the same">of_geom</a> *ptrgeom, <span class="keywordtype">int</span> uconcovtype, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *uconcov, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> v4concovtype, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *vector4in, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *vector4out)</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;{</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d5/d0a/tetrad_8c.html#af9cffa9c2f215c3446c8dced2a326b42" title="convert 4-vector to/from lab-frame coordinate basis to fluid frame orthonormal basis">vector_lab2orthofluidorback</a>(<span class="keywordtype">int</span> primcoord, <span class="keywordtype">int</span> lab2orthofluid, <span class="keyword">struct</span> <a class="code" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae" title="typedef struct of_geom struct of_compgeom; force to be the same">of_geom</a> *ptrgeom, <span class="keywordtype">int</span> uconcovtype, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *uconcov, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> v4concovtype, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *vector4in, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *vector4out);</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;  <span class="keywordtype">int</span> jj;</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> vector4incopy[NPR];</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  </div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;  <span class="comment">// KORALTODO SUPERGODMARK: Need to know what coordinates ptrgeom is.  Currently assume always PRIMECOORDS for either LAB2FF or FF2LAB.</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  </div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  <span class="comment">// preserve vector4in</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(jj) vector4incopy[jj]=vector4in[jj];</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  <span class="comment">// harmlab to ortho fluid</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  <span class="keywordflow">if</span>(harm2orthofluid==<a class="code" href="../../d4/d96/global_8nondepmnemonics_8rad_8h.html#a88a1143fe44212183756a9ca513c160c">LAB2FF</a>){</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    <span class="comment">// correct &quot;t&quot; component</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <span class="keywordflow">if</span>(whichvector==<a class="code" href="../../d4/d96/global_8nondepmnemonics_8rad_8h.html#a94d83bcb35c53a4419b7afddc7998916">TYPEUCOV</a>){ <span class="comment">// u_\mu type</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;      <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(jj) vector4incopy[jj] *= 1.0; <span class="comment">// (ptrgeom-&gt;alphalapse); // gets E_\nu from T^t_\nu or T^{t\nu} from E^\nu</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    }</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(whichvector==<a class="code" href="../../d4/d96/global_8nondepmnemonics_8rad_8h.html#a2bbc1db2b84f7d7738a65be5cdeda4e0">TYPEUCON</a>){ <span class="comment">// u^\nu type</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;      <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(jj) vector4incopy[jj] *= 1.0; <span class="comment">//(ptrgeom-&gt;alphalapse); // gets B^\nu from B^i or B_i from B_\nu</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    }</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    <span class="comment">// transform+boost</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <span class="keywordtype">int</span> primcoord=1; <span class="comment">// assume input is harm&#39;s PRIMECOORDS so can use dxdxp to optimize tetrad computation</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <a class="code" href="../../d5/d0a/tetrad_8c.html#af9cffa9c2f215c3446c8dced2a326b42" title="convert 4-vector to/from lab-frame coordinate basis to fluid frame orthonormal basis">vector_lab2orthofluidorback</a>(primcoord, harm2orthofluid, ptrgeom, uconcovtype, uconcov, v4concovtype, vector4incopy, vector4out);</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="comment">// vector4out is now orthonormalized and boosted into fluid frame</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  }</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  <span class="comment">// ortho fluid to harmlab</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;  <span class="keywordflow">if</span>(harm2orthofluid==<a class="code" href="../../d4/d96/global_8nondepmnemonics_8rad_8h.html#a0f3447461a389d1bef312bd4a6e84dd9">FF2LAB</a>){</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="comment">// transform+boost</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <span class="keywordtype">int</span> primcoord=1; <span class="comment">// assume inputting fluid frame, but want back harm PRIMECOORDS</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    <a class="code" href="../../d5/d0a/tetrad_8c.html#af9cffa9c2f215c3446c8dced2a326b42" title="convert 4-vector to/from lab-frame coordinate basis to fluid frame orthonormal basis">vector_lab2orthofluidorback</a>(primcoord, harm2orthofluid, ptrgeom, uconcovtype, uconcov, v4concovtype, vector4incopy, vector4out);</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <span class="comment">// vector4out is now orthonormalized and boosted into fluid frame</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="comment">// correct &quot;t&quot; component</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    <span class="keywordflow">if</span>(whichvector==<a class="code" href="../../d4/d96/global_8nondepmnemonics_8rad_8h.html#a94d83bcb35c53a4419b7afddc7998916">TYPEUCOV</a>){ <span class="comment">// u_\mu type</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;      <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(jj) vector4out[jj] /= 1.0; <span class="comment">//(ptrgeom-&gt;alphalapse); // gets T^t_\nu from E_\nu or T^{t\nu} from E^\nu</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    }</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(whichvector==<a class="code" href="../../d4/d96/global_8nondepmnemonics_8rad_8h.html#a2bbc1db2b84f7d7738a65be5cdeda4e0">TYPEUCON</a>){ <span class="comment">// u^\nu type</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;      <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(jj) vector4out[jj] /= 1.0; <span class="comment">//(ptrgeom-&gt;alphalapse); // gets B^i from B^\nu or B_i from B_\nu</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    }</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  }</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  </div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  </div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;}</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;</div>
<div class="line"><a name="l00840"></a><span class="lineno"><a class="code" href="../../d3/dfc/tetrad_8funcdeclare_8h.html#af9cffa9c2f215c3446c8dced2a326b42">  840</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d5/d0a/tetrad_8c.html#af9cffa9c2f215c3446c8dced2a326b42" title="convert 4-vector to/from lab-frame coordinate basis to fluid frame orthonormal basis">vector_lab2orthofluidorback</a>(<span class="keywordtype">int</span> primcoord, <span class="keywordtype">int</span> lab2orthofluid, <span class="keyword">struct</span> <a class="code" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae" title="typedef struct of_geom struct of_compgeom; force to be the same">of_geom</a> *ptrgeom, <span class="keywordtype">int</span> uconcovtype, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *uconcov, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> v4concovtype, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *vector4in, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *vector4out)</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;{</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> transboostup[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>],transboostlo[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> ucon[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>]; <span class="comment">// needed for transboost</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;  <span class="keywordflow">if</span>(uconcovtype==<a class="code" href="../../d4/d96/global_8nondepmnemonics_8rad_8h.html#a2bbc1db2b84f7d7738a65be5cdeda4e0">TYPEUCON</a>){ <span class="comment">// then uconcov is contravariant u^\mu of fluid frame</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    <span class="comment">// ucon</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(mu) ucon[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>] = uconcov[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>];</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  }</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(uconcovtype==<a class="code" href="../../d4/d96/global_8nondepmnemonics_8rad_8h.html#a94d83bcb35c53a4419b7afddc7998916">TYPEUCOV</a>){ <span class="comment">// then uconcov is covariant u_\mu of fluid frame</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <span class="comment">// ucon</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(mu) ucon[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>] = 0.0; <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(mu,nu) ucon[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>] += uconcov[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>]*(ptrgeom-&gt;gcon[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a28b8da8b36c3a7b2f04da8809cd50b34">GIND</a>(mu,nu)]);</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  }</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;No such uconcovtype=%d\n&quot;</span>,uconcovtype);</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    myexit(934627520);</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  }</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;  <span class="comment">// get trans boosts (uses ucon always, hence above getting of ucon)</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;  <a class="code" href="../../d5/d0a/tetrad_8c.html#a69bb4f4bdcfeeddc2f94c291e3c4a887" title="use lab frame contravariant 4-velocity (uconlab) and get transformation matrix for going to orthonorm...">transboost_lab2fluid</a>(lab2orthofluid, primcoord, ptrgeom, ucon, transboostup, transboostlo);</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;  <span class="comment">// apply trans boost to 4-vector</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(mu) vector4out[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>]=0.0;</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;  <span class="keywordflow">if</span>(v4concovtype==<a class="code" href="../../d4/d96/global_8nondepmnemonics_8rad_8h.html#a2bbc1db2b84f7d7738a65be5cdeda4e0">TYPEUCON</a>){ <span class="comment">// then vector4in^\mu is contravariant</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <span class="keywordflow">if</span>(lab2orthofluid==<a class="code" href="../../d4/d96/global_8nondepmnemonics_8rad_8h.html#a88a1143fe44212183756a9ca513c160c">LAB2FF</a>){</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;      <span class="comment">// vector4ff^\nu = TBlo^\nu_\mu vector4labcoordbasis^\mu</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;      <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(mu,nu) vector4out[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>] += transboostlo[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>][<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>]*vector4in[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>]; <span class="comment">// application on vector4in^\mu</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    }</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="keywordflow">else</span>{ <span class="comment">// i.e. orthoff 2 lab</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;      <span class="comment">// vector4labcoordbasis^\mu = vector4ff^\nu TBup_\nu^\mu </span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;      <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(mu,nu) vector4out[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>] += vector4in[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>]*transboostup[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>][<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>]; <span class="comment">// application on vector4in^\nu</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    }</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;  }</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(v4concovtype==<a class="code" href="../../d4/d96/global_8nondepmnemonics_8rad_8h.html#a94d83bcb35c53a4419b7afddc7998916">TYPEUCOV</a>){ <span class="comment">// then vector4in_\mu is covariant</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <span class="keywordflow">if</span>(lab2orthofluid==<a class="code" href="../../d4/d96/global_8nondepmnemonics_8rad_8h.html#a88a1143fe44212183756a9ca513c160c">LAB2FF</a>){</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;      <span class="comment">//vector4ff_\nu = TBup_\nu^\mu vector4labcoordbasis_\mu</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;      <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(mu,nu) vector4out[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>] += transboostup[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>][<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>]*vector4in[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>]; <span class="comment">// application on vector4in_\mu</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    }</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    <span class="keywordflow">else</span>{ <span class="comment">// i.e. orthoff 2 lab</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;      <span class="comment">// vector4labcoordbasis_\mu = vector4ff_\nu TBlo^\nu_\mu </span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;      <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(mu,nu) vector4out[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>] += vector4in[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>]*transboostlo[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>][<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>]; <span class="comment">// application on vector4in_\nu</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    }</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  }</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;No such v4concovtype=%d\n&quot;</span>,v4concovtype);</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    myexit(934627520);</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  }</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;}</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;</div>
<div class="line"><a name="l00907"></a><span class="lineno"><a class="code" href="../../d3/dfc/tetrad_8funcdeclare_8h.html#a6999a0ba04240d0dcbe3ae46adba0510">  907</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d5/d0a/tetrad_8c.html#a6999a0ba04240d0dcbe3ae46adba0510" title="convert lab frame 4-tensor to fluid frame orthonormal 4-tensor">tensor_lab2orthofluidorback</a>(<span class="keywordtype">int</span> primcoord, <span class="keywordtype">int</span> lab2orthofluid, <span class="keyword">struct</span> <a class="code" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae" title="typedef struct of_geom struct of_compgeom; force to be the same">of_geom</a> *ptrgeom, <span class="keywordtype">int</span> uconcovtype, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *uconcov, <span class="keywordtype">int</span> tconcovtypeA, <span class="keywordtype">int</span> tconcovtypeB, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*tensor4in)[NDIM], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*tensor4out)[NDIM])</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;{</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>,<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>,aa,bb;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> ucon[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> transboostup[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>],transboostlo[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  <span class="keywordflow">if</span>(uconcovtype==<a class="code" href="../../d4/d96/global_8nondepmnemonics_8rad_8h.html#a2bbc1db2b84f7d7738a65be5cdeda4e0">TYPEUCON</a>){ <span class="comment">// then uconcov is contravariant u^\mu of fluid frame</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    <span class="comment">// ucon</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(mu) ucon[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>] = uconcov[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>];</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;  }</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(uconcovtype==<a class="code" href="../../d4/d96/global_8nondepmnemonics_8rad_8h.html#a94d83bcb35c53a4419b7afddc7998916">TYPEUCOV</a>){ <span class="comment">// then uconcov is covariant u_\mu of fluid frame</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <span class="comment">// ucon</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    raise_vec(uconcov,ptrgeom,ucon);</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  }</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;No such uconcovtype=%d\n&quot;</span>,uconcovtype);</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    myexit(934627525);</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  }</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;  <span class="comment">// get trans boosts (uses ucon always, hence above getting of ucon)</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;  <a class="code" href="../../d5/d0a/tetrad_8c.html#a69bb4f4bdcfeeddc2f94c291e3c4a887" title="use lab frame contravariant 4-velocity (uconlab) and get transformation matrix for going to orthonorm...">transboost_lab2fluid</a>(lab2orthofluid, primcoord, ptrgeom, ucon, transboostup, transboostlo);</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;  <span class="comment">//  DLOOP(mu,nu) dualfprintf(fail_file,&quot;mu=%d nu=%d transboostup=%g transboostlo=%g\n&quot;,mu,nu,transboostup[mu][nu],transboostlo[mu][nu]);</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  <span class="comment">// apply trans boost to 4-tensor</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(mu,nu) tensor4out[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>][<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>]=0.0;</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;  <span class="keywordflow">if</span>(tconcovtypeA==<a class="code" href="../../d4/d96/global_8nondepmnemonics_8rad_8h.html#a2bbc1db2b84f7d7738a65be5cdeda4e0">TYPEUCON</a> &amp;&amp; tconcovtypeB==<a class="code" href="../../d4/d96/global_8nondepmnemonics_8rad_8h.html#a2bbc1db2b84f7d7738a65be5cdeda4e0">TYPEUCON</a>){</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    <span class="keywordflow">if</span>(lab2orthofluid==<a class="code" href="../../d4/d96/global_8nondepmnemonics_8rad_8h.html#a88a1143fe44212183756a9ca513c160c">LAB2FF</a> || lab2orthofluid==<a class="code" href="../../d4/d96/global_8nondepmnemonics_8rad_8h.html#a01ed590b6a0ee9d851a71ddfc727b12a">HARM2FF</a>){</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;      <span class="comment">// tfl^{\nu bb} = TBlo^\nu[ffortho]_\mu[labcoord] TBlo^bb[ffortho]_aa[labcoord] t^{\mu aa}</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;      <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(mu,nu) <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(aa,bb) tensor4out[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>][bb] += transboostlo[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>][<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>]*transboostlo[bb][aa]*tensor4in[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>][aa]; <span class="comment">// application on con con</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    }</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;      <span class="comment">// t^{\mu aa} = tfl^{\nu bb} TBup_\nu^\mu TBup_bb^aa</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;      <span class="comment">//DLOOP(mu,aa){</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;      <span class="comment">// DLOOP(nu,bb){</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;      <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(mu,nu){</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;        <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(aa,bb){</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;          tensor4out[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>][aa] += tensor4in[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>][bb]*transboostup[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>][<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>]*transboostup[bb][aa]; <span class="comment">// application on con con</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;          <span class="comment">//    dualfprintf(fail_file,&quot;mu=%d aa=%d nu=%d bb=%d adding=%g from %g*%g*%g\n&quot;,mu,aa,nu,bb,tensor4in[nu][bb]*transboostup[nu][mu]*transboostup[bb][aa],tensor4in[nu][bb],transboostup[nu][mu],transboostup[bb][aa]);</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;        }</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;      }</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;      <span class="comment">//   dualfprintf(fail_file,&quot;final00=%26.20g final10=%26.20g final01=%26.20g\n&quot;,tensor4out[0][0],tensor4out[0][1],tensor4out[1][0]);</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    }</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  }</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(tconcovtypeA==<a class="code" href="../../d4/d96/global_8nondepmnemonics_8rad_8h.html#a2bbc1db2b84f7d7738a65be5cdeda4e0">TYPEUCON</a> &amp;&amp; tconcovtypeB==<a class="code" href="../../d4/d96/global_8nondepmnemonics_8rad_8h.html#a94d83bcb35c53a4419b7afddc7998916">TYPEUCOV</a>){</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    <span class="keywordflow">if</span>(lab2orthofluid==<a class="code" href="../../d4/d96/global_8nondepmnemonics_8rad_8h.html#a88a1143fe44212183756a9ca513c160c">LAB2FF</a> || lab2orthofluid==<a class="code" href="../../d4/d96/global_8nondepmnemonics_8rad_8h.html#a01ed590b6a0ee9d851a71ddfc727b12a">HARM2FF</a>){</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;      <span class="comment">// tfl^\nu_bb = TBlo^\nu_\mu TBup_bb^aa t^\mu_aa</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;      <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(mu,nu) <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(aa,bb) tensor4out[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>][bb] += transboostlo[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>][<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>]*transboostup[bb][aa]*tensor4in[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>][aa]; <span class="comment">// application on con cov</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    }</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;      <span class="comment">// t^\mu_aa = t^\nu_bb TBup_\nu^\mu TBlo^bb_aa</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;      <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(mu,nu) <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(aa,bb) tensor4out[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>][aa] += tensor4in[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>][bb]*transboostup[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>][<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>]*transboostlo[bb][aa]; <span class="comment">// application on con cov</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    }</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;  }</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(tconcovtypeA==<a class="code" href="../../d4/d96/global_8nondepmnemonics_8rad_8h.html#a94d83bcb35c53a4419b7afddc7998916">TYPEUCOV</a> &amp;&amp; tconcovtypeB==<a class="code" href="../../d4/d96/global_8nondepmnemonics_8rad_8h.html#a2bbc1db2b84f7d7738a65be5cdeda4e0">TYPEUCON</a>){</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <span class="keywordflow">if</span>(lab2orthofluid==<a class="code" href="../../d4/d96/global_8nondepmnemonics_8rad_8h.html#a88a1143fe44212183756a9ca513c160c">LAB2FF</a> || lab2orthofluid==<a class="code" href="../../d4/d96/global_8nondepmnemonics_8rad_8h.html#a01ed590b6a0ee9d851a71ddfc727b12a">HARM2FF</a>){</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;      <span class="comment">// tfl_\nu^bb = TBup_\nu^\mu TBlo^bb_aa t_\mu^aa</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;      <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(mu,nu) <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(aa,bb) tensor4out[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>][bb] += transboostup[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>][<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>]*transboostlo[bb][aa]*tensor4in[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>][aa]; <span class="comment">// application on cov con</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    }</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;      <span class="comment">// t_\mu^aa = t_\nu^bb TBlo^\nu_\mu TBup_bb^aa</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;      <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(mu,nu) <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(aa,bb) tensor4out[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>][aa] += tensor4in[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>][bb]*transboostlo[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>][<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>]*transboostup[bb][aa]; <span class="comment">// application on cov con</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    }</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;  }</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(tconcovtypeA==<a class="code" href="../../d4/d96/global_8nondepmnemonics_8rad_8h.html#a94d83bcb35c53a4419b7afddc7998916">TYPEUCOV</a> &amp;&amp; tconcovtypeB==<a class="code" href="../../d4/d96/global_8nondepmnemonics_8rad_8h.html#a94d83bcb35c53a4419b7afddc7998916">TYPEUCOV</a>){</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    <span class="keywordflow">if</span>(lab2orthofluid==<a class="code" href="../../d4/d96/global_8nondepmnemonics_8rad_8h.html#a88a1143fe44212183756a9ca513c160c">LAB2FF</a> || lab2orthofluid==<a class="code" href="../../d4/d96/global_8nondepmnemonics_8rad_8h.html#a01ed590b6a0ee9d851a71ddfc727b12a">HARM2FF</a>){</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;      <span class="comment">// tfl_{\nu bb} = TBup_\nu^\mu TBup_bb^aa t_{\mu aa}</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;      <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(mu,nu) <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(aa,bb) tensor4out[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>][bb] += transboostup[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>][<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>]*transboostup[bb][aa]*tensor4in[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>][aa]; <span class="comment">// application on cov cov</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    }</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;      <span class="comment">// t_{\mu aa} = t_{\nu bb} TBlo^\nu_\mu TBlo^bb_aa</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;      <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(mu,nu) <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(aa,bb) tensor4out[<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>][aa] += tensor4in[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>][bb]*transboostlo[<a class="code" href="../../d8/d5b/defs_8general_8h.html#a0649c2a1b13c2ac3a9e6bb7cf95286ee" title="Ramesh stuff.">nu</a>][<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a09ff43f0b783688e7ffeff6596ef60a6">mu</a>]*transboostlo[bb][aa]; <span class="comment">// application on cov cov</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    }</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;  }</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;No such tconcovtypeA=%d tconcovtypeB=%d\n&quot;</span>,tconcovtypeA,tconcovtypeB);</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    myexit(934627526);</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;  }</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;}</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;</div>
<div class="line"><a name="l01003"></a><span class="lineno"><a class="code" href="../../d3/dfc/tetrad_8funcdeclare_8h.html#a614dd4a14d7f224cf56500671c1d7757"> 1003</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/d0a/tetrad_8c.html#a247a69dd41367582001175d392ebbd68" title="Use as, e.g.">vecX2vecVortho</a>(<span class="keywordtype">int</span> concovtype, <span class="keyword">struct</span> <a class="code" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae" title="typedef struct of_geom struct of_compgeom; force to be the same">of_geom</a> *ptrgeom, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *veclab, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *vecortho)</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;{</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;  <span class="keywordtype">int</span> primcoord=1; <span class="comment">// input is X and going to V means used dxdxp when making metric, so can use dxdxp to simplify metric before getting tetrad</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;  <span class="comment">// get tetrcov and tetrcon</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="comment"></span>  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> tetrconmem[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>],tetrcovmem[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>][<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*tetrcon)[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>]=tetrconmem;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> (*tetrcov)[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>]=tetrcovmem;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;  <a class="code" href="../../d5/d0a/tetrad_8c.html#a529e9fcba9169e956453fa28b0ec5b29" title="get stored or compute tetrcov and tetrcon primcoord: whether PRIMCOORDS type, so will use dxdxp to si...">get_tetrcovcon</a>(primcoord, ptrgeom, &amp;tetrcov,&amp;tetrcon); <span class="comment">// pass address of pointer since want to give new pointer address if stored</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  <span class="comment">// Now setup transformation</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> tempcomp[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> finalvec[<a class="code" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>];</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;  <span class="comment">// vector here is in original X coordinates</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;  <span class="keywordtype">int</span> jj;</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(jj) finalvec[jj]=veclab[jj];</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(jj) tempcomp[jj]=0.0;</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  <span class="keywordtype">int</span> kk;</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;  <span class="comment">// NOTEMARK: here (unlike in jon_interp_computepreprocess.c) tetrcon and tetrcov convert directly from X coords to V-based orthonormal basis</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  <span class="keywordflow">if</span>(concovtype==<a class="code" href="../../d4/d96/global_8nondepmnemonics_8rad_8h.html#a2bbc1db2b84f7d7738a65be5cdeda4e0">TYPEUCON</a>){</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    <span class="comment">// transform to orthonormal basis for contravariant vector in X coordinates</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    <span class="comment">// u^kk[ortho] = tetrcov^kk[ortho]_jj[lab] u^jj[lab]</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(jj,kk) tempcomp[kk] += tetrcov[kk][jj]*finalvec[jj];</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;  }</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(concovtype==<a class="code" href="../../d4/d96/global_8nondepmnemonics_8rad_8h.html#a94d83bcb35c53a4419b7afddc7998916">TYPEUCOV</a>){</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    <span class="comment">// transform to orthonormal basis for covariant vector in X coordinates</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    <span class="comment">// u_kk[ortho] = tetrcon_kk[ortho]^jj[lab] u_jj[lab]</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a59b7ef1517ff22fd4dfce4cf6d380c55" title="loop over all Dimensions; second rank loop">DLOOP</a>(jj,kk) tempcomp[kk] += tetrcon[kk][jj]*finalvec[jj];</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;  }</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;No such concovtype=%d\n&quot;</span>,concovtype);</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    myexit(1);</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;  }</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(jj) finalvec[jj]=tempcomp[jj];</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;  <span class="comment">// Could now apply lambda that transforms from (e.g.) SPC to Cart using normal orthonormal type transformation for both coordinates to get that transformation</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;  <span class="comment">// final answer:</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;  <a class="code" href="../../d5/dd8/global_8loops_8perpoint_8h.html#a5f53c1711297fb7345342298fa31396f" title="loop over all Dimensions; first rank loop">DLOOPA</a>(jj) vecortho[jj]=finalvec[jj];</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;}</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;</div>
<div class="line"><a name="l01059"></a><span class="lineno"><a class="code" href="../../d5/d0a/tetrad_8c.html#ad28d4f9a890cdb922ac0852380d73d70"> 1059</a></span>&#160;<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d5/d0a/tetrad_8c.html#ad28d4f9a890cdb922ac0852380d73d70" title="http://stackoverflow.com/questions/12449079/roots-of-cubic-using-c-and-gsl http://en.wikipedia.org/wiki/Cubic_function (but not good if need to use all real numbers) a x^3 + b c^2 + c x + d = 0">Root</a>(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa73cf2d397cae726436e08d2c891bdb0">a</a>, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> b, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> c, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> d, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *roots, <span class="keywordtype">int</span> *numroots)</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;{</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> x0=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a38eb76aa0a9a1bb1dac30c75be4a05b6">BIG</a>,x1=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a38eb76aa0a9a1bb1dac30c75be4a05b6">BIG</a>,x2=<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a38eb76aa0a9a1bb1dac30c75be4a05b6">BIG</a>;</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;<span class="preprocessor">#if(USINGGSL)</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="preprocessor"></span>  <span class="keywordtype">int</span> failreturn = gsl_poly_solve_cubic(b/a,c/a,d/a,&amp;x0,&amp;x1,&amp;x2);</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="preprocessor"></span>  dualfprintf(<a class="code" href="../../d8/d5b/defs_8general_8h.html#ad3709a52076ae713f92f3c3fe3ec9255">fail_file</a>,<span class="stringliteral">&quot;Shouldn&#39;t be here with no GSL\n&quot;</span>);</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;  myexit(562525);</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">if</span>(x1==<a class="code" href="../../d1/de6/global_8depmnemonics_8h.html#a38eb76aa0a9a1bb1dac30c75be4a05b6">BIG</a>){ <span class="comment">// then only 1 root</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    *numroots=1;</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;  }</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;  <span class="keywordflow">else</span>{ <span class="comment">// then 3 roots</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    *numroots=3;</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;  }</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;  roots[0]=x0;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;  roots[1]=x1;</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;  roots[2]=x2;</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;  </div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;  <span class="keywordflow">return</span>(roots[0]); <span class="comment">// assume first root always chosen</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;}</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;</div>
<div class="line"><a name="l01084"></a><span class="lineno"><a class="code" href="../../d5/d0a/tetrad_8c.html#af592c246a75f6239aca4826a6b5919b9"> 1084</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d5/d0a/tetrad_8c.html#af592c246a75f6239aca4826a6b5919b9" title="http://en.wikipedia.org/wiki/Cubic_function (but not good if need to use all real numbers) a x^3 + b ...">cubicroots</a>(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa73cf2d397cae726436e08d2c891bdb0">a</a>, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> b, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> c, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> d, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *roots)</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;{</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> Delta = 18.0*a*b*c*d - 4.0*b*b*b*d + b*b*c*c - 4.0*a*c*c*c - 27.0*a*a*d*d;</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;  <span class="comment">//The following cases need to be considered: [17]</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;  <span class="comment">// If  &gt; 0, then the equation has three distinct real roots.</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;  <span class="comment">// If  = 0, then the equation has a multiple root and all its roots are real.</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;  <span class="comment">// If  &lt; 0, then the equation has one real root and two nonreal complex conjugate roots.</span></div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;  </div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> u1=1.0;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> u2=0.0;<span class="comment">// complex</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> u3=0.0;<span class="comment">// complex</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> Delta0 = b*b - 3.0*a*c;</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> Delta1 = 2.0*b*b*b - 9.0*a*b*c + 27.0*a*a*d;</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> Delta2sq = -27.0*a*a*Delta + 4.0*Delta0*Delta0*Delta0;</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> Delta2=sqrt(Delta2sq);</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;  </div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d8/d5b/defs_8general_8h.html#a0050aa7bf7fc92a690eec015acb18800">C</a> = pow( (Delta1 + sqrt(Delta1*Delta1 - 4.0*Delta0*Delta0*Delta0))*0.5 ,1.0/3.0);</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> r1 = -1.0/(3.0*<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa73cf2d397cae726436e08d2c891bdb0">a</a>) * (b + u1*C + Delta0/(u1*C));</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> r2 = -1.0/(3.0*<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa73cf2d397cae726436e08d2c891bdb0">a</a>) * (b + u2*C + Delta0/(u2*C));</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> r3 = -1.0/(3.0*<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa73cf2d397cae726436e08d2c891bdb0">a</a>) * (b + u3*C + Delta0/(u3*C));</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;}</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;</div>
<div class="line"><a name="l01112"></a><span class="lineno"><a class="code" href="../../d5/d0a/tetrad_8c.html#ac2fea2632684125a16a6acd1212a078c"> 1112</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d5/d0a/tetrad_8c.html#ac2fea2632684125a16a6acd1212a078c" title="compute the semi-general eigensystem for a pretty general metric.">genes</a>(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *gcov[4], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *evec[4], <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *eval)</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;{</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d5/d0a/tetrad_8c.html#ad28d4f9a890cdb922ac0852380d73d70" title="http://stackoverflow.com/questions/12449079/roots-of-cubic-using-c-and-gsl http://en.wikipedia.org/wiki/Cubic_function (but not good if need to use all real numbers) a x^3 + b c^2 + c x + d = 0">Root</a>(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa73cf2d397cae726436e08d2c891bdb0">a</a>, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> b, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> c, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> d, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *roots, <span class="keywordtype">int</span> *numroots);</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160; </div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;  <span class="comment">//#include &quot;genes.txt&quot;</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;}</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;</div>
<div class="line"><a name="l01122"></a><span class="lineno"><a class="code" href="../../d5/d0a/tetrad_8c.html#ae8de9430525d359b1e5946f0a3d52d51"> 1122</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d5/d0a/tetrad_8c.html#ae8de9430525d359b1e5946f0a3d52d51" title="compute the general orthonormal version of 4 vectors (that should be from eigensystem)">genortho</a>(<a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *vec1, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *vec2, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *vec3, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *vec4, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *ovec1, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *ovec2, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *ovec3, <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> *ovec4)</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;{</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> vec1a=vec1[0];</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> vec1b=vec1[1];</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> vec1c=vec1[2];</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> vec1d=vec1[3];</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> vec2a=vec2[0];</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> vec2b=vec2[1];</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> vec2c=vec2[2];</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> vec2d=vec2[3];</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> vec3a=vec3[0];</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> vec3b=vec3[1];</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> vec3c=vec3[2];</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> vec3d=vec3[3];</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> vec4a=vec4[0];</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> vec4b=vec4[1];</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> vec4c=vec4[2];</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;  <a class="code" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0" title="need not change below datatype stuff">FTYPE</a> vec4d=vec4[3];</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;  <span class="comment">//  #include &quot;genortho.c&quot;</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri May 20 2016 15:52:35 for HARM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.3.1
</small></address>
</body>
</html>
