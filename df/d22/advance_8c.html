<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>HARM: advance.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">HARM
   </div>
   <div id="projectbrief">harm and utilities</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">advance.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Takes RK sub-step.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;decs.h&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for advance.c:</div>
<div class="dyncontent">
<div class="center"><img src="../../d8/d2c/advance_8c__incl.png" border="0" usemap="#advance_8c" alt=""/></div>
<map name="advance_8c" id="advance_8c">
</map>
</div>
</div>
<p><a href="../../df/d22/advance_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a58e70abbec4cf7ac016d4ce9c51d7e1a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d22/advance_8c.html#a58e70abbec4cf7ac016d4ce9c51d7e1a">COMPARE_GAMMA</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:a58e70abbec4cf7ac016d4ce9c51d7e1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee532ee6b3b6f97488c944cd5aebc695"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d22/advance_8c.html#aee532ee6b3b6f97488c944cd5aebc695">GRAVITYCOUR</a>&#160;&#160;&#160;(0.1)</td></tr>
<tr class="separator:aee532ee6b3b6f97488c944cd5aebc695"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a080ef26ac144e3416a4c5a0ccc1f1e9b"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d22/advance_8c.html#a080ef26ac144e3416a4c5a0ccc1f1e9b">fractional_diff</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> <a class="el" href="../../d8/d5b/defs_8general_8h.html#aa73cf2d397cae726436e08d2c891bdb0">a</a>, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> b)</td></tr>
<tr class="memdesc:a080ef26ac144e3416a4c5a0ccc1f1e9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the fractional difference between a &amp; b.  <a href="#a080ef26ac144e3416a4c5a0ccc1f1e9b">More...</a><br/></td></tr>
<tr class="separator:a080ef26ac144e3416a4c5a0ccc1f1e9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a217bbc071881142282a66a317664912b"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b">advance_standard</a> (int truestep, int stage, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*pi)[<a class="el" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*pb)[<a class="el" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*pf)[<a class="el" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*pstag)[<a class="el" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*pl_ct)[<a class="el" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823">NSTORE1</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR2INTERP], <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*pr_ct)[<a class="el" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823">NSTORE1</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR2INTERP], <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*F1)[<a class="el" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="el" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>], <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*F2)[<a class="el" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="el" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>], <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*F3)[<a class="el" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="el" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>], <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*vpot)[<a class="el" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823">NSTORE1</a>+<a class="el" href="../../df/d1c/global_8storage_8h.html#a1c452bce7a227fd9f2c8f937a3c7841c">SHIFTSTORE1</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>+<a class="el" href="../../df/d1c/global_8storage_8h.html#adfe8c351b7f60e189dbd9bfca47af5c5">SHIFTSTORE2</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>+<a class="el" href="../../df/d1c/global_8storage_8h.html#a6dc540b0373d80d3ea2db53d03a9fa72">SHIFTSTORE3</a>], <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*ui)[<a class="el" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*uf)[<a class="el" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*ucum)[<a class="el" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *CUf, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *CUnew, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> fluxdt, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> boundtime, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> fluxtime, int timeorder, int numtimeorders, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *ndt)</td></tr>
<tr class="memdesc:a217bbc071881142282a66a317664912b"><td class="mdescLeft">&#160;</td><td class="mdescRight">this method guarantees conservation of non-sourced conserved quantities when metric is time-dependent this method has updated field staggered method Note that when dt==0.0, assume no fluxing, just take ucum -&gt; ui -&gt; {uf,ucum} and invert.  <a href="#a217bbc071881142282a66a317664912b">More...</a><br/></td></tr>
<tr class="separator:a217bbc071881142282a66a317664912b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38c6fa95ece38a2821c70a1524ec47ec"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec">advance_standard_orig</a> (int truestep, int stage, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*pi)[<a class="el" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*pb)[<a class="el" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*pf)[<a class="el" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*pstag)[<a class="el" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*pl_ct)[<a class="el" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823">NSTORE1</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR2INTERP], <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*pr_ct)[<a class="el" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823">NSTORE1</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR2INTERP], <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*F1)[<a class="el" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="el" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>], <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*F2)[<a class="el" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="el" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>], <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*F3)[<a class="el" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="el" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>], <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*vpot)[<a class="el" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823">NSTORE1</a>+<a class="el" href="../../df/d1c/global_8storage_8h.html#a1c452bce7a227fd9f2c8f937a3c7841c">SHIFTSTORE1</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>+<a class="el" href="../../df/d1c/global_8storage_8h.html#adfe8c351b7f60e189dbd9bfca47af5c5">SHIFTSTORE2</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>+<a class="el" href="../../df/d1c/global_8storage_8h.html#a6dc540b0373d80d3ea2db53d03a9fa72">SHIFTSTORE3</a>], <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*ui)[<a class="el" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*uf)[<a class="el" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*ucum)[<a class="el" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *CUf, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *CUnew, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> fluxdt, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> boundtime, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> fluxtime, int timeorder, int numtimeorders, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *ndt)</td></tr>
<tr class="memdesc:a38c6fa95ece38a2821c70a1524ec47ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">this method guarantees conservation of non-sourced conserved quantities when metric is time-dependent this method has updated field staggered method Note that when dt==0.0, assume no fluxing, just take ucum -&gt; ui -&gt; {uf,ucum} and invert.  <a href="#a38c6fa95ece38a2821c70a1524ec47ec">More...</a><br/></td></tr>
<tr class="separator:a38c6fa95ece38a2821c70a1524ec47ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22dff5dc24ff389254919e70b79be489"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489">advance</a> (int truestep, int stage, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*pi)[<a class="el" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*pb)[<a class="el" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*pf)[<a class="el" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*pstag)[<a class="el" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*pl_ct)[<a class="el" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823">NSTORE1</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR2INTERP], <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*pr_ct)[<a class="el" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823">NSTORE1</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR2INTERP], <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*F1)[<a class="el" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="el" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>], <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*F2)[<a class="el" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="el" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>], <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*F3)[<a class="el" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR+<a class="el" href="../../d1/de6/global_8depmnemonics_8h.html#ac14b9db972c66ce6df62cb4d4faa6ded">NSPECIAL</a>], <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*vpot)[<a class="el" href="../../df/d1c/global_8storage_8h.html#a917a6677d5e3b38aa54aa577978bf823">NSTORE1</a>+<a class="el" href="../../df/d1c/global_8storage_8h.html#a1c452bce7a227fd9f2c8f937a3c7841c">SHIFTSTORE1</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>+<a class="el" href="../../df/d1c/global_8storage_8h.html#adfe8c351b7f60e189dbd9bfca47af5c5">SHIFTSTORE2</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>+<a class="el" href="../../df/d1c/global_8storage_8h.html#a6dc540b0373d80d3ea2db53d03a9fa72">SHIFTSTORE3</a>], <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*ui)[<a class="el" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*uf)[<a class="el" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*ucum)[<a class="el" href="../../df/d1c/global_8storage_8h.html#ad1398d310d3072da1a781925d63e61b2">NSTORE2</a>][<a class="el" href="../../df/d1c/global_8storage_8h.html#a6763b3a393c2900fc4a186bfbe6f3bb5">NSTORE3</a>][NPR], <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *CUf, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *CUnew, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> fluxdt, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> boundtime, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a> fluxtime, int timeorder, int numtimeorders, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *ndt)</td></tr>
<tr class="memdesc:a22dff5dc24ff389254919e70b79be489"><td class="mdescLeft">&#160;</td><td class="mdescRight">pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using flux(pb) from pi's Ui -&gt; Uf pi, pb, and pf can all be the same since 1) pb used first on a stencil, not modified, to compute fluxes 2) pf=pi is assigned by value at each zone 3) pf is modified using Utoprim at each zone using pb for sources (to correspond to fluxes which used pb)  <a href="#a22dff5dc24ff389254919e70b79be489">More...</a><br/></td></tr>
<tr class="separator:a22dff5dc24ff389254919e70b79be489"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0936d88b132d9655aa9287035a4793c5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d22/advance_8c.html#a0936d88b132d9655aa9287035a4793c5">limit_prim_correction</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> fractional_difference_threshold, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *geom, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *pin, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *pout)</td></tr>
<tr class="memdesc:a0936d88b132d9655aa9287035a4793c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">If density or gamma-factors are different by more than fractional_difference_threshold for states pin &amp; pout, if different &ndash; correct pout such that it is not more than fractional_difference_threshold away from pin.  <a href="#a0936d88b132d9655aa9287035a4793c5">More...</a><br/></td></tr>
<tr class="separator:a0936d88b132d9655aa9287035a4793c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Takes RK sub-step. </p>
<p>Takes RK substep by doing 1) flux and source 2) flux+source-&gt;dU 3) dU-&gt;U 4) U-&gt;P </p>

<p>Definition in file <a class="el" href="../../df/d22/advance_8c_source.html">advance.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a58e70abbec4cf7ac016d4ce9c51d7e1a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define COMPARE_GAMMA&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../df/d22/advance_8c_source.html#l03018">3018</a> of file <a class="el" href="../../df/d22/advance_8c_source.html">advance.c</a>.</p>

</div>
</div>
<a class="anchor" id="aee532ee6b3b6f97488c944cd5aebc695"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GRAVITYCOUR&#160;&#160;&#160;(0.1)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../df/d22/advance_8c_source.html#l03684">3684</a> of file <a class="el" href="../../df/d22/advance_8c_source.html">advance.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a22dff5dc24ff389254919e70b79be489"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int advance </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>truestep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>stage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>pi</em>[NSTORE2][NSTORE3][NPR], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>pb</em>[NSTORE2][NSTORE3][NPR], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>pf</em>[NSTORE2][NSTORE3][NPR], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>pstag</em>[NSTORE2][NSTORE3][NPR], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>pl_ct</em>[NSTORE1][NSTORE2][NSTORE3][NPR2INTERP], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>pr_ct</em>[NSTORE1][NSTORE2][NSTORE3][NPR2INTERP], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>F1</em>[NSTORE2][NSTORE3][NPR+NSPECIAL], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>F2</em>[NSTORE2][NSTORE3][NPR+NSPECIAL], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>F3</em>[NSTORE2][NSTORE3][NPR+NSPECIAL], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>vpot</em>[NSTORE1+SHIFTSTORE1][NSTORE2+SHIFTSTORE2][NSTORE3+SHIFTSTORE3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>ui</em>[NSTORE2][NSTORE3][NPR], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>uf</em>[NSTORE2][NSTORE3][NPR], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>ucum</em>[NSTORE2][NSTORE3][NPR], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>CUf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>CUnew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a>&#160;</td>
          <td class="paramname"><em>fluxdt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a>&#160;</td>
          <td class="paramname"><em>boundtime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a>&#160;</td>
          <td class="paramname"><em>fluxtime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>timeorder</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numtimeorders</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>ndt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using flux(pb) from pi's Ui -&gt; Uf pi, pb, and pf can all be the same since 1) pb used first on a stencil, not modified, to compute fluxes 2) pf=pi is assigned by value at each zone 3) pf is modified using Utoprim at each zone using pb for sources (to correspond to fluxes which used pb) </p>
<p>So in the end only pf is modified at each zone, so the loop changing p at previous (i,j) location doesn't affect the any new location in (i,j) </p>

<p>Definition at line <a class="el" href="../../df/d22/advance_8c_source.html#l00102">102</a> of file <a class="el" href="../../df/d22/advance_8c_source.html">advance.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d22/advance_8c_a22dff5dc24ff389254919e70b79be489_cgraph.png" border="0" usemap="#df/d22/advance_8c_a22dff5dc24ff389254919e70b79be489_cgraph" alt=""/></div>
<map name="df/d22/advance_8c_a22dff5dc24ff389254919e70b79be489_cgraph" id="df/d22/advance_8c_a22dff5dc24ff389254919e70b79be489_cgraph">
<area shape="rect" id="node3" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="125,1052,253,1081"/><area shape="rect" id="node5" href="../../dc/dae/flux_8c.html#ab229b0f3f2caf3c0a3ef5299fba2b1c0" title="see fluxcompute.c for non&#45;computer science, real physics calculations of flux" alt="" coords="333,820,400,849"/><area shape="rect" id="node67" href="../../d3/ddc/phys_8funcdeclare_8h.html#a11e17cd8b0594d1ad52e3594aa9f477e" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="2528,684,2603,713"/><area shape="rect" id="node194" href="../../d0/dde/fluxctstag_8c.html#a3c59ef3a54b18bbaf4970c13995dadfc" title="wrapper for taking staggered conserved field quantity and obtaining centered field quantity upoint en..." alt="" coords="831,1052,1007,1081"/><area shape="rect" id="node216" href="../../d3/ddc/phys_8funcdeclare_8h.html#a9a54096e4c40a15a2c1bf74266153616" title="calculate &quot;conserved&quot; quantities" alt="" coords="2284,1768,2351,1797"/><area shape="rect" id="node219" href="../../de/d8c/phys_8c.html#a126e2e13b7ac0d2c79b17ecf87129b77" title="wrapper for choosing to get state by computing it or from global array pointer assign (overrides the ..." alt="" coords="301,442,432,472"/><area shape="rect" id="node226" href="../../d3/ddc/phys_8funcdeclare_8h.html#a4ebf7765a6bde079a76719b89d3033b6" title="add in source terms to equations of motion ui and dUriemann in UEVOLVE form assume q(pr) so consisten..." alt="" coords="684,1564,745,1593"/><area shape="rect" id="node332" href="../../d1/d3e/utoprimgen_8c.html#a7e078cc9a354495bc85554d875a705d9" title="General explicit inversion of U[MHD]&#45;&gt;P[MHD] and also inverts scalars. Inverts radiation if(EOMRADTYP..." alt="" coords="2060,1125,2148,1154"/><area shape="rect" id="node7" href="../../dc/dae/flux_8c.html#a8ffa7399bd5354fdcdec5f3e1adf0b13" title="wrapper for CENT_to_FACE1,2,3 used to compute flux at face" alt="" coords="497,793,591,822"/><area shape="rect" id="node178" href="../../dc/dae/flux_8c.html#ae680339abb42df844400546501125e2c" title="fluxEM2flux4EMF" alt="" coords="481,740,607,769"/><area shape="rect" id="node180" href="../../d5/d2f/flux_8funcdeclare_8h.html#a77a38ff10f7d1d0a073866bd154c52b6" title="wrapper for: 1) interpolate FACE 2 CORN 2) loop over dimensions setting field flux dimension&#45;by&#45;dimen..." alt="" coords="853,845,984,874"/><area shape="rect" id="node9" href="../../dc/dae/flux_8c.html#aaf6d832880760f80459d91477c28b519" title="wrapper for different standard 1&#45;D flux calculators 1&#45;D interpolate and get flux for that direction (..." alt="" coords="657,560,772,589"/><area shape="rect" id="node11" href="../../dc/dae/flux_8c.html#a054658527dfb1d80226b8b2d2106aeed" title="original flux calculator that gets F in &quot;dir&quot;. At end global pleft,pright,dq also set and if STOREWAV..." alt="" coords="857,506,980,536"/><area shape="rect" id="node162" href="../../dc/dae/flux_8c.html#a2602a4dad9ed7adc944227d02435312e" title="standard (non&#45;field flux) calculation but setup to store results of interpolation so can be used for ..." alt="" coords="821,560,1016,589"/><area shape="rect" id="node13" href="../../dc/dae/flux_8c.html#a2a4bea22d4d0b16aaba0d19357413e31" title="slope_lim() is provided p2interp and returns pleft/pright" alt="" coords="1348,506,1425,536"/><area shape="rect" id="node47" href="../../de/db6/wavespeeds_8c.html#ade70ed882f42b4e9e2a70916a33ab532" title="complete storage of wave speeds per dimension only called for STOREWAVESPEEDS==1" alt="" coords="1065,558,1249,588"/><area shape="rect" id="node94" href="../../dc/d5e/fluxcompute_8c.html#aa195df0bf8c8fb0a14d8e27a1d3b89ff" title="actually compute the flux and ctop for dt calculation" alt="" coords="1083,376,1232,405"/><area shape="rect" id="node15" href="../../d5/d2f/flux_8funcdeclare_8h.html#a8dd1a8200cac33bfd5c4520a76285d69" title="slope_lim_linetype_c2e" alt="" coords="1548,664,1705,693"/><area shape="rect" id="node17" href="../../d5/d2f/flux_8funcdeclare_8h.html#a0d50fd876f4e61d909a1e006bac28387" title="whether primreal is p2interp can&#39;t assume this is true in general (e.g." alt="" coords="1559,717,1695,746"/><area shape="rect" id="node19" href="../../d8/ddd/interppoint_8c.html#ab50c96d0a8603ec34f1c7a023a4156ff" title="interpolate from a center point to a left/right interface" alt="" coords="1809,737,1948,766"/><area shape="rect" id="node33" href="../../d8/ddd/interppoint_8c.html#a7d9885f70f6b7a32637920ddf74b0f98" title="DEVELOPING RIGHT NOW interpolate from a center point to a left/right interface." alt="" coords="1809,634,1948,680"/><area shape="rect" id="node37" href="../../d8/ddd/interppoint_8c.html#af1ea622d3759b98722d11ed0a3d555e7" title="interpolate from a center point to a left/right interface" alt="" coords="1808,806,1949,836"/><area shape="rect" id="node21" href="../../df/d30/interppoint_8para_8c.html#a6f45f925dd7972198f6ef41de42374df" title="lout/rout is left and right sides of cell note how used in step_ch.c to get appropriate interface val..." alt="" coords="2081,864,2127,893"/><area shape="rect" id="node23" href="../../df/d30/interppoint_8para_8c.html#abe1b655c3bd8c6e3ac699e6cedb03c18" title="doesn&#39;t use dq" alt="" coords="2077,704,2131,733"/><area shape="rect" id="node25" href="../../d8/ddd/interppoint_8c.html#a70f54bffe6df5f410a43980f4aa83971" title="limited slopes using 3 points Gives slope that will be assumed to be located at same location as yc –..." alt="" coords="2041,757,2167,786"/><area shape="rect" id="node27" href="../../d8/ddd/interppoint_8c.html#a9a8e95c4501b23d1a80162c3b2cee142" title="http://mesa.sourceforge.net/pdfs/suresh+huynh_97.pdf http://iopscience.iop.org/0264&#45;9381/31/1/015005/..." alt="" coords="2081,650,2127,680"/><area shape="rect" id="node31" href="../../d8/ddd/interppoint_8c.html#a75bf89b2527949948883f2089374dcf9" title="Enhanced PPM The Einstein Toolkit source code says that the relevant references are: Colella &amp; Sekora..." alt="" coords="2077,810,2131,840"/><area shape="rect" id="node29" href="../../d8/ddd/interppoint_8c.html#a5677d72681462036d6c8a6e13c1c20d9" title="if yll,yl,yc,yr,yrr are really in that order, then get lout." alt="" coords="2281,632,2353,661"/><area shape="rect" id="node35" href="../../d8/ddd/interppoint_8c.html#a367af7d2f93ccc62459fbdbacd4f62f3" title="limited 2nd derivatives using 4 points see e2c_continuous.nb" alt="" coords="2027,580,2181,627"/><area shape="rect" id="node39" href="../../df/d30/interppoint_8para_8c.html#af36824cae5f3156fa6da09c3536c7785" title="used when lim=PARAFLAT" alt="" coords="2076,917,2132,946"/><area shape="rect" id="node41" href="../../df/d30/interppoint_8para_8c.html#ac3af1cc044a6058812c512179cbb090a" title="Get pressure Note this is quite inefficient since operating per&#45;point get same pressure for entire li..." alt="" coords="2272,736,2363,765"/><area shape="rect" id="node43" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a5943065ab3d5b4e9f4f691db499b588f" title="calculates total opacity over dx[]" alt="" coords="2523,1132,2608,1161"/><area shape="rect" id="node45" href="../../d2/d72/phys_8tools_8rad_8c.html#a795959353203e99366b456b16d0d0bab" title="calculates total opacity over dx[] for given chi or chieff" alt="" coords="2763,1132,2888,1161"/><area shape="rect" id="node49" href="../../de/db6/wavespeeds_8c.html#a99d8d29de65565134c1d91007b0d12c6" title="store wavespeeds somewhere" alt="" coords="1307,453,1467,482"/><area shape="rect" id="node92" href="../../de/db6/wavespeeds_8c.html#a9adb8a9ad30e24a08285f6a4c28856ef" title="GODMARK: something wrong with comparing multiple velocities since grid/metric changes in space (i..." alt="" coords="1340,560,1433,589"/><area shape="rect" id="node51" href="../../de/d8c/phys_8c.html#af560087e095f9677ac65b1bc6b424fa9" title="wrapper for choosing to get state by computing it or from global array pointer assign (overrides the ..." alt="" coords="1780,529,1977,558"/><area shape="rect" id="node61" href="../../de/db6/wavespeeds_8c.html#add5696e20b7235a8f870dd0dffb8dc7d" title="vchar_each" alt="" coords="1583,298,1671,328"/><area shape="rect" id="node53" href="../../d7/def/phys_8tools_8c.html#a3ef47960a272ef981fd551582b610503" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="2455,630,2676,660"/><area shape="rect" id="node55" href="../../d3/ddc/phys_8funcdeclare_8h.html#a12a473e24b431762af4168179e82cd08" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="2744,630,2907,660"/><area shape="rect" id="node57" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a8a762bf6582e6f7e1199de9c43b98454" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="2727,577,2924,606"/><area shape="rect" id="node59" href="../../d3/ddc/phys_8funcdeclare_8h.html#a41b8eacac0a4a23d6b00b670fe49629c" title="bsq_calc_fromq" alt="" coords="2768,684,2883,713"/><area shape="rect" id="node63" href="../../d8/d20/vchar_8c.html#acdcca98ca82b041999cdb29fdf958a22" title="Charles believed that near polar axis one should set vmax=vmin=0, but not right since makes flux comp..." alt="" coords="1852,217,1905,246"/><area shape="rect" id="node72" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a2f3df15638b9795556ef2bdf1e8c8f97" title="compute radiative characteristics as limited by opacity" alt="" coords="1840,281,1917,310"/><area shape="rect" id="node65" href="../../d8/d20/vchar_8c.html#acad033b60e7ca6404ffcd9b0fdfd13b4" title="simplefast" alt="" coords="2276,217,2359,246"/><area shape="rect" id="node74" href="../../d2/d72/phys_8tools_8rad_8c.html#a63256be4e6a63216cb736012e36a6375" title="calc_chi" alt="" coords="2069,269,2139,298"/><area shape="rect" id="node77" href="../../d2/d72/phys_8tools_8rad_8c.html#abd01208ba3c5754ea5587bcaefcaa01b" title="get lab&#45;frame 3&#45;velocity for radiative emission in radiative frame" alt="" coords="2051,165,2157,194"/><area shape="rect" id="node80" href="../../d9/de9/coord_8c.html#a0672d8c0ee4ff07c7265d0ecbc365cdc" title="normally&#45;used dxdxp[i,j,k] = dV/dX" alt="" coords="2779,290,2872,320"/><area shape="rect" id="node82" href="../../d9/de9/coord_8c.html#a64a4372100fc55abf546f02c8b779595" title="Jacobian for dx uniform per dx nonuniform (dx/dr / dx/dr&#39;) i.e." alt="" coords="3035,645,3109,674"/><area shape="rect" id="node84" href="../../d9/de9/coord_8c.html#a56c4b5c03b74a33a7d809daecfa6925e" title="numerical derivative of V w.r.t. X" alt="" coords="3259,1361,3379,1390"/><area shape="rect" id="node86" href="../../d9/de9/coord_8c.html#a65ad4ca9656d141cc995fd35ed31dc40" title="Returns boyer&#45;lindquist coordinte of point." alt="" coords="3497,1998,3567,2028"/><area shape="rect" id="node88" href="../../d8/d60/init_8c.html#a27c01fe4532cf3e10d467517403dbf70" title="blcoord_user" alt="" coords="3661,1985,3757,2014"/><area shape="rect" id="node90" href="../../d9/de9/coord_8c.html#af7a086e6042d598aea95c2360d07a99b" title="blcoord_singfixes" alt="" coords="3648,2038,3771,2068"/><area shape="rect" id="node96" href="../../dc/d5e/fluxcompute_8c.html#a922e55dc88348166e53d2615941564d8" title="actually compute flux from given data GODMARK: right now if splitmaem==1 assumes F is linear in FMA a..." alt="" coords="1337,298,1436,328"/><area shape="rect" id="node100" href="../../dc/d5e/fluxcompute_8c.html#ab088a2ff1d1132363446aab47e5c9c7b" title="P&#45;&gt;sate,flux,U." alt="" coords="2053,373,2155,402"/><area shape="rect" id="node152" href="../../dc/d5e/fluxcompute_8c.html#a9fdd8e08eb928fb500db9e2688f1475b" title="p2SFUevolveall" alt="" coords="2047,477,2161,506"/><area shape="rect" id="node156" href="../../de/db6/wavespeeds_8c.html#a269fca52bf4745f3742456843cd0c4ca" title="get wave speeds for flux calculation" alt="" coords="1327,245,1447,274"/><area shape="rect" id="node98" href="../../de/db6/wavespeeds_8c.html#a7fa9b1c8202eb413cf4a926eebec66dc" title="really HARM is currently using VERY local lax Friedrich." alt="" coords="1573,245,1680,274"/><area shape="rect" id="node102" href="../../de/d8c/phys_8c.html#a92cd9cc63c782c0d94699d639aa48f69" title="wrapper for choosing to get state by computing it or from global array notice that ptrgeom&#45;&gt;p inputte..." alt="" coords="2249,464,2385,493"/><area shape="rect" id="node113" href="../../d3/ddc/phys_8funcdeclare_8h.html#a19e08c0d7e5a7c9fb9d97ff5ffab053c" title="Calculate fluxes in direction dir and conserved variable U returntype==0 : flux with geometric factor..." alt="" coords="2527,1552,2604,1581"/><area shape="rect" id="node104" href="../../d7/def/phys_8tools_8c.html#adf1cf36a7c564b77dca08d26ce233df7" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="2485,524,2645,553"/><area shape="rect" id="node109" href="../../d7/def/phys_8tools_8c.html#a8db4cb0eaaedfc1b0f3d5791d5052068" title="separate function for getting primitives" alt="" coords="2768,524,2883,553"/><area shape="rect" id="node111" href="../../d7/def/phys_8tools_8c.html#ab23ee4012c46b45e96ebffcf5766b0bb" title="separate function for getting geometry" alt="" coords="2768,470,2883,500"/><area shape="rect" id="node115" href="../../d7/def/phys_8tools_8c.html#ace478826bef11e98daed7dd2ab026c93" title="matter only terms (as if B=0)" alt="" coords="2773,1552,2877,1581"/><area shape="rect" id="node135" href="../../d7/def/phys_8tools_8c.html#a3c8277899afc2a48590156971490bb79" title="radiation terms (as if rho=u=p=0)" alt="" coords="2773,1426,2877,1456"/><area shape="rect" id="node140" href="../../d7/def/phys_8tools_8c.html#a664550c21e363870d26e73f3ab5b3d3c" title="electromagnetic terms (as if rho=u=p=0)" alt="" coords="2773,1661,2877,1690"/><area shape="rect" id="node117" href="../../d7/def/phys_8tools_8c.html#a133cabc36f68eda16f9245f749c3cc38" title="flux asociated with Ynu variable" alt="" coords="3025,1552,3119,1581"/><area shape="rect" id="node119" href="../../d7/def/phys_8tools_8c.html#a787551c0e83438fe9e63ecd3d996f61a" title="massflux_calc" alt="" coords="3265,1500,3372,1529"/><area shape="rect" id="node121" href="../../d7/def/phys_8tools_8c.html#a2ef51d65728fe59168e5b705165af6d4" title="flux associated with Y_L variable" alt="" coords="3031,1448,3113,1477"/><area shape="rect" id="node124" href="../../d7/def/phys_8tools_8c.html#a1e1dcf1d515232206c829a33d7e1192b" title="flux associated with Y_fl variable" alt="" coords="3028,1394,3116,1424"/><area shape="rect" id="node127" href="../../d7/def/phys_8tools_8c.html#a5717fa95303172fb697892a9232f0546" title="flux of specific entropy" alt="" coords="3013,1658,3131,1688"/><area shape="rect" id="node129" href="../../d7/def/phys_8tools_8c.html#a4886704a6724ea65ccaae2277b6ded74" title="MHD stress tensor, with first index up, second index down mhd^dir_j understood that mhddiagpress only..." alt="" coords="3021,1605,3123,1634"/><area shape="rect" id="node131" href="../../d7/def/phys_8tools_8c.html#ab3fd971df8ad09cce2462e78d7735f33" title="MHD stress tensor, with first index up, second index down." alt="" coords="3260,1602,3377,1632"/><area shape="rect" id="node133" href="../../d7/def/phys_8tools_8c.html#a44930b5d598885afcb717a270f42749f" title="MHD stress tensor, with first index up, second index down avoids catastrophic cancellation with rest&#45;..." alt="" coords="3229,1656,3408,1685"/><area shape="rect" id="node138" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a389bf7e41d2fd117af996e3392067cdc" title="compute radiation stres&#45;energy tensor assuming M1 closure" alt="" coords="3268,1762,3369,1792"/><area shape="rect" id="node142" href="../../d7/def/phys_8tools_8c.html#a3552b97ec9f1982094fbc3e3f9af7f05" title="MHD stress tensor, with first index up, second index down mhd^dir_j." alt="" coords="3021,2026,3123,2056"/><area shape="rect" id="node148" href="../../d7/def/phys_8tools_8c.html#a12b4ca77ffbef030f608b079327b4eb7" title="spatial part of dualfaraday" alt="" coords="2993,1712,3151,1741"/><area shape="rect" id="node144" href="../../d7/def/phys_8tools_8c.html#a3f6e052b84282b8db7b05a0acc435622" title="EM part of stress&#45;energy tensor." alt="" coords="3260,2080,3377,2109"/><area shape="rect" id="node146" href="../../d7/def/phys_8tools_8c.html#a864ca09eade159d4c4b545593c1095de" title="MHD stress tensor, with first index up, second index down avoids catastrophic cancellation with rest&#45;..." alt="" coords="3240,2026,3397,2056"/><area shape="rect" id="node150" href="../../d7/def/phys_8tools_8c.html#abc846df49f33c007310b52240e099e3b" title="Notation for HARM paper and JCM&#39;s GRFFE paper is that: B^ = &#160;*F^{} and for lab&#45;frame we chose ={&#45;1..." alt="" coords="3251,1709,3387,1738"/><area shape="rect" id="node164" href="../../dc/dae/flux_8c.html#aef355ccd1ca2295b84ad2fe1fc011d35" title="normal interpolation of CENT quantities to FACE quantities sets global variables pl_ct and pr_ct to p..." alt="" coords="1068,717,1247,746"/><area shape="rect" id="node166" href="../../dc/dae/flux_8c.html#a26e710fdb46e850254a41503d339720d" title="slope_lim_cent2face() is provided p2interp and returns pleft/pright gets interpolations in expanded r..." alt="" coords="1316,664,1457,693"/><area shape="rect" id="node170" href="../../d4/dad/bounds_8funcdeclare_8h.html#addca75a18cc861326a321565a2e81aa0" title="normal bounding of non&#45;staggered primitives" alt="" coords="1583,898,1671,928"/><area shape="rect" id="node172" href="../../d4/dad/bounds_8funcdeclare_8h.html#adbe0e3ba8a74f09ab928a96bd68cab6d" title="bound any prim type CALLS directly real and MPI boundary functions pstag = pstagglobal ucons = unewgl..." alt="" coords="1824,930,1933,960"/><area shape="rect" id="node174" href="../../de/d51/bounds_8c.html#a4bc7413b2cdb89e070f38bbb689ae555" title="bound_prim_user_dir" alt="" coords="2033,970,2175,1000"/><area shape="rect" id="node182" href="../../d0/dde/fluxctstag_8c.html#a985ee116306b4011810334ae93900493" title="INPUTS: Nvec, pr, primface_l[dir], primface_r[dir] OUTPUTS: pbcorn[dir][side], pvcorn[dir][side][side..." alt="" coords="1068,664,1247,693"/><area shape="rect" id="node190" href="../../d0/dde/fluxctstag_8c.html#a2dd789bf1402bef72523cdb69e85806e" title="use global pbcorninterp and pvcorninterp at CORN1,2,3 to obtain EMFs at CORN1,2,3 NO interpolation of..." alt="" coords="1092,836,1223,883"/><area shape="rect" id="node184" href="../../d0/dde/fluxctstag_8c.html#ad6aa918442f7768dff3c099ba353ee64" title="slope_lim_face2corn() is provided p2interp and returns pleft/pright differs from slope_lim() by range..." alt="" coords="1316,717,1457,746"/><area shape="rect" id="node196" href="../../d0/dde/fluxctstag_8c.html#a6cd90dff56319085b32bc57c0c8b3cfd" title="this function called in initbase.c and during advance() here ustag is point value if dimension doesn&#39;..." alt="" coords="1097,1026,1217,1056"/><area shape="rect" id="node201" href="../../d0/dde/fluxctstag_8c.html#a5e3dcbe89d6f8a9384cafb58afd7dbf4" title="interpolates field at FACE to field at CENT assuming field along itself is continuous" alt="" coords="1097,956,1217,1003"/><area shape="rect" id="node209" href="../../d4/dad/bounds_8funcdeclare_8h.html#a6f4b963a50a7288964f01775f2f18bb9" title="normal bounding of staggered primitives" alt="" coords="1109,1130,1205,1160"/><area shape="rect" id="node198" href="../../d0/dde/fluxctstag_8c.html#aa0b35fa62bf99b1fb71d2318548fcac4" title="U staggered field to P staggered field OPTMARK: presume this function gets inlined." alt="" coords="1340,1026,1433,1056"/><area shape="rect" id="node203" href="../../d0/dde/fluxctstag_8c.html#aaec26a518629175ecceefbaf6c84225e" title="wrapper for continuous interpolation for FACE_to_CENT" alt="" coords="1300,770,1473,800"/><area shape="rect" id="node211" href="../../d4/dad/bounds_8funcdeclare_8h.html#abdea68b778dc9253324da69d3c376965" title="bound any pstag type CALLS directly real and MPI boundary functions pstag is at FACE1,2,3 for fields, so user bound is different MPI bounding is the same as CENT quantities used when restarting in initbase.c to bound unewglobal for FLUXB==FLUXCTSTAG" alt="" coords="1328,1130,1445,1160"/><area shape="rect" id="node213" href="../../de/d51/bounds_8c.html#a3246b706b24adb6265016a8954807f6f" title="assume single user function takes care of primitive locations" alt="" coords="1552,970,1701,1000"/><area shape="rect" id="node221" href="../../d7/def/phys_8tools_8c.html#a39e973bfdc6ccf9e82b33925e073fca3" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="2488,577,2643,606"/><area shape="rect" id="node228" href="../../de/d8c/phys_8c.html#a44693eac289e90fab8a6792e6e9fb02c" title="source_conn" alt="" coords="2056,1976,2152,2005"/><area shape="rect" id="node240" href="../../d3/ddc/phys_8funcdeclare_8h.html#a9ffbdaa97489ef748af456f65c779e18" title="Ugeomfree and dUother are in UNOTHING form (or UEVOLVE without geometry) pf might be modified so bett..." alt="" coords="865,1564,972,1593"/><area shape="rect" id="node230" href="../../d7/def/phys_8tools_8c.html#a12238eba5936209a397a23dd34724ec9" title="returns entire space&#45;time(NDIM in size) / EOM(NPR in size) matrix" alt="" coords="2269,1821,2365,1850"/><area shape="rect" id="node233" href="../../d7/def/phys_8tools_8c.html#acee98fab974682bc6838e2040bed0d45" title="MHD stress tensor, with first index up, second index down mhd^dir_j." alt="" coords="2279,1976,2356,2005"/><area shape="rect" id="node235" href="../../d7/def/phys_8tools_8c.html#adeb9f0f94ef0d4f02ddd49a3de4de7e3" title="MHD stress tensor, with first index up, second index down avoids catastrophic cancellation with rest&#45;..." alt="" coords="2749,1976,2901,2005"/><area shape="rect" id="node242" href="../../d2/d72/phys_8tools_8rad_8c.html#aa8c5c0d5de580899948f9f22e10aff23" title="General radiation source term calculation (EXTERNALLY called) NOTE: source_explicit() takes as first ..." alt="" coords="1097,1590,1217,1620"/><area shape="rect" id="node330" href="../../d5/de1/global_8inits_8h.html#aeb307be7cd4b2a4520d60cdb2510c1ce" title="coolfunc_user" alt="" coords="1107,1537,1208,1566"/><area shape="rect" id="node244" href="../../d2/d72/phys_8tools_8rad_8c.html#a675bb3f12a77c62cf2540bc42c4867f8" title="wrapper for mode method" alt="" coords="1303,1590,1471,1620"/><area shape="rect" id="node246" href="../../d9/de9/coord_8c.html#a96290375e27d5d0aa4d843b07e228e14" title="normally&#45;used bl_coord[i,j,k] {i,j,k} &#45;&gt; V only" alt="" coords="3273,2133,3364,2162"/><area shape="rect" id="node251" href="../../d2/d72/phys_8tools_8rad_8c.html#a17aede36203a236390363af78d3a86f0" title="compute changes to U (both T and R) using implicit method KORALTODO: If doing implicit, should also add geometry source term that can sometimes be stiff." alt="" coords="1523,1617,1731,1646"/><area shape="rect" id="node324" href="../../d1/d3e/utoprimgen_8c.html#a7d31362f91cd4ec3b92e15dd6bcb3908" title="includerad=1: account for fact that not only assume MHD flow is cold itself, but energy&#45;force balance..." alt="" coords="1587,1510,1667,1540"/><area shape="rect" id="node328" href="../../de/d95/fixup_8c.html#a43fb15d762b67f635ac6c63a158bf558" title="record who called the diag_fixup routine" alt="" coords="1568,1564,1685,1593"/><area shape="rect" id="node248" href="../../d9/de9/coord_8c.html#a041e7b005310415c97d90f4b8521ed1a" title="get X(i,j,k) CENT is default position in degenerate cases" alt="" coords="3505,2133,3559,2162"/><area shape="rect" id="node253" href="../../d2/d72/phys_8tools_8rad_8c.html#a5dcc789108ddf06ec44fb22770f18e90" title="compute dt for this sub&#45;step" alt="" coords="1833,1669,1924,1698"/><area shape="rect" id="node256" href="../../d2/d72/phys_8tools_8rad_8c.html#af46d2b1cf89a70a7e2ef503146c649a9" title="uu0 &#45; original cons." alt="" coords="2067,1445,2141,1474"/><area shape="rect" id="node296" href="../../d1/d3e/utoprimgen_8c.html#abfc42de6975dd4ff02f2748404e10911" title="perform U&#45;&gt;p inversion on advected scalars" alt="" coords="2263,1098,2372,1128"/><area shape="rect" id="node298" href="../../d3/ddc/phys_8funcdeclare_8h.html#aae6a7d24b984236dae44b1a3e8ee37b6" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="2491,1718,2640,1748"/><area shape="rect" id="node300" href="../../d7/def/phys_8tools_8c.html#ad54ad99ee062beaf43518d6e9afae0a7" title="primtoflux_nonradonly" alt="" coords="2491,1612,2640,1641"/><area shape="rect" id="node310" href="../../d1/d3e/utoprimgen_8c.html#a1118806d01e553c38ae5cf5f036f9f2e" title="perform U&#45;&gt;p inversion on advected scalars" alt="" coords="2263,1045,2372,1074"/><area shape="rect" id="node315" href="../../d2/d72/phys_8tools_8rad_8c.html#afa73a2caa3209e565a64f92447058507" title="calculating approximate Jacobian: dUresid(dUrad,G(Urad))/dUrad = dy(x)/dx then compute inverse Jacobi..." alt="" coords="1827,1544,1931,1573"/><area shape="rect" id="node259" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a0a9afe086334630c217cca3b3dbf7f7d" title="get 4&#45;force for all pl&#39;s" alt="" coords="2241,1304,2393,1333"/><area shape="rect" id="node288" href="../../d2/d72/phys_8tools_8rad_8c.html#a0a4c88ebd712c11eee70dda4d75288cf" title="setgasinversionstuff" alt="" coords="2248,1458,2387,1488"/><area shape="rect" id="node291" href="../../d3/ddc/phys_8funcdeclare_8h.html#a3c69b676adf3024cd6ae832094d91fab" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="2491,1025,2640,1054"/><area shape="rect" id="node304" href="../../d3/ddc/phys_8funcdeclare_8h.html#a07847bede2b7ba9d0aabaea82f17f989" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="2503,972,2628,1001"/><area shape="rect" id="node307" href="../../d7/def/phys_8tools_8c.html#a764e6f682011d16faec0f9b71eb360d2" title="primtoflux_radonly" alt="" coords="2501,1458,2629,1488"/><area shape="rect" id="node313" href="../../d2/d72/phys_8tools_8rad_8c.html#ae83fc4364d7c6bc0b717418cd5345297" title="calc_approx_ratchangeRtt" alt="" coords="2231,1512,2404,1541"/><area shape="rect" id="node262" href="../../d2/d72/phys_8tools_8rad_8c.html#aaa32f967773a287ecb6647732157606f" title="get G_" alt="" coords="2531,1665,2600,1694"/><area shape="rect" id="node264" href="../../d2/d72/phys_8tools_8rad_8c.html#ab62b07a8cbcc04f20c05a468ad6de636" title="compute G^ 4&#45;force" alt="" coords="2791,1817,2860,1846"/><area shape="rect" id="node266" href="../../df/d21/global_8funcdeclare_8rad_8h.html#aba8efc1e2ea7a31f67bb6c06ce3c164a" title="mhdfull_calc_rad" alt="" coords="3012,1869,3132,1898"/><area shape="rect" id="node269" href="../../df/d21/global_8funcdeclare_8rad_8h.html#af8e0b77aba8b494909392ceca6f551a0" title="get {abs} and {es} in /mass * rho = 1/cm form." alt="" coords="2973,1973,3171,2002"/><area shape="rect" id="node286" href="../../d8/d60/init_8c.html#a9118b79d84fe3dccfed3b28ee0fd84b5" title="Gcompt" alt="" coords="3039,1765,3105,1794"/><area shape="rect" id="node271" href="../../d2/d72/phys_8tools_8rad_8c.html#a864793af319e70c0d099679fa81dd398" title="compute Trad (also computed directly in calc_Gu() above) using only primitives (not using conserved q..." alt="" coords="3219,1973,3419,2002"/><area shape="rect" id="node278" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a7dc2e853cec9b6f9a5e83ce23c468d03" title="nrad(T) = nrad=arad T^3/2.70118 (this is LTE only if put in T was gas T)" alt="" coords="3645,1869,3773,1898"/><area shape="rect" id="node281" href="../../df/d21/global_8funcdeclare_8rad_8h.html#ab4537b80f4788d1a81759b595c8441a9" title="kappa_func_fits_all" alt="" coords="3252,1866,3385,1896"/><area shape="rect" id="node283" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a0fb687f68b97453843fc3c085f05f1b4" title="E=urad=arad T^4 (this is LTE only if put in T was gas T)" alt="" coords="3256,1920,3381,1949"/><area shape="rect" id="node273" href="../../df/d21/global_8funcdeclare_8rad_8h.html#af07558357c906b4dfa61cd34656d9f02" title="E=urad=arad T^4 and just solve for T (this is LTE only if assume resulting T is gas T)..." alt="" coords="3647,1925,3772,1954"/><area shape="rect" id="node275" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a3e47afcfc5c42719999d851395fd032d" title="nrad(E)" alt="" coords="3468,1870,3596,1900"/><area shape="rect" id="node334" href="../../d1/d3e/utoprimgen_8c.html#a0a83e9e7fdd3cc595c5b8d0df88ec684" title="just picks the algorithm to invert" alt="" coords="2257,941,2377,970"/><area shape="rect" id="node336" href="../../d1/dde/utoprim__jon_8c.html#a2c450f7c2c86203afc48f0a40c665d38" title="The ONLY global function:" alt="" coords="2477,902,2653,948"/><area shape="rect" id="node341" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a9fe58e7f372421d18633c8fc5007b815" title="u2p_rad" alt="" coords="2532,1078,2599,1108"/><area shape="rect" id="node343" href="../../d2/d72/phys_8tools_8rad_8c.html#a67b370af2fa58283bc590ff4e895fb90" title="Like u2p_rad_orig(), but uses Jon&#39;s paper draft ZAMO RAD version." alt="" coords="2776,1078,2875,1108"/><area shape="rect" id="node345" href="../../d2/d72/phys_8tools_8rad_8c.html#a77c546a7fb064266fef5a9e796dc63dc" title="compute ZAMO version of radiation quantities as in paper draft" alt="" coords="2999,1052,3145,1081"/><area shape="rect" id="node347" href="../../d3/ddc/phys_8funcdeclare_8h.html#abfae38e47b0bd05a4fc38302ff948a96" title="find gamma&#45;factor wrt normal observer This function and qsq_calc() have about the same cache miss amo..." alt="" coords="2987,1105,3157,1134"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d22/advance_8c_a22dff5dc24ff389254919e70b79be489_icgraph.png" border="0" usemap="#df/d22/advance_8c_a22dff5dc24ff389254919e70b79be489_icgraph" alt=""/></div>
<map name="df/d22/advance_8c_a22dff5dc24ff389254919e70b79be489_icgraph" id="df/d22/advance_8c_a22dff5dc24ff389254919e70b79be489_icgraph">
<area shape="rect" id="node3" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="127,5,260,35"/><area shape="rect" id="node5" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="311,5,377,35"/><area shape="rect" id="node7" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="428,5,519,35"/><area shape="rect" id="node9" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="568,5,619,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a217bbc071881142282a66a317664912b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int advance_standard </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>truestep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>stage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>pi</em>[NSTORE2][NSTORE3][NPR], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>pb</em>[NSTORE2][NSTORE3][NPR], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>pf</em>[NSTORE2][NSTORE3][NPR], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>pstag</em>[NSTORE2][NSTORE3][NPR], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>pl_ct</em>[NSTORE1][NSTORE2][NSTORE3][NPR2INTERP], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>pr_ct</em>[NSTORE1][NSTORE2][NSTORE3][NPR2INTERP], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>F1</em>[NSTORE2][NSTORE3][NPR+NSPECIAL], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>F2</em>[NSTORE2][NSTORE3][NPR+NSPECIAL], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>F3</em>[NSTORE2][NSTORE3][NPR+NSPECIAL], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>vpot</em>[NSTORE1+SHIFTSTORE1][NSTORE2+SHIFTSTORE2][NSTORE3+SHIFTSTORE3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>ui</em>[NSTORE2][NSTORE3][NPR], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>uf</em>[NSTORE2][NSTORE3][NPR], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>ucum</em>[NSTORE2][NSTORE3][NPR], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>CUf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>CUnew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a>&#160;</td>
          <td class="paramname"><em>fluxdt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a>&#160;</td>
          <td class="paramname"><em>boundtime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a>&#160;</td>
          <td class="paramname"><em>fluxtime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>timeorder</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numtimeorders</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>ndt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>this method guarantees conservation of non-sourced conserved quantities when metric is time-dependent this method has updated field staggered method Note that when dt==0.0, assume no fluxing, just take ucum -&gt; ui -&gt; {uf,ucum} and invert. </p>
<p>Used with metric update.</p>
<p>NEW: like <a class="el" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non-sourced conserved quantities when metric is time-dependent...">advance_standard_orig()</a>, but removed debug info and set field "inversion" first so have centered value for <a class="el" href="../../d3/ddc/phys_8funcdeclare_8h.html#a4ebf7765a6bde079a76719b89d3033b6" title="add in source terms to equations of motion ui and dUriemann in UEVOLVE form assume q(pr) so consisten...">source()</a> so have it for any point-use of values like in implicit solver for radiation-fluid interaction. </p>

<p>Definition at line <a class="el" href="../../df/d22/advance_8c_source.html#l00160">160</a> of file <a class="el" href="../../df/d22/advance_8c_source.html">advance.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d22/advance_8c_a217bbc071881142282a66a317664912b_cgraph.png" border="0" usemap="#df/d22/advance_8c_a217bbc071881142282a66a317664912b_cgraph" alt=""/></div>
<map name="df/d22/advance_8c_a217bbc071881142282a66a317664912b_cgraph" id="df/d22/advance_8c_a217bbc071881142282a66a317664912b_cgraph">
<area shape="rect" id="node3" href="../../dc/dae/flux_8c.html#ab229b0f3f2caf3c0a3ef5299fba2b1c0" title="see fluxcompute.c for non&#45;computer science, real physics calculations of flux" alt="" coords="213,820,280,849"/><area shape="rect" id="node65" href="../../d3/ddc/phys_8funcdeclare_8h.html#a11e17cd8b0594d1ad52e3594aa9f477e" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="2408,684,2483,713"/><area shape="rect" id="node192" href="../../d0/dde/fluxctstag_8c.html#a3c59ef3a54b18bbaf4970c13995dadfc" title="wrapper for taking staggered conserved field quantity and obtaining centered field quantity upoint en..." alt="" coords="711,1052,887,1081"/><area shape="rect" id="node214" href="../../d3/ddc/phys_8funcdeclare_8h.html#a9a54096e4c40a15a2c1bf74266153616" title="calculate &quot;conserved&quot; quantities" alt="" coords="2164,1768,2231,1797"/><area shape="rect" id="node217" href="../../de/d8c/phys_8c.html#a126e2e13b7ac0d2c79b17ecf87129b77" title="wrapper for choosing to get state by computing it or from global array pointer assign (overrides the ..." alt="" coords="181,442,312,472"/><area shape="rect" id="node224" href="../../d3/ddc/phys_8funcdeclare_8h.html#a4ebf7765a6bde079a76719b89d3033b6" title="add in source terms to equations of motion ui and dUriemann in UEVOLVE form assume q(pr) so consisten..." alt="" coords="564,1564,625,1593"/><area shape="rect" id="node330" href="../../d1/d3e/utoprimgen_8c.html#a7e078cc9a354495bc85554d875a705d9" title="General explicit inversion of U[MHD]&#45;&gt;P[MHD] and also inverts scalars. Inverts radiation if(EOMRADTYP..." alt="" coords="1940,1125,2028,1154"/><area shape="rect" id="node5" href="../../dc/dae/flux_8c.html#a8ffa7399bd5354fdcdec5f3e1adf0b13" title="wrapper for CENT_to_FACE1,2,3 used to compute flux at face" alt="" coords="377,793,471,822"/><area shape="rect" id="node176" href="../../dc/dae/flux_8c.html#ae680339abb42df844400546501125e2c" title="fluxEM2flux4EMF" alt="" coords="361,740,487,769"/><area shape="rect" id="node178" href="../../d5/d2f/flux_8funcdeclare_8h.html#a77a38ff10f7d1d0a073866bd154c52b6" title="wrapper for: 1) interpolate FACE 2 CORN 2) loop over dimensions setting field flux dimension&#45;by&#45;dimen..." alt="" coords="733,845,864,874"/><area shape="rect" id="node7" href="../../dc/dae/flux_8c.html#aaf6d832880760f80459d91477c28b519" title="wrapper for different standard 1&#45;D flux calculators 1&#45;D interpolate and get flux for that direction (..." alt="" coords="537,560,652,589"/><area shape="rect" id="node9" href="../../dc/dae/flux_8c.html#a054658527dfb1d80226b8b2d2106aeed" title="original flux calculator that gets F in &quot;dir&quot;. At end global pleft,pright,dq also set and if STOREWAV..." alt="" coords="737,506,860,536"/><area shape="rect" id="node160" href="../../dc/dae/flux_8c.html#a2602a4dad9ed7adc944227d02435312e" title="standard (non&#45;field flux) calculation but setup to store results of interpolation so can be used for ..." alt="" coords="701,560,896,589"/><area shape="rect" id="node11" href="../../dc/dae/flux_8c.html#a2a4bea22d4d0b16aaba0d19357413e31" title="slope_lim() is provided p2interp and returns pleft/pright" alt="" coords="1228,506,1305,536"/><area shape="rect" id="node45" href="../../de/db6/wavespeeds_8c.html#ade70ed882f42b4e9e2a70916a33ab532" title="complete storage of wave speeds per dimension only called for STOREWAVESPEEDS==1" alt="" coords="945,558,1129,588"/><area shape="rect" id="node92" href="../../dc/d5e/fluxcompute_8c.html#aa195df0bf8c8fb0a14d8e27a1d3b89ff" title="actually compute the flux and ctop for dt calculation" alt="" coords="963,376,1112,405"/><area shape="rect" id="node13" href="../../d5/d2f/flux_8funcdeclare_8h.html#a8dd1a8200cac33bfd5c4520a76285d69" title="slope_lim_linetype_c2e" alt="" coords="1428,664,1585,693"/><area shape="rect" id="node15" href="../../d5/d2f/flux_8funcdeclare_8h.html#a0d50fd876f4e61d909a1e006bac28387" title="whether primreal is p2interp can&#39;t assume this is true in general (e.g." alt="" coords="1439,717,1575,746"/><area shape="rect" id="node17" href="../../d8/ddd/interppoint_8c.html#ab50c96d0a8603ec34f1c7a023a4156ff" title="interpolate from a center point to a left/right interface" alt="" coords="1689,737,1828,766"/><area shape="rect" id="node31" href="../../d8/ddd/interppoint_8c.html#a7d9885f70f6b7a32637920ddf74b0f98" title="DEVELOPING RIGHT NOW interpolate from a center point to a left/right interface." alt="" coords="1689,634,1828,680"/><area shape="rect" id="node35" href="../../d8/ddd/interppoint_8c.html#af1ea622d3759b98722d11ed0a3d555e7" title="interpolate from a center point to a left/right interface" alt="" coords="1688,806,1829,836"/><area shape="rect" id="node19" href="../../df/d30/interppoint_8para_8c.html#a6f45f925dd7972198f6ef41de42374df" title="lout/rout is left and right sides of cell note how used in step_ch.c to get appropriate interface val..." alt="" coords="1961,864,2007,893"/><area shape="rect" id="node21" href="../../df/d30/interppoint_8para_8c.html#abe1b655c3bd8c6e3ac699e6cedb03c18" title="doesn&#39;t use dq" alt="" coords="1957,704,2011,733"/><area shape="rect" id="node23" href="../../d8/ddd/interppoint_8c.html#a70f54bffe6df5f410a43980f4aa83971" title="limited slopes using 3 points Gives slope that will be assumed to be located at same location as yc –..." alt="" coords="1921,757,2047,786"/><area shape="rect" id="node25" href="../../d8/ddd/interppoint_8c.html#a9a8e95c4501b23d1a80162c3b2cee142" title="http://mesa.sourceforge.net/pdfs/suresh+huynh_97.pdf http://iopscience.iop.org/0264&#45;9381/31/1/015005/..." alt="" coords="1961,650,2007,680"/><area shape="rect" id="node29" href="../../d8/ddd/interppoint_8c.html#a75bf89b2527949948883f2089374dcf9" title="Enhanced PPM The Einstein Toolkit source code says that the relevant references are: Colella &amp; Sekora..." alt="" coords="1957,810,2011,840"/><area shape="rect" id="node27" href="../../d8/ddd/interppoint_8c.html#a5677d72681462036d6c8a6e13c1c20d9" title="if yll,yl,yc,yr,yrr are really in that order, then get lout." alt="" coords="2161,632,2233,661"/><area shape="rect" id="node33" href="../../d8/ddd/interppoint_8c.html#a367af7d2f93ccc62459fbdbacd4f62f3" title="limited 2nd derivatives using 4 points see e2c_continuous.nb" alt="" coords="1907,580,2061,627"/><area shape="rect" id="node37" href="../../df/d30/interppoint_8para_8c.html#af36824cae5f3156fa6da09c3536c7785" title="used when lim=PARAFLAT" alt="" coords="1956,917,2012,946"/><area shape="rect" id="node39" href="../../df/d30/interppoint_8para_8c.html#ac3af1cc044a6058812c512179cbb090a" title="Get pressure Note this is quite inefficient since operating per&#45;point get same pressure for entire li..." alt="" coords="2152,736,2243,765"/><area shape="rect" id="node41" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a5943065ab3d5b4e9f4f691db499b588f" title="calculates total opacity over dx[]" alt="" coords="2403,1132,2488,1161"/><area shape="rect" id="node43" href="../../d2/d72/phys_8tools_8rad_8c.html#a795959353203e99366b456b16d0d0bab" title="calculates total opacity over dx[] for given chi or chieff" alt="" coords="2643,1132,2768,1161"/><area shape="rect" id="node47" href="../../de/db6/wavespeeds_8c.html#a99d8d29de65565134c1d91007b0d12c6" title="store wavespeeds somewhere" alt="" coords="1187,453,1347,482"/><area shape="rect" id="node90" href="../../de/db6/wavespeeds_8c.html#a9adb8a9ad30e24a08285f6a4c28856ef" title="GODMARK: something wrong with comparing multiple velocities since grid/metric changes in space (i..." alt="" coords="1220,560,1313,589"/><area shape="rect" id="node49" href="../../de/d8c/phys_8c.html#af560087e095f9677ac65b1bc6b424fa9" title="wrapper for choosing to get state by computing it or from global array pointer assign (overrides the ..." alt="" coords="1660,529,1857,558"/><area shape="rect" id="node59" href="../../de/db6/wavespeeds_8c.html#add5696e20b7235a8f870dd0dffb8dc7d" title="vchar_each" alt="" coords="1463,298,1551,328"/><area shape="rect" id="node51" href="../../d7/def/phys_8tools_8c.html#a3ef47960a272ef981fd551582b610503" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="2335,630,2556,660"/><area shape="rect" id="node53" href="../../d3/ddc/phys_8funcdeclare_8h.html#a12a473e24b431762af4168179e82cd08" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="2624,630,2787,660"/><area shape="rect" id="node55" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a8a762bf6582e6f7e1199de9c43b98454" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="2607,577,2804,606"/><area shape="rect" id="node57" href="../../d3/ddc/phys_8funcdeclare_8h.html#a41b8eacac0a4a23d6b00b670fe49629c" title="bsq_calc_fromq" alt="" coords="2648,684,2763,713"/><area shape="rect" id="node61" href="../../d8/d20/vchar_8c.html#acdcca98ca82b041999cdb29fdf958a22" title="Charles believed that near polar axis one should set vmax=vmin=0, but not right since makes flux comp..." alt="" coords="1732,217,1785,246"/><area shape="rect" id="node70" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a2f3df15638b9795556ef2bdf1e8c8f97" title="compute radiative characteristics as limited by opacity" alt="" coords="1720,281,1797,310"/><area shape="rect" id="node63" href="../../d8/d20/vchar_8c.html#acad033b60e7ca6404ffcd9b0fdfd13b4" title="simplefast" alt="" coords="2156,217,2239,246"/><area shape="rect" id="node72" href="../../d2/d72/phys_8tools_8rad_8c.html#a63256be4e6a63216cb736012e36a6375" title="calc_chi" alt="" coords="1949,269,2019,298"/><area shape="rect" id="node75" href="../../d2/d72/phys_8tools_8rad_8c.html#abd01208ba3c5754ea5587bcaefcaa01b" title="get lab&#45;frame 3&#45;velocity for radiative emission in radiative frame" alt="" coords="1931,165,2037,194"/><area shape="rect" id="node78" href="../../d9/de9/coord_8c.html#a0672d8c0ee4ff07c7265d0ecbc365cdc" title="normally&#45;used dxdxp[i,j,k] = dV/dX" alt="" coords="2659,290,2752,320"/><area shape="rect" id="node80" href="../../d9/de9/coord_8c.html#a64a4372100fc55abf546f02c8b779595" title="Jacobian for dx uniform per dx nonuniform (dx/dr / dx/dr&#39;) i.e." alt="" coords="2915,645,2989,674"/><area shape="rect" id="node82" href="../../d9/de9/coord_8c.html#a56c4b5c03b74a33a7d809daecfa6925e" title="numerical derivative of V w.r.t. X" alt="" coords="3139,1361,3259,1390"/><area shape="rect" id="node84" href="../../d9/de9/coord_8c.html#a65ad4ca9656d141cc995fd35ed31dc40" title="Returns boyer&#45;lindquist coordinte of point." alt="" coords="3377,1998,3447,2028"/><area shape="rect" id="node86" href="../../d8/d60/init_8c.html#a27c01fe4532cf3e10d467517403dbf70" title="blcoord_user" alt="" coords="3541,1985,3637,2014"/><area shape="rect" id="node88" href="../../d9/de9/coord_8c.html#af7a086e6042d598aea95c2360d07a99b" title="blcoord_singfixes" alt="" coords="3528,2038,3651,2068"/><area shape="rect" id="node94" href="../../dc/d5e/fluxcompute_8c.html#a922e55dc88348166e53d2615941564d8" title="actually compute flux from given data GODMARK: right now if splitmaem==1 assumes F is linear in FMA a..." alt="" coords="1217,298,1316,328"/><area shape="rect" id="node98" href="../../dc/d5e/fluxcompute_8c.html#ab088a2ff1d1132363446aab47e5c9c7b" title="P&#45;&gt;sate,flux,U." alt="" coords="1933,373,2035,402"/><area shape="rect" id="node150" href="../../dc/d5e/fluxcompute_8c.html#a9fdd8e08eb928fb500db9e2688f1475b" title="p2SFUevolveall" alt="" coords="1927,477,2041,506"/><area shape="rect" id="node154" href="../../de/db6/wavespeeds_8c.html#a269fca52bf4745f3742456843cd0c4ca" title="get wave speeds for flux calculation" alt="" coords="1207,245,1327,274"/><area shape="rect" id="node96" href="../../de/db6/wavespeeds_8c.html#a7fa9b1c8202eb413cf4a926eebec66dc" title="really HARM is currently using VERY local lax Friedrich." alt="" coords="1453,245,1560,274"/><area shape="rect" id="node100" href="../../de/d8c/phys_8c.html#a92cd9cc63c782c0d94699d639aa48f69" title="wrapper for choosing to get state by computing it or from global array notice that ptrgeom&#45;&gt;p inputte..." alt="" coords="2129,464,2265,493"/><area shape="rect" id="node111" href="../../d3/ddc/phys_8funcdeclare_8h.html#a19e08c0d7e5a7c9fb9d97ff5ffab053c" title="Calculate fluxes in direction dir and conserved variable U returntype==0 : flux with geometric factor..." alt="" coords="2407,1552,2484,1581"/><area shape="rect" id="node102" href="../../d7/def/phys_8tools_8c.html#adf1cf36a7c564b77dca08d26ce233df7" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="2365,524,2525,553"/><area shape="rect" id="node107" href="../../d7/def/phys_8tools_8c.html#a8db4cb0eaaedfc1b0f3d5791d5052068" title="separate function for getting primitives" alt="" coords="2648,524,2763,553"/><area shape="rect" id="node109" href="../../d7/def/phys_8tools_8c.html#ab23ee4012c46b45e96ebffcf5766b0bb" title="separate function for getting geometry" alt="" coords="2648,470,2763,500"/><area shape="rect" id="node113" href="../../d7/def/phys_8tools_8c.html#ace478826bef11e98daed7dd2ab026c93" title="matter only terms (as if B=0)" alt="" coords="2653,1552,2757,1581"/><area shape="rect" id="node133" href="../../d7/def/phys_8tools_8c.html#a3c8277899afc2a48590156971490bb79" title="radiation terms (as if rho=u=p=0)" alt="" coords="2653,1426,2757,1456"/><area shape="rect" id="node138" href="../../d7/def/phys_8tools_8c.html#a664550c21e363870d26e73f3ab5b3d3c" title="electromagnetic terms (as if rho=u=p=0)" alt="" coords="2653,1661,2757,1690"/><area shape="rect" id="node115" href="../../d7/def/phys_8tools_8c.html#a133cabc36f68eda16f9245f749c3cc38" title="flux asociated with Ynu variable" alt="" coords="2905,1552,2999,1581"/><area shape="rect" id="node117" href="../../d7/def/phys_8tools_8c.html#a787551c0e83438fe9e63ecd3d996f61a" title="massflux_calc" alt="" coords="3145,1500,3252,1529"/><area shape="rect" id="node119" href="../../d7/def/phys_8tools_8c.html#a2ef51d65728fe59168e5b705165af6d4" title="flux associated with Y_L variable" alt="" coords="2911,1448,2993,1477"/><area shape="rect" id="node122" href="../../d7/def/phys_8tools_8c.html#a1e1dcf1d515232206c829a33d7e1192b" title="flux associated with Y_fl variable" alt="" coords="2908,1394,2996,1424"/><area shape="rect" id="node125" href="../../d7/def/phys_8tools_8c.html#a5717fa95303172fb697892a9232f0546" title="flux of specific entropy" alt="" coords="2893,1658,3011,1688"/><area shape="rect" id="node127" href="../../d7/def/phys_8tools_8c.html#a4886704a6724ea65ccaae2277b6ded74" title="MHD stress tensor, with first index up, second index down mhd^dir_j understood that mhddiagpress only..." alt="" coords="2901,1605,3003,1634"/><area shape="rect" id="node129" href="../../d7/def/phys_8tools_8c.html#ab3fd971df8ad09cce2462e78d7735f33" title="MHD stress tensor, with first index up, second index down." alt="" coords="3140,1602,3257,1632"/><area shape="rect" id="node131" href="../../d7/def/phys_8tools_8c.html#a44930b5d598885afcb717a270f42749f" title="MHD stress tensor, with first index up, second index down avoids catastrophic cancellation with rest&#45;..." alt="" coords="3109,1656,3288,1685"/><area shape="rect" id="node136" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a389bf7e41d2fd117af996e3392067cdc" title="compute radiation stres&#45;energy tensor assuming M1 closure" alt="" coords="3148,1762,3249,1792"/><area shape="rect" id="node140" href="../../d7/def/phys_8tools_8c.html#a3552b97ec9f1982094fbc3e3f9af7f05" title="MHD stress tensor, with first index up, second index down mhd^dir_j." alt="" coords="2901,2026,3003,2056"/><area shape="rect" id="node146" href="../../d7/def/phys_8tools_8c.html#a12b4ca77ffbef030f608b079327b4eb7" title="spatial part of dualfaraday" alt="" coords="2873,1712,3031,1741"/><area shape="rect" id="node142" href="../../d7/def/phys_8tools_8c.html#a3f6e052b84282b8db7b05a0acc435622" title="EM part of stress&#45;energy tensor." alt="" coords="3140,2080,3257,2109"/><area shape="rect" id="node144" href="../../d7/def/phys_8tools_8c.html#a864ca09eade159d4c4b545593c1095de" title="MHD stress tensor, with first index up, second index down avoids catastrophic cancellation with rest&#45;..." alt="" coords="3120,2026,3277,2056"/><area shape="rect" id="node148" href="../../d7/def/phys_8tools_8c.html#abc846df49f33c007310b52240e099e3b" title="Notation for HARM paper and JCM&#39;s GRFFE paper is that: B^ = &#160;*F^{} and for lab&#45;frame we chose ={&#45;1..." alt="" coords="3131,1709,3267,1738"/><area shape="rect" id="node162" href="../../dc/dae/flux_8c.html#aef355ccd1ca2295b84ad2fe1fc011d35" title="normal interpolation of CENT quantities to FACE quantities sets global variables pl_ct and pr_ct to p..." alt="" coords="948,717,1127,746"/><area shape="rect" id="node164" href="../../dc/dae/flux_8c.html#a26e710fdb46e850254a41503d339720d" title="slope_lim_cent2face() is provided p2interp and returns pleft/pright gets interpolations in expanded r..." alt="" coords="1196,664,1337,693"/><area shape="rect" id="node168" href="../../d4/dad/bounds_8funcdeclare_8h.html#addca75a18cc861326a321565a2e81aa0" title="normal bounding of non&#45;staggered primitives" alt="" coords="1463,898,1551,928"/><area shape="rect" id="node170" href="../../d4/dad/bounds_8funcdeclare_8h.html#adbe0e3ba8a74f09ab928a96bd68cab6d" title="bound any prim type CALLS directly real and MPI boundary functions pstag = pstagglobal ucons = unewgl..." alt="" coords="1704,930,1813,960"/><area shape="rect" id="node172" href="../../de/d51/bounds_8c.html#a4bc7413b2cdb89e070f38bbb689ae555" title="bound_prim_user_dir" alt="" coords="1913,970,2055,1000"/><area shape="rect" id="node180" href="../../d0/dde/fluxctstag_8c.html#a985ee116306b4011810334ae93900493" title="INPUTS: Nvec, pr, primface_l[dir], primface_r[dir] OUTPUTS: pbcorn[dir][side], pvcorn[dir][side][side..." alt="" coords="948,664,1127,693"/><area shape="rect" id="node188" href="../../d0/dde/fluxctstag_8c.html#a2dd789bf1402bef72523cdb69e85806e" title="use global pbcorninterp and pvcorninterp at CORN1,2,3 to obtain EMFs at CORN1,2,3 NO interpolation of..." alt="" coords="972,836,1103,883"/><area shape="rect" id="node182" href="../../d0/dde/fluxctstag_8c.html#ad6aa918442f7768dff3c099ba353ee64" title="slope_lim_face2corn() is provided p2interp and returns pleft/pright differs from slope_lim() by range..." alt="" coords="1196,717,1337,746"/><area shape="rect" id="node194" href="../../d0/dde/fluxctstag_8c.html#a6cd90dff56319085b32bc57c0c8b3cfd" title="this function called in initbase.c and during advance() here ustag is point value if dimension doesn&#39;..." alt="" coords="977,1026,1097,1056"/><area shape="rect" id="node199" href="../../d0/dde/fluxctstag_8c.html#a5e3dcbe89d6f8a9384cafb58afd7dbf4" title="interpolates field at FACE to field at CENT assuming field along itself is continuous" alt="" coords="977,956,1097,1003"/><area shape="rect" id="node207" href="../../d4/dad/bounds_8funcdeclare_8h.html#a6f4b963a50a7288964f01775f2f18bb9" title="normal bounding of staggered primitives" alt="" coords="989,1130,1085,1160"/><area shape="rect" id="node196" href="../../d0/dde/fluxctstag_8c.html#aa0b35fa62bf99b1fb71d2318548fcac4" title="U staggered field to P staggered field OPTMARK: presume this function gets inlined." alt="" coords="1220,1026,1313,1056"/><area shape="rect" id="node201" href="../../d0/dde/fluxctstag_8c.html#aaec26a518629175ecceefbaf6c84225e" title="wrapper for continuous interpolation for FACE_to_CENT" alt="" coords="1180,770,1353,800"/><area shape="rect" id="node209" href="../../d4/dad/bounds_8funcdeclare_8h.html#abdea68b778dc9253324da69d3c376965" title="bound any pstag type CALLS directly real and MPI boundary functions pstag is at FACE1,2,3 for fields, so user bound is different MPI bounding is the same as CENT quantities used when restarting in initbase.c to bound unewglobal for FLUXB==FLUXCTSTAG" alt="" coords="1208,1130,1325,1160"/><area shape="rect" id="node211" href="../../de/d51/bounds_8c.html#a3246b706b24adb6265016a8954807f6f" title="assume single user function takes care of primitive locations" alt="" coords="1432,970,1581,1000"/><area shape="rect" id="node219" href="../../d7/def/phys_8tools_8c.html#a39e973bfdc6ccf9e82b33925e073fca3" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="2368,577,2523,606"/><area shape="rect" id="node226" href="../../de/d8c/phys_8c.html#a44693eac289e90fab8a6792e6e9fb02c" title="source_conn" alt="" coords="1936,1976,2032,2005"/><area shape="rect" id="node238" href="../../d3/ddc/phys_8funcdeclare_8h.html#a9ffbdaa97489ef748af456f65c779e18" title="Ugeomfree and dUother are in UNOTHING form (or UEVOLVE without geometry) pf might be modified so bett..." alt="" coords="745,1564,852,1593"/><area shape="rect" id="node228" href="../../d7/def/phys_8tools_8c.html#a12238eba5936209a397a23dd34724ec9" title="returns entire space&#45;time(NDIM in size) / EOM(NPR in size) matrix" alt="" coords="2149,1821,2245,1850"/><area shape="rect" id="node231" href="../../d7/def/phys_8tools_8c.html#acee98fab974682bc6838e2040bed0d45" title="MHD stress tensor, with first index up, second index down mhd^dir_j." alt="" coords="2159,1976,2236,2005"/><area shape="rect" id="node233" href="../../d7/def/phys_8tools_8c.html#adeb9f0f94ef0d4f02ddd49a3de4de7e3" title="MHD stress tensor, with first index up, second index down avoids catastrophic cancellation with rest&#45;..." alt="" coords="2629,1976,2781,2005"/><area shape="rect" id="node240" href="../../d2/d72/phys_8tools_8rad_8c.html#aa8c5c0d5de580899948f9f22e10aff23" title="General radiation source term calculation (EXTERNALLY called) NOTE: source_explicit() takes as first ..." alt="" coords="977,1590,1097,1620"/><area shape="rect" id="node328" href="../../d5/de1/global_8inits_8h.html#aeb307be7cd4b2a4520d60cdb2510c1ce" title="coolfunc_user" alt="" coords="987,1537,1088,1566"/><area shape="rect" id="node242" href="../../d2/d72/phys_8tools_8rad_8c.html#a675bb3f12a77c62cf2540bc42c4867f8" title="wrapper for mode method" alt="" coords="1183,1590,1351,1620"/><area shape="rect" id="node244" href="../../d9/de9/coord_8c.html#a96290375e27d5d0aa4d843b07e228e14" title="normally&#45;used bl_coord[i,j,k] {i,j,k} &#45;&gt; V only" alt="" coords="3153,2133,3244,2162"/><area shape="rect" id="node249" href="../../d2/d72/phys_8tools_8rad_8c.html#a17aede36203a236390363af78d3a86f0" title="compute changes to U (both T and R) using implicit method KORALTODO: If doing implicit, should also add geometry source term that can sometimes be stiff." alt="" coords="1403,1617,1611,1646"/><area shape="rect" id="node322" href="../../d1/d3e/utoprimgen_8c.html#a7d31362f91cd4ec3b92e15dd6bcb3908" title="includerad=1: account for fact that not only assume MHD flow is cold itself, but energy&#45;force balance..." alt="" coords="1467,1510,1547,1540"/><area shape="rect" id="node326" href="../../de/d95/fixup_8c.html#a43fb15d762b67f635ac6c63a158bf558" title="record who called the diag_fixup routine" alt="" coords="1448,1564,1565,1593"/><area shape="rect" id="node246" href="../../d9/de9/coord_8c.html#a041e7b005310415c97d90f4b8521ed1a" title="get X(i,j,k) CENT is default position in degenerate cases" alt="" coords="3385,2133,3439,2162"/><area shape="rect" id="node251" href="../../d2/d72/phys_8tools_8rad_8c.html#a5dcc789108ddf06ec44fb22770f18e90" title="compute dt for this sub&#45;step" alt="" coords="1713,1669,1804,1698"/><area shape="rect" id="node254" href="../../d2/d72/phys_8tools_8rad_8c.html#af46d2b1cf89a70a7e2ef503146c649a9" title="uu0 &#45; original cons." alt="" coords="1947,1445,2021,1474"/><area shape="rect" id="node294" href="../../d1/d3e/utoprimgen_8c.html#abfc42de6975dd4ff02f2748404e10911" title="perform U&#45;&gt;p inversion on advected scalars" alt="" coords="2143,1098,2252,1128"/><area shape="rect" id="node296" href="../../d3/ddc/phys_8funcdeclare_8h.html#aae6a7d24b984236dae44b1a3e8ee37b6" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="2371,1718,2520,1748"/><area shape="rect" id="node298" href="../../d7/def/phys_8tools_8c.html#ad54ad99ee062beaf43518d6e9afae0a7" title="primtoflux_nonradonly" alt="" coords="2371,1612,2520,1641"/><area shape="rect" id="node308" href="../../d1/d3e/utoprimgen_8c.html#a1118806d01e553c38ae5cf5f036f9f2e" title="perform U&#45;&gt;p inversion on advected scalars" alt="" coords="2143,1045,2252,1074"/><area shape="rect" id="node313" href="../../d2/d72/phys_8tools_8rad_8c.html#afa73a2caa3209e565a64f92447058507" title="calculating approximate Jacobian: dUresid(dUrad,G(Urad))/dUrad = dy(x)/dx then compute inverse Jacobi..." alt="" coords="1707,1544,1811,1573"/><area shape="rect" id="node257" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a0a9afe086334630c217cca3b3dbf7f7d" title="get 4&#45;force for all pl&#39;s" alt="" coords="2121,1304,2273,1333"/><area shape="rect" id="node286" href="../../d2/d72/phys_8tools_8rad_8c.html#a0a4c88ebd712c11eee70dda4d75288cf" title="setgasinversionstuff" alt="" coords="2128,1458,2267,1488"/><area shape="rect" id="node289" href="../../d3/ddc/phys_8funcdeclare_8h.html#a3c69b676adf3024cd6ae832094d91fab" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="2371,1025,2520,1054"/><area shape="rect" id="node302" href="../../d3/ddc/phys_8funcdeclare_8h.html#a07847bede2b7ba9d0aabaea82f17f989" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="2383,972,2508,1001"/><area shape="rect" id="node305" href="../../d7/def/phys_8tools_8c.html#a764e6f682011d16faec0f9b71eb360d2" title="primtoflux_radonly" alt="" coords="2381,1458,2509,1488"/><area shape="rect" id="node311" href="../../d2/d72/phys_8tools_8rad_8c.html#ae83fc4364d7c6bc0b717418cd5345297" title="calc_approx_ratchangeRtt" alt="" coords="2111,1512,2284,1541"/><area shape="rect" id="node260" href="../../d2/d72/phys_8tools_8rad_8c.html#aaa32f967773a287ecb6647732157606f" title="get G_" alt="" coords="2411,1665,2480,1694"/><area shape="rect" id="node262" href="../../d2/d72/phys_8tools_8rad_8c.html#ab62b07a8cbcc04f20c05a468ad6de636" title="compute G^ 4&#45;force" alt="" coords="2671,1817,2740,1846"/><area shape="rect" id="node264" href="../../df/d21/global_8funcdeclare_8rad_8h.html#aba8efc1e2ea7a31f67bb6c06ce3c164a" title="mhdfull_calc_rad" alt="" coords="2892,1869,3012,1898"/><area shape="rect" id="node267" href="../../df/d21/global_8funcdeclare_8rad_8h.html#af8e0b77aba8b494909392ceca6f551a0" title="get {abs} and {es} in /mass * rho = 1/cm form." alt="" coords="2853,1973,3051,2002"/><area shape="rect" id="node284" href="../../d8/d60/init_8c.html#a9118b79d84fe3dccfed3b28ee0fd84b5" title="Gcompt" alt="" coords="2919,1765,2985,1794"/><area shape="rect" id="node269" href="../../d2/d72/phys_8tools_8rad_8c.html#a864793af319e70c0d099679fa81dd398" title="compute Trad (also computed directly in calc_Gu() above) using only primitives (not using conserved q..." alt="" coords="3099,1973,3299,2002"/><area shape="rect" id="node276" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a7dc2e853cec9b6f9a5e83ce23c468d03" title="nrad(T) = nrad=arad T^3/2.70118 (this is LTE only if put in T was gas T)" alt="" coords="3525,1869,3653,1898"/><area shape="rect" id="node279" href="../../df/d21/global_8funcdeclare_8rad_8h.html#ab4537b80f4788d1a81759b595c8441a9" title="kappa_func_fits_all" alt="" coords="3132,1866,3265,1896"/><area shape="rect" id="node281" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a0fb687f68b97453843fc3c085f05f1b4" title="E=urad=arad T^4 (this is LTE only if put in T was gas T)" alt="" coords="3136,1920,3261,1949"/><area shape="rect" id="node271" href="../../df/d21/global_8funcdeclare_8rad_8h.html#af07558357c906b4dfa61cd34656d9f02" title="E=urad=arad T^4 and just solve for T (this is LTE only if assume resulting T is gas T)..." alt="" coords="3527,1925,3652,1954"/><area shape="rect" id="node273" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a3e47afcfc5c42719999d851395fd032d" title="nrad(E)" alt="" coords="3348,1870,3476,1900"/><area shape="rect" id="node332" href="../../d1/d3e/utoprimgen_8c.html#a0a83e9e7fdd3cc595c5b8d0df88ec684" title="just picks the algorithm to invert" alt="" coords="2137,941,2257,970"/><area shape="rect" id="node334" href="../../d1/dde/utoprim__jon_8c.html#a2c450f7c2c86203afc48f0a40c665d38" title="The ONLY global function:" alt="" coords="2357,902,2533,948"/><area shape="rect" id="node339" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a9fe58e7f372421d18633c8fc5007b815" title="u2p_rad" alt="" coords="2412,1078,2479,1108"/><area shape="rect" id="node341" href="../../d2/d72/phys_8tools_8rad_8c.html#a67b370af2fa58283bc590ff4e895fb90" title="Like u2p_rad_orig(), but uses Jon&#39;s paper draft ZAMO RAD version." alt="" coords="2656,1078,2755,1108"/><area shape="rect" id="node343" href="../../d2/d72/phys_8tools_8rad_8c.html#a77c546a7fb064266fef5a9e796dc63dc" title="compute ZAMO version of radiation quantities as in paper draft" alt="" coords="2879,1052,3025,1081"/><area shape="rect" id="node345" href="../../d3/ddc/phys_8funcdeclare_8h.html#abfae38e47b0bd05a4fc38302ff948a96" title="find gamma&#45;factor wrt normal observer This function and qsq_calc() have about the same cache miss amo..." alt="" coords="2867,1105,3037,1134"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d22/advance_8c_a217bbc071881142282a66a317664912b_icgraph.png" border="0" usemap="#df/d22/advance_8c_a217bbc071881142282a66a317664912b_icgraph" alt=""/></div>
<map name="df/d22/advance_8c_a217bbc071881142282a66a317664912b_icgraph" id="df/d22/advance_8c_a217bbc071881142282a66a317664912b_icgraph">
<area shape="rect" id="node3" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="183,5,252,35"/><area shape="rect" id="node5" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="303,5,436,35"/><area shape="rect" id="node7" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="487,5,553,35"/><area shape="rect" id="node9" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="604,5,695,35"/><area shape="rect" id="node11" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="744,5,795,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a38c6fa95ece38a2821c70a1524ec47ec"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int advance_standard_orig </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>truestep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>stage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>pi</em>[NSTORE2][NSTORE3][NPR], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>pb</em>[NSTORE2][NSTORE3][NPR], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>pf</em>[NSTORE2][NSTORE3][NPR], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>pstag</em>[NSTORE2][NSTORE3][NPR], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>pl_ct</em>[NSTORE1][NSTORE2][NSTORE3][NPR2INTERP], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>pr_ct</em>[NSTORE1][NSTORE2][NSTORE3][NPR2INTERP], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>F1</em>[NSTORE2][NSTORE3][NPR+NSPECIAL], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>F2</em>[NSTORE2][NSTORE3][NPR+NSPECIAL], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>F3</em>[NSTORE2][NSTORE3][NPR+NSPECIAL], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>vpot</em>[NSTORE1+SHIFTSTORE1][NSTORE2+SHIFTSTORE2][NSTORE3+SHIFTSTORE3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>ui</em>[NSTORE2][NSTORE3][NPR], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>uf</em>[NSTORE2][NSTORE3][NPR], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>ucum</em>[NSTORE2][NSTORE3][NPR], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>CUf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>CUnew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a>&#160;</td>
          <td class="paramname"><em>fluxdt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a>&#160;</td>
          <td class="paramname"><em>boundtime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a0263684ebff8e72a2f0de1861393595f">SFTYPE</a>&#160;</td>
          <td class="paramname"><em>fluxtime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>timeorder</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numtimeorders</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>ndt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>this method guarantees conservation of non-sourced conserved quantities when metric is time-dependent this method has updated field staggered method Note that when dt==0.0, assume no fluxing, just take ucum -&gt; ui -&gt; {uf,ucum} and invert. </p>
<p>Used with metric update. </p>

<p>Definition at line <a class="el" href="../../df/d22/advance_8c_source.html#l01235">1235</a> of file <a class="el" href="../../df/d22/advance_8c_source.html">advance.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d22/advance_8c_a38c6fa95ece38a2821c70a1524ec47ec_cgraph.png" border="0" usemap="#df/d22/advance_8c_a38c6fa95ece38a2821c70a1524ec47ec_cgraph" alt=""/></div>
<map name="df/d22/advance_8c_a38c6fa95ece38a2821c70a1524ec47ec_cgraph" id="df/d22/advance_8c_a38c6fa95ece38a2821c70a1524ec47ec_cgraph">
<area shape="rect" id="node3" href="../../dc/dae/flux_8c.html#ab229b0f3f2caf3c0a3ef5299fba2b1c0" title="see fluxcompute.c for non&#45;computer science, real physics calculations of flux" alt="" coords="243,750,309,780"/><area shape="rect" id="node65" href="../../d3/ddc/phys_8funcdeclare_8h.html#a11e17cd8b0594d1ad52e3594aa9f477e" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="2437,1062,2512,1092"/><area shape="rect" id="node192" href="../../dc/dae/flux_8c.html#aa26f8747446e1cd5bd214ebc345aafa2" title="compute donor&#45;based flux, bypassing normal fluxcalc()." alt="" coords="775,986,881,1016"/><area shape="rect" id="node201" href="../../d3/ddc/phys_8funcdeclare_8h.html#a9a54096e4c40a15a2c1bf74266153616" title="calculate &quot;conserved&quot; quantities" alt="" coords="2193,2273,2260,2302"/><area shape="rect" id="node204" href="../../de/d8c/phys_8c.html#a126e2e13b7ac0d2c79b17ecf87129b77" title="wrapper for choosing to get state by computing it or from global array pointer assign (overrides the ..." alt="" coords="211,645,341,674"/><area shape="rect" id="node211" href="../../d3/ddc/phys_8funcdeclare_8h.html#a4ebf7765a6bde079a76719b89d3033b6" title="add in source terms to equations of motion ui and dUriemann in UEVOLVE form assume q(pr) so consisten..." alt="" coords="593,2570,655,2600"/><area shape="rect" id="node317" href="../../d0/dde/fluxctstag_8c.html#a3c59ef3a54b18bbaf4970c13995dadfc" title="wrapper for taking staggered conserved field quantity and obtaining centered field quantity upoint en..." alt="" coords="740,141,916,170"/><area shape="rect" id="node338" href="../../d1/d3e/utoprimgen_8c.html#a7e078cc9a354495bc85554d875a705d9" title="General explicit inversion of U[MHD]&#45;&gt;P[MHD] and also inverts scalars. Inverts radiation if(EOMRADTYP..." alt="" coords="1969,1521,2057,1550"/><area shape="rect" id="node5" href="../../dc/dae/flux_8c.html#a8ffa7399bd5354fdcdec5f3e1adf0b13" title="wrapper for CENT_to_FACE1,2,3 used to compute flux at face" alt="" coords="407,776,500,805"/><area shape="rect" id="node176" href="../../dc/dae/flux_8c.html#ae680339abb42df844400546501125e2c" title="fluxEM2flux4EMF" alt="" coords="391,722,516,752"/><area shape="rect" id="node178" href="../../d5/d2f/flux_8funcdeclare_8h.html#a77a38ff10f7d1d0a073866bd154c52b6" title="wrapper for: 1) interpolate FACE 2 CORN 2) loop over dimensions setting field flux dimension&#45;by&#45;dimen..." alt="" coords="763,368,893,397"/><area shape="rect" id="node7" href="../../dc/dae/flux_8c.html#aaf6d832880760f80459d91477c28b519" title="wrapper for different standard 1&#45;D flux calculators 1&#45;D interpolate and get flux for that direction (..." alt="" coords="567,776,681,805"/><area shape="rect" id="node9" href="../../dc/dae/flux_8c.html#a054658527dfb1d80226b8b2d2106aeed" title="original flux calculator that gets F in &quot;dir&quot;. At end global pleft,pright,dq also set and if STOREWAV..." alt="" coords="767,776,889,805"/><area shape="rect" id="node160" href="../../dc/dae/flux_8c.html#a2602a4dad9ed7adc944227d02435312e" title="standard (non&#45;field flux) calculation but setup to store results of interpolation so can be used for ..." alt="" coords="731,722,925,752"/><area shape="rect" id="node11" href="../../dc/dae/flux_8c.html#a2a4bea22d4d0b16aaba0d19357413e31" title="slope_lim() is provided p2interp and returns pleft/pright" alt="" coords="1257,516,1335,545"/><area shape="rect" id="node45" href="../../de/db6/wavespeeds_8c.html#ade70ed882f42b4e9e2a70916a33ab532" title="complete storage of wave speeds per dimension only called for STOREWAVESPEEDS==1" alt="" coords="975,722,1159,752"/><area shape="rect" id="node92" href="../../dc/d5e/fluxcompute_8c.html#aa195df0bf8c8fb0a14d8e27a1d3b89ff" title="actually compute the flux and ctop for dt calculation" alt="" coords="992,830,1141,860"/><area shape="rect" id="node13" href="../../d5/d2f/flux_8funcdeclare_8h.html#a8dd1a8200cac33bfd5c4520a76285d69" title="slope_lim_linetype_c2e" alt="" coords="1457,409,1615,438"/><area shape="rect" id="node15" href="../../d5/d2f/flux_8funcdeclare_8h.html#a0d50fd876f4e61d909a1e006bac28387" title="whether primreal is p2interp can&#39;t assume this is true in general (e.g." alt="" coords="1468,462,1604,492"/><area shape="rect" id="node17" href="../../d8/ddd/interppoint_8c.html#ab50c96d0a8603ec34f1c7a023a4156ff" title="interpolate from a center point to a left/right interface" alt="" coords="1719,422,1857,452"/><area shape="rect" id="node31" href="../../d8/ddd/interppoint_8c.html#a7d9885f70f6b7a32637920ddf74b0f98" title="DEVELOPING RIGHT NOW interpolate from a center point to a left/right interface." alt="" coords="1719,527,1857,574"/><area shape="rect" id="node35" href="../../d8/ddd/interppoint_8c.html#af1ea622d3759b98722d11ed0a3d555e7" title="interpolate from a center point to a left/right interface" alt="" coords="1717,830,1859,860"/><area shape="rect" id="node19" href="../../df/d30/interppoint_8para_8c.html#a6f45f925dd7972198f6ef41de42374df" title="lout/rout is left and right sides of cell note how used in step_ch.c to get appropriate interface val..." alt="" coords="1991,502,2036,532"/><area shape="rect" id="node21" href="../../df/d30/interppoint_8para_8c.html#abe1b655c3bd8c6e3ac699e6cedb03c18" title="doesn&#39;t use dq" alt="" coords="1987,342,2040,372"/><area shape="rect" id="node23" href="../../d8/ddd/interppoint_8c.html#a70f54bffe6df5f410a43980f4aa83971" title="limited slopes using 3 points Gives slope that will be assumed to be located at same location as yc –..." alt="" coords="1951,396,2076,425"/><area shape="rect" id="node25" href="../../d8/ddd/interppoint_8c.html#a9a8e95c4501b23d1a80162c3b2cee142" title="http://mesa.sourceforge.net/pdfs/suresh+huynh_97.pdf http://iopscience.iop.org/0264&#45;9381/31/1/015005/..." alt="" coords="1991,289,2036,318"/><area shape="rect" id="node29" href="../../d8/ddd/interppoint_8c.html#a75bf89b2527949948883f2089374dcf9" title="Enhanced PPM The Einstein Toolkit source code says that the relevant references are: Colella &amp; Sekora..." alt="" coords="1987,449,2040,478"/><area shape="rect" id="node27" href="../../d8/ddd/interppoint_8c.html#a5677d72681462036d6c8a6e13c1c20d9" title="if yll,yl,yc,yr,yrr are really in that order, then get lout." alt="" coords="2191,289,2263,318"/><area shape="rect" id="node33" href="../../d8/ddd/interppoint_8c.html#a367af7d2f93ccc62459fbdbacd4f62f3" title="limited 2nd derivatives using 4 points see e2c_continuous.nb" alt="" coords="1936,555,2091,602"/><area shape="rect" id="node37" href="../../df/d30/interppoint_8para_8c.html#af36824cae5f3156fa6da09c3536c7785" title="used when lim=PARAFLAT" alt="" coords="1985,1140,2041,1169"/><area shape="rect" id="node39" href="../../df/d30/interppoint_8para_8c.html#ac3af1cc044a6058812c512179cbb090a" title="Get pressure Note this is quite inefficient since operating per&#45;point get same pressure for entire li..." alt="" coords="2181,1241,2272,1270"/><area shape="rect" id="node41" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a5943065ab3d5b4e9f4f691db499b588f" title="calculates total opacity over dx[]" alt="" coords="2432,1293,2517,1322"/><area shape="rect" id="node43" href="../../d2/d72/phys_8tools_8rad_8c.html#a795959353203e99366b456b16d0d0bab" title="calculates total opacity over dx[] for given chi or chieff" alt="" coords="2672,1293,2797,1322"/><area shape="rect" id="node47" href="../../de/db6/wavespeeds_8c.html#a99d8d29de65565134c1d91007b0d12c6" title="store wavespeeds somewhere" alt="" coords="1216,724,1376,753"/><area shape="rect" id="node90" href="../../de/db6/wavespeeds_8c.html#a9adb8a9ad30e24a08285f6a4c28856ef" title="GODMARK: something wrong with comparing multiple velocities since grid/metric changes in space (i..." alt="" coords="1249,670,1343,700"/><area shape="rect" id="node49" href="../../de/d8c/phys_8c.html#af560087e095f9677ac65b1bc6b424fa9" title="wrapper for choosing to get state by computing it or from global array pointer assign (overrides the ..." alt="" coords="1689,673,1887,702"/><area shape="rect" id="node59" href="../../de/db6/wavespeeds_8c.html#add5696e20b7235a8f870dd0dffb8dc7d" title="vchar_each" alt="" coords="1492,778,1580,808"/><area shape="rect" id="node51" href="../../d7/def/phys_8tools_8c.html#a3ef47960a272ef981fd551582b610503" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="2364,958,2585,988"/><area shape="rect" id="node53" href="../../d3/ddc/phys_8funcdeclare_8h.html#a12a473e24b431762af4168179e82cd08" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="2653,984,2816,1013"/><area shape="rect" id="node55" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a8a762bf6582e6f7e1199de9c43b98454" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="2636,930,2833,960"/><area shape="rect" id="node57" href="../../d3/ddc/phys_8funcdeclare_8h.html#a41b8eacac0a4a23d6b00b670fe49629c" title="bsq_calc_fromq" alt="" coords="2677,1062,2792,1092"/><area shape="rect" id="node61" href="../../d8/d20/vchar_8c.html#acdcca98ca82b041999cdb29fdf958a22" title="Charles believed that near polar axis one should set vmax=vmin=0, but not right since makes flux comp..." alt="" coords="1761,884,1815,913"/><area shape="rect" id="node70" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a2f3df15638b9795556ef2bdf1e8c8f97" title="compute radiative characteristics as limited by opacity" alt="" coords="1749,777,1827,806"/><area shape="rect" id="node63" href="../../d8/d20/vchar_8c.html#acad033b60e7ca6404ffcd9b0fdfd13b4" title="simplefast" alt="" coords="2185,884,2268,913"/><area shape="rect" id="node72" href="../../d2/d72/phys_8tools_8rad_8c.html#a63256be4e6a63216cb736012e36a6375" title="calc_chi" alt="" coords="1979,780,2048,809"/><area shape="rect" id="node75" href="../../d2/d72/phys_8tools_8rad_8c.html#abd01208ba3c5754ea5587bcaefcaa01b" title="get lab&#45;frame 3&#45;velocity for radiative emission in radiative frame" alt="" coords="1960,726,2067,756"/><area shape="rect" id="node78" href="../../d9/de9/coord_8c.html#a0672d8c0ee4ff07c7265d0ecbc365cdc" title="normally&#45;used dxdxp[i,j,k] = dV/dX" alt="" coords="2180,572,2273,601"/><area shape="rect" id="node80" href="../../d9/de9/coord_8c.html#a64a4372100fc55abf546f02c8b779595" title="Jacobian for dx uniform per dx nonuniform (dx/dr / dx/dr&#39;) i.e." alt="" coords="2944,1233,3019,1262"/><area shape="rect" id="node82" href="../../d9/de9/coord_8c.html#a56c4b5c03b74a33a7d809daecfa6925e" title="numerical derivative of V w.r.t. X" alt="" coords="3168,1578,3288,1608"/><area shape="rect" id="node84" href="../../d9/de9/coord_8c.html#a65ad4ca9656d141cc995fd35ed31dc40" title="Returns boyer&#45;lindquist coordinte of point." alt="" coords="3407,1845,3476,1874"/><area shape="rect" id="node86" href="../../d8/d60/init_8c.html#a27c01fe4532cf3e10d467517403dbf70" title="blcoord_user" alt="" coords="3571,1818,3667,1848"/><area shape="rect" id="node88" href="../../d9/de9/coord_8c.html#af7a086e6042d598aea95c2360d07a99b" title="blcoord_singfixes" alt="" coords="3557,1872,3680,1901"/><area shape="rect" id="node94" href="../../dc/d5e/fluxcompute_8c.html#a922e55dc88348166e53d2615941564d8" title="actually compute flux from given data GODMARK: right now if splitmaem==1 assumes F is linear in FMA a..." alt="" coords="1247,1089,1345,1118"/><area shape="rect" id="node98" href="../../dc/d5e/fluxcompute_8c.html#ab088a2ff1d1132363446aab47e5c9c7b" title="P&#45;&gt;sate,flux,U." alt="" coords="1245,884,1347,913"/><area shape="rect" id="node150" href="../../dc/d5e/fluxcompute_8c.html#a9fdd8e08eb928fb500db9e2688f1475b" title="p2SFUevolveall" alt="" coords="1239,830,1353,860"/><area shape="rect" id="node154" href="../../de/db6/wavespeeds_8c.html#a269fca52bf4745f3742456843cd0c4ca" title="get wave speeds for flux calculation" alt="" coords="1236,777,1356,806"/><area shape="rect" id="node96" href="../../de/db6/wavespeeds_8c.html#a7fa9b1c8202eb413cf4a926eebec66dc" title="really HARM is currently using VERY local lax Friedrich." alt="" coords="1483,1089,1589,1118"/><area shape="rect" id="node100" href="../../de/d8c/phys_8c.html#a92cd9cc63c782c0d94699d639aa48f69" title="wrapper for choosing to get state by computing it or from global array notice that ptrgeom&#45;&gt;p inputte..." alt="" coords="1468,725,1604,754"/><area shape="rect" id="node111" href="../../d3/ddc/phys_8funcdeclare_8h.html#a19e08c0d7e5a7c9fb9d97ff5ffab053c" title="Calculate fluxes in direction dir and conserved variable U returntype==0 : flux with geometric factor..." alt="" coords="2436,2376,2513,2405"/><area shape="rect" id="node102" href="../../d7/def/phys_8tools_8c.html#adf1cf36a7c564b77dca08d26ce233df7" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="2395,852,2555,881"/><area shape="rect" id="node107" href="../../d7/def/phys_8tools_8c.html#a8db4cb0eaaedfc1b0f3d5791d5052068" title="separate function for getting primitives" alt="" coords="2677,865,2792,894"/><area shape="rect" id="node109" href="../../d7/def/phys_8tools_8c.html#ab23ee4012c46b45e96ebffcf5766b0bb" title="separate function for getting geometry" alt="" coords="2677,812,2792,841"/><area shape="rect" id="node113" href="../../d7/def/phys_8tools_8c.html#ace478826bef11e98daed7dd2ab026c93" title="matter only terms (as if B=0)" alt="" coords="2683,2242,2787,2272"/><area shape="rect" id="node133" href="../../d7/def/phys_8tools_8c.html#a3c8277899afc2a48590156971490bb79" title="radiation terms (as if rho=u=p=0)" alt="" coords="2683,2322,2787,2352"/><area shape="rect" id="node138" href="../../d7/def/phys_8tools_8c.html#a664550c21e363870d26e73f3ab5b3d3c" title="electromagnetic terms (as if rho=u=p=0)" alt="" coords="2683,2376,2787,2405"/><area shape="rect" id="node115" href="../../d7/def/phys_8tools_8c.html#a133cabc36f68eda16f9245f749c3cc38" title="flux asociated with Ynu variable" alt="" coords="2935,2269,3028,2298"/><area shape="rect" id="node117" href="../../d7/def/phys_8tools_8c.html#a787551c0e83438fe9e63ecd3d996f61a" title="massflux_calc" alt="" coords="3175,2112,3281,2141"/><area shape="rect" id="node119" href="../../d7/def/phys_8tools_8c.html#a2ef51d65728fe59168e5b705165af6d4" title="flux associated with Y_L variable" alt="" coords="2940,2061,3023,2090"/><area shape="rect" id="node122" href="../../d7/def/phys_8tools_8c.html#a1e1dcf1d515232206c829a33d7e1192b" title="flux associated with Y_fl variable" alt="" coords="2937,2322,3025,2352"/><area shape="rect" id="node125" href="../../d7/def/phys_8tools_8c.html#a5717fa95303172fb697892a9232f0546" title="flux of specific entropy" alt="" coords="2923,2216,3040,2245"/><area shape="rect" id="node127" href="../../d7/def/phys_8tools_8c.html#a4886704a6724ea65ccaae2277b6ded74" title="MHD stress tensor, with first index up, second index down mhd^dir_j understood that mhddiagpress only..." alt="" coords="2931,2429,3032,2458"/><area shape="rect" id="node129" href="../../d7/def/phys_8tools_8c.html#ab3fd971df8ad09cce2462e78d7735f33" title="MHD stress tensor, with first index up, second index down." alt="" coords="3169,2429,3287,2458"/><area shape="rect" id="node131" href="../../d7/def/phys_8tools_8c.html#a44930b5d598885afcb717a270f42749f" title="MHD stress tensor, with first index up, second index down avoids catastrophic cancellation with rest&#45;..." alt="" coords="3139,2482,3317,2512"/><area shape="rect" id="node136" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a389bf7e41d2fd117af996e3392067cdc" title="compute radiation stres&#45;energy tensor assuming M1 closure" alt="" coords="3177,2536,3279,2565"/><area shape="rect" id="node140" href="../../d7/def/phys_8tools_8c.html#a3552b97ec9f1982094fbc3e3f9af7f05" title="MHD stress tensor, with first index up, second index down mhd^dir_j." alt="" coords="2931,2741,3032,2770"/><area shape="rect" id="node146" href="../../d7/def/phys_8tools_8c.html#a12b4ca77ffbef030f608b079327b4eb7" title="spatial part of dualfaraday" alt="" coords="2903,2376,3060,2405"/><area shape="rect" id="node142" href="../../d7/def/phys_8tools_8c.html#a3f6e052b84282b8db7b05a0acc435622" title="EM part of stress&#45;energy tensor." alt="" coords="3169,2637,3287,2666"/><area shape="rect" id="node144" href="../../d7/def/phys_8tools_8c.html#a864ca09eade159d4c4b545593c1095de" title="MHD stress tensor, with first index up, second index down avoids catastrophic cancellation with rest&#45;..." alt="" coords="3149,2690,3307,2720"/><area shape="rect" id="node148" href="../../d7/def/phys_8tools_8c.html#abc846df49f33c007310b52240e099e3b" title="Notation for HARM paper and JCM&#39;s GRFFE paper is that: B^ = &#160;*F^{} and for lab&#45;frame we chose ={&#45;1..." alt="" coords="3160,2376,3296,2405"/><area shape="rect" id="node162" href="../../dc/dae/flux_8c.html#aef355ccd1ca2295b84ad2fe1fc011d35" title="normal interpolation of CENT quantities to FACE quantities sets global variables pl_ct and pr_ct to p..." alt="" coords="977,429,1156,458"/><area shape="rect" id="node164" href="../../dc/dae/flux_8c.html#a26e710fdb46e850254a41503d339720d" title="slope_lim_cent2face() is provided p2interp and returns pleft/pright gets interpolations in expanded r..." alt="" coords="1225,462,1367,492"/><area shape="rect" id="node168" href="../../d4/dad/bounds_8funcdeclare_8h.html#addca75a18cc861326a321565a2e81aa0" title="normal bounding of non&#45;staggered primitives" alt="" coords="1492,228,1580,257"/><area shape="rect" id="node170" href="../../d4/dad/bounds_8funcdeclare_8h.html#adbe0e3ba8a74f09ab928a96bd68cab6d" title="bound any prim type CALLS directly real and MPI boundary functions pstag = pstagglobal ucons = unewgl..." alt="" coords="1733,185,1843,214"/><area shape="rect" id="node172" href="../../de/d51/bounds_8c.html#a4bc7413b2cdb89e070f38bbb689ae555" title="bound_prim_user_dir" alt="" coords="1943,185,2084,214"/><area shape="rect" id="node180" href="../../d0/dde/fluxctstag_8c.html#a985ee116306b4011810334ae93900493" title="INPUTS: Nvec, pr, primface_l[dir], primface_r[dir] OUTPUTS: pbcorn[dir][side], pvcorn[dir][side][side..." alt="" coords="977,482,1156,512"/><area shape="rect" id="node188" href="../../d0/dde/fluxctstag_8c.html#a2dd789bf1402bef72523cdb69e85806e" title="use global pbcorninterp and pvcorninterp at CORN1,2,3 to obtain EMFs at CORN1,2,3 NO interpolation of..." alt="" coords="1001,194,1132,240"/><area shape="rect" id="node182" href="../../d0/dde/fluxctstag_8c.html#ad6aa918442f7768dff3c099ba353ee64" title="slope_lim_face2corn() is provided p2interp and returns pleft/pright differs from slope_lim() by range..." alt="" coords="1225,409,1367,438"/><area shape="rect" id="node206" href="../../d7/def/phys_8tools_8c.html#a39e973bfdc6ccf9e82b33925e073fca3" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="2397,905,2552,934"/><area shape="rect" id="node213" href="../../de/d8c/phys_8c.html#a44693eac289e90fab8a6792e6e9fb02c" title="source_conn" alt="" coords="1965,2570,2061,2600"/><area shape="rect" id="node225" href="../../d3/ddc/phys_8funcdeclare_8h.html#a9ffbdaa97489ef748af456f65c779e18" title="Ugeomfree and dUother are in UNOTHING form (or UEVOLVE without geometry) pf might be modified so bett..." alt="" coords="775,2441,881,2470"/><area shape="rect" id="node215" href="../../d7/def/phys_8tools_8c.html#a12238eba5936209a397a23dd34724ec9" title="returns entire space&#45;time(NDIM in size) / EOM(NPR in size) matrix" alt="" coords="2179,2478,2275,2508"/><area shape="rect" id="node218" href="../../d7/def/phys_8tools_8c.html#acee98fab974682bc6838e2040bed0d45" title="MHD stress tensor, with first index up, second index down mhd^dir_j." alt="" coords="2188,2610,2265,2640"/><area shape="rect" id="node220" href="../../d7/def/phys_8tools_8c.html#adeb9f0f94ef0d4f02ddd49a3de4de7e3" title="MHD stress tensor, with first index up, second index down avoids catastrophic cancellation with rest&#45;..." alt="" coords="2659,2689,2811,2718"/><area shape="rect" id="node227" href="../../d2/d72/phys_8tools_8rad_8c.html#aa8c5c0d5de580899948f9f22e10aff23" title="General radiation source term calculation (EXTERNALLY called) NOTE: source_explicit() takes as first ..." alt="" coords="1007,2376,1127,2405"/><area shape="rect" id="node315" href="../../d5/de1/global_8inits_8h.html#aeb307be7cd4b2a4520d60cdb2510c1ce" title="coolfunc_user" alt="" coords="1016,2441,1117,2470"/><area shape="rect" id="node229" href="../../d2/d72/phys_8tools_8rad_8c.html#a675bb3f12a77c62cf2540bc42c4867f8" title="wrapper for mode method" alt="" coords="1212,2362,1380,2392"/><area shape="rect" id="node231" href="../../d9/de9/coord_8c.html#a96290375e27d5d0aa4d843b07e228e14" title="normally&#45;used bl_coord[i,j,k] {i,j,k} &#45;&gt; V only" alt="" coords="3183,2165,3273,2194"/><area shape="rect" id="node236" href="../../d2/d72/phys_8tools_8rad_8c.html#a17aede36203a236390363af78d3a86f0" title="compute changes to U (both T and R) using implicit method KORALTODO: If doing implicit, should also add geometry source term that can sometimes be stiff." alt="" coords="1432,1892,1640,1921"/><area shape="rect" id="node309" href="../../d1/d3e/utoprimgen_8c.html#a7d31362f91cd4ec3b92e15dd6bcb3908" title="includerad=1: account for fact that not only assume MHD flow is cold itself, but energy&#45;force balance..." alt="" coords="1496,2466,1576,2496"/><area shape="rect" id="node313" href="../../de/d95/fixup_8c.html#a43fb15d762b67f635ac6c63a158bf558" title="record who called the diag_fixup routine" alt="" coords="1477,2362,1595,2392"/><area shape="rect" id="node233" href="../../d9/de9/coord_8c.html#a041e7b005310415c97d90f4b8521ed1a" title="get X(i,j,k) CENT is default position in degenerate cases" alt="" coords="3415,2165,3468,2194"/><area shape="rect" id="node238" href="../../d2/d72/phys_8tools_8rad_8c.html#a5dcc789108ddf06ec44fb22770f18e90" title="compute dt for this sub&#45;step" alt="" coords="1743,1944,1833,1973"/><area shape="rect" id="node241" href="../../d2/d72/phys_8tools_8rad_8c.html#af46d2b1cf89a70a7e2ef503146c649a9" title="uu0 &#45; original cons." alt="" coords="1976,1846,2051,1876"/><area shape="rect" id="node281" href="../../d1/d3e/utoprimgen_8c.html#abfc42de6975dd4ff02f2748404e10911" title="perform U&#45;&gt;p inversion on advected scalars" alt="" coords="2172,1702,2281,1732"/><area shape="rect" id="node283" href="../../d3/ddc/phys_8funcdeclare_8h.html#aae6a7d24b984236dae44b1a3e8ee37b6" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="2400,2196,2549,2225"/><area shape="rect" id="node285" href="../../d7/def/phys_8tools_8c.html#ad54ad99ee062beaf43518d6e9afae0a7" title="primtoflux_nonradonly" alt="" coords="2400,2089,2549,2118"/><area shape="rect" id="node295" href="../../d1/d3e/utoprimgen_8c.html#a1118806d01e553c38ae5cf5f036f9f2e" title="perform U&#45;&gt;p inversion on advected scalars" alt="" coords="2172,1756,2281,1785"/><area shape="rect" id="node300" href="../../d2/d72/phys_8tools_8rad_8c.html#afa73a2caa3209e565a64f92447058507" title="calculating approximate Jacobian: dUresid(dUrad,G(Urad))/dUrad = dy(x)/dx then compute inverse Jacobi..." alt="" coords="1736,1840,1840,1869"/><area shape="rect" id="node244" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a0a9afe086334630c217cca3b3dbf7f7d" title="get 4&#45;force for all pl&#39;s" alt="" coords="2151,1910,2303,1940"/><area shape="rect" id="node273" href="../../d2/d72/phys_8tools_8rad_8c.html#a0a4c88ebd712c11eee70dda4d75288cf" title="setgasinversionstuff" alt="" coords="2157,2014,2296,2044"/><area shape="rect" id="node276" href="../../d3/ddc/phys_8funcdeclare_8h.html#a3c69b676adf3024cd6ae832094d91fab" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="2400,1545,2549,1574"/><area shape="rect" id="node289" href="../../d3/ddc/phys_8funcdeclare_8h.html#a07847bede2b7ba9d0aabaea82f17f989" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="2412,1492,2537,1521"/><area shape="rect" id="node292" href="../../d7/def/phys_8tools_8c.html#a764e6f682011d16faec0f9b71eb360d2" title="primtoflux_radonly" alt="" coords="2411,1913,2539,1942"/><area shape="rect" id="node298" href="../../d2/d72/phys_8tools_8rad_8c.html#ae83fc4364d7c6bc0b717418cd5345297" title="calc_approx_ratchangeRtt" alt="" coords="2140,2068,2313,2097"/><area shape="rect" id="node247" href="../../d2/d72/phys_8tools_8rad_8c.html#aaa32f967773a287ecb6647732157606f" title="get G_" alt="" coords="2440,2142,2509,2172"/><area shape="rect" id="node249" href="../../d2/d72/phys_8tools_8rad_8c.html#ab62b07a8cbcc04f20c05a468ad6de636" title="compute G^ 4&#45;force" alt="" coords="2700,2609,2769,2638"/><area shape="rect" id="node251" href="../../df/d21/global_8funcdeclare_8rad_8h.html#aba8efc1e2ea7a31f67bb6c06ce3c164a" title="mhdfull_calc_rad" alt="" coords="2921,2584,3041,2613"/><area shape="rect" id="node254" href="../../df/d21/global_8funcdeclare_8rad_8h.html#af8e0b77aba8b494909392ceca6f551a0" title="get {abs} and {es} in /mass * rho = 1/cm form." alt="" coords="2883,2794,3080,2824"/><area shape="rect" id="node271" href="../../d8/d60/init_8c.html#a9118b79d84fe3dccfed3b28ee0fd84b5" title="Gcompt" alt="" coords="2948,2637,3015,2666"/><area shape="rect" id="node256" href="../../d2/d72/phys_8tools_8rad_8c.html#a864793af319e70c0d099679fa81dd398" title="compute Trad (also computed directly in calc_Gu() above) using only primitives (not using conserved q..." alt="" coords="3128,2901,3328,2930"/><area shape="rect" id="node263" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a7dc2e853cec9b6f9a5e83ce23c468d03" title="nrad(T) = nrad=arad T^3/2.70118 (this is LTE only if put in T was gas T)" alt="" coords="3555,2768,3683,2797"/><area shape="rect" id="node266" href="../../df/d21/global_8funcdeclare_8rad_8h.html#ab4537b80f4788d1a81759b595c8441a9" title="kappa_func_fits_all" alt="" coords="3161,2848,3295,2877"/><area shape="rect" id="node268" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a0fb687f68b97453843fc3c085f05f1b4" title="E=urad=arad T^4 (this is LTE only if put in T was gas T)" alt="" coords="3165,2794,3291,2824"/><area shape="rect" id="node258" href="../../df/d21/global_8funcdeclare_8rad_8h.html#af07558357c906b4dfa61cd34656d9f02" title="E=urad=arad T^4 and just solve for T (this is LTE only if assume resulting T is gas T)..." alt="" coords="3556,2846,3681,2876"/><area shape="rect" id="node260" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a3e47afcfc5c42719999d851395fd032d" title="nrad(E)" alt="" coords="3377,2794,3505,2824"/><area shape="rect" id="node319" href="../../d0/dde/fluxctstag_8c.html#a6cd90dff56319085b32bc57c0c8b3cfd" title="this function called in initbase.c and during advance() here ustag is point value if dimension doesn&#39;..." alt="" coords="1007,88,1127,117"/><area shape="rect" id="node324" href="../../d0/dde/fluxctstag_8c.html#a5e3dcbe89d6f8a9384cafb58afd7dbf4" title="interpolates field at FACE to field at CENT assuming field along itself is continuous" alt="" coords="1007,331,1127,378"/><area shape="rect" id="node332" href="../../d4/dad/bounds_8funcdeclare_8h.html#a6f4b963a50a7288964f01775f2f18bb9" title="normal bounding of staggered primitives" alt="" coords="1019,141,1115,170"/><area shape="rect" id="node321" href="../../d0/dde/fluxctstag_8c.html#aa0b35fa62bf99b1fb71d2318548fcac4" title="U staggered field to P staggered field OPTMARK: presume this function gets inlined." alt="" coords="1249,97,1343,126"/><area shape="rect" id="node326" href="../../d0/dde/fluxctstag_8c.html#aaec26a518629175ecceefbaf6c84225e" title="wrapper for continuous interpolation for FACE_to_CENT" alt="" coords="1209,356,1383,385"/><area shape="rect" id="node334" href="../../d4/dad/bounds_8funcdeclare_8h.html#abdea68b778dc9253324da69d3c376965" title="bound any pstag type CALLS directly real and MPI boundary functions pstag is at FACE1,2,3 for fields, so user bound is different MPI bounding is the same as CENT quantities used when restarting in initbase.c to bound unewglobal for FLUXB==FLUXCTSTAG" alt="" coords="1237,150,1355,180"/><area shape="rect" id="node336" href="../../de/d51/bounds_8c.html#a3246b706b24adb6265016a8954807f6f" title="assume single user function takes care of primitive locations" alt="" coords="1461,150,1611,180"/><area shape="rect" id="node340" href="../../d1/d3e/utoprimgen_8c.html#a0a83e9e7fdd3cc595c5b8d0df88ec684" title="just picks the algorithm to invert" alt="" coords="2167,1649,2287,1678"/><area shape="rect" id="node342" href="../../d1/dde/utoprim__jon_8c.html#a2c450f7c2c86203afc48f0a40c665d38" title="The ONLY global function:" alt="" coords="2387,1648,2563,1695"/><area shape="rect" id="node347" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a9fe58e7f372421d18633c8fc5007b815" title="u2p_rad" alt="" coords="2441,1860,2508,1889"/><area shape="rect" id="node349" href="../../d2/d72/phys_8tools_8rad_8c.html#a67b370af2fa58283bc590ff4e895fb90" title="Like u2p_rad_orig(), but uses Jon&#39;s paper draft ZAMO RAD version." alt="" coords="2685,1878,2784,1908"/><area shape="rect" id="node351" href="../../d2/d72/phys_8tools_8rad_8c.html#a77c546a7fb064266fef5a9e796dc63dc" title="compute ZAMO version of radiation quantities as in paper draft" alt="" coords="2908,1905,3055,1934"/><area shape="rect" id="node353" href="../../d3/ddc/phys_8funcdeclare_8h.html#abfae38e47b0bd05a4fc38302ff948a96" title="find gamma&#45;factor wrt normal observer This function and qsq_calc() have about the same cache miss amo..." alt="" coords="2896,1852,3067,1881"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a080ef26ac144e3416a4c5a0ccc1f1e9b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> fractional_diff </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the fractional difference between a &amp; b. </p>

<p>Definition at line <a class="el" href="../../df/d22/advance_8c_source.html#l03100">3100</a> of file <a class="el" href="../../df/d22/advance_8c_source.html">advance.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d22/advance_8c_a080ef26ac144e3416a4c5a0ccc1f1e9b_icgraph.png" border="0" usemap="#df/d22/advance_8c_a080ef26ac144e3416a4c5a0ccc1f1e9b_icgraph" alt=""/></div>
<map name="df/d22/advance_8c_a080ef26ac144e3416a4c5a0ccc1f1e9b_icgraph" id="df/d22/advance_8c_a080ef26ac144e3416a4c5a0ccc1f1e9b_icgraph">
<area shape="rect" id="node3" href="../../df/d22/advance_8c.html#a0936d88b132d9655aa9287035a4793c5" title="If density or gamma&#45;factors are different by more than fractional_difference_threshold for states pin..." alt="" coords="156,5,297,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0936d88b132d9655aa9287035a4793c5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> limit_prim_correction </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td>
          <td class="paramname"><em>fractional_difference_threshold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>geom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>If density or gamma-factors are different by more than fractional_difference_threshold for states pin &amp; pout, if different &ndash; correct pout such that it is not more than fractional_difference_threshold away from pin. </p>
<p>externally referenced </p>

<p>Definition at line <a class="el" href="../../df/d22/advance_8c_source.html#l03023">3023</a> of file <a class="el" href="../../df/d22/advance_8c_source.html">advance.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d22/advance_8c_a0936d88b132d9655aa9287035a4793c5_cgraph.png" border="0" usemap="#df/d22/advance_8c_a0936d88b132d9655aa9287035a4793c5_cgraph" alt=""/></div>
<map name="df/d22/advance_8c_a0936d88b132d9655aa9287035a4793c5_cgraph" id="df/d22/advance_8c_a0936d88b132d9655aa9287035a4793c5_cgraph">
<area shape="rect" id="node3" href="../../d3/ddc/phys_8funcdeclare_8h.html#a11e17cd8b0594d1ad52e3594aa9f477e" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="211,59,285,88"/><area shape="rect" id="node11" href="../../df/d22/advance_8c.html#a080ef26ac144e3416a4c5a0ccc1f1e9b" title="Returns the fractional difference between a &amp; b." alt="" coords="199,112,297,141"/><area shape="rect" id="node5" href="../../d3/ddc/phys_8funcdeclare_8h.html#a12a473e24b431762af4168179e82cd08" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="365,5,528,35"/><area shape="rect" id="node7" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a8a762bf6582e6f7e1199de9c43b98454" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="348,59,545,88"/><area shape="rect" id="node9" href="../../d3/ddc/phys_8funcdeclare_8h.html#a41b8eacac0a4a23d6b00b670fe49629c" title="bsq_calc_fromq" alt="" coords="389,112,504,141"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri May 20 2016 15:52:35 for HARM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.3.1
</small></address>
</body>
</html>
