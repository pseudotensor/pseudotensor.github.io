<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>HARM: global.funcdeclare.rad.h File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">HARM
   </div>
   <div id="projectbrief">harm and utilities</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">global.funcdeclare.rad.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Function declarations (used globally) from RADIATION parts of code.  
<a href="#details">More...</a></p>
<div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d9e/global_8funcdeclare_8rad_8h__dep__incl.png" border="0" usemap="#global_8funcdeclare_8rad_8hdep" alt=""/></div>
<map name="global_8funcdeclare_8rad_8hdep" id="global_8funcdeclare_8rad_8hdep">
<area shape="rect" id="node3" href="../../d8/df4/global_8funcdeclare_8h.html" title="Function declarations (used globally) by entire code." alt="" coords="41,83,180,112"/><area shape="rect" id="node5" href="../../d3/d67/global_8general_8h.html" title="General code definitions with specific order from independent to dependent definitions." alt="" coords="55,160,167,189"/><area shape="rect" id="node7" href="../../d0/dcc/global_8grmhd_8h.html" title="Wrapper and Comments on comments." alt="" coords="57,237,164,267"/><area shape="rect" id="node9" href="../../d4/dda/defs_8grmhd_8h.html" title="Wrapper." alt="" coords="5,315,104,344"/><area shape="rect" id="node11" href="../../d8/d2e/u2p__util_8c.html" title="U&#45;&gt;P inversion functions used by all utoprim files." alt="" coords="128,315,205,344"/><area shape="rect" id="node13" href="../../d1/dde/utoprim__jon_8c.html" title="Jon&#39;s U&#45;&gt;P inversion." alt="" coords="117,392,216,421"/></map>
</div>
</div>
<p><a href="../../df/d21/global_8funcdeclare_8rad_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aba8efc1e2ea7a31f67bb6c06ce3c164a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d21/global_8funcdeclare_8rad_8h.html#aba8efc1e2ea7a31f67bb6c06ce3c164a">mhdfull_calc_rad</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *<a class="el" href="../../dc/dd2/newcodediff_8txt.html#ae7ab77d7e616dc02fba121a009b48c27">pr</a>, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *ptrgeom, struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *q, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*radstressdir)[<a class="el" href="../../de/d10/global_8nondepmnemonics_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>])</td></tr>
<tr class="separator:aba8efc1e2ea7a31f67bb6c06ce3c164a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a389bf7e41d2fd117af996e3392067cdc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a389bf7e41d2fd117af996e3392067cdc">mhd_calc_rad</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *<a class="el" href="../../dc/dd2/newcodediff_8txt.html#ae7ab77d7e616dc02fba121a009b48c27">pr</a>, int dir, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *geom, struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *q, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *radstressdir, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *radstressdirabs)</td></tr>
<tr class="memdesc:a389bf7e41d2fd117af996e3392067cdc"><td class="mdescLeft">&#160;</td><td class="mdescRight">compute radiation stres-energy tensor assuming M1 closure  <a href="#a389bf7e41d2fd117af996e3392067cdc">More...</a><br/></td></tr>
<tr class="separator:a389bf7e41d2fd117af996e3392067cdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5672d3575bbbb87acb183714955fb7b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d21/global_8funcdeclare_8rad_8h.html#ae5672d3575bbbb87acb183714955fb7b">my_min</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> <a class="el" href="../../d8/d5b/defs_8general_8h.html#aa73cf2d397cae726436e08d2c891bdb0">a</a>, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> b)</td></tr>
<tr class="separator:ae5672d3575bbbb87acb183714955fb7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a267140b3112324c12f7ac5ce328da64a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a267140b3112324c12f7ac5ce328da64a">my_sign</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> x)</td></tr>
<tr class="separator:a267140b3112324c12f7ac5ce328da64a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05abe9d4076eaff42edb288900c53309"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a05abe9d4076eaff42edb288900c53309">calc_Rij</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *pp, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> Rij[][4])</td></tr>
<tr class="separator:a05abe9d4076eaff42edb288900c53309"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a9afe086334630c217cca3b3dbf7f7d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a0a9afe086334630c217cca3b3dbf7f7d">koral_source_rad_calc</a> (int computestate, int computeentropy, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *<a class="el" href="../../dc/dd2/newcodediff_8txt.html#ae7ab77d7e616dc02fba121a009b48c27">pr</a>, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *ptrgeom, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *Gdpl, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *Gdabspl, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *chi, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *Tgas, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *Trad, struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *q)</td></tr>
<tr class="memdesc:a0a9afe086334630c217cca3b3dbf7f7d"><td class="mdescLeft">&#160;</td><td class="mdescRight">get 4-force for all pl's  <a href="#a0a9afe086334630c217cca3b3dbf7f7d">More...</a><br/></td></tr>
<tr class="separator:a0a9afe086334630c217cca3b3dbf7f7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa305b4ec3db7dc78a29d7694462e911d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d21/global_8funcdeclare_8rad_8h.html#aa305b4ec3db7dc78a29d7694462e911d">calc_rad_lambda</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *pp, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *ptrgeom, struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *q, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> Tgas, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *lambda, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *nlambda, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *kappaemit, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *kappanemit)</td></tr>
<tr class="separator:aa305b4ec3db7dc78a29d7694462e911d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8e0b77aba8b494909392ceca6f551a0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d21/global_8funcdeclare_8rad_8h.html#af8e0b77aba8b494909392ceca6f551a0">calc_Tandopacityandemission</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *<a class="el" href="../../dc/dd2/newcodediff_8txt.html#ae7ab77d7e616dc02fba121a009b48c27">pr</a>, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *ptrgeom, struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *q, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> Ruu, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> gammaradgas, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> B, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *Tgas, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *Tradff, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *nradff, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *expfactorff, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *kappa, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *kappan, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *kappaemit, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *kappanemit, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *kappaes, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *lambda, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *nlambda)</td></tr>
<tr class="memdesc:af8e0b77aba8b494909392ceca6f551a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">get {abs} and {es} in /mass * rho = 1/cm form.  <a href="#af8e0b77aba8b494909392ceca6f551a0">More...</a><br/></td></tr>
<tr class="separator:af8e0b77aba8b494909392ceca6f551a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af50896d039d660550b738862b3390b07"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d21/global_8funcdeclare_8rad_8h.html#af50896d039d660550b738862b3390b07">prad_fforlab</a> (int *whichvel, int *<a class="el" href="../../dc/dd2/newcodediff_8txt.html#ab29c7802084b56a574b83eb818d2fdda">whichcoord</a>, int whichdir, int <a class="el" href="../../d0/d10/datadesc_8txt.html#ad21ff679aac3fe28202c6d592eafd3e6">i</a>, int <a class="el" href="../../d0/d10/datadesc_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>, int k, int loc, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *ptrgeom, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *pradffortho, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *pin, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *pout)</td></tr>
<tr class="memdesc:af50896d039d660550b738862b3390b07"><td class="mdescLeft">&#160;</td><td class="mdescRight">radiative ortonormal ff primitives (E,F^i) &lt;-&gt; primitives in lab frame Used only for initial conditions whichvel: input vel type for U1-U3 whichcoord: input coord type for both U1-U3 and URAD1-URAD3 whichdir: LAB2FF or FF2LAB .  <a href="#af50896d039d660550b738862b3390b07">More...</a><br/></td></tr>
<tr class="separator:af50896d039d660550b738862b3390b07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1313c275fb108d10f866373d9bb227a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d21/global_8funcdeclare_8rad_8h.html#ad1313c275fb108d10f866373d9bb227a">prad_labtoff</a> (int *whichvel, int *<a class="el" href="../../dc/dd2/newcodediff_8txt.html#ab29c7802084b56a574b83eb818d2fdda">whichcoord</a>, int <a class="el" href="../../d0/d10/datadesc_8txt.html#ad21ff679aac3fe28202c6d592eafd3e6">i</a>, int <a class="el" href="../../d0/d10/datadesc_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>, int k, int loc, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *ptrgeom, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *pradffortho, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *pin, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *pout)</td></tr>
<tr class="memdesc:ad1313c275fb108d10f866373d9bb227a"><td class="mdescLeft">&#160;</td><td class="mdescRight">like <a class="el" href="../../df/d21/global_8funcdeclare_8rad_8h.html#af50896d039d660550b738862b3390b07" title="radiative ortonormal ff primitives (E,F^i) &lt;-&gt; primitives in lab frame Used only for initial conditio...">prad_fforlab()</a> but for only whichdir=LAB2FF used for dumps or diags  <a href="#ad1313c275fb108d10f866373d9bb227a">More...</a><br/></td></tr>
<tr class="separator:ad1313c275fb108d10f866373d9bb227a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ec6ee79c76351868a725b22dac62135"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a2ec6ee79c76351868a725b22dac62135">prad_fftolab</a> (int *whichvel, int *<a class="el" href="../../dc/dd2/newcodediff_8txt.html#ab29c7802084b56a574b83eb818d2fdda">whichcoord</a>, int <a class="el" href="../../d0/d10/datadesc_8txt.html#ad21ff679aac3fe28202c6d592eafd3e6">i</a>, int <a class="el" href="../../d0/d10/datadesc_8txt.html#a89e3d6451dccc75ffa4e5f4e6e774b69">j</a>, int k, int loc, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *ptrgeom, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *pradffortho, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *pin, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *pout)</td></tr>
<tr class="memdesc:a2ec6ee79c76351868a725b22dac62135"><td class="mdescLeft">&#160;</td><td class="mdescRight">like <a class="el" href="../../df/d21/global_8funcdeclare_8rad_8h.html#af50896d039d660550b738862b3390b07" title="radiative ortonormal ff primitives (E,F^i) &lt;-&gt; primitives in lab frame Used only for initial conditio...">prad_fforlab()</a> but for only whichdir=FF2LAB used for IC  <a href="#a2ec6ee79c76351868a725b22dac62135">More...</a><br/></td></tr>
<tr class="separator:a2ec6ee79c76351868a725b22dac62135"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64226cb28f52020ffe18ac6c6b1a2f5c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a64226cb28f52020ffe18ac6c6b1a2f5c">whichfluid_ffrad_to_primeall</a> (int *whichvel, int *whichcoordfluid, int *whichcoordrad, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *ptrgeomprimecoords, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *pradffortho, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *pin, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *pout)</td></tr>
<tr class="memdesc:a64226cb28f52020ffe18ac6c6b1a2f5c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Input: start with pin [with fluid in whichvel velocity and whichcoordfluid coordinates (PRIMECOORDS or MCOORD) and radiation as E,F in fluid frame orthonormal basis in whichcoordrad coordinates] Output: pout [with all WHICHVEL PRIMECOORDS and radiation using velocity primitive].  <a href="#a64226cb28f52020ffe18ac6c6b1a2f5c">More...</a><br/></td></tr>
<tr class="separator:a64226cb28f52020ffe18ac6c6b1a2f5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa25aa4dfb3559619f276abca5f4b3ca0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d21/global_8funcdeclare_8rad_8h.html#aa25aa4dfb3559619f276abca5f4b3ca0">primefluid_EVrad_to_primeall</a> (int *whichvel, int *<a class="el" href="../../dc/dd2/newcodediff_8txt.html#ab29c7802084b56a574b83eb818d2fdda">whichcoord</a>, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *ptrgeom, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *pin, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *pout)</td></tr>
<tr class="memdesc:aa25aa4dfb3559619f276abca5f4b3ca0"><td class="mdescLeft">&#160;</td><td class="mdescRight">for BCs, to take E[radiation frame] and u^i as radiation primitives in whichvel/whichcoord obtains WHICHVEL/PRIMECOORD primitives  <a href="#aa25aa4dfb3559619f276abca5f4b3ca0">More...</a><br/></td></tr>
<tr class="separator:aa25aa4dfb3559619f276abca5f4b3ca0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fe58e7f372421d18633c8fc5007b815"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a9fe58e7f372421d18633c8fc5007b815">u2p_rad</a> (int showmessages, int allowlocalfailurefixandnoreport, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> gammamaxrad, int whichcap, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *uu, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *pp, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *ptrgeom, <a class="el" href="../../d1/de6/global_8depmnemonics_8h.html#a9377001671b5ece8bb2a2cf636de4b8a">PFTYPE</a> *lpflag, <a class="el" href="../../d1/de6/global_8depmnemonics_8h.html#a9377001671b5ece8bb2a2cf636de4b8a">PFTYPE</a> *lpflagrad)</td></tr>
<tr class="separator:a9fe58e7f372421d18633c8fc5007b815"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a762bf6582e6f7e1199de9c43b98454"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a8a762bf6582e6f7e1199de9c43b98454">get_state_uradconuradcovonly</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *<a class="el" href="../../dc/dd2/newcodediff_8txt.html#ae7ab77d7e616dc02fba121a009b48c27">pr</a>, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *ptrgeom, struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *q)</td></tr>
<tr class="memdesc:a8a762bf6582e6f7e1199de9c43b98454"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get only u^ and u_ assumine b^ and b_ not used.  <a href="#a8a762bf6582e6f7e1199de9c43b98454">More...</a><br/></td></tr>
<tr class="separator:a8a762bf6582e6f7e1199de9c43b98454"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f3df15638b9795556ef2bdf1e8c8f97"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a2f3df15638b9795556ef2bdf1e8c8f97">vchar_rad</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *<a class="el" href="../../dc/dd2/newcodediff_8txt.html#ae7ab77d7e616dc02fba121a009b48c27">pr</a>, struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *q, int dir, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *geom, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *cmax, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *cmin, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *cmax2, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *cmin2, int *ignorecourant)</td></tr>
<tr class="memdesc:a2f3df15638b9795556ef2bdf1e8c8f97"><td class="mdescLeft">&#160;</td><td class="mdescRight">compute radiative characteristics as limited by opacity  <a href="#a2f3df15638b9795556ef2bdf1e8c8f97">More...</a><br/></td></tr>
<tr class="separator:a2f3df15638b9795556ef2bdf1e8c8f97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4537b80f4788d1a81759b595c8441a9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d21/global_8funcdeclare_8rad_8h.html#ab4537b80f4788d1a81759b595c8441a9">kappa_func_fits_all</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> rho, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> B, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> Tg, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> Tr, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> varexpf, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *kappa, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *kappaemit, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *kappan, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *kappanemit, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *kappaes)</td></tr>
<tr class="separator:ab4537b80f4788d1a81759b595c8441a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6748b88a3ad397cb35b4d60c108508d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d21/global_8funcdeclare_8rad_8h.html#ad6748b88a3ad397cb35b4d60c108508d">calcfull_tautot</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *pp, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *ptrgeom, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *tautot, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *tautotmax)</td></tr>
<tr class="separator:ad6748b88a3ad397cb35b4d60c108508d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5943065ab3d5b4e9f4f691db499b588f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a5943065ab3d5b4e9f4f691db499b588f">calc_tautot</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *pp, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *ptrgeom, struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *q, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *tautot, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *tautotmax)</td></tr>
<tr class="memdesc:a5943065ab3d5b4e9f4f691db499b588f"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculates total opacity over dx[]  <a href="#a5943065ab3d5b4e9f4f691db499b588f">More...</a><br/></td></tr>
<tr class="separator:a5943065ab3d5b4e9f4f691db499b588f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7dc2e853cec9b6f9a5e83ce23c468d03"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a7dc2e853cec9b6f9a5e83ce23c468d03">calc_LTE_NfromT</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> T)</td></tr>
<tr class="memdesc:a7dc2e853cec9b6f9a5e83ce23c468d03"><td class="mdescLeft">&#160;</td><td class="mdescRight">nrad(T) = nrad=arad T^3/2.70118 (this is LTE only if put in T was gas T)  <a href="#a7dc2e853cec9b6f9a5e83ce23c468d03">More...</a><br/></td></tr>
<tr class="separator:a7dc2e853cec9b6f9a5e83ce23c468d03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e47afcfc5c42719999d851395fd032d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a3e47afcfc5c42719999d851395fd032d">calc_LTE_NfromE</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> <a class="el" href="../../dc/d88/init_8koral_8c.html#a07484107e6d9fdf38b53edf631d6511d">E</a>)</td></tr>
<tr class="memdesc:a3e47afcfc5c42719999d851395fd032d"><td class="mdescLeft">&#160;</td><td class="mdescRight">nrad(E)  <a href="#a3e47afcfc5c42719999d851395fd032d">More...</a><br/></td></tr>
<tr class="separator:a3e47afcfc5c42719999d851395fd032d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fb687f68b97453843fc3c085f05f1b4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a0fb687f68b97453843fc3c085f05f1b4">calc_LTE_EfromT</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>)</td></tr>
<tr class="memdesc:a0fb687f68b97453843fc3c085f05f1b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">E=urad=arad T^4 (this is LTE only if put in T was gas T)  <a href="#a0fb687f68b97453843fc3c085f05f1b4">More...</a><br/></td></tr>
<tr class="separator:a0fb687f68b97453843fc3c085f05f1b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af07558357c906b4dfa61cd34656d9f02"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d21/global_8funcdeclare_8rad_8h.html#af07558357c906b4dfa61cd34656d9f02">calc_LTE_TfromE</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>)</td></tr>
<tr class="memdesc:af07558357c906b4dfa61cd34656d9f02"><td class="mdescLeft">&#160;</td><td class="mdescRight">E=urad=arad T^4 and just solve for T (this is LTE only if assume resulting T is gas T). If put in fluid-frame E, then correct T for radiation in fluid frame.  <a href="#af07558357c906b4dfa61cd34656d9f02">More...</a><br/></td></tr>
<tr class="separator:af07558357c906b4dfa61cd34656d9f02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a922d3fe2d1de331e41f5c2e561976d39"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a922d3fe2d1de331e41f5c2e561976d39">calc_LTE_Efromurho</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> <a class="el" href="../../dc/d88/init_8koral_8c.html#a07484107e6d9fdf38b53edf631d6511d">E</a>, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>)</td></tr>
<tr class="memdesc:a922d3fe2d1de331e41f5c2e561976d39"><td class="mdescLeft">&#160;</td><td class="mdescRight">This will really give back only LTE E.  <a href="#a922d3fe2d1de331e41f5c2e561976d39">More...</a><br/></td></tr>
<tr class="separator:a922d3fe2d1de331e41f5c2e561976d39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c7052b05f1c8206988b52c760b2e4af"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a1c7052b05f1c8206988b52c760b2e4af">calc_PEQ_ufromTrho</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>)</td></tr>
<tr class="memdesc:a1c7052b05f1c8206988b52c760b2e4af"><td class="mdescLeft">&#160;</td><td class="mdescRight">suplementary routines for conversions  <a href="#a1c7052b05f1c8206988b52c760b2e4af">More...</a><br/></td></tr>
<tr class="separator:a1c7052b05f1c8206988b52c760b2e4af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2fe1c6debba576d29c23100d4e30704"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d21/global_8funcdeclare_8rad_8h.html#ae2fe1c6debba576d29c23100d4e30704">calc_PEQ_Tfromurho</a> (<a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>)</td></tr>
<tr class="separator:ae2fe1c6debba576d29c23100d4e30704"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8edd5fc0afc1713ad401c2db92c71e0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d21/global_8funcdeclare_8rad_8h.html#aa8edd5fc0afc1713ad401c2db92c71e0">set_ncon_velocity</a> (int whichvel, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> gammamax, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *ncon, struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *ptrgeom, <a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *uconwhichvel)</td></tr>
<tr class="memdesc:aa8edd5fc0afc1713ad401c2db92c71e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">set velocity based upon ncon and gammamax and return in whichvel format for the ptrgeom geometry/coords  <a href="#aa8edd5fc0afc1713ad401c2db92c71e0">More...</a><br/></td></tr>
<tr class="separator:aa8edd5fc0afc1713ad401c2db92c71e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Function declarations (used globally) from RADIATION parts of code. </p>

<p>Definition in file <a class="el" href="../../df/d21/global_8funcdeclare_8rad_8h_source.html">global.funcdeclare.rad.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a0fb687f68b97453843fc3c085f05f1b4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> calc_LTE_EfromT </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>E=urad=arad T^4 (this is LTE only if put in T was gas T) </p>

<p>Definition at line <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html#l14181">14181</a> of file <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html">phys.tools.rad.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d21/global_8funcdeclare_8rad_8h_a0fb687f68b97453843fc3c085f05f1b4_icgraph.png" border="0" usemap="#df/d21/global_8funcdeclare_8rad_8h_a0fb687f68b97453843fc3c085f05f1b4_icgraph" alt=""/></div>
<map name="df/d21/global_8funcdeclare_8rad_8h_a0fb687f68b97453843fc3c085f05f1b4_icgraph" id="df/d21/global_8funcdeclare_8rad_8h_a0fb687f68b97453843fc3c085f05f1b4_icgraph">
<area shape="rect" id="node3" href="../../de/d51/bounds_8c.html#a09a080d9895db7b800a3824cb3fac9f1" title="X1 lower for beam injection to create shadow." alt="" coords="463,497,623,527"/><area shape="rect" id="node110" href="../../de/d51/bounds_8c.html#a3ee134cc5fb18752265c16a20dbdfb63" title="X3 lower for radiation beam injection." alt="" coords="445,705,640,735"/><area shape="rect" id="node113" href="../../de/d51/bounds_8c.html#a8300ddf3ae6a3866234cc0e9c12f26dc" title="X1 upper for inflow." alt="" coords="449,812,636,841"/><area shape="rect" id="node116" href="../../de/d51/bounds_8c.html#a01088f65c7a4cfa2ebfed202f815b951" title="X1 lower and upper for RADATM." alt="" coords="195,549,365,579"/><area shape="rect" id="node119" href="../../de/d51/bounds_8c.html#a42658c4ecf3c6edb958394eb65a9ac2b" title="RADNT." alt="" coords="233,603,327,632"/><area shape="rect" id="node122" href="../../de/d51/bounds_8c.html#a3e4008fd24427b2e91d0ae5882b9536a" title="X1 upper for RADCYLBEAM." alt="" coords="197,861,363,891"/><area shape="rect" id="node125" href="../../de/d51/bounds_8c.html#ac32c1a20138382904dc5f1c66778ad8b" title="X1 upper for RADCYLJET." alt="" coords="207,915,353,944"/><area shape="rect" id="node128" href="../../de/d51/bounds_8c.html#a635fbaba3d6d6afcf5f34bbb2c278737" title="X2 upper for radiation beam injection." alt="" coords="428,652,657,681"/><area shape="rect" id="node131" href="../../de/d51/bounds_8c.html#a9f1df4e461f3f776bf3cb80e36a4d6df" title="get_radcylbeamcart" alt="" coords="212,392,348,421"/><area shape="rect" id="node136" href="../../de/db2/initbase_8funcdeclare_8h.html#abd98493cc6574124e0b41c742a056eea" title="init_global" alt="" coords="3393,968,3473,997"/><area shape="rect" id="node139" href="../../d8/d60/init_8c.html#af94364e17d67cddfbb7bb3bf39c05ee6" title="init_dsandvels_koral" alt="" coords="723,1039,861,1068"/><area shape="rect" id="node144" href="../../d8/d60/init_8c.html#a83e7f10ffd348c4d18b3245dd4bab585" title="make_nonrt2rt_solution" alt="" coords="201,1120,359,1149"/><area shape="rect" id="node151" href="../../d8/d60/init_8c.html#afea1cedfcfd7a2363ba469b1561eb034" title="jetbound" alt="" coords="245,445,315,475"/><area shape="rect" id="node156" href="../../d2/d72/phys_8tools_8rad_8c.html#a41e256325d07de60fa8b6b8e743cf7b8" title="get {abs} and {es} in /mass * rho = 1/cm form." alt="" coords="181,339,379,368"/><area shape="rect" id="node181" href="../../d2/d72/phys_8tools_8rad_8c.html#a16de7a292f454ba565392841710ace58" title="This will really give back only LTE E." alt="" coords="208,757,352,787"/><area shape="rect" id="node5" href="../../de/d51/bounds_8c.html#a34ac3f1ca7b0f3a21053c633da9931a9" title="user boundary routine" alt="" coords="707,652,877,681"/><area shape="rect" id="node7" href="../../d4/dad/bounds_8funcdeclare_8h.html#a4bc7413b2cdb89e070f38bbb689ae555" title="bound_prim_user_dir" alt="" coords="931,595,1072,624"/><area shape="rect" id="node99" href="../../d4/dad/bounds_8funcdeclare_8h.html#a2fbddc9ff8fc706bafa80c39695c7262" title="assume single user function takes care of primitive locations" alt="" coords="1125,799,1275,828"/><area shape="rect" id="node9" href="../../d9/de0/step__ch_8c.html#adbe0e3ba8a74f09ab928a96bd68cab6d" title="bound any prim type CALLS directly real and MPI boundary functions pstag = pstagglobal ucons = unewgl..." alt="" coords="1145,491,1255,520"/><area shape="rect" id="node11" href="../../d9/de0/step__ch_8c.html#a689fddc1949b1a1d390b59d10d17d83c" title="normal full bounding during evolution NOTEMARK: Was previously also bounding pstag here..." alt="" coords="1341,136,1467,165"/><area shape="rect" id="node24" href="../../d9/de0/step__ch_8c.html#a4079244d85c301885c1363ca41502869" title="simple bounding during evolution NOTEMARK: Was previously also bounding pstag here, but not necessary since done by calling bound_pstag in fluxctstag.c" alt="" coords="1323,301,1485,331"/><area shape="rect" id="node27" href="../../d9/de0/step__ch_8c.html#addca75a18cc861326a321565a2e81aa0" title="normal bounding of non&#45;staggered primitives" alt="" coords="1360,491,1448,520"/><area shape="rect" id="node93" href="../../d9/de0/step__ch_8c.html#a460b84e1112e3aef17209c20e22e1cf1" title="bound all prims" alt="" coords="1825,797,1948,827"/><area shape="rect" id="node13" href="../../d9/de0/step__ch_8c.html#ad36a0f9f915547477e3bb2405f8166b9" title="things to do after advance()" alt="" coords="1587,136,1688,165"/><area shape="rect" id="node15" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="3009,135,3143,164"/><area shape="rect" id="node17" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="3229,312,3296,341"/><area shape="rect" id="node19" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="3535,572,3625,601"/><area shape="rect" id="node21" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="3675,684,3725,713"/><area shape="rect" id="node29" href="../../dc/dae/flux_8c.html#aef355ccd1ca2295b84ad2fe1fc011d35" title="normal interpolation of CENT quantities to FACE quantities sets global variables pl_ct and pr_ct to p..." alt="" coords="1548,213,1727,243"/><area shape="rect" id="node46" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aecb3f613a7cb3bbb42fff2dbee5d65a1" title="This vpot2field function is for staggered method to evolve quasi&#45;deaveraged fields (i..." alt="" coords="2260,643,2425,672"/><area shape="rect" id="node48" href="../../de/db2/initbase_8funcdeclare_8h.html#ae6b2ad4cd0debf5b89ba8a9e471d6977" title="assumes normal field p pleft used as temp var if FLUXB==FLUXCTSTAG assigns conserved field in UEVOLVE..." alt="" coords="2476,655,2553,684"/><area shape="rect" id="node56" href="../../df/d15/init_8tools_8c.html#a77551ab2581efdbaf170dfca073ff9ab" title="user1_init_primitives" alt="" coords="3192,744,3333,773"/><area shape="rect" id="node60" href="../../de/df8/initbase_8c.html#ac4110398e386c9888d9565630357dbbe" title="General&#45;Primary init() routine Uses globals inside init() because sets memory and sets physics..." alt="" coords="3561,796,3599,825"/><area shape="rect" id="node63" href="../../d0/dde/fluxctstag_8c.html#a4e3d76c6ad125b8199948408c262e3a1" title="wrapper for: 1) interpolate FACE 2 CORN 2) loop over dimensions setting field flux dimension&#45;by&#45;dimen..." alt="" coords="2056,291,2187,320"/><area shape="rect" id="node66" href="../../d0/dde/fluxctstag_8c.html#a2dd789bf1402bef72523cdb69e85806e" title="use global pbcorninterp and pvcorninterp at CORN1,2,3 to obtain EMFs at CORN1,2,3 NO interpolation of..." alt="" coords="1572,317,1703,363"/><area shape="rect" id="node69" href="../../d0/dde/fluxctstag_8c.html#aaec26a518629175ecceefbaf6c84225e" title="wrapper for continuous interpolation for FACE_to_CENT" alt="" coords="1551,491,1724,520"/><area shape="rect" id="node73" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aa31dd83c96936277334c62e2098dd51d" title="wrapper for taking staggered conserved field quantity and obtaining centered field quantity upoint en..." alt="" coords="2033,483,2209,512"/><area shape="rect" id="node82" href="../../d0/dde/fluxctstag_8c.html#a6cd90dff56319085b32bc57c0c8b3cfd" title="this function called in initbase.c and during advance() here ustag is point value if dimension doesn&#39;..." alt="" coords="1827,421,1947,451"/><area shape="rect" id="node85" href="../../d0/dde/fluxctstag_8c.html#ad6aa918442f7768dff3c099ba353ee64" title="slope_lim_face2corn() is provided p2interp and returns pleft/pright differs from slope_lim() by range..." alt="" coords="1567,387,1708,416"/><area shape="rect" id="node31" href="../../dc/dae/flux_8c.html#a2602a4dad9ed7adc944227d02435312e" title="standard (non&#45;field flux) calculation but setup to store results of interpolation so can be used for ..." alt="" coords="1789,213,1984,243"/><area shape="rect" id="node33" href="../../dc/dae/flux_8c.html#aaf6d832880760f80459d91477c28b519" title="wrapper for different standard 1&#45;D flux calculators 1&#45;D interpolate and get flux for that direction (..." alt="" coords="2064,213,2179,243"/><area shape="rect" id="node35" href="../../dc/dae/flux_8c.html#a8ffa7399bd5354fdcdec5f3e1adf0b13" title="wrapper for CENT_to_FACE1,2,3 used to compute flux at face" alt="" coords="2296,213,2389,243"/><area shape="rect" id="node37" href="../../d5/d2f/flux_8funcdeclare_8h.html#ab229b0f3f2caf3c0a3ef5299fba2b1c0" title="see fluxcompute.c for non&#45;computer science, real physics calculations of flux" alt="" coords="2481,213,2548,243"/><area shape="rect" id="node39" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="2625,160,2753,189"/><area shape="rect" id="node44" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="2612,213,2767,243"/><area shape="rect" id="node41" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="2857,160,2927,189"/><area shape="rect" id="node50" href="../../df/d15/init_8tools_8c.html#a3750bc790613bc6c8c805af0f1b839c8" title="user1_init_vpot2field_user" alt="" coords="2603,679,2776,708"/><area shape="rect" id="node52" href="../../de/db2/initbase_8funcdeclare_8h.html#afda44281ad5c163455c40f012d4a8954" title="init_vpot2field_user" alt="" coords="2825,681,2959,711"/><area shape="rect" id="node54" href="../../de/db2/initbase_8funcdeclare_8h.html#a90699a18ede8b7f112c0078512804ec1" title="initialize vector potential given user function assumes normal non&#45;staggered field in pr Notice that ..." alt="" coords="3041,685,3111,715"/><area shape="rect" id="node58" href="../../de/db2/initbase_8funcdeclare_8h.html#a0afa200a5f947b1c9f6e554519f28fc4" title="init_primitives" alt="" coords="3383,744,3484,773"/><area shape="rect" id="node71" href="../../d0/dde/fluxctstag_8c.html#a5e3dcbe89d6f8a9384cafb58afd7dbf4" title="interpolates field at FACE to field at CENT assuming field along itself is continuous" alt="" coords="1827,474,1947,521"/><area shape="rect" id="node77" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aaa24493002bc8c0a527b1ea2ac2dddbf" title="convert conservative U to stag point P and CENT point U and CENT point primitive" alt="" coords="2276,539,2409,568"/><area shape="rect" id="node87" href="../../d0/dde/fluxctstag_8c.html#a985ee116306b4011810334ae93900493" title="INPUTS: Nvec, pr, primface_l[dir], primface_r[dir] OUTPUTS: pbcorn[dir][side], pvcorn[dir][side][side..." alt="" coords="1797,368,1976,397"/><area shape="rect" id="node95" href="../../d9/de0/step__ch_8c.html#a91fe5c4370e3292a19e7f794797a407f" title="normal bounding of all primitives" alt="" coords="3025,848,3127,877"/><area shape="rect" id="node101" href="../../d9/de0/step__ch_8c.html#abdea68b778dc9253324da69d3c376965" title="bound any pstag type CALLS directly real and MPI boundary functions pstag is at FACE1,2,3 for fields, so user bound is different MPI bounding is the same as CENT quantities used when restarting in initbase.c to bound unewglobal for FLUXB==FLUXCTSTAG" alt="" coords="1579,849,1696,879"/><area shape="rect" id="node104" href="../../d9/de0/step__ch_8c.html#a6f4b963a50a7288964f01775f2f18bb9" title="normal bounding of staggered primitives" alt="" coords="1839,851,1935,880"/><area shape="rect" id="node107" href="../../d0/dde/fluxctstag_8c.html#aa169cb1999412f2e2460012cc5d7a804" title="pure DONOR version: upoint is input staggered updated field that needs to be converted to pstag and t..." alt="" coords="2033,847,2209,894"/><area shape="rect" id="node133" href="../../de/d51/bounds_8c.html#a16398a5325a9df48783423f00ba65bb7" title="all boundaries for RADCYLBEAMCART" alt="" coords="467,391,619,420"/><area shape="rect" id="node141" href="../../df/d15/init_8tools_8c.html#acefd26944dbbb1c289886f520f6befac" title="init_dsandvels" alt="" coords="2840,744,2944,773"/><area shape="rect" id="node146" href="../../d8/d60/init_8c.html#a73009fd6280963c265e2cf5d1c353e8d" title="get_full_rtsolution" alt="" coords="481,1120,604,1149"/><area shape="rect" id="node149" href="../../d8/d60/init_8c.html#a448cd3fd9a1d862485e7b6e67b965172" title="process_restart_toget\l_radiation" alt="" coords="719,1111,865,1158"/><area shape="rect" id="node153" href="../../de/d51/bounds_8c.html#abf5c0888b3797f59a8ccf9626722f79e" title="X2 lower for RADCYLJET." alt="" coords="469,444,616,473"/><area shape="rect" id="node158" href="../../d2/d72/phys_8tools_8rad_8c.html#ab62b07a8cbcc04f20c05a468ad6de636" title="compute G^ 4&#45;force" alt="" coords="508,197,577,227"/><area shape="rect" id="node160" href="../../d2/d72/phys_8tools_8rad_8c.html#aaa32f967773a287ecb6647732157606f" title="get G_" alt="" coords="757,161,827,191"/><area shape="rect" id="node162" href="../../d2/d72/phys_8tools_8rad_8c.html#a2a80e3b7ea37b9536f0e49cc740425c9" title="get 4&#45;force for all pl&#39;s" alt="" coords="925,92,1077,121"/><area shape="rect" id="node164" href="../../d2/d72/phys_8tools_8rad_8c.html#af46d2b1cf89a70a7e2ef503146c649a9" title="uu0 &#45; original cons." alt="" coords="1163,57,1237,87"/><area shape="rect" id="node166" href="../../d2/d72/phys_8tools_8rad_8c.html#a17aede36203a236390363af78d3a86f0" title="compute changes to U (both T and R) using implicit method KORALTODO: If doing implicit, should also add geometry source term that can sometimes be stiff." alt="" coords="1533,5,1741,35"/><area shape="rect" id="node178" href="../../d2/d72/phys_8tools_8rad_8c.html#afa73a2caa3209e565a64f92447058507" title="calculating approximate Jacobian: dUresid(dUrad,G(Urad))/dUrad = dy(x)/dx then compute inverse Jacobi..." alt="" coords="1352,57,1456,87"/><area shape="rect" id="node168" href="../../d2/d72/phys_8tools_8rad_8c.html#a675bb3f12a77c62cf2540bc42c4867f8" title="wrapper for mode method" alt="" coords="1803,160,1971,189"/><area shape="rect" id="node170" href="../../d2/d72/phys_8tools_8rad_8c.html#aa8c5c0d5de580899948f9f22e10aff23" title="General radiation source term calculation (EXTERNALLY called) NOTE: source_explicit() takes as first ..." alt="" coords="2061,160,2181,189"/><area shape="rect" id="node172" href="../../d2/d1d/sources_8c.html#a504ce383765ca3d2ff0b1ee653aff854" title="Ugeomfree and dUother are in UNOTHING form (or UEVOLVE without geometry) pf might be modified so bett..." alt="" coords="2289,160,2396,189"/><area shape="rect" id="node174" href="../../d7/def/phys_8tools_8c.html#a12ce5092c3a1a566cb7a560a7440acc1" title="add in source terms to equations of motion ui and dUriemann in UEVOLVE form assume q(pr) so consisten..." alt="" coords="2484,160,2545,189"/><area shape="rect" id="node185" href="../../de/d51/bounds_8c.html#ac15824bc610943cb7e02112e77b94752" title="on&#45;grid bounding" alt="" coords="493,759,592,788"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a922d3fe2d1de331e41f5c2e561976d39"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> calc_LTE_Efromurho </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td>
          <td class="paramname"><em>E</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This will really give back only LTE E. </p>

<p>Definition at line <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html#l14208">14208</a> of file <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html">phys.tools.rad.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d21/global_8funcdeclare_8rad_8h_a922d3fe2d1de331e41f5c2e561976d39_cgraph.png" border="0" usemap="#df/d21/global_8funcdeclare_8rad_8h_a922d3fe2d1de331e41f5c2e561976d39_cgraph" alt=""/></div>
<map name="df/d21/global_8funcdeclare_8rad_8h_a922d3fe2d1de331e41f5c2e561976d39_cgraph" id="df/d21/global_8funcdeclare_8rad_8h_a922d3fe2d1de331e41f5c2e561976d39_cgraph">
<area shape="rect" id="node3" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a0fb687f68b97453843fc3c085f05f1b4" title="E=urad=arad T^4 (this is LTE only if put in T was gas T)" alt="" coords="199,5,324,35"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d21/global_8funcdeclare_8rad_8h_a922d3fe2d1de331e41f5c2e561976d39_icgraph.png" border="0" usemap="#df/d21/global_8funcdeclare_8rad_8h_a922d3fe2d1de331e41f5c2e561976d39_icgraph" alt=""/></div>
<map name="df/d21/global_8funcdeclare_8rad_8h_a922d3fe2d1de331e41f5c2e561976d39_icgraph" id="df/d21/global_8funcdeclare_8rad_8h_a922d3fe2d1de331e41f5c2e561976d39_icgraph">
<area shape="rect" id="node3" href="../../de/d51/bounds_8c.html#a3ee134cc5fb18752265c16a20dbdfb63" title="X3 lower for radiation beam injection." alt="" coords="216,757,411,787"/><area shape="rect" id="node110" href="../../de/d51/bounds_8c.html#a8300ddf3ae6a3866234cc0e9c12f26dc" title="X1 upper for inflow." alt="" coords="220,811,407,840"/><area shape="rect" id="node113" href="../../de/d51/bounds_8c.html#ac15824bc610943cb7e02112e77b94752" title="on&#45;grid bounding" alt="" coords="264,651,363,680"/><area shape="rect" id="node116" href="../../de/d51/bounds_8c.html#a635fbaba3d6d6afcf5f34bbb2c278737" title="X2 upper for radiation beam injection." alt="" coords="199,704,428,733"/><area shape="rect" id="node119" href="../../d8/d60/init_8c.html#af94364e17d67cddfbb7bb3bf39c05ee6" title="init_dsandvels_koral" alt="" coords="493,863,632,892"/><area shape="rect" id="node5" href="../../de/d51/bounds_8c.html#a34ac3f1ca7b0f3a21053c633da9931a9" title="user boundary routine" alt="" coords="477,715,648,744"/><area shape="rect" id="node7" href="../../d4/dad/bounds_8funcdeclare_8h.html#a4bc7413b2cdb89e070f38bbb689ae555" title="bound_prim_user_dir" alt="" coords="700,528,841,557"/><area shape="rect" id="node99" href="../../d4/dad/bounds_8funcdeclare_8h.html#a2fbddc9ff8fc706bafa80c39695c7262" title="assume single user function takes care of primitive locations" alt="" coords="696,725,845,755"/><area shape="rect" id="node9" href="../../d9/de0/step__ch_8c.html#adbe0e3ba8a74f09ab928a96bd68cab6d" title="bound any prim type CALLS directly real and MPI boundary functions pstag = pstagglobal ucons = unewgl..." alt="" coords="895,387,1004,416"/><area shape="rect" id="node11" href="../../d9/de0/step__ch_8c.html#a689fddc1949b1a1d390b59d10d17d83c" title="normal full bounding during evolution NOTEMARK: Was previously also bounding pstag here..." alt="" coords="1072,59,1197,88"/><area shape="rect" id="node24" href="../../d9/de0/step__ch_8c.html#a4079244d85c301885c1363ca41502869" title="simple bounding during evolution NOTEMARK: Was previously also bounding pstag here, but not necessary since done by calling bound_pstag in fluxctstag.c" alt="" coords="1053,5,1216,35"/><area shape="rect" id="node27" href="../../d9/de0/step__ch_8c.html#addca75a18cc861326a321565a2e81aa0" title="normal bounding of non&#45;staggered primitives" alt="" coords="1091,387,1179,416"/><area shape="rect" id="node93" href="../../d9/de0/step__ch_8c.html#a460b84e1112e3aef17209c20e22e1cf1" title="bound all prims" alt="" coords="1527,693,1649,723"/><area shape="rect" id="node13" href="../../d9/de0/step__ch_8c.html#ad36a0f9f915547477e3bb2405f8166b9" title="things to do after advance()" alt="" coords="1303,5,1404,35"/><area shape="rect" id="node15" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="2711,123,2844,152"/><area shape="rect" id="node17" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="2931,172,2997,201"/><area shape="rect" id="node19" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="3236,412,3327,441"/><area shape="rect" id="node21" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="3376,515,3427,544"/><area shape="rect" id="node29" href="../../dc/dae/flux_8c.html#aef355ccd1ca2295b84ad2fe1fc011d35" title="normal interpolation of CENT quantities to FACE quantities sets global variables pl_ct and pr_ct to p..." alt="" coords="1264,283,1443,312"/><area shape="rect" id="node46" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aecb3f613a7cb3bbb42fff2dbee5d65a1" title="This vpot2field function is for staggered method to evolve quasi&#45;deaveraged fields (i..." alt="" coords="1961,488,2127,517"/><area shape="rect" id="node48" href="../../de/db2/initbase_8funcdeclare_8h.html#ae6b2ad4cd0debf5b89ba8a9e471d6977" title="assumes normal field p pleft used as temp var if FLUXB==FLUXCTSTAG assigns conserved field in UEVOLVE..." alt="" coords="2177,488,2255,517"/><area shape="rect" id="node56" href="../../df/d15/init_8tools_8c.html#a77551ab2581efdbaf170dfca073ff9ab" title="user1_init_primitives" alt="" coords="2893,589,3035,619"/><area shape="rect" id="node60" href="../../de/df8/initbase_8c.html#ac4110398e386c9888d9565630357dbbe" title="General&#45;Primary init() routine Uses globals inside init() because sets memory and sets physics..." alt="" coords="3263,616,3300,645"/><area shape="rect" id="node63" href="../../d0/dde/fluxctstag_8c.html#a4e3d76c6ad125b8199948408c262e3a1" title="wrapper for: 1) interpolate FACE 2 CORN 2) loop over dimensions setting field flux dimension&#45;by&#45;dimen..." alt="" coords="1757,187,1888,216"/><area shape="rect" id="node66" href="../../d0/dde/fluxctstag_8c.html#a2dd789bf1402bef72523cdb69e85806e" title="use global pbcorninterp and pvcorninterp at CORN1,2,3 to obtain EMFs at CORN1,2,3 NO interpolation of..." alt="" coords="1288,162,1419,209"/><area shape="rect" id="node69" href="../../d0/dde/fluxctstag_8c.html#aaec26a518629175ecceefbaf6c84225e" title="wrapper for continuous interpolation for FACE_to_CENT" alt="" coords="1267,387,1440,416"/><area shape="rect" id="node73" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aa31dd83c96936277334c62e2098dd51d" title="wrapper for taking staggered conserved field quantity and obtaining centered field quantity upoint en..." alt="" coords="1735,379,1911,408"/><area shape="rect" id="node82" href="../../d0/dde/fluxctstag_8c.html#a6cd90dff56319085b32bc57c0c8b3cfd" title="this function called in initbase.c and during advance() here ustag is point value if dimension doesn&#39;..." alt="" coords="1528,317,1648,347"/><area shape="rect" id="node85" href="../../d0/dde/fluxctstag_8c.html#ad6aa918442f7768dff3c099ba353ee64" title="slope_lim_face2corn() is provided p2interp and returns pleft/pright differs from slope_lim() by range..." alt="" coords="1283,109,1424,139"/><area shape="rect" id="node31" href="../../dc/dae/flux_8c.html#a2602a4dad9ed7adc944227d02435312e" title="standard (non&#45;field flux) calculation but setup to store results of interpolation so can be used for ..." alt="" coords="1491,264,1685,293"/><area shape="rect" id="node33" href="../../dc/dae/flux_8c.html#aaf6d832880760f80459d91477c28b519" title="wrapper for different standard 1&#45;D flux calculators 1&#45;D interpolate and get flux for that direction (..." alt="" coords="1765,264,1880,293"/><area shape="rect" id="node35" href="../../dc/dae/flux_8c.html#a8ffa7399bd5354fdcdec5f3e1adf0b13" title="wrapper for CENT_to_FACE1,2,3 used to compute flux at face" alt="" coords="1997,264,2091,293"/><area shape="rect" id="node37" href="../../d5/d2f/flux_8funcdeclare_8h.html#ab229b0f3f2caf3c0a3ef5299fba2b1c0" title="see fluxcompute.c for non&#45;computer science, real physics calculations of flux" alt="" coords="2183,264,2249,293"/><area shape="rect" id="node39" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="2327,264,2455,293"/><area shape="rect" id="node44" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="2313,345,2468,375"/><area shape="rect" id="node41" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="2559,187,2628,216"/><area shape="rect" id="node50" href="../../df/d15/init_8tools_8c.html#a3750bc790613bc6c8c805af0f1b839c8" title="user1_init_vpot2field_user" alt="" coords="2304,488,2477,517"/><area shape="rect" id="node52" href="../../de/db2/initbase_8funcdeclare_8h.html#afda44281ad5c163455c40f012d4a8954" title="init_vpot2field_user" alt="" coords="2527,488,2660,517"/><area shape="rect" id="node54" href="../../de/db2/initbase_8funcdeclare_8h.html#a90699a18ede8b7f112c0078512804ec1" title="initialize vector potential given user function assumes normal non&#45;staggered field in pr Notice that ..." alt="" coords="2743,488,2812,517"/><area shape="rect" id="node58" href="../../de/db2/initbase_8funcdeclare_8h.html#a0afa200a5f947b1c9f6e554519f28fc4" title="init_primitives" alt="" coords="3084,589,3185,619"/><area shape="rect" id="node71" href="../../d0/dde/fluxctstag_8c.html#a5e3dcbe89d6f8a9384cafb58afd7dbf4" title="interpolates field at FACE to field at CENT assuming field along itself is continuous" alt="" coords="1528,370,1648,417"/><area shape="rect" id="node77" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aaa24493002bc8c0a527b1ea2ac2dddbf" title="convert conservative U to stag point P and CENT point U and CENT point primitive" alt="" coords="1977,435,2111,464"/><area shape="rect" id="node87" href="../../d0/dde/fluxctstag_8c.html#a985ee116306b4011810334ae93900493" title="INPUTS: Nvec, pr, primface_l[dir], primface_r[dir] OUTPUTS: pbcorn[dir][side], pvcorn[dir][side][side..." alt="" coords="1499,109,1677,139"/><area shape="rect" id="node95" href="../../d9/de0/step__ch_8c.html#a91fe5c4370e3292a19e7f794797a407f" title="normal bounding of all primitives" alt="" coords="2727,693,2828,723"/><area shape="rect" id="node101" href="../../d9/de0/step__ch_8c.html#abdea68b778dc9253324da69d3c376965" title="bound any pstag type CALLS directly real and MPI boundary functions pstag is at FACE1,2,3 for fields, so user bound is different MPI bounding is the same as CENT quantities used when restarting in initbase.c to bound unewglobal for FLUXB==FLUXCTSTAG" alt="" coords="1295,747,1412,776"/><area shape="rect" id="node104" href="../../d9/de0/step__ch_8c.html#a6f4b963a50a7288964f01775f2f18bb9" title="normal bounding of staggered primitives" alt="" coords="1540,747,1636,776"/><area shape="rect" id="node107" href="../../d0/dde/fluxctstag_8c.html#aa169cb1999412f2e2460012cc5d7a804" title="pure DONOR version: upoint is input staggered updated field that needs to be converted to pstag and t..." alt="" coords="1735,743,1911,790"/><area shape="rect" id="node121" href="../../df/d15/init_8tools_8c.html#acefd26944dbbb1c289886f520f6befac" title="init_dsandvels" alt="" coords="897,863,1001,892"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3e47afcfc5c42719999d851395fd032d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> calc_LTE_NfromE </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td>
          <td class="paramname"><em>E</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>nrad(E) </p>

<p>Definition at line <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html#l14194">14194</a> of file <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html">phys.tools.rad.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d21/global_8funcdeclare_8rad_8h_a3e47afcfc5c42719999d851395fd032d_cgraph.png" border="0" usemap="#df/d21/global_8funcdeclare_8rad_8h_a3e47afcfc5c42719999d851395fd032d_cgraph" alt=""/></div>
<map name="df/d21/global_8funcdeclare_8rad_8h_a3e47afcfc5c42719999d851395fd032d_cgraph" id="df/d21/global_8funcdeclare_8rad_8h_a3e47afcfc5c42719999d851395fd032d_cgraph">
<area shape="rect" id="node3" href="../../df/d21/global_8funcdeclare_8rad_8h.html#af07558357c906b4dfa61cd34656d9f02" title="E=urad=arad T^4 and just solve for T (this is LTE only if assume resulting T is gas T)..." alt="" coords="185,5,311,35"/><area shape="rect" id="node5" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a7dc2e853cec9b6f9a5e83ce23c468d03" title="nrad(T) = nrad=arad T^3/2.70118 (this is LTE only if put in T was gas T)" alt="" coords="184,59,312,88"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d21/global_8funcdeclare_8rad_8h_a3e47afcfc5c42719999d851395fd032d_icgraph.png" border="0" usemap="#df/d21/global_8funcdeclare_8rad_8h_a3e47afcfc5c42719999d851395fd032d_icgraph" alt=""/></div>
<map name="df/d21/global_8funcdeclare_8rad_8h_a3e47afcfc5c42719999d851395fd032d_icgraph" id="df/d21/global_8funcdeclare_8rad_8h_a3e47afcfc5c42719999d851395fd032d_icgraph">
<area shape="rect" id="node3" href="../../d2/d72/phys_8tools_8rad_8c.html#a8242523b45077ccd783a2867dddb731a" title="compute Trad (also computed directly in calc_Gu() above) using only primitives (not using conserved q..." alt="" coords="433,445,511,475"/><area shape="rect" id="node7" href="../../d2/d72/phys_8tools_8rad_8c.html#a864793af319e70c0d099679fa81dd398" title="compute Trad (also computed directly in calc_Gu() above) using only primitives (not using conserved q..." alt="" coords="184,497,384,527"/><area shape="rect" id="node47" href="../../d2/d72/phys_8tools_8rad_8c.html#a67b370af2fa58283bc590ff4e895fb90" title="Like u2p_rad_orig(), but uses Jon&#39;s paper draft ZAMO RAD version." alt="" coords="235,576,333,605"/><area shape="rect" id="node5" href="../../d2/d72/phys_8tools_8rad_8c.html#a3ad3833ac14b93095e76f8d915c5c9ad" title="calcfull_Trad" alt="" coords="572,445,668,475"/><area shape="rect" id="node9" href="../../d2/d72/phys_8tools_8rad_8c.html#a41e256325d07de60fa8b6b8e743cf7b8" title="get {abs} and {es} in /mass * rho = 1/cm form." alt="" coords="728,396,925,425"/><area shape="rect" id="node11" href="../../d2/d72/phys_8tools_8rad_8c.html#ab62b07a8cbcc04f20c05a468ad6de636" title="compute G^ 4&#45;force" alt="" coords="1013,369,1083,399"/><area shape="rect" id="node13" href="../../d2/d72/phys_8tools_8rad_8c.html#aaa32f967773a287ecb6647732157606f" title="get G_" alt="" coords="1517,215,1587,244"/><area shape="rect" id="node15" href="../../d2/d72/phys_8tools_8rad_8c.html#a2a80e3b7ea37b9536f0e49cc740425c9" title="get 4&#45;force for all pl&#39;s" alt="" coords="1711,103,1863,132"/><area shape="rect" id="node17" href="../../d2/d72/phys_8tools_8rad_8c.html#af46d2b1cf89a70a7e2ef503146c649a9" title="uu0 &#45; original cons." alt="" coords="2136,32,2211,61"/><area shape="rect" id="node19" href="../../d2/d72/phys_8tools_8rad_8c.html#a17aede36203a236390363af78d3a86f0" title="compute changes to U (both T and R) using implicit method KORALTODO: If doing implicit, should also add geometry source term that can sometimes be stiff." alt="" coords="2488,5,2696,35"/><area shape="rect" id="node43" href="../../d2/d72/phys_8tools_8rad_8c.html#afa73a2caa3209e565a64f92447058507" title="calculating approximate Jacobian: dUresid(dUrad,G(Urad))/dUrad = dy(x)/dx then compute inverse Jacobi..." alt="" coords="2307,32,2411,61"/><area shape="rect" id="node21" href="../../d2/d72/phys_8tools_8rad_8c.html#a675bb3f12a77c62cf2540bc42c4867f8" title="wrapper for mode method" alt="" coords="2757,5,2925,35"/><area shape="rect" id="node23" href="../../d2/d72/phys_8tools_8rad_8c.html#aa8c5c0d5de580899948f9f22e10aff23" title="General radiation source term calculation (EXTERNALLY called) NOTE: source_explicit() takes as first ..." alt="" coords="3016,109,3136,139"/><area shape="rect" id="node25" href="../../d2/d1d/sources_8c.html#a504ce383765ca3d2ff0b1ee653aff854" title="Ugeomfree and dUother are in UNOTHING form (or UEVOLVE without geometry) pf might be modified so bett..." alt="" coords="3244,219,3351,248"/><area shape="rect" id="node27" href="../../d7/def/phys_8tools_8c.html#a12ce5092c3a1a566cb7a560a7440acc1" title="add in source terms to equations of motion ui and dUriemann in UEVOLVE form assume q(pr) so consisten..." alt="" coords="3444,284,3505,313"/><area shape="rect" id="node29" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="3591,337,3719,367"/><area shape="rect" id="node41" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="3577,415,3732,444"/><area shape="rect" id="node31" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="3823,293,3892,323"/><area shape="rect" id="node33" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="3975,205,4108,235"/><area shape="rect" id="node35" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="4195,339,4261,368"/><area shape="rect" id="node37" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="4500,439,4591,468"/><area shape="rect" id="node39" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="4640,520,4691,549"/><area shape="rect" id="node49" href="../../d2/d72/phys_8tools_8rad_8c.html#aca8e86da8eb620a3a3e3487b420df3e1" title="u2p_rad" alt="" coords="439,627,505,656"/><area shape="rect" id="node51" href="../../d2/d72/phys_8tools_8rad_8c.html#a2ec6ee79c76351868a725b22dac62135" title="like prad_fforlab() but for only whichdir=FF2LAB used for IC" alt="" coords="575,627,665,656"/><area shape="rect" id="node194" href="../../d1/d3e/utoprimgen_8c.html#a0a83e9e7fdd3cc595c5b8d0df88ec684" title="just picks the algorithm to invert" alt="" coords="560,835,680,864"/><area shape="rect" id="node53" href="../../d2/d72/phys_8tools_8rad_8c.html#af50896d039d660550b738862b3390b07" title="radiative ortonormal ff primitives (E,F^i) &lt;&#45;&gt; primitives in lab frame Used only for initial conditio..." alt="" coords="781,627,872,656"/><area shape="rect" id="node55" href="../../d8/d60/init_8c.html#af94364e17d67cddfbb7bb3bf39c05ee6" title="init_dsandvels_koral" alt="" coords="1925,937,2064,967"/><area shape="rect" id="node66" href="../../d8/d60/init_8c.html#a448cd3fd9a1d862485e7b6e67b965172" title="process_restart_toget\l_radiation" alt="" coords="975,549,1121,595"/><area shape="rect" id="node68" href="../../d2/d72/phys_8tools_8rad_8c.html#a64226cb28f52020ffe18ac6c6b1a2f5c" title="Input: start with pin [with fluid in whichvel velocity and whichcoordfluid coordinates (PRIMECOORDS o..." alt="" coords="983,618,1113,665"/><area shape="rect" id="node57" href="../../df/d15/init_8tools_8c.html#acefd26944dbbb1c289886f520f6befac" title="init_dsandvels" alt="" coords="3805,939,3909,968"/><area shape="rect" id="node59" href="../../df/d15/init_8tools_8c.html#a77551ab2581efdbaf170dfca073ff9ab" title="user1_init_primitives" alt="" coords="4157,679,4299,708"/><area shape="rect" id="node61" href="../../de/db2/initbase_8funcdeclare_8h.html#a0afa200a5f947b1c9f6e554519f28fc4" title="init_primitives" alt="" coords="4348,653,4449,683"/><area shape="rect" id="node63" href="../../de/df8/initbase_8c.html#ac4110398e386c9888d9565630357dbbe" title="General&#45;Primary init() routine Uses globals inside init() because sets memory and sets physics..." alt="" coords="4527,601,4564,631"/><area shape="rect" id="node70" href="../../de/d51/bounds_8c.html#a3bc773d499b145705bdc23125b963840" title="Koral specific physical boundary conditions." alt="" coords="1452,621,1652,651"/><area shape="rect" id="node159" href="../../de/d51/bounds_8c.html#a09a080d9895db7b800a3824cb3fac9f1" title="X1 lower for beam injection to create shadow." alt="" coords="1472,675,1632,704"/><area shape="rect" id="node162" href="../../de/d51/bounds_8c.html#a3ee134cc5fb18752265c16a20dbdfb63" title="X3 lower for radiation beam injection." alt="" coords="1455,728,1649,757"/><area shape="rect" id="node165" href="../../de/d51/bounds_8c.html#a8300ddf3ae6a3866234cc0e9c12f26dc" title="X1 upper for inflow." alt="" coords="1459,781,1645,811"/><area shape="rect" id="node168" href="../../de/d51/bounds_8c.html#a01088f65c7a4cfa2ebfed202f815b951" title="X1 lower and upper for RADATM." alt="" coords="1467,835,1637,864"/><area shape="rect" id="node171" href="../../de/d51/bounds_8c.html#a1382959a7b699ea5d224168612504263" title="X1 upper for inflow." alt="" coords="1213,883,1360,912"/><area shape="rect" id="node174" href="../../de/d51/bounds_8c.html#ac15824bc610943cb7e02112e77b94752" title="on&#45;grid bounding" alt="" coords="1237,308,1336,337"/><area shape="rect" id="node177" href="../../de/d51/bounds_8c.html#a42658c4ecf3c6edb958394eb65a9ac2b" title="RADNT." alt="" coords="1240,361,1333,391"/><area shape="rect" id="node180" href="../../de/d51/bounds_8c.html#a3e4008fd24427b2e91d0ae5882b9536a" title="X1 upper for RADCYLBEAM." alt="" coords="1204,415,1369,444"/><area shape="rect" id="node183" href="../../de/d51/bounds_8c.html#ac32c1a20138382904dc5f1c66778ad8b" title="X1 upper for RADCYLJET." alt="" coords="1213,468,1360,497"/><area shape="rect" id="node186" href="../../de/d51/bounds_8c.html#a635fbaba3d6d6afcf5f34bbb2c278737" title="X2 upper for radiation beam injection." alt="" coords="1172,521,1401,551"/><area shape="rect" id="node189" href="../../de/d51/bounds_8c.html#a9f1df4e461f3f776bf3cb80e36a4d6df" title="get_radcylbeamcart" alt="" coords="1219,575,1355,604"/><area shape="rect" id="node72" href="../../de/d51/bounds_8c.html#a34ac3f1ca7b0f3a21053c633da9931a9" title="user boundary routine" alt="" coords="1701,595,1872,624"/><area shape="rect" id="node74" href="../../d4/dad/bounds_8funcdeclare_8h.html#a4bc7413b2cdb89e070f38bbb689ae555" title="bound_prim_user_dir" alt="" coords="1924,509,2065,539"/><area shape="rect" id="node148" href="../../d4/dad/bounds_8funcdeclare_8h.html#a2fbddc9ff8fc706bafa80c39695c7262" title="assume single user function takes care of primitive locations" alt="" coords="1920,695,2069,724"/><area shape="rect" id="node76" href="../../d9/de0/step__ch_8c.html#adbe0e3ba8a74f09ab928a96bd68cab6d" title="bound any prim type CALLS directly real and MPI boundary functions pstag = pstagglobal ucons = unewgl..." alt="" coords="2119,452,2228,481"/><area shape="rect" id="node78" href="../../d9/de0/step__ch_8c.html#a689fddc1949b1a1d390b59d10d17d83c" title="normal full bounding during evolution NOTEMARK: Was previously also bounding pstag here..." alt="" coords="2296,139,2421,168"/><area shape="rect" id="node84" href="../../d9/de0/step__ch_8c.html#a4079244d85c301885c1363ca41502869" title="simple bounding during evolution NOTEMARK: Was previously also bounding pstag here, but not necessary since done by calling bound_pstag in fluxctstag.c" alt="" coords="2277,85,2440,115"/><area shape="rect" id="node87" href="../../d9/de0/step__ch_8c.html#addca75a18cc861326a321565a2e81aa0" title="normal bounding of non&#45;staggered primitives" alt="" coords="2315,452,2403,481"/><area shape="rect" id="node142" href="../../d9/de0/step__ch_8c.html#a460b84e1112e3aef17209c20e22e1cf1" title="bound all prims" alt="" coords="2780,768,2903,797"/><area shape="rect" id="node80" href="../../d9/de0/step__ch_8c.html#ad36a0f9f915547477e3bb2405f8166b9" title="things to do after advance()" alt="" coords="2541,72,2643,101"/><area shape="rect" id="node89" href="../../dc/dae/flux_8c.html#aef355ccd1ca2295b84ad2fe1fc011d35" title="normal interpolation of CENT quantities to FACE quantities sets global variables pl_ct and pr_ct to p..." alt="" coords="2503,176,2681,205"/><area shape="rect" id="node101" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aecb3f613a7cb3bbb42fff2dbee5d65a1" title="This vpot2field function is for staggered method to evolve quasi&#45;deaveraged fields (i..." alt="" coords="3215,665,3380,695"/><area shape="rect" id="node103" href="../../de/db2/initbase_8funcdeclare_8h.html#ae6b2ad4cd0debf5b89ba8a9e471d6977" title="assumes normal field p pleft used as temp var if FLUXB==FLUXCTSTAG assigns conserved field in UEVOLVE..." alt="" coords="3436,651,3513,680"/><area shape="rect" id="node112" href="../../d0/dde/fluxctstag_8c.html#a4e3d76c6ad125b8199948408c262e3a1" title="wrapper for: 1) interpolate FACE 2 CORN 2) loop over dimensions setting field flux dimension&#45;by&#45;dimen..." alt="" coords="3011,317,3141,347"/><area shape="rect" id="node115" href="../../d0/dde/fluxctstag_8c.html#a2dd789bf1402bef72523cdb69e85806e" title="use global pbcorninterp and pvcorninterp at CORN1,2,3 to obtain EMFs at CORN1,2,3 NO interpolation of..." alt="" coords="2527,229,2657,275"/><area shape="rect" id="node118" href="../../d0/dde/fluxctstag_8c.html#aaec26a518629175ecceefbaf6c84225e" title="wrapper for continuous interpolation for FACE_to_CENT" alt="" coords="2505,504,2679,533"/><area shape="rect" id="node122" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aa31dd83c96936277334c62e2098dd51d" title="wrapper for taking staggered conserved field quantity and obtaining centered field quantity upoint en..." alt="" coords="2988,443,3164,472"/><area shape="rect" id="node131" href="../../d0/dde/fluxctstag_8c.html#a6cd90dff56319085b32bc57c0c8b3cfd" title="this function called in initbase.c and during advance() here ustag is point value if dimension doesn&#39;..." alt="" coords="2781,443,2901,472"/><area shape="rect" id="node134" href="../../d0/dde/fluxctstag_8c.html#ad6aa918442f7768dff3c099ba353ee64" title="slope_lim_face2corn() is provided p2interp and returns pleft/pright differs from slope_lim() by range..." alt="" coords="2521,299,2663,328"/><area shape="rect" id="node91" href="../../dc/dae/flux_8c.html#a2602a4dad9ed7adc944227d02435312e" title="standard (non&#45;field flux) calculation but setup to store results of interpolation so can be used for ..." alt="" coords="2744,180,2939,209"/><area shape="rect" id="node93" href="../../dc/dae/flux_8c.html#aaf6d832880760f80459d91477c28b519" title="wrapper for different standard 1&#45;D flux calculators 1&#45;D interpolate and get flux for that direction (..." alt="" coords="3019,240,3133,269"/><area shape="rect" id="node95" href="../../dc/dae/flux_8c.html#a8ffa7399bd5354fdcdec5f3e1adf0b13" title="wrapper for CENT_to_FACE1,2,3 used to compute flux at face" alt="" coords="3251,283,3344,312"/><area shape="rect" id="node97" href="../../d5/d2f/flux_8funcdeclare_8h.html#ab229b0f3f2caf3c0a3ef5299fba2b1c0" title="see fluxcompute.c for non&#45;computer science, real physics calculations of flux" alt="" coords="3441,337,3508,367"/><area shape="rect" id="node105" href="../../df/d15/init_8tools_8c.html#a3750bc790613bc6c8c805af0f1b839c8" title="user1_init_vpot2field_user" alt="" coords="3568,677,3741,707"/><area shape="rect" id="node107" href="../../de/db2/initbase_8funcdeclare_8h.html#afda44281ad5c163455c40f012d4a8954" title="init_vpot2field_user" alt="" coords="3791,677,3924,707"/><area shape="rect" id="node109" href="../../de/db2/initbase_8funcdeclare_8h.html#a90699a18ede8b7f112c0078512804ec1" title="initialize vector potential given user function assumes normal non&#45;staggered field in pr Notice that ..." alt="" coords="4007,677,4076,707"/><area shape="rect" id="node120" href="../../d0/dde/fluxctstag_8c.html#a5e3dcbe89d6f8a9384cafb58afd7dbf4" title="interpolates field at FACE to field at CENT assuming field along itself is continuous" alt="" coords="2781,495,2901,542"/><area shape="rect" id="node126" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aaa24493002bc8c0a527b1ea2ac2dddbf" title="convert conservative U to stag point P and CENT point U and CENT point primitive" alt="" coords="3231,511,3364,540"/><area shape="rect" id="node136" href="../../d0/dde/fluxctstag_8c.html#a985ee116306b4011810334ae93900493" title="INPUTS: Nvec, pr, primface_l[dir], primface_r[dir] OUTPUTS: pbcorn[dir][side], pvcorn[dir][side][side..." alt="" coords="2752,288,2931,317"/><area shape="rect" id="node144" href="../../d9/de0/step__ch_8c.html#a91fe5c4370e3292a19e7f794797a407f" title="normal bounding of all primitives" alt="" coords="3991,731,4092,760"/><area shape="rect" id="node150" href="../../d9/de0/step__ch_8c.html#abdea68b778dc9253324da69d3c376965" title="bound any pstag type CALLS directly real and MPI boundary functions pstag is at FACE1,2,3 for fields, so user bound is different MPI bounding is the same as CENT quantities used when restarting in initbase.c to bound unewglobal for FLUXB==FLUXCTSTAG" alt="" coords="2533,821,2651,851"/><area shape="rect" id="node153" href="../../d9/de0/step__ch_8c.html#a6f4b963a50a7288964f01775f2f18bb9" title="normal bounding of staggered primitives" alt="" coords="2793,821,2889,851"/><area shape="rect" id="node156" href="../../d0/dde/fluxctstag_8c.html#aa169cb1999412f2e2460012cc5d7a804" title="pure DONOR version: upoint is input staggered updated field that needs to be converted to pstag and t..." alt="" coords="2988,818,3164,865"/><area shape="rect" id="node191" href="../../de/d51/bounds_8c.html#a16398a5325a9df48783423f00ba65bb7" title="all boundaries for RADCYLBEAMCART" alt="" coords="1476,568,1628,597"/><area shape="rect" id="node196" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a7e078cc9a354495bc85554d875a705d9" title="General explicit inversion of U[MHD]&#45;&gt;P[MHD] and also inverts scalars. Inverts radiation if(EOMRADTYP..." alt="" coords="3431,989,3519,1019"/><area shape="rect" id="node200" href="../../d8/d60/init_8c.html#af3b64278d50c2ff0fee80291fbd38dab" title="fieldprim" alt="" coords="3620,989,3689,1019"/><area shape="rect" id="node206" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a8db9dc7c7f52d6fcb405a74e519db5cf" title="there may be something wrong with this function  didn&#39;t work in TIMEORDER==4, had to do standard met..." alt="" coords="3609,1043,3700,1072"/><area shape="rect" id="node203" href="../../de/db2/initbase_8funcdeclare_8h.html#a4e121b9448ac1adaa7608206369f9ea5" title="init_postvpot" alt="" coords="3993,835,4089,864"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7dc2e853cec9b6f9a5e83ce23c468d03"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> calc_LTE_NfromT </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td>
          <td class="paramname"><em>T</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>nrad(T) = nrad=arad T^3/2.70118 (this is LTE only if put in T was gas T) </p>

<p>Definition at line <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html#l14188">14188</a> of file <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html">phys.tools.rad.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d21/global_8funcdeclare_8rad_8h_a7dc2e853cec9b6f9a5e83ce23c468d03_icgraph.png" border="0" usemap="#df/d21/global_8funcdeclare_8rad_8h_a7dc2e853cec9b6f9a5e83ce23c468d03_icgraph" alt=""/></div>
<map name="df/d21/global_8funcdeclare_8rad_8h_a7dc2e853cec9b6f9a5e83ce23c468d03_icgraph" id="df/d21/global_8funcdeclare_8rad_8h_a7dc2e853cec9b6f9a5e83ce23c468d03_icgraph">
<area shape="rect" id="node3" href="../../d2/d72/phys_8tools_8rad_8c.html#a41e256325d07de60fa8b6b8e743cf7b8" title="get {abs} and {es} in /mass * rho = 1/cm form." alt="" coords="608,163,805,192"/><area shape="rect" id="node40" href="../../d2/d72/phys_8tools_8rad_8c.html#a3e47afcfc5c42719999d851395fd032d" title="nrad(E)" alt="" coords="183,188,311,217"/><area shape="rect" id="node5" href="../../d2/d72/phys_8tools_8rad_8c.html#ab62b07a8cbcc04f20c05a468ad6de636" title="compute G^ 4&#45;force" alt="" coords="1032,163,1101,192"/><area shape="rect" id="node7" href="../../d2/d72/phys_8tools_8rad_8c.html#aaa32f967773a287ecb6647732157606f" title="get G_" alt="" coords="1704,163,1773,192"/><area shape="rect" id="node9" href="../../d2/d72/phys_8tools_8rad_8c.html#a2a80e3b7ea37b9536f0e49cc740425c9" title="get 4&#45;force for all pl&#39;s" alt="" coords="1897,163,2049,192"/><area shape="rect" id="node11" href="../../d2/d72/phys_8tools_8rad_8c.html#af46d2b1cf89a70a7e2ef503146c649a9" title="uu0 &#45; original cons." alt="" coords="2323,163,2397,192"/><area shape="rect" id="node13" href="../../d2/d72/phys_8tools_8rad_8c.html#a17aede36203a236390363af78d3a86f0" title="compute changes to U (both T and R) using implicit method KORALTODO: If doing implicit, should also add geometry source term that can sometimes be stiff." alt="" coords="2675,163,2883,192"/><area shape="rect" id="node37" href="../../d2/d72/phys_8tools_8rad_8c.html#afa73a2caa3209e565a64f92447058507" title="calculating approximate Jacobian: dUresid(dUrad,G(Urad))/dUrad = dy(x)/dx then compute inverse Jacobi..." alt="" coords="2493,112,2597,141"/><area shape="rect" id="node15" href="../../d2/d72/phys_8tools_8rad_8c.html#a675bb3f12a77c62cf2540bc42c4867f8" title="wrapper for mode method" alt="" coords="2944,163,3112,192"/><area shape="rect" id="node17" href="../../d2/d72/phys_8tools_8rad_8c.html#aa8c5c0d5de580899948f9f22e10aff23" title="General radiation source term calculation (EXTERNALLY called) NOTE: source_explicit() takes as first ..." alt="" coords="3203,163,3323,192"/><area shape="rect" id="node19" href="../../d2/d1d/sources_8c.html#a504ce383765ca3d2ff0b1ee653aff854" title="Ugeomfree and dUother are in UNOTHING form (or UEVOLVE without geometry) pf might be modified so bett..." alt="" coords="3431,163,3537,192"/><area shape="rect" id="node21" href="../../d7/def/phys_8tools_8c.html#a12ce5092c3a1a566cb7a560a7440acc1" title="add in source terms to equations of motion ui and dUriemann in UEVOLVE form assume q(pr) so consisten..." alt="" coords="3631,291,3692,320"/><area shape="rect" id="node23" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="3777,291,3905,320"/><area shape="rect" id="node35" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="3764,383,3919,412"/><area shape="rect" id="node25" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="4009,227,4079,256"/><area shape="rect" id="node27" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="4161,169,4295,199"/><area shape="rect" id="node29" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="4381,348,4448,377"/><area shape="rect" id="node31" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="4687,457,4777,487"/><area shape="rect" id="node33" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="4827,559,4877,588"/><area shape="rect" id="node42" href="../../d2/d72/phys_8tools_8rad_8c.html#a8242523b45077ccd783a2867dddb731a" title="compute Trad (also computed directly in calc_Gu() above) using only primitives (not using conserved q..." alt="" coords="668,109,745,139"/><area shape="rect" id="node46" href="../../d2/d72/phys_8tools_8rad_8c.html#a864793af319e70c0d099679fa81dd398" title="compute Trad (also computed directly in calc_Gu() above) using only primitives (not using conserved q..." alt="" coords="360,161,560,191"/><area shape="rect" id="node50" href="../../d2/d72/phys_8tools_8rad_8c.html#a67b370af2fa58283bc590ff4e895fb90" title="Like u2p_rad_orig(), but uses Jon&#39;s paper draft ZAMO RAD version." alt="" coords="411,215,509,244"/><area shape="rect" id="node44" href="../../d2/d72/phys_8tools_8rad_8c.html#a3ad3833ac14b93095e76f8d915c5c9ad" title="calcfull_Trad" alt="" coords="865,109,961,139"/><area shape="rect" id="node52" href="../../d2/d72/phys_8tools_8rad_8c.html#aca8e86da8eb620a3a3e3487b420df3e1" title="u2p_rad" alt="" coords="673,216,740,245"/><area shape="rect" id="node54" href="../../d2/d72/phys_8tools_8rad_8c.html#a2ec6ee79c76351868a725b22dac62135" title="like prad_fforlab() but for only whichdir=FF2LAB used for IC" alt="" coords="868,428,959,457"/><area shape="rect" id="node197" href="../../d1/d3e/utoprimgen_8c.html#a0a83e9e7fdd3cc595c5b8d0df88ec684" title="just picks the algorithm to invert" alt="" coords="853,215,973,244"/><area shape="rect" id="node56" href="../../d2/d72/phys_8tools_8rad_8c.html#af50896d039d660550b738862b3390b07" title="radiative ortonormal ff primitives (E,F^i) &lt;&#45;&gt; primitives in lab frame Used only for initial conditio..." alt="" coords="1021,589,1112,619"/><area shape="rect" id="node58" href="../../d8/d60/init_8c.html#af94364e17d67cddfbb7bb3bf39c05ee6" title="init_dsandvels_koral" alt="" coords="2112,875,2251,904"/><area shape="rect" id="node69" href="../../d8/d60/init_8c.html#a448cd3fd9a1d862485e7b6e67b965172" title="process_restart_toget\l_radiation" alt="" coords="1161,615,1308,662"/><area shape="rect" id="node71" href="../../d2/d72/phys_8tools_8rad_8c.html#a64226cb28f52020ffe18ac6c6b1a2f5c" title="Input: start with pin [with fluid in whichvel velocity and whichcoordfluid coordinates (PRIMECOORDS o..." alt="" coords="1169,546,1300,593"/><area shape="rect" id="node60" href="../../df/d15/init_8tools_8c.html#acefd26944dbbb1c289886f520f6befac" title="init_dsandvels" alt="" coords="3992,735,4096,764"/><area shape="rect" id="node62" href="../../df/d15/init_8tools_8c.html#a77551ab2581efdbaf170dfca073ff9ab" title="user1_init_primitives" alt="" coords="4344,769,4485,799"/><area shape="rect" id="node64" href="../../de/db2/initbase_8funcdeclare_8h.html#a0afa200a5f947b1c9f6e554519f28fc4" title="init_primitives" alt="" coords="4535,732,4636,761"/><area shape="rect" id="node66" href="../../de/df8/initbase_8c.html#ac4110398e386c9888d9565630357dbbe" title="General&#45;Primary init() routine Uses globals inside init() because sets memory and sets physics..." alt="" coords="4713,659,4751,688"/><area shape="rect" id="node73" href="../../de/d51/bounds_8c.html#a3bc773d499b145705bdc23125b963840" title="Koral specific physical boundary conditions." alt="" coords="1639,473,1839,503"/><area shape="rect" id="node162" href="../../de/d51/bounds_8c.html#a09a080d9895db7b800a3824cb3fac9f1" title="X1 lower for beam injection to create shadow." alt="" coords="1659,527,1819,556"/><area shape="rect" id="node165" href="../../de/d51/bounds_8c.html#a3ee134cc5fb18752265c16a20dbdfb63" title="X3 lower for radiation beam injection." alt="" coords="1641,580,1836,609"/><area shape="rect" id="node168" href="../../de/d51/bounds_8c.html#a8300ddf3ae6a3866234cc0e9c12f26dc" title="X1 upper for inflow." alt="" coords="1645,633,1832,663"/><area shape="rect" id="node171" href="../../de/d51/bounds_8c.html#a01088f65c7a4cfa2ebfed202f815b951" title="X1 lower and upper for RADATM." alt="" coords="1653,687,1824,716"/><area shape="rect" id="node174" href="../../de/d51/bounds_8c.html#a1382959a7b699ea5d224168612504263" title="X1 upper for inflow." alt="" coords="1400,733,1547,763"/><area shape="rect" id="node177" href="../../de/d51/bounds_8c.html#ac15824bc610943cb7e02112e77b94752" title="on&#45;grid bounding" alt="" coords="1424,787,1523,816"/><area shape="rect" id="node180" href="../../de/d51/bounds_8c.html#a42658c4ecf3c6edb958394eb65a9ac2b" title="RADNT." alt="" coords="1427,840,1520,869"/><area shape="rect" id="node183" href="../../de/d51/bounds_8c.html#a3e4008fd24427b2e91d0ae5882b9536a" title="X1 upper for RADCYLBEAM." alt="" coords="1391,267,1556,296"/><area shape="rect" id="node186" href="../../de/d51/bounds_8c.html#ac32c1a20138382904dc5f1c66778ad8b" title="X1 upper for RADCYLJET." alt="" coords="1400,320,1547,349"/><area shape="rect" id="node189" href="../../de/d51/bounds_8c.html#a635fbaba3d6d6afcf5f34bbb2c278737" title="X2 upper for radiation beam injection." alt="" coords="1359,373,1588,403"/><area shape="rect" id="node192" href="../../de/d51/bounds_8c.html#a9f1df4e461f3f776bf3cb80e36a4d6df" title="get_radcylbeamcart" alt="" coords="1405,427,1541,456"/><area shape="rect" id="node75" href="../../de/d51/bounds_8c.html#a34ac3f1ca7b0f3a21053c633da9931a9" title="user boundary routine" alt="" coords="1888,563,2059,592"/><area shape="rect" id="node77" href="../../d4/dad/bounds_8funcdeclare_8h.html#a4bc7413b2cdb89e070f38bbb689ae555" title="bound_prim_user_dir" alt="" coords="2111,553,2252,583"/><area shape="rect" id="node151" href="../../d4/dad/bounds_8funcdeclare_8h.html#a2fbddc9ff8fc706bafa80c39695c7262" title="assume single user function takes care of primitive locations" alt="" coords="2107,695,2256,724"/><area shape="rect" id="node79" href="../../d9/de0/step__ch_8c.html#adbe0e3ba8a74f09ab928a96bd68cab6d" title="bound any prim type CALLS directly real and MPI boundary functions pstag = pstagglobal ucons = unewgl..." alt="" coords="2305,544,2415,573"/><area shape="rect" id="node81" href="../../d9/de0/step__ch_8c.html#a689fddc1949b1a1d390b59d10d17d83c" title="normal full bounding during evolution NOTEMARK: Was previously also bounding pstag here..." alt="" coords="2483,59,2608,88"/><area shape="rect" id="node87" href="../../d9/de0/step__ch_8c.html#a4079244d85c301885c1363ca41502869" title="simple bounding during evolution NOTEMARK: Was previously also bounding pstag here, but not necessary since done by calling bound_pstag in fluxctstag.c" alt="" coords="2464,5,2627,35"/><area shape="rect" id="node90" href="../../d9/de0/step__ch_8c.html#addca75a18cc861326a321565a2e81aa0" title="normal bounding of non&#45;staggered primitives" alt="" coords="2501,544,2589,573"/><area shape="rect" id="node145" href="../../d9/de0/step__ch_8c.html#a460b84e1112e3aef17209c20e22e1cf1" title="bound all prims" alt="" coords="2967,955,3089,984"/><area shape="rect" id="node83" href="../../d9/de0/step__ch_8c.html#ad36a0f9f915547477e3bb2405f8166b9" title="things to do after advance()" alt="" coords="2728,59,2829,88"/><area shape="rect" id="node92" href="../../dc/dae/flux_8c.html#aef355ccd1ca2295b84ad2fe1fc011d35" title="normal interpolation of CENT quantities to FACE quantities sets global variables pl_ct and pr_ct to p..." alt="" coords="2689,440,2868,469"/><area shape="rect" id="node104" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aecb3f613a7cb3bbb42fff2dbee5d65a1" title="This vpot2field function is for staggered method to evolve quasi&#45;deaveraged fields (i..." alt="" coords="3401,817,3567,847"/><area shape="rect" id="node106" href="../../de/db2/initbase_8funcdeclare_8h.html#ae6b2ad4cd0debf5b89ba8a9e471d6977" title="assumes normal field p pleft used as temp var if FLUXB==FLUXCTSTAG assigns conserved field in UEVOLVE..." alt="" coords="3623,773,3700,803"/><area shape="rect" id="node115" href="../../d0/dde/fluxctstag_8c.html#a4e3d76c6ad125b8199948408c262e3a1" title="wrapper for: 1) interpolate FACE 2 CORN 2) loop over dimensions setting field flux dimension&#45;by&#45;dimen..." alt="" coords="3197,317,3328,347"/><area shape="rect" id="node118" href="../../d0/dde/fluxctstag_8c.html#a2dd789bf1402bef72523cdb69e85806e" title="use global pbcorninterp and pvcorninterp at CORN1,2,3 to obtain EMFs at CORN1,2,3 NO interpolation of..." alt="" coords="2713,370,2844,417"/><area shape="rect" id="node121" href="../../d0/dde/fluxctstag_8c.html#aaec26a518629175ecceefbaf6c84225e" title="wrapper for continuous interpolation for FACE_to_CENT" alt="" coords="2692,544,2865,573"/><area shape="rect" id="node125" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aa31dd83c96936277334c62e2098dd51d" title="wrapper for taking staggered conserved field quantity and obtaining centered field quantity upoint en..." alt="" coords="3175,533,3351,563"/><area shape="rect" id="node134" href="../../d0/dde/fluxctstag_8c.html#a6cd90dff56319085b32bc57c0c8b3cfd" title="this function called in initbase.c and during advance() here ustag is point value if dimension doesn&#39;..." alt="" coords="2968,595,3088,624"/><area shape="rect" id="node137" href="../../d0/dde/fluxctstag_8c.html#ad6aa918442f7768dff3c099ba353ee64" title="slope_lim_face2corn() is provided p2interp and returns pleft/pright differs from slope_lim() by range..." alt="" coords="2708,267,2849,296"/><area shape="rect" id="node94" href="../../dc/dae/flux_8c.html#a2602a4dad9ed7adc944227d02435312e" title="standard (non&#45;field flux) calculation but setup to store results of interpolation so can be used for ..." alt="" coords="2931,421,3125,451"/><area shape="rect" id="node96" href="../../dc/dae/flux_8c.html#aaf6d832880760f80459d91477c28b519" title="wrapper for different standard 1&#45;D flux calculators 1&#45;D interpolate and get flux for that direction (..." alt="" coords="3205,396,3320,425"/><area shape="rect" id="node98" href="../../dc/dae/flux_8c.html#a8ffa7399bd5354fdcdec5f3e1adf0b13" title="wrapper for CENT_to_FACE1,2,3 used to compute flux at face" alt="" coords="3437,369,3531,399"/><area shape="rect" id="node100" href="../../d5/d2f/flux_8funcdeclare_8h.html#ab229b0f3f2caf3c0a3ef5299fba2b1c0" title="see fluxcompute.c for non&#45;computer science, real physics calculations of flux" alt="" coords="3628,357,3695,387"/><area shape="rect" id="node108" href="../../df/d15/init_8tools_8c.html#a3750bc790613bc6c8c805af0f1b839c8" title="user1_init_vpot2field_user" alt="" coords="3755,788,3928,817"/><area shape="rect" id="node110" href="../../de/db2/initbase_8funcdeclare_8h.html#afda44281ad5c163455c40f012d4a8954" title="init_vpot2field_user" alt="" coords="3977,788,4111,817"/><area shape="rect" id="node112" href="../../de/db2/initbase_8funcdeclare_8h.html#a90699a18ede8b7f112c0078512804ec1" title="initialize vector potential given user function assumes normal non&#45;staggered field in pr Notice that ..." alt="" coords="4193,788,4263,817"/><area shape="rect" id="node123" href="../../d0/dde/fluxctstag_8c.html#a5e3dcbe89d6f8a9384cafb58afd7dbf4" title="interpolates field at FACE to field at CENT assuming field along itself is continuous" alt="" coords="2968,525,3088,571"/><area shape="rect" id="node129" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aaa24493002bc8c0a527b1ea2ac2dddbf" title="convert conservative U to stag point P and CENT point U and CENT point primitive" alt="" coords="3417,579,3551,608"/><area shape="rect" id="node139" href="../../d0/dde/fluxctstag_8c.html#a985ee116306b4011810334ae93900493" title="INPUTS: Nvec, pr, primface_l[dir], primface_r[dir] OUTPUTS: pbcorn[dir][side], pvcorn[dir][side][side..." alt="" coords="2939,267,3117,296"/><area shape="rect" id="node147" href="../../d9/de0/step__ch_8c.html#a91fe5c4370e3292a19e7f794797a407f" title="normal bounding of all primitives" alt="" coords="4177,955,4279,984"/><area shape="rect" id="node153" href="../../d9/de0/step__ch_8c.html#abdea68b778dc9253324da69d3c376965" title="bound any pstag type CALLS directly real and MPI boundary functions pstag is at FACE1,2,3 for fields, so user bound is different MPI bounding is the same as CENT quantities used when restarting in initbase.c to bound unewglobal for FLUXB==FLUXCTSTAG" alt="" coords="2720,1005,2837,1035"/><area shape="rect" id="node156" href="../../d9/de0/step__ch_8c.html#a6f4b963a50a7288964f01775f2f18bb9" title="normal bounding of staggered primitives" alt="" coords="2980,800,3076,829"/><area shape="rect" id="node159" href="../../d0/dde/fluxctstag_8c.html#aa169cb1999412f2e2460012cc5d7a804" title="pure DONOR version: upoint is input staggered updated field that needs to be converted to pstag and t..." alt="" coords="3175,783,3351,830"/><area shape="rect" id="node194" href="../../de/d51/bounds_8c.html#a16398a5325a9df48783423f00ba65bb7" title="all boundaries for RADCYLBEAMCART" alt="" coords="1663,420,1815,449"/><area shape="rect" id="node199" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a7e078cc9a354495bc85554d875a705d9" title="General explicit inversion of U[MHD]&#45;&gt;P[MHD] and also inverts scalars. Inverts radiation if(EOMRADTYP..." alt="" coords="3617,473,3705,503"/><area shape="rect" id="node203" href="../../d8/d60/init_8c.html#af3b64278d50c2ff0fee80291fbd38dab" title="fieldprim" alt="" coords="3807,683,3876,712"/><area shape="rect" id="node209" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a8db9dc7c7f52d6fcb405a74e519db5cf" title="there may be something wrong with this function  didn&#39;t work in TIMEORDER==4, had to do standard met..." alt="" coords="3796,473,3887,503"/><area shape="rect" id="node206" href="../../de/db2/initbase_8funcdeclare_8h.html#a4e121b9448ac1adaa7608206369f9ea5" title="init_postvpot" alt="" coords="4180,683,4276,712"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af07558357c906b4dfa61cd34656d9f02"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> calc_LTE_TfromE </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>E=urad=arad T^4 and just solve for T (this is LTE only if assume resulting T is gas T). If put in fluid-frame E, then correct T for radiation in fluid frame. </p>

<p>Definition at line <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html#l14201">14201</a> of file <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html">phys.tools.rad.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d21/global_8funcdeclare_8rad_8h_af07558357c906b4dfa61cd34656d9f02_icgraph.png" border="0" usemap="#df/d21/global_8funcdeclare_8rad_8h_af07558357c906b4dfa61cd34656d9f02_icgraph" alt=""/></div>
<map name="df/d21/global_8funcdeclare_8rad_8h_af07558357c906b4dfa61cd34656d9f02_icgraph" id="df/d21/global_8funcdeclare_8rad_8h_af07558357c906b4dfa61cd34656d9f02_icgraph">
<area shape="rect" id="node3" href="../../d2/d72/phys_8tools_8rad_8c.html#a8242523b45077ccd783a2867dddb731a" title="compute Trad (also computed directly in calc_Gu() above) using only primitives (not using conserved q..." alt="" coords="609,223,687,252"/><area shape="rect" id="node7" href="../../d2/d72/phys_8tools_8rad_8c.html#a864793af319e70c0d099679fa81dd398" title="compute Trad (also computed directly in calc_Gu() above) using only primitives (not using conserved q..." alt="" coords="360,171,560,200"/><area shape="rect" id="node47" href="../../d2/d72/phys_8tools_8rad_8c.html#a3e47afcfc5c42719999d851395fd032d" title="nrad(E)" alt="" coords="183,223,311,252"/><area shape="rect" id="node5" href="../../d2/d72/phys_8tools_8rad_8c.html#a3ad3833ac14b93095e76f8d915c5c9ad" title="calcfull_Trad" alt="" coords="748,223,844,252"/><area shape="rect" id="node9" href="../../d2/d72/phys_8tools_8rad_8c.html#a41e256325d07de60fa8b6b8e743cf7b8" title="get {abs} and {es} in /mass * rho = 1/cm form." alt="" coords="904,133,1101,163"/><area shape="rect" id="node11" href="../../d2/d72/phys_8tools_8rad_8c.html#ab62b07a8cbcc04f20c05a468ad6de636" title="compute G^ 4&#45;force" alt="" coords="1189,84,1259,113"/><area shape="rect" id="node13" href="../../d2/d72/phys_8tools_8rad_8c.html#aaa32f967773a287ecb6647732157606f" title="get G_" alt="" coords="1693,37,1763,67"/><area shape="rect" id="node15" href="../../d2/d72/phys_8tools_8rad_8c.html#a2a80e3b7ea37b9536f0e49cc740425c9" title="get 4&#45;force for all pl&#39;s" alt="" coords="1887,35,2039,64"/><area shape="rect" id="node17" href="../../d2/d72/phys_8tools_8rad_8c.html#af46d2b1cf89a70a7e2ef503146c649a9" title="uu0 &#45; original cons." alt="" coords="2312,32,2387,61"/><area shape="rect" id="node19" href="../../d2/d72/phys_8tools_8rad_8c.html#a17aede36203a236390363af78d3a86f0" title="compute changes to U (both T and R) using implicit method KORALTODO: If doing implicit, should also add geometry source term that can sometimes be stiff." alt="" coords="2664,5,2872,35"/><area shape="rect" id="node43" href="../../d2/d72/phys_8tools_8rad_8c.html#afa73a2caa3209e565a64f92447058507" title="calculating approximate Jacobian: dUresid(dUrad,G(Urad))/dUrad = dy(x)/dx then compute inverse Jacobi..." alt="" coords="2483,32,2587,61"/><area shape="rect" id="node21" href="../../d2/d72/phys_8tools_8rad_8c.html#a675bb3f12a77c62cf2540bc42c4867f8" title="wrapper for mode method" alt="" coords="2933,5,3101,35"/><area shape="rect" id="node23" href="../../d2/d72/phys_8tools_8rad_8c.html#aa8c5c0d5de580899948f9f22e10aff23" title="General radiation source term calculation (EXTERNALLY called) NOTE: source_explicit() takes as first ..." alt="" coords="3192,109,3312,139"/><area shape="rect" id="node25" href="../../d2/d1d/sources_8c.html#a504ce383765ca3d2ff0b1ee653aff854" title="Ugeomfree and dUother are in UNOTHING form (or UEVOLVE without geometry) pf might be modified so bett..." alt="" coords="3420,216,3527,245"/><area shape="rect" id="node27" href="../../d7/def/phys_8tools_8c.html#a12ce5092c3a1a566cb7a560a7440acc1" title="add in source terms to equations of motion ui and dUriemann in UEVOLVE form assume q(pr) so consisten..." alt="" coords="3620,284,3681,313"/><area shape="rect" id="node29" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="3767,337,3895,367"/><area shape="rect" id="node41" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="3753,416,3908,445"/><area shape="rect" id="node31" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="3999,293,4068,323"/><area shape="rect" id="node33" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="4151,205,4284,235"/><area shape="rect" id="node35" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="4371,339,4437,368"/><area shape="rect" id="node37" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="4676,439,4767,468"/><area shape="rect" id="node39" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="4816,520,4867,549"/><area shape="rect" id="node51" href="../../d2/d72/phys_8tools_8rad_8c.html#a67b370af2fa58283bc590ff4e895fb90" title="Like u2p_rad_orig(), but uses Jon&#39;s paper draft ZAMO RAD version." alt="" coords="411,527,509,556"/><area shape="rect" id="node53" href="../../d2/d72/phys_8tools_8rad_8c.html#aca8e86da8eb620a3a3e3487b420df3e1" title="u2p_rad" alt="" coords="615,627,681,656"/><area shape="rect" id="node55" href="../../d2/d72/phys_8tools_8rad_8c.html#a2ec6ee79c76351868a725b22dac62135" title="like prad_fforlab() but for only whichdir=FF2LAB used for IC" alt="" coords="751,627,841,656"/><area shape="rect" id="node198" href="../../d1/d3e/utoprimgen_8c.html#a0a83e9e7fdd3cc595c5b8d0df88ec684" title="just picks the algorithm to invert" alt="" coords="736,835,856,864"/><area shape="rect" id="node57" href="../../d2/d72/phys_8tools_8rad_8c.html#af50896d039d660550b738862b3390b07" title="radiative ortonormal ff primitives (E,F^i) &lt;&#45;&gt; primitives in lab frame Used only for initial conditio..." alt="" coords="957,627,1048,656"/><area shape="rect" id="node59" href="../../d8/d60/init_8c.html#af94364e17d67cddfbb7bb3bf39c05ee6" title="init_dsandvels_koral" alt="" coords="2101,937,2240,967"/><area shape="rect" id="node70" href="../../d8/d60/init_8c.html#a448cd3fd9a1d862485e7b6e67b965172" title="process_restart_toget\l_radiation" alt="" coords="1151,549,1297,595"/><area shape="rect" id="node72" href="../../d2/d72/phys_8tools_8rad_8c.html#a64226cb28f52020ffe18ac6c6b1a2f5c" title="Input: start with pin [with fluid in whichvel velocity and whichcoordfluid coordinates (PRIMECOORDS o..." alt="" coords="1159,618,1289,665"/><area shape="rect" id="node61" href="../../df/d15/init_8tools_8c.html#acefd26944dbbb1c289886f520f6befac" title="init_dsandvels" alt="" coords="3981,939,4085,968"/><area shape="rect" id="node63" href="../../df/d15/init_8tools_8c.html#a77551ab2581efdbaf170dfca073ff9ab" title="user1_init_primitives" alt="" coords="4333,679,4475,708"/><area shape="rect" id="node65" href="../../de/db2/initbase_8funcdeclare_8h.html#a0afa200a5f947b1c9f6e554519f28fc4" title="init_primitives" alt="" coords="4524,653,4625,683"/><area shape="rect" id="node67" href="../../de/df8/initbase_8c.html#ac4110398e386c9888d9565630357dbbe" title="General&#45;Primary init() routine Uses globals inside init() because sets memory and sets physics..." alt="" coords="4703,601,4740,631"/><area shape="rect" id="node74" href="../../de/d51/bounds_8c.html#a3bc773d499b145705bdc23125b963840" title="Koral specific physical boundary conditions." alt="" coords="1628,621,1828,651"/><area shape="rect" id="node163" href="../../de/d51/bounds_8c.html#a09a080d9895db7b800a3824cb3fac9f1" title="X1 lower for beam injection to create shadow." alt="" coords="1648,675,1808,704"/><area shape="rect" id="node166" href="../../de/d51/bounds_8c.html#a3ee134cc5fb18752265c16a20dbdfb63" title="X3 lower for radiation beam injection." alt="" coords="1631,728,1825,757"/><area shape="rect" id="node169" href="../../de/d51/bounds_8c.html#a8300ddf3ae6a3866234cc0e9c12f26dc" title="X1 upper for inflow." alt="" coords="1635,781,1821,811"/><area shape="rect" id="node172" href="../../de/d51/bounds_8c.html#a01088f65c7a4cfa2ebfed202f815b951" title="X1 lower and upper for RADATM." alt="" coords="1643,835,1813,864"/><area shape="rect" id="node175" href="../../de/d51/bounds_8c.html#a1382959a7b699ea5d224168612504263" title="X1 upper for inflow." alt="" coords="1389,883,1536,912"/><area shape="rect" id="node178" href="../../de/d51/bounds_8c.html#ac15824bc610943cb7e02112e77b94752" title="on&#45;grid bounding" alt="" coords="1413,308,1512,337"/><area shape="rect" id="node181" href="../../de/d51/bounds_8c.html#a42658c4ecf3c6edb958394eb65a9ac2b" title="RADNT." alt="" coords="1416,361,1509,391"/><area shape="rect" id="node184" href="../../de/d51/bounds_8c.html#a3e4008fd24427b2e91d0ae5882b9536a" title="X1 upper for RADCYLBEAM." alt="" coords="1380,415,1545,444"/><area shape="rect" id="node187" href="../../de/d51/bounds_8c.html#ac32c1a20138382904dc5f1c66778ad8b" title="X1 upper for RADCYLJET." alt="" coords="1389,468,1536,497"/><area shape="rect" id="node190" href="../../de/d51/bounds_8c.html#a635fbaba3d6d6afcf5f34bbb2c278737" title="X2 upper for radiation beam injection." alt="" coords="1348,521,1577,551"/><area shape="rect" id="node193" href="../../de/d51/bounds_8c.html#a9f1df4e461f3f776bf3cb80e36a4d6df" title="get_radcylbeamcart" alt="" coords="1395,575,1531,604"/><area shape="rect" id="node76" href="../../de/d51/bounds_8c.html#a34ac3f1ca7b0f3a21053c633da9931a9" title="user boundary routine" alt="" coords="1877,595,2048,624"/><area shape="rect" id="node78" href="../../d4/dad/bounds_8funcdeclare_8h.html#a4bc7413b2cdb89e070f38bbb689ae555" title="bound_prim_user_dir" alt="" coords="2100,523,2241,552"/><area shape="rect" id="node152" href="../../d4/dad/bounds_8funcdeclare_8h.html#a2fbddc9ff8fc706bafa80c39695c7262" title="assume single user function takes care of primitive locations" alt="" coords="2096,708,2245,737"/><area shape="rect" id="node80" href="../../d9/de0/step__ch_8c.html#adbe0e3ba8a74f09ab928a96bd68cab6d" title="bound any prim type CALLS directly real and MPI boundary functions pstag = pstagglobal ucons = unewgl..." alt="" coords="2295,452,2404,481"/><area shape="rect" id="node82" href="../../d9/de0/step__ch_8c.html#a689fddc1949b1a1d390b59d10d17d83c" title="normal full bounding during evolution NOTEMARK: Was previously also bounding pstag here..." alt="" coords="2472,139,2597,168"/><area shape="rect" id="node88" href="../../d9/de0/step__ch_8c.html#a4079244d85c301885c1363ca41502869" title="simple bounding during evolution NOTEMARK: Was previously also bounding pstag here, but not necessary since done by calling bound_pstag in fluxctstag.c" alt="" coords="2453,85,2616,115"/><area shape="rect" id="node91" href="../../d9/de0/step__ch_8c.html#addca75a18cc861326a321565a2e81aa0" title="normal bounding of non&#45;staggered primitives" alt="" coords="2491,452,2579,481"/><area shape="rect" id="node146" href="../../d9/de0/step__ch_8c.html#a460b84e1112e3aef17209c20e22e1cf1" title="bound all prims" alt="" coords="2956,768,3079,797"/><area shape="rect" id="node84" href="../../d9/de0/step__ch_8c.html#ad36a0f9f915547477e3bb2405f8166b9" title="things to do after advance()" alt="" coords="2717,72,2819,101"/><area shape="rect" id="node93" href="../../dc/dae/flux_8c.html#aef355ccd1ca2295b84ad2fe1fc011d35" title="normal interpolation of CENT quantities to FACE quantities sets global variables pl_ct and pr_ct to p..." alt="" coords="2679,176,2857,205"/><area shape="rect" id="node105" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aecb3f613a7cb3bbb42fff2dbee5d65a1" title="This vpot2field function is for staggered method to evolve quasi&#45;deaveraged fields (i..." alt="" coords="3391,665,3556,695"/><area shape="rect" id="node107" href="../../de/db2/initbase_8funcdeclare_8h.html#ae6b2ad4cd0debf5b89ba8a9e471d6977" title="assumes normal field p pleft used as temp var if FLUXB==FLUXCTSTAG assigns conserved field in UEVOLVE..." alt="" coords="3612,637,3689,667"/><area shape="rect" id="node116" href="../../d0/dde/fluxctstag_8c.html#a4e3d76c6ad125b8199948408c262e3a1" title="wrapper for: 1) interpolate FACE 2 CORN 2) loop over dimensions setting field flux dimension&#45;by&#45;dimen..." alt="" coords="3187,324,3317,353"/><area shape="rect" id="node119" href="../../d0/dde/fluxctstag_8c.html#a2dd789bf1402bef72523cdb69e85806e" title="use global pbcorninterp and pvcorninterp at CORN1,2,3 to obtain EMFs at CORN1,2,3 NO interpolation of..." alt="" coords="2703,229,2833,275"/><area shape="rect" id="node122" href="../../d0/dde/fluxctstag_8c.html#aaec26a518629175ecceefbaf6c84225e" title="wrapper for continuous interpolation for FACE_to_CENT" alt="" coords="2681,504,2855,533"/><area shape="rect" id="node126" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aa31dd83c96936277334c62e2098dd51d" title="wrapper for taking staggered conserved field quantity and obtaining centered field quantity upoint en..." alt="" coords="3164,443,3340,472"/><area shape="rect" id="node135" href="../../d0/dde/fluxctstag_8c.html#a6cd90dff56319085b32bc57c0c8b3cfd" title="this function called in initbase.c and during advance() here ustag is point value if dimension doesn&#39;..." alt="" coords="2957,443,3077,472"/><area shape="rect" id="node138" href="../../d0/dde/fluxctstag_8c.html#ad6aa918442f7768dff3c099ba353ee64" title="slope_lim_face2corn() is provided p2interp and returns pleft/pright differs from slope_lim() by range..." alt="" coords="2697,299,2839,328"/><area shape="rect" id="node95" href="../../dc/dae/flux_8c.html#a2602a4dad9ed7adc944227d02435312e" title="standard (non&#45;field flux) calculation but setup to store results of interpolation so can be used for ..." alt="" coords="2920,181,3115,211"/><area shape="rect" id="node97" href="../../dc/dae/flux_8c.html#aaf6d832880760f80459d91477c28b519" title="wrapper for different standard 1&#45;D flux calculators 1&#45;D interpolate and get flux for that direction (..." alt="" coords="3195,239,3309,268"/><area shape="rect" id="node99" href="../../dc/dae/flux_8c.html#a8ffa7399bd5354fdcdec5f3e1adf0b13" title="wrapper for CENT_to_FACE1,2,3 used to compute flux at face" alt="" coords="3427,275,3520,304"/><area shape="rect" id="node101" href="../../d5/d2f/flux_8funcdeclare_8h.html#ab229b0f3f2caf3c0a3ef5299fba2b1c0" title="see fluxcompute.c for non&#45;computer science, real physics calculations of flux" alt="" coords="3617,337,3684,367"/><area shape="rect" id="node109" href="../../df/d15/init_8tools_8c.html#a3750bc790613bc6c8c805af0f1b839c8" title="user1_init_vpot2field_user" alt="" coords="3744,677,3917,707"/><area shape="rect" id="node111" href="../../de/db2/initbase_8funcdeclare_8h.html#afda44281ad5c163455c40f012d4a8954" title="init_vpot2field_user" alt="" coords="3967,677,4100,707"/><area shape="rect" id="node113" href="../../de/db2/initbase_8funcdeclare_8h.html#a90699a18ede8b7f112c0078512804ec1" title="initialize vector potential given user function assumes normal non&#45;staggered field in pr Notice that ..." alt="" coords="4183,677,4252,707"/><area shape="rect" id="node124" href="../../d0/dde/fluxctstag_8c.html#a5e3dcbe89d6f8a9384cafb58afd7dbf4" title="interpolates field at FACE to field at CENT assuming field along itself is continuous" alt="" coords="2957,495,3077,542"/><area shape="rect" id="node130" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aaa24493002bc8c0a527b1ea2ac2dddbf" title="convert conservative U to stag point P and CENT point U and CENT point primitive" alt="" coords="3407,511,3540,540"/><area shape="rect" id="node140" href="../../d0/dde/fluxctstag_8c.html#a985ee116306b4011810334ae93900493" title="INPUTS: Nvec, pr, primface_l[dir], primface_r[dir] OUTPUTS: pbcorn[dir][side], pvcorn[dir][side][side..." alt="" coords="2928,288,3107,317"/><area shape="rect" id="node148" href="../../d9/de0/step__ch_8c.html#a91fe5c4370e3292a19e7f794797a407f" title="normal bounding of all primitives" alt="" coords="4167,731,4268,760"/><area shape="rect" id="node154" href="../../d9/de0/step__ch_8c.html#abdea68b778dc9253324da69d3c376965" title="bound any pstag type CALLS directly real and MPI boundary functions pstag is at FACE1,2,3 for fields, so user bound is different MPI bounding is the same as CENT quantities used when restarting in initbase.c to bound unewglobal for FLUXB==FLUXCTSTAG" alt="" coords="2709,821,2827,851"/><area shape="rect" id="node157" href="../../d9/de0/step__ch_8c.html#a6f4b963a50a7288964f01775f2f18bb9" title="normal bounding of staggered primitives" alt="" coords="2969,821,3065,851"/><area shape="rect" id="node160" href="../../d0/dde/fluxctstag_8c.html#aa169cb1999412f2e2460012cc5d7a804" title="pure DONOR version: upoint is input staggered updated field that needs to be converted to pstag and t..." alt="" coords="3164,818,3340,865"/><area shape="rect" id="node195" href="../../de/d51/bounds_8c.html#a16398a5325a9df48783423f00ba65bb7" title="all boundaries for RADCYLBEAMCART" alt="" coords="1652,568,1804,597"/><area shape="rect" id="node200" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a7e078cc9a354495bc85554d875a705d9" title="General explicit inversion of U[MHD]&#45;&gt;P[MHD] and also inverts scalars. Inverts radiation if(EOMRADTYP..." alt="" coords="3607,989,3695,1019"/><area shape="rect" id="node204" href="../../d8/d60/init_8c.html#af3b64278d50c2ff0fee80291fbd38dab" title="fieldprim" alt="" coords="3796,989,3865,1019"/><area shape="rect" id="node210" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a8db9dc7c7f52d6fcb405a74e519db5cf" title="there may be something wrong with this function  didn&#39;t work in TIMEORDER==4, had to do standard met..." alt="" coords="3785,1043,3876,1072"/><area shape="rect" id="node207" href="../../de/db2/initbase_8funcdeclare_8h.html#a4e121b9448ac1adaa7608206369f9ea5" title="init_postvpot" alt="" coords="4169,835,4265,864"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae2fe1c6debba576d29c23100d4e30704"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> calc_PEQ_Tfromurho </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html#l14174">14174</a> of file <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html">phys.tools.rad.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d21/global_8funcdeclare_8rad_8h_ae2fe1c6debba576d29c23100d4e30704_icgraph.png" border="0" usemap="#df/d21/global_8funcdeclare_8rad_8h_ae2fe1c6debba576d29c23100d4e30704_icgraph" alt=""/></div>
<map name="df/d21/global_8funcdeclare_8rad_8h_ae2fe1c6debba576d29c23100d4e30704_icgraph" id="df/d21/global_8funcdeclare_8rad_8h_ae2fe1c6debba576d29c23100d4e30704_icgraph">
<area shape="rect" id="node3" href="../../de/d51/bounds_8c.html#a01088f65c7a4cfa2ebfed202f815b951" title="X1 lower and upper for RADATM." alt="" coords="200,157,371,187"/><area shape="rect" id="node110" href="../../de/db2/initbase_8funcdeclare_8h.html#abd98493cc6574124e0b41c742a056eea" title="init_global" alt="" coords="3073,5,3153,35"/><area shape="rect" id="node113" href="../../d8/d60/init_8c.html#af94364e17d67cddfbb7bb3bf39c05ee6" title="init_dsandvels_koral" alt="" coords="643,179,781,208"/><area shape="rect" id="node118" href="../../d8/d60/init_8c.html#a73009fd6280963c265e2cf5d1c353e8d" title="get_full_rtsolution" alt="" coords="443,237,565,267"/><area shape="rect" id="node123" href="../../d8/d60/init_8c.html#a83e7f10ffd348c4d18b3245dd4bab585" title="make_nonrt2rt_solution" alt="" coords="207,211,364,240"/><area shape="rect" id="node5" href="../../de/d51/bounds_8c.html#a34ac3f1ca7b0f3a21053c633da9931a9" title="user boundary routine" alt="" coords="419,157,589,187"/><area shape="rect" id="node7" href="../../d4/dad/bounds_8funcdeclare_8h.html#a4bc7413b2cdb89e070f38bbb689ae555" title="bound_prim_user_dir" alt="" coords="641,232,783,261"/><area shape="rect" id="node99" href="../../d4/dad/bounds_8funcdeclare_8h.html#a2fbddc9ff8fc706bafa80c39695c7262" title="assume single user function takes care of primitive locations" alt="" coords="835,127,984,156"/><area shape="rect" id="node9" href="../../d9/de0/step__ch_8c.html#adbe0e3ba8a74f09ab928a96bd68cab6d" title="bound any prim type CALLS directly real and MPI boundary functions pstag = pstagglobal ucons = unewgl..." alt="" coords="855,537,964,567"/><area shape="rect" id="node11" href="../../d9/de0/step__ch_8c.html#a689fddc1949b1a1d390b59d10d17d83c" title="normal full bounding during evolution NOTEMARK: Was previously also bounding pstag here..." alt="" coords="1051,864,1176,893"/><area shape="rect" id="node24" href="../../d9/de0/step__ch_8c.html#a4079244d85c301885c1363ca41502869" title="simple bounding during evolution NOTEMARK: Was previously also bounding pstag here, but not necessary since done by calling bound_pstag in fluxctstag.c" alt="" coords="1032,917,1195,947"/><area shape="rect" id="node27" href="../../d9/de0/step__ch_8c.html#addca75a18cc861326a321565a2e81aa0" title="normal bounding of non&#45;staggered primitives" alt="" coords="1069,537,1157,567"/><area shape="rect" id="node93" href="../../d9/de0/step__ch_8c.html#a460b84e1112e3aef17209c20e22e1cf1" title="bound all prims" alt="" coords="1505,176,1628,205"/><area shape="rect" id="node13" href="../../d9/de0/step__ch_8c.html#ad36a0f9f915547477e3bb2405f8166b9" title="things to do after advance()" alt="" coords="1281,917,1383,947"/><area shape="rect" id="node15" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="2689,859,2823,888"/><area shape="rect" id="node17" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="2909,845,2976,875"/><area shape="rect" id="node19" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="3215,575,3305,604"/><area shape="rect" id="node21" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="3355,423,3405,452"/><area shape="rect" id="node29" href="../../dc/dae/flux_8c.html#aef355ccd1ca2295b84ad2fe1fc011d35" title="normal interpolation of CENT quantities to FACE quantities sets global variables pl_ct and pr_ct to p..." alt="" coords="1243,763,1421,792"/><area shape="rect" id="node46" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aecb3f613a7cb3bbb42fff2dbee5d65a1" title="This vpot2field function is for staggered method to evolve quasi&#45;deaveraged fields (i..." alt="" coords="1940,333,2105,363"/><area shape="rect" id="node48" href="../../de/db2/initbase_8funcdeclare_8h.html#ae6b2ad4cd0debf5b89ba8a9e471d6977" title="assumes normal field p pleft used as temp var if FLUXB==FLUXCTSTAG assigns conserved field in UEVOLVE..." alt="" coords="2156,359,2233,388"/><area shape="rect" id="node56" href="../../df/d15/init_8tools_8c.html#a77551ab2581efdbaf170dfca073ff9ab" title="user1_init_primitives" alt="" coords="2872,269,3013,299"/><area shape="rect" id="node60" href="../../de/df8/initbase_8c.html#ac4110398e386c9888d9565630357dbbe" title="General&#45;Primary init() routine Uses globals inside init() because sets memory and sets physics..." alt="" coords="3241,269,3279,299"/><area shape="rect" id="node63" href="../../d0/dde/fluxctstag_8c.html#a4e3d76c6ad125b8199948408c262e3a1" title="wrapper for: 1) interpolate FACE 2 CORN 2) loop over dimensions setting field flux dimension&#45;by&#45;dimen..." alt="" coords="1736,657,1867,687"/><area shape="rect" id="node66" href="../../d0/dde/fluxctstag_8c.html#a2dd789bf1402bef72523cdb69e85806e" title="use global pbcorninterp and pvcorninterp at CORN1,2,3 to obtain EMFs at CORN1,2,3 NO interpolation of..." alt="" coords="1267,589,1397,635"/><area shape="rect" id="node69" href="../../d0/dde/fluxctstag_8c.html#aaec26a518629175ecceefbaf6c84225e" title="wrapper for continuous interpolation for FACE_to_CENT" alt="" coords="1245,435,1419,464"/><area shape="rect" id="node73" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aa31dd83c96936277334c62e2098dd51d" title="wrapper for taking staggered conserved field quantity and obtaining centered field quantity upoint en..." alt="" coords="1713,503,1889,532"/><area shape="rect" id="node82" href="../../d0/dde/fluxctstag_8c.html#a6cd90dff56319085b32bc57c0c8b3cfd" title="this function called in initbase.c and during advance() here ustag is point value if dimension doesn&#39;..." alt="" coords="1507,555,1627,584"/><area shape="rect" id="node85" href="../../d0/dde/fluxctstag_8c.html#ad6aa918442f7768dff3c099ba353ee64" title="slope_lim_face2corn() is provided p2interp and returns pleft/pright differs from slope_lim() by range..." alt="" coords="1261,709,1403,739"/><area shape="rect" id="node31" href="../../dc/dae/flux_8c.html#a2602a4dad9ed7adc944227d02435312e" title="standard (non&#45;field flux) calculation but setup to store results of interpolation so can be used for ..." alt="" coords="1469,763,1664,792"/><area shape="rect" id="node33" href="../../dc/dae/flux_8c.html#aaf6d832880760f80459d91477c28b519" title="wrapper for different standard 1&#45;D flux calculators 1&#45;D interpolate and get flux for that direction (..." alt="" coords="1744,736,1859,765"/><area shape="rect" id="node35" href="../../dc/dae/flux_8c.html#a8ffa7399bd5354fdcdec5f3e1adf0b13" title="wrapper for CENT_to_FACE1,2,3 used to compute flux at face" alt="" coords="1976,719,2069,748"/><area shape="rect" id="node37" href="../../d5/d2f/flux_8funcdeclare_8h.html#ab229b0f3f2caf3c0a3ef5299fba2b1c0" title="see fluxcompute.c for non&#45;computer science, real physics calculations of flux" alt="" coords="2161,657,2228,687"/><area shape="rect" id="node39" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="2305,657,2433,687"/><area shape="rect" id="node44" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="2292,565,2447,595"/><area shape="rect" id="node41" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="2537,813,2607,843"/><area shape="rect" id="node50" href="../../df/d15/init_8tools_8c.html#a3750bc790613bc6c8c805af0f1b839c8" title="user1_init_vpot2field_user" alt="" coords="2283,345,2456,375"/><area shape="rect" id="node52" href="../../de/db2/initbase_8funcdeclare_8h.html#afda44281ad5c163455c40f012d4a8954" title="init_vpot2field_user" alt="" coords="2505,339,2639,368"/><area shape="rect" id="node54" href="../../de/db2/initbase_8funcdeclare_8h.html#a90699a18ede8b7f112c0078512804ec1" title="initialize vector potential given user function assumes normal non&#45;staggered field in pr Notice that ..." alt="" coords="2721,336,2791,365"/><area shape="rect" id="node58" href="../../de/db2/initbase_8funcdeclare_8h.html#a0afa200a5f947b1c9f6e554519f28fc4" title="init_primitives" alt="" coords="3063,269,3164,299"/><area shape="rect" id="node71" href="../../d0/dde/fluxctstag_8c.html#a5e3dcbe89d6f8a9384cafb58afd7dbf4" title="interpolates field at FACE to field at CENT assuming field along itself is continuous" alt="" coords="1507,434,1627,481"/><area shape="rect" id="node77" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aaa24493002bc8c0a527b1ea2ac2dddbf" title="convert conservative U to stag point P and CENT point U and CENT point primitive" alt="" coords="1956,437,2089,467"/><area shape="rect" id="node87" href="../../d0/dde/fluxctstag_8c.html#a985ee116306b4011810334ae93900493" title="INPUTS: Nvec, pr, primface_l[dir], primface_r[dir] OUTPUTS: pbcorn[dir][side], pvcorn[dir][side][side..." alt="" coords="1477,709,1656,739"/><area shape="rect" id="node95" href="../../d9/de0/step__ch_8c.html#a91fe5c4370e3292a19e7f794797a407f" title="normal bounding of all primitives" alt="" coords="2705,179,2807,208"/><area shape="rect" id="node101" href="../../d9/de0/step__ch_8c.html#abdea68b778dc9253324da69d3c376965" title="bound any pstag type CALLS directly real and MPI boundary functions pstag is at FACE1,2,3 for fields, so user bound is different MPI bounding is the same as CENT quantities used when restarting in initbase.c to bound unewglobal for FLUXB==FLUXCTSTAG" alt="" coords="1273,124,1391,153"/><area shape="rect" id="node104" href="../../d9/de0/step__ch_8c.html#a6f4b963a50a7288964f01775f2f18bb9" title="normal bounding of staggered primitives" alt="" coords="1519,123,1615,152"/><area shape="rect" id="node107" href="../../d0/dde/fluxctstag_8c.html#aa169cb1999412f2e2460012cc5d7a804" title="pure DONOR version: upoint is input staggered updated field that needs to be converted to pstag and t..." alt="" coords="1713,109,1889,155"/><area shape="rect" id="node115" href="../../df/d15/init_8tools_8c.html#acefd26944dbbb1c289886f520f6befac" title="init_dsandvels" alt="" coords="1971,229,2075,259"/><area shape="rect" id="node121" href="../../d8/d60/init_8c.html#a448cd3fd9a1d862485e7b6e67b965172" title="process_restart_toget\l_radiation" alt="" coords="639,285,785,331"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1c7052b05f1c8206988b52c760b2e4af"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> calc_PEQ_ufromTrho </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>suplementary routines for conversions </p>

<p>Definition at line <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html#l14166">14166</a> of file <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html">phys.tools.rad.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d21/global_8funcdeclare_8rad_8h_a1c7052b05f1c8206988b52c760b2e4af_icgraph.png" border="0" usemap="#df/d21/global_8funcdeclare_8rad_8h_a1c7052b05f1c8206988b52c760b2e4af_icgraph" alt=""/></div>
<map name="df/d21/global_8funcdeclare_8rad_8h_a1c7052b05f1c8206988b52c760b2e4af_icgraph" id="df/d21/global_8funcdeclare_8rad_8h_a1c7052b05f1c8206988b52c760b2e4af_icgraph">
<area shape="rect" id="node3" href="../../de/d51/bounds_8c.html#a09a080d9895db7b800a3824cb3fac9f1" title="X1 lower for beam injection to create shadow." alt="" coords="236,161,396,191"/><area shape="rect" id="node110" href="../../de/d51/bounds_8c.html#a3ee134cc5fb18752265c16a20dbdfb63" title="X3 lower for radiation beam injection." alt="" coords="219,215,413,244"/><area shape="rect" id="node113" href="../../de/d51/bounds_8c.html#a8300ddf3ae6a3866234cc0e9c12f26dc" title="X1 upper for inflow." alt="" coords="223,268,409,297"/><area shape="rect" id="node116" href="../../de/d51/bounds_8c.html#a1382959a7b699ea5d224168612504263" title="X1 upper for inflow." alt="" coords="243,321,389,351"/><area shape="rect" id="node119" href="../../de/d51/bounds_8c.html#a635fbaba3d6d6afcf5f34bbb2c278737" title="X2 upper for radiation beam injection." alt="" coords="201,108,431,137"/><area shape="rect" id="node122" href="../../de/db2/initbase_8funcdeclare_8h.html#abd98493cc6574124e0b41c742a056eea" title="init_global" alt="" coords="3135,5,3215,35"/><area shape="rect" id="node125" href="../../d8/d60/init_8c.html#af94364e17d67cddfbb7bb3bf39c05ee6" title="init_dsandvels_koral" alt="" coords="704,180,843,209"/><area shape="rect" id="node130" href="../../d8/d60/init_8c.html#a83e7f10ffd348c4d18b3245dd4bab585" title="make_nonrt2rt_solution" alt="" coords="237,375,395,404"/><area shape="rect" id="node5" href="../../de/d51/bounds_8c.html#a34ac3f1ca7b0f3a21053c633da9931a9" title="user boundary routine" alt="" coords="480,215,651,244"/><area shape="rect" id="node7" href="../../d4/dad/bounds_8funcdeclare_8h.html#a4bc7413b2cdb89e070f38bbb689ae555" title="bound_prim_user_dir" alt="" coords="703,253,844,283"/><area shape="rect" id="node99" href="../../d4/dad/bounds_8funcdeclare_8h.html#a2fbddc9ff8fc706bafa80c39695c7262" title="assume single user function takes care of primitive locations" alt="" coords="896,124,1045,153"/><area shape="rect" id="node9" href="../../d9/de0/step__ch_8c.html#adbe0e3ba8a74f09ab928a96bd68cab6d" title="bound any prim type CALLS directly real and MPI boundary functions pstag = pstagglobal ucons = unewgl..." alt="" coords="916,537,1025,567"/><area shape="rect" id="node11" href="../../d9/de0/step__ch_8c.html#a689fddc1949b1a1d390b59d10d17d83c" title="normal full bounding during evolution NOTEMARK: Was previously also bounding pstag here..." alt="" coords="1112,864,1237,893"/><area shape="rect" id="node24" href="../../d9/de0/step__ch_8c.html#a4079244d85c301885c1363ca41502869" title="simple bounding during evolution NOTEMARK: Was previously also bounding pstag here, but not necessary since done by calling bound_pstag in fluxctstag.c" alt="" coords="1093,917,1256,947"/><area shape="rect" id="node27" href="../../d9/de0/step__ch_8c.html#addca75a18cc861326a321565a2e81aa0" title="normal bounding of non&#45;staggered primitives" alt="" coords="1131,537,1219,567"/><area shape="rect" id="node93" href="../../d9/de0/step__ch_8c.html#a460b84e1112e3aef17209c20e22e1cf1" title="bound all prims" alt="" coords="1567,176,1689,205"/><area shape="rect" id="node13" href="../../d9/de0/step__ch_8c.html#ad36a0f9f915547477e3bb2405f8166b9" title="things to do after advance()" alt="" coords="1343,917,1444,947"/><area shape="rect" id="node15" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="2751,859,2884,888"/><area shape="rect" id="node17" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="2971,845,3037,875"/><area shape="rect" id="node19" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="3276,575,3367,604"/><area shape="rect" id="node21" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="3416,423,3467,452"/><area shape="rect" id="node29" href="../../dc/dae/flux_8c.html#aef355ccd1ca2295b84ad2fe1fc011d35" title="normal interpolation of CENT quantities to FACE quantities sets global variables pl_ct and pr_ct to p..." alt="" coords="1304,763,1483,792"/><area shape="rect" id="node46" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aecb3f613a7cb3bbb42fff2dbee5d65a1" title="This vpot2field function is for staggered method to evolve quasi&#45;deaveraged fields (i..." alt="" coords="2001,333,2167,363"/><area shape="rect" id="node48" href="../../de/db2/initbase_8funcdeclare_8h.html#ae6b2ad4cd0debf5b89ba8a9e471d6977" title="assumes normal field p pleft used as temp var if FLUXB==FLUXCTSTAG assigns conserved field in UEVOLVE..." alt="" coords="2217,357,2295,387"/><area shape="rect" id="node56" href="../../df/d15/init_8tools_8c.html#a77551ab2581efdbaf170dfca073ff9ab" title="user1_init_primitives" alt="" coords="2933,269,3075,299"/><area shape="rect" id="node60" href="../../de/df8/initbase_8c.html#ac4110398e386c9888d9565630357dbbe" title="General&#45;Primary init() routine Uses globals inside init() because sets memory and sets physics..." alt="" coords="3303,269,3340,299"/><area shape="rect" id="node63" href="../../d0/dde/fluxctstag_8c.html#a4e3d76c6ad125b8199948408c262e3a1" title="wrapper for: 1) interpolate FACE 2 CORN 2) loop over dimensions setting field flux dimension&#45;by&#45;dimen..." alt="" coords="1797,657,1928,687"/><area shape="rect" id="node66" href="../../d0/dde/fluxctstag_8c.html#a2dd789bf1402bef72523cdb69e85806e" title="use global pbcorninterp and pvcorninterp at CORN1,2,3 to obtain EMFs at CORN1,2,3 NO interpolation of..." alt="" coords="1328,589,1459,635"/><area shape="rect" id="node69" href="../../d0/dde/fluxctstag_8c.html#aaec26a518629175ecceefbaf6c84225e" title="wrapper for continuous interpolation for FACE_to_CENT" alt="" coords="1307,435,1480,464"/><area shape="rect" id="node73" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aa31dd83c96936277334c62e2098dd51d" title="wrapper for taking staggered conserved field quantity and obtaining centered field quantity upoint en..." alt="" coords="1775,503,1951,532"/><area shape="rect" id="node82" href="../../d0/dde/fluxctstag_8c.html#a6cd90dff56319085b32bc57c0c8b3cfd" title="this function called in initbase.c and during advance() here ustag is point value if dimension doesn&#39;..." alt="" coords="1568,555,1688,584"/><area shape="rect" id="node85" href="../../d0/dde/fluxctstag_8c.html#ad6aa918442f7768dff3c099ba353ee64" title="slope_lim_face2corn() is provided p2interp and returns pleft/pright differs from slope_lim() by range..." alt="" coords="1323,709,1464,739"/><area shape="rect" id="node31" href="../../dc/dae/flux_8c.html#a2602a4dad9ed7adc944227d02435312e" title="standard (non&#45;field flux) calculation but setup to store results of interpolation so can be used for ..." alt="" coords="1531,763,1725,792"/><area shape="rect" id="node33" href="../../dc/dae/flux_8c.html#aaf6d832880760f80459d91477c28b519" title="wrapper for different standard 1&#45;D flux calculators 1&#45;D interpolate and get flux for that direction (..." alt="" coords="1805,736,1920,765"/><area shape="rect" id="node35" href="../../dc/dae/flux_8c.html#a8ffa7399bd5354fdcdec5f3e1adf0b13" title="wrapper for CENT_to_FACE1,2,3 used to compute flux at face" alt="" coords="2037,716,2131,745"/><area shape="rect" id="node37" href="../../d5/d2f/flux_8funcdeclare_8h.html#ab229b0f3f2caf3c0a3ef5299fba2b1c0" title="see fluxcompute.c for non&#45;computer science, real physics calculations of flux" alt="" coords="2223,657,2289,687"/><area shape="rect" id="node39" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="2367,657,2495,687"/><area shape="rect" id="node44" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="2353,565,2508,595"/><area shape="rect" id="node41" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="2599,813,2668,843"/><area shape="rect" id="node50" href="../../df/d15/init_8tools_8c.html#a3750bc790613bc6c8c805af0f1b839c8" title="user1_init_vpot2field_user" alt="" coords="2344,353,2517,383"/><area shape="rect" id="node52" href="../../de/db2/initbase_8funcdeclare_8h.html#afda44281ad5c163455c40f012d4a8954" title="init_vpot2field_user" alt="" coords="2567,347,2700,376"/><area shape="rect" id="node54" href="../../de/db2/initbase_8funcdeclare_8h.html#a90699a18ede8b7f112c0078512804ec1" title="initialize vector potential given user function assumes normal non&#45;staggered field in pr Notice that ..." alt="" coords="2783,340,2852,369"/><area shape="rect" id="node58" href="../../de/db2/initbase_8funcdeclare_8h.html#a0afa200a5f947b1c9f6e554519f28fc4" title="init_primitives" alt="" coords="3124,269,3225,299"/><area shape="rect" id="node71" href="../../d0/dde/fluxctstag_8c.html#a5e3dcbe89d6f8a9384cafb58afd7dbf4" title="interpolates field at FACE to field at CENT assuming field along itself is continuous" alt="" coords="1568,434,1688,481"/><area shape="rect" id="node77" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aaa24493002bc8c0a527b1ea2ac2dddbf" title="convert conservative U to stag point P and CENT point U and CENT point primitive" alt="" coords="2017,437,2151,467"/><area shape="rect" id="node87" href="../../d0/dde/fluxctstag_8c.html#a985ee116306b4011810334ae93900493" title="INPUTS: Nvec, pr, primface_l[dir], primface_r[dir] OUTPUTS: pbcorn[dir][side], pvcorn[dir][side][side..." alt="" coords="1539,709,1717,739"/><area shape="rect" id="node95" href="../../d9/de0/step__ch_8c.html#a91fe5c4370e3292a19e7f794797a407f" title="normal bounding of all primitives" alt="" coords="2767,179,2868,208"/><area shape="rect" id="node101" href="../../d9/de0/step__ch_8c.html#abdea68b778dc9253324da69d3c376965" title="bound any pstag type CALLS directly real and MPI boundary functions pstag is at FACE1,2,3 for fields, so user bound is different MPI bounding is the same as CENT quantities used when restarting in initbase.c to bound unewglobal for FLUXB==FLUXCTSTAG" alt="" coords="1335,123,1452,152"/><area shape="rect" id="node104" href="../../d9/de0/step__ch_8c.html#a6f4b963a50a7288964f01775f2f18bb9" title="normal bounding of staggered primitives" alt="" coords="1580,123,1676,152"/><area shape="rect" id="node107" href="../../d0/dde/fluxctstag_8c.html#aa169cb1999412f2e2460012cc5d7a804" title="pure DONOR version: upoint is input staggered updated field that needs to be converted to pstag and t..." alt="" coords="1775,109,1951,155"/><area shape="rect" id="node127" href="../../df/d15/init_8tools_8c.html#acefd26944dbbb1c289886f520f6befac" title="init_dsandvels" alt="" coords="2032,229,2136,259"/><area shape="rect" id="node132" href="../../d8/d60/init_8c.html#a73009fd6280963c265e2cf5d1c353e8d" title="get_full_rtsolution" alt="" coords="504,355,627,384"/><area shape="rect" id="node135" href="../../d8/d60/init_8c.html#a448cd3fd9a1d862485e7b6e67b965172" title="process_restart_toget\l_radiation" alt="" coords="700,346,847,393"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa305b4ec3db7dc78a29d7694462e911d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int calc_rad_lambda </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>ptrgeom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td>
          <td class="paramname"><em>Tgas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>nlambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>kappaemit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>kappanemit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a05abe9d4076eaff42edb288900c53309"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int calc_Rij </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td>
          <td class="paramname"><em>Rij</em>[][4]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="af8e0b77aba8b494909392ceca6f551a0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calc_Tandopacityandemission </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>ptrgeom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td>
          <td class="paramname"><em>Ruu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td>
          <td class="paramname"><em>gammaradgas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>Tgas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>Tradff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>nradff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>expfactorradff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>kappa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>kappan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>kappaemit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>kappanemit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>kappaes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>nlambda</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get {abs} and {es} in /mass * rho = 1/cm form. </p>
<p>energy density loss rate integrated over frequency and solid angle </p>

<p>Definition at line <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html#l10442">10442</a> of file <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html">phys.tools.rad.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d21/global_8funcdeclare_8rad_8h_af8e0b77aba8b494909392ceca6f551a0_cgraph.png" border="0" usemap="#df/d21/global_8funcdeclare_8rad_8h_af8e0b77aba8b494909392ceca6f551a0_cgraph" alt=""/></div>
<map name="df/d21/global_8funcdeclare_8rad_8h_af8e0b77aba8b494909392ceca6f551a0_cgraph" id="df/d21/global_8funcdeclare_8rad_8h_af8e0b77aba8b494909392ceca6f551a0_cgraph">
<area shape="rect" id="node3" href="../../d2/d72/phys_8tools_8rad_8c.html#a864793af319e70c0d099679fa81dd398" title="compute Trad (also computed directly in calc_Gu() above) using only primitives (not using conserved q..." alt="" coords="251,44,451,73"/><area shape="rect" id="node10" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a7dc2e853cec9b6f9a5e83ce23c468d03" title="nrad(T) = nrad=arad T^3/2.70118 (this is LTE only if put in T was gas T)" alt="" coords="677,71,805,100"/><area shape="rect" id="node12" href="../../d9/de9/coord_8c.html#a96290375e27d5d0aa4d843b07e228e14" title="normally&#45;used bl_coord[i,j,k] {i,j,k} &#45;&gt; V only" alt="" coords="305,148,396,177"/><area shape="rect" id="node22" href="../../df/d21/global_8funcdeclare_8rad_8h.html#ab4537b80f4788d1a81759b595c8441a9" title="kappa_func_fits_all" alt="" coords="284,201,417,231"/><area shape="rect" id="node24" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a0fb687f68b97453843fc3c085f05f1b4" title="E=urad=arad T^4 (this is LTE only if put in T was gas T)" alt="" coords="288,255,413,284"/><area shape="rect" id="node5" href="../../df/d21/global_8funcdeclare_8rad_8h.html#af07558357c906b4dfa61cd34656d9f02" title="E=urad=arad T^4 and just solve for T (this is LTE only if assume resulting T is gas T)..." alt="" coords="679,5,804,35"/><area shape="rect" id="node7" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a3e47afcfc5c42719999d851395fd032d" title="nrad(E)" alt="" coords="500,44,628,73"/><area shape="rect" id="node14" href="../../d9/de9/coord_8c.html#a041e7b005310415c97d90f4b8521ed1a" title="get X(i,j,k) CENT is default position in degenerate cases" alt="" coords="537,148,591,177"/><area shape="rect" id="node16" href="../../d9/de9/coord_8c.html#a65ad4ca9656d141cc995fd35ed31dc40" title="Returns boyer&#45;lindquist coordinte of point." alt="" coords="529,201,599,231"/><area shape="rect" id="node18" href="../../d8/d60/init_8c.html#a27c01fe4532cf3e10d467517403dbf70" title="blcoord_user" alt="" coords="693,148,789,177"/><area shape="rect" id="node20" href="../../d9/de9/coord_8c.html#af7a086e6042d598aea95c2360d07a99b" title="blcoord_singfixes" alt="" coords="680,201,803,231"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d21/global_8funcdeclare_8rad_8h_af8e0b77aba8b494909392ceca6f551a0_icgraph.png" border="0" usemap="#df/d21/global_8funcdeclare_8rad_8h_af8e0b77aba8b494909392ceca6f551a0_icgraph" alt=""/></div>
<map name="df/d21/global_8funcdeclare_8rad_8h_af8e0b77aba8b494909392ceca6f551a0_icgraph" id="df/d21/global_8funcdeclare_8rad_8h_af8e0b77aba8b494909392ceca6f551a0_icgraph">
<area shape="rect" id="node3" href="../../d2/d72/phys_8tools_8rad_8c.html#ab62b07a8cbcc04f20c05a468ad6de636" title="compute G^ 4&#45;force" alt="" coords="252,32,321,61"/><area shape="rect" id="node5" href="../../d2/d72/phys_8tools_8rad_8c.html#aaa32f967773a287ecb6647732157606f" title="get G_" alt="" coords="372,32,441,61"/><area shape="rect" id="node7" href="../../d2/d72/phys_8tools_8rad_8c.html#a2a80e3b7ea37b9536f0e49cc740425c9" title="get 4&#45;force for all pl&#39;s" alt="" coords="491,32,643,61"/><area shape="rect" id="node9" href="../../d2/d72/phys_8tools_8rad_8c.html#af46d2b1cf89a70a7e2ef503146c649a9" title="uu0 &#45; original cons." alt="" coords="691,32,765,61"/><area shape="rect" id="node11" href="../../d2/d72/phys_8tools_8rad_8c.html#a17aede36203a236390363af78d3a86f0" title="compute changes to U (both T and R) using implicit method KORALTODO: If doing implicit, should also add geometry source term that can sometimes be stiff." alt="" coords="968,32,1176,61"/><area shape="rect" id="node35" href="../../d2/d72/phys_8tools_8rad_8c.html#afa73a2caa3209e565a64f92447058507" title="calculating approximate Jacobian: dUresid(dUrad,G(Urad))/dUrad = dy(x)/dx then compute inverse Jacobi..." alt="" coords="815,57,919,87"/><area shape="rect" id="node13" href="../../d2/d72/phys_8tools_8rad_8c.html#a675bb3f12a77c62cf2540bc42c4867f8" title="wrapper for mode method" alt="" coords="1225,32,1393,61"/><area shape="rect" id="node15" href="../../d2/d72/phys_8tools_8rad_8c.html#aa8c5c0d5de580899948f9f22e10aff23" title="General radiation source term calculation (EXTERNALLY called) NOTE: source_explicit() takes as first ..." alt="" coords="1444,32,1564,61"/><area shape="rect" id="node17" href="../../d2/d1d/sources_8c.html#a504ce383765ca3d2ff0b1ee653aff854" title="Ugeomfree and dUother are in UNOTHING form (or UEVOLVE without geometry) pf might be modified so bett..." alt="" coords="1613,32,1720,61"/><area shape="rect" id="node19" href="../../d7/def/phys_8tools_8c.html#a12ce5092c3a1a566cb7a560a7440acc1" title="add in source terms to equations of motion ui and dUriemann in UEVOLVE form assume q(pr) so consisten..." alt="" coords="1768,32,1829,61"/><area shape="rect" id="node21" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="1892,5,2020,35"/><area shape="rect" id="node33" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="1879,59,2033,88"/><area shape="rect" id="node23" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="2084,5,2153,35"/><area shape="rect" id="node25" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="2204,5,2337,35"/><area shape="rect" id="node27" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="2388,5,2455,35"/><area shape="rect" id="node29" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="2505,5,2596,35"/><area shape="rect" id="node31" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="2645,5,2696,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5943065ab3d5b4e9f4f691db499b588f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int calc_tautot </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>ptrgeom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>tautot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>tautotmax</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculates total opacity over dx[] </p>

<p>Definition at line <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html#l14147">14147</a> of file <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html">phys.tools.rad.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d21/global_8funcdeclare_8rad_8h_a5943065ab3d5b4e9f4f691db499b588f_cgraph.png" border="0" usemap="#df/d21/global_8funcdeclare_8rad_8h_a5943065ab3d5b4e9f4f691db499b588f_cgraph" alt=""/></div>
<map name="df/d21/global_8funcdeclare_8rad_8h_a5943065ab3d5b4e9f4f691db499b588f_cgraph" id="df/d21/global_8funcdeclare_8rad_8h_a5943065ab3d5b4e9f4f691db499b588f_cgraph">
<area shape="rect" id="node3" href="../../d2/d72/phys_8tools_8rad_8c.html#a795959353203e99366b456b16d0d0bab" title="calculates total opacity over dx[] for given chi or chieff" alt="" coords="141,5,267,35"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d21/global_8funcdeclare_8rad_8h_a5943065ab3d5b4e9f4f691db499b588f_icgraph.png" border="0" usemap="#df/d21/global_8funcdeclare_8rad_8h_a5943065ab3d5b4e9f4f691db499b588f_icgraph" alt=""/></div>
<map name="df/d21/global_8funcdeclare_8rad_8h_a5943065ab3d5b4e9f4f691db499b588f_icgraph" id="df/d21/global_8funcdeclare_8rad_8h_a5943065ab3d5b4e9f4f691db499b588f_icgraph">
<area shape="rect" id="node3" href="../../d8/d29/interpline_8c.html#a77526a5c5b89294821d25d493f21eb57" title="determine shock indicator (used for both c2e and other routines, only operates on quantities with NPR..." alt="" coords="431,83,529,112"/><area shape="rect" id="node13" href="../../d8/d29/interpline_8c.html#a86547c640e11a0b2c6666f2661ac5d6d" title="returns the improved pressure jump indicators" alt="" coords="172,145,319,175"/><area shape="rect" id="node22" href="../../df/d30/interppoint_8para_8c.html#ac3af1cc044a6058812c512179cbb090a" title="Get pressure Note this is quite inefficient since operating per&#45;point get same pressure for entire li..." alt="" coords="200,312,291,341"/><area shape="rect" id="node94" href="../../d2/d72/phys_8tools_8rad_8c.html#a17aede36203a236390363af78d3a86f0" title="compute changes to U (both T and R) using implicit method KORALTODO: If doing implicit, should also add geometry source term that can sometimes be stiff." alt="" coords="141,227,349,256"/><area shape="rect" id="node106" href="../../d2/d72/phys_8tools_8rad_8c.html#ad6748b88a3ad397cb35b4d60c108508d" title="calcfull_tautot" alt="" coords="195,541,296,571"/><area shape="rect" id="node110" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a7e078cc9a354495bc85554d875a705d9" title="General explicit inversion of U[MHD]&#45;&gt;P[MHD] and also inverts scalars. Inverts radiation if(EOMRADTYP..." alt="" coords="2157,437,2245,467"/><area shape="rect" id="node5" href="../../d8/d29/interpline_8c.html#ac0108e09712d4ba63a94800f9f007ea2" title="interior of main SUPERGENLOOP() inside slope_lim_linetype_c2e()" alt="" coords="656,74,784,121"/><area shape="rect" id="node9" href="../../d8/d29/interpline_8c.html#a016b471d950e6b0dad945e9a064a506b" title="inside of SUPERGENLOOP() in slope_lim_linetype()" alt="" coords="656,5,784,51"/><area shape="rect" id="node7" href="../../d8/d29/interpline_8c.html#af01fe38edb6f0dd4a67e7bcb2db70d48" title="very similar to slope_lim_linetype, but different number of quantities to handle" alt="" coords="877,117,1035,147"/><area shape="rect" id="node11" href="../../d8/d29/interpline_8c.html#aabe389c926d3f8600911f2ffa6d645e4" title="linetype assumed to return pleft/pright directly since linetype&#39;s are usually higher order this funct..." alt="" coords="892,13,1020,43"/><area shape="rect" id="node15" href="../../d8/d29/interpline_8c.html#a3d874481fe13ed640058992d96cf0df1" title="interior _perijk() functions:" alt="" coords="408,143,552,172"/><area shape="rect" id="node17" href="../../d8/d29/interpline_8c.html#a9614310c18cd4bc4fce55ea5964382d5" title="interior of main SUPERGENLOOP() inside slope_lim_linetype_c2e()" alt="" coords="611,143,829,190"/><area shape="rect" id="node24" href="../../df/d30/interppoint_8para_8c.html#af36824cae5f3156fa6da09c3536c7785" title="used when lim=PARAFLAT" alt="" coords="452,325,508,355"/><area shape="rect" id="node26" href="../../d8/ddd/interppoint_8c.html#af1ea622d3759b98722d11ed0a3d555e7" title="interpolate from a center point to a left/right interface" alt="" coords="649,329,791,359"/><area shape="rect" id="node28" href="../../d8/ddd/interppoint_8c.html#a0d50fd876f4e61d909a1e006bac28387" title="whether primreal is p2interp can&#39;t assume this is true in general (e.g." alt="" coords="888,331,1024,360"/><area shape="rect" id="node30" href="../../dc/dae/flux_8c.html#a2a4bea22d4d0b16aaba0d19357413e31" title="slope_lim() is provided p2interp and returns pleft/pright" alt="" coords="1132,384,1209,413"/><area shape="rect" id="node54" href="../../dc/dae/flux_8c.html#a26e710fdb46e850254a41503d339720d" title="slope_lim_cent2face() is provided p2interp and returns pleft/pright gets interpolations in expanded r..." alt="" coords="1100,331,1241,360"/><area shape="rect" id="node61" href="../../d0/dde/fluxctstag_8c.html#aaec26a518629175ecceefbaf6c84225e" title="wrapper for continuous interpolation for FACE_to_CENT" alt="" coords="1084,275,1257,304"/><area shape="rect" id="node87" href="../../d0/dde/fluxctstag_8c.html#ad6aa918442f7768dff3c099ba353ee64" title="slope_lim_face2corn() is provided p2interp and returns pleft/pright differs from slope_lim() by range..." alt="" coords="1100,437,1241,467"/><area shape="rect" id="node32" href="../../dc/dae/flux_8c.html#a054658527dfb1d80226b8b2d2106aeed" title="original flux calculator that gets F in &quot;dir&quot;. At end global pleft,pright,dq also set and if STOREWAV..." alt="" coords="1569,385,1692,415"/><area shape="rect" id="node34" href="../../dc/dae/flux_8c.html#aaf6d832880760f80459d91477c28b519" title="wrapper for different standard 1&#45;D flux calculators 1&#45;D interpolate and get flux for that direction (..." alt="" coords="1787,384,1901,413"/><area shape="rect" id="node36" href="../../dc/dae/flux_8c.html#a8ffa7399bd5354fdcdec5f3e1adf0b13" title="wrapper for CENT_to_FACE1,2,3 used to compute flux at face" alt="" coords="1967,384,2060,413"/><area shape="rect" id="node38" href="../../d5/d2f/flux_8funcdeclare_8h.html#ab229b0f3f2caf3c0a3ef5299fba2b1c0" title="see fluxcompute.c for non&#45;computer science, real physics calculations of flux" alt="" coords="2168,384,2235,413"/><area shape="rect" id="node40" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="2351,332,2479,361"/><area shape="rect" id="node52" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="2337,279,2492,308"/><area shape="rect" id="node42" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="2560,177,2629,207"/><area shape="rect" id="node44" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="2700,173,2833,203"/><area shape="rect" id="node46" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="2904,63,2971,92"/><area shape="rect" id="node48" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="3039,63,3129,92"/><area shape="rect" id="node50" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="3179,89,3229,119"/><area shape="rect" id="node56" href="../../dc/dae/flux_8c.html#aef355ccd1ca2295b84ad2fe1fc011d35" title="normal interpolation of CENT quantities to FACE quantities sets global variables pl_ct and pr_ct to p..." alt="" coords="1307,333,1485,363"/><area shape="rect" id="node58" href="../../dc/dae/flux_8c.html#a2602a4dad9ed7adc944227d02435312e" title="standard (non&#45;field flux) calculation but setup to store results of interpolation so can be used for ..." alt="" coords="1533,332,1728,361"/><area shape="rect" id="node63" href="../../d0/dde/fluxctstag_8c.html#a5e3dcbe89d6f8a9384cafb58afd7dbf4" title="interpolates field at FACE to field at CENT assuming field along itself is continuous" alt="" coords="1336,263,1456,310"/><area shape="rect" id="node65" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aa31dd83c96936277334c62e2098dd51d" title="wrapper for taking staggered conserved field quantity and obtaining centered field quantity upoint en..." alt="" coords="1543,272,1719,301"/><area shape="rect" id="node69" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aaa24493002bc8c0a527b1ea2ac2dddbf" title="convert conservative U to stag point P and CENT point U and CENT point primitive" alt="" coords="1777,167,1911,196"/><area shape="rect" id="node71" href="../../de/db2/initbase_8funcdeclare_8h.html#ae6b2ad4cd0debf5b89ba8a9e471d6977" title="assumes normal field p pleft used as temp var if FLUXB==FLUXCTSTAG assigns conserved field in UEVOLVE..." alt="" coords="1975,167,2052,196"/><area shape="rect" id="node83" href="../../de/df8/initbase_8c.html#ac4110398e386c9888d9565630357dbbe" title="General&#45;Primary init() routine Uses globals inside init() because sets memory and sets physics..." alt="" coords="3065,116,3103,145"/><area shape="rect" id="node73" href="../../df/d15/init_8tools_8c.html#a3750bc790613bc6c8c805af0f1b839c8" title="user1_init_vpot2field_user" alt="" coords="2115,171,2288,200"/><area shape="rect" id="node75" href="../../de/db2/initbase_8funcdeclare_8h.html#afda44281ad5c163455c40f012d4a8954" title="init_vpot2field_user" alt="" coords="2348,195,2481,224"/><area shape="rect" id="node77" href="../../de/db2/initbase_8funcdeclare_8h.html#a90699a18ede8b7f112c0078512804ec1" title="initialize vector potential given user function assumes normal non&#45;staggered field in pr Notice that ..." alt="" coords="2560,260,2629,289"/><area shape="rect" id="node79" href="../../df/d15/init_8tools_8c.html#a77551ab2581efdbaf170dfca073ff9ab" title="user1_init_primitives" alt="" coords="2696,301,2837,331"/><area shape="rect" id="node81" href="../../de/db2/initbase_8funcdeclare_8h.html#a0afa200a5f947b1c9f6e554519f28fc4" title="init_primitives" alt="" coords="2887,233,2988,263"/><area shape="rect" id="node89" href="../../d0/dde/fluxctstag_8c.html#a985ee116306b4011810334ae93900493" title="INPUTS: Nvec, pr, primface_l[dir], primface_r[dir] OUTPUTS: pbcorn[dir][side], pvcorn[dir][side][side..." alt="" coords="1307,437,1485,467"/><area shape="rect" id="node91" href="../../d0/dde/fluxctstag_8c.html#a4e3d76c6ad125b8199948408c262e3a1" title="wrapper for: 1) interpolate FACE 2 CORN 2) loop over dimensions setting field flux dimension&#45;by&#45;dimen..." alt="" coords="1779,437,1909,467"/><area shape="rect" id="node96" href="../../d2/d72/phys_8tools_8rad_8c.html#a675bb3f12a77c62cf2540bc42c4867f8" title="wrapper for mode method" alt="" coords="1547,216,1715,245"/><area shape="rect" id="node98" href="../../d2/d72/phys_8tools_8rad_8c.html#aa8c5c0d5de580899948f9f22e10aff23" title="General radiation source term calculation (EXTERNALLY called) NOTE: source_explicit() takes as first ..." alt="" coords="1784,220,1904,249"/><area shape="rect" id="node100" href="../../d2/d1d/sources_8c.html#a504ce383765ca3d2ff0b1ee653aff854" title="Ugeomfree and dUother are in UNOTHING form (or UEVOLVE without geometry) pf might be modified so bett..." alt="" coords="1960,220,2067,249"/><area shape="rect" id="node102" href="../../d7/def/phys_8tools_8c.html#a12ce5092c3a1a566cb7a560a7440acc1" title="add in source terms to equations of motion ui and dUriemann in UEVOLVE form assume q(pr) so consisten..." alt="" coords="2171,280,2232,309"/><area shape="rect" id="node108" href="../../d2/d72/phys_8tools_8rad_8c.html#a69289f92f5afd222ade67c4e9c60285a" title="get contravariant relative 4&#45;velocity in lab frame" alt="" coords="399,541,561,571"/><area shape="rect" id="node114" href="../../d8/d60/init_8c.html#af3b64278d50c2ff0fee80291fbd38dab" title="fieldprim" alt="" coords="2380,385,2449,415"/><area shape="rect" id="node122" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a8db9dc7c7f52d6fcb405a74e519db5cf" title="there may be something wrong with this function  didn&#39;t work in TIMEORDER==4, had to do standard met..." alt="" coords="2369,439,2460,468"/><area shape="rect" id="node116" href="../../df/d15/init_8tools_8c.html#acefd26944dbbb1c289886f520f6befac" title="init_dsandvels" alt="" coords="2543,384,2647,413"/><area shape="rect" id="node119" href="../../de/db2/initbase_8funcdeclare_8h.html#a4e121b9448ac1adaa7608206369f9ea5" title="init_postvpot" alt="" coords="2547,316,2643,345"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad6748b88a3ad397cb35b4d60c108508d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int calcfull_tautot </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>ptrgeom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>tautot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>tautotmax</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html#l14136">14136</a> of file <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html">phys.tools.rad.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d21/global_8funcdeclare_8rad_8h_ad6748b88a3ad397cb35b4d60c108508d_cgraph.png" border="0" usemap="#df/d21/global_8funcdeclare_8rad_8h_ad6748b88a3ad397cb35b4d60c108508d_cgraph" alt=""/></div>
<map name="df/d21/global_8funcdeclare_8rad_8h_ad6748b88a3ad397cb35b4d60c108508d_cgraph" id="df/d21/global_8funcdeclare_8rad_8h_ad6748b88a3ad397cb35b4d60c108508d_cgraph">
<area shape="rect" id="node3" href="../../d3/ddc/phys_8funcdeclare_8h.html#a11e17cd8b0594d1ad52e3594aa9f477e" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="164,72,239,101"/><area shape="rect" id="node11" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a5943065ab3d5b4e9f4f691db499b588f" title="calculates total opacity over dx[]" alt="" coords="159,139,244,168"/><area shape="rect" id="node5" href="../../d3/ddc/phys_8funcdeclare_8h.html#a12a473e24b431762af4168179e82cd08" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="312,5,475,35"/><area shape="rect" id="node7" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a8a762bf6582e6f7e1199de9c43b98454" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="295,59,492,88"/><area shape="rect" id="node9" href="../../d3/ddc/phys_8funcdeclare_8h.html#a41b8eacac0a4a23d6b00b670fe49629c" title="bsq_calc_fromq" alt="" coords="336,112,451,141"/><area shape="rect" id="node13" href="../../d2/d72/phys_8tools_8rad_8c.html#a795959353203e99366b456b16d0d0bab" title="calculates total opacity over dx[] for given chi or chieff" alt="" coords="331,165,456,195"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d21/global_8funcdeclare_8rad_8h_ad6748b88a3ad397cb35b4d60c108508d_icgraph.png" border="0" usemap="#df/d21/global_8funcdeclare_8rad_8h_ad6748b88a3ad397cb35b4d60c108508d_icgraph" alt=""/></div>
<map name="df/d21/global_8funcdeclare_8rad_8h_ad6748b88a3ad397cb35b4d60c108508d_icgraph" id="df/d21/global_8funcdeclare_8rad_8h_ad6748b88a3ad397cb35b4d60c108508d_icgraph">
<area shape="rect" id="node3" href="../../d2/d72/phys_8tools_8rad_8c.html#a69289f92f5afd222ade67c4e9c60285a" title="get contravariant relative 4&#45;velocity in lab frame" alt="" coords="159,5,321,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8a762bf6582e6f7e1199de9c43b98454"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_state_uradconuradcovonly </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>ptrgeom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *&#160;</td>
          <td class="paramname"><em>q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get only u^ and u_ assumine b^ and b_ not used. </p>

<p>Definition at line <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html#l11096">11096</a> of file <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html">phys.tools.rad.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d21/global_8funcdeclare_8rad_8h_a8a762bf6582e6f7e1199de9c43b98454_icgraph.png" border="0" usemap="#df/d21/global_8funcdeclare_8rad_8h_a8a762bf6582e6f7e1199de9c43b98454_icgraph" alt=""/></div>
<map name="df/d21/global_8funcdeclare_8rad_8h_a8a762bf6582e6f7e1199de9c43b98454_icgraph" id="df/d21/global_8funcdeclare_8rad_8h_a8a762bf6582e6f7e1199de9c43b98454_icgraph">
<area shape="rect" id="node3" href="../../d7/def/phys_8tools_8c.html#a9684455352a66ce457839e4eb0c4c172" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="328,637,403,667"/><area shape="rect" id="node259" href="../../d7/def/phys_8tools_8c.html#a1a2559c2030bdec8e79f36165581a85c" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="539,405,664,435"/><area shape="rect" id="node265" href="../../d7/def/phys_8tools_8c.html#a83946d263e4786959397e89cf6bf1431" title="all get_state() things except the field quantities" alt="" coords="305,691,425,720"/><area shape="rect" id="node267" href="../../d7/def/phys_8tools_8c.html#ad46675c486138b240d9bfa27e5ca262a" title="used to check inversion, which has consistent pressure used to get things as functions of &#160;instead of..." alt="" coords="276,744,455,773"/><area shape="rect" id="node269" href="../../d7/def/phys_8tools_8c.html#adf1cf36a7c564b77dca08d26ce233df7" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="285,183,445,212"/><area shape="rect" id="node281" href="../../d7/def/phys_8tools_8c.html#a39e973bfdc6ccf9e82b33925e073fca3" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="2332,127,2487,156"/><area shape="rect" id="node287" href="../../d7/def/phys_8tools_8c.html#a932c3d0ede37a07f6d380cf6ce07e0b0" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="281,797,449,827"/><area shape="rect" id="node310" href="../../d7/def/phys_8tools_8c.html#a3ef47960a272ef981fd551582b610503" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="255,377,476,407"/><area shape="rect" id="node315" href="../../d7/def/phys_8tools_8c.html#a4fe81910bc63688d418cca528888089e" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="260,851,471,880"/><area shape="rect" id="node5" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="3652,775,3780,804"/><area shape="rect" id="node17" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="3639,313,3793,343"/><area shape="rect" id="node19" href="../../df/d22/advance_8c.html#a0936d88b132d9655aa9287035a4793c5" title="If density or gamma&#45;factors are different by more than fractional_difference_threshold for states pin..." alt="" coords="531,765,672,795"/><area shape="rect" id="node21" href="../../d5/de3/phys_8tools_8funcdeclare_8h.html#ac9512f95a18d4a189ac642d138f95051" title="2D only for now since really only useful for 2D imaging map out region around failure point OPENMPNOT..." alt="" coords="1975,589,2052,619"/><area shape="rect" id="node32" href="../../d6/db2/diag_8funcdeclare_8h.html#a53324e6dbf9729772e70f0a053468ae6" title="set var to be averaged in time" alt="" coords="1965,643,2061,672"/><area shape="rect" id="node37" href="../../dc/dae/flux_8c.html#aa26f8747446e1cd5bd214ebc345aafa2" title="compute donor&#45;based flux, bypassing normal fluxcalc()." alt="" coords="2164,195,2271,224"/><area shape="rect" id="node40" href="../../d8/d60/init_8c.html#af3b64278d50c2ff0fee80291fbd38dab" title="fieldprim" alt="" coords="1252,972,1321,1001"/><area shape="rect" id="node54" href="../../d7/def/phys_8tools_8c.html#aedc30b56b48db47c3622b2d6c55161d9" title="returns b^2 (i.e., twice magnetic pressure)" alt="" coords="540,920,663,949"/><area shape="rect" id="node56" href="../../d2/d72/phys_8tools_8rad_8c.html#af46d2b1cf89a70a7e2ef503146c649a9" title="uu0 &#45; original cons." alt="" coords="788,509,863,539"/><area shape="rect" id="node58" href="../../d2/d72/phys_8tools_8rad_8c.html#a17aede36203a236390363af78d3a86f0" title="compute changes to U (both T and R) using implicit method KORALTODO: If doing implicit, should also add geometry source term that can sometimes be stiff." alt="" coords="1183,611,1391,640"/><area shape="rect" id="node60" href="../../d2/d72/phys_8tools_8rad_8c.html#a675bb3f12a77c62cf2540bc42c4867f8" title="wrapper for mode method" alt="" coords="1468,611,1636,640"/><area shape="rect" id="node75" href="../../d2/d72/phys_8tools_8rad_8c.html#a2a80e3b7ea37b9536f0e49cc740425c9" title="get 4&#45;force for all pl&#39;s" alt="" coords="525,560,677,589"/><area shape="rect" id="node78" href="../../d2/d72/phys_8tools_8rad_8c.html#a3ad3833ac14b93095e76f8d915c5c9ad" title="calcfull_Trad" alt="" coords="553,1024,649,1053"/><area shape="rect" id="node80" href="../../d2/d72/phys_8tools_8rad_8c.html#ad1313c275fb108d10f866373d9bb227a" title="like prad_fforlab() but for only whichdir=LAB2FF used for dumps or diags" alt="" coords="556,1131,647,1160"/><area shape="rect" id="node213" href="../../d2/d72/phys_8tools_8rad_8c.html#ad6748b88a3ad397cb35b4d60c108508d" title="calcfull_tautot" alt="" coords="551,1077,652,1107"/><area shape="rect" id="node217" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a7e078cc9a354495bc85554d875a705d9" title="General explicit inversion of U[MHD]&#45;&gt;P[MHD] and also inverts scalars. Inverts radiation if(EOMRADTYP..." alt="" coords="1004,456,1092,485"/><area shape="rect" id="node224" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a58011440113d7e9adf2b0af40e531f25" title="loop for P&#45;&gt;U" alt="" coords="556,1184,647,1213"/><area shape="rect" id="node226" href="../../d8/d20/vchar_8c.html#acad033b60e7ca6404ffcd9b0fdfd13b4" title="simplefast" alt="" coords="784,352,867,381"/><area shape="rect" id="node238" href="../../d2/dd4/wavespeeds_8funcdeclare_8h.html#a2afa5dfde87c74476341a69d555f91e6" title="get wave speeds for flux calculation" alt="" coords="1727,352,1847,381"/><area shape="rect" id="node7" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="3884,980,3953,1009"/><area shape="rect" id="node9" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="4036,1057,4169,1087"/><area shape="rect" id="node11" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="4256,1012,4323,1041"/><area shape="rect" id="node13" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="4415,964,4505,993"/><area shape="rect" id="node15" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="4648,964,4699,993"/><area shape="rect" id="node23" href="../../d6/db2/diag_8funcdeclare_8h.html#ac0efe363ff7411385b5c6ab3b1f146aa" title="main diag() call for diagnostics OPENMPNOTE: Assume diag() not called by multiple threads..." alt="" coords="2387,620,2432,649"/><area shape="rect" id="node26" href="../../d9/de0/step__ch_8c.html#a4c42d9adb1cef442b95fd62f99ee087a" title="things to do before taking a full timestep assume not called when dt==0.0" alt="" coords="3876,824,3961,853"/><area shape="rect" id="node29" href="../../d9/de0/step__ch_8c.html#ad36a0f9f915547477e3bb2405f8166b9" title="things to do after advance()" alt="" coords="2577,1343,2679,1372"/><area shape="rect" id="node34" href="../../d6/db2/diag_8funcdeclare_8h.html#a6bd89f9169256368191c508d23b0b453" title="if doavg==1, then assume this is call before dumping" alt="" coords="2168,641,2267,671"/><area shape="rect" id="node42" href="../../df/d15/init_8tools_8c.html#acefd26944dbbb1c289886f520f6befac" title="init_dsandvels" alt="" coords="1500,1651,1604,1680"/><area shape="rect" id="node51" href="../../de/db2/initbase_8funcdeclare_8h.html#a4e121b9448ac1adaa7608206369f9ea5" title="init_postvpot" alt="" coords="3668,1419,3764,1448"/><area shape="rect" id="node44" href="../../df/d15/init_8tools_8c.html#a77551ab2581efdbaf170dfca073ff9ab" title="user1_init_primitives" alt="" coords="4219,1456,4360,1485"/><area shape="rect" id="node46" href="../../de/db2/initbase_8funcdeclare_8h.html#a0afa200a5f947b1c9f6e554519f28fc4" title="init_primitives" alt="" coords="4409,1424,4511,1453"/><area shape="rect" id="node48" href="../../de/df8/initbase_8c.html#ac4110398e386c9888d9565630357dbbe" title="General&#45;Primary init() routine Uses globals inside init() because sets memory and sets physics..." alt="" coords="4561,1353,4599,1383"/><area shape="rect" id="node70" href="../../d2/d72/phys_8tools_8rad_8c.html#afa73a2caa3209e565a64f92447058507" title="calculating approximate Jacobian: dUresid(dUrad,G(Urad))/dUrad = dy(x)/dx then compute inverse Jacobi..." alt="" coords="996,560,1100,589"/><area shape="rect" id="node62" href="../../d2/d72/phys_8tools_8rad_8c.html#aa8c5c0d5de580899948f9f22e10aff23" title="General radiation source term calculation (EXTERNALLY called) NOTE: source_explicit() takes as first ..." alt="" coords="2157,537,2277,567"/><area shape="rect" id="node64" href="../../d2/d1d/sources_8c.html#a504ce383765ca3d2ff0b1ee653aff854" title="Ugeomfree and dUother are in UNOTHING form (or UEVOLVE without geometry) pf might be modified so bett..." alt="" coords="3265,568,3372,597"/><area shape="rect" id="node66" href="../../d7/def/phys_8tools_8c.html#a12ce5092c3a1a566cb7a560a7440acc1" title="add in source terms to equations of motion ui and dUriemann in UEVOLVE form assume q(pr) so consisten..." alt="" coords="3485,568,3547,597"/><area shape="rect" id="node82" href="../../d2/d72/phys_8tools_8rad_8c.html#af50896d039d660550b738862b3390b07" title="radiative ortonormal ff primitives (E,F^i) &lt;&#45;&gt; primitives in lab frame Used only for initial conditio..." alt="" coords="780,1276,871,1305"/><area shape="rect" id="node84" href="../../d8/d60/init_8c.html#af94364e17d67cddfbb7bb3bf39c05ee6" title="init_dsandvels_koral" alt="" coords="979,1512,1117,1541"/><area shape="rect" id="node87" href="../../d8/d60/init_8c.html#a448cd3fd9a1d862485e7b6e67b965172" title="process_restart_toget\l_radiation" alt="" coords="975,1233,1121,1279"/><area shape="rect" id="node89" href="../../d2/d72/phys_8tools_8rad_8c.html#a64226cb28f52020ffe18ac6c6b1a2f5c" title="Input: start with pin [with fluid in whichvel velocity and whichcoordfluid coordinates (PRIMECOORDS o..." alt="" coords="983,1302,1113,1349"/><area shape="rect" id="node91" href="../../de/d51/bounds_8c.html#a3bc773d499b145705bdc23125b963840" title="Koral specific physical boundary conditions." alt="" coords="1452,1128,1652,1157"/><area shape="rect" id="node178" href="../../de/d51/bounds_8c.html#a09a080d9895db7b800a3824cb3fac9f1" title="X1 lower for beam injection to create shadow." alt="" coords="1472,1181,1632,1211"/><area shape="rect" id="node181" href="../../de/d51/bounds_8c.html#a3ee134cc5fb18752265c16a20dbdfb63" title="X3 lower for radiation beam injection." alt="" coords="1455,1235,1649,1264"/><area shape="rect" id="node184" href="../../de/d51/bounds_8c.html#a8300ddf3ae6a3866234cc0e9c12f26dc" title="X1 upper for inflow." alt="" coords="1459,1288,1645,1317"/><area shape="rect" id="node187" href="../../de/d51/bounds_8c.html#a01088f65c7a4cfa2ebfed202f815b951" title="X1 lower and upper for RADATM." alt="" coords="1467,1341,1637,1371"/><area shape="rect" id="node190" href="../../de/d51/bounds_8c.html#a1382959a7b699ea5d224168612504263" title="X1 upper for inflow." alt="" coords="1479,1395,1625,1424"/><area shape="rect" id="node193" href="../../de/d51/bounds_8c.html#ac15824bc610943cb7e02112e77b94752" title="on&#45;grid bounding" alt="" coords="1237,1439,1336,1468"/><area shape="rect" id="node196" href="../../de/d51/bounds_8c.html#a42658c4ecf3c6edb958394eb65a9ac2b" title="RADNT." alt="" coords="1240,1492,1333,1521"/><area shape="rect" id="node199" href="../../de/d51/bounds_8c.html#a3e4008fd24427b2e91d0ae5882b9536a" title="X1 upper for RADCYLBEAM." alt="" coords="1204,1545,1369,1575"/><area shape="rect" id="node202" href="../../de/d51/bounds_8c.html#ac32c1a20138382904dc5f1c66778ad8b" title="X1 upper for RADCYLJET." alt="" coords="1213,1599,1360,1628"/><area shape="rect" id="node205" href="../../de/d51/bounds_8c.html#a635fbaba3d6d6afcf5f34bbb2c278737" title="X2 upper for radiation beam injection." alt="" coords="1172,1025,1401,1055"/><area shape="rect" id="node208" href="../../de/d51/bounds_8c.html#a9f1df4e461f3f776bf3cb80e36a4d6df" title="get_radcylbeamcart" alt="" coords="1219,1079,1355,1108"/><area shape="rect" id="node93" href="../../de/d51/bounds_8c.html#a34ac3f1ca7b0f3a21053c633da9931a9" title="user boundary routine" alt="" coords="1701,1299,1872,1328"/><area shape="rect" id="node95" href="../../d4/dad/bounds_8funcdeclare_8h.html#a4bc7413b2cdb89e070f38bbb689ae555" title="bound_prim_user_dir" alt="" coords="1943,1296,2084,1325"/><area shape="rect" id="node167" href="../../d4/dad/bounds_8funcdeclare_8h.html#a2fbddc9ff8fc706bafa80c39695c7262" title="assume single user function takes care of primitive locations" alt="" coords="1939,1504,2088,1533"/><area shape="rect" id="node97" href="../../d9/de0/step__ch_8c.html#adbe0e3ba8a74f09ab928a96bd68cab6d" title="bound any prim type CALLS directly real and MPI boundary functions pstag = pstagglobal ucons = unewgl..." alt="" coords="2163,1292,2272,1321"/><area shape="rect" id="node99" href="../../d9/de0/step__ch_8c.html#a689fddc1949b1a1d390b59d10d17d83c" title="normal full bounding during evolution NOTEMARK: Was previously also bounding pstag here..." alt="" coords="2347,1239,2472,1268"/><area shape="rect" id="node103" href="../../d9/de0/step__ch_8c.html#a4079244d85c301885c1363ca41502869" title="simple bounding during evolution NOTEMARK: Was previously also bounding pstag here, but not necessary since done by calling bound_pstag in fluxctstag.c" alt="" coords="2328,1292,2491,1321"/><area shape="rect" id="node106" href="../../d9/de0/step__ch_8c.html#addca75a18cc861326a321565a2e81aa0" title="normal bounding of non&#45;staggered primitives" alt="" coords="2365,1113,2453,1143"/><area shape="rect" id="node161" href="../../d9/de0/step__ch_8c.html#a460b84e1112e3aef17209c20e22e1cf1" title="bound all prims" alt="" coords="2801,1656,2924,1685"/><area shape="rect" id="node108" href="../../dc/dae/flux_8c.html#aef355ccd1ca2295b84ad2fe1fc011d35" title="normal interpolation of CENT quantities to FACE quantities sets global variables pl_ct and pr_ct to p..." alt="" coords="2539,681,2717,711"/><area shape="rect" id="node120" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aecb3f613a7cb3bbb42fff2dbee5d65a1" title="This vpot2field function is for staggered method to evolve quasi&#45;deaveraged fields (i..." alt="" coords="3236,1341,3401,1371"/><area shape="rect" id="node122" href="../../de/db2/initbase_8funcdeclare_8h.html#ae6b2ad4cd0debf5b89ba8a9e471d6977" title="assumes normal field p pleft used as temp var if FLUXB==FLUXCTSTAG assigns conserved field in UEVOLVE..." alt="" coords="3477,1341,3555,1371"/><area shape="rect" id="node131" href="../../d0/dde/fluxctstag_8c.html#a4e3d76c6ad125b8199948408c262e3a1" title="wrapper for: 1) interpolate FACE 2 CORN 2) loop over dimensions setting field flux dimension&#45;by&#45;dimen..." alt="" coords="3032,873,3163,903"/><area shape="rect" id="node134" href="../../d0/dde/fluxctstag_8c.html#a2dd789bf1402bef72523cdb69e85806e" title="use global pbcorninterp and pvcorninterp at CORN1,2,3 to obtain EMFs at CORN1,2,3 NO interpolation of..." alt="" coords="2797,950,2928,997"/><area shape="rect" id="node137" href="../../d0/dde/fluxctstag_8c.html#aaec26a518629175ecceefbaf6c84225e" title="wrapper for continuous interpolation for FACE_to_CENT" alt="" coords="2541,1031,2715,1060"/><area shape="rect" id="node141" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aa31dd83c96936277334c62e2098dd51d" title="wrapper for taking staggered conserved field quantity and obtaining centered field quantity upoint en..." alt="" coords="3009,1088,3185,1117"/><area shape="rect" id="node150" href="../../d0/dde/fluxctstag_8c.html#a6cd90dff56319085b32bc57c0c8b3cfd" title="this function called in initbase.c and during advance() here ustag is point value if dimension doesn&#39;..." alt="" coords="2568,1087,2688,1116"/><area shape="rect" id="node153" href="../../d0/dde/fluxctstag_8c.html#ad6aa918442f7768dff3c099ba353ee64" title="slope_lim_face2corn() is provided p2interp and returns pleft/pright differs from slope_lim() by range..." alt="" coords="2557,847,2699,876"/><area shape="rect" id="node110" href="../../dc/dae/flux_8c.html#a2602a4dad9ed7adc944227d02435312e" title="standard (non&#45;field flux) calculation but setup to store results of interpolation so can be used for ..." alt="" coords="2765,417,2960,447"/><area shape="rect" id="node112" href="../../dc/dae/flux_8c.html#aaf6d832880760f80459d91477c28b519" title="wrapper for different standard 1&#45;D flux calculators 1&#45;D interpolate and get flux for that direction (..." alt="" coords="3040,417,3155,447"/><area shape="rect" id="node114" href="../../dc/dae/flux_8c.html#a8ffa7399bd5354fdcdec5f3e1adf0b13" title="wrapper for CENT_to_FACE1,2,3 used to compute flux at face" alt="" coords="3272,440,3365,469"/><area shape="rect" id="node116" href="../../d5/d2f/flux_8funcdeclare_8h.html#ab229b0f3f2caf3c0a3ef5299fba2b1c0" title="see fluxcompute.c for non&#45;computer science, real physics calculations of flux" alt="" coords="3483,672,3549,701"/><area shape="rect" id="node124" href="../../df/d15/init_8tools_8c.html#a3750bc790613bc6c8c805af0f1b839c8" title="user1_init_vpot2field_user" alt="" coords="3629,1353,3803,1383"/><area shape="rect" id="node126" href="../../de/db2/initbase_8funcdeclare_8h.html#afda44281ad5c163455c40f012d4a8954" title="init_vpot2field_user" alt="" coords="3852,1360,3985,1389"/><area shape="rect" id="node128" href="../../de/db2/initbase_8funcdeclare_8h.html#a90699a18ede8b7f112c0078512804ec1" title="initialize vector potential given user function assumes normal non&#45;staggered field in pr Notice that ..." alt="" coords="4068,1363,4137,1392"/><area shape="rect" id="node139" href="../../d0/dde/fluxctstag_8c.html#a5e3dcbe89d6f8a9384cafb58afd7dbf4" title="interpolates field at FACE to field at CENT assuming field along itself is continuous" alt="" coords="2803,1019,2923,1066"/><area shape="rect" id="node145" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aaa24493002bc8c0a527b1ea2ac2dddbf" title="convert conservative U to stag point P and CENT point U and CENT point primitive" alt="" coords="3252,1237,3385,1267"/><area shape="rect" id="node155" href="../../d0/dde/fluxctstag_8c.html#a985ee116306b4011810334ae93900493" title="INPUTS: Nvec, pr, primface_l[dir], primface_r[dir] OUTPUTS: pbcorn[dir][side], pvcorn[dir][side][side..." alt="" coords="2773,847,2952,876"/><area shape="rect" id="node163" href="../../d9/de0/step__ch_8c.html#a91fe5c4370e3292a19e7f794797a407f" title="normal bounding of all primitives" alt="" coords="4052,1663,4153,1692"/><area shape="rect" id="node169" href="../../d9/de0/step__ch_8c.html#abdea68b778dc9253324da69d3c376965" title="bound any pstag type CALLS directly real and MPI boundary functions pstag is at FACE1,2,3 for fields, so user bound is different MPI bounding is the same as CENT quantities used when restarting in initbase.c to bound unewglobal for FLUXB==FLUXCTSTAG" alt="" coords="2569,1655,2687,1684"/><area shape="rect" id="node172" href="../../d9/de0/step__ch_8c.html#a6f4b963a50a7288964f01775f2f18bb9" title="normal bounding of staggered primitives" alt="" coords="2815,1501,2911,1531"/><area shape="rect" id="node175" href="../../d0/dde/fluxctstag_8c.html#aa169cb1999412f2e2460012cc5d7a804" title="pure DONOR version: upoint is input staggered updated field that needs to be converted to pstag and t..." alt="" coords="3009,1494,3185,1541"/><area shape="rect" id="node210" href="../../de/d51/bounds_8c.html#a16398a5325a9df48783423f00ba65bb7" title="all boundaries for RADCYLBEAMCART" alt="" coords="1476,1075,1628,1104"/><area shape="rect" id="node215" href="../../d2/d72/phys_8tools_8rad_8c.html#a69289f92f5afd222ade67c4e9c60285a" title="get contravariant relative 4&#45;velocity in lab frame" alt="" coords="744,1077,907,1107"/><area shape="rect" id="node222" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a8db9dc7c7f52d6fcb405a74e519db5cf" title="there may be something wrong with this function  didn&#39;t work in TIMEORDER==4, had to do standard met..." alt="" coords="1241,507,1332,536"/><area shape="rect" id="node228" href="../../d2/d72/phys_8tools_8rad_8c.html#abd01208ba3c5754ea5587bcaefcaa01b" title="get lab&#45;frame 3&#45;velocity for radiative emission in radiative frame" alt="" coords="995,403,1101,432"/><area shape="rect" id="node253" href="../../d2/dd4/wavespeeds_8funcdeclare_8h.html#adba6a1e320ad60ae452a4ff6f8ba6e25" title="Charles believed that near polar axis one should set vmax=vmin=0, but not right since makes flux comp..." alt="" coords="1260,299,1313,328"/><area shape="rect" id="node230" href="../../d2/d72/phys_8tools_8rad_8c.html#a56f468401f08e66966f0318198ca6e85" title="compute radiative characteristics as limited by opacity" alt="" coords="1248,352,1325,381"/><area shape="rect" id="node232" href="../../d2/dd4/wavespeeds_8funcdeclare_8h.html#abb81988bde678c59afc5d006cf76b835" title="vchar_each" alt="" coords="1508,352,1596,381"/><area shape="rect" id="node234" href="../../d2/dd4/wavespeeds_8funcdeclare_8h.html#a119027341f97d571212ad74c5ddc94b4" title="get wave speeds for flux calculation and for dt calculation" alt="" coords="1749,641,1824,671"/><area shape="rect" id="node247" href="../../d2/dd4/wavespeeds_8funcdeclare_8h.html#a75426b1b9bf1a293c60d108c63b0322d" title="store wavespeeds somewhere" alt="" coords="1707,405,1867,435"/><area shape="rect" id="node240" href="../../d3/ddc/phys_8funcdeclare_8h.html#a0bb12b388b07610cf01d08c19f8fddb1" title="actually compute the flux and ctop for dt calculation" alt="" coords="1939,256,2088,285"/><area shape="rect" id="node242" href="../../dc/dae/flux_8c.html#a054658527dfb1d80226b8b2d2106aeed" title="original flux calculator that gets F in &quot;dir&quot;. At end global pleft,pright,dq also set and if STOREWAV..." alt="" coords="2156,365,2279,395"/><area shape="rect" id="node249" href="../../d2/dd4/wavespeeds_8funcdeclare_8h.html#acb4a2a3be68517862cdcf097ff51af37" title="complete storage of wave speeds per dimension only called for STOREWAVESPEEDS==1" alt="" coords="1921,405,2105,435"/><area shape="rect" id="node262" href="../../d1/d3e/utoprimgen_8c.html#a0a83e9e7fdd3cc595c5b8d0df88ec684" title="just picks the algorithm to invert" alt="" coords="765,405,885,435"/><area shape="rect" id="node271" href="../../d3/ddc/phys_8funcdeclare_8h.html#a92cd9cc63c782c0d94699d639aa48f69" title="wrapper for choosing to get state by computing it or from global array notice that ptrgeom&#45;&gt;p inputte..." alt="" coords="1484,195,1620,224"/><area shape="rect" id="node273" href="../../dc/d5e/fluxcompute_8c.html#ab088a2ff1d1132363446aab47e5c9c7b" title="P&#45;&gt;sate,flux,U." alt="" coords="1736,195,1837,224"/><area shape="rect" id="node277" href="../../dc/d5e/fluxcompute_8c.html#a9fdd8e08eb928fb500db9e2688f1475b" title="p2SFUevolveall" alt="" coords="1729,248,1844,277"/><area shape="rect" id="node283" href="../../d3/ddc/phys_8funcdeclare_8h.html#a035303dc3a9c5826bd56fdc2996fb2a3" title="wrapper for choosing to get state by computing it or from global array pointer assign (overrides the ..." alt="" coords="3451,160,3581,189"/><area shape="rect" id="node289" href="../../d3/ddc/phys_8funcdeclare_8h.html#a7c83a4e2d3fdf30054e2462d7b3a88f0" title="wrapper for choosing to get state by computing it or from global array pointer assign (overrides the ..." alt="" coords="531,1753,672,1783"/><area shape="rect" id="node291" href="../../d8/d29/interpline_8c.html#a77526a5c5b89294821d25d493f21eb57" title="determine shock indicator (used for both c2e and other routines, only operates on quantities with NPR..." alt="" coords="999,1807,1097,1836"/><area shape="rect" id="node301" href="../../d8/d29/interpline_8c.html#a86547c640e11a0b2c6666f2661ac5d6d" title="returns the improved pressure jump indicators" alt="" coords="752,1753,899,1783"/><area shape="rect" id="node293" href="../../d8/d29/interpline_8c.html#ac0108e09712d4ba63a94800f9f007ea2" title="interior of main SUPERGENLOOP() inside slope_lim_linetype_c2e()" alt="" coords="1223,1771,1351,1818"/><area shape="rect" id="node297" href="../../d8/d29/interpline_8c.html#a016b471d950e6b0dad945e9a064a506b" title="inside of SUPERGENLOOP() in slope_lim_linetype()" alt="" coords="1223,1841,1351,1887"/><area shape="rect" id="node295" href="../../d8/d29/interpline_8c.html#af01fe38edb6f0dd4a67e7bcb2db70d48" title="very similar to slope_lim_linetype, but different number of quantities to handle" alt="" coords="1473,1745,1631,1775"/><area shape="rect" id="node299" href="../../d8/d29/interpline_8c.html#aabe389c926d3f8600911f2ffa6d645e4" title="linetype assumed to return pleft/pright directly since linetype&#39;s are usually higher order this funct..." alt="" coords="1488,1849,1616,1879"/><area shape="rect" id="node303" href="../../d8/d29/interpline_8c.html#a3d874481fe13ed640058992d96cf0df1" title="interior _perijk() functions:" alt="" coords="976,1753,1120,1783"/><area shape="rect" id="node305" href="../../d8/d29/interpline_8c.html#a9614310c18cd4bc4fce55ea5964382d5" title="interior of main SUPERGENLOOP() inside slope_lim_linetype_c2e()" alt="" coords="1177,1702,1396,1749"/><area shape="rect" id="node312" href="../../d3/ddc/phys_8funcdeclare_8h.html#af560087e095f9677ac65b1bc6b424fa9" title="wrapper for choosing to get state by computing it or from global array pointer assign (overrides the ..." alt="" coords="727,299,924,328"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab4537b80f4788d1a81759b595c8441a9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int kappa_func_fits_all </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td>
          <td class="paramname"><em>rho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td>
          <td class="paramname"><em>Tg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td>
          <td class="paramname"><em>Tr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td>
          <td class="paramname"><em>varexpf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>kappa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>kappaemit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>kappan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>kappanemit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>kappaes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>kappaes = sigma_T n_e = sigma_T n_b (n_e/n_b) = sigma_T rho/mb (ne/nb)</p>
<p>kappaes = sigma_T n_e = sigma_T n_b (n_e/n_b) = sigma_T rho/mb (ne/nb) </p>

<p>Definition at line <a class="el" href="../../d8/d60/init_8c_source.html#l09646">9646</a> of file <a class="el" href="../../d8/d60/init_8c_source.html">init.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d21/global_8funcdeclare_8rad_8h_ab4537b80f4788d1a81759b595c8441a9_icgraph.png" border="0" usemap="#df/d21/global_8funcdeclare_8rad_8h_ab4537b80f4788d1a81759b595c8441a9_icgraph" alt=""/></div>
<map name="df/d21/global_8funcdeclare_8rad_8h_ab4537b80f4788d1a81759b595c8441a9_icgraph" id="df/d21/global_8funcdeclare_8rad_8h_ab4537b80f4788d1a81759b595c8441a9_icgraph">
<area shape="rect" id="node3" href="../../d8/d60/init_8c.html#ab897c337de5217abb458e83c73982479" title="kappa_func_fits" alt="" coords="231,5,345,35"/><area shape="rect" id="node5" href="../../d2/d72/phys_8tools_8rad_8c.html#a41e256325d07de60fa8b6b8e743cf7b8" title="get {abs} and {es} in /mass * rho = 1/cm form." alt="" coords="189,59,387,88"/><area shape="rect" id="node7" href="../../d2/d72/phys_8tools_8rad_8c.html#ab62b07a8cbcc04f20c05a468ad6de636" title="compute G^ 4&#45;force" alt="" coords="436,59,505,88"/><area shape="rect" id="node9" href="../../d2/d72/phys_8tools_8rad_8c.html#aaa32f967773a287ecb6647732157606f" title="get G_" alt="" coords="556,59,625,88"/><area shape="rect" id="node11" href="../../d2/d72/phys_8tools_8rad_8c.html#a2a80e3b7ea37b9536f0e49cc740425c9" title="get 4&#45;force for all pl&#39;s" alt="" coords="675,59,827,88"/><area shape="rect" id="node13" href="../../d2/d72/phys_8tools_8rad_8c.html#af46d2b1cf89a70a7e2ef503146c649a9" title="uu0 &#45; original cons." alt="" coords="875,59,949,88"/><area shape="rect" id="node15" href="../../d2/d72/phys_8tools_8rad_8c.html#a17aede36203a236390363af78d3a86f0" title="compute changes to U (both T and R) using implicit method KORALTODO: If doing implicit, should also add geometry source term that can sometimes be stiff." alt="" coords="1152,59,1360,88"/><area shape="rect" id="node39" href="../../d2/d72/phys_8tools_8rad_8c.html#afa73a2caa3209e565a64f92447058507" title="calculating approximate Jacobian: dUresid(dUrad,G(Urad))/dUrad = dy(x)/dx then compute inverse Jacobi..." alt="" coords="999,84,1103,113"/><area shape="rect" id="node17" href="../../d2/d72/phys_8tools_8rad_8c.html#a675bb3f12a77c62cf2540bc42c4867f8" title="wrapper for mode method" alt="" coords="1409,59,1577,88"/><area shape="rect" id="node19" href="../../d2/d72/phys_8tools_8rad_8c.html#aa8c5c0d5de580899948f9f22e10aff23" title="General radiation source term calculation (EXTERNALLY called) NOTE: source_explicit() takes as first ..." alt="" coords="1628,59,1748,88"/><area shape="rect" id="node21" href="../../d2/d1d/sources_8c.html#a504ce383765ca3d2ff0b1ee653aff854" title="Ugeomfree and dUother are in UNOTHING form (or UEVOLVE without geometry) pf might be modified so bett..." alt="" coords="1797,59,1904,88"/><area shape="rect" id="node23" href="../../d7/def/phys_8tools_8c.html#a12ce5092c3a1a566cb7a560a7440acc1" title="add in source terms to equations of motion ui and dUriemann in UEVOLVE form assume q(pr) so consisten..." alt="" coords="1952,59,2013,88"/><area shape="rect" id="node25" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="2076,32,2204,61"/><area shape="rect" id="node37" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="2063,85,2217,115"/><area shape="rect" id="node27" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="2268,32,2337,61"/><area shape="rect" id="node29" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="2388,32,2521,61"/><area shape="rect" id="node31" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="2572,32,2639,61"/><area shape="rect" id="node33" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="2689,32,2780,61"/><area shape="rect" id="node35" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="2829,32,2880,61"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0a9afe086334630c217cca3b3dbf7f7d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void koral_source_rad_calc </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>computestate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>computeentropy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>ptrgeom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>Gdpl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>Gdabspl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>chi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>Tgas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>Trad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *&#160;</td>
          <td class="paramname"><em>q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get 4-force for all pl's </p>

<p>Definition at line <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html#l10568">10568</a> of file <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html">phys.tools.rad.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d21/global_8funcdeclare_8rad_8h_a0a9afe086334630c217cca3b3dbf7f7d_cgraph.png" border="0" usemap="#df/d21/global_8funcdeclare_8rad_8h_a0a9afe086334630c217cca3b3dbf7f7d_cgraph" alt=""/></div>
<map name="df/d21/global_8funcdeclare_8rad_8h_a0a9afe086334630c217cca3b3dbf7f7d_cgraph" id="df/d21/global_8funcdeclare_8rad_8h_a0a9afe086334630c217cca3b3dbf7f7d_cgraph">
<area shape="rect" id="node3" href="../../d3/ddc/phys_8funcdeclare_8h.html#a11e17cd8b0594d1ad52e3594aa9f477e" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="207,72,281,101"/><area shape="rect" id="node11" href="../../d2/d72/phys_8tools_8rad_8c.html#aaa32f967773a287ecb6647732157606f" title="get G_" alt="" coords="209,152,279,181"/><area shape="rect" id="node5" href="../../d3/ddc/phys_8funcdeclare_8h.html#a12a473e24b431762af4168179e82cd08" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="349,5,512,35"/><area shape="rect" id="node7" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a8a762bf6582e6f7e1199de9c43b98454" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="332,59,529,88"/><area shape="rect" id="node9" href="../../d3/ddc/phys_8funcdeclare_8h.html#a41b8eacac0a4a23d6b00b670fe49629c" title="bsq_calc_fromq" alt="" coords="373,112,488,141"/><area shape="rect" id="node13" href="../../d2/d72/phys_8tools_8rad_8c.html#ab62b07a8cbcc04f20c05a468ad6de636" title="compute G^ 4&#45;force" alt="" coords="396,165,465,195"/><area shape="rect" id="node15" href="../../df/d21/global_8funcdeclare_8rad_8h.html#aba8efc1e2ea7a31f67bb6c06ce3c164a" title="mhdfull_calc_rad" alt="" coords="617,60,737,89"/><area shape="rect" id="node19" href="../../df/d21/global_8funcdeclare_8rad_8h.html#af8e0b77aba8b494909392ceca6f551a0" title="get {abs} and {es} in /mass * rho = 1/cm form." alt="" coords="579,165,776,195"/><area shape="rect" id="node45" href="../../d8/d60/init_8c.html#a9118b79d84fe3dccfed3b28ee0fd84b5" title="Gcompt" alt="" coords="644,219,711,248"/><area shape="rect" id="node17" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a389bf7e41d2fd117af996e3392067cdc" title="compute radiation stres&#45;energy tensor assuming M1 closure" alt="" coords="873,33,975,63"/><area shape="rect" id="node21" href="../../d2/d72/phys_8tools_8rad_8c.html#a864793af319e70c0d099679fa81dd398" title="compute Trad (also computed directly in calc_Gu() above) using only primitives (not using conserved q..." alt="" coords="824,87,1024,116"/><area shape="rect" id="node28" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a7dc2e853cec9b6f9a5e83ce23c468d03" title="nrad(T) = nrad=arad T^3/2.70118 (this is LTE only if put in T was gas T)" alt="" coords="1251,113,1379,143"/><area shape="rect" id="node30" href="../../d9/de9/coord_8c.html#a96290375e27d5d0aa4d843b07e228e14" title="normally&#45;used bl_coord[i,j,k] {i,j,k} &#45;&gt; V only" alt="" coords="879,191,969,220"/><area shape="rect" id="node40" href="../../df/d21/global_8funcdeclare_8rad_8h.html#ab4537b80f4788d1a81759b595c8441a9" title="kappa_func_fits_all" alt="" coords="857,244,991,273"/><area shape="rect" id="node42" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a0fb687f68b97453843fc3c085f05f1b4" title="E=urad=arad T^4 (this is LTE only if put in T was gas T)" alt="" coords="861,297,987,327"/><area shape="rect" id="node23" href="../../df/d21/global_8funcdeclare_8rad_8h.html#af07558357c906b4dfa61cd34656d9f02" title="E=urad=arad T^4 and just solve for T (this is LTE only if assume resulting T is gas T)..." alt="" coords="1252,48,1377,77"/><area shape="rect" id="node25" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a3e47afcfc5c42719999d851395fd032d" title="nrad(E)" alt="" coords="1073,87,1201,116"/><area shape="rect" id="node32" href="../../d9/de9/coord_8c.html#a041e7b005310415c97d90f4b8521ed1a" title="get X(i,j,k) CENT is default position in degenerate cases" alt="" coords="1111,191,1164,220"/><area shape="rect" id="node34" href="../../d9/de9/coord_8c.html#a65ad4ca9656d141cc995fd35ed31dc40" title="Returns boyer&#45;lindquist coordinte of point." alt="" coords="1103,244,1172,273"/><area shape="rect" id="node36" href="../../d8/d60/init_8c.html#a27c01fe4532cf3e10d467517403dbf70" title="blcoord_user" alt="" coords="1267,191,1363,220"/><area shape="rect" id="node38" href="../../d9/de9/coord_8c.html#af7a086e6042d598aea95c2360d07a99b" title="blcoord_singfixes" alt="" coords="1253,244,1376,273"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d21/global_8funcdeclare_8rad_8h_a0a9afe086334630c217cca3b3dbf7f7d_icgraph.png" border="0" usemap="#df/d21/global_8funcdeclare_8rad_8h_a0a9afe086334630c217cca3b3dbf7f7d_icgraph" alt=""/></div>
<map name="df/d21/global_8funcdeclare_8rad_8h_a0a9afe086334630c217cca3b3dbf7f7d_icgraph" id="df/d21/global_8funcdeclare_8rad_8h_a0a9afe086334630c217cca3b3dbf7f7d_icgraph">
<area shape="rect" id="node3" href="../../d2/d72/phys_8tools_8rad_8c.html#af46d2b1cf89a70a7e2ef503146c649a9" title="uu0 &#45; original cons." alt="" coords="205,32,280,61"/><area shape="rect" id="node5" href="../../d2/d72/phys_8tools_8rad_8c.html#a17aede36203a236390363af78d3a86f0" title="compute changes to U (both T and R) using implicit method KORALTODO: If doing implicit, should also add geometry source term that can sometimes be stiff." alt="" coords="483,32,691,61"/><area shape="rect" id="node29" href="../../d2/d72/phys_8tools_8rad_8c.html#afa73a2caa3209e565a64f92447058507" title="calculating approximate Jacobian: dUresid(dUrad,G(Urad))/dUrad = dy(x)/dx then compute inverse Jacobi..." alt="" coords="329,57,433,87"/><area shape="rect" id="node7" href="../../d2/d72/phys_8tools_8rad_8c.html#a675bb3f12a77c62cf2540bc42c4867f8" title="wrapper for mode method" alt="" coords="740,32,908,61"/><area shape="rect" id="node9" href="../../d2/d72/phys_8tools_8rad_8c.html#aa8c5c0d5de580899948f9f22e10aff23" title="General radiation source term calculation (EXTERNALLY called) NOTE: source_explicit() takes as first ..." alt="" coords="959,32,1079,61"/><area shape="rect" id="node11" href="../../d2/d1d/sources_8c.html#a504ce383765ca3d2ff0b1ee653aff854" title="Ugeomfree and dUother are in UNOTHING form (or UEVOLVE without geometry) pf might be modified so bett..." alt="" coords="1128,32,1235,61"/><area shape="rect" id="node13" href="../../d7/def/phys_8tools_8c.html#a12ce5092c3a1a566cb7a560a7440acc1" title="add in source terms to equations of motion ui and dUriemann in UEVOLVE form assume q(pr) so consisten..." alt="" coords="1283,32,1344,61"/><area shape="rect" id="node15" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="1407,5,1535,35"/><area shape="rect" id="node27" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="1393,59,1548,88"/><area shape="rect" id="node17" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="1599,5,1668,35"/><area shape="rect" id="node19" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="1719,5,1852,35"/><area shape="rect" id="node21" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="1903,5,1969,35"/><area shape="rect" id="node23" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="2020,5,2111,35"/><area shape="rect" id="node25" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="2160,5,2211,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a389bf7e41d2fd117af996e3392067cdc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mhd_calc_rad </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>geom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>radstressdir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>radstressdirabs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>compute radiation stres-energy tensor assuming M1 closure </p>

<p>Definition at line <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html#l11124">11124</a> of file <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html">phys.tools.rad.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d21/global_8funcdeclare_8rad_8h_a389bf7e41d2fd117af996e3392067cdc_icgraph.png" border="0" usemap="#df/d21/global_8funcdeclare_8rad_8h_a389bf7e41d2fd117af996e3392067cdc_icgraph" alt=""/></div>
<map name="df/d21/global_8funcdeclare_8rad_8h_a389bf7e41d2fd117af996e3392067cdc_icgraph" id="df/d21/global_8funcdeclare_8rad_8h_a389bf7e41d2fd117af996e3392067cdc_icgraph">
<area shape="rect" id="node3" href="../../de/d8c/phys_8c.html#a44693eac289e90fab8a6792e6e9fb02c" title="source_conn" alt="" coords="1764,93,1860,123"/><area shape="rect" id="node21" href="../../d7/def/phys_8tools_8c.html#a3c8277899afc2a48590156971490bb79" title="radiation terms (as if rho=u=p=0)" alt="" coords="1135,143,1239,172"/><area shape="rect" id="node101" href="../../d2/d72/phys_8tools_8rad_8c.html#aba8efc1e2ea7a31f67bb6c06ce3c164a" title="mhdfull_calc_rad" alt="" coords="157,195,277,224"/><area shape="rect" id="node5" href="../../d7/def/phys_8tools_8c.html#a12ce5092c3a1a566cb7a560a7440acc1" title="add in source terms to equations of motion ui and dUriemann in UEVOLVE form assume q(pr) so consisten..." alt="" coords="3081,312,3143,341"/><area shape="rect" id="node7" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="3223,493,3351,523"/><area shape="rect" id="node19" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="3209,287,3364,316"/><area shape="rect" id="node9" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="3455,556,3524,585"/><area shape="rect" id="node11" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="3607,721,3740,751"/><area shape="rect" id="node13" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="3827,911,3893,940"/><area shape="rect" id="node15" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="4132,1025,4223,1055"/><area shape="rect" id="node17" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="4272,1127,4323,1156"/><area shape="rect" id="node23" href="../../d7/def/phys_8tools_8c.html#a341c2b0cf913f82a3aa04f9c9e0f5149" title="Calculate fluxes in direction dir and conserved variable U returntype==0 : flux with geometric factor..." alt="" coords="1383,144,1460,173"/><area shape="rect" id="node95" href="../../d7/def/phys_8tools_8c.html#a764e6f682011d16faec0f9b71eb360d2" title="primtoflux_radonly" alt="" coords="1565,583,1693,612"/><area shape="rect" id="node25" href="../../dc/d5e/fluxcompute_8c.html#ab088a2ff1d1132363446aab47e5c9c7b" title="P&#45;&gt;sate,flux,U." alt="" coords="1951,41,2052,71"/><area shape="rect" id="node46" href="../../dc/d5e/fluxcompute_8c.html#a9fdd8e08eb928fb500db9e2688f1475b" title="p2SFUevolveall" alt="" coords="1572,147,1687,176"/><area shape="rect" id="node49" href="../../d8/d60/init_8c.html#af3b64278d50c2ff0fee80291fbd38dab" title="fieldprim" alt="" coords="2200,557,2269,587"/><area shape="rect" id="node63" href="../../d7/def/phys_8tools_8c.html#a12238eba5936209a397a23dd34724ec9" title="returns entire space&#45;time(NDIM in size) / EOM(NPR in size) matrix" alt="" coords="1581,93,1677,123"/><area shape="rect" id="node66" href="../../d7/def/phys_8tools_8c.html#a06fa54aa3b2f9f3f125f6c53e5ee29e9" title="calculate &quot;conserved&quot; quantities" alt="" coords="1596,324,1663,353"/><area shape="rect" id="node27" href="../../dc/dae/flux_8c.html#aa26f8747446e1cd5bd214ebc345aafa2" title="compute donor&#45;based flux, bypassing normal fluxcalc()." alt="" coords="2431,41,2537,71"/><area shape="rect" id="node30" href="../../d3/ddc/phys_8funcdeclare_8h.html#a0bb12b388b07610cf01d08c19f8fddb1" title="actually compute the flux and ctop for dt calculation" alt="" coords="2160,145,2309,175"/><area shape="rect" id="node32" href="../../dc/dae/flux_8c.html#a054658527dfb1d80226b8b2d2106aeed" title="original flux calculator that gets F in &quot;dir&quot;. At end global pleft,pright,dq also set and if STOREWAV..." alt="" coords="2423,208,2545,237"/><area shape="rect" id="node42" href="../../dc/dae/flux_8c.html#a2602a4dad9ed7adc944227d02435312e" title="standard (non&#45;field flux) calculation but setup to store results of interpolation so can be used for ..." alt="" coords="2387,312,2581,341"/><area shape="rect" id="node34" href="../../dc/dae/flux_8c.html#aaf6d832880760f80459d91477c28b519" title="wrapper for different standard 1&#45;D flux calculators 1&#45;D interpolate and get flux for that direction (..." alt="" coords="2661,312,2776,341"/><area shape="rect" id="node36" href="../../dc/dae/flux_8c.html#a8ffa7399bd5354fdcdec5f3e1adf0b13" title="wrapper for CENT_to_FACE1,2,3 used to compute flux at face" alt="" coords="2893,312,2987,341"/><area shape="rect" id="node38" href="../../d5/d2f/flux_8funcdeclare_8h.html#ab229b0f3f2caf3c0a3ef5299fba2b1c0" title="see fluxcompute.c for non&#45;computer science, real physics calculations of flux" alt="" coords="3079,365,3145,395"/><area shape="rect" id="node51" href="../../df/d15/init_8tools_8c.html#acefd26944dbbb1c289886f520f6befac" title="init_dsandvels" alt="" coords="2432,824,2536,853"/><area shape="rect" id="node60" href="../../de/db2/initbase_8funcdeclare_8h.html#a4e121b9448ac1adaa7608206369f9ea5" title="init_postvpot" alt="" coords="3441,961,3537,991"/><area shape="rect" id="node53" href="../../df/d15/init_8tools_8c.html#a77551ab2581efdbaf170dfca073ff9ab" title="user1_init_primitives" alt="" coords="3789,1337,3931,1367"/><area shape="rect" id="node55" href="../../de/db2/initbase_8funcdeclare_8h.html#a0afa200a5f947b1c9f6e554519f28fc4" title="init_primitives" alt="" coords="3980,1300,4081,1329"/><area shape="rect" id="node57" href="../../de/df8/initbase_8c.html#ac4110398e386c9888d9565630357dbbe" title="General&#45;Primary init() routine Uses globals inside init() because sets memory and sets physics..." alt="" coords="4159,1227,4196,1256"/><area shape="rect" id="node70" href="../../d2/d72/phys_8tools_8rad_8c.html#af46d2b1cf89a70a7e2ef503146c649a9" title="uu0 &#45; original cons." alt="" coords="1775,609,1849,639"/><area shape="rect" id="node72" href="../../d2/d72/phys_8tools_8rad_8c.html#a17aede36203a236390363af78d3a86f0" title="compute changes to U (both T and R) using implicit method KORALTODO: If doing implicit, should also add geometry source term that can sometimes be stiff." alt="" coords="2131,611,2339,640"/><area shape="rect" id="node74" href="../../d2/d72/phys_8tools_8rad_8c.html#a675bb3f12a77c62cf2540bc42c4867f8" title="wrapper for mode method" alt="" coords="2400,365,2568,395"/><area shape="rect" id="node86" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a7e078cc9a354495bc85554d875a705d9" title="General explicit inversion of U[MHD]&#45;&gt;P[MHD] and also inverts scalars. Inverts radiation if(EOMRADTYP..." alt="" coords="1957,379,2045,408"/><area shape="rect" id="node93" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a58011440113d7e9adf2b0af40e531f25" title="loop for P&#45;&gt;U" alt="" coords="1767,351,1857,380"/><area shape="rect" id="node81" href="../../d2/d72/phys_8tools_8rad_8c.html#afa73a2caa3209e565a64f92447058507" title="calculating approximate Jacobian: dUresid(dUrad,G(Urad))/dUrad = dy(x)/dx then compute inverse Jacobi..." alt="" coords="1949,609,2053,639"/><area shape="rect" id="node76" href="../../d2/d72/phys_8tools_8rad_8c.html#aa8c5c0d5de580899948f9f22e10aff23" title="General radiation source term calculation (EXTERNALLY called) NOTE: source_explicit() takes as first ..." alt="" coords="2659,365,2779,395"/><area shape="rect" id="node78" href="../../d2/d1d/sources_8c.html#a504ce383765ca3d2ff0b1ee653aff854" title="Ugeomfree and dUother are in UNOTHING form (or UEVOLVE without geometry) pf might be modified so bett..." alt="" coords="2887,365,2993,395"/><area shape="rect" id="node91" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a8db9dc7c7f52d6fcb405a74e519db5cf" title="there may be something wrong with this function  didn&#39;t work in TIMEORDER==4, had to do standard met..." alt="" coords="2189,365,2280,395"/><area shape="rect" id="node98" href="../../d1/d3e/utoprimgen_8c.html#a0a83e9e7fdd3cc595c5b8d0df88ec684" title="just picks the algorithm to invert" alt="" coords="1752,404,1872,433"/><area shape="rect" id="node103" href="../../d2/d72/phys_8tools_8rad_8c.html#ab62b07a8cbcc04f20c05a468ad6de636" title="compute G^ 4&#45;force" alt="" coords="336,221,405,251"/><area shape="rect" id="node110" href="../../d2/d72/phys_8tools_8rad_8c.html#a8242523b45077ccd783a2867dddb731a" title="compute Trad (also computed directly in calc_Gu() above) using only primitives (not using conserved q..." alt="" coords="332,168,409,197"/><area shape="rect" id="node114" href="../../d2/d72/phys_8tools_8rad_8c.html#ad1313c275fb108d10f866373d9bb227a" title="like prad_fforlab() but for only whichdir=LAB2FF used for dumps or diags" alt="" coords="325,401,416,431"/><area shape="rect" id="node105" href="../../d2/d72/phys_8tools_8rad_8c.html#aaa32f967773a287ecb6647732157606f" title="get G_" alt="" coords="477,221,547,251"/><area shape="rect" id="node107" href="../../d2/d72/phys_8tools_8rad_8c.html#a2a80e3b7ea37b9536f0e49cc740425c9" title="get 4&#45;force for all pl&#39;s" alt="" coords="1345,472,1497,501"/><area shape="rect" id="node112" href="../../d2/d72/phys_8tools_8rad_8c.html#a3ad3833ac14b93095e76f8d915c5c9ad" title="calcfull_Trad" alt="" coords="464,168,560,197"/><area shape="rect" id="node116" href="../../d2/d72/phys_8tools_8rad_8c.html#af50896d039d660550b738862b3390b07" title="radiative ortonormal ff primitives (E,F^i) &lt;&#45;&gt; primitives in lab frame Used only for initial conditio..." alt="" coords="467,495,557,524"/><area shape="rect" id="node118" href="../../d8/d60/init_8c.html#af94364e17d67cddfbb7bb3bf39c05ee6" title="init_dsandvels_koral" alt="" coords="613,744,752,773"/><area shape="rect" id="node121" href="../../d8/d60/init_8c.html#a448cd3fd9a1d862485e7b6e67b965172" title="process_restart_toget\l_radiation" alt="" coords="609,451,756,498"/><area shape="rect" id="node123" href="../../d2/d72/phys_8tools_8rad_8c.html#a64226cb28f52020ffe18ac6c6b1a2f5c" title="Input: start with pin [with fluid in whichvel velocity and whichcoordfluid coordinates (PRIMECOORDS o..." alt="" coords="617,521,748,567"/><area shape="rect" id="node125" href="../../de/d51/bounds_8c.html#a3bc773d499b145705bdc23125b963840" title="Koral specific physical boundary conditions." alt="" coords="1087,351,1287,380"/><area shape="rect" id="node205" href="../../de/d51/bounds_8c.html#a09a080d9895db7b800a3824cb3fac9f1" title="X1 lower for beam injection to create shadow." alt="" coords="1107,404,1267,433"/><area shape="rect" id="node208" href="../../de/d51/bounds_8c.html#a3ee134cc5fb18752265c16a20dbdfb63" title="X3 lower for radiation beam injection." alt="" coords="1089,457,1284,487"/><area shape="rect" id="node211" href="../../de/d51/bounds_8c.html#a8300ddf3ae6a3866234cc0e9c12f26dc" title="X1 upper for inflow." alt="" coords="1093,511,1280,540"/><area shape="rect" id="node214" href="../../de/d51/bounds_8c.html#a01088f65c7a4cfa2ebfed202f815b951" title="X1 lower and upper for RADATM." alt="" coords="1101,564,1272,593"/><area shape="rect" id="node217" href="../../de/d51/bounds_8c.html#a1382959a7b699ea5d224168612504263" title="X1 upper for inflow." alt="" coords="848,607,995,636"/><area shape="rect" id="node220" href="../../de/d51/bounds_8c.html#ac15824bc610943cb7e02112e77b94752" title="on&#45;grid bounding" alt="" coords="872,660,971,689"/><area shape="rect" id="node223" href="../../de/d51/bounds_8c.html#a42658c4ecf3c6edb958394eb65a9ac2b" title="RADNT." alt="" coords="875,713,968,743"/><area shape="rect" id="node226" href="../../de/d51/bounds_8c.html#a3e4008fd24427b2e91d0ae5882b9536a" title="X1 upper for RADCYLBEAM." alt="" coords="839,767,1004,796"/><area shape="rect" id="node229" href="../../de/d51/bounds_8c.html#ac32c1a20138382904dc5f1c66778ad8b" title="X1 upper for RADCYLJET." alt="" coords="848,820,995,849"/><area shape="rect" id="node232" href="../../de/d51/bounds_8c.html#a635fbaba3d6d6afcf5f34bbb2c278737" title="X2 upper for radiation beam injection." alt="" coords="807,247,1036,276"/><area shape="rect" id="node235" href="../../de/d51/bounds_8c.html#a9f1df4e461f3f776bf3cb80e36a4d6df" title="get_radcylbeamcart" alt="" coords="853,300,989,329"/><area shape="rect" id="node127" href="../../de/d51/bounds_8c.html#a34ac3f1ca7b0f3a21053c633da9931a9" title="user boundary routine" alt="" coords="1336,591,1507,620"/><area shape="rect" id="node129" href="../../d4/dad/bounds_8funcdeclare_8h.html#a4bc7413b2cdb89e070f38bbb689ae555" title="bound_prim_user_dir" alt="" coords="1559,737,1700,767"/><area shape="rect" id="node194" href="../../d4/dad/bounds_8funcdeclare_8h.html#a2fbddc9ff8fc706bafa80c39695c7262" title="assume single user function takes care of primitive locations" alt="" coords="1555,1220,1704,1249"/><area shape="rect" id="node131" href="../../d9/de0/step__ch_8c.html#adbe0e3ba8a74f09ab928a96bd68cab6d" title="bound any prim type CALLS directly real and MPI boundary functions pstag = pstagglobal ucons = unewgl..." alt="" coords="1757,803,1867,832"/><area shape="rect" id="node133" href="../../d9/de0/step__ch_8c.html#a689fddc1949b1a1d390b59d10d17d83c" title="normal full bounding during evolution NOTEMARK: Was previously also bounding pstag here..." alt="" coords="1939,749,2064,779"/><area shape="rect" id="node139" href="../../d9/de0/step__ch_8c.html#a4079244d85c301885c1363ca41502869" title="simple bounding during evolution NOTEMARK: Was previously also bounding pstag here, but not necessary since done by calling bound_pstag in fluxctstag.c" alt="" coords="1920,803,2083,832"/><area shape="rect" id="node142" href="../../d9/de0/step__ch_8c.html#addca75a18cc861326a321565a2e81aa0" title="normal bounding of non&#45;staggered primitives" alt="" coords="1957,1128,2045,1157"/><area shape="rect" id="node188" href="../../d9/de0/step__ch_8c.html#a460b84e1112e3aef17209c20e22e1cf1" title="bound all prims" alt="" coords="2423,1460,2545,1489"/><area shape="rect" id="node135" href="../../d9/de0/step__ch_8c.html#ad36a0f9f915547477e3bb2405f8166b9" title="things to do after advance()" alt="" coords="2184,772,2285,801"/><area shape="rect" id="node144" href="../../dc/dae/flux_8c.html#aef355ccd1ca2295b84ad2fe1fc011d35" title="normal interpolation of CENT quantities to FACE quantities sets global variables pl_ct and pr_ct to p..." alt="" coords="2145,876,2324,905"/><area shape="rect" id="node147" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aecb3f613a7cb3bbb42fff2dbee5d65a1" title="This vpot2field function is for staggered method to evolve quasi&#45;deaveraged fields (i..." alt="" coords="2857,1356,3023,1385"/><area shape="rect" id="node149" href="../../de/db2/initbase_8funcdeclare_8h.html#ae6b2ad4cd0debf5b89ba8a9e471d6977" title="assumes normal field p pleft used as temp var if FLUXB==FLUXCTSTAG assigns conserved field in UEVOLVE..." alt="" coords="3073,1331,3151,1360"/><area shape="rect" id="node158" href="../../d0/dde/fluxctstag_8c.html#a4e3d76c6ad125b8199948408c262e3a1" title="wrapper for: 1) interpolate FACE 2 CORN 2) loop over dimensions setting field flux dimension&#45;by&#45;dimen..." alt="" coords="2653,1032,2784,1061"/><area shape="rect" id="node161" href="../../d0/dde/fluxctstag_8c.html#a2dd789bf1402bef72523cdb69e85806e" title="use global pbcorninterp and pvcorninterp at CORN1,2,3 to obtain EMFs at CORN1,2,3 NO interpolation of..." alt="" coords="2169,1033,2300,1079"/><area shape="rect" id="node164" href="../../d0/dde/fluxctstag_8c.html#aaec26a518629175ecceefbaf6c84225e" title="wrapper for continuous interpolation for FACE_to_CENT" alt="" coords="2148,1153,2321,1183"/><area shape="rect" id="node168" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aa31dd83c96936277334c62e2098dd51d" title="wrapper for taking staggered conserved field quantity and obtaining centered field quantity upoint en..." alt="" coords="2631,1143,2807,1172"/><area shape="rect" id="node177" href="../../d0/dde/fluxctstag_8c.html#a6cd90dff56319085b32bc57c0c8b3cfd" title="this function called in initbase.c and during advance() here ustag is point value if dimension doesn&#39;..." alt="" coords="2424,1204,2544,1233"/><area shape="rect" id="node180" href="../../d0/dde/fluxctstag_8c.html#ad6aa918442f7768dff3c099ba353ee64" title="slope_lim_face2corn() is provided p2interp and returns pleft/pright differs from slope_lim() by range..." alt="" coords="2164,929,2305,959"/><area shape="rect" id="node151" href="../../df/d15/init_8tools_8c.html#a3750bc790613bc6c8c805af0f1b839c8" title="user1_init_vpot2field_user" alt="" coords="3200,1343,3373,1372"/><area shape="rect" id="node153" href="../../de/db2/initbase_8funcdeclare_8h.html#afda44281ad5c163455c40f012d4a8954" title="init_vpot2field_user" alt="" coords="3423,1355,3556,1384"/><area shape="rect" id="node155" href="../../de/db2/initbase_8funcdeclare_8h.html#a90699a18ede8b7f112c0078512804ec1" title="initialize vector potential given user function assumes normal non&#45;staggered field in pr Notice that ..." alt="" coords="3639,1356,3708,1385"/><area shape="rect" id="node166" href="../../d0/dde/fluxctstag_8c.html#a5e3dcbe89d6f8a9384cafb58afd7dbf4" title="interpolates field at FACE to field at CENT assuming field along itself is continuous" alt="" coords="2424,1134,2544,1181"/><area shape="rect" id="node172" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aaa24493002bc8c0a527b1ea2ac2dddbf" title="convert conservative U to stag point P and CENT point U and CENT point primitive" alt="" coords="2873,1152,3007,1181"/><area shape="rect" id="node182" href="../../d0/dde/fluxctstag_8c.html#a985ee116306b4011810334ae93900493" title="INPUTS: Nvec, pr, primface_l[dir], primface_r[dir] OUTPUTS: pbcorn[dir][side], pvcorn[dir][side][side..." alt="" coords="2395,929,2573,959"/><area shape="rect" id="node190" href="../../d9/de0/step__ch_8c.html#a91fe5c4370e3292a19e7f794797a407f" title="normal bounding of all primitives" alt="" coords="3623,1460,3724,1489"/><area shape="rect" id="node196" href="../../d9/de0/step__ch_8c.html#abdea68b778dc9253324da69d3c376965" title="bound any pstag type CALLS directly real and MPI boundary functions pstag is at FACE1,2,3 for fields, so user bound is different MPI bounding is the same as CENT quantities used when restarting in initbase.c to bound unewglobal for FLUXB==FLUXCTSTAG" alt="" coords="2176,1512,2293,1541"/><area shape="rect" id="node199" href="../../d9/de0/step__ch_8c.html#a6f4b963a50a7288964f01775f2f18bb9" title="normal bounding of staggered primitives" alt="" coords="2436,1513,2532,1543"/><area shape="rect" id="node202" href="../../d0/dde/fluxctstag_8c.html#aa169cb1999412f2e2460012cc5d7a804" title="pure DONOR version: upoint is input staggered updated field that needs to be converted to pstag and t..." alt="" coords="2631,1510,2807,1557"/><area shape="rect" id="node237" href="../../de/d51/bounds_8c.html#a16398a5325a9df48783423f00ba65bb7" title="all boundaries for RADCYLBEAMCART" alt="" coords="1111,297,1263,327"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aba8efc1e2ea7a31f67bb6c06ce3c164a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mhdfull_calc_rad </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>ptrgeom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>(*)&#160;</td>
          <td class="paramname"><em>radstressdir</em>[NDIM]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html#l11111">11111</a> of file <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html">phys.tools.rad.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d21/global_8funcdeclare_8rad_8h_aba8efc1e2ea7a31f67bb6c06ce3c164a_cgraph.png" border="0" usemap="#df/d21/global_8funcdeclare_8rad_8h_aba8efc1e2ea7a31f67bb6c06ce3c164a_cgraph" alt=""/></div>
<map name="df/d21/global_8funcdeclare_8rad_8h_aba8efc1e2ea7a31f67bb6c06ce3c164a_cgraph" id="df/d21/global_8funcdeclare_8rad_8h_aba8efc1e2ea7a31f67bb6c06ce3c164a_cgraph">
<area shape="rect" id="node3" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a389bf7e41d2fd117af996e3392067cdc" title="compute radiation stres&#45;energy tensor assuming M1 closure" alt="" coords="175,5,276,35"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d21/global_8funcdeclare_8rad_8h_aba8efc1e2ea7a31f67bb6c06ce3c164a_icgraph.png" border="0" usemap="#df/d21/global_8funcdeclare_8rad_8h_aba8efc1e2ea7a31f67bb6c06ce3c164a_icgraph" alt=""/></div>
<map name="df/d21/global_8funcdeclare_8rad_8h_aba8efc1e2ea7a31f67bb6c06ce3c164a_icgraph" id="df/d21/global_8funcdeclare_8rad_8h_aba8efc1e2ea7a31f67bb6c06ce3c164a_icgraph">
<area shape="rect" id="node3" href="../../d2/d72/phys_8tools_8rad_8c.html#ab62b07a8cbcc04f20c05a468ad6de636" title="compute G^ 4&#45;force" alt="" coords="184,768,253,797"/><area shape="rect" id="node38" href="../../d2/d72/phys_8tools_8rad_8c.html#a8242523b45077ccd783a2867dddb731a" title="compute Trad (also computed directly in calc_Gu() above) using only primitives (not using conserved q..." alt="" coords="180,680,257,709"/><area shape="rect" id="node42" href="../../d2/d72/phys_8tools_8rad_8c.html#ad1313c275fb108d10f866373d9bb227a" title="like prad_fforlab() but for only whichdir=LAB2FF used for dumps or diags" alt="" coords="173,609,264,639"/><area shape="rect" id="node5" href="../../d2/d72/phys_8tools_8rad_8c.html#aaa32f967773a287ecb6647732157606f" title="get G_" alt="" coords="1000,837,1069,867"/><area shape="rect" id="node7" href="../../d2/d72/phys_8tools_8rad_8c.html#a2a80e3b7ea37b9536f0e49cc740425c9" title="get 4&#45;force for all pl&#39;s" alt="" coords="1193,844,1345,873"/><area shape="rect" id="node9" href="../../d2/d72/phys_8tools_8rad_8c.html#af46d2b1cf89a70a7e2ef503146c649a9" title="uu0 &#45; original cons." alt="" coords="1619,871,1693,900"/><area shape="rect" id="node11" href="../../d2/d72/phys_8tools_8rad_8c.html#a17aede36203a236390363af78d3a86f0" title="compute changes to U (both T and R) using implicit method KORALTODO: If doing implicit, should also add geometry source term that can sometimes be stiff." alt="" coords="1971,923,2179,952"/><area shape="rect" id="node35" href="../../d2/d72/phys_8tools_8rad_8c.html#afa73a2caa3209e565a64f92447058507" title="calculating approximate Jacobian: dUresid(dUrad,G(Urad))/dUrad = dy(x)/dx then compute inverse Jacobi..." alt="" coords="1789,923,1893,952"/><area shape="rect" id="node13" href="../../d2/d72/phys_8tools_8rad_8c.html#a675bb3f12a77c62cf2540bc42c4867f8" title="wrapper for mode method" alt="" coords="2240,923,2408,952"/><area shape="rect" id="node15" href="../../d2/d72/phys_8tools_8rad_8c.html#aa8c5c0d5de580899948f9f22e10aff23" title="General radiation source term calculation (EXTERNALLY called) NOTE: source_explicit() takes as first ..." alt="" coords="2499,923,2619,952"/><area shape="rect" id="node17" href="../../d2/d1d/sources_8c.html#a504ce383765ca3d2ff0b1ee653aff854" title="Ugeomfree and dUother are in UNOTHING form (or UEVOLVE without geometry) pf might be modified so bett..." alt="" coords="2727,755,2833,784"/><area shape="rect" id="node19" href="../../d7/def/phys_8tools_8c.html#a12ce5092c3a1a566cb7a560a7440acc1" title="add in source terms to equations of motion ui and dUriemann in UEVOLVE form assume q(pr) so consisten..." alt="" coords="2921,725,2983,755"/><area shape="rect" id="node21" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="3063,725,3191,755"/><area shape="rect" id="node33" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="3049,672,3204,701"/><area shape="rect" id="node23" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="3295,741,3364,771"/><area shape="rect" id="node25" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="3447,775,3580,804"/><area shape="rect" id="node27" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="3667,616,3733,645"/><area shape="rect" id="node29" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="3972,407,4063,436"/><area shape="rect" id="node31" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="4112,329,4163,359"/><area shape="rect" id="node40" href="../../d2/d72/phys_8tools_8rad_8c.html#a3ad3833ac14b93095e76f8d915c5c9ad" title="calcfull_Trad" alt="" coords="312,680,408,709"/><area shape="rect" id="node44" href="../../d2/d72/phys_8tools_8rad_8c.html#af50896d039d660550b738862b3390b07" title="radiative ortonormal ff primitives (E,F^i) &lt;&#45;&gt; primitives in lab frame Used only for initial conditio..." alt="" coords="315,528,405,557"/><area shape="rect" id="node46" href="../../d8/d60/init_8c.html#af94364e17d67cddfbb7bb3bf39c05ee6" title="init_dsandvels_koral" alt="" coords="965,69,1104,99"/><area shape="rect" id="node57" href="../../d8/d60/init_8c.html#a448cd3fd9a1d862485e7b6e67b965172" title="process_restart_toget\l_radiation" alt="" coords="457,554,604,601"/><area shape="rect" id="node59" href="../../d2/d72/phys_8tools_8rad_8c.html#a64226cb28f52020ffe18ac6c6b1a2f5c" title="Input: start with pin [with fluid in whichvel velocity and whichcoordfluid coordinates (PRIMECOORDS o..." alt="" coords="465,485,596,531"/><area shape="rect" id="node48" href="../../df/d15/init_8tools_8c.html#acefd26944dbbb1c289886f520f6befac" title="init_dsandvels" alt="" coords="1425,5,1529,35"/><area shape="rect" id="node50" href="../../df/d15/init_8tools_8c.html#a77551ab2581efdbaf170dfca073ff9ab" title="user1_init_primitives" alt="" coords="3629,276,3771,305"/><area shape="rect" id="node52" href="../../de/db2/initbase_8funcdeclare_8h.html#a0afa200a5f947b1c9f6e554519f28fc4" title="init_primitives" alt="" coords="3820,276,3921,305"/><area shape="rect" id="node54" href="../../de/df8/initbase_8c.html#ac4110398e386c9888d9565630357dbbe" title="General&#45;Primary init() routine Uses globals inside init() because sets memory and sets physics..." alt="" coords="3999,251,4036,280"/><area shape="rect" id="node61" href="../../de/d51/bounds_8c.html#a3bc773d499b145705bdc23125b963840" title="Koral specific physical boundary conditions." alt="" coords="935,784,1135,813"/><area shape="rect" id="node150" href="../../de/d51/bounds_8c.html#a09a080d9895db7b800a3824cb3fac9f1" title="X1 lower for beam injection to create shadow." alt="" coords="955,208,1115,237"/><area shape="rect" id="node153" href="../../de/d51/bounds_8c.html#a3ee134cc5fb18752265c16a20dbdfb63" title="X3 lower for radiation beam injection." alt="" coords="937,261,1132,291"/><area shape="rect" id="node156" href="../../de/d51/bounds_8c.html#a8300ddf3ae6a3866234cc0e9c12f26dc" title="X1 upper for inflow." alt="" coords="941,315,1128,344"/><area shape="rect" id="node159" href="../../de/d51/bounds_8c.html#a01088f65c7a4cfa2ebfed202f815b951" title="X1 lower and upper for RADATM." alt="" coords="949,368,1120,397"/><area shape="rect" id="node162" href="../../de/d51/bounds_8c.html#a1382959a7b699ea5d224168612504263" title="X1 upper for inflow." alt="" coords="696,413,843,443"/><area shape="rect" id="node165" href="../../de/d51/bounds_8c.html#ac15824bc610943cb7e02112e77b94752" title="on&#45;grid bounding" alt="" coords="720,467,819,496"/><area shape="rect" id="node168" href="../../de/d51/bounds_8c.html#a42658c4ecf3c6edb958394eb65a9ac2b" title="RADNT." alt="" coords="723,520,816,549"/><area shape="rect" id="node171" href="../../de/d51/bounds_8c.html#a3e4008fd24427b2e91d0ae5882b9536a" title="X1 upper for RADCYLBEAM." alt="" coords="687,573,852,603"/><area shape="rect" id="node174" href="../../de/d51/bounds_8c.html#ac32c1a20138382904dc5f1c66778ad8b" title="X1 upper for RADCYLJET." alt="" coords="696,627,843,656"/><area shape="rect" id="node177" href="../../de/d51/bounds_8c.html#a635fbaba3d6d6afcf5f34bbb2c278737" title="X2 upper for radiation beam injection." alt="" coords="655,680,884,709"/><area shape="rect" id="node180" href="../../de/d51/bounds_8c.html#a9f1df4e461f3f776bf3cb80e36a4d6df" title="get_radcylbeamcart" alt="" coords="701,733,837,763"/><area shape="rect" id="node63" href="../../de/d51/bounds_8c.html#a34ac3f1ca7b0f3a21053c633da9931a9" title="user boundary routine" alt="" coords="1184,476,1355,505"/><area shape="rect" id="node65" href="../../d4/dad/bounds_8funcdeclare_8h.html#a4bc7413b2cdb89e070f38bbb689ae555" title="bound_prim_user_dir" alt="" coords="1407,487,1548,516"/><area shape="rect" id="node139" href="../../d4/dad/bounds_8funcdeclare_8h.html#a2fbddc9ff8fc706bafa80c39695c7262" title="assume single user function takes care of primitive locations" alt="" coords="1403,275,1552,304"/><area shape="rect" id="node67" href="../../d9/de0/step__ch_8c.html#adbe0e3ba8a74f09ab928a96bd68cab6d" title="bound any prim type CALLS directly real and MPI boundary functions pstag = pstagglobal ucons = unewgl..." alt="" coords="1601,489,1711,519"/><area shape="rect" id="node69" href="../../d9/de0/step__ch_8c.html#a689fddc1949b1a1d390b59d10d17d83c" title="normal full bounding during evolution NOTEMARK: Was previously also bounding pstag here..." alt="" coords="1779,819,1904,848"/><area shape="rect" id="node75" href="../../d9/de0/step__ch_8c.html#a4079244d85c301885c1363ca41502869" title="simple bounding during evolution NOTEMARK: Was previously also bounding pstag here, but not necessary since done by calling bound_pstag in fluxctstag.c" alt="" coords="1760,653,1923,683"/><area shape="rect" id="node78" href="../../d9/de0/step__ch_8c.html#addca75a18cc861326a321565a2e81aa0" title="normal bounding of non&#45;staggered primitives" alt="" coords="1797,489,1885,519"/><area shape="rect" id="node133" href="../../d9/de0/step__ch_8c.html#a460b84e1112e3aef17209c20e22e1cf1" title="bound all prims" alt="" coords="2263,172,2385,201"/><area shape="rect" id="node71" href="../../d9/de0/step__ch_8c.html#ad36a0f9f915547477e3bb2405f8166b9" title="things to do after advance()" alt="" coords="2024,819,2125,848"/><area shape="rect" id="node80" href="../../dc/dae/flux_8c.html#aef355ccd1ca2295b84ad2fe1fc011d35" title="normal interpolation of CENT quantities to FACE quantities sets global variables pl_ct and pr_ct to p..." alt="" coords="1985,592,2164,621"/><area shape="rect" id="node92" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aecb3f613a7cb3bbb42fff2dbee5d65a1" title="This vpot2field function is for staggered method to evolve quasi&#45;deaveraged fields (i..." alt="" coords="2697,327,2863,356"/><area shape="rect" id="node94" href="../../de/db2/initbase_8funcdeclare_8h.html#ae6b2ad4cd0debf5b89ba8a9e471d6977" title="assumes normal field p pleft used as temp var if FLUXB==FLUXCTSTAG assigns conserved field in UEVOLVE..." alt="" coords="2913,327,2991,356"/><area shape="rect" id="node103" href="../../d0/dde/fluxctstag_8c.html#a4e3d76c6ad125b8199948408c262e3a1" title="wrapper for: 1) interpolate FACE 2 CORN 2) loop over dimensions setting field flux dimension&#45;by&#45;dimen..." alt="" coords="2493,696,2624,725"/><area shape="rect" id="node106" href="../../d0/dde/fluxctstag_8c.html#a2dd789bf1402bef72523cdb69e85806e" title="use global pbcorninterp and pvcorninterp at CORN1,2,3 to obtain EMFs at CORN1,2,3 NO interpolation of..." alt="" coords="2009,749,2140,795"/><area shape="rect" id="node109" href="../../d0/dde/fluxctstag_8c.html#aaec26a518629175ecceefbaf6c84225e" title="wrapper for continuous interpolation for FACE_to_CENT" alt="" coords="1988,436,2161,465"/><area shape="rect" id="node113" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aa31dd83c96936277334c62e2098dd51d" title="wrapper for taking staggered conserved field quantity and obtaining centered field quantity upoint en..." alt="" coords="2471,496,2647,525"/><area shape="rect" id="node122" href="../../d0/dde/fluxctstag_8c.html#a6cd90dff56319085b32bc57c0c8b3cfd" title="this function called in initbase.c and during advance() here ustag is point value if dimension doesn&#39;..." alt="" coords="2264,548,2384,577"/><area shape="rect" id="node125" href="../../d0/dde/fluxctstag_8c.html#ad6aa918442f7768dff3c099ba353ee64" title="slope_lim_face2corn() is provided p2interp and returns pleft/pright differs from slope_lim() by range..." alt="" coords="2004,645,2145,675"/><area shape="rect" id="node82" href="../../dc/dae/flux_8c.html#a2602a4dad9ed7adc944227d02435312e" title="standard (non&#45;field flux) calculation but setup to store results of interpolation so can be used for ..." alt="" coords="2227,601,2421,631"/><area shape="rect" id="node84" href="../../dc/dae/flux_8c.html#aaf6d832880760f80459d91477c28b519" title="wrapper for different standard 1&#45;D flux calculators 1&#45;D interpolate and get flux for that direction (..." alt="" coords="2501,615,2616,644"/><area shape="rect" id="node86" href="../../dc/dae/flux_8c.html#a8ffa7399bd5354fdcdec5f3e1adf0b13" title="wrapper for CENT_to_FACE1,2,3 used to compute flux at face" alt="" coords="2733,640,2827,669"/><area shape="rect" id="node88" href="../../d5/d2f/flux_8funcdeclare_8h.html#ab229b0f3f2caf3c0a3ef5299fba2b1c0" title="see fluxcompute.c for non&#45;computer science, real physics calculations of flux" alt="" coords="2919,672,2985,701"/><area shape="rect" id="node96" href="../../df/d15/init_8tools_8c.html#a3750bc790613bc6c8c805af0f1b839c8" title="user1_init_vpot2field_user" alt="" coords="3040,327,3213,356"/><area shape="rect" id="node98" href="../../de/db2/initbase_8funcdeclare_8h.html#afda44281ad5c163455c40f012d4a8954" title="init_vpot2field_user" alt="" coords="3263,327,3396,356"/><area shape="rect" id="node100" href="../../de/db2/initbase_8funcdeclare_8h.html#a90699a18ede8b7f112c0078512804ec1" title="initialize vector potential given user function assumes normal non&#45;staggered field in pr Notice that ..." alt="" coords="3479,327,3548,356"/><area shape="rect" id="node111" href="../../d0/dde/fluxctstag_8c.html#a5e3dcbe89d6f8a9384cafb58afd7dbf4" title="interpolates field at FACE to field at CENT assuming field along itself is continuous" alt="" coords="2264,427,2384,474"/><area shape="rect" id="node117" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aaa24493002bc8c0a527b1ea2ac2dddbf" title="convert conservative U to stag point P and CENT point U and CENT point primitive" alt="" coords="2713,431,2847,460"/><area shape="rect" id="node127" href="../../d0/dde/fluxctstag_8c.html#a985ee116306b4011810334ae93900493" title="INPUTS: Nvec, pr, primface_l[dir], primface_r[dir] OUTPUTS: pbcorn[dir][side], pvcorn[dir][side][side..." alt="" coords="2235,655,2413,684"/><area shape="rect" id="node135" href="../../d9/de0/step__ch_8c.html#a91fe5c4370e3292a19e7f794797a407f" title="normal bounding of all primitives" alt="" coords="3463,113,3564,143"/><area shape="rect" id="node141" href="../../d9/de0/step__ch_8c.html#abdea68b778dc9253324da69d3c376965" title="bound any pstag type CALLS directly real and MPI boundary functions pstag is at FACE1,2,3 for fields, so user bound is different MPI bounding is the same as CENT quantities used when restarting in initbase.c to bound unewglobal for FLUXB==FLUXCTSTAG" alt="" coords="2016,120,2133,149"/><area shape="rect" id="node144" href="../../d9/de0/step__ch_8c.html#a6f4b963a50a7288964f01775f2f18bb9" title="normal bounding of staggered primitives" alt="" coords="2276,119,2372,148"/><area shape="rect" id="node147" href="../../d0/dde/fluxctstag_8c.html#aa169cb1999412f2e2460012cc5d7a804" title="pure DONOR version: upoint is input staggered updated field that needs to be converted to pstag and t..." alt="" coords="2471,105,2647,151"/><area shape="rect" id="node182" href="../../de/d51/bounds_8c.html#a16398a5325a9df48783423f00ba65bb7" title="all boundaries for RADCYLBEAMCART" alt="" coords="959,731,1111,760"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae5672d3575bbbb87acb183714955fb7b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> my_min </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html#l11239">11239</a> of file <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html">phys.tools.rad.c</a>.</p>

</div>
</div>
<a class="anchor" id="a267140b3112324c12f7ac5ce328da64a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> my_sign </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html#l11245">11245</a> of file <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html">phys.tools.rad.c</a>.</p>

</div>
</div>
<a class="anchor" id="af50896d039d660550b738862b3390b07"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int prad_fforlab </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>whichvel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>whichcoord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>whichdir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>ptrgeom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pradffortho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>radiative ortonormal ff primitives (E,F^i) &lt;-&gt; primitives in lab frame Used only for initial conditions whichvel: input vel type for U1-U3 whichcoord: input coord type for both U1-U3 and URAD1-URAD3 whichdir: LAB2FF or FF2LAB . </p>
<p>In addition, here lab means HARM-lab different by alpha factor from true lab. i,j,k,loc = standard grid location ptrgeom: any input geometry for the lab frame (ptrgeom could be from MCOORD, PRIMECOORDS, etc.) (same for pin's velocity as well as orthonormal basis) If ptrgeom==NULL, then use i,j,k,loc to get geometry in whichcoord coordinates pradffortho: radiation primitives (PRAD0-3) should be fluid-frame orthonormal basis values (i.e. E,F in fluid frame orthonormal basis) pin: inputs for primitives (i.e. whichvel for U1-U3 and whichcoord for U1-U3,URAD1-URAD3) pout: outputs for primitives ("") </p>

<p>Definition at line <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html#l11432">11432</a> of file <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html">phys.tools.rad.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d21/global_8funcdeclare_8rad_8h_af50896d039d660550b738862b3390b07_cgraph.png" border="0" usemap="#df/d21/global_8funcdeclare_8rad_8h_af50896d039d660550b738862b3390b07_cgraph" alt=""/></div>
<map name="df/d21/global_8funcdeclare_8rad_8h_af50896d039d660550b738862b3390b07_cgraph" id="df/d21/global_8funcdeclare_8rad_8h_af50896d039d660550b738862b3390b07_cgraph">
<area shape="rect" id="node3" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a2ec6ee79c76351868a725b22dac62135" title="like prad_fforlab() but for only whichdir=FF2LAB used for IC" alt="" coords="144,269,235,299"/><area shape="rect" id="node77" href="../../df/d21/global_8funcdeclare_8rad_8h.html#ad1313c275fb108d10f866373d9bb227a" title="like prad_fforlab() but for only whichdir=LAB2FF used for dumps or diags" alt="" coords="144,401,235,431"/><area shape="rect" id="node5" href="../../d2/d72/phys_8tools_8rad_8c.html#a949a0736746df92cb2600c6c015976e1" title="compute fluid frame orthonormal basis radiation stress&#45;energy tensor assuming M1 closure" alt="" coords="339,216,421,245"/><area shape="rect" id="node7" href="../../d3/ddc/phys_8funcdeclare_8h.html#a35c4399eb86e3fa77e2221000e077572" title="ucon_calc_whichvel" alt="" coords="311,269,449,299"/><area shape="rect" id="node23" href="../../d5/d0a/tetrad_8c.html#a6999a0ba04240d0dcbe3ae46adba0510" title="convert lab frame 4&#45;tensor to fluid frame orthonormal 4&#45;tensor" alt="" coords="289,348,471,377"/><area shape="rect" id="node64" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a9fe58e7f372421d18633c8fc5007b815" title="u2p_rad" alt="" coords="347,124,413,153"/><area shape="rect" id="node9" href="../../d3/ddc/phys_8funcdeclare_8h.html#ad141359a7901a82a0c26241b432183c3" title="find contravariant time component of four&#45;velocity from the 4velocity (3 terms)" alt="" coords="569,296,681,325"/><area shape="rect" id="node13" href="../../d3/ddc/phys_8funcdeclare_8h.html#afc1e1232a2f457b71cfd9210f2b5240a" title="find contravariant four&#45;velocity int ucon_calc(FTYPE *pr, struct of_geom *geom, FTYPE *ucon..." alt="" coords="569,243,681,272"/><area shape="rect" id="node15" href="../../d3/ddc/phys_8funcdeclare_8h.html#a7aadb359813194586356c2c325322a45" title="find contravariant four&#45;velocity from the relative 4 velocity" alt="" coords="563,189,688,219"/><area shape="rect" id="node11" href="../../d9/de9/coord_8c.html#a041e7b005310415c97d90f4b8521ed1a" title="get X(i,j,k) CENT is default position in degenerate cases" alt="" coords="848,296,901,325"/><area shape="rect" id="node17" href="../../d3/ddc/phys_8funcdeclare_8h.html#a5910aabe5e76183d341ef5b830b01bab" title="find {u}^ from u^ only fill spatial parts so can feed in 3&#45;vector" alt="" coords="843,243,907,272"/><area shape="rect" id="node19" href="../../d3/ddc/phys_8funcdeclare_8h.html#a20be479a3f03f3de780359d6e9290fe3" title="find u^ from {u}^ fill full 4&#45;vector OPTMARK: Before storing , this was the most expensive function o..." alt="" coords="775,189,975,219"/><area shape="rect" id="node21" href="../../d3/ddc/phys_8funcdeclare_8h.html#abfae38e47b0bd05a4fc38302ff948a96" title="find gamma&#45;factor wrt normal observer This function and qsq_calc() have about the same cache miss amo..." alt="" coords="1024,164,1195,193"/><area shape="rect" id="node25" href="../../d5/d0a/tetrad_8c.html#a69bb4f4bdcfeeddc2f94c291e3c4a887" title="use lab frame contravariant 4&#45;velocity (uconlab) and get transformation matrix for going to orthonorm..." alt="" coords="805,375,944,404"/><area shape="rect" id="node27" href="../../d5/d0a/tetrad_8c.html#a529e9fcba9169e956453fa28b0ec5b29" title="get stored or compute tetrcov and tetrcon primcoord: whether PRIMCOORDS type, so will use dxdxp to si..." alt="" coords="1056,375,1163,404"/><area shape="rect" id="node45" href="../../d6/d1b/metric_8tools_8c.html#af5438dd54272eb585ff5acb06d7195d4" title="matrix_inverse" alt="" coords="1767,452,1873,481"/><area shape="rect" id="node61" href="../../d5/d0a/tetrad_8c.html#aecffb2ef6ac562816636daf704607915" title="calculate boost assuming in orthonormal basis where g_{}={} = diag(&#45;1,0,0,0) NOTEMARK: Orthonormal do..." alt="" coords="1039,321,1180,351"/><area shape="rect" id="node29" href="../../d5/d0a/tetrad_8c.html#a1a0f6fda274fc7e16bdd8fcdfb4450ed" title="Notes:" alt="" coords="1243,375,1357,404"/><area shape="rect" id="node31" href="../../d9/de9/coord_8c.html#a0672d8c0ee4ff07c7265d0ecbc365cdc" title="normally&#45;used dxdxp[i,j,k] = dV/dX" alt="" coords="1431,295,1524,324"/><area shape="rect" id="node43" href="../../d9/de9/coord_8c.html#a8a51ec95e21441bc2c561af70a1037de" title="Get (dV/dX)^{&#45;1}." alt="" coords="1599,400,1676,429"/><area shape="rect" id="node47" href="../../d5/d0a/tetrad_8c.html#ad5d2935e2a3bac988149aa7b02c8feca" title="find suitable orthonormal tetrad wrapper for tetr_func()." alt="" coords="1407,348,1548,377"/><area shape="rect" id="node33" href="../../d9/de9/coord_8c.html#a64a4372100fc55abf546f02c8b779595" title="Jacobian for dx uniform per dx nonuniform (dx/dr / dx/dr&#39;) i.e." alt="" coords="1600,293,1675,323"/><area shape="rect" id="node35" href="../../d9/de9/coord_8c.html#a56c4b5c03b74a33a7d809daecfa6925e" title="numerical derivative of V w.r.t. X" alt="" coords="1760,293,1880,323"/><area shape="rect" id="node37" href="../../d9/de9/coord_8c.html#a65ad4ca9656d141cc995fd35ed31dc40" title="Returns boyer&#45;lindquist coordinte of point." alt="" coords="2023,293,2092,323"/><area shape="rect" id="node39" href="../../d8/d60/init_8c.html#a27c01fe4532cf3e10d467517403dbf70" title="blcoord_user" alt="" coords="2213,240,2309,269"/><area shape="rect" id="node41" href="../../d9/de9/coord_8c.html#af7a086e6042d598aea95c2360d07a99b" title="blcoord_singfixes" alt="" coords="2200,293,2323,323"/><area shape="rect" id="node50" href="../../d5/d0a/tetrad_8c.html#a0ca3db13e43c41bb7271db7bac10dc2a" title="input gcov and get out orthonormal tetrad in covariant and contravariant forms if metrictype..." alt="" coords="1601,347,1673,376"/><area shape="rect" id="node52" href="../../d5/d0a/tetrad_8c.html#a2ed15e40ab71ecd986b28510b0d8b8d4" title="compute_tetrcon_frommetric" alt="" coords="1727,399,1913,428"/><area shape="rect" id="node54" href="../../d5/d0a/tetrad_8c.html#a7daace7a466d45cd01436b89193102c0" title="pre&#45;setup tetrad use of lapack function" alt="" coords="1988,347,2127,376"/><area shape="rect" id="node58" href="../../d5/d0a/tetrad_8c.html#acc8b9e9ae9e03624e53b0a45e881a367" title="compute orthonormal tetrad [ortho]^[lab] for converting u_[lab] or u^[ortho] Notes: For full rotating..." alt="" coords="1964,399,2151,446"/><area shape="rect" id="node56" href="../../d4/dfc/tetlapack__func__doubleonly_8c.html#a6493f604b00b9a2337263d17b6230a02" title="native doubles for inside variables find tetrad" alt="" coords="2208,347,2315,376"/><area shape="rect" id="node66" href="../../d2/d72/phys_8tools_8rad_8c.html#a67b370af2fa58283bc590ff4e895fb90" title="Like u2p_rad_orig(), but uses Jon&#39;s paper draft ZAMO RAD version." alt="" coords="576,104,675,133"/><area shape="rect" id="node68" href="../../d2/d72/phys_8tools_8rad_8c.html#a77c546a7fb064266fef5a9e796dc63dc" title="compute ZAMO version of radiation quantities as in paper draft" alt="" coords="801,85,948,115"/><area shape="rect" id="node71" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a3e47afcfc5c42719999d851395fd032d" title="nrad(E)" alt="" coords="811,32,939,61"/><area shape="rect" id="node73" href="../../df/d21/global_8funcdeclare_8rad_8h.html#af07558357c906b4dfa61cd34656d9f02" title="E=urad=arad T^4 and just solve for T (this is LTE only if assume resulting T is gas T)..." alt="" coords="1047,5,1172,35"/><area shape="rect" id="node75" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a7dc2e853cec9b6f9a5e83ce23c468d03" title="nrad(T) = nrad=arad T^3/2.70118 (this is LTE only if put in T was gas T)" alt="" coords="1045,59,1173,88"/><area shape="rect" id="node79" href="../../d3/ddc/phys_8funcdeclare_8h.html#a11e17cd8b0594d1ad52e3594aa9f477e" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="343,480,417,509"/><area shape="rect" id="node87" href="../../df/d21/global_8funcdeclare_8rad_8h.html#aba8efc1e2ea7a31f67bb6c06ce3c164a" title="mhdfull_calc_rad" alt="" coords="320,585,440,615"/><area shape="rect" id="node91" href="../../d5/d0a/tetrad_8c.html#ae8d70957690f267632e5db4f4b06a490" title="Wrapper for vector_lab2orthofluidorback()" alt="" coords="284,401,476,431"/><area shape="rect" id="node81" href="../../d3/ddc/phys_8funcdeclare_8h.html#a12a473e24b431762af4168179e82cd08" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="544,453,707,483"/><area shape="rect" id="node83" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a8a762bf6582e6f7e1199de9c43b98454" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="527,507,724,536"/><area shape="rect" id="node85" href="../../d3/ddc/phys_8funcdeclare_8h.html#a41b8eacac0a4a23d6b00b670fe49629c" title="bsq_calc_fromq" alt="" coords="568,560,683,589"/><area shape="rect" id="node89" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a389bf7e41d2fd117af996e3392067cdc" title="compute radiation stres&#45;energy tensor assuming M1 closure" alt="" coords="575,613,676,643"/><area shape="rect" id="node93" href="../../d5/d0a/tetrad_8c.html#af9cffa9c2f215c3446c8dced2a326b42" title="convert 4&#45;vector to/from lab&#45;frame coordinate basis to fluid frame orthonormal basis" alt="" coords="535,400,716,429"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d21/global_8funcdeclare_8rad_8h_af50896d039d660550b738862b3390b07_icgraph.png" border="0" usemap="#df/d21/global_8funcdeclare_8rad_8h_af50896d039d660550b738862b3390b07_icgraph" alt=""/></div>
<map name="df/d21/global_8funcdeclare_8rad_8h_af50896d039d660550b738862b3390b07_icgraph" id="df/d21/global_8funcdeclare_8rad_8h_af50896d039d660550b738862b3390b07_icgraph">
<area shape="rect" id="node3" href="../../d8/d60/init_8c.html#af94364e17d67cddfbb7bb3bf39c05ee6" title="init_dsandvels_koral" alt="" coords="149,132,288,161"/><area shape="rect" id="node15" href="../../d8/d60/init_8c.html#a448cd3fd9a1d862485e7b6e67b965172" title="process_restart_toget\l_radiation" alt="" coords="145,381,292,427"/><area shape="rect" id="node17" href="../../d2/d72/phys_8tools_8rad_8c.html#a64226cb28f52020ffe18ac6c6b1a2f5c" title="Input: start with pin [with fluid in whichvel velocity and whichcoordfluid coordinates (PRIMECOORDS o..." alt="" coords="153,311,284,358"/><area shape="rect" id="node5" href="../../df/d15/init_8tools_8c.html#acefd26944dbbb1c289886f520f6befac" title="init_dsandvels" alt="" coords="671,5,775,35"/><area shape="rect" id="node7" href="../../df/d15/init_8tools_8c.html#a77551ab2581efdbaf170dfca073ff9ab" title="user1_init_primitives" alt="" coords="3288,227,3429,256"/><area shape="rect" id="node9" href="../../de/db2/initbase_8funcdeclare_8h.html#a0afa200a5f947b1c9f6e554519f28fc4" title="init_primitives" alt="" coords="3479,279,3580,308"/><area shape="rect" id="node11" href="../../de/df8/initbase_8c.html#ac4110398e386c9888d9565630357dbbe" title="General&#45;Primary init() routine Uses globals inside init() because sets memory and sets physics..." alt="" coords="3657,331,3695,360"/><area shape="rect" id="node13" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="3771,387,3821,416"/><area shape="rect" id="node19" href="../../de/d51/bounds_8c.html#a3bc773d499b145705bdc23125b963840" title="Koral specific physical boundary conditions." alt="" coords="623,264,823,293"/><area shape="rect" id="node119" href="../../de/d51/bounds_8c.html#a09a080d9895db7b800a3824cb3fac9f1" title="X1 lower for beam injection to create shadow." alt="" coords="643,317,803,347"/><area shape="rect" id="node122" href="../../de/d51/bounds_8c.html#a3ee134cc5fb18752265c16a20dbdfb63" title="X3 lower for radiation beam injection." alt="" coords="625,371,820,400"/><area shape="rect" id="node125" href="../../de/d51/bounds_8c.html#a8300ddf3ae6a3866234cc0e9c12f26dc" title="X1 upper for inflow." alt="" coords="629,424,816,453"/><area shape="rect" id="node128" href="../../de/d51/bounds_8c.html#a01088f65c7a4cfa2ebfed202f815b951" title="X1 lower and upper for RADATM." alt="" coords="637,477,808,507"/><area shape="rect" id="node131" href="../../de/d51/bounds_8c.html#a1382959a7b699ea5d224168612504263" title="X1 upper for inflow." alt="" coords="384,524,531,553"/><area shape="rect" id="node134" href="../../de/d51/bounds_8c.html#ac15824bc610943cb7e02112e77b94752" title="on&#45;grid bounding" alt="" coords="408,577,507,607"/><area shape="rect" id="node137" href="../../de/d51/bounds_8c.html#a42658c4ecf3c6edb958394eb65a9ac2b" title="RADNT." alt="" coords="411,631,504,660"/><area shape="rect" id="node140" href="../../de/d51/bounds_8c.html#a3e4008fd24427b2e91d0ae5882b9536a" title="X1 upper for RADCYLBEAM." alt="" coords="375,57,540,87"/><area shape="rect" id="node143" href="../../de/d51/bounds_8c.html#ac32c1a20138382904dc5f1c66778ad8b" title="X1 upper for RADCYLJET." alt="" coords="384,111,531,140"/><area shape="rect" id="node146" href="../../de/d51/bounds_8c.html#a635fbaba3d6d6afcf5f34bbb2c278737" title="X2 upper for radiation beam injection." alt="" coords="343,164,572,193"/><area shape="rect" id="node149" href="../../de/d51/bounds_8c.html#a9f1df4e461f3f776bf3cb80e36a4d6df" title="get_radcylbeamcart" alt="" coords="389,217,525,247"/><area shape="rect" id="node21" href="../../de/d51/bounds_8c.html#a34ac3f1ca7b0f3a21053c633da9931a9" title="user boundary routine" alt="" coords="872,344,1043,373"/><area shape="rect" id="node23" href="../../d4/dad/bounds_8funcdeclare_8h.html#a4bc7413b2cdb89e070f38bbb689ae555" title="bound_prim_user_dir" alt="" coords="1095,399,1236,428"/><area shape="rect" id="node108" href="../../d4/dad/bounds_8funcdeclare_8h.html#a2fbddc9ff8fc706bafa80c39695c7262" title="assume single user function takes care of primitive locations" alt="" coords="1091,248,1240,277"/><area shape="rect" id="node25" href="../../d9/de0/step__ch_8c.html#adbe0e3ba8a74f09ab928a96bd68cab6d" title="bound any prim type CALLS directly real and MPI boundary functions pstag = pstagglobal ucons = unewgl..." alt="" coords="1289,480,1399,509"/><area shape="rect" id="node27" href="../../d9/de0/step__ch_8c.html#a689fddc1949b1a1d390b59d10d17d83c" title="normal full bounding during evolution NOTEMARK: Was previously also bounding pstag here..." alt="" coords="1467,809,1592,839"/><area shape="rect" id="node39" href="../../d9/de0/step__ch_8c.html#a4079244d85c301885c1363ca41502869" title="simple bounding during evolution NOTEMARK: Was previously also bounding pstag here, but not necessary since done by calling bound_pstag in fluxctstag.c" alt="" coords="1448,863,1611,892"/><area shape="rect" id="node42" href="../../d9/de0/step__ch_8c.html#addca75a18cc861326a321565a2e81aa0" title="normal bounding of non&#45;staggered primitives" alt="" coords="1485,480,1573,509"/><area shape="rect" id="node102" href="../../d9/de0/step__ch_8c.html#a460b84e1112e3aef17209c20e22e1cf1" title="bound all prims" alt="" coords="1921,117,2044,147"/><area shape="rect" id="node29" href="../../d9/de0/step__ch_8c.html#ad36a0f9f915547477e3bb2405f8166b9" title="things to do after advance()" alt="" coords="1697,863,1799,892"/><area shape="rect" id="node31" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="3105,759,3239,788"/><area shape="rect" id="node33" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="3496,552,3563,581"/><area shape="rect" id="node35" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="3631,443,3721,472"/><area shape="rect" id="node44" href="../../dc/dae/flux_8c.html#aef355ccd1ca2295b84ad2fe1fc011d35" title="normal interpolation of CENT quantities to FACE quantities sets global variables pl_ct and pr_ct to p..." alt="" coords="1659,585,1837,615"/><area shape="rect" id="node61" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aecb3f613a7cb3bbb42fff2dbee5d65a1" title="This vpot2field function is for staggered method to evolve quasi&#45;deaveraged fields (i..." alt="" coords="2356,329,2521,359"/><area shape="rect" id="node63" href="../../de/db2/initbase_8funcdeclare_8h.html#ae6b2ad4cd0debf5b89ba8a9e471d6977" title="assumes normal field p pleft used as temp var if FLUXB==FLUXCTSTAG assigns conserved field in UEVOLVE..." alt="" coords="2572,316,2649,345"/><area shape="rect" id="node72" href="../../d0/dde/fluxctstag_8c.html#a4e3d76c6ad125b8199948408c262e3a1" title="wrapper for: 1) interpolate FACE 2 CORN 2) loop over dimensions setting field flux dimension&#45;by&#45;dimen..." alt="" coords="2152,683,2283,712"/><area shape="rect" id="node75" href="../../d0/dde/fluxctstag_8c.html#a2dd789bf1402bef72523cdb69e85806e" title="use global pbcorninterp and pvcorninterp at CORN1,2,3 to obtain EMFs at CORN1,2,3 NO interpolation of..." alt="" coords="1683,638,1813,685"/><area shape="rect" id="node78" href="../../d0/dde/fluxctstag_8c.html#aaec26a518629175ecceefbaf6c84225e" title="wrapper for continuous interpolation for FACE_to_CENT" alt="" coords="1661,532,1835,561"/><area shape="rect" id="node82" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aa31dd83c96936277334c62e2098dd51d" title="wrapper for taking staggered conserved field quantity and obtaining centered field quantity upoint en..." alt="" coords="2129,483,2305,512"/><area shape="rect" id="node91" href="../../d0/dde/fluxctstag_8c.html#a6cd90dff56319085b32bc57c0c8b3cfd" title="this function called in initbase.c and during advance() here ustag is point value if dimension doesn&#39;..." alt="" coords="1923,431,2043,460"/><area shape="rect" id="node94" href="../../d0/dde/fluxctstag_8c.html#ad6aa918442f7768dff3c099ba353ee64" title="slope_lim_face2corn() is provided p2interp and returns pleft/pright differs from slope_lim() by range..." alt="" coords="1677,708,1819,737"/><area shape="rect" id="node46" href="../../dc/dae/flux_8c.html#a2602a4dad9ed7adc944227d02435312e" title="standard (non&#45;field flux) calculation but setup to store results of interpolation so can be used for ..." alt="" coords="1885,604,2080,633"/><area shape="rect" id="node48" href="../../dc/dae/flux_8c.html#aaf6d832880760f80459d91477c28b519" title="wrapper for different standard 1&#45;D flux calculators 1&#45;D interpolate and get flux for that direction (..." alt="" coords="2160,604,2275,633"/><area shape="rect" id="node50" href="../../dc/dae/flux_8c.html#a8ffa7399bd5354fdcdec5f3e1adf0b13" title="wrapper for CENT_to_FACE1,2,3 used to compute flux at face" alt="" coords="2392,604,2485,633"/><area shape="rect" id="node52" href="../../d5/d2f/flux_8funcdeclare_8h.html#ab229b0f3f2caf3c0a3ef5299fba2b1c0" title="see fluxcompute.c for non&#45;computer science, real physics calculations of flux" alt="" coords="2577,604,2644,633"/><area shape="rect" id="node54" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="2721,604,2849,633"/><area shape="rect" id="node59" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="2708,521,2863,551"/><area shape="rect" id="node56" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="2953,656,3023,685"/><area shape="rect" id="node65" href="../../df/d15/init_8tools_8c.html#a3750bc790613bc6c8c805af0f1b839c8" title="user1_init_vpot2field_user" alt="" coords="2699,316,2872,345"/><area shape="rect" id="node67" href="../../de/db2/initbase_8funcdeclare_8h.html#afda44281ad5c163455c40f012d4a8954" title="init_vpot2field_user" alt="" coords="2921,316,3055,345"/><area shape="rect" id="node69" href="../../de/db2/initbase_8funcdeclare_8h.html#a90699a18ede8b7f112c0078512804ec1" title="initialize vector potential given user function assumes normal non&#45;staggered field in pr Notice that ..." alt="" coords="3137,304,3207,333"/><area shape="rect" id="node80" href="../../d0/dde/fluxctstag_8c.html#a5e3dcbe89d6f8a9384cafb58afd7dbf4" title="interpolates field at FACE to field at CENT assuming field along itself is continuous" alt="" coords="1923,534,2043,581"/><area shape="rect" id="node86" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aaa24493002bc8c0a527b1ea2ac2dddbf" title="convert conservative U to stag point P and CENT point U and CENT point primitive" alt="" coords="2372,433,2505,463"/><area shape="rect" id="node96" href="../../d0/dde/fluxctstag_8c.html#a985ee116306b4011810334ae93900493" title="INPUTS: Nvec, pr, primface_l[dir], primface_r[dir] OUTPUTS: pbcorn[dir][side], pvcorn[dir][side][side..." alt="" coords="1893,708,2072,737"/><area shape="rect" id="node104" href="../../d9/de0/step__ch_8c.html#a91fe5c4370e3292a19e7f794797a407f" title="normal bounding of all primitives" alt="" coords="3121,175,3223,204"/><area shape="rect" id="node110" href="../../d9/de0/step__ch_8c.html#abdea68b778dc9253324da69d3c376965" title="bound any pstag type CALLS directly real and MPI boundary functions pstag is at FACE1,2,3 for fields, so user bound is different MPI bounding is the same as CENT quantities used when restarting in initbase.c to bound unewglobal for FLUXB==FLUXCTSTAG" alt="" coords="1689,123,1807,152"/><area shape="rect" id="node113" href="../../d9/de0/step__ch_8c.html#a6f4b963a50a7288964f01775f2f18bb9" title="normal bounding of staggered primitives" alt="" coords="1935,171,2031,200"/><area shape="rect" id="node116" href="../../d0/dde/fluxctstag_8c.html#aa169cb1999412f2e2460012cc5d7a804" title="pure DONOR version: upoint is input staggered updated field that needs to be converted to pstag and t..." alt="" coords="2129,158,2305,205"/><area shape="rect" id="node151" href="../../de/d51/bounds_8c.html#a16398a5325a9df48783423f00ba65bb7" title="all boundaries for RADCYLBEAMCART" alt="" coords="647,211,799,240"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2ec6ee79c76351868a725b22dac62135"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int prad_fftolab </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>whichvel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>whichcoord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>ptrgeom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pradffortho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>like <a class="el" href="../../df/d21/global_8funcdeclare_8rad_8h.html#af50896d039d660550b738862b3390b07" title="radiative ortonormal ff primitives (E,F^i) &lt;-&gt; primitives in lab frame Used only for initial conditio...">prad_fforlab()</a> but for only whichdir=FF2LAB used for IC </p>

<p>Definition at line <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html#l11526">11526</a> of file <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html">phys.tools.rad.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d21/global_8funcdeclare_8rad_8h_a2ec6ee79c76351868a725b22dac62135_cgraph.png" border="0" usemap="#df/d21/global_8funcdeclare_8rad_8h_a2ec6ee79c76351868a725b22dac62135_cgraph" alt=""/></div>
<map name="df/d21/global_8funcdeclare_8rad_8h_a2ec6ee79c76351868a725b22dac62135_cgraph" id="df/d21/global_8funcdeclare_8rad_8h_a2ec6ee79c76351868a725b22dac62135_cgraph">
<area shape="rect" id="node3" href="../../d2/d72/phys_8tools_8rad_8c.html#a949a0736746df92cb2600c6c015976e1" title="compute fluid frame orthonormal basis radiation stress&#45;energy tensor assuming M1 closure" alt="" coords="193,59,276,88"/><area shape="rect" id="node5" href="../../d3/ddc/phys_8funcdeclare_8h.html#a35c4399eb86e3fa77e2221000e077572" title="ucon_calc_whichvel" alt="" coords="165,112,304,141"/><area shape="rect" id="node21" href="../../d5/d0a/tetrad_8c.html#a6999a0ba04240d0dcbe3ae46adba0510" title="convert lab frame 4&#45;tensor to fluid frame orthonormal 4&#45;tensor" alt="" coords="144,284,325,313"/><area shape="rect" id="node62" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a9fe58e7f372421d18633c8fc5007b815" title="u2p_rad" alt="" coords="201,179,268,208"/><area shape="rect" id="node7" href="../../d3/ddc/phys_8funcdeclare_8h.html#ad141359a7901a82a0c26241b432183c3" title="find contravariant time component of four&#45;velocity from the 4velocity (3 terms)" alt="" coords="387,59,499,88"/><area shape="rect" id="node11" href="../../d3/ddc/phys_8funcdeclare_8h.html#afc1e1232a2f457b71cfd9210f2b5240a" title="find contravariant four&#45;velocity int ucon_calc(FTYPE *pr, struct of_geom *geom, FTYPE *ucon..." alt="" coords="387,5,499,35"/><area shape="rect" id="node13" href="../../d3/ddc/phys_8funcdeclare_8h.html#a7aadb359813194586356c2c325322a45" title="find contravariant four&#45;velocity from the relative 4 velocity" alt="" coords="380,112,505,141"/><area shape="rect" id="node9" href="../../d9/de9/coord_8c.html#a041e7b005310415c97d90f4b8521ed1a" title="get X(i,j,k) CENT is default position in degenerate cases" alt="" coords="635,5,688,35"/><area shape="rect" id="node15" href="../../d3/ddc/phys_8funcdeclare_8h.html#a5910aabe5e76183d341ef5b830b01bab" title="find {u}^ from u^ only fill spatial parts so can feed in 3&#45;vector" alt="" coords="629,59,693,88"/><area shape="rect" id="node17" href="../../d3/ddc/phys_8funcdeclare_8h.html#a20be479a3f03f3de780359d6e9290fe3" title="find u^ from {u}^ fill full 4&#45;vector OPTMARK: Before storing , this was the most expensive function o..." alt="" coords="561,112,761,141"/><area shape="rect" id="node19" href="../../d3/ddc/phys_8funcdeclare_8h.html#abfae38e47b0bd05a4fc38302ff948a96" title="find gamma&#45;factor wrt normal observer This function and qsq_calc() have about the same cache miss amo..." alt="" coords="811,137,981,167"/><area shape="rect" id="node23" href="../../d5/d0a/tetrad_8c.html#a69bb4f4bdcfeeddc2f94c291e3c4a887" title="use lab frame contravariant 4&#45;velocity (uconlab) and get transformation matrix for going to orthonorm..." alt="" coords="373,349,512,379"/><area shape="rect" id="node25" href="../../d5/d0a/tetrad_8c.html#a529e9fcba9169e956453fa28b0ec5b29" title="get stored or compute tetrcov and tetrcon primcoord: whether PRIMCOORDS type, so will use dxdxp to si..." alt="" coords="608,323,715,352"/><area shape="rect" id="node43" href="../../d6/d1b/metric_8tools_8c.html#af5438dd54272eb585ff5acb06d7195d4" title="matrix_inverse" alt="" coords="1391,375,1497,404"/><area shape="rect" id="node59" href="../../d5/d0a/tetrad_8c.html#aecffb2ef6ac562816636daf704607915" title="calculate boost assuming in orthonormal basis where g_{}={} = diag(&#45;1,0,0,0) NOTEMARK: Orthonormal do..." alt="" coords="591,427,732,456"/><area shape="rect" id="node27" href="../../d5/d0a/tetrad_8c.html#a1a0f6fda274fc7e16bdd8fcdfb4450ed" title="Notes:" alt="" coords="839,323,953,352"/><area shape="rect" id="node29" href="../../d9/de9/coord_8c.html#a0672d8c0ee4ff07c7265d0ecbc365cdc" title="normally&#45;used dxdxp[i,j,k] = dV/dX" alt="" coords="1055,217,1148,247"/><area shape="rect" id="node41" href="../../d9/de9/coord_8c.html#a8a51ec95e21441bc2c561af70a1037de" title="Get (dV/dX)^{&#45;1}." alt="" coords="1223,323,1300,352"/><area shape="rect" id="node45" href="../../d5/d0a/tetrad_8c.html#ad5d2935e2a3bac988149aa7b02c8feca" title="find suitable orthonormal tetrad wrapper for tetr_func()." alt="" coords="1031,271,1172,300"/><area shape="rect" id="node31" href="../../d9/de9/coord_8c.html#a64a4372100fc55abf546f02c8b779595" title="Jacobian for dx uniform per dx nonuniform (dx/dr / dx/dr&#39;) i.e." alt="" coords="1224,216,1299,245"/><area shape="rect" id="node33" href="../../d9/de9/coord_8c.html#a56c4b5c03b74a33a7d809daecfa6925e" title="numerical derivative of V w.r.t. X" alt="" coords="1384,216,1504,245"/><area shape="rect" id="node35" href="../../d9/de9/coord_8c.html#a65ad4ca9656d141cc995fd35ed31dc40" title="Returns boyer&#45;lindquist coordinte of point." alt="" coords="1647,216,1716,245"/><area shape="rect" id="node37" href="../../d8/d60/init_8c.html#a27c01fe4532cf3e10d467517403dbf70" title="blcoord_user" alt="" coords="1837,163,1933,192"/><area shape="rect" id="node39" href="../../d9/de9/coord_8c.html#af7a086e6042d598aea95c2360d07a99b" title="blcoord_singfixes" alt="" coords="1824,216,1947,245"/><area shape="rect" id="node48" href="../../d5/d0a/tetrad_8c.html#a0ca3db13e43c41bb7271db7bac10dc2a" title="input gcov and get out orthonormal tetrad in covariant and contravariant forms if metrictype..." alt="" coords="1225,269,1297,299"/><area shape="rect" id="node50" href="../../d5/d0a/tetrad_8c.html#a2ed15e40ab71ecd986b28510b0d8b8d4" title="compute_tetrcon_frommetric" alt="" coords="1351,321,1537,351"/><area shape="rect" id="node52" href="../../d5/d0a/tetrad_8c.html#a7daace7a466d45cd01436b89193102c0" title="pre&#45;setup tetrad use of lapack function" alt="" coords="1612,269,1751,299"/><area shape="rect" id="node56" href="../../d5/d0a/tetrad_8c.html#acc8b9e9ae9e03624e53b0a45e881a367" title="compute orthonormal tetrad [ortho]^[lab] for converting u_[lab] or u^[ortho] Notes: For full rotating..." alt="" coords="1588,322,1775,369"/><area shape="rect" id="node54" href="../../d4/dfc/tetlapack__func__doubleonly_8c.html#a6493f604b00b9a2337263d17b6230a02" title="native doubles for inside variables find tetrad" alt="" coords="1832,269,1939,299"/><area shape="rect" id="node64" href="../../d2/d72/phys_8tools_8rad_8c.html#a67b370af2fa58283bc590ff4e895fb90" title="Like u2p_rad_orig(), but uses Jon&#39;s paper draft ZAMO RAD version." alt="" coords="393,204,492,233"/><area shape="rect" id="node66" href="../../d2/d72/phys_8tools_8rad_8c.html#a77c546a7fb064266fef5a9e796dc63dc" title="compute ZAMO version of radiation quantities as in paper draft" alt="" coords="588,216,735,245"/><area shape="rect" id="node69" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a3e47afcfc5c42719999d851395fd032d" title="nrad(E)" alt="" coords="597,269,725,299"/><area shape="rect" id="node71" href="../../df/d21/global_8funcdeclare_8rad_8h.html#af07558357c906b4dfa61cd34656d9f02" title="E=urad=arad T^4 and just solve for T (this is LTE only if assume resulting T is gas T)..." alt="" coords="833,269,959,299"/><area shape="rect" id="node73" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a7dc2e853cec9b6f9a5e83ce23c468d03" title="nrad(T) = nrad=arad T^3/2.70118 (this is LTE only if put in T was gas T)" alt="" coords="832,216,960,245"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d21/global_8funcdeclare_8rad_8h_a2ec6ee79c76351868a725b22dac62135_icgraph.png" border="0" usemap="#df/d21/global_8funcdeclare_8rad_8h_a2ec6ee79c76351868a725b22dac62135_icgraph" alt=""/></div>
<map name="df/d21/global_8funcdeclare_8rad_8h_a2ec6ee79c76351868a725b22dac62135_icgraph" id="df/d21/global_8funcdeclare_8rad_8h_a2ec6ee79c76351868a725b22dac62135_icgraph">
<area shape="rect" id="node3" href="../../d2/d72/phys_8tools_8rad_8c.html#af50896d039d660550b738862b3390b07" title="radiative ortonormal ff primitives (E,F^i) &lt;&#45;&gt; primitives in lab frame Used only for initial conditio..." alt="" coords="144,320,235,349"/><area shape="rect" id="node5" href="../../d8/d60/init_8c.html#af94364e17d67cddfbb7bb3bf39c05ee6" title="init_dsandvels_koral" alt="" coords="288,132,427,161"/><area shape="rect" id="node17" href="../../d8/d60/init_8c.html#a448cd3fd9a1d862485e7b6e67b965172" title="process_restart_toget\l_radiation" alt="" coords="284,381,431,427"/><area shape="rect" id="node19" href="../../d2/d72/phys_8tools_8rad_8c.html#a64226cb28f52020ffe18ac6c6b1a2f5c" title="Input: start with pin [with fluid in whichvel velocity and whichcoordfluid coordinates (PRIMECOORDS o..." alt="" coords="292,311,423,358"/><area shape="rect" id="node7" href="../../df/d15/init_8tools_8c.html#acefd26944dbbb1c289886f520f6befac" title="init_dsandvels" alt="" coords="809,5,913,35"/><area shape="rect" id="node9" href="../../df/d15/init_8tools_8c.html#a77551ab2581efdbaf170dfca073ff9ab" title="user1_init_primitives" alt="" coords="3427,227,3568,256"/><area shape="rect" id="node11" href="../../de/db2/initbase_8funcdeclare_8h.html#a0afa200a5f947b1c9f6e554519f28fc4" title="init_primitives" alt="" coords="3617,279,3719,308"/><area shape="rect" id="node13" href="../../de/df8/initbase_8c.html#ac4110398e386c9888d9565630357dbbe" title="General&#45;Primary init() routine Uses globals inside init() because sets memory and sets physics..." alt="" coords="3796,331,3833,360"/><area shape="rect" id="node15" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="3909,387,3960,416"/><area shape="rect" id="node21" href="../../de/d51/bounds_8c.html#a3bc773d499b145705bdc23125b963840" title="Koral specific physical boundary conditions." alt="" coords="761,264,961,293"/><area shape="rect" id="node121" href="../../de/d51/bounds_8c.html#a09a080d9895db7b800a3824cb3fac9f1" title="X1 lower for beam injection to create shadow." alt="" coords="781,317,941,347"/><area shape="rect" id="node124" href="../../de/d51/bounds_8c.html#a3ee134cc5fb18752265c16a20dbdfb63" title="X3 lower for radiation beam injection." alt="" coords="764,371,959,400"/><area shape="rect" id="node127" href="../../de/d51/bounds_8c.html#a8300ddf3ae6a3866234cc0e9c12f26dc" title="X1 upper for inflow." alt="" coords="768,424,955,453"/><area shape="rect" id="node130" href="../../de/d51/bounds_8c.html#a01088f65c7a4cfa2ebfed202f815b951" title="X1 lower and upper for RADATM." alt="" coords="776,477,947,507"/><area shape="rect" id="node133" href="../../de/d51/bounds_8c.html#a1382959a7b699ea5d224168612504263" title="X1 upper for inflow." alt="" coords="523,524,669,553"/><area shape="rect" id="node136" href="../../de/d51/bounds_8c.html#ac15824bc610943cb7e02112e77b94752" title="on&#45;grid bounding" alt="" coords="547,577,645,607"/><area shape="rect" id="node139" href="../../de/d51/bounds_8c.html#a42658c4ecf3c6edb958394eb65a9ac2b" title="RADNT." alt="" coords="549,631,643,660"/><area shape="rect" id="node142" href="../../de/d51/bounds_8c.html#a3e4008fd24427b2e91d0ae5882b9536a" title="X1 upper for RADCYLBEAM." alt="" coords="513,57,679,87"/><area shape="rect" id="node145" href="../../de/d51/bounds_8c.html#ac32c1a20138382904dc5f1c66778ad8b" title="X1 upper for RADCYLJET." alt="" coords="523,111,669,140"/><area shape="rect" id="node148" href="../../de/d51/bounds_8c.html#a635fbaba3d6d6afcf5f34bbb2c278737" title="X2 upper for radiation beam injection." alt="" coords="481,164,711,193"/><area shape="rect" id="node151" href="../../de/d51/bounds_8c.html#a9f1df4e461f3f776bf3cb80e36a4d6df" title="get_radcylbeamcart" alt="" coords="528,217,664,247"/><area shape="rect" id="node23" href="../../de/d51/bounds_8c.html#a34ac3f1ca7b0f3a21053c633da9931a9" title="user boundary routine" alt="" coords="1011,344,1181,373"/><area shape="rect" id="node25" href="../../d4/dad/bounds_8funcdeclare_8h.html#a4bc7413b2cdb89e070f38bbb689ae555" title="bound_prim_user_dir" alt="" coords="1233,399,1375,428"/><area shape="rect" id="node110" href="../../d4/dad/bounds_8funcdeclare_8h.html#a2fbddc9ff8fc706bafa80c39695c7262" title="assume single user function takes care of primitive locations" alt="" coords="1229,248,1379,277"/><area shape="rect" id="node27" href="../../d9/de0/step__ch_8c.html#adbe0e3ba8a74f09ab928a96bd68cab6d" title="bound any prim type CALLS directly real and MPI boundary functions pstag = pstagglobal ucons = unewgl..." alt="" coords="1428,480,1537,509"/><area shape="rect" id="node29" href="../../d9/de0/step__ch_8c.html#a689fddc1949b1a1d390b59d10d17d83c" title="normal full bounding during evolution NOTEMARK: Was previously also bounding pstag here..." alt="" coords="1605,809,1731,839"/><area shape="rect" id="node41" href="../../d9/de0/step__ch_8c.html#a4079244d85c301885c1363ca41502869" title="simple bounding during evolution NOTEMARK: Was previously also bounding pstag here, but not necessary since done by calling bound_pstag in fluxctstag.c" alt="" coords="1587,863,1749,892"/><area shape="rect" id="node44" href="../../d9/de0/step__ch_8c.html#addca75a18cc861326a321565a2e81aa0" title="normal bounding of non&#45;staggered primitives" alt="" coords="1624,480,1712,509"/><area shape="rect" id="node104" href="../../d9/de0/step__ch_8c.html#a460b84e1112e3aef17209c20e22e1cf1" title="bound all prims" alt="" coords="2060,117,2183,147"/><area shape="rect" id="node31" href="../../d9/de0/step__ch_8c.html#ad36a0f9f915547477e3bb2405f8166b9" title="things to do after advance()" alt="" coords="1836,863,1937,892"/><area shape="rect" id="node33" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="3244,759,3377,788"/><area shape="rect" id="node35" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="3635,552,3701,581"/><area shape="rect" id="node37" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="3769,443,3860,472"/><area shape="rect" id="node46" href="../../dc/dae/flux_8c.html#aef355ccd1ca2295b84ad2fe1fc011d35" title="normal interpolation of CENT quantities to FACE quantities sets global variables pl_ct and pr_ct to p..." alt="" coords="1797,585,1976,615"/><area shape="rect" id="node63" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aecb3f613a7cb3bbb42fff2dbee5d65a1" title="This vpot2field function is for staggered method to evolve quasi&#45;deaveraged fields (i..." alt="" coords="2495,329,2660,359"/><area shape="rect" id="node65" href="../../de/db2/initbase_8funcdeclare_8h.html#ae6b2ad4cd0debf5b89ba8a9e471d6977" title="assumes normal field p pleft used as temp var if FLUXB==FLUXCTSTAG assigns conserved field in UEVOLVE..." alt="" coords="2711,316,2788,345"/><area shape="rect" id="node74" href="../../d0/dde/fluxctstag_8c.html#a4e3d76c6ad125b8199948408c262e3a1" title="wrapper for: 1) interpolate FACE 2 CORN 2) loop over dimensions setting field flux dimension&#45;by&#45;dimen..." alt="" coords="2291,683,2421,712"/><area shape="rect" id="node77" href="../../d0/dde/fluxctstag_8c.html#a2dd789bf1402bef72523cdb69e85806e" title="use global pbcorninterp and pvcorninterp at CORN1,2,3 to obtain EMFs at CORN1,2,3 NO interpolation of..." alt="" coords="1821,638,1952,685"/><area shape="rect" id="node80" href="../../d0/dde/fluxctstag_8c.html#aaec26a518629175ecceefbaf6c84225e" title="wrapper for continuous interpolation for FACE_to_CENT" alt="" coords="1800,532,1973,561"/><area shape="rect" id="node84" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aa31dd83c96936277334c62e2098dd51d" title="wrapper for taking staggered conserved field quantity and obtaining centered field quantity upoint en..." alt="" coords="2268,483,2444,512"/><area shape="rect" id="node93" href="../../d0/dde/fluxctstag_8c.html#a6cd90dff56319085b32bc57c0c8b3cfd" title="this function called in initbase.c and during advance() here ustag is point value if dimension doesn&#39;..." alt="" coords="2061,431,2181,460"/><area shape="rect" id="node96" href="../../d0/dde/fluxctstag_8c.html#ad6aa918442f7768dff3c099ba353ee64" title="slope_lim_face2corn() is provided p2interp and returns pleft/pright differs from slope_lim() by range..." alt="" coords="1816,708,1957,737"/><area shape="rect" id="node48" href="../../dc/dae/flux_8c.html#a2602a4dad9ed7adc944227d02435312e" title="standard (non&#45;field flux) calculation but setup to store results of interpolation so can be used for ..." alt="" coords="2024,604,2219,633"/><area shape="rect" id="node50" href="../../dc/dae/flux_8c.html#aaf6d832880760f80459d91477c28b519" title="wrapper for different standard 1&#45;D flux calculators 1&#45;D interpolate and get flux for that direction (..." alt="" coords="2299,604,2413,633"/><area shape="rect" id="node52" href="../../dc/dae/flux_8c.html#a8ffa7399bd5354fdcdec5f3e1adf0b13" title="wrapper for CENT_to_FACE1,2,3 used to compute flux at face" alt="" coords="2531,604,2624,633"/><area shape="rect" id="node54" href="../../d5/d2f/flux_8funcdeclare_8h.html#ab229b0f3f2caf3c0a3ef5299fba2b1c0" title="see fluxcompute.c for non&#45;computer science, real physics calculations of flux" alt="" coords="2716,604,2783,633"/><area shape="rect" id="node56" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="2860,604,2988,633"/><area shape="rect" id="node61" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="2847,521,3001,551"/><area shape="rect" id="node58" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="3092,656,3161,685"/><area shape="rect" id="node67" href="../../df/d15/init_8tools_8c.html#a3750bc790613bc6c8c805af0f1b839c8" title="user1_init_vpot2field_user" alt="" coords="2837,316,3011,345"/><area shape="rect" id="node69" href="../../de/db2/initbase_8funcdeclare_8h.html#afda44281ad5c163455c40f012d4a8954" title="init_vpot2field_user" alt="" coords="3060,316,3193,345"/><area shape="rect" id="node71" href="../../de/db2/initbase_8funcdeclare_8h.html#a90699a18ede8b7f112c0078512804ec1" title="initialize vector potential given user function assumes normal non&#45;staggered field in pr Notice that ..." alt="" coords="3276,304,3345,333"/><area shape="rect" id="node82" href="../../d0/dde/fluxctstag_8c.html#a5e3dcbe89d6f8a9384cafb58afd7dbf4" title="interpolates field at FACE to field at CENT assuming field along itself is continuous" alt="" coords="2061,534,2181,581"/><area shape="rect" id="node88" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aaa24493002bc8c0a527b1ea2ac2dddbf" title="convert conservative U to stag point P and CENT point U and CENT point primitive" alt="" coords="2511,433,2644,463"/><area shape="rect" id="node98" href="../../d0/dde/fluxctstag_8c.html#a985ee116306b4011810334ae93900493" title="INPUTS: Nvec, pr, primface_l[dir], primface_r[dir] OUTPUTS: pbcorn[dir][side], pvcorn[dir][side][side..." alt="" coords="2032,708,2211,737"/><area shape="rect" id="node106" href="../../d9/de0/step__ch_8c.html#a91fe5c4370e3292a19e7f794797a407f" title="normal bounding of all primitives" alt="" coords="3260,175,3361,204"/><area shape="rect" id="node112" href="../../d9/de0/step__ch_8c.html#abdea68b778dc9253324da69d3c376965" title="bound any pstag type CALLS directly real and MPI boundary functions pstag is at FACE1,2,3 for fields, so user bound is different MPI bounding is the same as CENT quantities used when restarting in initbase.c to bound unewglobal for FLUXB==FLUXCTSTAG" alt="" coords="1828,123,1945,152"/><area shape="rect" id="node115" href="../../d9/de0/step__ch_8c.html#a6f4b963a50a7288964f01775f2f18bb9" title="normal bounding of staggered primitives" alt="" coords="2073,171,2169,200"/><area shape="rect" id="node118" href="../../d0/dde/fluxctstag_8c.html#aa169cb1999412f2e2460012cc5d7a804" title="pure DONOR version: upoint is input staggered updated field that needs to be converted to pstag and t..." alt="" coords="2268,158,2444,205"/><area shape="rect" id="node153" href="../../de/d51/bounds_8c.html#a16398a5325a9df48783423f00ba65bb7" title="all boundaries for RADCYLBEAMCART" alt="" coords="785,211,937,240"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad1313c275fb108d10f866373d9bb227a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int prad_labtoff </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>whichvel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>whichcoord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>ptrgeom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pradffortho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>like <a class="el" href="../../df/d21/global_8funcdeclare_8rad_8h.html#af50896d039d660550b738862b3390b07" title="radiative ortonormal ff primitives (E,F^i) &lt;-&gt; primitives in lab frame Used only for initial conditio...">prad_fforlab()</a> but for only whichdir=LAB2FF used for dumps or diags </p>

<p>Definition at line <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html#l11448">11448</a> of file <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html">phys.tools.rad.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d21/global_8funcdeclare_8rad_8h_ad1313c275fb108d10f866373d9bb227a_cgraph.png" border="0" usemap="#df/d21/global_8funcdeclare_8rad_8h_ad1313c275fb108d10f866373d9bb227a_cgraph" alt=""/></div>
<map name="df/d21/global_8funcdeclare_8rad_8h_ad1313c275fb108d10f866373d9bb227a_cgraph" id="df/d21/global_8funcdeclare_8rad_8h_ad1313c275fb108d10f866373d9bb227a_cgraph">
<area shape="rect" id="node3" href="../../d3/ddc/phys_8funcdeclare_8h.html#a11e17cd8b0594d1ad52e3594aa9f477e" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="204,85,279,115"/><area shape="rect" id="node11" href="../../df/d21/global_8funcdeclare_8rad_8h.html#aba8efc1e2ea7a31f67bb6c06ce3c164a" title="mhdfull_calc_rad" alt="" coords="181,164,301,193"/><area shape="rect" id="node15" href="../../d5/d0a/tetrad_8c.html#ae8d70957690f267632e5db4f4b06a490" title="Wrapper for vector_lab2orthofluidorback()" alt="" coords="145,217,337,247"/><area shape="rect" id="node58" href="../../d5/d0a/tetrad_8c.html#a6999a0ba04240d0dcbe3ae46adba0510" title="convert lab frame 4&#45;tensor to fluid frame orthonormal 4&#45;tensor" alt="" coords="151,271,332,300"/><area shape="rect" id="node5" href="../../d3/ddc/phys_8funcdeclare_8h.html#a12a473e24b431762af4168179e82cd08" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="405,5,568,35"/><area shape="rect" id="node7" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a8a762bf6582e6f7e1199de9c43b98454" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="388,59,585,88"/><area shape="rect" id="node9" href="../../d3/ddc/phys_8funcdeclare_8h.html#a41b8eacac0a4a23d6b00b670fe49629c" title="bsq_calc_fromq" alt="" coords="429,112,544,141"/><area shape="rect" id="node13" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a389bf7e41d2fd117af996e3392067cdc" title="compute radiation stres&#45;energy tensor assuming M1 closure" alt="" coords="436,165,537,195"/><area shape="rect" id="node17" href="../../d5/d0a/tetrad_8c.html#af9cffa9c2f215c3446c8dced2a326b42" title="convert 4&#45;vector to/from lab&#45;frame coordinate basis to fluid frame orthonormal basis" alt="" coords="396,219,577,248"/><area shape="rect" id="node19" href="../../d5/d0a/tetrad_8c.html#a69bb4f4bdcfeeddc2f94c291e3c4a887" title="use lab frame contravariant 4&#45;velocity (uconlab) and get transformation matrix for going to orthonorm..." alt="" coords="635,245,773,275"/><area shape="rect" id="node21" href="../../d5/d0a/tetrad_8c.html#a529e9fcba9169e956453fa28b0ec5b29" title="get stored or compute tetrcov and tetrcon primcoord: whether PRIMCOORDS type, so will use dxdxp to si..." alt="" coords="840,168,947,197"/><area shape="rect" id="node39" href="../../d6/d1b/metric_8tools_8c.html#af5438dd54272eb585ff5acb06d7195d4" title="matrix_inverse" alt="" coords="1537,245,1644,275"/><area shape="rect" id="node55" href="../../d5/d0a/tetrad_8c.html#aecffb2ef6ac562816636daf704607915" title="calculate boost assuming in orthonormal basis where g_{}={} = diag(&#45;1,0,0,0) NOTEMARK: Orthonormal do..." alt="" coords="823,297,964,327"/><area shape="rect" id="node23" href="../../d5/d0a/tetrad_8c.html#a1a0f6fda274fc7e16bdd8fcdfb4450ed" title="Notes:" alt="" coords="1013,168,1128,197"/><area shape="rect" id="node25" href="../../d9/de9/coord_8c.html#a0672d8c0ee4ff07c7265d0ecbc365cdc" title="normally&#45;used dxdxp[i,j,k] = dV/dX" alt="" coords="1201,88,1295,117"/><area shape="rect" id="node37" href="../../d9/de9/coord_8c.html#a8a51ec95e21441bc2c561af70a1037de" title="Get (dV/dX)^{&#45;1}." alt="" coords="1369,193,1447,223"/><area shape="rect" id="node41" href="../../d5/d0a/tetrad_8c.html#ad5d2935e2a3bac988149aa7b02c8feca" title="find suitable orthonormal tetrad wrapper for tetr_func()." alt="" coords="1177,141,1319,171"/><area shape="rect" id="node27" href="../../d9/de9/coord_8c.html#a64a4372100fc55abf546f02c8b779595" title="Jacobian for dx uniform per dx nonuniform (dx/dr / dx/dr&#39;) i.e." alt="" coords="1371,87,1445,116"/><area shape="rect" id="node29" href="../../d9/de9/coord_8c.html#a56c4b5c03b74a33a7d809daecfa6925e" title="numerical derivative of V w.r.t. X" alt="" coords="1531,87,1651,116"/><area shape="rect" id="node31" href="../../d9/de9/coord_8c.html#a65ad4ca9656d141cc995fd35ed31dc40" title="Returns boyer&#45;lindquist coordinte of point." alt="" coords="1793,87,1863,116"/><area shape="rect" id="node33" href="../../d8/d60/init_8c.html#a27c01fe4532cf3e10d467517403dbf70" title="blcoord_user" alt="" coords="1984,33,2080,63"/><area shape="rect" id="node35" href="../../d9/de9/coord_8c.html#af7a086e6042d598aea95c2360d07a99b" title="blcoord_singfixes" alt="" coords="1971,87,2093,116"/><area shape="rect" id="node44" href="../../d5/d0a/tetrad_8c.html#a0ca3db13e43c41bb7271db7bac10dc2a" title="input gcov and get out orthonormal tetrad in covariant and contravariant forms if metrictype..." alt="" coords="1372,140,1444,169"/><area shape="rect" id="node46" href="../../d5/d0a/tetrad_8c.html#a2ed15e40ab71ecd986b28510b0d8b8d4" title="compute_tetrcon_frommetric" alt="" coords="1497,192,1684,221"/><area shape="rect" id="node48" href="../../d5/d0a/tetrad_8c.html#a7daace7a466d45cd01436b89193102c0" title="pre&#45;setup tetrad use of lapack function" alt="" coords="1759,140,1897,169"/><area shape="rect" id="node52" href="../../d5/d0a/tetrad_8c.html#acc8b9e9ae9e03624e53b0a45e881a367" title="compute orthonormal tetrad [ortho]^[lab] for converting u_[lab] or u^[ortho] Notes: For full rotating..." alt="" coords="1735,193,1921,239"/><area shape="rect" id="node50" href="../../d4/dfc/tetlapack__func__doubleonly_8c.html#a6493f604b00b9a2337263d17b6230a02" title="native doubles for inside variables find tetrad" alt="" coords="1979,140,2085,169"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d21/global_8funcdeclare_8rad_8h_ad1313c275fb108d10f866373d9bb227a_icgraph.png" border="0" usemap="#df/d21/global_8funcdeclare_8rad_8h_ad1313c275fb108d10f866373d9bb227a_icgraph" alt=""/></div>
<map name="df/d21/global_8funcdeclare_8rad_8h_ad1313c275fb108d10f866373d9bb227a_icgraph" id="df/d21/global_8funcdeclare_8rad_8h_ad1313c275fb108d10f866373d9bb227a_icgraph">
<area shape="rect" id="node3" href="../../d2/d72/phys_8tools_8rad_8c.html#af50896d039d660550b738862b3390b07" title="radiative ortonormal ff primitives (E,F^i) &lt;&#45;&gt; primitives in lab frame Used only for initial conditio..." alt="" coords="144,320,235,349"/><area shape="rect" id="node5" href="../../d8/d60/init_8c.html#af94364e17d67cddfbb7bb3bf39c05ee6" title="init_dsandvels_koral" alt="" coords="288,132,427,161"/><area shape="rect" id="node17" href="../../d8/d60/init_8c.html#a448cd3fd9a1d862485e7b6e67b965172" title="process_restart_toget\l_radiation" alt="" coords="284,381,431,427"/><area shape="rect" id="node19" href="../../d2/d72/phys_8tools_8rad_8c.html#a64226cb28f52020ffe18ac6c6b1a2f5c" title="Input: start with pin [with fluid in whichvel velocity and whichcoordfluid coordinates (PRIMECOORDS o..." alt="" coords="292,311,423,358"/><area shape="rect" id="node7" href="../../df/d15/init_8tools_8c.html#acefd26944dbbb1c289886f520f6befac" title="init_dsandvels" alt="" coords="809,5,913,35"/><area shape="rect" id="node9" href="../../df/d15/init_8tools_8c.html#a77551ab2581efdbaf170dfca073ff9ab" title="user1_init_primitives" alt="" coords="3427,227,3568,256"/><area shape="rect" id="node11" href="../../de/db2/initbase_8funcdeclare_8h.html#a0afa200a5f947b1c9f6e554519f28fc4" title="init_primitives" alt="" coords="3617,279,3719,308"/><area shape="rect" id="node13" href="../../de/df8/initbase_8c.html#ac4110398e386c9888d9565630357dbbe" title="General&#45;Primary init() routine Uses globals inside init() because sets memory and sets physics..." alt="" coords="3796,331,3833,360"/><area shape="rect" id="node15" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="3909,387,3960,416"/><area shape="rect" id="node21" href="../../de/d51/bounds_8c.html#a3bc773d499b145705bdc23125b963840" title="Koral specific physical boundary conditions." alt="" coords="761,264,961,293"/><area shape="rect" id="node121" href="../../de/d51/bounds_8c.html#a09a080d9895db7b800a3824cb3fac9f1" title="X1 lower for beam injection to create shadow." alt="" coords="781,317,941,347"/><area shape="rect" id="node124" href="../../de/d51/bounds_8c.html#a3ee134cc5fb18752265c16a20dbdfb63" title="X3 lower for radiation beam injection." alt="" coords="764,371,959,400"/><area shape="rect" id="node127" href="../../de/d51/bounds_8c.html#a8300ddf3ae6a3866234cc0e9c12f26dc" title="X1 upper for inflow." alt="" coords="768,424,955,453"/><area shape="rect" id="node130" href="../../de/d51/bounds_8c.html#a01088f65c7a4cfa2ebfed202f815b951" title="X1 lower and upper for RADATM." alt="" coords="776,477,947,507"/><area shape="rect" id="node133" href="../../de/d51/bounds_8c.html#a1382959a7b699ea5d224168612504263" title="X1 upper for inflow." alt="" coords="523,524,669,553"/><area shape="rect" id="node136" href="../../de/d51/bounds_8c.html#ac15824bc610943cb7e02112e77b94752" title="on&#45;grid bounding" alt="" coords="547,577,645,607"/><area shape="rect" id="node139" href="../../de/d51/bounds_8c.html#a42658c4ecf3c6edb958394eb65a9ac2b" title="RADNT." alt="" coords="549,631,643,660"/><area shape="rect" id="node142" href="../../de/d51/bounds_8c.html#a3e4008fd24427b2e91d0ae5882b9536a" title="X1 upper for RADCYLBEAM." alt="" coords="513,57,679,87"/><area shape="rect" id="node145" href="../../de/d51/bounds_8c.html#ac32c1a20138382904dc5f1c66778ad8b" title="X1 upper for RADCYLJET." alt="" coords="523,111,669,140"/><area shape="rect" id="node148" href="../../de/d51/bounds_8c.html#a635fbaba3d6d6afcf5f34bbb2c278737" title="X2 upper for radiation beam injection." alt="" coords="481,164,711,193"/><area shape="rect" id="node151" href="../../de/d51/bounds_8c.html#a9f1df4e461f3f776bf3cb80e36a4d6df" title="get_radcylbeamcart" alt="" coords="528,217,664,247"/><area shape="rect" id="node23" href="../../de/d51/bounds_8c.html#a34ac3f1ca7b0f3a21053c633da9931a9" title="user boundary routine" alt="" coords="1011,344,1181,373"/><area shape="rect" id="node25" href="../../d4/dad/bounds_8funcdeclare_8h.html#a4bc7413b2cdb89e070f38bbb689ae555" title="bound_prim_user_dir" alt="" coords="1233,399,1375,428"/><area shape="rect" id="node110" href="../../d4/dad/bounds_8funcdeclare_8h.html#a2fbddc9ff8fc706bafa80c39695c7262" title="assume single user function takes care of primitive locations" alt="" coords="1229,248,1379,277"/><area shape="rect" id="node27" href="../../d9/de0/step__ch_8c.html#adbe0e3ba8a74f09ab928a96bd68cab6d" title="bound any prim type CALLS directly real and MPI boundary functions pstag = pstagglobal ucons = unewgl..." alt="" coords="1428,480,1537,509"/><area shape="rect" id="node29" href="../../d9/de0/step__ch_8c.html#a689fddc1949b1a1d390b59d10d17d83c" title="normal full bounding during evolution NOTEMARK: Was previously also bounding pstag here..." alt="" coords="1605,809,1731,839"/><area shape="rect" id="node41" href="../../d9/de0/step__ch_8c.html#a4079244d85c301885c1363ca41502869" title="simple bounding during evolution NOTEMARK: Was previously also bounding pstag here, but not necessary since done by calling bound_pstag in fluxctstag.c" alt="" coords="1587,863,1749,892"/><area shape="rect" id="node44" href="../../d9/de0/step__ch_8c.html#addca75a18cc861326a321565a2e81aa0" title="normal bounding of non&#45;staggered primitives" alt="" coords="1624,480,1712,509"/><area shape="rect" id="node104" href="../../d9/de0/step__ch_8c.html#a460b84e1112e3aef17209c20e22e1cf1" title="bound all prims" alt="" coords="2060,117,2183,147"/><area shape="rect" id="node31" href="../../d9/de0/step__ch_8c.html#ad36a0f9f915547477e3bb2405f8166b9" title="things to do after advance()" alt="" coords="1836,863,1937,892"/><area shape="rect" id="node33" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="3244,759,3377,788"/><area shape="rect" id="node35" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="3635,552,3701,581"/><area shape="rect" id="node37" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="3769,443,3860,472"/><area shape="rect" id="node46" href="../../dc/dae/flux_8c.html#aef355ccd1ca2295b84ad2fe1fc011d35" title="normal interpolation of CENT quantities to FACE quantities sets global variables pl_ct and pr_ct to p..." alt="" coords="1797,585,1976,615"/><area shape="rect" id="node63" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aecb3f613a7cb3bbb42fff2dbee5d65a1" title="This vpot2field function is for staggered method to evolve quasi&#45;deaveraged fields (i..." alt="" coords="2495,329,2660,359"/><area shape="rect" id="node65" href="../../de/db2/initbase_8funcdeclare_8h.html#ae6b2ad4cd0debf5b89ba8a9e471d6977" title="assumes normal field p pleft used as temp var if FLUXB==FLUXCTSTAG assigns conserved field in UEVOLVE..." alt="" coords="2711,316,2788,345"/><area shape="rect" id="node74" href="../../d0/dde/fluxctstag_8c.html#a4e3d76c6ad125b8199948408c262e3a1" title="wrapper for: 1) interpolate FACE 2 CORN 2) loop over dimensions setting field flux dimension&#45;by&#45;dimen..." alt="" coords="2291,683,2421,712"/><area shape="rect" id="node77" href="../../d0/dde/fluxctstag_8c.html#a2dd789bf1402bef72523cdb69e85806e" title="use global pbcorninterp and pvcorninterp at CORN1,2,3 to obtain EMFs at CORN1,2,3 NO interpolation of..." alt="" coords="1821,638,1952,685"/><area shape="rect" id="node80" href="../../d0/dde/fluxctstag_8c.html#aaec26a518629175ecceefbaf6c84225e" title="wrapper for continuous interpolation for FACE_to_CENT" alt="" coords="1800,532,1973,561"/><area shape="rect" id="node84" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aa31dd83c96936277334c62e2098dd51d" title="wrapper for taking staggered conserved field quantity and obtaining centered field quantity upoint en..." alt="" coords="2268,483,2444,512"/><area shape="rect" id="node93" href="../../d0/dde/fluxctstag_8c.html#a6cd90dff56319085b32bc57c0c8b3cfd" title="this function called in initbase.c and during advance() here ustag is point value if dimension doesn&#39;..." alt="" coords="2061,431,2181,460"/><area shape="rect" id="node96" href="../../d0/dde/fluxctstag_8c.html#ad6aa918442f7768dff3c099ba353ee64" title="slope_lim_face2corn() is provided p2interp and returns pleft/pright differs from slope_lim() by range..." alt="" coords="1816,708,1957,737"/><area shape="rect" id="node48" href="../../dc/dae/flux_8c.html#a2602a4dad9ed7adc944227d02435312e" title="standard (non&#45;field flux) calculation but setup to store results of interpolation so can be used for ..." alt="" coords="2024,604,2219,633"/><area shape="rect" id="node50" href="../../dc/dae/flux_8c.html#aaf6d832880760f80459d91477c28b519" title="wrapper for different standard 1&#45;D flux calculators 1&#45;D interpolate and get flux for that direction (..." alt="" coords="2299,604,2413,633"/><area shape="rect" id="node52" href="../../dc/dae/flux_8c.html#a8ffa7399bd5354fdcdec5f3e1adf0b13" title="wrapper for CENT_to_FACE1,2,3 used to compute flux at face" alt="" coords="2531,604,2624,633"/><area shape="rect" id="node54" href="../../d5/d2f/flux_8funcdeclare_8h.html#ab229b0f3f2caf3c0a3ef5299fba2b1c0" title="see fluxcompute.c for non&#45;computer science, real physics calculations of flux" alt="" coords="2716,604,2783,633"/><area shape="rect" id="node56" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="2860,604,2988,633"/><area shape="rect" id="node61" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="2847,521,3001,551"/><area shape="rect" id="node58" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="3092,656,3161,685"/><area shape="rect" id="node67" href="../../df/d15/init_8tools_8c.html#a3750bc790613bc6c8c805af0f1b839c8" title="user1_init_vpot2field_user" alt="" coords="2837,316,3011,345"/><area shape="rect" id="node69" href="../../de/db2/initbase_8funcdeclare_8h.html#afda44281ad5c163455c40f012d4a8954" title="init_vpot2field_user" alt="" coords="3060,316,3193,345"/><area shape="rect" id="node71" href="../../de/db2/initbase_8funcdeclare_8h.html#a90699a18ede8b7f112c0078512804ec1" title="initialize vector potential given user function assumes normal non&#45;staggered field in pr Notice that ..." alt="" coords="3276,304,3345,333"/><area shape="rect" id="node82" href="../../d0/dde/fluxctstag_8c.html#a5e3dcbe89d6f8a9384cafb58afd7dbf4" title="interpolates field at FACE to field at CENT assuming field along itself is continuous" alt="" coords="2061,534,2181,581"/><area shape="rect" id="node88" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aaa24493002bc8c0a527b1ea2ac2dddbf" title="convert conservative U to stag point P and CENT point U and CENT point primitive" alt="" coords="2511,433,2644,463"/><area shape="rect" id="node98" href="../../d0/dde/fluxctstag_8c.html#a985ee116306b4011810334ae93900493" title="INPUTS: Nvec, pr, primface_l[dir], primface_r[dir] OUTPUTS: pbcorn[dir][side], pvcorn[dir][side][side..." alt="" coords="2032,708,2211,737"/><area shape="rect" id="node106" href="../../d9/de0/step__ch_8c.html#a91fe5c4370e3292a19e7f794797a407f" title="normal bounding of all primitives" alt="" coords="3260,175,3361,204"/><area shape="rect" id="node112" href="../../d9/de0/step__ch_8c.html#abdea68b778dc9253324da69d3c376965" title="bound any pstag type CALLS directly real and MPI boundary functions pstag is at FACE1,2,3 for fields, so user bound is different MPI bounding is the same as CENT quantities used when restarting in initbase.c to bound unewglobal for FLUXB==FLUXCTSTAG" alt="" coords="1828,123,1945,152"/><area shape="rect" id="node115" href="../../d9/de0/step__ch_8c.html#a6f4b963a50a7288964f01775f2f18bb9" title="normal bounding of staggered primitives" alt="" coords="2073,171,2169,200"/><area shape="rect" id="node118" href="../../d0/dde/fluxctstag_8c.html#aa169cb1999412f2e2460012cc5d7a804" title="pure DONOR version: upoint is input staggered updated field that needs to be converted to pstag and t..." alt="" coords="2268,158,2444,205"/><area shape="rect" id="node153" href="../../de/d51/bounds_8c.html#a16398a5325a9df48783423f00ba65bb7" title="all boundaries for RADCYLBEAMCART" alt="" coords="785,211,937,240"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa25aa4dfb3559619f276abca5f4b3ca0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int primefluid_EVrad_to_primeall </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>whichvel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>whichcoord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>ptrgeom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>for BCs, to take E[radiation frame] and u^i as radiation primitives in whichvel/whichcoord obtains WHICHVEL/PRIMECOORD primitives </p>

<p>Definition at line <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html#l11684">11684</a> of file <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html">phys.tools.rad.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d21/global_8funcdeclare_8rad_8h_aa25aa4dfb3559619f276abca5f4b3ca0_cgraph.png" border="0" usemap="#df/d21/global_8funcdeclare_8rad_8h_aa25aa4dfb3559619f276abca5f4b3ca0_cgraph" alt=""/></div>
<map name="df/d21/global_8funcdeclare_8rad_8h_aa25aa4dfb3559619f276abca5f4b3ca0_cgraph" id="df/d21/global_8funcdeclare_8rad_8h_aa25aa4dfb3559619f276abca5f4b3ca0_cgraph">
<area shape="rect" id="node3" href="../../d3/ddc/phys_8funcdeclare_8h.html#a35c4399eb86e3fa77e2221000e077572" title="ucon_calc_whichvel" alt="" coords="192,85,331,115"/><area shape="rect" id="node19" href="../../d3/d09/transforms_8c.html#a0c5044bf89287cf41d59999d96f9fc12" title="MCOORD &#45;&gt; prime MCOORD." alt="" coords="197,152,325,181"/><area shape="rect" id="node5" href="../../d3/ddc/phys_8funcdeclare_8h.html#ad141359a7901a82a0c26241b432183c3" title="find contravariant time component of four&#45;velocity from the 4velocity (3 terms)" alt="" coords="387,5,499,35"/><area shape="rect" id="node9" href="../../d3/ddc/phys_8funcdeclare_8h.html#afc1e1232a2f457b71cfd9210f2b5240a" title="find contravariant four&#45;velocity int ucon_calc(FTYPE *pr, struct of_geom *geom, FTYPE *ucon..." alt="" coords="387,59,499,88"/><area shape="rect" id="node11" href="../../d3/ddc/phys_8funcdeclare_8h.html#a7aadb359813194586356c2c325322a45" title="find contravariant four&#45;velocity from the relative 4 velocity" alt="" coords="380,112,505,141"/><area shape="rect" id="node7" href="../../d9/de9/coord_8c.html#a041e7b005310415c97d90f4b8521ed1a" title="get X(i,j,k) CENT is default position in degenerate cases" alt="" coords="629,5,683,35"/><area shape="rect" id="node13" href="../../d3/ddc/phys_8funcdeclare_8h.html#a5910aabe5e76183d341ef5b830b01bab" title="find {u}^ from u^ only fill spatial parts so can feed in 3&#45;vector" alt="" coords="624,59,688,88"/><area shape="rect" id="node15" href="../../d3/ddc/phys_8funcdeclare_8h.html#a20be479a3f03f3de780359d6e9290fe3" title="find u^ from {u}^ fill full 4&#45;vector OPTMARK: Before storing , this was the most expensive function o..." alt="" coords="556,112,756,141"/><area shape="rect" id="node17" href="../../d3/ddc/phys_8funcdeclare_8h.html#abfae38e47b0bd05a4fc38302ff948a96" title="find gamma&#45;factor wrt normal observer This function and qsq_calc() have about the same cache miss amo..." alt="" coords="805,112,976,141"/><area shape="rect" id="node21" href="../../d9/de9/coord_8c.html#a6b81e8ff9e3ef5fdf6eade928726f237" title="normally&#45;used dxdxp[i,j,k]" alt="" coords="393,165,492,195"/><area shape="rect" id="node23" href="../../d9/de9/coord_8c.html#a64a4372100fc55abf546f02c8b779595" title="Jacobian for dx uniform per dx nonuniform (dx/dr / dx/dr&#39;) i.e." alt="" coords="619,165,693,195"/><area shape="rect" id="node33" href="../../d9/de9/coord_8c.html#a8a51ec95e21441bc2c561af70a1037de" title="Get (dV/dX)^{&#45;1}." alt="" coords="617,219,695,248"/><area shape="rect" id="node25" href="../../d9/de9/coord_8c.html#a56c4b5c03b74a33a7d809daecfa6925e" title="numerical derivative of V w.r.t. X" alt="" coords="831,165,951,195"/><area shape="rect" id="node27" href="../../d9/de9/coord_8c.html#a65ad4ca9656d141cc995fd35ed31dc40" title="Returns boyer&#45;lindquist coordinte of point." alt="" coords="1025,165,1095,195"/><area shape="rect" id="node29" href="../../d8/d60/init_8c.html#a27c01fe4532cf3e10d467517403dbf70" title="blcoord_user" alt="" coords="1157,139,1253,168"/><area shape="rect" id="node31" href="../../d9/de9/coord_8c.html#af7a086e6042d598aea95c2360d07a99b" title="blcoord_singfixes" alt="" coords="1144,192,1267,221"/><area shape="rect" id="node35" href="../../d6/d1b/metric_8tools_8c.html#af5438dd54272eb585ff5acb06d7195d4" title="matrix_inverse" alt="" coords="837,219,944,248"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d21/global_8funcdeclare_8rad_8h_aa25aa4dfb3559619f276abca5f4b3ca0_icgraph.png" border="0" usemap="#df/d21/global_8funcdeclare_8rad_8h_aa25aa4dfb3559619f276abca5f4b3ca0_icgraph" alt=""/></div>
<map name="df/d21/global_8funcdeclare_8rad_8h_aa25aa4dfb3559619f276abca5f4b3ca0_icgraph" id="df/d21/global_8funcdeclare_8rad_8h_aa25aa4dfb3559619f276abca5f4b3ca0_icgraph">
<area shape="rect" id="node3" href="../../de/d51/bounds_8c.html#a3bc773d499b145705bdc23125b963840" title="Koral specific physical boundary conditions." alt="" coords="208,368,408,397"/><area shape="rect" id="node110" href="../../de/d51/bounds_8c.html#a09a080d9895db7b800a3824cb3fac9f1" title="X1 lower for beam injection to create shadow." alt="" coords="228,421,388,451"/><area shape="rect" id="node113" href="../../de/d51/bounds_8c.html#a3ee134cc5fb18752265c16a20dbdfb63" title="X3 lower for radiation beam injection." alt="" coords="211,475,405,504"/><area shape="rect" id="node116" href="../../de/d51/bounds_8c.html#a3a96629ab9e350154c992f8a4ce92cbe" title="X1 lower and upper X2." alt="" coords="239,528,377,557"/><area shape="rect" id="node119" href="../../de/d51/bounds_8c.html#a635fbaba3d6d6afcf5f34bbb2c278737" title="X2 upper for radiation beam injection." alt="" coords="193,581,423,611"/><area shape="rect" id="node5" href="../../de/d51/bounds_8c.html#a34ac3f1ca7b0f3a21053c633da9931a9" title="user boundary routine" alt="" coords="472,475,643,504"/><area shape="rect" id="node7" href="../../d4/dad/bounds_8funcdeclare_8h.html#a4bc7413b2cdb89e070f38bbb689ae555" title="bound_prim_user_dir" alt="" coords="695,419,836,448"/><area shape="rect" id="node99" href="../../d4/dad/bounds_8funcdeclare_8h.html#a2fbddc9ff8fc706bafa80c39695c7262" title="assume single user function takes care of primitive locations" alt="" coords="691,661,840,691"/><area shape="rect" id="node9" href="../../d9/de0/step__ch_8c.html#adbe0e3ba8a74f09ab928a96bd68cab6d" title="bound any prim type CALLS directly real and MPI boundary functions pstag = pstagglobal ucons = unewgl..." alt="" coords="889,372,999,401"/><area shape="rect" id="node11" href="../../d9/de0/step__ch_8c.html#a689fddc1949b1a1d390b59d10d17d83c" title="normal full bounding during evolution NOTEMARK: Was previously also bounding pstag here..." alt="" coords="1067,43,1192,72"/><area shape="rect" id="node24" href="../../d9/de0/step__ch_8c.html#a4079244d85c301885c1363ca41502869" title="simple bounding during evolution NOTEMARK: Was previously also bounding pstag here, but not necessary since done by calling bound_pstag in fluxctstag.c" alt="" coords="1048,207,1211,236"/><area shape="rect" id="node27" href="../../d9/de0/step__ch_8c.html#addca75a18cc861326a321565a2e81aa0" title="normal bounding of non&#45;staggered primitives" alt="" coords="1085,372,1173,401"/><area shape="rect" id="node93" href="../../d9/de0/step__ch_8c.html#a460b84e1112e3aef17209c20e22e1cf1" title="bound all prims" alt="" coords="1521,757,1644,787"/><area shape="rect" id="node13" href="../../d9/de0/step__ch_8c.html#ad36a0f9f915547477e3bb2405f8166b9" title="things to do after advance()" alt="" coords="1297,43,1399,72"/><area shape="rect" id="node15" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="2705,104,2839,133"/><area shape="rect" id="node17" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="2925,247,2992,276"/><area shape="rect" id="node19" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="3231,340,3321,369"/><area shape="rect" id="node21" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="3371,423,3421,452"/><area shape="rect" id="node29" href="../../dc/dae/flux_8c.html#aef355ccd1ca2295b84ad2fe1fc011d35" title="normal interpolation of CENT quantities to FACE quantities sets global variables pl_ct and pr_ct to p..." alt="" coords="1259,269,1437,299"/><area shape="rect" id="node46" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aecb3f613a7cb3bbb42fff2dbee5d65a1" title="This vpot2field function is for staggered method to evolve quasi&#45;deaveraged fields (i..." alt="" coords="1956,647,2121,676"/><area shape="rect" id="node48" href="../../de/db2/initbase_8funcdeclare_8h.html#ae6b2ad4cd0debf5b89ba8a9e471d6977" title="assumes normal field p pleft used as temp var if FLUXB==FLUXCTSTAG assigns conserved field in UEVOLVE..." alt="" coords="2172,596,2249,625"/><area shape="rect" id="node56" href="../../df/d15/init_8tools_8c.html#a77551ab2581efdbaf170dfca073ff9ab" title="user1_init_primitives" alt="" coords="2888,583,3029,612"/><area shape="rect" id="node60" href="../../de/df8/initbase_8c.html#ac4110398e386c9888d9565630357dbbe" title="General&#45;Primary init() routine Uses globals inside init() because sets memory and sets physics..." alt="" coords="3257,505,3295,535"/><area shape="rect" id="node63" href="../../d0/dde/fluxctstag_8c.html#a4e3d76c6ad125b8199948408c262e3a1" title="wrapper for: 1) interpolate FACE 2 CORN 2) loop over dimensions setting field flux dimension&#45;by&#45;dimen..." alt="" coords="1752,189,1883,219"/><area shape="rect" id="node66" href="../../d0/dde/fluxctstag_8c.html#a2dd789bf1402bef72523cdb69e85806e" title="use global pbcorninterp and pvcorninterp at CORN1,2,3 to obtain EMFs at CORN1,2,3 NO interpolation of..." alt="" coords="1283,95,1413,142"/><area shape="rect" id="node69" href="../../d0/dde/fluxctstag_8c.html#aaec26a518629175ecceefbaf6c84225e" title="wrapper for continuous interpolation for FACE_to_CENT" alt="" coords="1261,428,1435,457"/><area shape="rect" id="node73" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aa31dd83c96936277334c62e2098dd51d" title="wrapper for taking staggered conserved field quantity and obtaining centered field quantity upoint en..." alt="" coords="1729,372,1905,401"/><area shape="rect" id="node82" href="../../d0/dde/fluxctstag_8c.html#a6cd90dff56319085b32bc57c0c8b3cfd" title="this function called in initbase.c and during advance() here ustag is point value if dimension doesn&#39;..." alt="" coords="1523,372,1643,401"/><area shape="rect" id="node85" href="../../d0/dde/fluxctstag_8c.html#ad6aa918442f7768dff3c099ba353ee64" title="slope_lim_face2corn() is provided p2interp and returns pleft/pright differs from slope_lim() by range..." alt="" coords="1277,165,1419,195"/><area shape="rect" id="node31" href="../../dc/dae/flux_8c.html#a2602a4dad9ed7adc944227d02435312e" title="standard (non&#45;field flux) calculation but setup to store results of interpolation so can be used for ..." alt="" coords="1485,268,1680,297"/><area shape="rect" id="node33" href="../../dc/dae/flux_8c.html#aaf6d832880760f80459d91477c28b519" title="wrapper for different standard 1&#45;D flux calculators 1&#45;D interpolate and get flux for that direction (..." alt="" coords="1760,268,1875,297"/><area shape="rect" id="node35" href="../../dc/dae/flux_8c.html#a8ffa7399bd5354fdcdec5f3e1adf0b13" title="wrapper for CENT_to_FACE1,2,3 used to compute flux at face" alt="" coords="1992,268,2085,297"/><area shape="rect" id="node37" href="../../d5/d2f/flux_8funcdeclare_8h.html#ab229b0f3f2caf3c0a3ef5299fba2b1c0" title="see fluxcompute.c for non&#45;computer science, real physics calculations of flux" alt="" coords="2177,268,2244,297"/><area shape="rect" id="node39" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="2321,268,2449,297"/><area shape="rect" id="node44" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="2308,345,2463,375"/><area shape="rect" id="node41" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="2553,213,2623,243"/><area shape="rect" id="node50" href="../../df/d15/init_8tools_8c.html#a3750bc790613bc6c8c805af0f1b839c8" title="user1_init_vpot2field_user" alt="" coords="2299,596,2472,625"/><area shape="rect" id="node52" href="../../de/db2/initbase_8funcdeclare_8h.html#afda44281ad5c163455c40f012d4a8954" title="init_vpot2field_user" alt="" coords="2521,596,2655,625"/><area shape="rect" id="node54" href="../../de/db2/initbase_8funcdeclare_8h.html#a90699a18ede8b7f112c0078512804ec1" title="initialize vector potential given user function assumes normal non&#45;staggered field in pr Notice that ..." alt="" coords="2737,596,2807,625"/><area shape="rect" id="node58" href="../../de/db2/initbase_8funcdeclare_8h.html#a0afa200a5f947b1c9f6e554519f28fc4" title="init_primitives" alt="" coords="3079,557,3180,587"/><area shape="rect" id="node71" href="../../d0/dde/fluxctstag_8c.html#a5e3dcbe89d6f8a9384cafb58afd7dbf4" title="interpolates field at FACE to field at CENT assuming field along itself is continuous" alt="" coords="1523,425,1643,471"/><area shape="rect" id="node77" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aaa24493002bc8c0a527b1ea2ac2dddbf" title="convert conservative U to stag point P and CENT point U and CENT point primitive" alt="" coords="1972,492,2105,521"/><area shape="rect" id="node87" href="../../d0/dde/fluxctstag_8c.html#a985ee116306b4011810334ae93900493" title="INPUTS: Nvec, pr, primface_l[dir], primface_r[dir] OUTPUTS: pbcorn[dir][side], pvcorn[dir][side][side..." alt="" coords="1493,164,1672,193"/><area shape="rect" id="node95" href="../../d9/de0/step__ch_8c.html#a91fe5c4370e3292a19e7f794797a407f" title="normal bounding of all primitives" alt="" coords="2721,649,2823,679"/><area shape="rect" id="node101" href="../../d9/de0/step__ch_8c.html#abdea68b778dc9253324da69d3c376965" title="bound any pstag type CALLS directly real and MPI boundary functions pstag is at FACE1,2,3 for fields, so user bound is different MPI bounding is the same as CENT quantities used when restarting in initbase.c to bound unewglobal for FLUXB==FLUXCTSTAG" alt="" coords="1289,756,1407,785"/><area shape="rect" id="node104" href="../../d9/de0/step__ch_8c.html#a6f4b963a50a7288964f01775f2f18bb9" title="normal bounding of staggered primitives" alt="" coords="1535,704,1631,733"/><area shape="rect" id="node107" href="../../d0/dde/fluxctstag_8c.html#aa169cb1999412f2e2460012cc5d7a804" title="pure DONOR version: upoint is input staggered updated field that needs to be converted to pstag and t..." alt="" coords="1729,697,1905,743"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa8edd5fc0afc1713ad401c2db92c71e0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int set_ncon_velocity </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>whichvel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td>
          <td class="paramname"><em>gammamax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>ncon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>ptrgeom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>uconwhichvel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>set velocity based upon ncon and gammamax and return in whichvel format for the ptrgeom geometry/coords </p>

<p>Definition at line <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html#l14217">14217</a> of file <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html">phys.tools.rad.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d21/global_8funcdeclare_8rad_8h_aa8edd5fc0afc1713ad401c2db92c71e0_cgraph.png" border="0" usemap="#df/d21/global_8funcdeclare_8rad_8h_aa8edd5fc0afc1713ad401c2db92c71e0_cgraph" alt=""/></div>
<map name="df/d21/global_8funcdeclare_8rad_8h_aa8edd5fc0afc1713ad401c2db92c71e0_cgraph" id="df/d21/global_8funcdeclare_8rad_8h_aa8edd5fc0afc1713ad401c2db92c71e0_cgraph">
<area shape="rect" id="node3" href="../../d3/ddc/phys_8funcdeclare_8h.html#abfae38e47b0bd05a4fc38302ff948a96" title="find gamma&#45;factor wrt normal observer This function and qsq_calc() have about the same cache miss amo..." alt="" coords="795,71,965,101"/><area shape="rect" id="node5" href="../../d3/ddc/phys_8funcdeclare_8h.html#a35c4399eb86e3fa77e2221000e077572" title="ucon_calc_whichvel" alt="" coords="181,70,320,99"/><area shape="rect" id="node7" href="../../d3/ddc/phys_8funcdeclare_8h.html#ad141359a7901a82a0c26241b432183c3" title="find contravariant time component of four&#45;velocity from the 4velocity (3 terms)" alt="" coords="376,43,488,73"/><area shape="rect" id="node11" href="../../d3/ddc/phys_8funcdeclare_8h.html#afc1e1232a2f457b71cfd9210f2b5240a" title="find contravariant four&#45;velocity int ucon_calc(FTYPE *pr, struct of_geom *geom, FTYPE *ucon..." alt="" coords="376,97,488,126"/><area shape="rect" id="node13" href="../../d3/ddc/phys_8funcdeclare_8h.html#a7aadb359813194586356c2c325322a45" title="find contravariant four&#45;velocity from the relative 4 velocity" alt="" coords="369,150,495,179"/><area shape="rect" id="node9" href="../../d9/de9/coord_8c.html#a041e7b005310415c97d90f4b8521ed1a" title="get X(i,j,k) CENT is default position in degenerate cases" alt="" coords="619,43,672,73"/><area shape="rect" id="node15" href="../../d3/ddc/phys_8funcdeclare_8h.html#a5910aabe5e76183d341ef5b830b01bab" title="find {u}^ from u^ only fill spatial parts so can feed in 3&#45;vector" alt="" coords="613,97,677,126"/><area shape="rect" id="node17" href="../../d3/ddc/phys_8funcdeclare_8h.html#a20be479a3f03f3de780359d6e9290fe3" title="find u^ from {u}^ fill full 4&#45;vector OPTMARK: Before storing , this was the most expensive function o..." alt="" coords="545,150,745,179"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9fe58e7f372421d18633c8fc5007b815"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int u2p_rad </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>showmessages</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>allowlocalfailurefixandnoreport</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a>&#160;</td>
          <td class="paramname"><em>gammamaxrad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>whichcap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>uu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>ptrgeom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/de6/global_8depmnemonics_8h.html#a9377001671b5ece8bb2a2cf636de4b8a">PFTYPE</a> *&#160;</td>
          <td class="paramname"><em>lpflag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/de6/global_8depmnemonics_8h.html#a9377001671b5ece8bb2a2cf636de4b8a">PFTYPE</a> *&#160;</td>
          <td class="paramname"><em>lpflagrad</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html#l11984">11984</a> of file <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html">phys.tools.rad.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d21/global_8funcdeclare_8rad_8h_a9fe58e7f372421d18633c8fc5007b815_cgraph.png" border="0" usemap="#df/d21/global_8funcdeclare_8rad_8h_a9fe58e7f372421d18633c8fc5007b815_cgraph" alt=""/></div>
<map name="df/d21/global_8funcdeclare_8rad_8h_a9fe58e7f372421d18633c8fc5007b815_cgraph" id="df/d21/global_8funcdeclare_8rad_8h_a9fe58e7f372421d18633c8fc5007b815_cgraph">
<area shape="rect" id="node3" href="../../d2/d72/phys_8tools_8rad_8c.html#a67b370af2fa58283bc590ff4e895fb90" title="Like u2p_rad_orig(), but uses Jon&#39;s paper draft ZAMO RAD version." alt="" coords="123,59,221,88"/><area shape="rect" id="node5" href="../../d2/d72/phys_8tools_8rad_8c.html#a77c546a7fb064266fef5a9e796dc63dc" title="compute ZAMO version of radiation quantities as in paper draft" alt="" coords="281,5,428,35"/><area shape="rect" id="node7" href="../../d3/ddc/phys_8funcdeclare_8h.html#abfae38e47b0bd05a4fc38302ff948a96" title="find gamma&#45;factor wrt normal observer This function and qsq_calc() have about the same cache miss amo..." alt="" coords="269,59,440,88"/><area shape="rect" id="node9" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a3e47afcfc5c42719999d851395fd032d" title="nrad(E)" alt="" coords="291,112,419,141"/><area shape="rect" id="node11" href="../../df/d21/global_8funcdeclare_8rad_8h.html#af07558357c906b4dfa61cd34656d9f02" title="E=urad=arad T^4 and just solve for T (this is LTE only if assume resulting T is gas T)..." alt="" coords="489,85,615,115"/><area shape="rect" id="node13" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a7dc2e853cec9b6f9a5e83ce23c468d03" title="nrad(T) = nrad=arad T^3/2.70118 (this is LTE only if put in T was gas T)" alt="" coords="488,139,616,168"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d21/global_8funcdeclare_8rad_8h_a9fe58e7f372421d18633c8fc5007b815_icgraph.png" border="0" usemap="#df/d21/global_8funcdeclare_8rad_8h_a9fe58e7f372421d18633c8fc5007b815_icgraph" alt=""/></div>
<map name="df/d21/global_8funcdeclare_8rad_8h_a9fe58e7f372421d18633c8fc5007b815_icgraph" id="df/d21/global_8funcdeclare_8rad_8h_a9fe58e7f372421d18633c8fc5007b815_icgraph">
<area shape="rect" id="node3" href="../../d2/d72/phys_8tools_8rad_8c.html#a2ec6ee79c76351868a725b22dac62135" title="like prad_fforlab() but for only whichdir=FF2LAB used for IC" alt="" coords="137,341,228,371"/><area shape="rect" id="node158" href="../../d1/d3e/utoprimgen_8c.html#a0a83e9e7fdd3cc595c5b8d0df88ec684" title="just picks the algorithm to invert" alt="" coords="123,216,243,245"/><area shape="rect" id="node5" href="../../d2/d72/phys_8tools_8rad_8c.html#af50896d039d660550b738862b3390b07" title="radiative ortonormal ff primitives (E,F^i) &lt;&#45;&gt; primitives in lab frame Used only for initial conditio..." alt="" coords="291,484,381,513"/><area shape="rect" id="node7" href="../../d8/d60/init_8c.html#af94364e17d67cddfbb7bb3bf39c05ee6" title="init_dsandvels_koral" alt="" coords="939,792,1077,821"/><area shape="rect" id="node19" href="../../d8/d60/init_8c.html#a448cd3fd9a1d862485e7b6e67b965172" title="process_restart_toget\l_radiation" alt="" coords="431,510,577,557"/><area shape="rect" id="node21" href="../../d2/d72/phys_8tools_8rad_8c.html#a64226cb28f52020ffe18ac6c6b1a2f5c" title="Input: start with pin [with fluid in whichvel velocity and whichcoordfluid coordinates (PRIMECOORDS o..." alt="" coords="439,441,569,487"/><area shape="rect" id="node9" href="../../df/d15/init_8tools_8c.html#acefd26944dbbb1c289886f520f6befac" title="init_dsandvels" alt="" coords="3232,696,3336,725"/><area shape="rect" id="node11" href="../../df/d15/init_8tools_8c.html#a77551ab2581efdbaf170dfca073ff9ab" title="user1_init_primitives" alt="" coords="3584,728,3725,757"/><area shape="rect" id="node13" href="../../de/db2/initbase_8funcdeclare_8h.html#a0afa200a5f947b1c9f6e554519f28fc4" title="init_primitives" alt="" coords="3775,687,3876,716"/><area shape="rect" id="node15" href="../../de/df8/initbase_8c.html#ac4110398e386c9888d9565630357dbbe" title="General&#45;Primary init() routine Uses globals inside init() because sets memory and sets physics..." alt="" coords="3953,603,3991,632"/><area shape="rect" id="node17" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="4067,493,4117,523"/><area shape="rect" id="node23" href="../../de/d51/bounds_8c.html#a3bc773d499b145705bdc23125b963840" title="Koral specific physical boundary conditions." alt="" coords="908,319,1108,348"/><area shape="rect" id="node123" href="../../de/d51/bounds_8c.html#a09a080d9895db7b800a3824cb3fac9f1" title="X1 lower for beam injection to create shadow." alt="" coords="928,372,1088,401"/><area shape="rect" id="node126" href="../../de/d51/bounds_8c.html#a3ee134cc5fb18752265c16a20dbdfb63" title="X3 lower for radiation beam injection." alt="" coords="911,425,1105,455"/><area shape="rect" id="node129" href="../../de/d51/bounds_8c.html#a8300ddf3ae6a3866234cc0e9c12f26dc" title="X1 upper for inflow." alt="" coords="915,479,1101,508"/><area shape="rect" id="node132" href="../../de/d51/bounds_8c.html#a01088f65c7a4cfa2ebfed202f815b951" title="X1 lower and upper for RADATM." alt="" coords="923,532,1093,561"/><area shape="rect" id="node135" href="../../de/d51/bounds_8c.html#a1382959a7b699ea5d224168612504263" title="X1 upper for inflow." alt="" coords="669,577,816,607"/><area shape="rect" id="node138" href="../../de/d51/bounds_8c.html#ac15824bc610943cb7e02112e77b94752" title="on&#45;grid bounding" alt="" coords="693,631,792,660"/><area shape="rect" id="node141" href="../../de/d51/bounds_8c.html#a42658c4ecf3c6edb958394eb65a9ac2b" title="RADNT." alt="" coords="696,684,789,713"/><area shape="rect" id="node144" href="../../de/d51/bounds_8c.html#a3e4008fd24427b2e91d0ae5882b9536a" title="X1 upper for RADCYLBEAM." alt="" coords="660,737,825,767"/><area shape="rect" id="node147" href="../../de/d51/bounds_8c.html#ac32c1a20138382904dc5f1c66778ad8b" title="X1 upper for RADCYLJET." alt="" coords="669,164,816,193"/><area shape="rect" id="node150" href="../../de/d51/bounds_8c.html#a635fbaba3d6d6afcf5f34bbb2c278737" title="X2 upper for radiation beam injection." alt="" coords="628,217,857,247"/><area shape="rect" id="node153" href="../../de/d51/bounds_8c.html#a9f1df4e461f3f776bf3cb80e36a4d6df" title="get_radcylbeamcart" alt="" coords="675,271,811,300"/><area shape="rect" id="node25" href="../../de/d51/bounds_8c.html#a34ac3f1ca7b0f3a21053c633da9931a9" title="user boundary routine" alt="" coords="1157,473,1328,503"/><area shape="rect" id="node27" href="../../d4/dad/bounds_8funcdeclare_8h.html#a4bc7413b2cdb89e070f38bbb689ae555" title="bound_prim_user_dir" alt="" coords="1380,463,1521,492"/><area shape="rect" id="node112" href="../../d4/dad/bounds_8funcdeclare_8h.html#a2fbddc9ff8fc706bafa80c39695c7262" title="assume single user function takes care of primitive locations" alt="" coords="1376,629,1525,659"/><area shape="rect" id="node29" href="../../d9/de0/step__ch_8c.html#adbe0e3ba8a74f09ab928a96bd68cab6d" title="bound any prim type CALLS directly real and MPI boundary functions pstag = pstagglobal ucons = unewgl..." alt="" coords="1575,440,1684,469"/><area shape="rect" id="node31" href="../../d9/de0/step__ch_8c.html#a689fddc1949b1a1d390b59d10d17d83c" title="normal full bounding during evolution NOTEMARK: Was previously also bounding pstag here..." alt="" coords="1752,59,1877,88"/><area shape="rect" id="node43" href="../../d9/de0/step__ch_8c.html#a4079244d85c301885c1363ca41502869" title="simple bounding during evolution NOTEMARK: Was previously also bounding pstag here, but not necessary since done by calling bound_pstag in fluxctstag.c" alt="" coords="1733,5,1896,35"/><area shape="rect" id="node46" href="../../d9/de0/step__ch_8c.html#addca75a18cc861326a321565a2e81aa0" title="normal bounding of non&#45;staggered primitives" alt="" coords="1771,440,1859,469"/><area shape="rect" id="node106" href="../../d9/de0/step__ch_8c.html#a460b84e1112e3aef17209c20e22e1cf1" title="bound all prims" alt="" coords="2207,856,2329,885"/><area shape="rect" id="node33" href="../../d9/de0/step__ch_8c.html#ad36a0f9f915547477e3bb2405f8166b9" title="things to do after advance()" alt="" coords="1983,7,2084,36"/><area shape="rect" id="node35" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="3401,131,3535,160"/><area shape="rect" id="node37" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="3792,361,3859,391"/><area shape="rect" id="node39" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="3927,383,4017,412"/><area shape="rect" id="node48" href="../../dc/dae/flux_8c.html#aef355ccd1ca2295b84ad2fe1fc011d35" title="normal interpolation of CENT quantities to FACE quantities sets global variables pl_ct and pr_ct to p..." alt="" coords="1944,161,2123,191"/><area shape="rect" id="node65" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aecb3f613a7cb3bbb42fff2dbee5d65a1" title="This vpot2field function is for staggered method to evolve quasi&#45;deaveraged fields (i..." alt="" coords="2641,644,2807,673"/><area shape="rect" id="node67" href="../../de/db2/initbase_8funcdeclare_8h.html#ae6b2ad4cd0debf5b89ba8a9e471d6977" title="assumes normal field p pleft used as temp var if FLUXB==FLUXCTSTAG assigns conserved field in UEVOLVE..." alt="" coords="2863,619,2940,648"/><area shape="rect" id="node76" href="../../d0/dde/fluxctstag_8c.html#a4e3d76c6ad125b8199948408c262e3a1" title="wrapper for: 1) interpolate FACE 2 CORN 2) loop over dimensions setting field flux dimension&#45;by&#45;dimen..." alt="" coords="2437,267,2568,296"/><area shape="rect" id="node79" href="../../d0/dde/fluxctstag_8c.html#a2dd789bf1402bef72523cdb69e85806e" title="use global pbcorninterp and pvcorninterp at CORN1,2,3 to obtain EMFs at CORN1,2,3 NO interpolation of..." alt="" coords="1968,318,2099,365"/><area shape="rect" id="node82" href="../../d0/dde/fluxctstag_8c.html#aaec26a518629175ecceefbaf6c84225e" title="wrapper for continuous interpolation for FACE_to_CENT" alt="" coords="1947,388,2120,417"/><area shape="rect" id="node86" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aa31dd83c96936277334c62e2098dd51d" title="wrapper for taking staggered conserved field quantity and obtaining centered field quantity upoint en..." alt="" coords="2415,437,2591,467"/><area shape="rect" id="node95" href="../../d0/dde/fluxctstag_8c.html#a6cd90dff56319085b32bc57c0c8b3cfd" title="this function called in initbase.c and during advance() here ustag is point value if dimension doesn&#39;..." alt="" coords="2208,489,2328,519"/><area shape="rect" id="node98" href="../../d0/dde/fluxctstag_8c.html#ad6aa918442f7768dff3c099ba353ee64" title="slope_lim_face2corn() is provided p2interp and returns pleft/pright differs from slope_lim() by range..." alt="" coords="1963,215,2104,244"/><area shape="rect" id="node50" href="../../dc/dae/flux_8c.html#a2602a4dad9ed7adc944227d02435312e" title="standard (non&#45;field flux) calculation but setup to store results of interpolation so can be used for ..." alt="" coords="2171,161,2365,191"/><area shape="rect" id="node52" href="../../dc/dae/flux_8c.html#aaf6d832880760f80459d91477c28b519" title="wrapper for different standard 1&#45;D flux calculators 1&#45;D interpolate and get flux for that direction (..." alt="" coords="2445,161,2560,191"/><area shape="rect" id="node54" href="../../dc/dae/flux_8c.html#a8ffa7399bd5354fdcdec5f3e1adf0b13" title="wrapper for CENT_to_FACE1,2,3 used to compute flux at face" alt="" coords="2677,111,2771,140"/><area shape="rect" id="node56" href="../../d5/d2f/flux_8funcdeclare_8h.html#ab229b0f3f2caf3c0a3ef5299fba2b1c0" title="see fluxcompute.c for non&#45;computer science, real physics calculations of flux" alt="" coords="2868,267,2935,296"/><area shape="rect" id="node58" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="3017,291,3145,320"/><area shape="rect" id="node63" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="3004,368,3159,397"/><area shape="rect" id="node60" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="3249,201,3319,231"/><area shape="rect" id="node69" href="../../df/d15/init_8tools_8c.html#a3750bc790613bc6c8c805af0f1b839c8" title="user1_init_vpot2field_user" alt="" coords="2995,748,3168,777"/><area shape="rect" id="node71" href="../../de/db2/initbase_8funcdeclare_8h.html#afda44281ad5c163455c40f012d4a8954" title="init_vpot2field_user" alt="" coords="3217,749,3351,779"/><area shape="rect" id="node73" href="../../de/db2/initbase_8funcdeclare_8h.html#a90699a18ede8b7f112c0078512804ec1" title="initialize vector potential given user function assumes normal non&#45;staggered field in pr Notice that ..." alt="" coords="3433,749,3503,779"/><area shape="rect" id="node84" href="../../d0/dde/fluxctstag_8c.html#a5e3dcbe89d6f8a9384cafb58afd7dbf4" title="interpolates field at FACE to field at CENT assuming field along itself is continuous" alt="" coords="2208,369,2328,415"/><area shape="rect" id="node90" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aaa24493002bc8c0a527b1ea2ac2dddbf" title="convert conservative U to stag point P and CENT point U and CENT point primitive" alt="" coords="2657,489,2791,519"/><area shape="rect" id="node100" href="../../d0/dde/fluxctstag_8c.html#a985ee116306b4011810334ae93900493" title="INPUTS: Nvec, pr, primface_l[dir], primface_r[dir] OUTPUTS: pbcorn[dir][side], pvcorn[dir][side][side..." alt="" coords="2179,215,2357,244"/><area shape="rect" id="node108" href="../../d9/de0/step__ch_8c.html#a91fe5c4370e3292a19e7f794797a407f" title="normal bounding of all primitives" alt="" coords="3417,863,3519,892"/><area shape="rect" id="node114" href="../../d9/de0/step__ch_8c.html#abdea68b778dc9253324da69d3c376965" title="bound any pstag type CALLS directly real and MPI boundary functions pstag is at FACE1,2,3 for fields, so user bound is different MPI bounding is the same as CENT quantities used when restarting in initbase.c to bound unewglobal for FLUXB==FLUXCTSTAG" alt="" coords="1975,852,2092,881"/><area shape="rect" id="node117" href="../../d9/de0/step__ch_8c.html#a6f4b963a50a7288964f01775f2f18bb9" title="normal bounding of staggered primitives" alt="" coords="2220,752,2316,781"/><area shape="rect" id="node120" href="../../d0/dde/fluxctstag_8c.html#aa169cb1999412f2e2460012cc5d7a804" title="pure DONOR version: upoint is input staggered updated field that needs to be converted to pstag and t..." alt="" coords="2415,745,2591,791"/><area shape="rect" id="node155" href="../../de/d51/bounds_8c.html#a16398a5325a9df48783423f00ba65bb7" title="all boundaries for RADCYLBEAMCART" alt="" coords="932,265,1084,295"/><area shape="rect" id="node160" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a7e078cc9a354495bc85554d875a705d9" title="General explicit inversion of U[MHD]&#45;&gt;P[MHD] and also inverts scalars. Inverts radiation if(EOMRADTYP..." alt="" coords="2857,421,2945,451"/><area shape="rect" id="node164" href="../../d8/d60/init_8c.html#af3b64278d50c2ff0fee80291fbd38dab" title="fieldprim" alt="" coords="3047,644,3116,673"/><area shape="rect" id="node170" href="../../db/dc8/utoprimgen_8funcdeclare_8h.html#a8db9dc7c7f52d6fcb405a74e519db5cf" title="there may be something wrong with this function  didn&#39;t work in TIMEORDER==4, had to do standard met..." alt="" coords="3036,421,3127,451"/><area shape="rect" id="node167" href="../../de/db2/initbase_8funcdeclare_8h.html#a4e121b9448ac1adaa7608206369f9ea5" title="init_postvpot" alt="" coords="3420,644,3516,673"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2f3df15638b9795556ef2bdf1e8c8f97"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int vchar_rad </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d1/d83/structof__state.html">of_state</a> *&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>geom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>cmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>cmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>cmax2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>cmin2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>ignorecourant</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>compute radiative characteristics as limited by opacity </p>

<p>Definition at line <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html#l10975">10975</a> of file <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html">phys.tools.rad.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d21/global_8funcdeclare_8rad_8h_a2f3df15638b9795556ef2bdf1e8c8f97_cgraph.png" border="0" usemap="#df/d21/global_8funcdeclare_8rad_8h_a2f3df15638b9795556ef2bdf1e8c8f97_cgraph" alt=""/></div>
<map name="df/d21/global_8funcdeclare_8rad_8h_a2f3df15638b9795556ef2bdf1e8c8f97_cgraph" id="df/d21/global_8funcdeclare_8rad_8h_a2f3df15638b9795556ef2bdf1e8c8f97_cgraph">
<area shape="rect" id="node3" href="../../d2/d72/phys_8tools_8rad_8c.html#a63256be4e6a63216cb736012e36a6375" title="calc_chi" alt="" coords="161,5,231,35"/><area shape="rect" id="node5" href="../../d2/d72/phys_8tools_8rad_8c.html#a795959353203e99366b456b16d0d0bab" title="calculates total opacity over dx[] for given chi or chieff" alt="" coords="133,59,259,88"/><area shape="rect" id="node7" href="../../d2/d72/phys_8tools_8rad_8c.html#abd01208ba3c5754ea5587bcaefcaa01b" title="get lab&#45;frame 3&#45;velocity for radiative emission in radiative frame" alt="" coords="143,112,249,141"/><area shape="rect" id="node9" href="../../d8/d20/vchar_8c.html#acad033b60e7ca6404ffcd9b0fdfd13b4" title="simplefast" alt="" coords="313,81,396,111"/><area shape="rect" id="node19" href="../../d9/de9/coord_8c.html#a0672d8c0ee4ff07c7265d0ecbc365cdc" title="normally&#45;used dxdxp[i,j,k] = dV/dX" alt="" coords="308,141,401,171"/><area shape="rect" id="node11" href="../../d3/ddc/phys_8funcdeclare_8h.html#a11e17cd8b0594d1ad52e3594aa9f477e" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="452,75,527,104"/><area shape="rect" id="node13" href="../../d3/ddc/phys_8funcdeclare_8h.html#a12a473e24b431762af4168179e82cd08" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="595,8,757,37"/><area shape="rect" id="node15" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a8a762bf6582e6f7e1199de9c43b98454" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="577,61,775,91"/><area shape="rect" id="node17" href="../../d3/ddc/phys_8funcdeclare_8h.html#a41b8eacac0a4a23d6b00b670fe49629c" title="bsq_calc_fromq" alt="" coords="619,115,733,144"/><area shape="rect" id="node21" href="../../d9/de9/coord_8c.html#a64a4372100fc55abf546f02c8b779595" title="Jacobian for dx uniform per dx nonuniform (dx/dr / dx/dr&#39;) i.e." alt="" coords="452,155,527,184"/><area shape="rect" id="node23" href="../../d9/de9/coord_8c.html#a56c4b5c03b74a33a7d809daecfa6925e" title="numerical derivative of V w.r.t. X" alt="" coords="616,168,736,197"/><area shape="rect" id="node25" href="../../d9/de9/coord_8c.html#a65ad4ca9656d141cc995fd35ed31dc40" title="Returns boyer&#45;lindquist coordinte of point." alt="" coords="825,168,895,197"/><area shape="rect" id="node27" href="../../d8/d60/init_8c.html#a27c01fe4532cf3e10d467517403dbf70" title="blcoord_user" alt="" coords="957,141,1053,171"/><area shape="rect" id="node29" href="../../d9/de9/coord_8c.html#af7a086e6042d598aea95c2360d07a99b" title="blcoord_singfixes" alt="" coords="944,195,1067,224"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d21/global_8funcdeclare_8rad_8h_a2f3df15638b9795556ef2bdf1e8c8f97_icgraph.png" border="0" usemap="#df/d21/global_8funcdeclare_8rad_8h_a2f3df15638b9795556ef2bdf1e8c8f97_icgraph" alt=""/></div>
<map name="df/d21/global_8funcdeclare_8rad_8h_a2f3df15638b9795556ef2bdf1e8c8f97_icgraph" id="df/d21/global_8funcdeclare_8rad_8h_a2f3df15638b9795556ef2bdf1e8c8f97_icgraph">
<area shape="rect" id="node3" href="../../d2/dd4/wavespeeds_8funcdeclare_8h.html#abb81988bde678c59afc5d006cf76b835" title="vchar_each" alt="" coords="135,95,223,124"/><area shape="rect" id="node5" href="../../d2/dd4/wavespeeds_8funcdeclare_8h.html#a119027341f97d571212ad74c5ddc94b4" title="get wave speeds for flux calculation and for dt calculation" alt="" coords="981,43,1056,72"/><area shape="rect" id="node30" href="../../d2/dd4/wavespeeds_8funcdeclare_8h.html#a2afa5dfde87c74476341a69d555f91e6" title="get wave speeds for flux calculation" alt="" coords="293,148,413,177"/><area shape="rect" id="node55" href="../../d2/dd4/wavespeeds_8funcdeclare_8h.html#a75426b1b9bf1a293c60d108c63b0322d" title="store wavespeeds somewhere" alt="" coords="273,95,433,124"/><area shape="rect" id="node7" href="../../d5/de3/phys_8tools_8funcdeclare_8h.html#ac9512f95a18d4a189ac642d138f95051" title="2D only for now since really only useful for 2D imaging map out region around failure point OPENMPNOT..." alt="" coords="1283,15,1360,44"/><area shape="rect" id="node25" href="../../d6/db2/diag_8funcdeclare_8h.html#a53324e6dbf9729772e70f0a053468ae6" title="set var to be averaged in time" alt="" coords="1127,68,1223,97"/><area shape="rect" id="node9" href="../../d6/db2/diag_8funcdeclare_8h.html#ac0efe363ff7411385b5c6ab3b1f146aa" title="main diag() call for diagnostics OPENMPNOTE: Assume diag() not called by multiple threads..." alt="" coords="1475,41,1520,71"/><area shape="rect" id="node11" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="2219,17,2269,47"/><area shape="rect" id="node13" href="../../d9/de0/step__ch_8c.html#a4c42d9adb1cef442b95fd62f99ee087a" title="things to do before taking a full timestep assume not called when dt==0.0" alt="" coords="1801,43,1887,72"/><area shape="rect" id="node18" href="../../d9/de0/step__ch_8c.html#ad36a0f9f915547477e3bb2405f8166b9" title="things to do after advance()" alt="" coords="1625,93,1727,123"/><area shape="rect" id="node15" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="2079,43,2169,72"/><area shape="rect" id="node20" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="1777,96,1911,125"/><area shape="rect" id="node22" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="1961,95,2028,124"/><area shape="rect" id="node27" href="../../d6/db2/diag_8funcdeclare_8h.html#a6bd89f9169256368191c508d23b0b453" title="if doavg==1, then assume this is call before dumping" alt="" coords="1272,68,1371,97"/><area shape="rect" id="node32" href="../../d3/ddc/phys_8funcdeclare_8h.html#a0bb12b388b07610cf01d08c19f8fddb1" title="actually compute the flux and ctop for dt calculation" alt="" coords="501,148,651,177"/><area shape="rect" id="node34" href="../../dc/dae/flux_8c.html#a054658527dfb1d80226b8b2d2106aeed" title="original flux calculator that gets F in &quot;dir&quot;. At end global pleft,pright,dq also set and if STOREWAV..." alt="" coords="753,95,876,124"/><area shape="rect" id="node49" href="../../dc/dae/flux_8c.html#a2602a4dad9ed7adc944227d02435312e" title="standard (non&#45;field flux) calculation but setup to store results of interpolation so can be used for ..." alt="" coords="717,148,912,177"/><area shape="rect" id="node52" href="../../dc/dae/flux_8c.html#aa26f8747446e1cd5bd214ebc345aafa2" title="compute donor&#45;based flux, bypassing normal fluxcalc()." alt="" coords="965,200,1072,229"/><area shape="rect" id="node36" href="../../dc/dae/flux_8c.html#aaf6d832880760f80459d91477c28b519" title="wrapper for different standard 1&#45;D flux calculators 1&#45;D interpolate and get flux for that direction (..." alt="" coords="961,147,1076,176"/><area shape="rect" id="node38" href="../../dc/dae/flux_8c.html#a8ffa7399bd5354fdcdec5f3e1adf0b13" title="wrapper for CENT_to_FACE1,2,3 used to compute flux at face" alt="" coords="1128,147,1221,176"/><area shape="rect" id="node40" href="../../d5/d2f/flux_8funcdeclare_8h.html#ab229b0f3f2caf3c0a3ef5299fba2b1c0" title="see fluxcompute.c for non&#45;computer science, real physics calculations of flux" alt="" coords="1288,147,1355,176"/><area shape="rect" id="node42" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="1433,147,1561,176"/><area shape="rect" id="node47" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="1420,200,1575,229"/><area shape="rect" id="node44" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="1641,147,1711,176"/><area shape="rect" id="node57" href="../../d2/dd4/wavespeeds_8funcdeclare_8h.html#acb4a2a3be68517862cdcf097ff51af37" title="complete storage of wave speeds per dimension only called for STOREWAVESPEEDS==1" alt="" coords="484,95,668,124"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a64226cb28f52020ffe18ac6c6b1a2f5c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int whichfluid_ffrad_to_primeall </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>whichvel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>whichcoordfluid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>whichcoordrad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d39/global_8structs_8h.html#aa7fe064ca3d2eb92f00456cd7c186eae">of_geom</a> *&#160;</td>
          <td class="paramname"><em>ptrgeomprimecoords</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pradffortho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/df4/global_8realdef_8h.html#a4b869b0ea0650e99dff987e742327ce0">FTYPE</a> *&#160;</td>
          <td class="paramname"><em>pout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Input: start with pin [with fluid in whichvel velocity and whichcoordfluid coordinates (PRIMECOORDS or MCOORD) and radiation as E,F in fluid frame orthonormal basis in whichcoordrad coordinates] Output: pout [with all WHICHVEL PRIMECOORDS and radiation using velocity primitive]. </p>
<p>Useful for BCs when have (say) VEL3,MCOORD for fluid velocity as well as E,F in ff for radiation and need normal WHICHVEL PRIMECOORDS fluid velocity as well as normal velocity primitive for radiation </p>

<p>Definition at line <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html#l11729">11729</a> of file <a class="el" href="../../d2/d72/phys_8tools_8rad_8c_source.html">phys.tools.rad.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d21/global_8funcdeclare_8rad_8h_a64226cb28f52020ffe18ac6c6b1a2f5c_cgraph.png" border="0" usemap="#df/d21/global_8funcdeclare_8rad_8h_a64226cb28f52020ffe18ac6c6b1a2f5c_cgraph" alt=""/></div>
<map name="df/d21/global_8funcdeclare_8rad_8h_a64226cb28f52020ffe18ac6c6b1a2f5c_cgraph" id="df/d21/global_8funcdeclare_8rad_8h_a64226cb28f52020ffe18ac6c6b1a2f5c_cgraph">
<area shape="rect" id="node3" href="../../d3/d09/transforms_8c.html#a30134f0b6967fd3c2326b305300d07dc" title="prime MCOORD &#45;&gt; MCOORD for u^" alt="" coords="1529,719,1657,748"/><area shape="rect" id="node17" href="../../d3/d09/transforms_8c.html#a0a76b7b5c088e56618389fe3acf60119" title="whichcoordin &#45;&gt; whichcoordout" alt="" coords="413,588,496,617"/><area shape="rect" id="node33" href="../../d3/d09/transforms_8c.html#a0c5044bf89287cf41d59999d96f9fc12" title="MCOORD &#45;&gt; prime MCOORD." alt="" coords="391,667,519,696"/><area shape="rect" id="node42" href="../../df/d21/global_8funcdeclare_8rad_8h.html#af50896d039d660550b738862b3390b07" title="radiative ortonormal ff primitives (E,F^i) &lt;&#45;&gt; primitives in lab frame Used only for initial conditio..." alt="" coords="217,375,308,404"/><area shape="rect" id="node123" href="../../d3/d09/transforms_8c.html#a571104584acab566d6eb37f51cfb2102" title="converts whichvel/whichcoord velocity to WHICHVEL/(&#45;&gt;MCOORD&#45;&gt;PRIMECOORDS) converts field too..." alt="" coords="185,616,340,645"/><area shape="rect" id="node5" href="../../d9/de9/coord_8c.html#a0672d8c0ee4ff07c7265d0ecbc365cdc" title="normally&#45;used dxdxp[i,j,k] = dV/dX" alt="" coords="1732,719,1825,748"/><area shape="rect" id="node7" href="../../d9/de9/coord_8c.html#a64a4372100fc55abf546f02c8b779595" title="Jacobian for dx uniform per dx nonuniform (dx/dr / dx/dr&#39;) i.e." alt="" coords="1901,665,1976,695"/><area shape="rect" id="node9" href="../../d9/de9/coord_8c.html#a56c4b5c03b74a33a7d809daecfa6925e" title="numerical derivative of V w.r.t. X" alt="" coords="2061,665,2181,695"/><area shape="rect" id="node11" href="../../d9/de9/coord_8c.html#a65ad4ca9656d141cc995fd35ed31dc40" title="Returns boyer&#45;lindquist coordinte of point." alt="" coords="2324,639,2393,668"/><area shape="rect" id="node13" href="../../d8/d60/init_8c.html#a27c01fe4532cf3e10d467517403dbf70" title="blcoord_user" alt="" coords="2515,612,2611,641"/><area shape="rect" id="node15" href="../../d9/de9/coord_8c.html#af7a086e6042d598aea95c2360d07a99b" title="blcoord_singfixes" alt="" coords="2501,665,2624,695"/><area shape="rect" id="node19" href="../../d3/d09/transforms_8c.html#a18c0d9e83dd42057f18c8682445e520e" title="bltoks" alt="" coords="637,615,693,644"/><area shape="rect" id="node28" href="../../d3/d09/transforms_8c.html#aeb5a7fff357c150f4a21d08ee9141661" title="kstobl" alt="" coords="637,561,693,591"/><area shape="rect" id="node21" href="../../d3/d09/transforms_8c.html#a4e56c98db9838030d332feae8a77e19d" title="bltoks_trans" alt="" coords="864,615,957,644"/><area shape="rect" id="node23" href="../../d9/de9/coord_8c.html#a96290375e27d5d0aa4d843b07e228e14" title="normally&#45;used bl_coord[i,j,k] {i,j,k} &#45;&gt; V only" alt="" coords="1115,615,1205,644"/><area shape="rect" id="node25" href="../../d9/de9/coord_8c.html#a041e7b005310415c97d90f4b8521ed1a" title="get X(i,j,k) CENT is default position in degenerate cases" alt="" coords="1368,561,1421,591"/><area shape="rect" id="node30" href="../../d3/d09/transforms_8c.html#aeba8434ef96cb68e3557349ee8e24378" title="kstobl_trans" alt="" coords="864,561,957,591"/><area shape="rect" id="node35" href="../../d9/de9/coord_8c.html#a6b81e8ff9e3ef5fdf6eade928726f237" title="normally&#45;used dxdxp[i,j,k]" alt="" coords="1729,665,1828,695"/><area shape="rect" id="node38" href="../../d9/de9/coord_8c.html#a8a51ec95e21441bc2c561af70a1037de" title="Get (dV/dX)^{&#45;1}." alt="" coords="1900,321,1977,351"/><area shape="rect" id="node40" href="../../d6/d1b/metric_8tools_8c.html#af5438dd54272eb585ff5acb06d7195d4" title="matrix_inverse" alt="" coords="2068,296,2175,325"/><area shape="rect" id="node44" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a2ec6ee79c76351868a725b22dac62135" title="like prad_fforlab() but for only whichdir=FF2LAB used for IC" alt="" coords="409,375,500,404"/><area shape="rect" id="node103" href="../../df/d21/global_8funcdeclare_8rad_8h.html#ad1313c275fb108d10f866373d9bb227a" title="like prad_fforlab() but for only whichdir=LAB2FF used for dumps or diags" alt="" coords="409,217,500,247"/><area shape="rect" id="node46" href="../../d2/d72/phys_8tools_8rad_8c.html#a949a0736746df92cb2600c6c015976e1" title="compute fluid frame orthonormal basis radiation stress&#45;energy tensor assuming M1 closure" alt="" coords="624,401,707,431"/><area shape="rect" id="node48" href="../../d3/ddc/phys_8funcdeclare_8h.html#a35c4399eb86e3fa77e2221000e077572" title="ucon_calc_whichvel" alt="" coords="596,348,735,377"/><area shape="rect" id="node63" href="../../d5/d0a/tetrad_8c.html#a6999a0ba04240d0dcbe3ae46adba0510" title="convert lab frame 4&#45;tensor to fluid frame orthonormal 4&#45;tensor" alt="" coords="575,271,756,300"/><area shape="rect" id="node90" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a9fe58e7f372421d18633c8fc5007b815" title="u2p_rad" alt="" coords="632,455,699,484"/><area shape="rect" id="node50" href="../../d3/ddc/phys_8funcdeclare_8h.html#ad141359a7901a82a0c26241b432183c3" title="find contravariant time component of four&#45;velocity from the 4velocity (3 terms)" alt="" coords="1104,561,1216,591"/><area shape="rect" id="node53" href="../../d3/ddc/phys_8funcdeclare_8h.html#afc1e1232a2f457b71cfd9210f2b5240a" title="find contravariant four&#45;velocity int ucon_calc(FTYPE *pr, struct of_geom *geom, FTYPE *ucon..." alt="" coords="855,323,967,352"/><area shape="rect" id="node55" href="../../d3/ddc/phys_8funcdeclare_8h.html#a7aadb359813194586356c2c325322a45" title="find contravariant four&#45;velocity from the relative 4 velocity" alt="" coords="848,376,973,405"/><area shape="rect" id="node57" href="../../d3/ddc/phys_8funcdeclare_8h.html#a5910aabe5e76183d341ef5b830b01bab" title="find {u}^ from u^ only fill spatial parts so can feed in 3&#45;vector" alt="" coords="1128,351,1192,380"/><area shape="rect" id="node59" href="../../d3/ddc/phys_8funcdeclare_8h.html#a20be479a3f03f3de780359d6e9290fe3" title="find u^ from {u}^ fill full 4&#45;vector OPTMARK: Before storing , this was the most expensive function o..." alt="" coords="1060,297,1260,327"/><area shape="rect" id="node61" href="../../d3/ddc/phys_8funcdeclare_8h.html#abfae38e47b0bd05a4fc38302ff948a96" title="find gamma&#45;factor wrt normal observer This function and qsq_calc() have about the same cache miss amo..." alt="" coords="1309,401,1480,431"/><area shape="rect" id="node65" href="../../d5/d0a/tetrad_8c.html#a69bb4f4bdcfeeddc2f94c291e3c4a887" title="use lab frame contravariant 4&#45;velocity (uconlab) and get transformation matrix for going to orthonorm..." alt="" coords="1091,244,1229,273"/><area shape="rect" id="node67" href="../../d5/d0a/tetrad_8c.html#a529e9fcba9169e956453fa28b0ec5b29" title="get stored or compute tetrcov and tetrcon primcoord: whether PRIMCOORDS type, so will use dxdxp to si..." alt="" coords="1341,348,1448,377"/><area shape="rect" id="node87" href="../../d5/d0a/tetrad_8c.html#aecffb2ef6ac562816636daf704607915" title="calculate boost assuming in orthonormal basis where g_{}={} = diag(&#45;1,0,0,0) NOTEMARK: Orthonormal do..." alt="" coords="1324,295,1465,324"/><area shape="rect" id="node69" href="../../d5/d0a/tetrad_8c.html#a1a0f6fda274fc7e16bdd8fcdfb4450ed" title="Notes:" alt="" coords="1536,348,1651,377"/><area shape="rect" id="node73" href="../../d5/d0a/tetrad_8c.html#ad5d2935e2a3bac988149aa7b02c8feca" title="find suitable orthonormal tetrad wrapper for tetr_func()." alt="" coords="1708,296,1849,325"/><area shape="rect" id="node76" href="../../d5/d0a/tetrad_8c.html#a0ca3db13e43c41bb7271db7bac10dc2a" title="input gcov and get out orthonormal tetrad in covariant and contravariant forms if metrictype..." alt="" coords="1903,191,1975,220"/><area shape="rect" id="node78" href="../../d5/d0a/tetrad_8c.html#a2ed15e40ab71ecd986b28510b0d8b8d4" title="compute_tetrcon_frommetric" alt="" coords="2028,165,2215,195"/><area shape="rect" id="node80" href="../../d5/d0a/tetrad_8c.html#a7daace7a466d45cd01436b89193102c0" title="pre&#45;setup tetrad use of lapack function" alt="" coords="2289,217,2428,247"/><area shape="rect" id="node84" href="../../d5/d0a/tetrad_8c.html#acc8b9e9ae9e03624e53b0a45e881a367" title="compute orthonormal tetrad [ortho]^[lab] for converting u_[lab] or u^[ortho] Notes: For full rotating..." alt="" coords="2265,147,2452,194"/><area shape="rect" id="node82" href="../../d4/dfc/tetlapack__func__doubleonly_8c.html#a6493f604b00b9a2337263d17b6230a02" title="native doubles for inside variables find tetrad" alt="" coords="2509,217,2616,247"/><area shape="rect" id="node92" href="../../d2/d72/phys_8tools_8rad_8c.html#a67b370af2fa58283bc590ff4e895fb90" title="Like u2p_rad_orig(), but uses Jon&#39;s paper draft ZAMO RAD version." alt="" coords="861,455,960,484"/><area shape="rect" id="node94" href="../../d2/d72/phys_8tools_8rad_8c.html#a77c546a7fb064266fef5a9e796dc63dc" title="compute ZAMO version of radiation quantities as in paper draft" alt="" coords="1087,508,1233,537"/><area shape="rect" id="node97" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a3e47afcfc5c42719999d851395fd032d" title="nrad(E)" alt="" coords="1096,455,1224,484"/><area shape="rect" id="node99" href="../../df/d21/global_8funcdeclare_8rad_8h.html#af07558357c906b4dfa61cd34656d9f02" title="E=urad=arad T^4 and just solve for T (this is LTE only if assume resulting T is gas T)..." alt="" coords="1332,508,1457,537"/><area shape="rect" id="node101" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a7dc2e853cec9b6f9a5e83ce23c468d03" title="nrad(T) = nrad=arad T^3/2.70118 (this is LTE only if put in T was gas T)" alt="" coords="1331,455,1459,484"/><area shape="rect" id="node105" href="../../d3/ddc/phys_8funcdeclare_8h.html#a11e17cd8b0594d1ad52e3594aa9f477e" title="find ucon, ucov, bcon, bcov from primitive variables when calling get_state, users of this function e..." alt="" coords="628,139,703,168"/><area shape="rect" id="node113" href="../../df/d21/global_8funcdeclare_8rad_8h.html#aba8efc1e2ea7a31f67bb6c06ce3c164a" title="mhdfull_calc_rad" alt="" coords="605,45,725,75"/><area shape="rect" id="node117" href="../../d5/d0a/tetrad_8c.html#ae8d70957690f267632e5db4f4b06a490" title="Wrapper for vector_lab2orthofluidorback()" alt="" coords="569,217,761,247"/><area shape="rect" id="node107" href="../../d3/ddc/phys_8funcdeclare_8h.html#a12a473e24b431762af4168179e82cd08" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="829,59,992,88"/><area shape="rect" id="node109" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a8a762bf6582e6f7e1199de9c43b98454" title="Get only u^ and u_ assumine b^ and b_ not used." alt="" coords="812,112,1009,141"/><area shape="rect" id="node111" href="../../d3/ddc/phys_8funcdeclare_8h.html#a41b8eacac0a4a23d6b00b670fe49629c" title="bsq_calc_fromq" alt="" coords="853,165,968,195"/><area shape="rect" id="node115" href="../../df/d21/global_8funcdeclare_8rad_8h.html#a389bf7e41d2fd117af996e3392067cdc" title="compute radiation stres&#45;energy tensor assuming M1 closure" alt="" coords="860,5,961,35"/><area shape="rect" id="node119" href="../../d5/d0a/tetrad_8c.html#af9cffa9c2f215c3446c8dced2a326b42" title="convert 4&#45;vector to/from lab&#45;frame coordinate basis to fluid frame orthonormal basis" alt="" coords="820,219,1001,248"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d21/global_8funcdeclare_8rad_8h_a64226cb28f52020ffe18ac6c6b1a2f5c_icgraph.png" border="0" usemap="#df/d21/global_8funcdeclare_8rad_8h_a64226cb28f52020ffe18ac6c6b1a2f5c_icgraph" alt=""/></div>
<map name="df/d21/global_8funcdeclare_8rad_8h_a64226cb28f52020ffe18ac6c6b1a2f5c_icgraph" id="df/d21/global_8funcdeclare_8rad_8h_a64226cb28f52020ffe18ac6c6b1a2f5c_icgraph">
<area shape="rect" id="node3" href="../../de/d51/bounds_8c.html#a3bc773d499b145705bdc23125b963840" title="Koral specific physical boundary conditions." alt="" coords="465,179,665,208"/><area shape="rect" id="node110" href="../../de/d51/bounds_8c.html#a09a080d9895db7b800a3824cb3fac9f1" title="X1 lower for beam injection to create shadow." alt="" coords="485,232,645,261"/><area shape="rect" id="node113" href="../../de/d51/bounds_8c.html#a3ee134cc5fb18752265c16a20dbdfb63" title="X3 lower for radiation beam injection." alt="" coords="468,285,663,315"/><area shape="rect" id="node116" href="../../de/d51/bounds_8c.html#a8300ddf3ae6a3866234cc0e9c12f26dc" title="X1 upper for inflow." alt="" coords="472,339,659,368"/><area shape="rect" id="node119" href="../../de/d51/bounds_8c.html#a01088f65c7a4cfa2ebfed202f815b951" title="X1 lower and upper for RADATM." alt="" coords="480,392,651,421"/><area shape="rect" id="node122" href="../../de/d51/bounds_8c.html#a1382959a7b699ea5d224168612504263" title="X1 upper for inflow." alt="" coords="492,445,639,475"/><area shape="rect" id="node125" href="../../de/d51/bounds_8c.html#ac15824bc610943cb7e02112e77b94752" title="on&#45;grid bounding" alt="" coords="251,491,349,520"/><area shape="rect" id="node128" href="../../de/d51/bounds_8c.html#a42658c4ecf3c6edb958394eb65a9ac2b" title="RADNT." alt="" coords="253,544,347,573"/><area shape="rect" id="node131" href="../../de/d51/bounds_8c.html#a3e4008fd24427b2e91d0ae5882b9536a" title="X1 upper for RADCYLBEAM." alt="" coords="217,597,383,627"/><area shape="rect" id="node134" href="../../de/d51/bounds_8c.html#ac32c1a20138382904dc5f1c66778ad8b" title="X1 upper for RADCYLJET." alt="" coords="227,651,373,680"/><area shape="rect" id="node137" href="../../de/d51/bounds_8c.html#a635fbaba3d6d6afcf5f34bbb2c278737" title="X2 upper for radiation beam injection." alt="" coords="185,704,415,733"/><area shape="rect" id="node140" href="../../de/d51/bounds_8c.html#a9f1df4e461f3f776bf3cb80e36a4d6df" title="get_radcylbeamcart" alt="" coords="232,757,368,787"/><area shape="rect" id="node5" href="../../de/d51/bounds_8c.html#a34ac3f1ca7b0f3a21053c633da9931a9" title="user boundary routine" alt="" coords="715,472,885,501"/><area shape="rect" id="node7" href="../../d4/dad/bounds_8funcdeclare_8h.html#a4bc7413b2cdb89e070f38bbb689ae555" title="bound_prim_user_dir" alt="" coords="937,419,1079,448"/><area shape="rect" id="node99" href="../../d4/dad/bounds_8funcdeclare_8h.html#a2fbddc9ff8fc706bafa80c39695c7262" title="assume single user function takes care of primitive locations" alt="" coords="933,659,1083,688"/><area shape="rect" id="node9" href="../../d9/de0/step__ch_8c.html#adbe0e3ba8a74f09ab928a96bd68cab6d" title="bound any prim type CALLS directly real and MPI boundary functions pstag = pstagglobal ucons = unewgl..." alt="" coords="1132,372,1241,401"/><area shape="rect" id="node11" href="../../d9/de0/step__ch_8c.html#a689fddc1949b1a1d390b59d10d17d83c" title="normal full bounding during evolution NOTEMARK: Was previously also bounding pstag here..." alt="" coords="1309,43,1435,72"/><area shape="rect" id="node24" href="../../d9/de0/step__ch_8c.html#a4079244d85c301885c1363ca41502869" title="simple bounding during evolution NOTEMARK: Was previously also bounding pstag here, but not necessary since done by calling bound_pstag in fluxctstag.c" alt="" coords="1291,207,1453,236"/><area shape="rect" id="node27" href="../../d9/de0/step__ch_8c.html#addca75a18cc861326a321565a2e81aa0" title="normal bounding of non&#45;staggered primitives" alt="" coords="1328,372,1416,401"/><area shape="rect" id="node93" href="../../d9/de0/step__ch_8c.html#a460b84e1112e3aef17209c20e22e1cf1" title="bound all prims" alt="" coords="1764,757,1887,787"/><area shape="rect" id="node13" href="../../d9/de0/step__ch_8c.html#ad36a0f9f915547477e3bb2405f8166b9" title="things to do after advance()" alt="" coords="1540,43,1641,72"/><area shape="rect" id="node15" href="../../d9/de0/step__ch_8c.html#a6ffc23f905bf9f398646f83250167dd2" title="take full step using normal MPI method This method transfers ALL boundary cells AT ONCE after updatin..." alt="" coords="2948,105,3081,135"/><area shape="rect" id="node17" href="../../d9/de0/step__ch_8c.html#afe241569412f22a86dea9cd91b516af8" title="take step itself" alt="" coords="3168,247,3235,276"/><area shape="rect" id="node19" href="../../d9/de0/step__ch_8c.html#a306fe858d9befc91e386212efe65acaf" title="take full step (called from main.c)" alt="" coords="3473,340,3564,369"/><area shape="rect" id="node21" href="../../d0/d29/main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function that primarily calls init(), diag(), and step_ch_full() in loop." alt="" coords="3613,423,3664,452"/><area shape="rect" id="node29" href="../../dc/dae/flux_8c.html#aef355ccd1ca2295b84ad2fe1fc011d35" title="normal interpolation of CENT quantities to FACE quantities sets global variables pl_ct and pr_ct to p..." alt="" coords="1501,269,1680,299"/><area shape="rect" id="node46" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aecb3f613a7cb3bbb42fff2dbee5d65a1" title="This vpot2field function is for staggered method to evolve quasi&#45;deaveraged fields (i..." alt="" coords="2199,647,2364,676"/><area shape="rect" id="node48" href="../../de/db2/initbase_8funcdeclare_8h.html#ae6b2ad4cd0debf5b89ba8a9e471d6977" title="assumes normal field p pleft used as temp var if FLUXB==FLUXCTSTAG assigns conserved field in UEVOLVE..." alt="" coords="2415,596,2492,625"/><area shape="rect" id="node56" href="../../df/d15/init_8tools_8c.html#a77551ab2581efdbaf170dfca073ff9ab" title="user1_init_primitives" alt="" coords="3131,583,3272,612"/><area shape="rect" id="node60" href="../../de/df8/initbase_8c.html#ac4110398e386c9888d9565630357dbbe" title="General&#45;Primary init() routine Uses globals inside init() because sets memory and sets physics..." alt="" coords="3500,505,3537,535"/><area shape="rect" id="node63" href="../../d0/dde/fluxctstag_8c.html#a4e3d76c6ad125b8199948408c262e3a1" title="wrapper for: 1) interpolate FACE 2 CORN 2) loop over dimensions setting field flux dimension&#45;by&#45;dimen..." alt="" coords="1995,189,2125,219"/><area shape="rect" id="node66" href="../../d0/dde/fluxctstag_8c.html#a2dd789bf1402bef72523cdb69e85806e" title="use global pbcorninterp and pvcorninterp at CORN1,2,3 to obtain EMFs at CORN1,2,3 NO interpolation of..." alt="" coords="1525,95,1656,142"/><area shape="rect" id="node69" href="../../d0/dde/fluxctstag_8c.html#aaec26a518629175ecceefbaf6c84225e" title="wrapper for continuous interpolation for FACE_to_CENT" alt="" coords="1504,428,1677,457"/><area shape="rect" id="node73" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aa31dd83c96936277334c62e2098dd51d" title="wrapper for taking staggered conserved field quantity and obtaining centered field quantity upoint en..." alt="" coords="1972,372,2148,401"/><area shape="rect" id="node82" href="../../d0/dde/fluxctstag_8c.html#a6cd90dff56319085b32bc57c0c8b3cfd" title="this function called in initbase.c and during advance() here ustag is point value if dimension doesn&#39;..." alt="" coords="1765,372,1885,401"/><area shape="rect" id="node85" href="../../d0/dde/fluxctstag_8c.html#ad6aa918442f7768dff3c099ba353ee64" title="slope_lim_face2corn() is provided p2interp and returns pleft/pright differs from slope_lim() by range..." alt="" coords="1520,165,1661,195"/><area shape="rect" id="node31" href="../../dc/dae/flux_8c.html#a2602a4dad9ed7adc944227d02435312e" title="standard (non&#45;field flux) calculation but setup to store results of interpolation so can be used for ..." alt="" coords="1728,268,1923,297"/><area shape="rect" id="node33" href="../../dc/dae/flux_8c.html#aaf6d832880760f80459d91477c28b519" title="wrapper for different standard 1&#45;D flux calculators 1&#45;D interpolate and get flux for that direction (..." alt="" coords="2003,268,2117,297"/><area shape="rect" id="node35" href="../../dc/dae/flux_8c.html#a8ffa7399bd5354fdcdec5f3e1adf0b13" title="wrapper for CENT_to_FACE1,2,3 used to compute flux at face" alt="" coords="2235,268,2328,297"/><area shape="rect" id="node37" href="../../d5/d2f/flux_8funcdeclare_8h.html#ab229b0f3f2caf3c0a3ef5299fba2b1c0" title="see fluxcompute.c for non&#45;computer science, real physics calculations of flux" alt="" coords="2420,268,2487,297"/><area shape="rect" id="node39" href="../../df/d22/advance_8c.html#a217bbc071881142282a66a317664912b" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="2564,268,2692,297"/><area shape="rect" id="node44" href="../../df/d22/advance_8c.html#a38c6fa95ece38a2821c70a1524ec47ec" title="this method guarantees conservation of non&#45;sourced conserved quantities when metric is time&#45;dependent..." alt="" coords="2551,345,2705,375"/><area shape="rect" id="node41" href="../../df/d22/advance_8c.html#a22dff5dc24ff389254919e70b79be489" title="pi: initial values at t=t0 to compute Ui pb: values used to compute flux/source pf: solution using fl..." alt="" coords="2796,213,2865,243"/><area shape="rect" id="node50" href="../../df/d15/init_8tools_8c.html#a3750bc790613bc6c8c805af0f1b839c8" title="user1_init_vpot2field_user" alt="" coords="2541,596,2715,625"/><area shape="rect" id="node52" href="../../de/db2/initbase_8funcdeclare_8h.html#afda44281ad5c163455c40f012d4a8954" title="init_vpot2field_user" alt="" coords="2764,596,2897,625"/><area shape="rect" id="node54" href="../../de/db2/initbase_8funcdeclare_8h.html#a90699a18ede8b7f112c0078512804ec1" title="initialize vector potential given user function assumes normal non&#45;staggered field in pr Notice that ..." alt="" coords="2980,596,3049,625"/><area shape="rect" id="node58" href="../../de/db2/initbase_8funcdeclare_8h.html#a0afa200a5f947b1c9f6e554519f28fc4" title="init_primitives" alt="" coords="3321,557,3423,587"/><area shape="rect" id="node71" href="../../d0/dde/fluxctstag_8c.html#a5e3dcbe89d6f8a9384cafb58afd7dbf4" title="interpolates field at FACE to field at CENT assuming field along itself is continuous" alt="" coords="1765,425,1885,471"/><area shape="rect" id="node77" href="../../d0/de6/fluxvpot_8funcdeclare_8h.html#aaa24493002bc8c0a527b1ea2ac2dddbf" title="convert conservative U to stag point P and CENT point U and CENT point primitive" alt="" coords="2215,492,2348,521"/><area shape="rect" id="node87" href="../../d0/dde/fluxctstag_8c.html#a985ee116306b4011810334ae93900493" title="INPUTS: Nvec, pr, primface_l[dir], primface_r[dir] OUTPUTS: pbcorn[dir][side], pvcorn[dir][side][side..." alt="" coords="1736,164,1915,193"/><area shape="rect" id="node95" href="../../d9/de0/step__ch_8c.html#a91fe5c4370e3292a19e7f794797a407f" title="normal bounding of all primitives" alt="" coords="2964,649,3065,679"/><area shape="rect" id="node101" href="../../d9/de0/step__ch_8c.html#abdea68b778dc9253324da69d3c376965" title="bound any pstag type CALLS directly real and MPI boundary functions pstag is at FACE1,2,3 for fields, so user bound is different MPI bounding is the same as CENT quantities used when restarting in initbase.c to bound unewglobal for FLUXB==FLUXCTSTAG" alt="" coords="1532,756,1649,785"/><area shape="rect" id="node104" href="../../d9/de0/step__ch_8c.html#a6f4b963a50a7288964f01775f2f18bb9" title="normal bounding of staggered primitives" alt="" coords="1777,704,1873,733"/><area shape="rect" id="node107" href="../../d0/dde/fluxctstag_8c.html#aa169cb1999412f2e2460012cc5d7a804" title="pure DONOR version: upoint is input staggered updated field that needs to be converted to pstag and t..." alt="" coords="1972,697,2148,743"/><area shape="rect" id="node142" href="../../de/d51/bounds_8c.html#a16398a5325a9df48783423f00ba65bb7" title="all boundaries for RADCYLBEAMCART" alt="" coords="489,755,641,784"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri May 20 2016 15:52:37 for HARM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.3.1
</small></address>
</body>
</html>
