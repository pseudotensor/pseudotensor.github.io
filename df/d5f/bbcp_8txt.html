<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>HARM: docs/bbcp.txt File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">HARM
   </div>
   <div id="projectbrief">harm and utilities</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">docs/bbcp.txt File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="fragment"><div class="line"><span class="preprocessor">####################</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor"># File transfer notes:</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">####################</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">##################</span></div>
<div class="line"><span class="preprocessor"></span>http:<span class="comment">//moo.nac.uci.edu/~hjm/HOWTO_move_data.html</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">##################</span></div>
<div class="line"><span class="preprocessor"></span>use:</div>
<div class="line">http:<span class="comment">//www.iozone.org/</span></div>
<div class="line">or FDT to benchmark disk performance to see what can <span class="keyword">get</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">######################</span></div>
<div class="line"><span class="preprocessor"></span>Lonestar + Ranger -&gt; Ranch <span class="keywordflow">for</span> data storage:</div>
<div class="line">http:<span class="comment">//services.tacc.utexas.edu/index.php/ranch-user-guide/</span></div>
<div class="line">tar cvf - thickdisk1 | ssh ${ARCHIVER} <span class="stringliteral">&quot;cat &gt; ${ARCHIVE}/thickdisk1.tar&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">######################</span></div>
<div class="line"><span class="preprocessor"></span>Lonestar4 (found has issues with taring to ranch <span class="keywordflow">for</span> big files -- and consulting was little help by just suggesting it was expected --- even though lonestar3 didn<span class="stringliteral">&#39;t do this)</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">Do on lonestar:</span></div>
<div class="line"><span class="stringliteral">cd $SCRATCH</span></div>
<div class="line"><span class="stringliteral">~/bin/bbcp -z -s 20 -b +200 -a -k -f -r -P 5 -V -T &#39;</span>ssh -x -<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa73cf2d397cae726436e08d2c891bdb0">a</a> -oConnectTimeout=0 -oFallBackToRsh=no %I -l %U %<a class="code" href="../../d8/d5b/defs_8general_8h.html#a333bf60038d1801707ebf78ebdebdaea">H</a> ~/bin/bbcp<span class="stringliteral">&#39; -S &#39;</span>ssh -x -<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa73cf2d397cae726436e08d2c891bdb0">a</a> -oConnectTimeout=0 -oFallBackToRsh=no %I -l %U %<a class="code" href="../../d8/d5b/defs_8general_8h.html#a333bf60038d1801707ebf78ebdebdaea">H</a> ~/bin/bbcp<span class="stringliteral">&#39; thickdisk7nextnexte tg802609@ranch.tacc.utexas.edu:</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">##############################</span></div>
<div class="line"><span class="stringliteral">With ssh (according to TACC):</span></div>
<div class="line"><span class="stringliteral">cat myfile.tar | ssh target_machine &quot;cd /target_dir/; tar xvf - &quot;</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">#for many files, do (e.g.):</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">for fil in `ls thickdisk7*.tar` ; do echo $fil ; cat $fil | ssh jmckinne@ki-jmck &quot;cd /data2/jmckinne/thickdisk7/ ; tar xvf -&quot; ; done</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">#OR with patterns (http://www.gnu.org/s/automake/manual/tar/extracting-files.html):</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">for fil in `ls thickdisk7*.tar` ; do echo $fil ; cat $fil | ssh jmckinne@ki-jmck &quot;cd /data2/jmckinne/thickdisk7/ ; tar -xvf - --wildcards --no-anchored &#39;</span>*fieldline*<span class="stringliteral">&#39; &quot; ; done</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral"># To copy tar contents over from ki-rh39:~/superdrive to (say) ki-jmck do:</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">ls &gt; allbutthickdisk7_dirs.txt</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral"># then pick out directories from tar files and then once have directory file allbutthickdisk7_tar.txt, do:</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">for fil in `cat allbutthickdisk7_tar.txt` ; do echo $fil ; cat $fil | ssh jmckinne@ki-jmck &quot;cd /data2/jmckinne/ ; tar -xvf - --wildcards --no-anchored &#39;</span>*coordpa*<span class="charliteral">&#39; &#39;</span>*<a class="code" href="../../d8/d5b/defs_8general_8h.html#af637e542453ec23c1a41a1038b223040">nprlist</a>*<span class="charliteral">&#39; &#39;</span>*fieldline*<span class="charliteral">&#39; &#39;</span>*dump0000.bin*<span class="charliteral">&#39; &#39;</span>*gdump.bin*<span class="stringliteral">&#39; &quot; ; done</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">################</span></div>
<div class="line"><span class="stringliteral"># To copy directories of only certain files in those directories but also copy directory structure, do:</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">ls &gt; allbutthickdisk7_dirs.txt</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral"># then pick out directories from tar files and then once have directory file allbutthickdisk7_dirs.txt, do:</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">for fil in `cat allbutthickdisk7_dirs.txt` ; do find $fil | grep fieldline ; done &gt; dirsfilelist.txt</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">for fil in `cat allbutthickdisk7_dirs.txt` ; do echo $fil ; ssh jmckinne@ki-jmck &quot;mkdir -p /data2/jmckinne/$fil/dumps/&quot; ; export dirorig=`pwd` ; cd $fil/dumps/ ; ls --color=never | grep --color=never -E &#39;</span>fieldline.*\.bin|dump0000\.bin|gdump\.bin<span class="stringliteral">&#39; &gt; fieldlinepluslist.txt ;  ~/bin/bbcp -a -k -f -p -r -z -b +200 -I fieldlinepluslist.txt  -P 5 -V -T &#39;</span>ssh -x -<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa73cf2d397cae726436e08d2c891bdb0">a</a> -oConnectTimeout=0 -oFallBackToRsh=no %I -l %U %<a class="code" href="../../d8/d5b/defs_8general_8h.html#a333bf60038d1801707ebf78ebdebdaea">H</a> ~/bin/bbcp<span class="stringliteral">&#39; -S &#39;</span>ssh -x -<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa73cf2d397cae726436e08d2c891bdb0">a</a> -oConnectTimeout=0 -oFallBackToRsh=no %I -l %U %<a class="code" href="../../d8/d5b/defs_8general_8h.html#a333bf60038d1801707ebf78ebdebdaea">H</a> ~/bin/bbcp<span class="stringliteral">&#39; jmckinne@ki-jmck:/data2/jmckinne/$fil/dumps/  ; cd $dirorig ; done</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">########################</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">#on ranch (getting new QB toroidal runs (nothing from kraken yet)):</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">echo &quot;thickdisk3.lmn thickdisk17.ijk thickdiskr3.stuv thickdisk15r.abc thickdisk10.pqrs thickdisk10.tuv thickdisk3.opq thickdisk17.lmn thickdiskr3.xyz thickdisk15r.def&quot; &gt; dirs.txt</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">rm -rf fieldlinepluslistdirs.txt</span></div>
<div class="line"><span class="stringliteral">for thedir in `cat dirs.txt` ; do echo $thedir ; find $thedir \( -name &quot;fieldline*.bin&quot; -o -name &quot;dump0000.bin&quot; -o -name &quot;gdump.bin&quot; -o -name &quot;coordparms&quot; -o -name &quot;nprlist&quot; \) -print &gt;&gt; fieldlinepluslistdirs.txt ; done</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">for fil in fieldlinepluslistdirs.txt ; do stage $fil ; done</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">~/bin/bbcp -a -k -f -p -r -s 20 -z -b +500 -I fieldlinepluslistdirs.txt -P 5 -V -T &#39;</span>ssh -x -<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa73cf2d397cae726436e08d2c891bdb0">a</a> -oFallBackToRsh=no %I -l %U %<a class="code" href="../../d8/d5b/defs_8general_8h.html#a333bf60038d1801707ebf78ebdebdaea">H</a> ~/bin/bbcp<span class="stringliteral">&#39; -S &#39;</span>ssh -x -<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa73cf2d397cae726436e08d2c891bdb0">a</a> -oFallBackToRsh=no %I -l %U %<a class="code" href="../../d8/d5b/defs_8general_8h.html#a333bf60038d1801707ebf78ebdebdaea">H</a> ~/bin/bbcp<span class="stringliteral">&#39; jmckinne@ki-jmck.slac.stanford.edu:/data2/jmckinne/</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">########################</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">Or, for transfers between TACC systems, you could use the version of</span></div>
<div class="line"><span class="stringliteral">gsissh that we have installed, which allows you to do the handshake</span></div>
<div class="line"><span class="stringliteral">encrypted but send the data unencrypted:</span></div>
<div class="line"><span class="stringliteral">cat myfile.tar | gsissh -oNoneEnabled=yes -oNoneSwitch=yes target_machine &quot;cd target_dir; tar xvf - &quot;</span></div>
<div class="line"><span class="stringliteral">The overall consensus here is that the fastest way to do what you want</span></div>
<div class="line"><span class="stringliteral">is to expand the files to $SCRATCH in Ranger and then bbcp them down</span></div>
<div class="line"><span class="stringliteral">to your machine. This should be faster than using the ssh/cat/tar that</span></div>
<div class="line"><span class="stringliteral">you are using now.</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">other options:</span></div>
<div class="line"><span class="stringliteral">http://moo.nac.uci.edu/~hjm/HOWTO_move_data.html</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">##################################</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">Old bbcp notes:</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">bbcp much faster:</span></div>
<div class="line"><span class="stringliteral">http://www.slac.stanford.edu/~abh/bbcp/</span></div>
<div class="line"><span class="stringliteral">http://pcbunn.cithep.caltech.edu/bbcp/using_bbcp.htm</span></div>
<div class="line"><span class="stringliteral">bbcp -P 5 -k -a ....</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">On jdexter@@luigi : getting files from ki-rh42:</span></div>
<div class="line"><span class="stringliteral">~/bin/bbcp -r -P 5 -a -k -T &#39;</span>ssh -x -<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa73cf2d397cae726436e08d2c891bdb0">a</a> %I -l %U %<a class="code" href="../../d8/d5b/defs_8general_8h.html#a333bf60038d1801707ebf78ebdebdaea">H</a> bbcp<span class="stringliteral">&#39; jon@ki-rh42.slac.stanford.edu:/media/disk/jon/thickdisk1/dumps/fieldline* jon@ki-rh42.slac.stanford.edu:/media/disk/jon/thickdisk1/dumps/dump0000* .</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">On QB to ranch (problem with -a into ranch -- have to manually  make directories used for recovering -- stupid):</span></div>
<div class="line"><span class="stringliteral">~/bin/bbcp -r -P 5 thickdisk5fghij tg802609@ranch.tacc.utexas.edu:</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">If copy failed for whatever reason (QB went down), then have to copy per directory since -a -k don&#39;</span><a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a> work properly with -r.  So one has to complete:</div>
<div class="line">~/bin/bbcp -<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa73cf2d397cae726436e08d2c891bdb0">a</a> -k -P 5 * tg802609@ranch.tacc.utexas.edu:thickdisk5fghij/</div>
<div class="line"><a class="code" href="../../d9/d54/other6_8txt.html#abea40877aa2ce569e5f9e3a264872b54">cd</a> <a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89abceb1f5e607b7074378156fa8f94b">dumps</a>/</div>
<div class="line">~/bin/bbcp -<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa73cf2d397cae726436e08d2c891bdb0">a</a> -k -P 5 * tg802609@ranch.tacc.utexas.edu:thickdisk5fghij/<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89abceb1f5e607b7074378156fa8f94b">dumps</a>/</div>
<div class="line"><a class="code" href="../../d9/d54/other6_8txt.html#abea40877aa2ce569e5f9e3a264872b54">cd</a> ../images/</div>
<div class="line">~/bin/bbcp -<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa73cf2d397cae726436e08d2c891bdb0">a</a> -k -P 5 * tg802609@ranch.tacc.utexas.edu:thickdisk5fghij/images/</div>
<div class="line">If <span class="keyword">get</span> message of append couldn<span class="stringliteral">&#39;t be completed, delete that file on ranch</span></div>
<div class="line"><span class="stringliteral">If get message that not enough space to copy files, then contact TACC.</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">bbcp -a will not copy if prior copy failed in some way that bbcp thinks the file is changed.  The file will be skipped!</span></div>
<div class="line"><span class="stringliteral">Can create a file list:</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">ls &gt; filelist.txt</span></div>
<div class="line"><span class="stringliteral">OR to ignore some files:</span></div>
<div class="line"><span class="stringliteral">ls --ignore=dumps --ignore=images --ignore=thickdiskr3 --ignore=filelist.txt --ignore=err.txt &gt; filelist.txt</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">and copy and check err.txt file for such messages &quot;append not poosible&quot;:</span></div>
<div class="line"><span class="stringliteral">~/bin/bbcp -a -k -P 5 -I filelist.txt -l err.txt tg802609@ranch.tacc.utexas.edu:thickdiskr2/dumps/</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">OR to avoid time-out issues with large file lists:</span></div>
<div class="line"><span class="stringliteral">ensure -b value is at least twice -s value</span></div>
<div class="line"><span class="stringliteral">can make s up to (say) 32 or 64 on LAN, but keep to order 4-10 on WAN</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">~/bin/bbcp -s 4 -b 8 -w 2m -a -k -P 5 -I filelist.txt -l err.txt -T &#39;</span>ssh -x -<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa73cf2d397cae726436e08d2c891bdb0">a</a> -oConnectTimeout=0 -oFallBackToRsh=no %I -l %U %<a class="code" href="../../d8/d5b/defs_8general_8h.html#a333bf60038d1801707ebf78ebdebdaea">H</a> bbcp<span class="stringliteral">&#39; -S &#39;</span>ssh -x -<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa73cf2d397cae726436e08d2c891bdb0">a</a> -oConnectTimeout=0 -oFallBackToRsh=no %I -l %U %<a class="code" href="../../d8/d5b/defs_8general_8h.html#a333bf60038d1801707ebf78ebdebdaea">H</a> bbcp<span class="stringliteral">&#39; tg802609@ranch.tacc.utexas.edu:thickdiskr2/dumps/</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">~/bin/bbcp -s 4 -b 8 -w 2m -a -k -P 5 -I filelist.txt -T &#39;</span>ssh -x -<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa73cf2d397cae726436e08d2c891bdb0">a</a> -oConnectTimeout=0 -oFallBackToRsh=no %I -l %U %<a class="code" href="../../d8/d5b/defs_8general_8h.html#a333bf60038d1801707ebf78ebdebdaea">H</a> bbcp<span class="stringliteral">&#39; -S &#39;</span>ssh -x -<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa73cf2d397cae726436e08d2c891bdb0">a</a> -oConnectTimeout=0 -oFallBackToRsh=no %I -l %U %<a class="code" href="../../d8/d5b/defs_8general_8h.html#a333bf60038d1801707ebf78ebdebdaea">H</a> bbcp<span class="stringliteral">&#39; tg802609@ranch.tacc.utexas.edu:thickdiskr2/dumps/</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">OLD: Best not use bbcp&#39;</span>s -r <span class="keywordflow">for</span> recursive since won<span class="stringliteral">&#39;t recover properly after using -a -k when copy failed.</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">Edited the bbcp code in bbcp_FileSpec.C to overwrite file if append not (sic) poosible, but on ranch can&#39;</span><a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a> compile.</div>
<div class="line"></div>
<div class="line">Note that <span class="keywordflow">if</span> use -l err.txt, then may not tell you <span class="keywordflow">if</span> completed successfully or not!  Just stops.  While NOT <span class="keyword">using</span> -l err.txt means don<span class="stringliteral">&#39;t know if had any &quot;poosible&quot; problems.</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">###################################</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">To compile bbcp on ranch, do: make OPT=-DSUN6 Sungcc  </span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">In the end, this worked to ensure complete and correct copy:</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">1) use bbcp as below.  Note that bbcp is the only program I&#39;</span>ve found that resumes.  For example, <span class="keywordflow">for</span> one directory <span class="keywordflow">do</span>:</div>
<div class="line"></div>
<div class="line">ls --ignore=err.txt --ignore=filelist.txt grmhd &gt; filelist.txt</div>
<div class="line">[grmhd included above because otherwise might have * in name and bbcp doesn<span class="stringliteral">&#39;t like that]</span></div>
<div class="line"><span class="stringliteral">-b + 100 helps avoid stalls with ranch and tape processing on ranch side.</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">~/bin/bbcp -a -k -f -b +100 -P 5 -V -I filelist.txt -T &#39;</span>ssh -x -<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa73cf2d397cae726436e08d2c891bdb0">a</a> -oConnectTimeout=0 -oFallBackToRsh=no %I -l %U %<a class="code" href="../../d8/d5b/defs_8general_8h.html#a333bf60038d1801707ebf78ebdebdaea">H</a> bbcp<span class="stringliteral">&#39; -S &#39;</span>ssh -x -<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa73cf2d397cae726436e08d2c891bdb0">a</a> -oConnectTimeout=0 -oFallBackToRsh=no %I -l %U %<a class="code" href="../../d8/d5b/defs_8general_8h.html#a333bf60038d1801707ebf78ebdebdaea">H</a> bbcp<span class="stringliteral">&#39; tg802609@ranch.tacc.utexas.edu:thickdiskr3.abcdefgh/dumps/ &amp;&gt; err.txt</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">Can also try without -I filelist.txt and use recursive copy in new version:</span></div>
<div class="line"><span class="stringliteral">Add: -r  and give path name(s) just before destination</span></div>
<div class="line"><span class="stringliteral">E.g.:</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">~/bin/bbcp -b +100 -a -k -f -r -P 5 -V -T &#39;</span>ssh -x -<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa73cf2d397cae726436e08d2c891bdb0">a</a> -oConnectTimeout=0 -oFallBackToRsh=no %I -l %U %<a class="code" href="../../d8/d5b/defs_8general_8h.html#a333bf60038d1801707ebf78ebdebdaea">H</a> bbcp<span class="stringliteral">&#39; -S &#39;</span>ssh -x -<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa73cf2d397cae726436e08d2c891bdb0">a</a> -oConnectTimeout=0 -oFallBackToRsh=no %I -l %U %<a class="code" href="../../d8/d5b/defs_8general_8h.html#a333bf60038d1801707ebf78ebdebdaea">H</a> bbcp<span class="stringliteral">&#39; thickdisk14.ab thickdiskrr2.ab tg802609@ranch.tacc.utexas.edu: &amp;&gt; err.txt</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">2) Copy each directory (the root data, dumps, images).  Can be done at the same time in different shells.  Don&#39;</span><a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a> use recursive copy in bbcp since won<span class="stringliteral">&#39;t resume correctly.</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">3) Once copy &quot;done&quot;, need to check if really copied and if all files copied and if correctly copied.</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">4) Repeat copy and ensure stderr (stored in err.txt) never outputs &quot;poosible&quot; or stops copying certain files.  This checks that append and all things are making sense to bbcp.  bbcp can append incorrectly and make files too short and even too long!</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">5) Repeat copy and output stderr to file so can:</span></div>
<div class="line"><span class="stringliteral">   grep &quot;already been copied&quot; err.txt | wc</span></div>
<div class="line"><span class="stringliteral">   This checks number of actual files copied.  bbcp can skip files in the list provided, or even if looping on shell, or if using shell expansion.  So unreliable.</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">6) Check result on remote machine per directory:</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">ls --ignore=dumps --ignore=images --ignore=filelist.txt --ignore=err.txt |wc</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">OR (if used recursive bbcp)</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">ls -R | wc</span></div>
<div class="line"><span class="stringliteral">(on ranch: and subtract 7=1+2 for 1 . and 2 blank lines and 2*2 directories (or subtract 2 from # of words)  ls -R won&#39;</span><a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a> include hidden dirs on some systems depending upon alias definition)</div>
<div class="line"></div>
<div class="line">6.5) Check filelist.txt to ensure actually copied all files:</div>
<div class="line"></div>
<div class="line">wc filelist.txt</div>
<div class="line"></div>
<div class="line">OR <span class="keywordflow">for</span> <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa73cf2d397cae726436e08d2c891bdb0">a</a> single recursive directory:</div>
<div class="line"></div>
<div class="line">ls -<a class="code" href="../../d8/d5b/defs_8general_8h.html#abf002e87ba3ed4d3c9dcc98216e6d9d6">R</a> | wc</div>
<div class="line">(should be same as on, e.g., ranch, even though not <span class="keyword">true</span> # of files)</div>
<div class="line"></div>
<div class="line">OR <span class="keywordflow">for</span> multiple recursive folders:</div>
<div class="line"></div>
<div class="line">find &lt;list of space separated folders&gt; &gt; filelist.txt | wc</div>
<div class="line"><a class="code" href="../../d8/d60/init_8c.html#a07484107e6d9fdf38b53edf631d6511d">E</a>.g.:</div>
<div class="line">find thickdiskrr2.ab thickdisk14.ab &gt; postfilelist.txt</div>
<div class="line">(and subtract #dirs * (1 + 2) ) = 3,6,9,etc.</div>
<div class="line"></div>
<div class="line">7) If numbers match, then likely have copied everything properly.  Should be correct size too, but can check manually that files have uniform looking sizes.  du -s doesn&#39;<a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a> help much since on ranch the sizes are measured oddly.  Rerunning bbcp repeatedly until &quot;already been copied&quot; appears for all files should be <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa73cf2d397cae726436e08d2c891bdb0">a</a> good check on file size and <a class="code" href="../../d8/d5b/defs_8general_8h.html#aa73cf2d397cae726436e08d2c891bdb0">a</a> lack of corruption.</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">###########################################</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">New type of command allowed (overwrites correctly <span class="keywordflow">if</span> <a class="code" href="../../d8/d5b/defs_8general_8h.html#ad4ec5aab9b62fbbe9b8fc2d8ac0a5989">failed</a> copy, and less <a class="code" href="../../d8/d5b/defs_8general_8h.html#ad4ec5aab9b62fbbe9b8fc2d8ac0a5989">failed</a> copies, but overwrites instead of appending <span class="keywordflow">for</span> some reason):</div>
<div class="line">On ranch, -s 20 required to get 20<a class="code" href="../../d4/d96/global_8nondepmnemonics_8rad_8h.html#aa6b38d492364d98453284934ed7caee9">MB</a>/s since only given 1<a class="code" href="../../d4/d96/global_8nondepmnemonics_8rad_8h.html#aa6b38d492364d98453284934ed7caee9">MB</a>/<a class="code" href="../../d8/df4/global_8funcdeclare_8h.html#a0cadfd81839468f4b4d9bebcecd8ee12">sec</a> per stream by ranch.</div>
<div class="line"></div>
<div class="line">nohup ~/bin/bbcp -s 20 -b +100 -<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa73cf2d397cae726436e08d2c891bdb0">a</a> -k -f -r -P 5 -<a class="code" href="../../dc/dd2/newcodediff_8txt.html#af84f2c3bf153920b7c8d186132d39bc7">V</a> -T <span class="stringliteral">&#39;ssh -x -a -oConnectTimeout=0 -oFallBackToRsh=no %I -l %U %H ~/bin/bbcp&#39;</span> -S <span class="stringliteral">&#39;ssh -x -a -oConnectTimeout=0 -oFallBackToRsh=no %I -l %U %H ~/bin/bbcp&#39;</span> tg802609@ranch.tacc.utexas.edu:<span class="stringliteral">&quot;thickdisk3abcdefgh thickdisk3.ijk&quot;</span> . &gt;err3again.txt &amp; </div>
<div class="line"></div>
<div class="line">#######################################</div>
<div class="line">On Kraken to ki-jmck:</div>
<div class="line">#http:<span class="comment">//www.nics.tennessee.edu/computing-resources/access</span></div>
<div class="line"></div>
<div class="line">From <a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a> = 0 out to <a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a> ~ 22500</div>
<div class="line">/lustre/scratch/atchekho/run/rtf2_15r34_2pi_a0.99gg500rbr1e3_0_0_0</div>
<div class="line"></div>
<div class="line">From <a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a> = 22500 out to <a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a> ~ 31500 (with correct floor accounting)</div>
<div class="line">/lustre/scratch/atchekho/run/rtf2_15r34_2pi_a0.99gg500rbr1e3_0_0_0_faildufix2</div>
<div class="line"></div>
<div class="line"># don<span class="stringliteral">&#39;t use below:</span></div>
<div class="line"><span class="stringliteral">#~/bin/bbcp -s 20 -b +200 -a -k -f -r -P 5 -V -T &#39;</span>ssh -x -<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa73cf2d397cae726436e08d2c891bdb0">a</a> -oConnectTimeout=0 -oFallBackToRsh=no %I -l %U %<a class="code" href="../../d8/d5b/defs_8general_8h.html#a333bf60038d1801707ebf78ebdebdaea">H</a> ~/bin/bbcp<span class="stringliteral">&#39; -S &#39;</span>ssh -x -<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa73cf2d397cae726436e08d2c891bdb0">a</a> -oConnectTimeout=0 -oFallBackToRsh=no %I -l %U %<a class="code" href="../../d8/d5b/defs_8general_8h.html#a333bf60038d1801707ebf78ebdebdaea">H</a> ~/bin/bbcp<span class="stringliteral">&#39; jmckinne@ki-jmck.slac.stanford.edu:/data2/jmckinne/</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral"># do below:</span></div>
<div class="line"><span class="stringliteral">echo &quot;rtf2_15r34_2pi_a0.99gg500rbr1e3_0_0_0&quot; &gt; ~/dirs1.txt</span></div>
<div class="line"><span class="stringliteral">echo &quot;rtf2_15r34_2pi_a0.99gg500rbr1e3_0_0_0_faildufix2&quot; &gt; ~/dirs2.txt</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral"># for other window since on Kraken, can&#39;</span><a class="code" href="../../d8/d5b/defs_8general_8h.html#ae1ee1e1c83c3f70e2e1afed4f4f5b41e">t</a> do passwordless ssh</div>
<div class="line"># -&gt; change dirs1 -&gt; dirs2 and back</div>
<div class="line"></div>
<div class="line"># Kraken barfs on: ls --color=never | grep --color=never -<a class="code" href="../../d8/d60/init_8c.html#a07484107e6d9fdf38b53edf631d6511d">E</a> <span class="stringliteral">&#39;fieldline.*\.bin|dump0000\.bin|gdump\.bin&#39;</span></div>
<div class="line"># replace with: find . \( -name <span class="stringliteral">&quot;fieldline*.bin&quot;</span> -o -name <span class="stringliteral">&quot;dump0000.bin&quot;</span> -o -name <span class="stringliteral">&quot;gdump.bin&quot;</span> \) -print</div>
<div class="line"></div>
<div class="line">for fil in `cat ~/dirs2.txt` ; <span class="keywordflow">do</span> echo <a class="code" href="../../d9/d54/other6_8txt.html#a6db4e5668b138261c639359c87c04598">$fil</a> ; export dirorig=`pwd` ; <a class="code" href="../../d9/d54/other6_8txt.html#abea40877aa2ce569e5f9e3a264872b54">cd</a> $fil/<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89abceb1f5e607b7074378156fa8f94b">dumps</a>/ ; find . \( -name <span class="stringliteral">&quot;fieldline*.bin&quot;</span> -o -name <span class="stringliteral">&quot;dump0000.bin&quot;</span> -o -name <span class="stringliteral">&quot;gdump.bin&quot;</span> \) -print &gt; ~/fieldlinepluslistdirs2.txt ; ssh jmckinne@ki-jmck.slac.stanford.edu <span class="stringliteral">&quot;mkdir -p /data2/jmckinne/$fil/dumps/&quot;</span> ;  ~/bin/bbcp -<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa73cf2d397cae726436e08d2c891bdb0">a</a> -k -f -<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a> -r -z -b +200 -I ~/fieldlinepluslistdirs2.txt  -P 5 -<a class="code" href="../../dc/dd2/newcodediff_8txt.html#af84f2c3bf153920b7c8d186132d39bc7">V</a> -T <span class="stringliteral">&#39;ssh -x -a -oConnectTimeout=0 -oFallBackToRsh=no %I -l %U %H ~/bin/bbcp&#39;</span> -S <span class="stringliteral">&#39;ssh -x -a -oConnectTimeout=0 -oFallBackToRsh=no %I -l %U %H ~/bin/bbcp&#39;</span> jmckinne@ki-jmck.slac.stanford.edu:/data2/jmckinne/$fil/<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89abceb1f5e607b7074378156fa8f94b">dumps</a>/  ; <a class="code" href="../../d9/d54/other6_8txt.html#abea40877aa2ce569e5f9e3a264872b54">cd</a> $dirorig ; done</div>
<div class="line"></div>
<div class="line"># <span class="keywordflow">for</span> every 100th file <span class="keywordflow">do</span>:</div>
<div class="line"># replace with: find . \( -name <span class="stringliteral">&quot;fieldline??00.bin&quot;</span> -o -name <span class="stringliteral">&quot;fieldline0000.bin&quot;</span> -o -name <span class="stringliteral">&quot;dump0000.bin&quot;</span> -o -name <span class="stringliteral">&quot;gdump.bin&quot;</span> \) -print</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">for</span> fil in `cat ~/dirs2.txt` ; <span class="keywordflow">do</span> echo <a class="code" href="../../d9/d54/other6_8txt.html#a6db4e5668b138261c639359c87c04598">$fil</a> ; export dirorig=`pwd` ; <a class="code" href="../../d9/d54/other6_8txt.html#abea40877aa2ce569e5f9e3a264872b54">cd</a> $fil/<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89abceb1f5e607b7074378156fa8f94b">dumps</a>/ ; find . \( -name <span class="stringliteral">&quot;fieldline??00.bin&quot;</span> -o -name <span class="stringliteral">&quot;fieldline0000.bin&quot;</span> -o -name <span class="stringliteral">&quot;dump0000.bin&quot;</span> -o -name <span class="stringliteral">&quot;gdump.bin&quot;</span> \) -print &gt; ~/fieldlinepluslistdirs2frac.txt ; ssh jmckinne@ki-jmck.slac.stanford.edu <span class="stringliteral">&quot;mkdir -p /data2/jmckinne/$fil/dumps/&quot;</span> ;  ~/bin/bbcp -<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa73cf2d397cae726436e08d2c891bdb0">a</a> -k -f -<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a> -r -z -b +200 -I ~/fieldlinepluslistdirs2frac.txt  -P 5 -<a class="code" href="../../dc/dd2/newcodediff_8txt.html#af84f2c3bf153920b7c8d186132d39bc7">V</a> -T <span class="stringliteral">&#39;ssh -x -a -oConnectTimeout=0 -oFallBackToRsh=no %I -l %U %H ~/bin/bbcp&#39;</span> -S <span class="stringliteral">&#39;ssh -x -a -oConnectTimeout=0 -oFallBackToRsh=no %I -l %U %H ~/bin/bbcp&#39;</span> jmckinne@ki-jmck.slac.stanford.edu:/data2/jmckinne/$fil/<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89abceb1f5e607b7074378156fa8f94b">dumps</a>/  ; <a class="code" href="../../d9/d54/other6_8txt.html#abea40877aa2ce569e5f9e3a264872b54">cd</a> $dirorig ; done</div>
<div class="line"></div>
<div class="line">#######################################</div>
<div class="line"></div>
<div class="line">Tried uberftp and globus-url-copy, but problems</div>
<div class="line"></div>
<div class="line">uberftp -binary -cksum on -keepalive 60 -parallel 10 -resume thickdiskr2 ranch.tacc.utexas.edu</div>
<div class="line">then enter and <span class="keywordflow">do</span>:</div>
<div class="line">resume thickdiskr2</div>
<div class="line">put -r thickdiskr2</div>
<div class="line"><span class="keywordflow">for</span> recursive copy.  Not sure how failure resume works <span class="keywordflow">if</span> at all.</div>
<div class="line"></div>
<div class="line">Problem is that certificate expires very soon and kills copy, so useless to copy large files.</div>
<div class="line"></div>
<div class="line">Also tried:</div>
<div class="line">globus-url-copy -b -r -restart -<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a> 5 file:<span class="comment">//thickdiskr2  gsiftp://ranch.tacc.utexas.edu:</span></div>
<div class="line"></div>
<div class="line">But <a class="code" href="../../d8/d5b/defs_8general_8h.html#ad4ec5aab9b62fbbe9b8fc2d8ac0a5989">failed</a> to figure out how to <span class="keyword">get</span> it<span class="stringliteral">&#39;s special certificate using that other program with a similar name.</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">############################################</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">Setting up ssh tunnel (e.g. to get out of orange.slac.stanford.edu to portal through ki-rh42):</span></div>
<div class="line"><span class="stringliteral">On orange do:</span></div>
<div class="line"><span class="stringliteral">1) ssh -N -f -L 2134:portal.astro.washington.edu:22 jon@ki-rh42.slac.stanford.edu  </span></div>
<div class="line"><span class="stringliteral">then still on orange do to ssh to jdexter@portal.astro.washington.edu through ki-rh42:</span></div>
<div class="line"><span class="stringliteral">2) ssh -p 2134 jdexter@localhost</span></div>
<div class="line"><span class="stringliteral">OR to scp</span></div>
<div class="line"><span class="stringliteral">3) scp -P 2134 dump???? jdexter@localhost:/astro/net/scratch1/jdexter/mb09/quadrupole_rout40/</span></div>
<div class="line"><span class="stringliteral">In either case you&#39;</span>ll need to enter the jdexter password on portal.astro.washington.edu.</div>
<div class="line"></div>
<div class="line">###############################################</div>
<div class="line"></div>
<div class="line">Couldn<span class="stringliteral">&#39;t get this to work:</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">Setting up ssh tunnel (e.g. to get data from queenbee to ranch through lonestar)</span></div>
<div class="line"><span class="stringliteral">On queenbee do (lonestar password):</span></div>
<div class="line"><span class="stringliteral">1) ssh -N -f -L 2134:ranch.tacc.utexas.edu:22 tg802609@lonestar.tacc.utexas.edu</span></div>
<div class="line"><span class="stringliteral">then still on queenbee do to ssh to tg802609@ranch.tacc.utexas.edu through lonestar:</span></div>
<div class="line"><span class="stringliteral">2) ssh -p 2134 tg802609@localhost</span></div>
<div class="line"><span class="stringliteral">OR to scp</span></div>
<div class="line"><span class="stringliteral">3) scp -P 2134 dump???? tg802609@localhost:</span></div>
<div class="line"><span class="stringliteral">OR to bbcp</span></div>
<div class="line"><span class="stringliteral">4) bbcp -k -a -r -P 5 -S &#39;</span>ssh -<a class="code" href="../../d9/d54/other6_8txt.html#a4c46d2d3bb1db943c0dce6af1c779ff5">p</a> 2134 -x -<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa73cf2d397cae726436e08d2c891bdb0">a</a> %I -l %U %<a class="code" href="../../d8/d5b/defs_8general_8h.html#a333bf60038d1801707ebf78ebdebdaea">H</a> bbcp<span class="stringliteral">&#39; dump???? tg802609@localhost:</span></div>
<div class="line"><span class="stringliteral"></span></div>
<div class="line"><span class="stringliteral">OR to bbcp w/ tarification</span></div>
<div class="line"><span class="stringliteral">5) ??????????tar cvf - thickdisk3 | bbcp -P 5 -k -a -T &#39;</span>ssh -x -<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa73cf2d397cae726436e08d2c891bdb0">a</a> %I -l %U %<a class="code" href="../../d8/d5b/defs_8general_8h.html#a333bf60038d1801707ebf78ebdebdaea">H</a> bbcp<span class="stringliteral">&#39; tg802609@localhost:</span></div>
<div class="line"><span class="stringliteral">In latter cases you&#39;</span>ll need to enter the tg802609 password on ranch</div>
<div class="line"></div>
<div class="line">####################################################</div>
<div class="line"></div>
<div class="line">This works:</div>
<div class="line"></div>
<div class="line">or directly:</div>
<div class="line">bbcp -r -k -<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa73cf2d397cae726436e08d2c891bdb0">a</a> -P 5 thickdisk3_qb.tgz tg802609@ranch.tacc.utexas.edu:</div>
<div class="line"></div>
<div class="line">############################################################</div>
<div class="line">Scratch:</div>
<div class="line">tar cvf - thickdisk1 | ssh ${ARCHIVER} <span class="stringliteral">&quot;cat &gt; ${ARCHIVE}/thickdisk1.tar&quot;</span></div>
<div class="line">~/bin/bbcp -r -P 5 -<a class="code" href="../../d8/d5b/defs_8general_8h.html#aa73cf2d397cae726436e08d2c891bdb0">a</a> -k -T <span class="stringliteral">&#39;ssh -x -a %I -l %U %H bbcp&#39;</span> jon@ki-rh42.slac.stanford.edu:/media/disk/jon/thickdisk1/<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89abceb1f5e607b7074378156fa8f94b">dumps</a>/fieldline* jon@ki-rh42.slac.stanford.edu:/media/disk/jon/thickdisk1/<a class="code" href="../../d0/ddc/datadesc__mb09_8txt.html#a89abceb1f5e607b7074378156fa8f94b">dumps</a>/dump0000* .</div>
<div class="line"></div>
<div class="line">#######</div>
<div class="line"><span class="preprocessor"># to clean stderr files:</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor"># find . -maxdepth 1 -name &#39;stderr_ranch*&#39; -exec rm {} \; ; find . -maxdepth 1 -name &#39;stdout_ranch*&#39; -exec rm {} \;  ;  find . -maxdepth 1 -name &#39;stdfull_ranch*&#39; -exec rm {} \;  ;  find . -maxdepth 1 -name &#39;filestocopy.txt.*&#39; -exec rm {} \;</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">dirorig=`pwd`</div>
<div class="line">streams=2</div>
<div class="line">buffers=2000</div>
<div class="line">thesubdirname=<span class="stringliteral">&quot;dumps&quot;</span></div>
<div class="line">counterbad=0</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#~/bin/bbcp -z -s $streams -b +$buffers -a -k -f -P 5 -V -l $dirorig/stderr_ranch.$thedir.$thesubdirname.$counterbad -T &#39;ssh -oConnectTimeout=0 -oFallBackToRsh=no %I -l %U %H ~/bin/bbcp&#39; -S &#39;ssh -oConnectTimeout=0 -oFallBackToRsh=no %I -l %U %H ~/bin/bbcp&#39; -I $dirorig/filestocopy.txt.$thedir.$thesubdirname tg802609@ranch.tacc.utexas.edu:$thedir/$thesubdirname/ &amp;&gt; $dirorig/stdfull_ranch.$thedir.$thesubdirname.$counterbad</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor"># bbcp.orig with recursive</span></div>
<div class="line"><span class="preprocessor"></span>bbcp_CONFIGFN=<span class="stringliteral">&quot;~/.bbcp.cf&quot;</span></div>
<div class="line"><a class="code" href="../../d9/d54/other6_8txt.html#abea40877aa2ce569e5f9e3a264872b54">cd</a> /lustre/scratch/jmckinne/</div>
<div class="line">dirorig=`pwd`</div>
<div class="line">thedir=<span class="stringliteral">&quot;thickdiskr3nextv&quot;</span></div>
<div class="line">thesubdirname=<span class="stringliteral">&quot;dumps&quot;</span></div>
<div class="line"><a class="code" href="../../d9/d54/other6_8txt.html#abea40877aa2ce569e5f9e3a264872b54">cd</a> $thedir/$thesubdirname/</div>
<div class="line">fulllist=<span class="stringliteral">&quot;$dirorig/files.test&quot;</span></div>
<div class="line"><span class="preprocessor">#ls * &gt; $fulllist</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#bufferoptions=&quot;-b +800&quot;</span></div>
<div class="line"><span class="preprocessor"></span>bufferoptions=<span class="stringliteral">&quot;&quot;</span></div>
<div class="line"><span class="preprocessor">#streamoptions=&quot;-s 20&quot;</span></div>
<div class="line"><span class="preprocessor"></span>streamoptions=<span class="stringliteral">&quot;&quot;</span></div>
<div class="line">options=<span class="stringliteral">&quot;-a -k -z -r -f -P 5 -V -C $dirorig/.bbcp.cf $bufferoptions $streamoptions&quot;</span></div>
<div class="line">erroptions=<span class="stringliteral">&quot;-l $dirorig/stderr.test&quot;</span></div>
<div class="line"><span class="preprocessor">#whichbbcp=&quot;bbcp.orig&quot;</span></div>
<div class="line"><span class="preprocessor"></span>whichbbcp=<span class="stringliteral">&quot;bbcp.v5&quot;</span></div>
<div class="line"><span class="preprocessor">#connectoptions=&quot;-T &#39;ssh -oConnectTimeout=0 -oFallBackToRsh=no %I -l %U %H ~/bin/$whichbbcp -C ~/.bbcp.cf&#39; -S &#39;ssh -oConnectTimeout=0 -oFallBackToRsh=no %I -l %U %H ~/bin/$whichbbcp -C ~/.bbcp.cf&#39;&quot;</span></div>
<div class="line"><span class="preprocessor"></span>connectoptions=<span class="stringliteral">&quot;&quot;</span></div>
<div class="line">destination=<span class="stringliteral">&quot;tg802609@ranch.tacc.utexas.edu:$thedir/$thesubdirname/&quot;</span></div>
<div class="line">~/bin/$whichbbcp $options $erroptions $connectoptions * $destination</div>
<div class="line"><span class="preprocessor">#~/bin/$whichbbcp $options $erroptions $connectoptions -I $fulllist $destination</span></div>
<div class="line"><span class="preprocessor">cd $dirorig</span></div>
</div><!-- fragment --> 
<p>Definition in file <a class="el" href="../../df/d5f/bbcp_8txt_source.html">bbcp.txt</a>.</p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri May 20 2016 15:52:36 for HARM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.3.1
</small></address>
</body>
</html>
